<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title> Trở thành Functional Programmer - Phần 3 · Learn and Share</title><meta name="description" content="Trở thành Functional Programmer - Phần 3 - Hung Tan Nguyen"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#FB4D42"><meta name="google-site-verification" content="rk-Nc1c8xi1CdZ0ZQIVV-ifsndGrHanIuSHI-yTHZYE"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/zoom.css"><meta property="og:title" content="Trở thành Functional Programmer - Phần 3"><meta property="og:image" content="https://viblo.asia/uploads/e85b8079-5076-40ca-af63-f1a136d06516.png"><meta property="og:description" content="Những bước đầu tiên của việc hiểu rõ các concepts trong lập trình hàm (Functional Programming - FP) là những bước quan trọng nhất, và đôi khi là những bước khó khăn nhất. Nhưng với cách tiếp cận đúng đắn, mọi thứ sẽ trở nên dễ hiểu hơn rất nhiều. Và đây là series được tạo ra nhằm mục đích giúp các bạn dễ thở hơn trong quá trình tiếp cận với FP."></head><body><div class="wrap"><div class="header"><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nthung2112" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item search-form-input"><div class="search-icon"><div class="search-icon__circle"></div><div class="search-icon__rectangle"></div></div></li></ul><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" placeholder="Type something..." class="ins-search-input"><span class="ins-close ins-selectable"><div class="close-icon"><div class="close-icon__x"></div><div class="close-icon__y"></div></div></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>var rootUrl = "/";
var contentUrl = '/content.json';
(function (window) {
  var INSIGHT_CONFIG = {
  TRANSLATION: {
      POSTS:'Posts',
      PAGES: 'Pages',
      CATEGORIES: 'Categories',
      TAGS: 'Tags',
      UNTITLED: '(Untitled)'
    },
    ROOT_URL: rootUrl,
    CONTENT_URL: contentUrl,
  };
  window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);</script></div></div><section class="container"><div class="post"><article class="post-block"><div class="wrap"><h1 class="post-title">Trở thành Functional Programmer - Phần 3</h1><h2 class="post-subtitle"></h2><header class="post-info">Aug 23, 2017<div class="tags"></div><div class="fb-ir-time"><time dateTime="2017-08-23T16:25:03.000Z" class="op-modified"></time><time dateTime="2017-08-23T16:25:03.000Z" class="op-published"></time></div></header></div><div class="post-banner"><img src="https://viblo.asia/uploads/e85b8079-5076-40ca-af63-f1a136d06516.png"></div><div class="wrap"><div class="post-content"><p>Những bước đầu tiên của việc hiểu rõ các concepts trong lập trình hàm (Functional Programming - FP) là những bước quan trọng nhất, và đôi khi là những bước khó khăn nhất. Nhưng với cách tiếp cận đúng đắn, mọi thứ sẽ trở nên dễ hiểu hơn rất nhiều. Và đây là series được tạo ra nhằm mục đích giúp các bạn dễ thở hơn trong quá trình tiếp cận với FP.</p>
<a id="more"></a>
<h2 id="Concept-5-Function-Composition-Ham-hop"><a href="#Concept-5-Function-Composition-Ham-hop" class="headerlink" title="Concept 5: Function Composition - Hàm hợp"></a>Concept 5: Function Composition - Hàm hợp</h2><p><img src="https://viblo.asia/uploads/a43d04e0-b38a-414e-994f-483c2e68770d.png" alt=""></p>
<p>Lười là một trong những đặc trưng của lập trình viên chúng ta. Điển hình cho cái tính lười này là sự ngán ngẩm khi phải thực hiện đi thực hiện lại công việc chỉnh sửa, test, deploy code mà mình đã từng viết trước đó.</p>
<p>Vì thế, chúng ta luôn luôn tìm ra những cách để chỉ làm một lần và đem ra tái sử dụng một lúc nào đó.</p>
<p>Tái sử dụng code (code reuse) là một thứ thật tuyệt vời nhưng rất khó để đạt được. Nếu các đoạn code quá cụ thể thì ta không thể nào tái sử dụng được. Nhưng nếu các đoạn code đó lại quá chung chung thì lại rất khó khi áp dụng vào từng trường hợp cụ thể.</p>
<p>Do đó chúng ta cần một sự cân bằng giữa hai tính chất trên, cần một cách để tạo ra các khối code nhỏ, có thể dễ dàng tái sử dụng - giống như các viên gạch vậy - để tạo nên các chức năng phức tạp.</p>
<p>Trong FP, hàm được coi như các khối vật liệu xây dựng nên chương trình. Chúng ta sẽ viết các hàm cho những công việc cụ thể, nhưng sau đó chúng ta có thể ghép chúng lại như ghép Lego vậy.</p>
<p>Và concept mô tả cho việc này có tên là <strong>Function Composition - Hàm hợp</strong></p>
<p>Vậy nó hoạt động như thế nào? Để hiểu rõ hơn, hãy cùng bắt đầu với 2 hàm Javascript sau :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var add10 = function(value) &#123;</span><br><span class="line">    return value + 10;</span><br><span class="line">&#125;;</span><br><span class="line">var mult5 = function(value) &#123;</span><br><span class="line">    return value * 5;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Nhìn 2 hàm này khá là rối rắm, nên chúng ta có thể viết lại bằng cách sử dụng <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener">Arrow function</a> như sau:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var add10 = value =&gt; value + 10;</span><br><span class="line">var mult5 = value =&gt; value * 5;</span><br></pre></td></tr></table></figure>
<p>Gọn hơn rồi nhỉ. Lúc này hãy thử tưởng tượng rằng chúng ta có một hàm nhận một giá trị số rồi cộng với 10, sau đó nhân kết quả nhận được với 5. Chúng ta <em>có thể</em> viết như sau :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var mult5AfterAdd10 = value =&gt; 5 * (value + 10)</span><br></pre></td></tr></table></figure>
<p>Mặc dù đây chỉ là một ví dụ đơn giản, nhưng chúng ta sẽ có cảm giác rằng mình không hề muốn viết hàm này từ con số 0 một chút nào. Lý do đầu tiên, vì chúng ta có thể phạm phải một số sai lầm như là quên mất dấu đóng/mở ngoặc.</p>
<p>Lý do thứ hai, chúng ta đã có 2 hàm trước đó, <code>add10</code> dùng để cộng thêm 10 vào 1 giá trị, <code>mult5</code> dùng để nhân 5 lần giá trị nhận được, nên việc viết lại hàm <code>mul5AfterAdd10</code> thực chất chỉ là viết lại những gì đã viết.</p>
<p>Và vì thế, chúng ta sẽ dùng 2 hàm <code>add10</code> và <code>mult5</code> làm thành phần cho việc <em>xây dựng</em> nên hàm mới:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var mult5AfterAdd10 = value =&gt; mult5(add10(value));</span><br></pre></td></tr></table></figure>
<p>Ta đã vừa sử dụng các hàm đã có để tạo nên hàm <code>mult5AfterAdd10</code>, nhưng vẫn còn cách cải thiện đoạn code trên.</p>
<p>Chúng ta sẽ nhắc lại một chút về toán học. <code>f ∘ g</code> là phép hợp hàm và được diễn giải là <code>hàm f kết hợp với hàm g</code>, hoặc theo ngôn ngữ phổ thong, <code>hàm f sau hàm g</code>. Vì thế <code>(f ∘ g)(x)</code> tương đương với việc gọi hàm <code>f</code> sau khi gọi hàm <code>g</code> với tham số là <code>x</code>, hay viết gọn lại là <code>f(g(x))</code>.</p>
<p>Ví dụ ở trên sẽ tương đương với <code>mult5 ∘ add10</code> hoặc là <code>hàm mult5 theo sau hàm add10</code>, và vì thế tên hàm sẽ là <code>mult5AfterAdd10</code>.</p>
<p>Và đó chính xác là những gì mà chúng ta đã làm. Ta gọi hàm <code>mult5</code> sau khi gọi hàm <code>add10</code> với tham số là <code>value</code>, hay viết gọn là <code>mult5(add10(value))</code>.</p>
<p>Vì Javascript không hỗ trợ FP một cách hoàn toàn nên code có vẻ khá phức tạp, chúng ta hãy nhìn sang phiên bản của Elm:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add10 value =</span><br><span class="line">    value + 10</span><br><span class="line">mult5 value =</span><br><span class="line">    value * 5</span><br><span class="line">mult5AfterAdd10 value =</span><br><span class="line">    (mult5 &lt;&lt; add10) value</span><br></pre></td></tr></table></figure>
<p>Toán tử <code>&lt;&lt;</code> được dùng để <em>kết hợp hàm</em> ở trong Elm. Và việc sử dụng toán tử này sẽ cho chúng ta một hình dung khá rõ ràng về luồng xử lý dữ liệu. Đầu tiên, biến <code>value</code> được truyền cho hàm <code>add10</code>, sau đó sẽ được truyền sang hàm <code>mult5</code>.</p>
<p>Đồng thời hãy lưu ý dấu mở và đóng ngoặc ở hàm <code>mult5AfterAdd10</code>, cụ thể là ở đoạn <code>(mult5 &lt;&lt; add10)</code>. Việc sử dụng đóng mở ngoặc ở đây nhằm đảm bảo rằng 2 hàm sẽ được kết hợp <em>trước khi</em> xử lý tham số <code>value</code>.</p>
<p>Ta cũng có thể kết hợp nhiều hàm nếu thích :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f x =</span><br><span class="line">   (g &lt;&lt; h &lt;&lt; s &lt;&lt; r &lt;&lt; t)  x</span><br></pre></td></tr></table></figure>
<p>Ở đây biến <code>x</code> sẽ được truyền vào hàm <code>t</code>, kết quả được truyền sang hàm <code>r</code>, sau đó kết quả ở hàm <code>r</code>lại sang hàng <code>s</code> và tiếp tục cho đến hết hàm <code>g</code>. Phiên bản hàm hợp tương đương ở Javascript sẽ là <code>g(h(s(r(t(x)))))</code> - trông như một đống ngổn ngang toàn dấu đóng mở ngoặc.</p>
<h2 id="Concept-6-Point-Free-Notation"><a href="#Concept-6-Point-Free-Notation" class="headerlink" title="Concept 6 : Point-Free Notation"></a>Concept 6 : Point-Free Notation</h2><p>(Lời người dịch : Từ này mình không tìm thấy từ tiếng Việt tương ứng, theo ý hiểu của mình có nghĩa là ký hiệu hàm mà không phải chỉ định rõ tham số nên được gọi là Point - Free)</p>
<p><img src="https://viblo.asia/uploads/0c8cf48b-7b8a-4da8-b178-101aefb74ca3.png" alt=""></p>
<p>Có một phong cách viết code mà không phải chỉ định rõ tham số với tên gọi là <strong>Point-Free Notation</strong>. Ban đầu phong cách này nhìn có thể kỳ cục nhưng theo thời gian, chúng ta sẽ cảm nhận được tác dụng của sự vắn tắt này.</p>
<p>Quay trở lại ví dụ về hàm <code>mult5AfterAdd10</code>, ta nhận thấy rằng biến <code>value</code> được ghi ra hai lần. Một lần trong danh sách tham số và một lần được sử dụng trong thân hàm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- This is a function that expects 1 parameter</span><br><span class="line">mult5AfterAdd10 value =</span><br><span class="line">    (mult5 &lt;&lt; add10) value</span><br></pre></td></tr></table></figure>
<p>Nhưng thực tế thì tham số này là không cần thiết vì hàm <code>add10</code> - hàm ở ngoài cùng bên phải của hàm hợp, cũng dùng chính xác tham số đó. Dưới đây sẽ là phiên bản <code>point-free</code> tương đương với hàm trên:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- This is also a function that expects 1 parameter</span><br><span class="line">mult5AfterAdd10 =</span><br><span class="line">    (mult5 &lt;&lt; add10)</span><br></pre></td></tr></table></figure>
<p>Khi viết theo cách này, thực tế sẽ đem lại cho ta rất nhiều lợi ích.</p>
<p>Đầu tiên, chúng ta không phải chỉ rõ các tham số được rút gọn, do đó chúng ta không phải mất thời gian để nghĩ tên cho tất cả các tham số đó.</p>
<p>Thứ hai, viết theo kiểu này sẽ dễ đọc và suy luận hơn vì nó sẽ bớt rối rắm. Ví dụ phía trên rất đơn giản, nhưng hãy tưởng tượng nếu một hàm nhận <em>nhiều hơn một tham số</em>.</p>
<h2 id="Rac-roi-chon-thien-duong"><a href="#Rac-roi-chon-thien-duong" class="headerlink" title="Rắc rối chốn thiên đường"></a>Rắc rối chốn thiên đường</h2><p><img src="https://viblo.asia/uploads/b7929b21-7615-4740-9aa9-40b4dafd8aef.png" alt=""></p>
<p>Từ đầu bài viết đến giờ, chúng ta đã tìm hiểu cách <em>Hàm hợp</em> hoạt động và lý do cũng như cách chúng ta nên viết hàm dưới dạng <em>Point-Free Notation</em> cho sự mạch lạc, rõ ràng và linh động.</p>
<p>Giờ, hãy thử áp dụng các ý tưởng trên vào một bối cảnh khác và xem chúng hoạt động ra sao nhé. Tưởng tượng chúng ta thay hàm <code>add10</code> bằng hàm <code>add</code> như sau :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add x y =</span><br><span class="line">    x + y</span><br><span class="line">mult5 value =</span><br><span class="line">    value * 5</span><br></pre></td></tr></table></figure>
<p>Câu hỏi giờ là : Làm thế nào để tạo ra hàm <code>mult5After10</code> chỉ với 2 hàm trên.</p>
<p>Trước khi đi tiếp, tôi khuyên bạn hãy dừng lại và nghĩ một chút. Không có gì nghiêm trọng cả, chỉ đơn giản là dừng lại và thử ngẫm nghĩ một chút thôi.</p>
<p>Ok, nếu bạn đã bỏ thời gian suy nghĩ, thì <em>có thể</em> bạn đã nghĩ đến giải pháp như dưới đây:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- This is wrong !!!!</span><br><span class="line">mult5AfterAdd10 =</span><br><span class="line">    (mult5 &lt;&lt; add) 10</span><br></pre></td></tr></table></figure>
<p>Nhưng thực tế nó sẽ không hoạt động. Vì sao? Vì hàm <code>add</code> cần hai - hai chứ không phải một tham số.</p>
<p>Nếu trong Elm nhìn có vẻ không hiển nhiên, chúng ta sẽ quay lại với phiên bản Javascript:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var mult5AfterAdd10 = mult5(add(10)); // cái này không hoạt động</span><br></pre></td></tr></table></figure>
<p>Đoạn code này không đúng, nhưng lý do là vì sao?</p>
<p>Nguyên nhân là vì hàm <code>add</code> chỉ lấy 1 trong 2 tham số để tính toán, tạo ra kết quả sai, mà <em>kết quả sai</em> đó sẽ được truyền sang hàm <code>mult5</code>, dẫn đến kết quả cuối cùng không đúng.</p>
<p>Trong thực tế, với Elm, bộ biên dịch - compiler sẽ không bao giờ bỏ qua những dòng code sai định dạng như trên (và đó là một trong những điểm tuyệt vời của Elm).</p>
<p>Chúng ta có thể viết lại như sau :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var mult5AfterAdd10 = y =&gt; mult5(add(10, y)); // not point-free</span><br></pre></td></tr></table></figure>
<p>Đây không phải là cách viết hàm theo phong cách <em>point-free</em>, nhưng ít ra thì nó sẽ đảm bảo được kết quả đúng. Nhưng giờ thì ta không thể dùng toán tử kết hợp các hàm lại thành hàm hợp nữa (là phần <code>&lt;&lt;</code>). Thay vì thế ta đang tạo ra một hàm mới. Sau này nếu kịch bản trở nên phức tạp hơn, ví dụ như muốn kết hợp hàm <code>mult5AfterAdd10</code> với một cái gì đó khác, lúc này mọi thứ sẽ trở nên thực sự rắc rối.</p>
<p>Vì thế khi chúng ta không thể kết hợp hai hàm ở trên, có một điều ta nhận thấy rõ ràng là <strong>Hàm hợp</strong> có sự hạn chế nhất định. Điều đó thật tệ vì <strong>Hàm hợp</strong> là một concept khá mạnh mẽ.</p>
<p>Vậy làm thế nào để chúng ta giải quyết vấn đề trên? Chúng ta cần thứ gì để có thể thổi bay sự rắc rối này?</p>
<p>Giả sử chúng ta có thể làm cách nào đó để chỉ truyền cho hàm <code>add</code> một giá trị tham số <em>trước tiên</em> (khi tạo hàm hợp) , và tham số thứ 2 sẽ được truyền vào <em>sau đó</em> khi thực hiện hàm hợp - ở đây là lúc hàm <code>mult5AfterAdd10</code> được gọi, chẳng phải vấn đề ở trên sẽ dễ dàng được giải quyết sao.</p>
<p>Và thực tế là cách đó có tồn tại, với tên gọi là <strong>Currying</strong>.</p>
<h2 id="Dau-cua-toi"><a href="#Dau-cua-toi" class="headerlink" title="Đầu của tôi!!!!"></a>Đầu của tôi!!!!</h2><p><img src="https://viblo.asia/uploads/3cb3a723-1140-4d4c-abc8-9da098acc7d6.png" alt=""></p>
<p>Hôm nay đến đây thôi là đủ.</p>
<p>Trong các phần sau của bài viết này, tôi sẽ nói về các vấn đề như là <em>Currying, các functional functions cơ bản (như là map, filter, fold,… ), Referential Transparency và một vài thứ nữa</em></p>
<p>Nếu bạn muốn tham gia vào cộng đồng các nhà phát triển web muốn học và giúp đỡ lẫn nhau về FP trong Elm, mời các bạn tham gia Group Facebook sau: <a href="https://www.facebook.com/groups/learnelm/" target="_blank" rel="noopener">Learn Elm Programming</a></p>
<p>Và đây là Twitter của tác giả : <a href="https://twitter.com/cscalfani" target="_blank" rel="noopener">@cscalfani</a></p>
<span>Source: </span><a href="https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-3-1b0fd14eb1a7#.8rfx2iaro" target="_blank" title="https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-3-1b0fd14eb1a7#.8rfx2iaro" class="post-from">https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-3-1b0fd14eb1a7#.8rfx2iaro</a></div></div></article></div></section><div class="wrap"><footer><div class="paginator"><a href="/2017/08/Tro-thanh-Functional-Programmer-Phan-4.html" class="prev">NEXT</a><a href="/2017/08/Tro-thanh-Functional-Programmer-Phan-2.html" class="next">PREV</a></div><div class="copyright"><p>© 2017 - 2018 <a href="http://nthung2112.github.io">Hung Tan Nguyen</a>, unless otherwise noted.</p></div></footer></div><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-41935289-1",'auto');ga('send','pageview');</script><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script><script src="/js/zoom.js"></script><script src="/js/insight.js"></script></body></html>