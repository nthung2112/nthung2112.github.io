<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title> Tìm hiểu về call, apply và bind · Learn and Share</title><meta name="description" content="Tìm hiểu về call, apply và bind - Hung Tan Nguyen"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#FB4D42"><meta name="google-site-verification" content="rk-Nc1c8xi1CdZ0ZQIVV-ifsndGrHanIuSHI-yTHZYE"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/zoom.css"><meta property="og:title" content="Tìm hiểu về call, apply và bind"><meta property="og:image"><meta property="og:description" content="Như trong bài về từ khóa this đã đề cập tới ngữ cảnh thực thi với mối tương quan tới từ khóa this và việc thay đổi được ngữ cảnh thực thi một cách trực tiếp bằng cách sử dụng call, apply và bind, thì bài viết này sẽ làm rõ ràng hơn 3 phương thức này và sự khác nhau cũng như tính hữu dụng của nó.
Về cơ bản call và apply gần giống nhau và được giới thiệu từ phiên bản 3 theo chuẩn ECMAScript, còn bind được giới thiệu từ phiên bản 5 thì lại khác hẳn về bản chất nhưng cũng có mối quan hệ mật thiết với 2 phương thức kia. Vậy nên trong bài này ta sẽ đi dần từ call với apply tới bind."></head><body><div class="wrap"><div class="header"><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nthung2112" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item search-form-input"><div class="search-icon"><div class="search-icon__circle"></div><div class="search-icon__rectangle"></div></div></li></ul><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" placeholder="Type something..." class="ins-search-input"><span class="ins-close ins-selectable"><div class="close-icon"><div class="close-icon__x"></div><div class="close-icon__y"></div></div></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>var rootUrl = "/";
var contentUrl = '/content.json';
(function (window) {
  var INSIGHT_CONFIG = {
  TRANSLATION: {
      POSTS:'Posts',
      PAGES: 'Pages',
      CATEGORIES: 'Categories',
      TAGS: 'Tags',
      UNTITLED: '(Untitled)'
    },
    ROOT_URL: rootUrl,
    CONTENT_URL: contentUrl,
  };
  window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);</script></div></div><section class="container"><div class="post"><article class="post-block"><div class="wrap"><h1 class="post-title">Tìm hiểu về call, apply và bind</h1><h2 class="post-subtitle"></h2><header class="post-info">Jan 10, 2017<div class="tags"><a href="/tags/javascript" class="tag-link">#javascript</a><a href="/tags/call" class="tag-link">#call</a><a href="/tags/apply" class="tag-link">#apply</a><a href="/tags/bind" class="tag-link">#bind</a></div><div class="fb-ir-time"><time dateTime="2017-01-10T12:57:42.000Z" class="op-modified"></time><time dateTime="2017-01-10T12:57:42.000Z" class="op-published"></time></div></header></div><div class="wrap"><div class="post-content"><p>Như trong bài về từ khóa <code>this</code> đã đề cập tới ngữ cảnh thực thi với mối tương quan tới từ khóa <code>this</code> và việc thay đổi được ngữ cảnh thực thi một cách trực tiếp bằng cách sử dụng <code>call</code>, <code>apply</code> và <code>bind</code>, thì bài viết này sẽ làm rõ ràng hơn 3 phương thức này và sự khác nhau cũng như tính hữu dụng của nó.</p>
<p>Về cơ bản <code>call</code> và <code>apply</code> gần giống nhau và được giới thiệu từ phiên bản 3 theo chuẩn ECMAScript, còn <code>bind</code> được giới thiệu từ phiên bản 5 thì lại khác hẳn về bản chất nhưng cũng có mối quan hệ mật thiết với 2 phương thức kia. Vậy nên trong bài này ta sẽ đi dần từ <code>call</code> với <code>apply</code> tới <code>bind</code>.<br><a id="more"></a></p>
<h3 id="1-Call-va-Apply"><a href="#1-Call-va-Apply" class="headerlink" title="1. Call và Apply"></a>1. Call và Apply</h3><p>Cú pháp:</p>
<ul>
<li><p>call()</p>
<blockquote>
<p>Function.prototype.call(thisArg[, arg1[ , arg2, …]])</p>
</blockquote>
</li>
<li><p>apply()</p>
<blockquote>
<p>Function.prototype.apply(thisArg, argArray)</p>
</blockquote>
</li>
</ul>
<p>Phương thức <code>call()</code> và <code>apply()</code> để <strong><em>gọi thực thi</em></strong> một hàm với một ngữ cảnh chỉ định thông qua tham số <code>thisArg</code> và các tham số đầu vào của hàm tương ứng. Tức là nó sẽ cho phép hàm thực thi được với một ngữ cảnh chỉ định nào đó tuỳ ý. Sự khác nhau giữa chúng là <code>call()</code> sẽ nhận tham số hàm qua từng biến đầu vào riêng biệt còn <code>apply()</code> thì lại nhận các tham số hàm qua một mảng chứa các biến đầu vào. Ta cùng xét ví dụ bên dưới:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    firstName: <span class="string">"Vô"</span>,</span><br><span class="line">    lastName : <span class="string">"Danh"</span>,</span><br><span class="line"></span><br><span class="line">    mMethod: <span class="function"><span class="keyword">function</span>(<span class="params">firstName, lastName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> firstName = firstName || <span class="keyword">this</span>.firstName</span><br><span class="line">        <span class="keyword">var</span> lastName = lastName || <span class="keyword">this</span>.lastName</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hello "</span> + firstName + <span class="string">" "</span> + lastName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    firstName: <span class="string">"Ông"</span>,</span><br><span class="line">    lastName : <span class="string">"Ké"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.mMethod() <span class="comment">// Hello Vô Danh</span></span><br><span class="line"></span><br><span class="line">obj.mMethod.call(obj1) <span class="comment">// Hello Ông Ké</span></span><br><span class="line"></span><br><span class="line">obj.mMethod.apply(obj1) <span class="comment">// Hello Ông Ké</span></span><br><span class="line"> </span><br><span class="line">obj.mMethod.call(obj1, <span class="string">"Thị"</span>, <span class="string">"Nở"</span>) <span class="comment">// Hello Thị Nở</span></span><br><span class="line"></span><br><span class="line">obj.mMethod.apply(obj1, [<span class="string">"Chí"</span>, <span class="string">"Phèo"</span>]) <span class="comment">// Hello Chí Phèo</span></span><br></pre></td></tr></table></figure>
<p>Với đoạn mã trên ta có thể thấy rằng, sau khi gọi <code>call()</code> hoặc <code>apply()</code> ngữ cảnh thực thi của <code>mMethod</code> đã được đổi sang <code>obj1</code> và <code>call()</code> cho phép ta truyền tham số đầu vào riêng biệt còn <code>apply()</code> lại cho phép truyền vào như một mảng.</p>
<p>Từ phiên bản 5, <code>apply()</code> còn có thể được truyền vào một đối tượng tựa mảng (chú thích [1]) thay vì mảng:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    firstName: <span class="string">"Vô"</span>,</span><br><span class="line">    lastName : <span class="string">"Danh"</span>,</span><br><span class="line"></span><br><span class="line">    mMethod: <span class="function"><span class="keyword">function</span>(<span class="params">firstName, lastName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> firstName = firstName || <span class="keyword">this</span>.firstName</span><br><span class="line">        <span class="keyword">var</span> lastName = lastName || <span class="keyword">this</span>.lastName</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hello "</span> + firstName + <span class="string">" "</span> + lastName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    firstName: <span class="string">"Ông"</span>,</span><br><span class="line">    lastName : <span class="string">"Ké"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.mMethod.apply(obj1, [<span class="string">"Chí"</span>, <span class="string">"Phèo"</span>]) <span class="comment">// Hello Chí Phèo</span></span><br><span class="line"></span><br><span class="line">obj.mMethod.apply(obj1, &#123;<span class="string">'length'</span>: <span class="number">2</span>, <span class="string">'0'</span>: <span class="string">"Chí"</span>, <span class="string">'1'</span>: <span class="string">"Phèo"</span>&#125;) <span class="comment">// Hello Chí Phèo</span></span><br></pre></td></tr></table></figure>
<p>Với việc sử dụng <code>call()</code> hoặc <code>apply()</code> ta có thể làm được rất nhiều việc hay ho như sử dụng phương thức của một ngữ cảnh khác như ở ví dụ trên, hay đẩy ngữ cảnh thực thi cho hàm phản hồi hoặc thay đổi cách truyền tham số hàm rất hiểu quả. Các bạn có thể xem ở ví dụ sau:</p>
<ul>
<li>Truyền ngữ cảnh thực thi cho hàm phản hồi</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.mVal)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    mVal: <span class="string">"Tôi yêu thành phố Hồ Chí Minh"</span>,</span><br><span class="line"></span><br><span class="line">    mMethod: <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// truyền đối tượng hiện tại cho hàm phản hồi callback</span></span><br><span class="line">        callback.call(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.mMethod(print)</span><br></pre></td></tr></table></figure>
<ul>
<li>Thay đổi cách truyền tham số hàm<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Math.min([value1[,value2[, ...]]])</span></span><br><span class="line"><span class="comment">// Ta sử dụng mảng cho tham số đầu vào thay vì các giá trị rời rạc</span></span><br><span class="line"><span class="built_in">console</span>.log (<span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, [<span class="number">100</span>, <span class="number">-1</span>, <span class="number">8</span>, <span class="number">219</span>])) <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Cũng không tồi đấy chứ, bằng <code>call</code>, <code>apply</code> ta có thể linh hoạt hơn khi lập trình, đỡ được nhiều công sức biến đổi rắc rối và tận dụng được mã nguồn rất hiệu quả.</p>
<h3 id="2-Bind"><a href="#2-Bind" class="headerlink" title="2. Bind"></a>2. Bind</h3><p>Cú pháp:</p>
<blockquote>
<p>Function.prototype.bind( thisArg[, arg1[ , arg2, …]])</p>
</blockquote>
<p>Phương thức <code>bind()</code> sẽ <strong><em>tạo</em></strong> ra một <strong><em>hàm mới</em></strong> có nội dung thực thi như hàm được gọi nhưng được gắn với một ngữ cảnh thực thi chỉ định qua tham số <code>thisArg</code>. Như vậy khác với <code>call()</code> và <code>apply()</code>, <code>bind()</code> sẽ không gọi để thực thi hàm mà sẽ lưu lại ngữ cảnh thực thi cho một hàm nào đó như ví dụ sau:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    mVal: <span class="string">"Việt Nam"</span>,</span><br><span class="line"> </span><br><span class="line">    mMethod: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hello "</span> + <span class="keyword">this</span>.mVal)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> oMethod = obj.mMethod.bind(obj) <span class="comment">// this trong oMethod sẽ bị ép thành giá trị obj</span></span><br><span class="line"></span><br><span class="line">oMethod() <span class="comment">// Hello Việt Nam</span></span><br><span class="line"></span><br><span class="line">obj.mVal = <span class="string">"Hà Nội"</span></span><br><span class="line"> </span><br><span class="line">oMethod() <span class="comment">// Hello Hà Nội</span></span><br></pre></td></tr></table></figure>
<p>Như vậy khác với <code>call()</code> và <code>apply()</code>, khi gọi <code>bind()</code> hàm sẽ không thực thi ngay mà chỉ gắn ngữ cảnh thực thi cho phương thức mMethod. Vì <code>mMethod</code> được gắn với ngữ cảnh đối tượng <code>obj</code>, nên mỗi lần thực thi nó sẽ sử dụng <code>this</code> như là đối tượng <code>obj</code>. Như trong ví dụ phía trên, sau khi ta thay đổi giá trị của biến <code>mVal</code> trong đối tượng <code>obj</code> thì <code>mMethod</code> cũng sẽ in ra giá trị đã bị thay đổi.</p>
<p>Về bản chất thì <code>bind()</code> có thể được thực hiện như sau:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        _this.apply(context, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Bằng việc sử dụng <code>apply()</code>, ta có thể thay đổi ngữ cảnh thực thi cho một hàm, còn để lưu lại ngữ cảnh dành cho việc thực thi sau này ta tạo ra một hàm mới như trong đoạn mã trên.</p>
<p>Vì tính chất lưu lại được ngữ cảnh nên <code>bind()</code> rất hay được sử dụng với hàm phản hồi như xử lý sự kiện click vào một nút nào đó chẳng hạn. Ví dụ như khi sử dụng jQuery, ta có thể lấy được giá trị cho <code>this</code> bằng <code>button</code> trong các hàm phản hồi của sự kiện <code>click</code> vào một <code>button</code> vì jQuery đều đã buộc (bind) sẵn <code>button</code> cho hàm phản hồi được truyền vào.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">"#btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span></span><br><span class="line"><span class="javascript">        $(<span class="keyword">this</span>).text(<span class="built_in">Number</span>($(<span class="keyword">this</span>).text()) + <span class="number">1</span>)</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Ngoài ra, ta có thể làm được rất nhiều việc khá hay ho như tạo shortcut cho hàm nào đó, hay nhóm lại các tham số theo từng cụm như ví dụ bên dưới:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    firstName: <span class="string">"Thánh"</span>,</span><br><span class="line">    lastName: <span class="string">"Gióng"</span>,</span><br><span class="line"></span><br><span class="line">    mMethod: <span class="function"><span class="keyword">function</span>(<span class="params">hello, firstName, lastName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> hello = hello || <span class="string">"Hello"</span></span><br><span class="line">           ,firstName = firstName || <span class="keyword">this</span>.firstName</span><br><span class="line">           ,lastName = lastName || <span class="keyword">this</span>.lastName</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(hello + <span class="string">" "</span> + firstName + <span class="string">" "</span> + lastName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tạo shortcut</span></span><br><span class="line"><span class="keyword">var</span> print = obj.mMethod.bind(obj)</span><br><span class="line">print()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> print = obj.mMethod.bind(obj, <span class="string">"Hello"</span>, <span class="string">"Mr"</span>, <span class="string">"Bean"</span>)</span><br><span class="line">print()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Nhóm theo hello</span></span><br><span class="line">print = obj.mMethod.bind(obj, <span class="string">"Xin chào bạn"</span>)</span><br><span class="line">print()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Nhóm theo firstName</span></span><br><span class="line">print = obj.mMethod.bind(obj, <span class="string">"Kính chào ngài"</span>, <span class="string">"Nguyễn"</span>)</span><br><span class="line">print(<span class="string">"Trãi"</span>)</span><br><span class="line">print(<span class="string">"Xiển"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="3-Vui-ve-ty"><a href="#3-Vui-ve-ty" class="headerlink" title="3. Vui vẻ tý"></a>3. Vui vẻ tý</h3><p>Như bên trên đã phân tích, khi ta cần thực thi một function cho một ngữ cảnh khác, ta cần sử dụng <code>call</code>, <code>apply</code> hoặc <code>bind</code>, nhưng có một cách vượt mặt để không cần sử dụng nó. Bạn có thể xem ví dụ sau:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    firstName: <span class="string">"Vô"</span>,</span><br><span class="line">    lastName : <span class="string">"Danh"</span>,</span><br><span class="line"></span><br><span class="line">    mMethod: <span class="function"><span class="keyword">function</span>(<span class="params">firstName, lastName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> firstName = firstName || <span class="keyword">this</span>.firstName</span><br><span class="line">        <span class="keyword">var</span> lastName = lastName || <span class="keyword">this</span>.lastName</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hello "</span> + firstName + <span class="string">" "</span> + lastName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    firstName: <span class="string">"Ông"</span>,</span><br><span class="line">    lastName : <span class="string">"Ké"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.mMethod.apply(obj1) <span class="comment">// Hello Ông Ké</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// vượt mặt ở đây</span></span><br><span class="line"><span class="keyword">var</span> method = <span class="built_in">Function</span>.call.bind(obj.mMethod)</span><br><span class="line"></span><br><span class="line">method(obj1) <span class="comment">// Hello Ông Ké</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// vượt mặt trong prototype của object</span></span><br><span class="line">method = <span class="built_in">Function</span>.call.bind(<span class="built_in">Array</span>.prototype.slice)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(method([<span class="number">100</span>, <span class="number">20</span>, <span class="number">40</span>], <span class="number">1</span>)) <span class="comment">// [20, 40]</span></span><br></pre></td></tr></table></figure>
<p>Với đoạn mã trên, ta có thế thấy rằng khi gọi <code>method</code> ta không cần phải gọi <code>call</code>, <code>apply</code> hay <code>bind</code> ra nữa mà chỉ cần đẩy trực tiếp đối tượng cần gọi và tham số vào là đủ. Khá hay ho đấy chứ? gọi <code>call</code>, <code>apply</code>, <code>bind</code> mãi cũng chán, overcome một tý thấy nó tiện hơn hẳn.</p>
<p>Ta có thể làm được như vậy là vì tất cả các function trong JavaScript đều kế thừa từ đối tượng <code>Function.prototype</code>, nên hiển nhiên nó có tất cả các function được định nghĩa từ <code>Function.prototype</code> như <code>call</code>, <code>apply</code> hay <code>bind</code>. Như vậy, ta hoàn toàn có thể gọi được các phương thức kế thừa này từ một function bất kì.</p>
<p>Với ví dụ trên, ta coi <code>obj.mMethod</code> là một đối tượng cần gọi tới phương thức <code>call</code> thì ta hoàn toàn có thể tạo một phương thức <code>method</code> trực tiếp từ phương thức <code>call</code> mà đã được gắn <code>thisVal</code> bằng <code>obj.mMethod</code>: <code>Function.call.bind(obj.mMethod)</code> hoặc <code>Function.prototype.call.bind(obj.mMethod)</code>. Hay nói cách khác, phương thức <code>method</code> mới được tạo ra có nội dung giống như phương thức <code>call</code> và đối tượng chứa nó (gọi nó - <code>this</code>) là đối tượng <code>obj.mMethod</code> nên <code>method()</code> ~ <code>obj.mMethod.call()</code>.</p>
<h3 id="4-Ket-luan"><a href="#4-Ket-luan" class="headerlink" title="4. Kết luận"></a>4. Kết luận</h3><p>Bằng việc sử dụng <code>call</code>, <code>apply</code> và <code>bind</code> ta có thể thay đổi được ngữ cảnh thực thi (phạm vi chứa hàm) để sử dụng một hàm với công dụng đa năng hơn như thực thi cho một đối tượng, phạm vi khác khác giúp ta có thể tận dụng tối đa mã nguồn được đã tạo ra, hay tạo shortcut cho hàm, linh hoạt hơn tham số đầu vào. Với <code>call</code> và <code>apply</code> chúng ta sử dụng để thực thi hàm đó luôn khi gọi, còn với <code>bind</code> ta có thể thực thi hàm đó nhiều lần sau khi đã được buộc (bind) với một ngữ cảnh nhất định.</p>
<p><strong><em>Chú thích</em></strong><br>[1] đối tượng tựa mảng: Một đối tượng tựa mảng (array-like object) là một đối tượng có các thuộc tính là số tự nhiên và có một thuộc tính bắt buộc là <code>length</code> có giá trị bằng số các thuộc tính là số tự nhiên. Ví dụ: <code>{length: 3, 0: &quot;Tôi&quot;, 1: &quot;là&quot;, 2: &quot;người Việt&quot;}</code> hoặc <code>{&#39;length&#39;: 3, &#39;0&#39;: &quot;Tôi&quot;, &#39;1&#39;: &quot;là&quot;, &#39;2&#39;: &quot;người Việt&quot;}</code>.</p>
</div></div></article></div></section><div class="wrap"><footer><div class="paginator"><a href="/2017/01/Javascript-Bat-ngo-ve-mang-trong-javascript.html" class="prev">NEXT</a><a href="/2017/01/Javascript-Tim-hieu-ve-tu-khoa-this.html" class="next">PREV</a></div><div class="copyright"><p>© 2017 - 2018 <a href="http://nthung2112.github.io">Hung Tan Nguyen</a>, unless otherwise noted.</p></div></footer></div><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-41935289-1",'auto');ga('send','pageview');</script><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script><script src="/js/zoom.js"></script><script src="/js/insight.js"></script></body></html>