<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title> How to Create a Reddit Clone Using React and Firebase · Learn and Share</title><meta name="description" content="How to Create a Reddit Clone Using React and Firebase - Hung Tan Nguyen"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#FB4D42"><meta name="google-site-verification" content="rk-Nc1c8xi1CdZ0ZQIVV-ifsndGrHanIuSHI-yTHZYE"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/zoom.css"><meta property="og:title" content="How to Create a Reddit Clone Using React and Firebase"><meta property="og:image"><meta property="og:description" content="React is an awesome JavaScript library for building user interfaces. Since the publishing of Create React App, it has become very easy to scaffold a barebones React application.
In this article, we will be using Firebase along with Create React App to build an app which will function similar to Reddit. It will allow the user to submit a new link which can then be voted on.
Here’s a live demo of what we’ll be building."></head><body><div class="wrap"><div class="header"><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nthung2112" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item search-form-input"><div class="search-icon"><div class="search-icon__circle"></div><div class="search-icon__rectangle"></div></div></li></ul><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" placeholder="Type something..." class="ins-search-input"><span class="ins-close ins-selectable"><div class="close-icon"><div class="close-icon__x"></div><div class="close-icon__y"></div></div></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>var rootUrl = "/";
var contentUrl = '/content.json';
(function (window) {
  var INSIGHT_CONFIG = {
  TRANSLATION: {
      POSTS:'Posts',
      PAGES: 'Pages',
      CATEGORIES: 'Categories',
      TAGS: 'Tags',
      UNTITLED: '(Untitled)'
    },
    ROOT_URL: rootUrl,
    CONTENT_URL: contentUrl,
  };
  window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);</script></div></div><section class="container"><div class="post"><article class="post-block"><div class="wrap"><h1 class="post-title">How to Create a Reddit Clone Using React and Firebase</h1><h2 class="post-subtitle"></h2><header class="post-info">Jul 23, 2017<div class="tags"><a href="/tags/react" class="tag-link">#react</a><a href="/tags/firebase" class="tag-link">#firebase</a></div><div class="fb-ir-time"><time dateTime="2017-07-23T09:48:27.000Z" class="op-modified"></time><time dateTime="2017-07-23T09:48:27.000Z" class="op-published"></time></div></header></div><div class="wrap"><div class="post-content"><p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/07/1500496188eddit_clone_using_Create_React_App_and_FirebaseA.jpg-01.png" alt="An inventor placing a FireBase heart into a robot creation"></p>
<p><a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> is an awesome JavaScript library for building user interfaces. Since the publishing of <a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="noopener">Create React App</a>, it has become very easy to scaffold a barebones React application.</p>
<p>In this article, we will be using <a href="https://firebase.google.com/" target="_blank" rel="noopener">Firebase</a> along with Create React App to build an app which will function similar to <a href="https://www.reddit.com/" target="_blank" rel="noopener">Reddit</a>. It will allow the user to submit a new link which can then be voted on.</p>
<p>Here’s a <a href="https://sitepoint-editors.github.io/reddit-clone/" target="_blank" rel="noopener">live demo</a> of what we’ll be building.</p>
<a id="more"></a>
<h2 id="Why-Firebase"><a href="#Why-Firebase" class="headerlink" title="Why Firebase?"></a>Why Firebase?</h2><p>Using Firebase will make it very easy for us to show real-time data to the user. Once a user votes on a link, the feedback will be instantaneous. Firebase’s Realtime Database will help us in developing this feature. Also, it will help us to understand how to bootstrap a React application with Firebase.</p>
<h2 id="Why-React"><a href="#Why-React" class="headerlink" title="Why React?"></a>Why React?</h2><p>React is particularly known for creating user interfaces using a component architecture. Each component can contain internal <a href="https://facebook.github.io/react/docs/state-and-lifecycle.html" target="_blank" rel="noopener">state</a> or be passed data as <a href="https://facebook.github.io/react/docs/components-and-props.html" target="_blank" rel="noopener">props</a>. State and props are the two most important concepts in React. These two things help us determine the state of our application at any point in time. If you are not familiar with these terms, please head over to the <a href="https://facebook.github.io/react/docs/hello-world.html" target="_blank" rel="noopener">React docs</a> first.</p>
<blockquote>
<p><strong>Note:</strong> You can also use a state container like <a href="http://redux.js.org/" target="_blank" rel="noopener">Redux</a> or <a href="https://mobx.js.org/" target="_blank" rel="noopener">MobX</a>, but for the sake of simplicity, we won’t be using one for this tutorial.</p>
</blockquote>
<p>The whole project is <a href="https://github.com/sitepoint-editors/reddit-clone" target="_blank" rel="noopener">available on Github</a>.</p>
<p>By the way, for a high-quality, in-depth introduction to React, you can’t go past Canadian full-stack developer Wes Bos. <a href="https://ReactForBeginners.com/friend/SITEPOINT" target="_blank" rel="noopener">Try his course</a>, and use the coupon code ‘SITEPOINT’ to get 25% off and to help support SitePoint.</p>
<h2 id="Setting-up-the-project"><a href="#Setting-up-the-project" class="headerlink" title="Setting up the project"></a>Setting up the project</h2><p>Let’s walk through the steps to set up our project structure and any necessary dependencies.</p>
<h3 id="Installing-create-react-app"><a href="#Installing-create-react-app" class="headerlink" title="Installing create-react-app"></a>Installing create-react-app</h3><p>If you haven’t already, you need to install <strong>create-react-app</strong>. To do so, you can type the following in your terminal:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-react-app</span><br></pre></td></tr></table></figure>
<p>Once you’ve installed it globally, you can use it to scaffold a React project inside any folder.</p>
<p>Now, let’s create a new app and call it <strong>reddit-clone</strong>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create-react-app reddit-clone</span><br></pre></td></tr></table></figure>
<p>This will scaffold a new <strong>create-react-app</strong> project inside the <strong>reddit-clone</strong> folder. Once the bootstrapping is done, we can go inside <strong>reddit-clone</strong> directory and fire up the development server:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p>At this point, you can go to <a href="http://localhost:3000/" target="_blank" rel="noopener">http://localhost:3000/</a> and see your app skeleton up and running.</p>
<h3 id="Structuring-the-app"><a href="#Structuring-the-app" class="headerlink" title="Structuring the app"></a>Structuring the app</h3><p>For maintenance, I always like to separate my <strong>containers</strong> and <strong>components</strong>. Containers are the smart components which are contains the business logic of our application and manage Ajax requests. Components are simply dumb presentational components. They can have their own internal state which can be used to control the logic of that component (e.g. showing the current state of a <a href="https://facebook.github.io/react/docs/forms.html#controlled-components" target="_blank" rel="noopener">controlled</a> input component).</p>
<p>After removing the unnecessary logo and css files, this is how your app should look like now. We created a <strong>components</strong> folder and a <strong>containers</strong> folder. Let’s move <em>App.js</em> inside the <strong>containers/App</strong> folder and create <em>registerServiceWorker.js</em> inside the <strong>utils</strong> folder.</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1496945149structuring-the-app.png" alt="Structuring the app"></p>
<p>Your <strong>src/containers/App/index.js</strong> file should look like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/App/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">        Hello World</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p>Your <strong>src/index.js</strong> file should look like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./containers/App'</span>;</span><br><span class="line"><span class="keyword">import</span> registerServiceWorker <span class="keyword">from</span> <span class="string">'./utils/registerServiceWorker'</span>;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span>, document.getElementById('root'));</span></span><br><span class="line"><span class="xml">registerServiceWorker();</span></span><br></pre></td></tr></table></figure>
<p>Go to your browser and if every thing works fine you will see <strong>Hello World</strong> on your screen.</p>
<p>You can check my <a href="https://github.com/sitepoint-editors/reddit-clone/commit/0653c7477298aa4a2b341397b28904f03abacfc6" target="_blank" rel="noopener">commit</a> on Github.</p>
<h3 id="Adding-react-router"><a href="#Adding-react-router" class="headerlink" title="Adding react-router"></a>Adding react-router</h3><p><a href="https://github.com/ReactTraining/react-router" target="_blank" rel="noopener">React-router</a> will help us define the routes for our app. It’s very customizable and very popular in the react ecosystem.</p>
<p>We will be using version <strong>3.0.0</strong> of <strong>react-router</strong>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-router@<span class="number">3.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>
<p>Now, add a new file <em>routes.js</em> inside the <em>src</em> folder with the following code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Router, Route &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./containers/App'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Routes = <span class="function">(<span class="params">props</span>) =&gt;</span> (</span><br><span class="line">  &lt;Router &#123;...props&#125;&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/"</span> component=&#123; App &#125;&gt;</span><br><span class="line">    &lt;<span class="regexp">/Route&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>Router&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Routes;</span><br></pre></td></tr></table></figure>
<p>The <code>Router</code> component wraps all the <code>Route</code> components. Based on the <code>path</code> prop of the <code>Route</code> component, the component passed to the <code>component</code> prop, will be rendered on the page. Here, we are setting up the root URL (<code>/</code>) to load our <code>App</code> component using the <code>Router</code> component.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Router &#123;...props&#125;&gt;</span><br><span class="line">  &lt;Route path=&quot;/&quot; component=&#123; &lt;div&gt;Hello World!&lt;/div&gt; &#125;&gt;</span><br><span class="line">  &lt;/Route&gt;</span><br><span class="line">&lt;/Router&gt;</span><br></pre></td></tr></table></figure>
<p>The above code is also valid. For the path <code>/</code>, the <code>&lt;div&gt;Hello World!&lt;/div&gt;</code> will be mounted.</p>
<p>Now, we need to call our <strong>routes.js</strong> file from our <strong>src/index.js</strong> file. The file should have the following content:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; browserHistory &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./containers/App'</span>;</span><br><span class="line"><span class="keyword">import</span> Routes <span class="keyword">from</span> <span class="string">'./routes'</span>;</span><br><span class="line"><span class="keyword">import</span> registerServiceWorker <span class="keyword">from</span> <span class="string">'./utils/registerServiceWorker'</span>;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Routes history=&#123;browserHistory&#125; /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">registerServiceWorker();</span><br></pre></td></tr></table></figure>
<p>Basically, we are mounting our <code>Router</code> component from our <strong>routes.js</strong> file. We pass in the <code>history</code> prop to it so that the routes know how to handle <a href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router/docs/api/history.md#history" target="_blank" rel="noopener">history tracking</a>.</p>
<p>You can check my <a href="https://github.com/sitepoint-editors/reddit-clone/commit/80929148bc71d1e16e7fde09fd34469bce142113" target="_blank" rel="noopener">commit</a> on Github.</p>
<h3 id="Adding-Firebase"><a href="#Adding-Firebase" class="headerlink" title="Adding Firebase"></a>Adding Firebase</h3><p>If you don’t have a <a href="https://firebase.google.com/" target="_blank" rel="noopener">Firebase</a> account, create one now (it’s free!) by going to their website. After you’re done creating a new account, log into your account and go to the <a href="https://console.firebase.google.com/" target="_blank" rel="noopener">console</a> page and click on <strong>Add project</strong>.</p>
<p>Enter the name of your project (I’ll call mine <strong>reddit-clone</strong>), choose your country, and click on the <strong>Create project</strong> button.</p>
<p>Now, before we proceed we need to change the <strong>rules</strong> for the database since, by default, Firebase expects the user to be authenticated to be able to read and write data. If you select your project and click on the <strong>Database</strong> tab on the left, you will be able to see your database. You need to click on the <strong>Rules</strong> tab on the top that will redirect us to a screen which will have the following data:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"rules"</span>: &#123;</span><br><span class="line">    <span class="attr">".read"</span>: <span class="string">"auth != null"</span>,</span><br><span class="line">    <span class="attr">".write"</span>: <span class="string">"auth != null"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We need to change this to the following:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"rules"</span>: &#123;</span><br><span class="line">    <span class="attr">".read"</span>: <span class="string">"auth === null"</span>,</span><br><span class="line">    <span class="attr">".write"</span>: <span class="string">"auth === null"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This will let users update the database without logging in. If we implemented a flow in which we had authentication before making updates to the database, then we would need the default rules provided by Firebase. To keep this application simple, we <em>won’t</em> be doing authentication.</p>
<blockquote>
<p><strong>Important:</strong> If you don’t make this modification, Firebase won’t let you update the database from your app.</p>
</blockquote>
<p>Now, let’s add the <code>firebase</code> npm module to our app by running the following code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save firebase</span><br></pre></td></tr></table></figure>
<p>Next, import that module in your <strong>App/index.js</strong> file as:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> firebase <span class="keyword">from</span> <span class="string">"firebase"</span>;</span><br></pre></td></tr></table></figure>
<p>When we select our project after logging into Firebase, we will get an option <strong>Add Firebase to your web app</strong>.</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1497022354Screen-Shot-2017-06-09-at-21.04.10.png" alt="Add Firebase to your web app"></p>
<p>If we click on that option, a modal will appear which will show us the <strong>config</strong> variable which we will use in our <code>componentWillMount</code> method.</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1497022441Screen-Shot-2017-06-09-at-21.06.23.png" alt="Configs"></p>
<p>Let’s create the Firebase config file. We shall call this file <strong>firebase-config.js</strong> and this file will contain all the configs necessary to connect our app with Firebase.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App/firebase-config.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  apiKey: <span class="string">"AIzaSyBRExKF0cHylh_wFLcd8Vxugj0UQRpq8oc"</span>,</span><br><span class="line">  authDomain: <span class="string">"reddit-clone-53da5.firebaseapp.com"</span>,</span><br><span class="line">  databaseURL: <span class="string">"https://reddit-clone-53da5.firebaseio.com"</span>,</span><br><span class="line">  projectId: <span class="string">"reddit-clone-53da5"</span>,</span><br><span class="line">  storageBucket: <span class="string">"reddit-clone-53da5.appspot.com"</span>,</span><br><span class="line">  messagingSenderId: <span class="string">"490290211297"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>We’ll import our Firebase config into <strong>App/index.js</strong>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'./firebase-config'</span>;</span><br></pre></td></tr></table></figure>
<p>We will initialize our Firebase database connection in the <code>constructor</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">constructor</span>() &#123;</span><br><span class="line">  <span class="keyword">super</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Initialize Firebase</span></span><br><span class="line">  firebase.initializeApp(config);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the <code>componentWillMount()</code> lifecycle hook, we use the package <code>firebase</code> we just installed and call its <code>initializeApp</code> method and passed the <code>config</code> variable to it. This object contains all the data about our app. The <code>initializeApp</code> method will connect our application to our Firebase database so that we can read and write data.</p>
<p>Let’s add some data to Firebase to check if our configuration is correct. Go to the <em>Database</em> tab and add the following structure to your database:</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1496945151test-data.png" alt="Test data"></p>
<p>Clicking on <em>Add</em> will save the data to our database.</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1496945145demo-data.png" alt="Demo data"></p>
<p>Now, let’s add some code to our <strong>componentWillMount</strong> method to make the data appear on our screen.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App/index.js</span></span><br><span class="line"></span><br><span class="line">componentWillMount() &#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> postsRef = firebase.database().ref(<span class="string">'posts'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    postsRef.on(<span class="string">'value'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">snapshot</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(snapshot.val());</span><br><span class="line"></span><br><span class="line">      _this.setState(&#123;</span><br><span class="line">        posts: snapshot.val(),</span><br><span class="line">        loading: <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><code>firebase.database()</code> gives us a reference to the database service. Using <code>ref()</code>, we can get a specific reference from the database. For example, if we call <code>ref(&#39;posts&#39;)</code>, we will be getting the <code>posts</code> reference from our database and storing that reference in <code>postsRef</code>.</p>
<p><code>postsRef.on(&#39;value&#39;, ...)</code> gives us the updated value whenever there is any change in the database. This is very useful when we need a real-time update to our user interface based on any database events.</p>
<p>Using <code>postsRef.once(&#39;value&#39;, ...)</code> will only give us the data once. This is useful for data that only needs to be loaded once and isn’t expected to change frequently or require active listening.</p>
<p>After we get the updated value in our <code>on()</code> callback, we store the values in our <code>posts</code> state.</p>
<p>Now, we will see the data appearing on our console.</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1496945147sample-data.png" alt="Sample data"></p>
<p>Also, we will be passing this data down to our children. So, we need to modify the <code>render</code> function of our <strong>App/index.js</strong> file:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App/index.js</span></span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">      &#123;<span class="keyword">this</span>.props.children &amp;&amp; React.cloneElement(<span class="keyword">this</span>.props.children, &#123;</span><br><span class="line">        firebaseRef: firebase.database().ref(<span class="string">'posts'</span>),</span><br><span class="line">        posts: <span class="keyword">this</span>.state.posts,</span><br><span class="line">        loading: <span class="keyword">this</span>.state.loading</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>This main objective here is to make the posts data available in all our children components which will be passed through <code>react-router</code>.</p>
<p>We are checking if <code>this.props.children</code> exists or not and if it exists we clone that element and pass all our props to all our children. This is a very efficient way of passing props to dynamic children.</p>
<p>Calling <a href="https://facebook.github.io/react/docs/react-api.html#cloneelement" target="_blank" rel="noopener">cloneElement</a> will shallowly merge the already existing props in <code>this.props.children</code> and the props, we passed here (firebaseRef, posts and loading).</p>
<p>Using this technique, the <code>firebaseRef</code>, <code>posts</code> and <code>loading</code> props will be available to all routes.</p>
<p>You can check my <a href="https://github.com/sitepoint-editors/reddit-clone/commit/2c09fc56e503027f5c4a98306816752cee18b48c" target="_blank" rel="noopener">commit</a> on Github.</p>
<h2 id="Connecting-The-App-With-Firebase"><a href="#Connecting-The-App-With-Firebase" class="headerlink" title="Connecting The App With Firebase"></a>Connecting The App With Firebase</h2><p>Firebase can only store data as objects; <a href="https://firebase.googleblog.com/2014/04/best-practices-arrays-in-firebase.html" target="_blank" rel="noopener">it doesn’t have any native support for arrays</a>. We will store the data in the following format:</p>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/06/1496945143database-structure.png" alt="Database structure"></p>
<p>Add the data in the screenshot above manually so that you can test your views.</p>
<h3 id="Add-views-for-all-the-posts"><a href="#Add-views-for-all-the-posts" class="headerlink" title="Add views for all the posts"></a>Add views for all the posts</h3><p>Now, we will add views to show all the posts. Create a file <strong>src/containers/Posts/index.js</strong> with the following content:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/Posts/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Posts</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.props.loading) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          Loading...</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;div className="Posts"&gt;</span></span><br><span class="line"><span class="regexp">        &#123; this.props.posts.map((post) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">            return (</span></span><br><span class="line"><span class="regexp">              &lt;div&gt;</span></span><br><span class="line"><span class="regexp">                &#123; post.title &#125;</span></span><br><span class="line"><span class="regexp">              &lt;/</span>div&gt;</span><br><span class="line">            );</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default Posts;</span></span><br></pre></td></tr></table></figure>
<p>Here, we are just mapping over the data and rendering it to the user interface.</p>
<p>Next, we need to add this to our <strong>routes.js</strong> file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes.js</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">&lt;Router &#123;...props&#125;&gt;</span><br><span class="line">  &lt;Route path=<span class="string">"/"</span> component=&#123; App &#125;&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/posts"</span> component=&#123; Posts &#125; /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Route&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>Router&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>This is because we want the posts to show up only on the <strong>/posts</strong> route. So, we just pass the <code>Posts</code> component to the <code>component</code> prop and <code>/posts</code> to the <code>path</code> prop of the <code>Route</code> component of react-router.</p>
<p>If we go to the URL <a href="http://localhost:3000/posts" target="_blank" rel="noopener">localhost:3000/posts</a>, we will see the posts from our Firebase database.</p>
<p>You can check my <a href="https://github.com/sitepoint-editors/reddit-clone/commit/40591cc8e36f5e65ae477d12307dd7c0d600a38b" target="_blank" rel="noopener">commit</a> on Github.</p>
<h3 id="Add-views-to-write-a-new-post"><a href="#Add-views-to-write-a-new-post" class="headerlink" title="Add views to write a new post"></a>Add views to write a new post</h3><p>Now, let’s create a view from where we can add a new post. Create a file <strong>src/containers/AddPost/index.js</strong> with the following content:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/AddPost/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddPost</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleSubmit = <span class="keyword">this</span>.handleSubmit.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    title: <span class="string">''</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  handleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      title: e.target.value</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSubmit = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.props.firebaseRef.push(&#123;</span><br><span class="line">      title: <span class="keyword">this</span>.state.title</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      title: <span class="string">''</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"AddPost"</span>&gt;</span><br><span class="line">        &lt;input </span><br><span class="line">          type=<span class="string">"text"</span> </span><br><span class="line">          placeholder=<span class="string">"Write the title of your post"</span> </span><br><span class="line">          onChange=&#123; <span class="keyword">this</span>.handleChange &#125; </span><br><span class="line">          value=&#123; <span class="keyword">this</span>.state.title &#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;button </span><br><span class="line">          type=<span class="string">"submit"</span> </span><br><span class="line">          onClick=&#123; <span class="keyword">this</span>.handleSubmit &#125;</span><br><span class="line">        &gt;</span><br><span class="line">          Submit</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> AddPost;</span><br></pre></td></tr></table></figure>
<p>Here, the <code>handleChange</code> method updates our state with the value present in the input box. Now, when we click on the button, the <code>handleSubmit</code> method is triggered. The <code>handleSubmit</code> method is responsible for making the API request to write to our database. We do it using the <code>firebaseRef</code> prop which we passed to all the children.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.props.firebaseRef.push(&#123;</span><br><span class="line">  title: <span class="keyword">this</span>.state.title</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>The above block of code sets the current value of the title to our database.</p>
<p>After the new post has been stored in the database, we make the input box empty again ready to add a new post.</p>
<p>Now, we need to add this page to our routes.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Router, Route &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./containers/App'</span>;</span><br><span class="line"><span class="keyword">import</span> Posts <span class="keyword">from</span> <span class="string">'./containers/Posts'</span>;</span><br><span class="line"><span class="keyword">import</span> AddPost <span class="keyword">from</span> <span class="string">'./containers/AddPost'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Routes = <span class="function">(<span class="params">props</span>) =&gt;</span> (</span><br><span class="line">  &lt;Router &#123;...props&#125;&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/"</span> component=&#123; App &#125;&gt;</span><br><span class="line">      &lt;Route path=<span class="string">"/posts"</span> component=&#123; Posts &#125; /&gt;</span><br><span class="line">      &lt;Route path=<span class="string">"/add-post"</span> component=&#123; AddPost &#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Route&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>Router&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Routes;</span><br></pre></td></tr></table></figure>
<p>Here, we just added the <strong>/add-post</strong> route so that we can add a new post from that route. Hence, we passed the <code>AddPost</code> component to its component prop.</p>
<p>Also, let’s modify the <code>render</code> method of our <strong>src/containers/Posts/index.js</strong> file so that it can iterate over objects instead of arrays (since Firebase doesn’t store arrays).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/Posts/index.js</span></span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">    <span class="keyword">let</span> posts = <span class="keyword">this</span>.props.posts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.props.loading) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          Loading...</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;div className="Posts"&gt;</span></span><br><span class="line"><span class="regexp">        &#123; Object.keys(posts).map(function(key) &#123;</span></span><br><span class="line"><span class="regexp">            return (</span></span><br><span class="line"><span class="regexp">              &lt;div key=&#123;key&#125;&gt;</span></span><br><span class="line"><span class="regexp">                &#123; posts[key].title &#125;</span></span><br><span class="line"><span class="regexp">              &lt;/</span>div&gt;</span><br><span class="line">            );</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br></pre></td></tr></table></figure>
<p>Now, if we go to <a href="http://localhost:3000/add-post" target="_blank" rel="noopener">localhost:3000/add-post</a>, we can add a new post. After clicking on the <em>submit</em> button, the new post will appear immediately on the <a href="http://localhost:3000/posts" target="_blank" rel="noopener">posts page</a>.</p>
<p>You can check my <a href="https://github.com/sitepoint-editors/reddit-clone/commit/c83e09b46989a7fb9ec8d40d8fdadd570fb2eaec" target="_blank" rel="noopener">commit</a> on Github.</p>
<h3 id="Implement-voting"><a href="#Implement-voting" class="headerlink" title="Implement voting"></a>Implement voting</h3><p>Now, we need to allow users to vote on a post. For that, let’s modify the <code>render</code> method of our <strong>src/containers/App/index.js</strong>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/App/index.js</span></span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">      &#123;<span class="keyword">this</span>.props.children &amp;&amp; React.cloneElement(<span class="keyword">this</span>.props.children, &#123;</span><br><span class="line">        <span class="comment">// https://github.com/ReactTraining/react-router/blob/v3/examples/passing-props-to-children/app.js#L56-L58</span></span><br><span class="line">        firebase: firebase.database(),</span><br><span class="line">        posts: <span class="keyword">this</span>.state.posts,</span><br><span class="line">        loading: <span class="keyword">this</span>.state.loading</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>We changed the <code>firebase</code> prop from <code>firebaseRef: firebase.database().ref(&#39;posts&#39;)</code> to <code>firebase: firebase.database()</code> because we will be using Firebase’s <a href="https://firebase.google.com/docs/database/web/read-and-write" target="_blank" rel="noopener"><code>set</code></a> method to update our voting count. In this way, if we had more Firebase refs, it would be very easy for us to handle them by using only the <code>firebase</code> prop.</p>
<p>Before proceeding with the voting, let’s modify the <code>handleSubmit</code> method in our <strong>src/containers/AddPost/index.js</strong> file a little bit:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/AddPost/index.js</span></span><br><span class="line"></span><br><span class="line">handleSubmit = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">this</span>.props.firebase.ref(<span class="string">'posts'</span>).push(&#123;</span><br><span class="line">    title: <span class="keyword">this</span>.state.title,</span><br><span class="line">    upvote: <span class="number">0</span>,</span><br><span class="line">    downvote: <span class="number">0</span></span><br><span class="line">  &#125;);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We renamed our <code>firebaseRef</code> prop to <code>firebase</code> prop. So, we change the <code>this.props.firebaseRef.push</code> to <code>this.props.firebase.ref(&#39;posts&#39;).push</code>.</p>
<p>Now, we need to modify our <strong>src/containers/Posts/index.js</strong> file to accomodate the voting.</p>
<p>The <code>render</code> method should be modified to:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/Posts/index.js</span></span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">let</span> posts = <span class="keyword">this</span>.props.posts;</span><br><span class="line">  <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!posts) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.props.loading) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        Loading...</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div className="Posts"&gt;</span></span><br><span class="line"><span class="regexp">      &#123; Object.keys(posts).map(function(key) &#123;</span></span><br><span class="line"><span class="regexp">          return (</span></span><br><span class="line"><span class="regexp">            &lt;div key=&#123;key&#125;&gt;</span></span><br><span class="line"><span class="regexp">              &lt;div&gt;Title: &#123; posts[key].title &#125;&lt;/</span>div&gt;</span><br><span class="line">              &lt;div&gt;Upvotes: &#123; posts[key].upvote &#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">              &lt;div&gt;Downvotes: &#123; posts[key].downvote &#125;&lt;/</span>div&gt;</span><br><span class="line">              &lt;div&gt;</span><br><span class="line">                &lt;button </span><br><span class="line">                  onClick=&#123; _this.handleUpvote.bind(<span class="keyword">this</span>, posts[key], key) &#125;</span><br><span class="line">                  type=<span class="string">"button"</span></span><br><span class="line">                &gt;</span><br><span class="line">                  Upvote</span><br><span class="line">                &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">                &lt;button </span></span><br><span class="line"><span class="regexp">                  onClick=&#123; _this.handleDownvote.bind(this, posts[key], key) &#125;</span></span><br><span class="line"><span class="regexp">                  type="button"</span></span><br><span class="line"><span class="regexp">                &gt;</span></span><br><span class="line"><span class="regexp">                  Downvote</span></span><br><span class="line"><span class="regexp">                &lt;/</span>button&gt;</span><br><span class="line">              &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">          );</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>When the buttons are clicked, the <strong>upvote</strong> or <strong>downvote</strong> count will be incremented in our Firebase DB. To handle that logic, we create two more methods: <code>handleUpvote()</code> and <code>handleDownvote()</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/containers/Posts/index.js</span></span><br><span class="line"></span><br><span class="line">handleUpvote = <span class="function">(<span class="params">post, key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">this</span>.props.firebase.ref(<span class="string">'posts/'</span> + key).set(&#123;</span><br><span class="line">    title: post.title,</span><br><span class="line">    upvote: post.upvote + <span class="number">1</span>,</span><br><span class="line">    downvote: post.downvote</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">handleDownvote = <span class="function">(<span class="params">post, key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">this</span>.props.firebase.ref(<span class="string">'posts/'</span> + key).set(&#123;</span><br><span class="line">    title: post.title,</span><br><span class="line">    upvote: post.upvote,</span><br><span class="line">    downvote: post.downvote + <span class="number">1</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In these two methods, whenever a user clicks on either of the buttons, the respective count is incremented in the database and is instantly updated in the browser.</p>
<p>If we open two tabs with <a href="http://localhost:3000/posts" target="_blank" rel="noopener">localhost:3000/posts</a> and click on the voting buttons of the posts, we will see each of the tabs get updated almost instantly. This is the magic of using a real-time database like Firebase.</p>
<p>You can check my <a href="https://github.com/sitepoint-editors/reddit-clone/commit/54a15d22b5e18771ea6084ae70575e0fc47ed016" target="_blank" rel="noopener">commit</a> on Github.</p>
<p>In the <a href="https://github.com/sitepoint-editors/reddit-clone" target="_blank" rel="noopener">repository</a>, I’ve added the <strong>/posts</strong> route to the <code>IndexRoute</code> of the application just to show the posts on <a href="http://localhost:3000/" target="_blank" rel="noopener">localhost:3000</a> by default. You can check that <a href="https://github.com/sitepoint-editors/reddit-clone/commit/7c621a212fe47036248c3317dedb1eb5788dce71" target="_blank" rel="noopener">commit</a> on Github.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The end result is admittedly a bit barebones, as we didn’t try to implement any design (although <a href="https://sitepoint-editors.github.io/reddit-clone/" target="_blank" rel="noopener">the demo</a> has some basic styles added). We also didn’t add any authentication in order to reduce the complexity and the length of the tutorial, but obviously any real-world application would require it.</p>
<p>Firebase is really useful for places where you don’t want to create and maintain a separate backend application or where you want real-time data without investing too much time developing your APIs. It plays really well with React, as you can hopefully see from the article.</p>
<span>Source: </span><a href="https://www.sitepoint.com/reddit-clone-react-firebase/" target="_blank" title="https://www.sitepoint.com/reddit-clone-react-firebase/" class="post-from">https://www.sitepoint.com/reddit-clone-react-firebase/</a></div></div></article></div></section><div class="wrap"><footer><div class="paginator"><a href="/2017/08/reducing-css-bundle-size-with-webpack.html" class="prev">NEXT</a><a href="/2017/07/Using-MySQL-with-Node-js-the-mysql-JavaScript-Client.html" class="next">PREV</a></div><div class="copyright"><p>© 2017 - 2018 <a href="http://nthung2112.github.io">Hung Tan Nguyen</a>, unless otherwise noted.</p></div></footer></div><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-41935289-1",'auto');ga('send','pageview');</script><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script><script src="/js/zoom.js"></script><script src="/js/insight.js"></script></body></html>