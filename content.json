{"meta":{"title":"Learn and Share","subtitle":null,"description":"Learn any share","author":"Hung Tan Nguyen","url":"http://nthung2112.github.io"},"pages":[{"title":"About me","date":"2017-03-09T01:12:38.000Z","updated":"2017-08-20T15:08:41.686Z","comments":true,"path":"about/index.html","permalink":"http://nthung2112.github.io/about/index.html","excerpt":"","text":"Hi all, TÃ´i lÃ  Hung Tan Nguyen. TÃ´i viáº¿t blog nÃ y má»¥c Ä‘Ã­ch Ä‘á»ƒ note láº¡i nhá»¯ng kiáº¿n thá»©c mÃ¬nh Ä‘Ã£ tham kháº£o vÃ  há»c há»i Ä‘Æ°á»£c, bÃªn cáº¡nh Ä‘Ã³ mÃ¬nh cÅ©ng muá»‘n chia sáº» nhá»¯ng kinh nghiá»‡m cá»§a mÃ¬nh Ä‘á»ƒ nÃ¢ng cao thÃªm kiáº¿n thá»©c cá»§a mÃ¬nh. Thanks all."},{"title":"Tags","date":"2017-03-09T14:16:54.197Z","updated":"2017-03-09T14:16:54.197Z","comments":true,"path":"tags/index.html","permalink":"http://nthung2112.github.io/tags/index.html","excerpt":"","text":""},{"title":"Categories","date":"2017-03-09T14:16:54.197Z","updated":"2017-03-09T14:16:54.197Z","comments":true,"path":"categories/index.html","permalink":"http://nthung2112.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"Web Architecture 101","slug":"Web-Architecture-101","date":"2019-01-06T16:31:00.000Z","updated":"2019-01-06T16:34:26.744Z","comments":true,"path":"2019/01/Web-Architecture-101.html","link":"","permalink":"http://nthung2112.github.io/2019/01/Web-Architecture-101.html","excerpt":"KhÃ¡i niá»‡m kiáº¿n trÃºc web cÆ¡ báº£n mÃ  tÃ´i Æ°á»›c tÃ´i biáº¿t khi má»›i trá»Ÿ thÃ nh developer. Biá»ƒu Ä‘á»• trÃªn trÃ¬nh bÃ y khÃ¡ Ä‘á»§ vá» kiáº¿n trÃºc cá»§a chÃºng tÃ´i á»Ÿ Storyblocks. Náº¿u báº¡n khÃ´ng pháº£i lÃ  má»™t web developer lÃ¢u nÄƒm thÃ¬ áº£nh trÃªn trÃ´ng sáº½ khÃ¡ phá»©c táº¡p. Viá»‡c má»• xáº» dÆ°á»›i Ä‘Ã¢y cháº¯c sáº½ giÃºp nÃ³ dá»… tiáº¿p cáº­n hÆ¡n trÆ°á»›c khi chÃºng ta Ä‘Ã o sÃ¢u vÃ o chi tiáº¿t cá»§a má»—i thÃ nh pháº§n.","text":"KhÃ¡i niá»‡m kiáº¿n trÃºc web cÆ¡ báº£n mÃ  tÃ´i Æ°á»›c tÃ´i biáº¿t khi má»›i trá»Ÿ thÃ nh developer. Biá»ƒu Ä‘á»• trÃªn trÃ¬nh bÃ y khÃ¡ Ä‘á»§ vá» kiáº¿n trÃºc cá»§a chÃºng tÃ´i á»Ÿ Storyblocks. Náº¿u báº¡n khÃ´ng pháº£i lÃ  má»™t web developer lÃ¢u nÄƒm thÃ¬ áº£nh trÃªn trÃ´ng sáº½ khÃ¡ phá»©c táº¡p. Viá»‡c má»• xáº» dÆ°á»›i Ä‘Ã¢y cháº¯c sáº½ giÃºp nÃ³ dá»… tiáº¿p cáº­n hÆ¡n trÆ°á»›c khi chÃºng ta Ä‘Ã o sÃ¢u vÃ o chi tiáº¿t cá»§a má»—i thÃ nh pháº§n. NgÆ°á»i dÃ¹ng search trÃªn Google tá»« khÃ³a â€œStrong Beautiful Fog And Sunbeams In The Forestâ€. Káº¿t quáº£ Ä‘áº§u tiÃªn Ä‘áº¿n tá»« Storyblocks, trang stock vÃ  vector cá»§a chÃºng tÃ´i. NgÆ°á»i dÃ¹ng click vÃ o káº¿t quáº£ vÃ  Ä‘Æ°á»£c chuyá»ƒn tiáº¿p Ä‘áº¿n trang chi tiáº¿t vá» bá»©c áº£nh. Vá» cÆ¡ báº£n lÃ  trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng gá»­i má»™t request Ä‘áº¿n server DNS Ä‘á»ƒ tÃ¬m cÃ¡ch liÃªn há»‡ vá»›i Storyblocks, vÃ  sau Ä‘Ã³ gá»­i request. Request nÃ y sáº½ gá»­i Ä‘áº¿n load balancer, vÃ  nÃ³ chá»n ngáº«u nhiÃªn 1 trong sá»‘ cÃ¡c web server chÃºng tÃ´i Ä‘ang cháº¡y Ä‘á»ƒ xá»­ lÃ½ request. Web server tÃ¬m thÃ´ng tin vá» áº£nh tá»« caching service vÃ  láº¥y dá»¯ liá»‡u cÃ²n láº¡i tá»« database. CÅ©ng lÆ°u Ã½ ráº±ng â€œhá»“ sÆ¡ mÃ uâ€ cá»§a bá»©c áº£nh chÆ°a Ä‘Æ°á»£c tÃ­nh toÃ¡n, nÃªn chÃºng tÃ´i gá»­i má»™t job Ä‘áº¿n hÃ ng Ä‘á»£i â€œjob queueâ€, vÃ  job server sáº½ xá»­ lÃ½ Ä‘á»“ng bá»™, Ä‘á»“ng thá»i cáº­p nháº­t database vá»›i káº¿t quáº£ cÃ³ Ä‘Æ°á»£c sau khi xá»­ lÃ½. Tiáº¿p Ä‘Ã³, chÃºng tÃ´i thá»­ tÃ¬m nhá»¯ng bá»©c áº£nh tÆ°Æ¡ng tá»± báº±ng cÃ¡ch gá»­i má»™t request Ä‘áº¿n service â€œfull text searchâ€ vá»›i Ä‘áº§u vÃ o lÃ  tiÃªu Ä‘á» bá»©c áº£nh. NgÆ°á»i dÃ¹ng tÃ¬nh cá» Ä‘Äƒng nháº­p vÃ o Storyblocks vá»›i tÆ° cÃ¡ch thÃ nh viÃªn thÃ¬ chÃºng tÃ´i tÃ¬m thÃ´ng tin tÃ i khoáº£n tá»« â€œaccount serviceâ€. Cuá»‘i cÃ¹ng, chÃºng tÃ´i báº¯n má»™t sá»± kiá»‡n Ä‘áº¿n firehose Ä‘á»ƒ lÆ°u láº¡i trÃªn há»‡ thá»‘ng lÆ°u trá»¯ Ä‘Ã¡m mÃ¢y vÃ  load vÃ o data warehouse, thá»© sáº½ Ä‘Æ°á»£c phÃ¢n tÃ­ch Ä‘á»ƒ tráº£ lá»i nhá»¯ng cÃ¢u há»i vá» business. Server render HTML view vÃ  gá»­i nÃ³ trá»Ÿ láº¡i trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng, trÆ°á»›c háº¿t thÃ´ng qua load balancer. Trang web chá»©a JavaScript vÃ  CSS Ä‘Æ°á»£c load tá»« há»‡ lÆ°u trá»¯ Ä‘Ã¡m máº¥y, nÃ³ káº¿t ná»‘i vá»›i CDN, nÃªn trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ liÃªn há»‡ vá»›i CDN Ä‘á»ƒ nháº­n ná»™i dung. Sau cÃ¹ng, trÃ¬nh duyá»‡t hiá»ƒn thá»‹ trang web cho ngÆ°á»i dÃ¹ng. Giá» tÃ´i sáº½ Ä‘i láº§n lÆ°á»£t tá»«ng thÃ nh pháº§n, giá»›i thiá»‡u theo kiá»ƒu â€œ101 â€¦â€ nháº±m cung cáº¥p cho báº¡n má»™t mÃ´ hÃ¬nh chuáº©n Ä‘á»ƒ suy nghÄ© vá» kiáº¿n trÃºc web (web architecture) vá» sau. 1. DNSDNS lÃ  viáº¿t táº¯t cá»§a â€œDomain Name Serverâ€ vÃ  nÃ³ lÃ  cÃ´ng nghá»‡ xÆ°Æ¡ng sá»‘ng Ä‘á»ƒ Ä‘á»ƒ www (world wide web) trá»Ÿ nÃªn kháº£ dÄ©. á» má»©c Ä‘á»™ cÆ¡ báº£n thÃ¬ DNS cung cáº¥p má»™t tham chiáº¿u key/value tá»« domain name (cháº³ng háº¡n google.com â€¦) Ä‘áº¿n má»™t Ä‘á»‹a chá»‰ IP (cháº³ng háº¡n 85.129.83.120 â€¦), giÃºp mÃ¡y tÃ­nh Ä‘iá»u hÆ°á»›ng request Ä‘áº¿n server tÆ°Æ¡ng á»©ng. TÆ°Æ¡ng tá»± vá»›i sá»‘ Ä‘iá»‡n thoáº¡i, sá»± khÃ¡c biá»‡t giá»¯a domain vÃ  Ä‘á»‹a chá»‰ IP chÃ­nh lÃ  sá»± khÃ¡c biá»‡t giá»¯a viá»‡c â€œgá»i John Doeâ€ vÃ  â€œgá»i Ä‘áº¿n sá»‘ 201-867-5309â€. Báº¡n cáº§n má»™t danh báº¡ Ä‘á»ƒ tÃ¬m sá»‘ cá»§a John, vÃ  tÆ°Æ¡ng tá»±, báº¡n cáº§n DNS Ä‘á»ƒ tÃ¬m Ä‘á»‹a chá»‰ IP cho domain (tÃªn miá»n). Tháº¿ nÃªn báº¡n cÃ³ thá»ƒ xem DNS lÃ  má»™t cuá»‘n danh báº¡ cho internet. CÃ²n nhiá»u Ä‘iá»u chi tiáº¿t hÆ¡n mÃ  chÃºng ta cÃ³ thá»ƒ Ä‘á» cáº­p Ä‘áº¿n nhÆ°ng tÃ´i sáº½ bá» qua vÃ¬ nÃ³ khÃ´ng pháº£i á»Ÿ má»©c giá»›i thiá»‡u kiá»ƒu â€œ101â€. P/S: 101 lÃ  gÃ¬ thÃ¬ Ä‘á»c á»Ÿ Ä‘Ã¢y nhÃ© http://www.slate.com/articles/news_and_politics/explainer/2006/09/101_101.html 2. Load Balancer (CÃ¢n báº±ng táº£i)TrÆ°á»›c khi Ä‘i sÃ¢u vÃ o cÃ¢n báº±ng táº£i, chÃºng ta cáº§n tháº£o luáº­n vá» â€œhorizontal scalingâ€œ (má»Ÿ rá»™ng theo chiá»u ngang) vÃ  â€œvertical scalingâ€œ (má»Ÿ rá»™ng theo chiá»u dá»c). ChÃºng lÃ  gÃ¬ vÃ  khÃ¡c nhau nhÆ° tháº¿ nÃ o? ÄÆ¡n giáº£n â€œhorizontal scalingâ€ nghÄ©a lÃ  má»Ÿ rá»™ng quy mÃ´ báº±ng cÃ¡ch thÃªm nhiá»u mÃ¡y tÃ­nh vÃ o nguá»“n tÃ i nguyÃªn, trong khi â€œvertical scalingâ€ nghÄ©a lÃ  tÄƒng cÆ°á»ng sá»©c máº¡nh cho má»™t mÃ¡y tÃ­nh Ä‘Ã£ cÃ³ (cháº³ng háº¡n nhÆ° CPU, RAM). Trong web development, gáº§n nhÆ° báº¡n luÃ´n muá»‘n má»Ÿ rá»™ng theo kiá»ƒu â€œhorizontalâ€. VÃ¬, server cÃ³ thá»ƒ bá»—ng dÆ°ng bá»‹ cháº¿t, máº¡ng gáº·p sá»± cá»‘, toÃ n bá»™ trung tÃ¢m dá»¯ liá»‡u thÆ°á»ng xuyÃªn máº¥t máº¡ng. CÃ³ nhiá»u hÆ¡n má»™t server cho phÃ©p báº¡n láº­p káº¿ hoáº¡ch cho cÃ¡c sá»± cá»‘ Ä‘á»ƒ á»©ng dá»¥ng váº«n tiáº¿p tá»¥c cháº¡y (fault tolerant). LÃ½ do thá»© hai, â€œhorizontal scalingâ€ sáº½ cho báº¡n káº¿t há»£p tá»‘i thiá»ƒu cÃ¡c pháº§n backend khÃ¡c nhau cá»§a á»©ng dá»¥ng (web server, database, service X, â€¦) báº±ng cÃ¡ch Ä‘á»ƒ chÃºng cháº¡y trÃªn nhiá»u server. Cuá»‘i cÃ¹ng, báº¡n cÃ³ thá»ƒ má»Ÿ rá»™ng quy mÃ´ Ä‘áº¿n má»™t má»©c mÃ  â€œvertical scalingâ€ khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c. ÄÃ³ lÃ  vÃ¬ khÃ´ng cÃ³ má»™t mÃ¡y tÃ­nh nÃ o trÃªn tháº¿ giá»›i Ä‘á»§ lá»›n Ä‘á»ƒ thá»±c hiá»‡n táº¥t cáº£ tÃ­nh toÃ¡n cho á»©ng dá»¥ng. HÃ£y nghÄ© ná»n táº£ng tÃ¬m kiáº¿m cá»§a Google nhÆ° má»™t vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh (dÃ¹ Ä‘iá»u nÃ y á»©ng dá»¥ng cho cÃ¡c cÃ´ng ty á»Ÿ quy mÃ´ bÃ© hÆ¡n nhiá»u). Storyblocks, cháº¡y tá»« 150 Ä‘áº¿n 400 AWS EC2 táº¡i thá»i Ä‘iá»ƒm viáº¿t bÃ i nÃ y, Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c khá»‘i lÆ°á»£ng tÃ­nh toÃ¡n áº¥y báº±ng â€œvertical scalingâ€ lÃ  má»™t thÃ¡ch thá»©c ráº¥t lá»›n. Trá»Ÿ láº¡i vá»›i cÃ¢n báº±ng táº£i, chÃºng lÃ  ma thuáº­t Ä‘á»ƒ má»Ÿ rá»™ng theo kiá»ƒu â€œhorizontalâ€, Ä‘iá»u hÆ°á»›ng incoming request Ä‘áº¿n má»™t trong nhiá»u server vÃ  gá»­i pháº£n há»“i tá»« server vá» client. Báº¥t ká»³ server nÃ o cÅ©ng pháº£i xá»­ lÃ½ request theo cÃ¹ng má»™t cÃ¡ch, do Ä‘Ã³ chá»‰ cÃ²n láº¡i má»™t váº¥n Ä‘á» lÃ  phÃ¢n bá»• request qua nhiá»u server Ä‘á»ƒ chÃºng khÃ´ng bá»‹ quÃ¡ táº£i (overload). Váº­y Ä‘Ã³, khÃ¡i niá»‡m cÃ¢n báº±ng táº£i khÃ¡ Ä‘Æ¡n giáº£n. Táº¥t nhiÃªn cÃ´ng nghá»‡ náº±m phÃ­a sau nÃ³ ráº¥t phá»©c táº¡p nhÆ°ng khÃ´ng cáº§n Ä‘á» cáº­p vá»›i phiÃªn báº£n â€œ101â€ lÃ m chi. 3. Web Application ServersWeb server lÃ  nÆ¡i thá»±c thi business logic, xá»­ lÃ½ request cá»§a user vÃ  gá»­i láº¡i HTML Ä‘áº¿n trÃ¬nh duyá»‡t cá»§a user. Äá»ƒ lÃ m viá»‡c Ä‘Ã³, chÃºng káº¿t ná»‘i vá»›i nhiá»u infra phÃ­a back-end nhÆ° database, caching layer, job queue, search service, microservice, data/logging queue, â€¦ NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn, Ã­t nháº¥t 2 server thÆ°á»ng Ä‘Æ°á»£c káº¿t ná»‘i vá»›i cÃ¢n báº±ng táº£i Ä‘á»ƒ xá»­ lÃ½ request cá»§a ngÆ°á»i dÃ¹ng. Báº¡n nÃªn biáº¿t ráº±ng triá»ƒn khai server yÃªu cáº§u má»™t ngÃ´n ngá»¯ cá»¥ thá»ƒ (Node.js, Ruby, PHP, Scala, Java, C# .NET, â€¦) vÃ  má»™t web framework cho ngÃ´n ngá»¯ Ä‘Ã³ (Express, Ruby on Rails, Play, Laravel, â€¦). Tuy nhiÃªn Ä‘i sÃ¢u vÃ o chi tiáº¿t cá»§a nhá»¯ng ngÃ´n ngá»¯ nÃ y náº±m ngoÃ i pháº¡m vi cá»§a bÃ i viáº¿t. 4. Database ServersMá»i á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i Ä‘á»u sá»­ dá»¥ng má»™t hoáº·c nhiá»u database Ä‘á»ƒ lÆ°u trá»¯ thÃ´ng tin. Database cung cáº¥p phÆ°Æ¡ng thá»©c Ä‘á»ƒ Ä‘á»‹nh nghÄ©a cáº¥u trÃºc dá»¯ liá»‡u, insert dá»¯ liá»‡u má»›i, tÃ¬m dá»¯ liá»‡u Ä‘Ã£ cÃ³, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u, thá»±c hiá»‡n tÃ­nh toÃ¡n, â€¦ DÃ¹ tÃ´i trÃ¡nh Ä‘Ã o sao vÃ o má»™t cÃ´ng nghá»‡ cá»¥ thá»ƒ cho má»—i thÃ nh pháº§n cá»§a kiáº¿n trÃºc web, sáº½ ráº¥t tá»‡ náº¿u tÃ´i khÃ´ng Ä‘á» cáº­p Ä‘áº¿n SQL vÃ  NoSQL. SQL lÃ  viáº¿t táº¯t cá»§a â€œStructured Query Languageâ€ (ngÃ´n ngá»¯ truy váº¥n cÃ³ cáº¥u trÃºc) Ä‘Æ°á»£c phÃ¡t minh vÃ o tháº­p niÃªn 70 cá»§a tháº¿ ká»· trÆ°á»›c, cung cáº¥p má»™t chuáº©n Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u. SQL database lÆ°u trá»¯ dá»¯ liá»‡u theo báº£ng, Ä‘Æ°á»£c liÃªn káº¿t vá»›i nhau thÆ°á»ng báº±ng ID. HÃ£y láº¥y má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» lÆ°u trá»¯ Ä‘á»‹a chá»‰ cá»§a ngÆ°á»i dÃ¹ng. Báº¡n cÃ³ 2 báº£ng, users vÃ  _user_addresses_, liÃªn káº¿t vá»›i nhau báº±ng id cá»§a ngÆ°á»i dÃ¹ng. NoSQL, nghÄ©a lÃ  â€œNon-SQLâ€, lÃ  má»™t cÃ´ng nghá»‡ cÆ¡ sá»Ÿ dá»¯ liá»‡u má»›i hÆ¡n, dÃ¹ng Ä‘á»ƒ xá»­ lÃ½ khá»‘i lÆ°á»£ng dá»¯ liá»‡u lá»›n Ä‘Æ°á»£c sinh ra bá»Ÿi nhá»¯ng á»©ng dá»¥ng web cÃ³ quy mÃ´ lÆ¡n (háº§u háº¿t cÃ¡c biáº¿n thá»ƒ cá»§a SQL khÃ´ng scale theo kiá»ƒu â€œhorizontalâ€ tá»‘t vÃ  chá»‰ cÃ³ thá»ƒ scale theo kiá»ƒu â€œverticalâ€ Ä‘áº¿n má»™t má»©c Ä‘á»™ nháº¥t Ä‘á»‹nh). Náº¿u báº¡n khÃ´ng biáº¿t gÃ¬ vá» NoSQL, tÃ´i Ä‘á» nghá»‹ xem nhá»¯ng tÃ i liá»‡u dÆ°á»›i Ä‘Ã¢y: https://www.w3resource.com/mongodb/nosql.php http://www.kdnuggets.com/2016/07/seven-steps-understanding-nosql-databases.html https://resources.mongodb.com/getting-started-with-mongodb/back-to-basics-1-introduction-to-nosql 5. Caching ServiceMá»™t caching service (dá»‹ch vá»¥ lÆ°u bá»™ nhá»› Ä‘á»‡m) cung cáº¥p lÆ°u trá»¯ dá»¯ liá»‡u theo kiá»ƒu â€œkey/valueâ€ Ä‘Æ¡n giáº£n giÃºp nÃ³ tÃ¬m kiáº¿m thÃ´ng tin vá»›i thá»i gian gáº§n nhÆ° báº±ng 0. CÃ¡c á»©ng dá»¥ng thÆ°á»ng táº­n dá»¥ng caching service Ä‘á»ƒ lÆ°u káº¿t quáº£ cá»§a nhá»¯ng tÃ­nh toÃ¡n Ä‘áº¯t Ä‘á» Ä‘á»ƒ nháº­n káº¿t cá»§a tá»« bá»™ nhá»› Ä‘á»‡m thay vÃ¬ pháº£i tÃ­nh toÃ¡n láº¡i má»™t láº§n ná»¯a khi cáº§n. á»¨ng dá»¥ng cÃ³ thá»ƒ cache káº¿t quáº£ cá»§a má»™t truy váº¥n cÆ¡ sá»Ÿ dá»¯ liá»‡u, gá»i Ä‘áº¿n má»™t dá»‹ch vá»¥ bÃªn ngoÃ i, cache HTML cá»§a má»™t Ä‘Æ°á»ng link, â€¦ DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ i vÃ­ dá»¥ thá»±c táº¿: Google lÆ°u káº¿t quáº£ tÃ¬m kiáº¿m cho nhá»¯ng truy váº¥n thÃ´ng thÆ°á»ng nhÆ° â€œdogâ€ hoáº·c â€œTaylor Swiftâ€ Ä‘á»ƒ khÃ´ng pháº£i tÃ­nh toÃ¡n láº¡i má»—i láº§n Facebook lÆ°u nhiá»u dá»¯ liá»‡u báº¡n nhÃ¬n tháº¥y khi Ä‘Äƒng nháº­p, cháº³ng háº¡n bÃ i viáº¿t, báº¡n bÃ¨â€¦ Báº¡n cÃ³ thá»ƒ Ä‘á»c chi tiáº¿t vá» Facebook caching á»Ÿ Ä‘Ã¢y. Storyblocks lÆ°u HTML output, káº¿t quáº£ tÃ¬m kiáº¿m, â€¦ Hai cÃ´ng nghá»‡ caching phá»• biáº¿n nháº¥t lÃ  Redis vÃ  Memcache. 6. Job Queue &amp; ServersHáº§u háº¿t á»©ng dá»¥ng web Ä‘á»u cáº§n lÃ m má»™t sá»‘ cÃ´ng viá»‡c báº¥t Ä‘á»“ng bá»™ á»Ÿ phÃ­a back-end mÃ  khÃ´ng káº¿t há»£p trá»±c tiáº¿p vÃ o dá»¯ liá»‡u tráº£ vá» cho ngÆ°á»i dÃ¹ng. Cháº³ng háº¡n, Google cáº§n crawl vÃ  index toÃ n bá»™ internet Ä‘á»ƒ tráº£ vá» káº¿t quáº£ tÃ¬m kiáº¿m. NÃ³ khÃ´ng Ä‘Æ°á»£c lÃ m má»—i láº§n báº¡n tÃ¬m kiáº¿m. Thay vÃ o Ä‘Ã³, nÃ³ crawl cÃ¡c trang web má»™t cÃ¡ch báº¥t Ä‘á»“ng bá»™, vÃ  cáº­p nháº­t index theo thá»i gian. Máº·c dÃ¹ cÃ³ nhiá»u kiáº¿n trÃºc khÃ¡c nhau cho cÃ¡c cÃ´ng viá»‡c báº¥t Ä‘á»“ng bá»™, nhÆ°ng phá»‘ biáº¿n nháº¥t lÃ  kiáº¿n trÃºc â€œjob queueâ€. NÃ³ chá»©a 2 thÃ nh pháº§n: má»™t hÃ ng Ä‘á»£i â€œjobâ€ cáº§n Ä‘Æ°á»£c cháº¡y, vÃ  má»™t hoáº·c nhiá»u â€œjob serverâ€ (hay cÃ²n láº¡i lÃ  worker) Ä‘á»ƒ cháº¡y job trong hÃ ng Ä‘á»£i. Job queue chá»©a má»™t danh sÃ¡ch job cáº§n Ä‘Æ°á»£c cháº¡y báº¥t Ä‘á»“ng bá»™. HÃ ng Ä‘á»£i Ä‘Æ¡n giáº£n nháº¥t lÃ  FIFO (first in first out) máº·c dÃ¹ háº§u háº¿t á»©ng dá»¥ng sáº½ cáº§n má»™t vÃ i hÃ ng Ä‘á»£i cÃ³ Æ°u tiÃªn. Má»—i khi á»©ng dá»¥ng cáº§n cháº¡y job thÃ¬ nÃ³ chá»‰ cáº§n thÃªm job Ä‘Ã³ vÃ o hÃ ng Ä‘á»£i. Storyblocks, cháº³ng háº¡n, táº­n dá»¥ng â€œjob queueâ€ Ä‘á»ƒ há»— trá»£ ráº¥t nhiá»u cÃ´ng viá»‡c phÃ­a back-end nháº±m phá»¥c vá»¥ thá»‹ trÆ°á»ng cá»§a chÃºng tÃ´i. ChÃºng tÃ´i cháº¡y job Ä‘á»ƒ encode video vÃ  áº£nh, xá»­ lÃ½ file CSV, thá»‘ng kÃª ngÆ°á»i dÃ¹ng, gá»­i máº­t kháº©u reset email, â€¦ LÃºc Ä‘áº§u chÃºng tÃ´i sá»­ dá»¥ng hÃ ng Ä‘á»£i FIFO Ä‘Æ¡n giáº£n, sau Ä‘Ã³ nÃ¢ng cáº¥p lÃªn hÃ ng Ä‘á»£i Æ°u tiÃªn Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng nhá»¯ng hoáº¡t Ä‘á»™ng kháº©n nhÆ° gá»­i máº­t kháº©u reset email Ä‘Æ°á»£c hoÃ n thÃ nh cÃ ng sá»›m cÃ ng tá»‘t. Job server xá»­ lÃ½ job. ChÃºng thÄƒm dÃ² â€œjob queueâ€ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ³ job cáº§n lÃ m hay khÃ´ng, vÃ  náº¿u cÃ³ thÃ¬ chÃºng sáº½ Ä‘áº©y job vÃ o hÃ ng Ä‘á»£i vÃ  thá»±c thi nÃ³. 7. Full-text Search ServiceHáº§u háº¿t á»©ng dá»¥ng web há»— trá»£ má»™t vÃ i chá»©c nÄƒng tÃ¬m kiáº¿m mÃ  ngÆ°á»i dÃ¹ng thÆ°á»ng sáº½ cung cáº¥p má»™t tham sá»‘ vÄƒn báº£n (cÃ²n gá»i lÃ  â€œqueryâ€) vÃ  á»©ng dá»¥ng tráº£ vá» káº¿t quáº£ â€œliÃªn quanâ€. CÃ´ng nghá»‡ há»— trá»£ Ä‘áº·c tÃ­nh nÃ y thÆ°á»ng gá»i lÃ  â€œfull-text searchâ€, sá»­ dá»¥ng index Ä‘á»ƒ nhanh chÃ³ng tÃ¬m tÃ i liá»‡u chá»©a tá»« khÃ³a cáº§n truy váº¥n. DÃ¹ cÃ³ thá»ƒ thá»±c hiá»‡n â€œfull-text searchâ€ trá»±c tiáº¿p tá»« database (cháº³ng háº¡n MySQL há»— trá»£ full-text search), nÃ³ thÆ°á»ng cháº¡y má»™t â€œsearch serviceâ€ riÃªng Ä‘á»ƒ tÃ­nh toÃ¡n vÃ  lÆ°u trá»¯ chá»‰ má»¥c vÃ  cung cáº¥p má»™t giao diá»‡n truy váº¥n riÃªng. Ná»n táº£ng full-text search phá»• biáº¿n nháº¥t hiá»‡n nay lÃ  Eltasticsearch, bÃªn cáº¡nh má»™t sá»‘ lá»±a chá»n khÃ¡c nhÆ° Sphinx hoáº·c Apache Solr. 8. ServicesKhi á»©ng dá»¥ng Ä‘áº¡t Ä‘áº¿n quy mÃ´ nháº¥t Ä‘á»‹nh, sáº½ cÃ³ má»™t sá»‘ â€œserviceâ€ Ä‘Æ°á»£c tahcs ra Ä‘á»ƒ cháº¡y nhÆ° má»™t á»©ng dá»¥ng riÃªng. ChÃºng khÃ´ng Ä‘Æ°á»£c public bÃªn ngoÃ i nhÆ°ng á»©ng dá»¥ng vÃ  cÃ¡c service khÃ¡c cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i chÃºng. Storyblocks cÃ³ má»™t sá»‘ service nhÆ° váº­y: Account service Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u ngÆ°á»i dÃ¹ng trÃªn táº¥t cáº£ cÃ¡c trang web cá»§a chÃºng tÃ´i, cho phÃ©p chÃºng tÃ´i dá»… dÃ ng cung cáº¥p cÃ¡c cÆ¡ há»™i â€œcross-sellâ€ vÃ  táº¡o nhá»¯ng tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng nháº¥t quÃ¡n hÆ¡n Content service lÆ°u trá»¯ metadata cho video, audio, áº£nh. NÃ³ cÅ©ng cung cáº¥p giao diá»‡n Ä‘á»ƒ download ná»™i dung vÃ  xem lá»‹ch sá»­ download. Payment service cung cáº¥p giao diá»‡n thanh toÃ¡n báº±ng tháº» tÃ­n dá»¥ng. HTML â†’ PDF service cung cáº¥p giao diá»‡n Ä‘Æ¡n giáº£n Ä‘á»ƒ sinh ra file PDF tá»« HTML. 9. DataNgÃ y nay, cÃ´ng ty muá»‘n tá»“n táº¡i thÃ¬ pháº£i dá»±a trÃªn cÃ¡ch há» khai thÃ¡c dá»¯ liá»‡u. Háº§u háº¿t nhá»¯ng á»©ng dá»¥ng bÃ¢y giá», má»—i láº§n Ä‘áº¡t Ä‘áº¿n má»™t quy mÃ´ nháº¥t Ä‘á»‹nh, hÃ£y táº­n dá»¥ng kÃªnh dá»¯ liá»‡u (data pipeline) Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c thu tháº­p, lÆ°u trá»¯ vÃ  phÃ¢n tÃ­ch. Má»™t kÃªnh dá»¯ liá»‡u bao gá»“m 3 giai Ä‘oáº¡n chÃ­nh: á»¨ng dá»¥ng gá»­i dá»¯ liá»‡u, sá»± kiá»‡n vá» tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng cho â€œfirehoseâ€ (cung cáº¥p giao diá»‡n streaming Ä‘á»ƒ nháº­p vÃ  xá»­ lÃ½ dá»¯ liá»‡u). ThÃ´ng thÆ°á»ng dá»¯ liá»‡u thÃ´ Ä‘Æ°á»£c xá»­ lÃ½ sáº½ Ä‘Æ°á»£c gá»­i Ä‘áº¿n firehose khÃ¡c. AWS Kinesis vÃ  Kafka lÃ  hai cÃ´ng nghá»‡ phá»‘ biáº¿n nháº¥t cho má»¥c Ä‘Ã­ch nÃ y. Dá»¯ liá»‡u thÃ´ cÅ©ng nhÆ° dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c lÆ°u trá»¯ Ä‘áº¿n cloud. AWS Kinesis cung cáº¥p má»™t setting gá»i lÃ  â€œfirehoseâ€ sáº½ lÆ°u dá»¯ liá»‡u thÃ´ vÃ o S3 Ä‘á»ƒ dá»… cáº¥u hÃ¬nh. Dá»¯ liá»‡u Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i sáº½ Ä‘Æ°á»£c táº£i vÃ o data warehouse Ä‘á»ƒ phÃ¢n tÃ­ch. ChÃºng tÃ´i sá»­ dá»¥ng AWS Redshift, máº·c dÃ¹ cÃ¡c cÃ´ng ty lá»›n khÃ¡c thÆ°á»ng dÃ¹ng Oracle hoáº·c cÃ´ng nghá»‡ warehouse Ä‘á»™c quyá»n. Náº¿u bá»™ dá»¯ liá»‡u Ä‘á»§ lá»›n, cÃ´ng nghá»‡ NoSQL MapReduce nhÆ° Hadoop sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n tÃ­ch. Má»™t bÆ°á»›c khÃ¡c khÃ´ng Ä‘Æ°á»£c mÃ´ táº£ trong biá»ƒu Ä‘á»“ kiáº¿n trÃºc lÃ : táº£i dá»¯ liá»‡u tá»« database cá»§a á»©ng dá»¥ng vÃ  service vÃ o data warehouse. Cháº³ng háº¡n á»Ÿ Storyblocks, chÃºng tÃ´i táº£i VideoBlocks, AudioBlocks, Storyblocks, account service, â€¦ vÃ o Redshift má»—i Ä‘Ãªm. Äiá»u nÃ y cung cáº¥p cho bá»™ phÃ¢n tÃ­ch nhá»¯ng dá»¯ liá»‡u tá»•ng thá»ƒ báº±ng cÃ¡ch cáº¥p phÃ¡t dá»¯ liá»‡u business cÃ¹ng vá»›i dá»¯ liá»‡u tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng. 10. Cloud storageDá»‹ch vá»¥ Ä‘Ã¡m mÃ¢y lÃ  cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t Ä‘á»ƒ lÆ°u trá»¯, truy xuáº¥t vÃ  chia sáº» dá»¯ liá»‡u trÃªn internet, theo AWS. Báº¡n cÃ³ thá»ƒ dÃ¹ng nÃ³ Ä‘á»ƒ lÆ°u trá»¯ vÃ  truy cáº­p vá»›i lá»£i tháº¿ lÃ  tÆ°Æ¡ng tÃ¡c vá»›i nÃ³ quáº£ RESTful API. Amazon S3 lÃ  dá»‹ch vá»¥ lÆ°u trá»¯ Ä‘Ã¡m mÃ¢y phá»• biáº¿n nháº¥t ngÃ y nay, vÃ  chÃºng tÃ´i dá»±a vÃ o nÃ³ Ä‘á»ƒ lÆ°u trá»¯ video, áº£nh, audio, CSS vÃ  JavaScript, dá»¯ liá»‡u sá»± kiá»‡n ngÆ°á»i dÃ¹ng vÃ  hÆ¡n tháº¿ ná»¯a. 11. CDNCSN lÃ  viáº¿t táº¯t cá»§a â€œContent Delivery Networkâ€ vÃ  cÃ´ng nghá»‡ cung cáº¥p má»™t cÃ¡ch Ä‘á»ƒ phá»¥c vá»¥ ná»™i dung tÄ©nh nhÆ° HTML, CSS, JavaScript vÃ  áº£nh trÃªn web nhanh hÆ¡n so vá»›i viá»‡c chá»‰ dÃ¹ng má»™t server. NÃ³ hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch phÃ¢n tÃ¡n ná»™i dung qua nhiá»u â€œedge serverâ€ kháº¯p tháº¿ giá»›i Ä‘á»ƒ ngÆ°á»i dÃ¹ng cuá»‘i cÃ³ thá»ƒ download ná»™i dung tá»« â€œedge serverâ€ thay vÃ¬ tá»« server gá»‘c. Cháº³ng háº¡n nhÆ° áº£nh dÆ°á»›i Ä‘Ã¢y, má»™t ngÆ°á»i dÃ¹ng tá»« TÃ¢y Ban Nha request má»™t trang web mÃ  cÃ³ server gá»‘c lÃ  á»Ÿ New York, nhÆ°ng cÃ¡c tÃ i nguyÃªn tÄ©nh cá»§a trang web láº¡i Ä‘Æ°á»£c táº£i vá» tá»« â€œedge serverâ€ cá»§a CDN tá»« Anh.","categories":[],"tags":[{"name":"architecture","slug":"architecture","permalink":"http://nthung2112.github.io/tags/architecture/"}]},{"title":"Má»™t mÃ´ hÃ¬nh sá»­ dá»¥ng Git branches hiá»‡u quáº£","slug":"Mot-mo-hinh-su-dung-Git-branches-hieu-qua","date":"2019-01-06T16:24:00.000Z","updated":"2019-01-06T16:27:51.189Z","comments":true,"path":"2019/01/Mot-mo-hinh-su-dung-Git-branches-hieu-qua.html","link":"","permalink":"http://nthung2112.github.io/2019/01/Mot-mo-hinh-su-dung-Git-branches-hieu-qua.html","excerpt":"Má»›i Ä‘áº§u mÃ¬nh tÃ­nh viáº¿t vá» git-flow - má»™t tool Ä‘Æ¡n giáº£n dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ Git branches, xong tháº¥y bÃ i viáº¿t nÃ y vá» má»™t vÃ­ dá»¥ sá»­ dá»¥ng Git branches hay quÃ¡, nÃªn quyáº¿t Ä‘á»‹nh dá»‹ch luÃ´n. Má»Ÿ Ä‘áº§uNgay bÃ¢y giá», tÃ´i sáº½ giá»›i thiá»‡u vá»›i cÃ¡c báº¡n mÃ´ hÃ¬nh sá»­ dá»¥ng Git mÃ  tÃ´i Ä‘Ã£ vÃ  Ä‘ang sá»­ dá»¥ng trong cÃ¡c dá»± Ã¡n khoáº£ng má»™t nÄƒm trá»Ÿ láº¡i Ä‘Ã¢y. ÄÃ³ lÃ  má»™t mÃ´ hÃ¬nh thá»±c sá»± thÃ nh cÃ´ng, nhÆ°ng mÃ£i Ä‘áº¿n giá» tÃ´i má»›i cÃ³ cÆ¡ há»™i Ä‘á»ƒ cÃ³ thá»ƒ viáº¿t vá» nÃ³ vÃ  chia sáº» vá»›i cÃ¡c báº¡n. TÃ´i sáº½ khÃ´ng Ä‘i vÃ o chi tiáº¿t dá»± Ã¡n, mÃ  chá»‰ xoay quanh chiáº¿n lÆ°á»£c quáº£n lÃ½ cÃ¡c phÃ¢n nhÃ¡nh mÃ  thÃ´i.","text":"Má»›i Ä‘áº§u mÃ¬nh tÃ­nh viáº¿t vá» git-flow - má»™t tool Ä‘Æ¡n giáº£n dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ Git branches, xong tháº¥y bÃ i viáº¿t nÃ y vá» má»™t vÃ­ dá»¥ sá»­ dá»¥ng Git branches hay quÃ¡, nÃªn quyáº¿t Ä‘á»‹nh dá»‹ch luÃ´n. Má»Ÿ Ä‘áº§uNgay bÃ¢y giá», tÃ´i sáº½ giá»›i thiá»‡u vá»›i cÃ¡c báº¡n mÃ´ hÃ¬nh sá»­ dá»¥ng Git mÃ  tÃ´i Ä‘Ã£ vÃ  Ä‘ang sá»­ dá»¥ng trong cÃ¡c dá»± Ã¡n khoáº£ng má»™t nÄƒm trá»Ÿ láº¡i Ä‘Ã¢y. ÄÃ³ lÃ  má»™t mÃ´ hÃ¬nh thá»±c sá»± thÃ nh cÃ´ng, nhÆ°ng mÃ£i Ä‘áº¿n giá» tÃ´i má»›i cÃ³ cÆ¡ há»™i Ä‘á»ƒ cÃ³ thá»ƒ viáº¿t vá» nÃ³ vÃ  chia sáº» vá»›i cÃ¡c báº¡n. TÃ´i sáº½ khÃ´ng Ä‘i vÃ o chi tiáº¿t dá»± Ã¡n, mÃ  chá»‰ xoay quanh chiáº¿n lÆ°á»£c quáº£n lÃ½ cÃ¡c phÃ¢n nhÃ¡nh mÃ  thÃ´i. Trong bÃ i viáº¿t dÆ°á»›i Ä‘Ã¢y, tÃ´i sá»­ dá»¥ng Git Ä‘á»ƒ quáº£n lÃ½ version cho toÃ n bá»™ source code. Náº¿u cÃ¡c báº¡n cÃ³ há»©ng thÃº vá»›i viá»‡c phÃ¢n tÃ­ch dá»¯ liá»‡u thá»i gian thá»±c dá»±a vÃ o hoáº¡t Ä‘á»™ng trÃªn Git, cÃ³ thá»ƒ tham kháº£o pháº§n má»m mÃ  GitPrime mÃ  cÃ´ng ty tÃ´i phÃ¡t triá»ƒn. Táº¡i sao láº¡i chá»n Git?ÄÃ£ cÃ³ quÃ¡ nhiá»u cuá»™c chiáº¿n ná»• ra khi bÃ n vá» Æ°u Ä‘iá»ƒm nhÆ°á»£c Ä‘iá»ƒm cá»§a Git so vá»›i cÃ¡c cÃ´ng cá»¥ quáº£n lÃ½ source code táº­p trung khÃ¡c (nhÆ° CVS, SVN). LÃ  má»™t developer, tÃ´i cáº£m tháº¥y yÃªu thÃ­ch Git hÆ¡n. Git thá»±c sá»± Ä‘Ã£ thay Ä‘á»•i cÃ¡ch suy nghÄ© vá» merging vÃ  branching. Nhá»¯ng ai Ä‘Ã£ tá»«ng lÃ m viá»‡c vá»›i CVS/Subversion Ä‘á»u hiá»ƒu merging/branching khÃ´ng há» Ä‘Æ¡n giáº£n, trong tÃ i liá»‡u vá» CVS/Subversion branching vÃ  merging chá»‰ Ä‘Æ°á»£c nháº¯c Ä‘áº¿n á»Ÿ chapter cuá»‘i, dÃ nh cho cÃ¡c users cÃ³ kinh nghiá»‡m. CÃ²n vá»›i Git, branching/merging lÃ  má»™t pháº§n trong workflow hÃ ng ngÃ y cá»§a báº¡n, Ä‘Æ°á»£c mÃ´ táº£ á»Ÿ nhá»¯ng pháº§n Ä‘áº§u tiÃªn trong Git book. PhÃ¢n tÃ¡n, nhÆ°ng táº­p trungMÃ´ hÃ¬nh Git mÃ  tÃ´i sá»­ dá»¥ng hoáº¡t Ä‘á»™ng xoay quanh má»™t repo trung tÃ¢m. NÃªn nhá»› Ä‘Ã³ â€œchá»‰ Ä‘Æ°á»£c xem nhÆ°â€ lÃ  repo trung tÃ¢m, chá»© vá» máº·t ká»¹ thuáº­t thÃ¬ GIT khÃ´ng há» cÃ³ cÃ¡i gÃ¬ gá»i lÃ  repo trung tÃ¢m cáº£. VÃ­ dá»¥ nhÆ° repo origin á»Ÿ hÃ¬nh bÃªn dÆ°á»›i. Má»—i developer sáº½ pull vÃ  push vá»›i origin. BÃªn cáº¡nh Ä‘Ã³, má»—i ngÆ°á»i cÃ³ thá»ƒ pull nhá»¯ng thay Ä‘á»•i tá»« nhá»¯ng ngÆ°á»i khÃ¡c Ä‘á»ƒ táº¡o thÃ nh cÃ¡c sub teams. Äiá»u nÃ y sáº½ thá»±c sá»± cÃ³ Ã­ch khi pháº£i lÃ m viá»‡c nhÃ³m 2-3 ngÆ°á»i trá»Ÿ lÃªn Ä‘á»ƒ hoÃ n thÃ nh má»™t feature lá»›n, mÃ  khÃ´ng pháº£i Ä‘áº©y source code váº«n Ä‘ang dá»Ÿ dang lÃªn origin. á» hÃ¬nh váº½ bÃªn trÃªn, cÃ¡c subteams lÃ  Alice-Bob, Alice-David, Clair-David. Vá» máº·t ká»¹ thuáº­t, Ä‘Æ¡n giáº£n lÃ  Alice Ä‘á»‹nh nghÄ©a má»™t Git remote lÃ  bob, trá» Ä‘áº¿n repo cá»§a Bob, vÃ  ngÆ°á»£c láº¡i. Nhá»¯ng branches chÃ­nhRepo trung tÃ¢m sáº½ chá»©a hai branches chÃ­nh hoáº¡t Ä‘á»™ng mÃ£i mÃ£i: master develop NhÃ¡nh master táº¡i origin lÃ  nhÃ¡nh quen thuá»™c vá»›i táº¥t cáº£ cÃ¡c Git users. Song song lÃ  nhÃ¡nh develop. origin/master Ä‘Æ°á»£c coi lÃ  nhÃ¡nh chÃ­nh vá»›i HEAD pháº£n Ã¡nh tráº¡ng thÃ¡i production-ready. origin/develop Ä‘Æ°á»£c coi lÃ  nhÃ¡nh chÃ­nh vá»›i HEAD pháº£n Ã¡nh tráº¡ng thÃ¡i thay Ä‘á»•i má»›i nháº¥t trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn, chuáº©n bá»‹ cho release tiáº¿p theo. Khi source code bÃªn develop Ä‘áº¡t Ä‘áº¿n má»™t má»©c Ä‘á»™ á»•n Ä‘á»‹nh nÃ o Ä‘Ã³ vÃ  sáºµn sÃ ng Ä‘á»ƒ release thÃ¬ sáº½ Ä‘Æ°á»£c merge sang bÃªn master vÃ  Ä‘Ã¡nh dáº¥u vá»›i release number. NhÆ° váº­y, theo Ä‘á»‹nh nghÄ©a vá» nhÃ¡nh master, chÃºng ta máº·c Ä‘á»‹nh hiá»ƒu ráº±ng khi cÃ³ thay Ä‘á»•i Ä‘Æ°á»£c merge vÃ o master thÃ¬ tá»©c lÃ  sáº½ cÃ³ má»™t phiÃªn báº£n production má»›i Ä‘Æ°á»£c release. Nhá» Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng script Ä‘á»ƒ tá»± Ä‘á»™ng build lÃªn production server má»—i khi cÃ³ commit á»Ÿ master. Nhá»¯ng branches phá»¥BÃªn cáº¡nh hai branches chÃ­nh master vÃ  develop, mÃ´ hÃ¬nh mÃ  tÃ´i Ä‘ang sá»­ dá»¥ng cÃ²n cÃ³ thÃªm ráº¥t nhiá»u nhá»¯ng branches phá»¥ Ä‘á»ƒ giÃºp cÃ¡c team members cÃ³ thá»ƒ phÃ¡t triá»ƒn song song, dá»… dÃ ng tracking theo features, chuáº©n bá»‹ cho release hoáº·c fix nhanh cÃ¡c váº¥n Ä‘á» production. KhÃ¡c vá»›i hai branches chÃ­nh kia, cÃ¡c branches phá»¥ nÃ y chá»‰ tá»“n táº¡i trong má»™t khoáº£ng thá»i gian ngáº¯n, rá»“i sáº½ bá»‹ xoÃ¡ Ä‘i. Feature branches Release branches Hotfix branches PhÃ­a trÃªn lÃ  cÃ¡c loáº¡i branches khÃ¡c nhau tÃ´i hay sá»­ dá»¥ng. Má»—i loáº¡i branches láº¡i cÃ³ má»™t nhiá»‡m vá»¥ riÃªng, vÃ  cÃ¡ch xá»­ lÃ½ riÃªng. TÃ´i sáº½ Ä‘i sÃ¢u vÃ o phÃ¢n tÃ­ch á»Ÿ Ä‘oáº¡n sau. Vá» máº·t ká»¹ thuáº­t, cháº£ cÃ³ branch nÃ o lÃ  â€œÄ‘áº·c biá»‡tâ€ so vá»›i cÃ¡c branches khÃ¡c cáº£. Táº¥t cáº£ chá»‰ lÃ  Git branches thÃ´ng thÆ°á»ng, chÃºng chá»‰ Ä‘Æ°á»£c phÃ¢n loáº¡i báº±ng cÃ¡ch ta sá»­ dá»¥ng ra sao thÃ´i. Feature branches TÃ¡ch tá»«: develop Merge vÃ o: develop Naming convention: tá»± do, ngoáº¡i trá»« master, develop, release-, hotfix- Feature branches (hay cÃ²n gá»i lÃ  topic branches) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¡t triá»ƒn cÃ¡c feature má»›i phá»¥c vá»¥ cho release sau nÃ y. Khi báº¯t Ä‘áº§u phÃ¡t triá»ƒn má»™t chá»©c nÄƒng, cÃ³ thá»ƒ chÆ°a rÃµ Ä‘Æ°á»£c thá»i Ä‘iá»ƒm chá»©c nÄƒng Ä‘Ã³ Ä‘Æ°á»£c tÃ­ch há»£p vÃ o há»‡ thá»‘ng vÃ  release. Feature branch sáº½ tá»“n táº¡i trong quÃ¡ trÃ¬nh chá»©c nÄƒng Ä‘Æ°á»£c phÃ¡t triá»ƒn, cuá»‘i cÃ¹ng sáº½ Ä‘Æ°á»£c merge láº¡i vÃ o develop (khi quyáº¿t Ä‘á»‹nh láº§n release tá»›i bao gá»“m chá»©c nÄƒng Ä‘Ã³) hoáº·c bá»‹ bá» Ä‘i (khi tháº¥y chá»©c nÄƒng khÃ´ng cÃ²n cáº§n thiáº¿t). Vá» cÆ¡ báº£n thÃ¬ feature branches chá»‰ tá»“n táº¡i á»Ÿ repos cá»§a developers, chá»© ko pháº£i á»Ÿ origin. Táº¡o feature branch1$ git checkout -b myfeature develop Merge vÃ o develop1234$ git checkout develop$ git merge --no--ff myfeature$ git branch -d myfeature$ git push origin develop â€“no-ff giÃºp thao tÃ¡c merge luÃ´n táº¡o ra má»™t commit má»›i, ngay cáº£ khi cÃ³ thá»ƒ merge theo fast-forward. Flag nÃ y giÃºp chÃºng ta khÃ´ng bá»‹ máº¥t thÃ´ng tin liÃªn quan Ä‘áº¿n lá»‹ch sá»­ cÃ¡c commits cá»§a feature branch. á» trÆ°á»ng há»£p bÃªn pháº£i, khÃ´ng thá»ƒ nháº­n biáº¿t Ä‘Æ°á»£c nhá»¯ng commits nÃ o phÃ¡t triá»ƒn cÃ¹ng chá»©c nÄƒng náº¿u khÃ´ng ngá»“i Ä‘á»c log message cá»§a tá»«ng commit. Khi dáº¥y, náº¿u muá»‘n revert láº¡i cáº£ feature (pháº£i revert nhiá»u commits liÃªn quan) thÃ¬ thá»±c sá»± lÃ  Ä‘au Ä‘áº§u. VÃ  Ä‘Ã³ lÃ  lÃ½ do mÃ  â€“no-ff Ä‘Æ°á»£c sá»­ dá»¥ng. ÄÆ°Æ¡ng nhiÃªn, nÃ³ sáº½ táº¡o ra thÃªm vÃ i commit, nhÆ°ng cháº£ cÃ³ váº¥n Ä‘á» gÃ¬ cáº£. Release branches TÃ¡ch tá»«: develop Merge vÃ o: develop vÃ  master Naming convention: release-* Release branches Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chuáº©n bá»‹ cho release báº£n production má»›i. Táº¥t cáº£ cÃ¡c cÃ´ng viá»‡c cuá»‘i cÃ¹ng trÆ°á»›c khi release sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n á»Ÿ Ä‘Ã¢y, ngoÃ i ra cÃ²n Ä‘á»ƒ fix ná»‘t cÃ¡c bugs láº» táº», chuáº©n bá»‹ meta-data (version number, build dates, etc..). Nhá» viá»‡c tÃ¡ch nhÃ¡nh ra khá»i develop, chÃºng ta cÃ³ thá»ƒ tiáº¿p tá»¥c phÃ¡t triá»ƒn cÃ¡c features cho Ä‘á»£t release khÃ¡c má»™t cÃ¡ch bÃ¬nh thÆ°á»ng. Thá»i Ä‘iá»ƒm Ä‘Æ°á»£c lá»±a chá»n Ä‘á»ƒ tÃ¡ch nhÃ¡nh tá»« develop lÃ  khi develop pháº£n Ã¡nh Ä‘Æ°á»£c tráº¡ng thÃ¡i mong muá»‘n cho viá»‡c release má»›i. Ãt nháº¥t lÃºc Ä‘Ã³ táº¥t cáº£ cÃ¡c features dÃ nh cho Ä‘á»£t release pháº£i Ä‘Æ°á»£c merge vÃ o develop rá»“i. Nhá»¯ng features nháº¯m Ä‘áº¿n cÃ¡c láº§n release sau thÃ¬ chÆ°a Ä‘Æ°á»£c merge vÃ o, pháº£i Ä‘á»£i sau khi tÃ¡ch nhÃ¡nh. ChÃºng ta sáº½ tiáº¿n hÃ nh Ä‘Ã¡nh version theo rule cá»§a dá»± Ã¡n ngay sau khi táº¡o release branch. Táº¡o release branch123$ git checkout -b release-1.2 develop$ ./bump-version.sh 1.2$ git commit -a -m &quot;Bumped version number to 1.2&quot; á» vÃ­ dá»¥ trÃªn, bump-version.sh tÆ°á»£ng trÆ°ng cho má»™t script thay Ä‘á»•i má»™t vÃ i files trong source code Ä‘á»ƒ pháº£n Ã¡nh version má»›i. Sau khi táº¡o branch má»›i vÃ  chuyá»ƒn sang branch Ä‘Ã³, chÃºng ta sáº½ thá»±c hiá»‡n nÃ¢ng version, rá»“i commit thao tÃ¡c Ä‘Ã³. Branch má»›i nÃ y sáº½ tá»“n táº¡i cho Ä‘áº¿n khi viá»‡c release Ä‘Æ°á»£c thá»±c hiá»‡n gá»n gháº½. Trong khoáº£ng thá»i gian Ä‘Ã³, cÃ³ thá»ƒ thá»±c hiá»‡n fix bugs á»Ÿ branch nÃ y, tuy nhiÃªn nghiÃªm cáº¥m viá»‡c bá»• sung feature má»›i lÃªn Ä‘Ã³. Tá»‘t nháº¥t náº¿u cÃ³ features má»›i thÃ¬ hÃ£y merge vÃ o develop, vÃ  Ä‘á»£i Ä‘á»£t release sau. Káº¿t thÃºc release branchKhi source code trÃªn release branch sáºµn sÃ ng Ä‘á»ƒ release, Ä‘áº§u tiÃªn, pháº£i merge vÃ o master, sau Ä‘Ã³ pháº£i Ä‘c merge láº¡i vÃ o develop Ä‘á»ƒ nhá»¯ng láº§n release sau cÅ©ng chá»©a nhá»¯ng thay Ä‘á»•i á»Ÿ láº§n nÃ y. 123$ git checkout master$ git merge --no-ff release-1.2$ git tag -a 1.2 Váº­y lÃ  source code Ä‘Ã£ Ä‘Æ°á»£c release lÃªn master, vÃ  Ä‘Ã£ Ä‘Æ°á»£c tag Ä‘á»ƒ tiá»‡n sau nÃ y tham chiáº¿u. 12$ git checkout develop$ git merge --no-ff release-1.2 á» bÆ°á»›c nÃ y, ráº¥t cÃ³ thá»ƒ sáº½ cÃ³ confict, nÃªn hÃ£y fix nÃ³ rá»“i commit nhÃ©. BÃ¢y giá» thÃ¬ viá»‡c release Ä‘Ã£ hoÃ n thÃ nh, vÃ  chÃºng ta ko cáº§n Ä‘áº¿n branch nÃ y ná»¯a. 1$ git branch -d release-1.2 Hotfix branches TÃ¡ch tá»«: master Merge vÃ o: develop vÃ  master Naming convention: hotfix-* Hotfix branches cÅ©ng giá»‘ng release branches á»Ÿ chá»— Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chuáº©n bá»‹ cho viá»‡c release production má»›i, chá»‰ khÃ¡c á»Ÿ chá»— lÃ  ko cÃ³ plan tá»« trÆ°á»›c. Khi cÃ³ má»™t bug nghiÃªm trá»ng trÃªn báº£n production cáº§n Ä‘Æ°á»£c giáº£i quyáº¿t ngay láº­p tá»©c, má»™t hotfix branch sáº½ Ä‘Æ°á»£c tÃ¡ch ra tá»« master vÃ  Ä‘Æ°á»£c Ä‘Ã¡nh version Ä‘á»ƒ nháº­n biáº¿t. Æ¯u Ä‘iá»ƒm cá»§a viá»‡c tÃ¡ch nhÃ¡nh nÃ y á»Ÿ chá»— cÃ¡c team members khÃ¡c cÃ³ thá»ƒ tiáº¿p tá»¥c cÃ´ng viá»‡c á»Ÿ develop trong khi nhá»¯ng ngÆ°á»i khÃ¡c cÃ³ thá»ƒ táº­p trung vÃ o fix bug cá»§a production. Táº¡o hotfix branchHotfix branch Ä‘Æ°á»£c táº¡o ra tá»« master. VÃ­ dá»¥ hiá»‡n táº¡i version 1.2 lÃ  phiÃªn báº£n production Ä‘ang cháº¡y vÃ  xuáº¥t hiá»‡n lá»—i nghiÃªm trá»ng. Tuy nhiÃªn source code trÃªn develop váº«n chÆ°a á»•n Ä‘á»‹nh, vÃ¬ tháº¿ chÃºng ta pháº£i tÃ¡ch nhÃ¡nh hotfix vÃ  tiáº¿n hÃ nh sá»­a lá»—i. 123$ git checkout -b hotfix-1.2.1 master$ ./bump-version.sh 1.2.1$ git commit -a -m &quot;Bumped version number to 1.2.1&quot; Sau khi tÃ¡ch nhÃ¡nh pháº£i tiáº¿n hÃ nh up version luÃ´n nhÃ©! Sau khi sá»­a lá»—i, hÃ£y thá»±c hiá»‡n commit. 1$ git commit -m &quot;Fixed severe production problem&quot; Káº¿t thÃºc hotfix branchSau khi káº¿t thÃºc sá»­a lá»—i, nhá»¯ng thay Ä‘á»•i pháº£i Ä‘Æ°á»£c merge láº¡i master, Ä‘á»“ng thá»i cÅ©ng pháº£i merge vÃ o develop Ä‘á»ƒ ngÄƒn lá»—i xáº£y ra á»Ÿ nhá»¯ng láº§n release sau. Nghe ráº¥t giá»‘ng vá»›i xá»­ lÃ½ trÃªn release branch pháº£i khÃ´ng. 123456$ git checkout master$ git merge --no-ff hotfix-1.2.1$ git tag -a 1.2.1$ git checkout develop$ git merge --no-ff hotfix-1.2.1 Tuy nhiÃªn, cÃ³ má»™t Ä‘iá»ƒm cáº§n lÆ°u Ã½ ráº±ng: khi Ä‘ang tá»“n táº¡i má»™t release branch thÃ¬ cáº§n pháº£i merge hotfix vÃ o release branch Ä‘Ã³, thay cho develop. Khi release branch Ä‘Æ°á»£c merge vÃ o develop thÃ¬ cuá»‘i cÃ¹ng nhá»¯ng thay Ä‘á»•i trong hotfix cÅ©ng Ä‘Æ°á»£c merge vÃ o develop, nÃªn khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ cáº£. Trá»« khi thá»±c sá»± cÃ´ng viá»‡c á»Ÿ develop cáº§n pháº§n hotfix ngay láº­p tá»©c vÃ  ko thá»ƒ Ä‘á»£i release branch Ä‘Æ°á»£c merge, thÃ¬ cáº§n cáº©n tháº­n merge hotfix vÃ o develop. Cuá»‘i cÃ¹ng, chÃºng ta cÅ©ng ko cáº§n Ä‘áº¿n branch nÃ y ná»¯a: 1$ git branch -d hotfix-1.2.1","categories":[],"tags":[{"name":"git","slug":"git","permalink":"http://nthung2112.github.io/tags/git/"},{"name":"gitflow","slug":"gitflow","permalink":"http://nthung2112.github.io/tags/gitflow/"}]},{"title":"Giá»›i thiá»‡u vá» Atomic CSS","slug":"Gioi-thieu-ve-Atomic-CSS","date":"2019-01-06T10:18:00.000Z","updated":"2019-01-06T10:39:27.084Z","comments":true,"path":"2019/01/Gioi-thieu-ve-Atomic-CSS.html","link":"","permalink":"http://nthung2112.github.io/2019/01/Gioi-thieu-ve-Atomic-CSS.html","excerpt":"","text":"Nhá»¯ng váº¥n Ä‘á» vá»›i cÃ¡ch viáº¿t CSS hiá»‡n táº¡iSpecificity war, thÃ¢m cung ná»™i chiáº¿nBáº¡n cÃ²n nhá»› láº§n Ä‘áº§u báº¡n viáº¿t CSS giá»‘ng nhÆ° tháº¿ nÃ o khÃ´ng? CÃ³ thá»ƒ lÃ  khai bÃ¡o style cho má»™t tháº» HTML nÃ o Ä‘Ã³. 1234567a &#123; text-decoration: none;&#125;p &#123; color: rainbow;&#125; Sau Ä‘Ã³ báº¡n biáº¿t thÃªm vá» ID vÃ  class: 12345678910#header &#123; margin: 10px; text-align: center; color: fabulous;&#125;.text &#123; font-weight: 700; font-size: 20px;&#125; VÃ  báº¡n há»c Ä‘Æ°á»£c cÃ¡ch xá»­ lÃ½ cÃ¡c pseudo selectors, hoáº·c khai bÃ¡o cho cÃ¡c pháº§n tá»­ anh chá»‹ em con chÃ¡u há» hÃ ng, v.vâ€¦ 12345678#header &gt; a:first-child &#123; color: unicorn;&#125;#header p &gt; a.text::before &#123; content: 'â›“'; font-family: Comic Sans;&#125; Rá»“i khi báº¡n Ä‘Ã£ quen vá»›i CSS vÃ  báº¯t tay vÃ o lÃ m dá»± Ã¡n thá»±c táº¿, báº¡n bÃ ng hoÃ ng nháº­n ra káº» thÃ¹ khÃ´ng á»Ÿ Ä‘Ã¢u xa, chÃºng Ä‘ang lá»Ÿn vá»Ÿn quanh ta Ã­ mÃ . Báº¡n bÆ°á»›c vÃ o cuá»™c chiáº¿n gá»i lÃ  â€œspecificity warâ€, Ä‘Ã¡nh nhau tÆ¡i bá»i khÃ³i lá»­a vá»›i class Ä‘Æ°á»£c viáº¿t bá»Ÿi cÃ¡c chiáº¿n há»¯u trong team. Quáº£ lÃ  má»™t tráº­n Ä‘áº¥u kinh hoÃ ng khi ai cÅ©ng muá»‘n Ä‘Ã¨ Ä‘áº§u cÆ°á»¡i cá»• (override) ngÆ°á»i Ä‘i trÆ°á»›c. Káº» náº¯m giá»¯ !important trong tay cá»© nghÄ© Ä‘Ã£ gáº§n vá»›i chiáº¿n tháº¯ng, nÃ o ngá» xuáº¥t hiá»‡n tiá»ƒu nhÃ¢n dÃ¹ng inline style + !important. TÃ¬nh anh em sá»©t máº», chiáº¿n há»¯u quay Ä‘áº§u khÃ´ng nhÃ¬n máº·t nhau. Báº¡n á»©c cháº¿ vÃ  gÃ o lÃªn â€œÄ‘áº­u phá»™ng CSS ğŸ¥œâ€. Specificity lÃ  gÃ¬? Specificity lÃ  má»™t trá»ng sá»‘ Ä‘Æ°á»£c trÃ¬nh duyá»‡t sá»­ dá»¥ng Ä‘á»ƒ quyáº¿t Ä‘á»‹nh CSS style nÃ o sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng cho cÃ¡c element. Specificity Ä‘Æ°á»£c tÃ­nh toÃ¡n dá»±a vÃ o phÃ¢n loáº¡i selector vÃ  sá»‘ lÆ°á»£ng selector Ã¡p dá»¥ng lÃªn má»™t element. Báº¡n cÃ³ thá»ƒ Ä‘á»c thÃªm vá» chá»§ Ä‘á» nÃ y á»Ÿ Ä‘Ã¢y hoáº·c trÃªn trang MDN. http://cssspecificity.com minh hoáº¡ khÃ¡ cá»¥ thá»ƒ cÃ¡ch tÃ­nh specificity. Block__Elementâ€“ModifierDÃ¢n tay to máº·t bá»± Ä‘á»c Ä‘áº¿n Ä‘Ã¢y cÃ³ láº½ Ä‘ang Ã¢m tháº§m (hoáº·c cÃ´ng khai) cÆ°á»i kháº©y: â€œAi kÃªu gÃ , xÃ i BEM lÃ  Ä‘Æ°á»£c rá»“iâ€. ChÃ­p chÃ­p ğŸ¥ Cho nhá»¯ng báº¡n chÆ°a biáº¿t: BEM - Block Element Modifier lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘áº·t tÃªn CSS class Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Yandex. Theo lÃ½ thuyáº¿t, BEM giÃºp báº¡n xÃ¢y dá»±ng cÃ¡c class theo tá»«ng block, má»—i block láº¡i cÃ³ element con, vÃ  cÃ¡c element nÃ y cÃ³ thá»ƒ sáº½ cÃ³ giao diá»‡n khÃ¡c nhau tuá»³ thuá»™c vÃ o modifier cá»§a nÃ³. VÃ­ dá»¥ Ä‘Ã¢y lÃ  CSS: 123456789101112131415&gt; /* Block */&gt; .btn &#123;&gt; &#125;&gt; &gt; /* Element */&gt; .btn__price &#123;&gt; &#125;&gt; &gt; /* Modifier */&gt; .btn--big &#123;&gt; &#125;&gt; &gt; .btn--green &#123;&gt; &#125;&gt; Ãp dá»¥ng vÃ o HTML: &lt;button class=&quot;btn btn--big btn--green&quot;&gt;&lt;span class=&quot;btn__price&quot;&gt;$9.99&lt;/span&gt;&lt;/button&gt; HoÃ n toÃ n khÃ´ng sai. BEM lÃ  má»™t phÆ°Æ¡ng phÃ¡p hiá»‡u quáº£ Ä‘á»ƒ chia nhá» trang thÃ nh tá»«ng component, vÃ  báº¡n hoÃ n toÃ n cÃ³ thá»ƒ trÃ¡nh Ä‘Æ°á»£c cuá»™c thÃ¡nh chiáº¿n á»Ÿ trÃªn báº±ng cÃ¡ch chá»‰ sá»­ dá»¥ng class Ä‘Æ°á»£c Ä‘áº·t tÃªn theo BEM. NgoÃ i ra, khi má»™t component khÃ´ng cÃ²n Ä‘Æ°á»£c dÃ¹ng ná»¯a, báº¡n cÃ³ thá»ƒ tá»± tin xoÃ¡ Ä‘i class cá»§a nÃ³ mÃ  khÃ´ng sá»£ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c component khÃ¡c. Tuy nhiÃªn BEM cÅ©ng cÃ³ nhá»¯ng váº¥n Ä‘á» â€œkhÃ³ chá»‹uâ€ mÃ  báº¡n cÃ³ thá»ƒ xem thÃªm á»Ÿ bÃ i viáº¿t Battling BEM CSS: 10 Common Problems And How To Avoid Them. Kinh nghiá»‡m cÃ¡ nhÃ¢n lÃ  khi lÃ m viá»‡c vá»›i BEM, cÃ³ thá»ƒ báº¡n sáº½ bá» kha khÃ¡ thá»i gian chá»‰ Ä‘á»ƒ suy nghÄ© vá» ngá»¯ nghÄ©a (semantics) cá»§a class. Báº¡n sáº½ pháº£i cÃ¢n nháº¯c block nÃ y nÃªn Ä‘áº·t tÃªn lÃ  gÃ¬, nhá»¯ng thÃ nh pháº§n con cá»§a nÃ³ cÃ³ nÃªn lÃ  element hay lÃ  má»™t component khÃ¡c, rá»“i element nÃ y nÃªn cÃ³ tÃªn chi, nÃªn gá»i nÃ³ lÃ  wrapper, container, hay body, v.vâ€¦ Äá»«ng coi thÆ°á»ng viá»‡c Ä‘áº·t tÃªn nhÃ©, má»™t trong nhá»¯ng váº¥n Ä‘á» khÃ³ nhai nháº¥t cá»§a khoa há»c mÃ¡y tÃ­nh Ä‘áº¥y. NgoÃ i ra tÃªn class thÆ°á»ng dÃ­nh liá»n vá»›i cáº¥u trÃºc/ ná»™i dung HTML mÃ  nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng, dáº«n Ä‘áº¿n viá»‡c khi refactor code láº¡i (chuyá»ƒn thÃ nh component tá»•ng quÃ¡t hÆ¡n), chÃºng ta pháº£i tá»‘n thá»i gian suy nghÄ© tÃªn khÃ¡c cho há»£p lÃ½. Vá»›i mÃ¬nh, viá»‡c suy nghÄ© thÃªm vá» ngá»¯ nghÄ©a cho CSS class khÃ´ng Ä‘em láº¡i hiá»‡u quáº£ Ä‘Ã¡ng ká»ƒ. VÃ¬ khÃ´ng giá»‘ng nhÆ° HTML, trÃ¬nh duyá»‡t vÃ  crawlers khÃ´ng quan tÃ¢m báº¡n Ä‘áº·t tÃªn class cÃ³ Ã½ nghÄ©a hay khÃ´ng. ChÃºng chá»‰ cÃ³ giÃ¡ trá»‹ vá»›i láº­p trÃ¬nh viÃªn, vÃ  thÆ°á»ng thÃ¬ chÃºng ta chá»‰ muá»‘n viáº¿t HTML/CSS sao cho giá»‘ng vá»›i thiáº¿t káº¿ tá»« designers nháº¥t mÃ  thÃ´i. TÃ­nh tÃ¡i sá»­ dá»¥ng vÃ  kÃ­ch thÆ°á»›c táº­p tin CSSMá»‰a mai thay, tÃ­nh cháº¥t â€œcascadingâ€ cá»§a CSS vá»‘n Ä‘Æ°á»£c sinh ra Ä‘á»ƒ há»— trá»£ tÃ¡i sá»­ dá»¥ng code láº¡i lÃ  má»™t con dao 2 lÆ°á»¡i vÃ  Ä‘em Ä‘áº¿n phiá»n muá»™n cho biáº¿t bao nhiÃªu ngÆ°á»i. Cascading cÃ¹ng vá»›i specificity lÃ m cho CSS trá»Ÿ nÃªn khÃ³ dá»± Ä‘oÃ¡n vÃ  lá»i khuyÃªn lÃ  háº¡n cháº¿ cascading Ä‘Æ°á»£c bao nhiÃªu hay báº¥y nhiÃªu. Äiá»u nÃ y dáº«n Ä‘áº¿n táº­p tin CSS chá»©a nhiá»u khai bÃ¡o bá»‹ trÃ¹ng láº¯p. 123456789.ie6 #footer-content .flex-control-nav li a,.ie7 #footer-content .flex-control-nav li a,.ie8 #footer-content .flex-control-nav li a &#123; float: left;&#125;#nav.challenger-a li.menu-products &#123; float: left;&#125; Khi dá»± Ã¡n cá»§a báº¡n phÃ¡t triá»ƒn, nhiá»u component xuáº¥t hiá»‡n Ä‘á»“ng nghÄ©a vá»›i kÃ­ch thÆ°á»›c táº­p tin CSS ngÃ y cÃ ng to ra. ÄÃ¡ng buá»“n lÃ , khÃ´ng pháº£i táº¥t cáº£ CSS Ä‘Æ°á»£c gá»­i xuá»‘ng cho ngÆ°á»i dÃ¹ng sáº½ tháº­t sá»± Ä‘Æ°á»£c sá»­ dá»¥ng trong trang. KÃ­ch thÆ°á»›c táº­p tin CSS cá»§a cÃ¡c website lá»›n, tÃ­nh Ä‘áº¿n thÃ¡ng 11 nÄƒm 2016. Nguá»“n: [1] Váº­y atomic CSS giáº£i quyáº¿t Ä‘Æ°á»£c nhá»¯ng váº¥n Ä‘á» trÃªn Ã ?CÃ³ thá»ƒ. NhÆ°ng trÆ°á»›c háº¿t hÃ£y xem atomic CSS lÃ  gÃ¬ Ä‘Ã£. Atomic CSS lÃ  cÃ¡ch khai bÃ¡o cÃ¡c class sao cho má»—i class chá»‰ mÃ´ táº£ má»™t tÃ­nh nÄƒng duy nháº¥t. Äá»ƒ xÃ¢y dá»±ng component lá»›n hÆ¡n, chÃºng ta sáº½ káº¿t há»£p cÃ¡c class nguyÃªn tá»­ nÃ y láº¡i vá»›i nhau. Cháº³ng háº¡n nhÆ°: 12345678910111213.white &#123; color: #fff;&#125;.bg-green &#123; background-color: #3d9970;&#125;.px-10 &#123; padding-left: 10px; padding-right: 10px;&#125;/* OÃ¡t Ä‘á» há»£i (à² _à² ) */ Trong vÃ­ dá»¥ trÃªn, class white chá»‰ lÃ m duy nháº¥t má»™t viá»‡c lÃ  Ä‘á»•i chá»¯ sang mÃ u tráº¯ng, bg-green sáº½ thiáº¿t láº­p ná»n sang mÃ u xanh, trong khi px-10 chá»‰nh padding á»Ÿ bÃªn trÃ¡i vÃ  pháº£i (trá»¥c x/ trá»¥c hoÃ nh) thÃ nh 10px. Má»™t component Ä‘Æ°á»£c viáº¿t theo atomic CSS sáº½ giá»‘ng nhÆ° tháº¿ nÃ y: 123&lt;button class=\"b1 b--green bg-green white br-5 ma-10 f3 ttu fw-400 padding-10\"&gt; &lt;span class=\"bg-dark o4 white padding-x-12 fw-600 br-left-5\"&gt;$9.99&lt;/span&gt; Purchase&lt;/button&gt; See the Pen BEM vs atomic CSS by Ehkoo (@ehkoo) on CodePen. Atomic CSS Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÃ¡c cÃ´ng ty nhÆ° npm, StackOverflow, Heroku, v.vâ€¦ Chuyá»‡n bÃªn lá»: Functional CSS, Atomic CSS, hay Utility-first CSS? â€œFunctional CSSâ€ lÃ  tÃªn gá»i Ä‘áº§u tiÃªn mÃ¬nh báº¯t gáº·p khi tÃ¬m hiá»ƒu vá» cÃ¡ch viáº¿t CSS nÃ y. Tá»« â€œfunctionalâ€ ngoÃ i nghÄ©a nhÆ° trong â€œfunctional programmingâ€ cÃ²n cÃ³ nghÄ©a lÃ  â€œhoáº¡t Ä‘á»™ngâ€ (trÃ­ch tá»« Ä‘iá»ƒn Oxford). Do Ä‘Ã³ â€œfunctional CSSâ€ cÃ³ thá»ƒ hiá»ƒu lÃ  â€œCSS hoáº¡t Ä‘á»™ng Ä‘Æ°á»£câ€, hoÃ n toÃ n khÃ´ng liÃªn quan Ä‘áº¿n Ã½ tÆ°á»Ÿng chÃ­nh: Ä‘áº·t CSS class thÃ nh tá»«ng hÃ m nhá». Má»™t tÃªn gá»i khÃ¡c lÃ  â€œAtomic CSSâ€, theo nghÄ©a má»—i class lÃ  má»™t â€œnguyÃªn tá»­â€ Ä‘á»™c láº­p. TÃªn gá»i nÃ y ráº¥t phÃ¹ há»£p vá»›i tiÃªu chÃ­ chia nhá» class, nhÆ°ng Ä‘Ã¡ng tiáº¿c thay khi nÃ³ â€œcÃ³ thá»ƒâ€ nháº§m láº«n lÃ  cÃ³ liÃªn quan tá»›i phÆ°Æ¡ng thá»©c Atomic Design. NgoÃ i ra, cÃ³ má»™t thÆ° viá»‡n cá»§a Yahoo! cÅ©ng tÃªn lÃ  Atomic CSS. Cuá»‘i cÃ¹ng, â€œUtility-first CSSâ€ cÃ³ láº½ lÃ  tÃªn gá»i mÃ´ táº£ chÃ­nh xÃ¡c nháº¥t. â€œUtility-firstâ€ mang nghÄ©a â€œtáº­p trung xÃ¢y dá»±ng cÃ¡c class há»— trá»£â€. Äiá»ƒm trá»« cá»§a thuáº­t ngá»¯ nÃ y lÃ â€¦tÃªn dÃ i quÃ¡. Suy Ä‘i xÃ©t láº¡i thiá»‡t hÆ¡n thÃ¬ trong bÃ i viáº¿t nÃ y mÃ¬nh chá»n â€œatomic CSSâ€ (chá»¯ â€œaâ€ viáº¿t thÆ°á»ng) vÃ¬â€¦gÃµ nhanh thÃ´i. NhÆ°ng báº¡n Ä‘á»ƒ Ã½ lÃ  3 thuáº­t ngá»¯ nÃ y Ä‘á»u dÃ¹ng chung cho má»™t cÃ¡ch viáº¿t CSS nhÃ©. Váº­y cÃ³ gÃ¬ hay?TrÃ¡nh cáº£nh binh Ä‘aoLá»£i Ã­ch Ä‘áº§u tiÃªn lÃ  cÅ©ng giá»‘ng nhÆ° BEM, atomic CSS chá»‰ cho phÃ©p khai bÃ¡o cÃ¡c class nÃªn chÃºng khÃ´ng xáº£y ra tranh cháº¥p specificity. Äá»“ng thá»i vÃ¬ má»—i class chá»‰ mÃ´ táº£ má»™t tÃ­nh nÄƒng duy nháº¥t, viá»‡c cÃ¡c thuá»™c tÃ­nh giáº«m chÃ¢n lÃªn nhau Ä‘Æ°á»£c háº¡n cháº¿ á»Ÿ má»©c tháº¥p nháº¥t. CÃ²n váº«n ghÃ©t nhau quÃ¡, muá»‘n Ä‘áº¡p nhau cho cháº¿t thÃ¬ Ä‘Ã¢y: 12345678910&lt;div class=\"red\"&gt; Roses are red &lt;div class=\"blue\"&gt; Violets are blue &lt;div class=\"yellow\"&gt; Honey is sweet &lt;div class=\"brown\"&gt;But not as sweet as you&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; Credit: @huytd Táº­p tin CSS nháº¹ hÆ¡nBáº±ng cÃ¡ch xÃ¢y dá»±ng component báº±ng nhá»¯ng class nguyÃªn tá»­, báº¡n khÃ´ng cáº§n pháº£i láº·p Ä‘i láº·p láº¡i nhá»¯ng khai bÃ¡o Ä‘Ã£ cÃ³. Khi nháº­n Ä‘Æ°á»£c thiáº¿t káº¿ cho component má»›i, báº¡n chá»‰ cáº§n káº¿t há»£p nhá»¯ng class Ä‘Ã£ cÃ³ sáºµn vá»›i nhau hoáº·c viáº¿t thÃªm atomic classes. Nhá»¯ng class má»›i xuáº¥t hiá»‡n sáº½ tiáº¿p tá»¥c Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng nÃªn sá»‘ lÆ°á»£ng class báº¡n thÃªm vÃ o sáº½ ngÃ y cÃ ng giáº£m Ä‘i khi tuá»•i thá» cá»§a dá»± Ã¡n dÃ i ra. Trong bÃ i viáº¿t By The Numbers: A Year and Half with Atomic CSS, John Polacek Ä‘Ã£ thá»­ nghiá»‡m chuyá»ƒn Ä‘á»•i tá»« CSS truyá»n thá»‘ng sang atomic CSS vÃ  káº¿t quáº£ lÃ  dung lÆ°á»£ng táº­p tin giáº£m tá»« 123.1KB xuá»‘ng cÃ²n 72.7KB (chÆ°a nÃ©n gzip). Káº¿t quáº£ cuá»‘i cÃ¹ng lÃ  cÃ ng ngÃ y báº¡n sáº½ cÃ ng viáº¿t Ã­t CSS láº¡i. KhÃ´ng pháº£i suy nghÄ© chuyá»‡n Ä‘áº·t tÃªn classVÃ¬ cÃ¡c atomic classes Ä‘Æ°á»£c Ä‘áº·t tÃªn gáº§n vá»›i thuá»™c tÃ­nh cá»§a chÃºng, báº¡n khÃ´ng cáº§n pháº£i suy nghÄ© nÃªn Ä‘áº·t tÃªn gÃ¬. Má»™t lá»£i Ã­ch ná»¯a lÃ  nhÃ¬n vÃ o HTML báº¡n cÃ³ thá»ƒ tÆ°Æ¡ng Ä‘á»‘i biáº¿t Ä‘Æ°á»£c style cá»§a má»™t element. Láº¥y vÃ­ dá»¥: 1234567&lt;!-- BEM --&gt;&lt;button class=\"btn btn--big btn--green\"&gt;&lt;span class=\"btn__price\"&gt;$9.99&lt;/span&gt; Purchase&lt;/button&gt;&lt;!-- atomic CSS --&gt;&lt;button class=\"b1 b--green bg-green white br-5 ma-10 f3 ttu fw-400 padding-10\"&gt; &lt;span class=\"bg-dark o4 white padding-x-12 fw-600 br-left-5\"&gt;$9.99&lt;/span&gt; Purchase&lt;/button&gt; Vá»›i BEM, báº¡n cÃ³ thá»ƒ sÆ¡ Ä‘oÃ¡n â€œÃ  cÃ¡i nÃºt nÃ y lÃ  cÃ¡i nÃºt mÃ u xanh bá»± nÃ¨â€, nhÆ°ng â€œbá»±â€ lÃ  cÃ¡i gÃ¬ â€œbá»±â€, font size hay height, vÃ  cÃ¡i gÃ¬ â€œxanhâ€, chá»¯ xanh, ná»n xanh hay viá»n xanh. Khi Ä‘i Ä‘áº¿n btn__price thÃ¬ hoÃ n toÃ n khÃ´ng thá»ƒ biáº¿t Ä‘Æ°á»£c style cá»§a nÃ³. So sÃ¡nh vá»›i atomic CSS, báº¡n cÃ³ thá»ƒ Ä‘á»c ngay lÃ  â€œnÃºt nÃ y cÃ³ viá»n 1px, viá»n mÃ u xanh, ná»n xanh, chá»¯ tráº¯ng, bo trÃ²n gÃ³c 5px, margin á»Ÿ bá»‘n phÃ­a 10px, font á»Ÿ level 3, chá»¯ Ä‘Æ°á»£c chuyá»ƒn thÃ nh chá»¯ hoa cÃ³ font weight 400, padding bá»‘n phÃ­a 10pxâ€. TÆ°Æ¡ng tá»± vá»›i tháº» SPAN, báº¡n cÃ³ thá»ƒ Ä‘á»c lÃ  â€œná»n Ä‘en cÃ³ opacity 0.4, chá»¯ tráº¯ng, padding trÃ¡i pháº£i 12px, font weight 600, bo trÃ²n gÃ³c bÃªn trÃ¡i 5pxâ€. Liá»‡u viá»‡c Ä‘á»c style nhÆ° tháº¿ nÃ y cÃ³ cáº§n thiáº¿t? Náº¿u báº¡n má»›i báº¯t Ä‘áº§u, cÃ¢u tráº£ lá»i cÃ³ thá»ƒ lÃ  khÃ´ng, nhÆ°ng khi Ä‘Ã£ quen rá»“i, Ä‘á»c class nhanh giÃºp báº¡n debug vÃ  thay Ä‘á»•i style dá»… dÃ ng hÆ¡n. XÃ¢y dá»±ng prototype nhanh hÆ¡nPrototyping, hay lÃ  chuyá»‡n lÃ m nhá»¯ng giao diá»‡n giáº£ Ä‘á»ƒ kiá»ƒm tra UI/UX, khÃ´ng cÃ²n láº¡ vá»›i dÃ¢n lÃ m frontend ná»¯a. Má»™t trong nhá»¯ng lÃ½ do báº¡n chá»n Bootstrap, Foundation, hay Bulmaâ€¦ cho dá»± Ã¡n vÃ¬ Ä‘Æ¡n giáº£n chÃºng cung cáº¥p nhá»¯ng component Ä‘Æ°á»£c xÃ¢y dá»±ng sáºµn, cÃ¹ng vá»›i há»‡ thá»‘ng grid vÃ  cÃ¡c class há»— trá»£. NhÆ°ng rá»“i báº¡n sáº½ lÃ¢m vÃ o cáº£nh Ä‘Ã¡nh nhau vá»›i cÃ¡c class cá»§a framework Ä‘á»ƒ tuá»³ biáº¿n cho phÃ¹ há»£p vá»›i chuáº©n thiáº¿t káº¿. Káº¿t quáº£ ra sao thÃ¬ báº¡n biáº¿t rá»“i. CÃ¡c framework Ä‘Æ°á»£c thiáº¿t káº¿ theo hÆ°á»›ng atomic khÃ´ng cÃ³ nhiá»u component, nhÆ°ng bÃ¹ láº¡i chÃºng khÃ´ng Ä‘áº·t quÃ¡ nhiá»u Ã½ kiáº¿n riÃªng vÃ  Ã©p buá»™c báº¡n pháº£i lÃ m theo. Háº§u háº¿t Ä‘á»u cho phÃ©p báº¡n tuá»³ chá»‰nh mÃ u sáº¯c, kÃ­ch thÆ°á»›c theo Ã½, tá»« Ä‘Ã³ báº¡n cÃ³ thá»ƒ xÃ¢y dá»±ng lÃªn nhá»¯ng component cáº§n thiáº¿t. Háº¡n cháº¿BÃ¹ng ná»• classTachyons lÃ  má»™t trong nhá»¯ng atomic CSS framework phá»• biáº¿n nháº¥t. Trong phiÃªn báº£n 4.10.0, Tachyons há»— trá»£ 37 mÃ u. Giáº£ sá»­ má»—i mÃ u sáº½ cÃ³ class tÆ°Æ¡ng á»©ng vá»›i mÃ u chá»¯, mÃ u ná»n, mÃ u viá»n, hover Ä‘á»•i mÃ u chá»¯, hover Ä‘á»•i mÃ u ná»n, vÃ  hover Ä‘á»•i mÃ u viá»n. Tachyons cÃ³ 3 breakpoints. NhÆ° váº­y tá»•ng sá»‘ class Ä‘Æ°á»£c táº¡o ra lÃ  37 x 8 (thuá»™c tÃ­nh) x 3 = 888 classes. Náº¿u báº¡n pháº£i sá»­ dá»¥ng nhiá»u mÃ u hÆ¡n, vÃ­ dá»¥ nhÆ° color palette cá»§a Material Design, há»— trá»£ nhiá»u thuá»™c tÃ­nh vÃ  pseudo selector hÆ¡n, thÃªm vÃ i breakpoints ná»¯a, báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘oÃ¡n Ä‘Æ°á»£c sá»‘ lÆ°á»£ng class phÃ¬nh ra nhÆ° tháº¿ nÃ o. Thá»±c táº¿ lÃ  khÃ´ng pháº£i táº¥t cáº£ class mÃ u Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng, nÃªn viá»‡c táº¡o ra class Ä‘á»ƒ bao gá»“m táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p lÃ  khÃ´ng cáº§n thiáº¿t. CÃ¡ch giáº£i quyáº¿t á»Ÿ Ä‘Ã¢y lÃ  chá»‰ viáº¿t thÃªm class khi báº¡n tháº­t sá»± cáº§n Ä‘áº¿n nÃ³. TÃ¬m vÃ  thay Ä‘á»•i class theo yÃªu cáº§u má»›i khÃ³ hÆ¡nGiáº£ sá»­ má»™t ngÃ y Ä‘áº¹p trá»i nÃ o Ä‘Ã³, Ä‘á»“ng chÃ­ Nguyá»…n VÄƒn XÃ i NÆ¡ quyáº¿t Ä‘á»‹nh ná»n mÃ u xanh cá»§a táº¥t cáº£ cÃ¡c nÃºt pháº£i Ä‘áº­m hÆ¡n chÃºt xÃ­u, nÃºt bá»± nghÄ©a lÃ  font size pháº£i á»Ÿ level 2. Vá»›i BEM, báº¡n chá»‰ cáº§n thay Ä‘á»•i giÃ¡ trá»‹ cá»§a class .btnâ€“green vÃ  .btnâ€“big lÃ  xong. Trong khi Ä‘Ã³ báº¡n khÃ´ng thá»ƒ Ä‘á»•i mÃ£ mÃ u cá»§a .bg-green bá»Ÿi vÃ¬ thay Ä‘á»•i nÃ y chá»‰ Ã¡p dá»¥ng trÃªn nÃºt vÃ  biáº¿t Ä‘Ã¢u Ä‘Æ°á»£c mÃ u cÅ© váº«n Ä‘Æ°á»£c dÃ¹ng á»Ÿ nÆ¡i khÃ¡c. Báº¡n cÅ©ng khÃ´ng thá»ƒ tuá»³ tiá»‡n tÄƒng font size cá»§a .f3. Giáº£i phÃ¡p an toÃ n nháº¥t lÃ  tÃ¬m táº¥t cáº£ cÃ¡c nÃºt, xoÃ¡ Ä‘i class cÅ© vÃ  thÃªm vÃ o f2 bg-dark-green. Báº¡n tÃ¬m cÃ¡c nÃºt báº±ng cÃ¡ch nÃ o? Search and Replaceâ€¦ bg-green white br-5 ma-10 f3 -&gt; bg-dark-green white br-5 ma-10 f2? Lá»¡ nhÆ° cÃ³ má»™t class nÃ o Ä‘Ã³ chen vÃ o giá»¯a bg-green white br-5 ma-10 letter-spacing-1 f3 vÃ  tháº¿ lÃ  tÃ¨n tÃ©n ten. Náº¿u dá»± Ã¡n cá»§a báº¡n sá»­ dá»¥ng React, Vue, hay cÃ¡c thÆ° viá»‡n há»— trá»£ (web) component khÃ¡c, viá»‡c thay Ä‘á»•i nÃ y khÃ´ng thÃ nh váº¥n Ä‘á». CÃ²n vá»›i thuáº§n HTML thÃ¬â€¦coi bá»™ cá»±c Ä‘Ã³. Báº¡n cÃ³ thá»ƒ Ä‘áº·t tÃªn cho UI component báº±ng data-, nhÆ°ng nhÆ° váº­y markup sáº½ bá»‹ rá»‘i vÃ  á»Ÿ phÃ­a ngÆ°á»i dÃ¹ng, cÃ¡c thuá»™c tÃ­nh nÃ y hoÃ n toÃ n khÃ´ng Ä‘Æ°á»£c dÃ¹ng Ä‘áº¿n. 123&lt;button data-ui-name=\"button-big-green\" class=\"b1 b--green bg-green white br-5 ma-10 f3 ttu fw-400 padding-10\"&gt; &lt;span class=\"bg-dark o4 white padding-x-12 fw-600 br-left-5\"&gt;$9.99&lt;/span&gt; Purchase&lt;/button&gt; Nghi ngá» tá»« cá»™ng Ä‘á»“ngThÃ nh tháº­t mÃ  nÃ³i, atomic CSS ráº¥t khÃ´ng tá»± nhiÃªn khi tiáº¿p xÃºc láº§n Ä‘áº§u tiÃªn. ChÃºng ta Ä‘Ã£ quÃ¡ quen vá»›i cÃ¡ch viáº¿t CSS truyá»n thá»‘ng/ BEM, vÃ  khi nhÃ¬n tháº¥y má»™t Ä‘á»‘ng class Ä‘i chung vá»›i nhá»¯ng cÃ¡i tÃªn xa láº¡ nhÆ° ma, px, hay ttu, nghi ngá» lÃ  pháº£n á»©ng ráº¥t dá»… hiá»ƒu. Váº­y cÃ³ khÃ¡c gÃ¬ inline style? NhÃ¬n sÆ¡ qua thÃ¬ Ä‘Ãºng lÃ  giá»‘ng nhÆ° inline style váº­y, vÃ  ai cÅ©ng biáº¿t inline style lÃ  bad practice. NhÆ°ng atomic classes khÃ¡c hoÃ n toÃ n vÃ  máº¡nh máº½ hÆ¡n inline style nhiá»u. Atomic classes cho phÃ©p báº¡n viáº¿t media queries, @support, pseudo selectors hay sá»­ dá»¥ng animation, nhá»¯ng Ä‘iá»u mÃ  inline style khÃ´ng lÃ m Ä‘Æ°á»£c. VÃ  vÃ¬ atomic CSS Ä‘Æ°á»£c lÆ°u trong táº­p tin CSS, trÃ¬nh duyá»‡t cÃ³ thá»ƒ lÆ°u vÃ o bá»™ nhá»› Ä‘á»‡m, khÃ´ng giá»‘ng nhÆ° inline style. TÃªn class tháº¥y gá»›m Kiá»ƒu viáº¿t táº¯t ma (margin all), px (padding x), ph (padding horizontal) hay bg ráº¥t phá»• biáº¿n trong cá»™ng Ä‘á»“ng atomic CSS. Ban Ä‘áº§u báº¡n cÃ³ thá»ƒ tháº¥y khÃ³ hiá»ƒu vÃ  tá»‘n thá»i gian Ä‘á»ƒ há»c, nhÆ°ng sau má»™t thá»i gian chÃºng sáº½ trá»Ÿ nÃªn tá»± nhiÃªn. NgoÃ i ra cÃ²n má»™t sá»‘ Ã½ kiáº¿n pháº£n Ä‘á»‘i atomic CSS ná»¯a mÃ  náº¿u muá»‘n, báº¡n cÃ³ thá»ƒ Ä‘á»c bÃ i viáº¿t The Problem with Atomic CSS rá»“i tá»± Ä‘Æ°a ra nháº­n xÃ©t. Spoiler alert: khÃ´ng pháº£i táº¥t cáº£ luáº­n Ä‘iá»ƒm trong bÃ i Ä‘á»u há»£p lÃ½. TÃ­ch há»£p vÃ o dá»± Ã¡nNáº¿u báº¡n Ä‘á»c Ä‘áº¿n Ä‘Ã¢y vÃ  khÃ´ng cáº£m tháº¥y atomic CSS lÃ  má»™t Ã½ tÆ°á»Ÿng dá»‹ há»£m thÃ¬ bÃ i viáº¿t nÃ y coi nhÆ° Ä‘Ã£ thÃ nh cÃ´ng. Äá»ƒ dÃ¹ng atomic CSS trong dá»± Ã¡n, báº¡n cÃ³ thá»ƒ chá»n cÃ¡ch dÃ¹ng cÃ¡c thÆ° viá»‡n cÃ³ sáºµn, hoáº·c tá»± xÃ¢y dá»±ng thÆ° viá»‡n riÃªng. DÃ¹ng hÃ ng Äƒn sáºµnCÃ¡ch nÃ y phÃ¹ há»£p vá»›i nhá»¯ng dá»± Ã¡n má»›i hoáº·c báº¡n muá»‘n thá»­ nghiá»‡m vá»›i atomic CSS. Hiá»‡n táº¡i thÃ¬ hai thÆ° viá»‡n phá»• biáº¿n nháº¥t lÃ  Tachyons vÃ  Tailwind. Tachyons cÃ³ lÆ°á»£ng ngÆ°á»i dÃ¹ng Ä‘Ã´ng Ä‘áº£o vÃ¬ xuáº¥t hiá»‡n trÆ°á»›c, nhÆ°ng Tailwind láº¡i máº¡nh máº½ hÆ¡n vÃ¬ cho phÃ©p báº¡n thay Ä‘á»•i mÃ u sáº¯c, kÃ­ch thÆ°á»›c, v.vâ€¦ hoÃ n toÃ n theo Ã½ muá»‘n. KhÃ´ng thÃ¬ báº¡n cÃ³ thá»ƒ dÃ¹ng há»‡ thá»‘ng thiáº¿t káº¿ cá»§a StackOverflow hay Heroku cÅ©ng Ä‘Æ°á»£c. Sá»± tháº­t lÃ  cÃ¡c atomic classes quÃ¡ nhá» nÃªn chÃºng gáº§n nhÆ° giá»‘ng há»‡t nhau á»Ÿ táº¥t cáº£ framework, cÃ³ khÃ¡c chÄƒng chá»‰ lÃ  tÃªn gá»i mÃ  thÃ´i. Tá»± trá»“ngTrong má»™t dá»± Ã¡n Ä‘ang cháº¡y, náº¿u muá»‘n Ã¡p dá»¥ng atomic CSS thÃ¬ khÃ´ng gÃ¬ tá»‘t hÆ¡n lÃ  tá»± trá»“ng láº¥y má»™t framework. CÃ¡c atomic classes ráº¥t nhá» vÃ  Ä‘Æ¡n giáº£n nÃªn hoÃ n toÃ n khÃ´ng cÃ³ gÃ¬ khÃ³ Ä‘á»ƒ tá»± viáº¿t cáº£. Báº¡n cÃ³ thá»ƒ tá»« tá»« bÃ³c tÃ¡ch cÃ¡c thuá»™c tÃ­nh cá»§a cÃ¡c class cÅ© vÃ  chuyá»ƒn chÃºng thÃ nh atomic classes. Dá»± Ã¡n cá»§a báº¡n cÃ³ thá»ƒ sáº¯p xáº¿p cÃ¡c táº­p tin (S)CSS nhÆ° tháº¿ nÃ y. 123456789101112131415161718192021styles/utils/â”œâ”€â”€ _animation.scssâ”œâ”€â”€ _background.scssâ”œâ”€â”€ _border.scssâ”œâ”€â”€ _box-shadow.scssâ”œâ”€â”€ _color.scssâ”œâ”€â”€ _cursor.scssâ”œâ”€â”€ _display.scssâ”œâ”€â”€ _flex.scssâ”œâ”€â”€ _font-size.scssâ”œâ”€â”€ _font-weight.scssâ”œâ”€â”€ _height.scssâ”œâ”€â”€ _letter-spacing.scssâ”œâ”€â”€ _line-height.scssâ”œâ”€â”€ _list.scssâ”œâ”€â”€ _margin.scssâ”œâ”€â”€ _max-width.scssâ”œâ”€â”€ _padding.scssâ”œâ”€â”€ _ratio.scssâ”œâ”€â”€ _text-align.scssâ””â”€â”€ _width.scss Vá» viá»‡c Ä‘áº·t tÃªn, báº¡n cÃ³ thá»ƒ chá»n kiá»ƒu viáº¿t táº¯t px, ma hay ttu nhÆ° trong Tachyons, hoáº·c kiá»ƒu Ä‘áº§y Ä‘á»§ padding-x, margin-all, text-transform-uppercase. CÃ¡i nÃ y tuá»³ thuá»™c vÃ o sá»Ÿ thÃ­ch cá»§a tá»«ng team. NgoÃ i ra, viá»‡c viáº¿t láº·p Ä‘i láº·p láº¡i nhÃ³m class cÃ³ thá»ƒ gÃ¢y nhÃ m chÃ¡n, do Ä‘Ã³ báº¡n Ä‘á»«ng quÃªn táº­n dá»¥ng cÃ¡c cÃ´ng cá»¥ tiá»n xá»­ lÃ½ CSS nhÆ° SASS, LESS, hay Stylus Ä‘á»ƒ cuá»™c sá»‘ng dá»… thá»Ÿ hÆ¡n. Cháº³ng háº¡n nhÆ° Ä‘oáº¡n code dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ táº¡o ra cÃ¡c class liÃªn quan Ä‘áº¿n height: 1234567$list: 28 96 128 640;@each $value in $list &#123; .h-#&#123;$value&#125; &#123; height: #&#123;$value&#125;px; &#125;&#125; Khi cáº§n thÃªm má»™t giÃ¡ trá»‹ má»›i, báº¡n chá»‰ cáº§n bá» nÃ³ vÃ o $list. Báº¡n cÅ©ng cÃ³ thá»ƒ dÃ¹ng mixin Ä‘á»ƒ táº¡o ra cÃ¡c class responsive: 123456789@include media(extra-large) &#123; $list: 28 96 128 640; @each $value in $list &#123; .h-#&#123;$value&#125;-xl &#123; height: #&#123;$value&#125;px; &#125; &#125;&#125; Káº¿tNáº¿u nhÃ³m cá»§a báº¡n Ä‘ang dÃ¹ng BEM hay cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¡t triá»ƒn CSS khÃ¡c vÃ  hÃ i lÃ²ng vá»›i chÃºng, báº¡n cÃ³ thá»ƒ khÃ´ng cáº§n atomic CSS. Atomic CSS khÃ´ng pháº£i sinh ra lÃ  Ä‘á»ƒ triá»‡t tiÃªu BEM, mÃ  bá»• sung vÃ  giÃºp báº¡n lÃ m viá»‡c vá»›i CSS má»™t cÃ¡ch hiá»‡u quáº£ hÆ¡n. Cuá»‘i cÃ¹ng, hÃ£y xem video nÃ y vÃ  quyáº¿t Ä‘á»‹nh cÃ³ nÃªn xÃ i atomic CSS khÃ´ng nhÃ© ;)","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"atomic","slug":"atomic","permalink":"http://nthung2112.github.io/tags/atomic/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P19: BÃªn trong custom element + thá»§ thuáº­t xÃ¢y dá»±ng component tá»‘i Æ°u","slug":"Cach-Javascript-hoat-dong-P19-Ben-trong-custom-element-thu-thuat-xay-dung-component-toi-uu","date":"2019-01-05T17:03:00.000Z","updated":"2019-01-05T17:07:19.212Z","comments":true,"path":"2019/01/Cach-Javascript-hoat-dong-P19-Ben-trong-custom-element-thu-thuat-xay-dung-component-toi-uu.html","link":"","permalink":"http://nthung2112.github.io/2019/01/Cach-Javascript-hoat-dong-P19-Ben-trong-custom-element-thu-thuat-xay-dung-component-toi-uu.html","excerpt":"ÄÃ¢y lÃ  bÃ i cuá»‘i cÃ¹ng trong series rá»“i (cháº¯c váº­y Ã¡, lÃ¢u nay khÃ´ng tháº¥y há» Ä‘Äƒng bÃ i má»›i). Cáº£m Æ¡n má»i ngÆ°á»i Ä‘Ã£ á»§ng há»™ mÃ¬nh trong suá»‘t thá»i gian qua. Tuy nhiÃªn náº¿u SessionStack cÃ³ bÃ i viáº¿t nÃ o má»›i thÃ¬ mÃ¬nh sáº½ cáº­p nháº­t thÃªm. Element: pháº§n tá»­ Custom element: pháº§n tá»­ tÃ¹y chá»n (tá»©c lÃ  nhá»¯ng element do ngÆ°á»i dÃ¹ng tá»± táº¡o ra) Component: thÃ nh pháº§n ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 19 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh.","text":"ÄÃ¢y lÃ  bÃ i cuá»‘i cÃ¹ng trong series rá»“i (cháº¯c váº­y Ã¡, lÃ¢u nay khÃ´ng tháº¥y há» Ä‘Äƒng bÃ i má»›i). Cáº£m Æ¡n má»i ngÆ°á»i Ä‘Ã£ á»§ng há»™ mÃ¬nh trong suá»‘t thá»i gian qua. Tuy nhiÃªn náº¿u SessionStack cÃ³ bÃ i viáº¿t nÃ o má»›i thÃ¬ mÃ¬nh sáº½ cáº­p nháº­t thÃªm. Element: pháº§n tá»­ Custom element: pháº§n tá»­ tÃ¹y chá»n (tá»©c lÃ  nhá»¯ng element do ngÆ°á»i dÃ¹ng tá»± táº¡o ra) Component: thÃ nh pháº§n ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 19 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tTrong bÃ i trÆ°á»›c chÃºng ta Ä‘Ã£ tháº£o luáº­n vá» Shadow DOM API vÃ  1 vÃ i Ã½ tÆ°á»Ÿng vá»‘n lÃ  cÃ¡c máº£nh ghÃ©p cá»§a 1 bá»©c tranh lá»›n hÆ¡n: web components. ToÃ n bá»™ Ã½ tÆ°á»Ÿng Ä‘áº±ng sau tiÃªu chuáº©n web components lÃ  cÃ³ thá»ƒ má»Ÿ rá»™ng cÃ¡c tÃ­nh nÄƒng sáºµn cÃ³ cá»§a HTML báº±ng cÃ¡ch táº¡o ra cÃ¡c element vá»«a nhá» gá»n, hÆ°á»›ng mÃ´ Ä‘un vÃ  cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng nhiá»u láº§n. ÄÃ¢y lÃ  1 tiÃªu chuáº©n tÆ°Æ¡ng Ä‘á»‘i má»›i trong W3C vÃ  Ä‘Ã£ Ä‘Æ°á»£c cháº¥p nháº­n bá»Ÿi Ä‘a sá»‘ cÃ¡c trÃ¬nh duyá»‡t lá»›n vÃ  cÃ³ thá»ƒ tháº¥y nÃ³ xuáº¥t hiá»‡n trong nhiá»u mÃ´i trÆ°á»ng productionâ€¦ dÄ© nhiÃªn lÃ  vá»›i 1 chÃºt sá»± giÃºp Ä‘á»¡ tá»« cÃ¡c thÆ° viá»‡n polyfill mÃ  chÃºng ta sáº½ nÃ³i sau.*_Polyfill lÃ  Ä‘á»ƒ chá»‰ viá»‡c biáº¿n Ä‘á»•i, thay tháº¿ hoáº·c chá»‰nh sá»­a cÃ¡c tÃ­nh nÄƒng má»›i cá»§a ngÃ´n ngá»¯ JS, HTML, CSS sao cho nÃ³ cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c trÃªn cÃ¡c trÃ¬nh duyá»‡t cÅ© nhÆ° IE NhÆ° cÃ¡c báº¡n Ä‘Ã£ biáº¿t, trÃ¬nh duyá»‡t cung cáº¥p cho chÃºng ta 1 sá»‘ Ã­t cÃ¡c cÃ´ng cá»¥ quan trá»ng Ä‘á»ƒ xÃ¢y dá»±ng website vÃ  cÃ¡c webapp. Ta Ä‘ang nÃ³i vá» HTML, CSS &amp; Javascript. Báº¡n dÃ¹ng HTML Ä‘á»ƒ kiáº¿n trÃºc nÃªn app cá»§a báº¡n, CSS Ä‘á»ƒ trang Ä‘iá»ƒm vÃ  lÃ m cho nÃ³ Ä‘áº¹p hÆ¡n rá»“i dÃ¹ng Javascript thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng khÃ¡c. Tuy nhiÃªn, trÆ°á»›c khi web components Ä‘Æ°á»£c giá»›i thiá»‡u thÃ¬ khÃ´ng cÃ³ cÃ¡ch nÃ o dá»… dÃ ng Ä‘á»ƒ liÃªn káº¿t cÃ¡c hÃ nh vi cá»§a Javascript Ä‘áº¿n vá»›i kiáº¿n trÃºc cá»§a HTML. Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» ná»n táº£ng cá»§a web component: custom element. NÃ³i ngáº¯n gá»n, API custom element cho phÃ©p báº¡n táº¡o ra cÃ¡c custom HTML element vá»›i logic Javascript vÃ  CSS style tÃ­ch há»£p sáºµn. Ráº¥t nhiá»u ngÆ°á»i cáº£m tháº¥y bá»‘i rá»‘i nháº§m láº«n custom element vá»›i Shadow DOM. NhÆ°ng chÃºng lÃ  2 Ã½ tÆ°á»Ÿng hoÃ n toÃ n khÃ¡c nhau vÃ  chÃºng thá»±c sá»­ bá»• khuyáº¿t cho nhau thay vÃ¬ thay tháº¿ láº«n nhau. Má»™t vÃ i framework vÃ  library nhÆ° Angular, Reactâ€¦ cá»‘ giáº£i quyáº¿t cÃ¹ng 1 váº¥n Ä‘á» báº±ng cÃ¡ch giá»›i thiá»‡u Ã½ tÆ°á»Ÿng riÃªng cá»§a há». Báº¡n cÃ³ thá»ƒ so sÃ¡nh custom element vá»›i Angular directive hoáº·c React component. Tuy nhiÃªn, custom element gáº§n gÅ©i vá»›i trÃ¬nh duyá»‡t mÃ  khÃ´ng yÃªu cáº§u gÃ¬ hÆ¡n ngoÃ i báº£n gá»‘c cá»§a Javascript, HTML, CSS. DÄ© nhiÃªn, Ä‘iá»u nÃ y khÃ´ng cÃ³ nghÄ©a ráº±ng nÃ³ lÃ  báº£n thay tháº¿ cho cÃ¡c Javascript framework Ä‘iá»ƒn hÃ¬nh. CÃ¡c framework hiá»‡n Ä‘áº¡i cho phÃ©p chÃºng ta thá»±c hiá»‡n nhiá»u thá»© hÆ¡n lÃ  chá»‰ giáº£ láº­p hÃ nh vi cá»§a custom element. VÃ¬ tháº¿ mÃ  chÃºng cÃ³ thá»ƒ cÃ¹ng hoáº¡t Ä‘á»™ng bÃªn cáº¡nh nhau. APITrÆ°á»›c khi chÃºng ta Ä‘Ã o sÃ¢u hÆ¡n thÃ¬ hÃ£y cÃ¹ng duyá»‡t qua nhá»¯ng gÃ¬ mÃ  API cung cáº¥p. Object global customElements sáºµn cÃ³ cho ta vÃ i phÆ°Æ¡ng thá»©c: define(tagName, constructor, options): Äá»‹nh nghÄ©a custom element má»›i. NÃ³ nháº­n vÃ o 3 Ä‘á»‘i sá»‘: 1 tháº» tÃªn há»£p lá»‡ cho custom element, Ä‘á»‹nh nghÄ©a lá»›p cho custom element vÃ  1 object options. Hiá»‡n táº¡i thÃ¬ chá»‰ cÃ³ 1 option Ä‘Æ°á»£c há»— trá»£ lÃ  extends, mang giÃ¡ trá»‹ lÃ  1 string chá»‰ Ä‘á»‹nh tÃªn cá»§a element cÃ³ sáºµn Ä‘á»ƒ má»Ÿ rá»™ng. ThÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ táº¡o ra cÃ¡c tÃ¹y biáº¿n cá»§a element sáºµn cÃ³. get(tagName): Tráº£ vá» constructor cá»§a 1 custom element náº¿u nhÆ° element Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a vÃ  ngÆ°á»£c láº¡i thÃ¬ tráº£ vá» undefined. NÃ³ nháº­n vÃ o 1 Ä‘á»‘i sá»‘ duy nháº¥t: tháº» tÃªn há»£p lá»‡ cá»§a custom element. whenDefined(tagName): Tráº£ vá» 1 promise vÃ  Ä‘Æ°á»£c resolve khi custom element Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a. Náº¿u nhÆ° element Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a rá»“i thÃ¬ nÃ³ sáº½ resolve ngay láº­p tá»©c. Promise bá»‹ reject náº¿u nhÆ° tháº» tÃªn khÃ´ng pháº£i lÃ  tÃªn há»£p lá»‡ cá»§a custom element. NÃ³ nháº­n vÃ o 1 Ä‘á»‘i sá»‘: tháº» tÃªn há»£p lá»‡ cá»§a 1 custom element. CÃ¡ch táº¡o custom elementTáº¡o ra custom element ráº¥t Ä‘Æ¡n giáº£n. Báº¡n chá»‰ cáº§n lÃ m 2 viá»‡c: Ä‘á»‹nh nghÄ©a 1 lá»›p cho element vÃ  cho nÃ³ extends tá»« lá»›p HTMLElement, viá»‡c thá»© 2 lÃ  Ä‘Äƒng kÃ½ tÃªn cho element Ä‘Ã³: 12345678910class MyCustomElement extends HTMLElement &#123; constructor() &#123; super(); // â€¦ &#125; // â€¦&#125;customElements.define('my-custom-element', MyCustomElement); Hoáº·c náº¿u muá»‘n thÃ¬ báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng anonymous class (lá»›p vÃ´ danh) trong trÆ°á»ng há»£p báº¡n muá»‘n code gá»n gÃ ng hÆ¡n 1 chÃºt: 12345678customElements.define('my-custom-element', class extends HTMLElement &#123; constructor() &#123; super(); // â€¦ &#125; // â€¦&#125;); NhÆ° cÃ¡c báº¡n Ä‘Ã£ tháº¥y, custom element Ä‘Æ°á»£c Ä‘Äƒng kÃ½ báº±ng phÆ°Æ¡ng thá»©c customElements.define(â€¦) Custom element giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬ ?Váº­y chá»© váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  gÃ¬? Div soups cháº³ng háº¡n. Tháº¿ div soups lÃ  cÃ¡i ná»“i gÃ¬? ThÃ¬ rÃµ theo nghÄ©a Ä‘en thÃ¬ nÃ³ lÃ  cÃ¡i ná»“i sÃºp tháº» div. Trong cÃ¡c á»©ng dá»¥ng webapp hiá»‡n Ä‘áº¡i thÃ¬ Ä‘Ã¢y lÃ  kiá»ƒu kiáº¿n trÃºc ráº¥t phá»• biáº¿n khi ta cÃ³ ráº¥t nhiá»u cÃ¡c tháº» div lá»“ng nhau nhÆ° tháº¿ nÃ y Ä‘Ã¢y: 12345678910111213&lt;div class=\"top-container\"&gt; &lt;div class=\"middle-container\"&gt; &lt;div class=\"inside-container\"&gt; &lt;div class=\"inside-inside-container\"&gt; &lt;div class=\"are-we-really-doing-this\"&gt; &lt;div class=\"mariana-trench\"&gt; â€¦ &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; Kiá»ƒu kiáº¿n trÃºc nhÆ° tháº¿ nÃ y thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng vÃ¬ nÃ³ báº£o trÃ¬nh duyá»‡t pháº£i render nhá»¯ng gÃ¬ mÃ  developer muá»‘n. NhÆ°ng nÃ³ láº¡i lÃ m cho code HTML khÃ³ Ä‘á»c vÃ  ráº¥t khÃ³ báº£o trÃ¬. VÃ­ dá»¥ chÃºng ta cÃ³ 1 component trÃ´ng nhÆ° tháº¿ nÃ y: Váº­y thÃ¬ theo cÃ¡ch cÅ©, HTML sáº½ nhÆ° tháº¿ nÃ y: 12345678910111213141516171819202122232425262728293031323334353637383940&lt;div class=\"primary-toolbar toolbar\"&gt; &lt;div class=\"toolbar\"&gt; &lt;div class=\"toolbar-button\"&gt; &lt;div class=\"toolbar-button-outer-box\"&gt; &lt;div class=\"toolbar-button-inner-box\"&gt; &lt;div class=\"icon\"&gt; &lt;div class=\"icon-undo\"&gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"toolbar-button\"&gt; &lt;div class=\"toolbar-button-outer-box\"&gt; &lt;div class=\"toolbar-button-inner-box\"&gt; &lt;div class=\"icon\"&gt; &lt;div class=\"icon-redo\"&gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"toolbar-button\"&gt; &lt;div class=\"toolbar-button-outer-box\"&gt; &lt;div class=\"toolbar-button-inner-box\"&gt; &lt;div class=\"icon\"&gt; &lt;div class=\"icon-print\"&gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"toolbar-toggle-button toolbar-button\"&gt; &lt;div class=\"toolbar-button-outer-box\"&gt; &lt;div class=\"toolbar-button-inner-box\"&gt; &lt;div class=\"icon\"&gt; &lt;div class=\"icon-paint-format\"&gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; Tuy nhiÃªn, tÆ°á»Ÿng tÆ°á»£ng ráº±ng chÃºng ta cÃ³ thá»ƒ lÃ m nhÆ° tháº¿ nÃ y: 12345678&lt;primary-toolbar&gt; &lt;toolbar-group&gt; &lt;toolbar-button class=\"icon-undo\"&gt;&lt;/toolbar-button&gt; &lt;toolbar-button class=\"icon-redo\"&gt;&lt;/toolbar-button&gt; &lt;toolbar-button class=\"icon-print\"&gt;&lt;/toolbar-button&gt; &lt;toolbar-toggle-button class=\"icon-paint-format\"&gt;&lt;/toolbar-toggle-button&gt; &lt;/toolbar-group&gt;&lt;/primary-toolbar&gt; RÃµ rÃ ng vÃ­ dá»¥ thá»© 2 nhÃ¬n sáº¡ch sáº½ vÃ  gá»n hÆ¡n nhiá»u. Dá»… báº£o trÃ¬, dá»… Ä‘á»c cho cáº£ trÃ¬nh duyá»‡t vÃ  developer. ÄÆ¡n giáº£n hÆ¡n nhiá»u. Váº¥n Ä‘á» tiáº¿p theo lÃ  kháº£ nÄƒng tÃ¡i sá»­ dá»¥ng. CÃ´ng viá»‡c cá»§a developer chÃºng ta Ä‘Ã²i há»i khÃ´ng chá»‰ viáº¿t code hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c mÃ  cÃ²n pháº£i báº£o trÃ¬ Ä‘Æ°á»£c. VÃ  1 Ä‘iá»u lÃ m cho code dá»… báº£o trÃ¬ lÃ  nÃ³ cÃ³ thá»ƒ dá»… dÃ ng tÃ¡i sá»­ dá»¥ng 1 pháº§n nÃ o Ä‘Ã³ cá»§a code thay vÃ¬ pháº£i viáº¿t Ä‘i viáº¿t láº¡i nhiá»u láº§n. DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ Ä‘Æ¡n giáº£n nhÆ°ng báº¡n sáº½ hiá»ƒu Ã½ tÆ°á»Ÿng cá»§a nÃ³. Giáº£ sá»­ ta cÃ³ element sau: 1234&lt;div class=\"my-custom-element\"&gt; &lt;input type=\"text\" class=\"email\" /&gt; &lt;button class=\"submit\"&gt;&lt;/button&gt;&lt;/div&gt; Náº¿u chÃºng ta cáº§n sá»­ dá»¥ng nÃ³ á»Ÿ nÆ¡i nÃ o khÃ¡c thÃ¬ ta sáº½ pháº£i viáº¿t láº¡i Ä‘oáº¡n HTML trÃªn nhiá»u láº§n. Giáº£ sá»­ nhÆ° ta cáº§n thay Ä‘á»•i 1 pháº§n nÃ o Ä‘Ã³ vÃ  Ã¡p dá»¥ng cho má»i element. Ta sáº½ pháº£i Ä‘i tÃ¬m táº¥t cáº£ má»i nÆ¡i cÃ³ Ä‘oáº¡n code Ä‘Ã³ vÃ  chá»‰nh sá»­a chÃ­nh xÃ¡c cÃ¹ng 1 thay Ä‘á»•i y chang nhau ráº¥t nhiá»u láº§n, bÃ¹mâ€¦.. Váº­y thÃ¬ khÃ´ng tá»‘t hÆ¡n náº¿u ta chá»‰ cáº§n nhÆ° váº­y thÃ´i sao: 1&lt;my-custom-element&gt;&lt;/my-custom-element&gt; NhÆ°ng webapp hiá»‡n Ä‘áº¡i khÃ´ng chá»‰ cÃ³ HTML tÄ©nh. Báº¡n cáº§n tÆ°Æ¡ng tÃ¡c vá»›i nÃ³ ná»¯a. VÃ  Ä‘Ã¢y lÃ  lÃºc ta cáº§n Javascript. ThÆ°á»ng thÃ¬ báº¡n sáº½ táº¡o ra 1 vÃ i element, ghÃ©p chÃºng vÃ o báº¥t ká»³ event listener nÃ o mÃ  báº¡n muá»‘n Ä‘á»ƒ cho nÃ³ cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c pháº£n há»“i khi cÃ³ input tá»« ngÆ°á»i dÃ¹ng. Báº¥t ká»ƒ lÃ  click, kÃ©o-tháº£, hover, nháº¥n bÃ n phÃ­m, vÃ¢n vÃ¢n 1234567var myDiv = document.querySelector('.my-custom-element');myDiv.addEventListener('click', _ =&gt; &#123; myDiv.innerHTML = '&lt;b&gt; I have been clicked &lt;/b&gt;';&#125;);&lt;div class=\"my-custom-element\"&gt; I have not been clicked yet.&lt;/div&gt; Vá»›i API custom element, toÃ n bá»™ pháº§n logic nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i vÃ o bÃªn trong chÃ­nh element Ä‘Ã³. Xem vÃ­ dá»¥ bÃªn dÆ°á»›i 123456789101112131415class MyCustomElement extends HTMLElement &#123; constructor() &#123; super(); var self = this; self.addEventListener('click', _ =&gt; &#123; self.innerHTML = '&lt;b&gt; I have been clicked &lt;/b&gt;'; &#125;); &#125;&#125;customElements.define('my-custom-element', MyCustomElement);&lt;my-custom-element&gt; I have not been clicked yet&lt;/my-custom-element&gt; Má»›i Ä‘áº§u nhÃ¬n vÃ o thÃ¬ cÃ³ váº» nhÆ° giáº£i phÃ¡p custom element nÃ y Ä‘Ã²i há»i nhiá»u Javascript. Tuy nhiÃªn trong cÃ¡c á»©ng dá»¥ng thá»±c táº¿ thÃ¬ báº¡n sáº½ hiáº¿m khi gáº·p pháº£i trÆ°á»ng há»£p mÃ  báº¡n táº¡o ra 1 element mÃ  khÃ´ng pháº£i tÃ¡i sá»­ dá»¥ng nÃ³. Má»™t diá»u Ä‘iá»ƒn hÃ¬nh ná»¯a trong cÃ¡c webapp hiá»‡n Ä‘áº¡i lÃ  Ä‘a sá»‘ cÃ¡c element Ä‘á»u Ä‘Æ°á»£c táº¡o ra báº±ng code trong quÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng (dynamic). VÃ¬ tháº¿ báº¡n cáº§n pháº£i xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p riÃªng biá»‡t khi element Ä‘Æ°á»£c thÃªm vÃ o báº±ng Javascript hoáº·c nÃ³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c kia trong kiáº¿n trÃºc HTML. Báº¡n sáº½ cÃ³ toÃ n bá»™ nhá»¯ng tÃ­nh nÄƒng áº¥y náº¿u dÃ¹ng custom element. TÃ³m láº¡i, custom element lÃ m code báº¡n dá»… hiá»ƒu, dá»… báº£o trÃ¬ hÆ¡n, chia nhá» nÃ³ thÃ nh cÃ¡c module khÃ©p kÃ­n nhá» hÆ¡n, cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng. CÃ¡c yÃªu cáº§uTrÆ°á»›c khi báº¡n báº¯t Ä‘áº§u táº¡o custom element cá»§a chÃ­nh mÃ¬nh, báº¡n nÃªn biáº¿t ráº±ng cÃ³ 1 sá»‘ quy táº¯c Ä‘áº·c biá»‡t mÃ  ta pháº£i tuÃ¢n theo: TÃªn pháº£i chá»©a dáº¥u gáº¡ch ngang (-). Báº±ng cÃ¡ch nÃ y bá»™ parser cá»§a HTML má»›i hiá»ƒu Ä‘Æ°á»£c element nÃ o lÃ  do ngÆ°á»i dÃ¹ng táº¡o ra vÃ  element nÃ o lÃ  sáºµn cÃ³. NÃ³ cÅ©ng Ä‘áº£m báº£o ráº±ng khÃ´ng cÃ³ xung Ä‘á»™t khi Ä‘áº·t tÃªn vá»›i cÃ¡c element sáºµn cÃ³ (báº¥t ká»ƒ bÃ¢y giá» hay trong tÆ°Æ¡ng lai, khi má»™t element má»›i Ä‘Æ°á»£c thÃªm vÃ o). VÃ­ dá»¥, &lt;my-custom-element&gt; lÃ  1 tÃªn há»£p lá»‡ trong khi &lt;myCustomElement&gt; vÃ  &lt;my_custom_element&gt; thÃ¬ khÃ´ng. KhÃ´ng Ä‘Æ°á»£c Ä‘Äƒng kÃ½ cÃ¹ng 1 tháº» tÃªn nhiá»u hÆ¡n 1 láº§n. Äiá»u nÃ y sáº½ lÃ m cho trÃ¬nh duyá»‡t báº¯n ra 1 biá»‡t lá»‡ DOMException. Báº¡n khÃ´ng thá»ƒ ghi Ä‘Ã¨ cÃ¡c custom element. Custom element khÃ´ng thá»ƒ tá»± Ä‘Ã³ng tháº». Bá»™ parser HTML chá»‰ cho phÃ©p 1 nhÃ³m cÃ¡c element sáºµn cÃ³ cÃ³ thá»ƒ tá»± Ä‘Ã³ng tháº» cá»§a nÃ³ (vÃ­ dá»¥: &lt;img&gt;, &lt;link&gt;, &lt;br&gt;). CÃ¡c kháº£ nÄƒngVáº­y thÃ¬ báº¡n thá»±c sá»± cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c gÃ¬ vá»›i custom element? VÃ  cÃ¢u tráº£ lá»i lÃ : ráº¥t nhiá»u thá»©. Má»™t trong sá»‘ nhá»¯ng tÃ­nh nÄƒng tá»‘t nháº¥t lÃ  Ä‘á»‹nh nghÄ©a class cá»§a element thá»±c sá»± liÃªn káº¿t Ä‘áº¿n chÃ­nh DOM element cá»§a nÃ³. Äiá»u nÃ y cÃ³ nghÄ©a báº¡n cÃ³ thá»ƒ dÃ¹ng trá»±c tiáº¿p this vá»›i event listener, truy cáº­p vÃ o cÃ¡c property cá»§a nÃ³, truy cáº­p cÃ¡c node con vÃ  vÃ¢n vÃ¢n. 12345678910111213class MyCustomElement extends HTMLElement &#123; // ... constructor() &#123; super(); this.addEventListener('mouseover', _ =&gt; &#123; console.log('I have been hovered'); &#125;); &#125; // ...&#125; DÄ© nhiÃªn lÃ  nÃ³ cho báº¡n kháº£ nÄƒng Ä‘á»ƒ ghi Ä‘Ã¨ láº¡i node con cá»§a 1 element vá»›i ná»™i dung má»›i. VÃ  cÅ©ng dÄ© nhiÃªn lÃ  Ä‘iá»u nÃ y khÃ´ng nÃªn lÃ m, bá»Ÿi vÃ¬ nÃ³ sáº½ dáº«n Ä‘áº¿n nhiá»u váº¥n Ä‘á» khÃ´ng mong muá»‘n. RÃµ rÃ ng náº¿u nhÆ° báº¡n cÃ³ 1 custom element Ä‘ang hoáº¡t Ä‘á»™ng vÃ  Ä‘á»™t nhiÃªn phÃ¡t hiá»‡n ra pháº§n markup cá»§a element cá»§a mÃ¬nh bá»‹ thay Ä‘á»•i thÃ¬ sáº½ bá»‘i rá»‘i láº¯m. CÃ³ 1 vÃ i vá»‹ trÃ­ Ä‘áº·c biá»‡t mÃ  báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a Ä‘á»ƒ thá»±c thi code táº¡i cÃ¡c thá»i Ä‘iá»ƒm cá»¥ thá»ƒ trong vÃ²ng Ä‘á»i cá»§a element. constructor: constructor Ä‘Æ°á»£c gá»i 1 láº§n khi element Ä‘Æ°á»£c táº¡o ra hoáº·c nÃ¢ng cáº¥p (chÃºng ta sáº½ nÃ³i vá» nÃ³ sau). Äa sá»‘ nÃ³ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ khá»Ÿi táº¡o state (tráº¡ng thÃ¡i), gáº¯n káº¿t cÃ¡c event listener, táº¡o shadow DOM, vÃ¢n vÃ¢n. LÆ°u Ã½ báº¡n háº§u nhÆ° cáº§n pháº£i gá»i super() trong constructor. connectedCallback: phÆ°Æ¡ng thá»©c connectedCallback Ä‘Æ°á»£c gá»i má»—i láº§n element Ä‘Æ°á»£c thÃªm vÃ o DOM. NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng (khuyáº¿n nghá»‹ nÃªn dÃ¹ng) Ä‘á»ƒ delay (hoÃ£n láº¡i) vÃ i viá»‡c cho Ä‘áº¿n khi element thá»±c sá»± Ä‘Æ°á»£c gáº¯n vÃ o trang (cháº³ng háº¡n nhÆ° láº¥y tÃ i nguyÃªn tá»« server). disconnectedCallback: tÆ°Æ¡ng tá»± nhÆ° connectedCallback thÃ¬ disconnectedCallback Ä‘Æ°á»£c gá»i khi 1 element bá»‹ láº¥y ra khá»i DOM. ThÆ°á»ng lÃ  Ä‘á»ƒ giáº£i phÃ³ng tÃ i nguyÃªn. LÆ°u Ã½ ráº±ng disconnectedCallback khÃ´ng bao giá» Ä‘Æ°á»£c gá»i náº¿u nhÆ° user Ä‘Ã³ng tab. HÃ£y cáº©n tháº­n vá»›i nhá»¯ng thá»© mÃ  báº¡n khá»Ÿi táº¡o lÃºc Ä‘áº§u. attributeChangedCallback: phÆ°Æ¡ng thá»©c nÃ y Ä‘Æ°á»£c gá»i khi 1 attribute cá»§a element Ä‘Æ°á»£c thÃªm vÃ o, gá»¡ ra, cáº­p nháº­t hoáº·c thay tháº¿. NÃ³ cÅ©ng Ä‘Æ°á»£c gá»i khi element Ä‘Æ°á»£c táº¡o ra bá»Ÿi parser. Tuy nhiÃªn, lÆ°u Ã½ ráº±ng nÃ³ chá»‰ Ã¡p dá»¥ng cho cÃ¡c attribute náº±m trong danh sÃ¡ch an toÃ n (whitelist) cá»§a property observedAttributes addoptedCallback: phÆ°Æ¡ng thá»©c nÃ y Ä‘Æ°á»£c gá»i khi document.adoptNote(â€¦) Ä‘Æ°á»£c gá»i Ä‘á»ƒ Ä‘Æ°a Ä‘Ã³ sang 1 document khÃ¡c. LÆ°u Ã½ ráº±ng táº¥t cáº£ cÃ¡c callbacks á»Ÿ trÃªn Ä‘á»u lÃ  Ä‘á»“ng bá»™. VÃ­ dá»¥, connectedCallback Ä‘Æ°á»£c gá»i ngay láº­p tá»©c sau khi element Ä‘Æ°á»£c thÃªm vÃ o DOM vÃ  trong lÃºc Ä‘Ã³ khÃ´ng cÃ³ gÃ¬ xáº£y ra. Pháº£n chiáº¿u propertyCÃ¡c element HTML sáºµn cÃ³ cung cáº¥p 1 kháº£ nÄƒng ráº¥t tiá»‡n dá»¥ng: pháº£n chiáº¿u property. NghÄ©a lÃ  cÃ¡c giÃ¡ trá»‹ cá»§a 1 vÃ i property Ä‘Æ°á»£c pháº£n chiáº¿u trá»±c tiáº¿p vá» DOM dÆ°á»›i dáº¡ng attribute. Má»™t vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh lÃ  property id. 1myDiv.id = 'new-id'; CÅ©ng sáº½ cáº­p nháº­t DOM thÃ nh: 1&lt;div id=\"new-id\"&gt; ... &lt;/div&gt; VÃ  nÃ³ cÅ©ng Ã¡p dá»¥ng theo hÆ°á»›ng ngÆ°á»£c láº¡i ná»¯a. Pháº§n nÃ y cá»±c ká»³ tiá»‡n lá»£i bá»Ÿi vÃ¬ nÃ³ cho phÃ©p báº¡n cáº¥u hÃ¬nh cÃ¡c element khai bÃ¡o. Custom element khÃ´ng cÃ³ tÃ­nh nÄƒng nhÆ° tháº¿ nÃ y nhÆ°ng cÃ³ 1 cÃ¡ch Ä‘á»ƒ báº¡n tá»± triá»ƒn khai. Ta cÃ³ thá»ƒ cÃ³ Ä‘Æ°á»£c tÃ­nh nÄƒng tÆ°Æ¡ng tá»± khi Ä‘á»‹nh nghÄ©a cÃ¡c getter &amp; setter cho cÃ¡c property. 1234567891011121314151617class MyCustomElement extends HTMLElement &#123; // ... get myProperty() &#123; return this.hasAttribute('my-property'); &#125; set myProperty(newValue) &#123; if (newValue) &#123; this.setAttribute('my-property', newValue); &#125; else &#123; this.removeAttribute('my-property'); &#125; &#125; // ...&#125; Má»Ÿ rá»™ng elementAPI custom element cho phÃ©p báº¡n khÃ´ng chá»‰ táº¡o ra cÃ¡c element HTML mÃ  cÃ²n cÃ³ thá»ƒ má»Ÿ rá»™ng element sáºµn cÃ³. PhÆ°Æ¡ng phÃ¡p nÃ y hoáº¡t Ä‘á»™ng cá»±c tá»‘t cho cáº£ element sáºµn cÃ³ vÃ  custom element. Báº¡n chá»‰ cáº§n má»Ÿ rá»™ng Ä‘á»‹nh nghÄ©a class cá»§a nÃ³ lÃ  Ä‘Æ°á»£c. 12345class MyAwesomeButton extends MyButton &#123; // ...&#125;customElements.define('my-awesome-button', MyAwesomeButton); Hoáº·c trong trÆ°á»ng há»£p cá»§a element cÃ³ sáºµn, ta cáº§n thÃªm 1 param thá»© 3 vÃ o hÃ m customElements.define(â€¦) - má»™t object vá»›i property extends vÃ  giÃ¡ trá»‹ lÃ  tháº» tÃªn cá»§a element Ä‘ang Ä‘Æ°á»£c má»Ÿ rá»™ng. Báº±ng cÃ¡ch nÃ y trÃ¬nh duyá»‡t biáº¿t Ä‘Æ°á»£c chÃ­nh xÃ¡c thÃ¬ element nÃ o Ä‘ang Ä‘Æ°á»£c má»Ÿ rá»™ng bá»Ÿi vÃ¬ cÃ³ ráº¥t nhiá»u element sáºµn cÃ³ cÃ¹ng chia sáº» giao diá»‡n DOM. Náº¿u khÃ´ng chá»‰ Ä‘á»‹nh element nÃ o mÃ  mÃ¬nh muá»‘n má»Ÿ rá»™ng, trÃ¬nh duyá»‡t sáº½ khÃ´ng biáº¿t Ä‘Æ°á»£c chá»©c nÄƒng nÃ o Ä‘ang Ä‘Æ°á»£c má»Ÿ rá»™ng. 12345class MyButton extends HTMLButtonElement &#123; // ...&#125;customElements.define('my-button', MyButton, &#123;extends: 'button'&#125;); Má»™t element gá»‘c má»Ÿ rá»™ng (extended native element) cÃ²n Ä‘Æ°á»£c gá»i lÃ  element Ä‘Æ°á»£c tÃ¹y biáº¿n (customized built-in element). NguyÃªn táº¯c vÃ ng cho báº¡n Ä‘Ã³ lÃ  luÃ´n luÃ´n má»Ÿ rá»™ng cÃ¡c element Ä‘ang tá»“n táº¡i sáºµn. VÃ  lÃ m viá»‡c nÃ y má»™t cÃ¡ch dáº§n dáº§n. NÃ³ cho phÃ©p báº¡n giá»¯ láº¡i táº¥t cáº£ cÃ¡c tÃ­nh nÄƒng trÆ°á»›c Ä‘Ã³ (property, attribute, cÃ¡c hÃ m). ChÃº Ã½ ráº±ng element Ä‘Æ°á»£c tÃ¹y biáº¿n chá»‰ Ä‘Æ°á»£c há»— trá»£ tá»« Chrome 67 trá»Ÿ lÃªn. NÃ³ sáº½ Ä‘Æ°á»£c triá»ƒn khai cho cÃ¡c trÃ¬nh duyá»‡t khÃ¡c ngoáº¡i trá»« Safari. NÃ¢ng cáº¥p elementNhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, chÃºng ta sá»­ dá»¥ng phÆ°Æ¡ng thá»©c customElements.define(â€¦) Ä‘á»ƒ Ä‘Äƒng kÃ½ 1 custom element. NhÆ°ng nÃ³ khÃ´ng cÃ³ nghÄ©a ráº±ng Ä‘Ã³ lÃ  viá»‡c Ä‘áº§u tiÃªn báº¡n pháº£i lÃ m. ÄÄƒng kÃ½ custom element cÃ³ thá»ƒ Ä‘Æ°á»£c hoÃ£n láº¡i sau nÃ y. Ká»ƒ cáº£ sau khi chÃ­nh element Ä‘Ã³ Ä‘Æ°á»£c thÃªm vÃ o DOM. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  nÃ¢ng cáº¥p element. Äá»ƒ giÃºp báº¡n biáº¿t Ä‘Æ°á»£c thá»±c sá»± khi nÃ o thÃ¬ element Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a thÃ¬ trÃ¬nh duyá»‡t cÃ³ cung cáº¥p phÆ°Æ¡ng thá»©c customElements.whenDefine(â€¦). Báº¡n truyá»n tháº» tÃªn cá»§a element vÃ o, nÃ³ tráº£ vá» 1 promise vÃ  sáº½ Ä‘Æ°á»£c resolve khi element Ä‘Äƒng kÃ½ xong. 123customElements.whenDefined('my-custom-element').then(_ =&gt; &#123; console.log('My custom element is defined');&#125;); VÃ­ dá»¥, khi báº¡n muá»‘n delay 1 vÃ i thá»© cho Ä‘áº¿n khi táº¥t cáº£ cÃ¡c element con Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a xong, cá»±c ká»³ cÃ³ Ã­ch khi mÃ  báº¡n cÃ³ cÃ¡c custom element lá»“ng nhau. Thá»‰nh thoáº£ng element cha sáº½ dá»±a vÃ o sá»± triá»ƒn khai cá»§a cÃ¡c element con. Trong trÆ°á»ng há»£p nÃ y báº¡n cáº§n Ä‘áº£m báº£o ráº±ng cÃ¡c element con Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c element cha. Shadow DOMNhÆ° Ä‘Ã£ nÃ³i, custom element vÃ  shadow DOM Ä‘i Ä‘Ã´i vá»›i nhau. Custom element Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ Ä‘Ã³ng gÃ³i logic Javascript vÃ o bÃªn trong 1 element trong khi shadow DOM Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ táº¡o ra 1 mÃ´i trÆ°á»ng khÃ©p kÃ­n cho pháº§n DOM khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi cÃ¡c yáº¿u tá»‘ bÃªn ngoÃ i. MÃ¬nh Ä‘á» nghá»‹ báº¡n nÃªn Ä‘á»c láº¡i bÃ i viáº¿t trÆ°á»›c Ä‘á»ƒ hiá»ƒu thÃªm vá» shadow DOM vÃ  cÃ¡c Ã½ tÆ°á»Ÿng cá»§a nÃ³. Äá»ƒ sá»­ dá»¥ng shadow DOM cho custom element, báº¡n chá»‰ cáº§n Ä‘Æ¡n giáº£n gá»i this.attachShadow 12345678910111213class MyCustomElement extends HTMLElement &#123; // ... constructor() &#123; super(); let shadowRoot = this.attachShadow(&#123;mode: 'open'&#125;); let elementContent = document.createElement('div'); shadowRoot.appendChild(elementContent); &#125; // ...&#125;); TemplateChÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu sÆ¡ vá» template trong bÃ i viáº¿t trÆ°á»›c vá» shadow DOM vÃ  chÃºng xá»©ng Ä‘Ã¡ng cÃ³ 1 bÃ i viáº¿t riÃªng. á» Ä‘Ã¢y chÃºng ta sáº½ Ä‘Æ°a ra 1 vÃ­ dá»¥ Ä‘Æ¡n giáº£n lÃ m tháº¿ nÃ o Ä‘á»ƒ báº¡n cÃ³ thá»ƒ káº¿t há»£p cÃ¡c template vÃ o quÃ¡ trÃ¬nh táº¡o ra custom element. Sá»­ dá»¥ng tháº» &lt;template&gt; báº¡n cÃ³ thá»ƒ khai bÃ¡o tháº» cá»§a 1 máº£nh DOM, má»™t thá»© Ä‘Æ°á»£c parse nhÆ°ng khÃ´ng Ä‘Æ°á»£c render trÃªn trang. 12345678910111213141516171819&lt;template id=\"my-custom-element-template\"&gt; &lt;div class=\"my-custom-element\"&gt; &lt;input type=\"text\" class=\"email\" /&gt; &lt;button class=\"submit\"&gt;&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;let myCustomElementTemplate = document.querySelector('#my-custom-element-template');class MyCustomElement extends HTMLElement &#123; // ... constructor() &#123; super(); let shadowRoot = this.attachShadow(&#123;mode: 'open'&#125;); shadowRoot.appendChild(myCustomElementTemplate.content.cloneNode(true)); &#125; // ...&#125;); Giá» Ä‘Ã¢y chÃºng ta cÃ³ thá»ƒ káº¿t há»£p custom element vá»›i shadow DOM vÃ  template, ta cÃ³ Ä‘Æ°á»£c 1 element khÃ©p kÃ­n trong pháº¡m vi cá»§a chÃ­nh nÃ³ vÃ  cÃ³ kiáº¿n trÃºc HTML riÃªng biá»‡t cÅ©ng nhÆ° Javascript logic StylingChÃºng ta Ä‘Ã£ Ä‘i qua pháº§n cá»§a HTML &amp; Javascript, giá» lÃ  vá» CSS. RÃµ rÃ ng thÃ¬ ta cáº§n 1 cÃ¡ch Ä‘á»ƒ chá»‰nh style cho cÃ¡c element. ChÃºng ta cÃ³ thá»ƒ thÃªm CSS stylesheet vÃ o bÃªn trong shadow DOM nhÆ°ng báº¡n sáº½ tháº¯c máº¯c lÃ  lÃ m tháº¿ nÃ o ta cÃ³ thá»ƒ chá»‰nh style cá»§a element tá»« bÃªn ngoÃ i vá»›i vai trÃ² lÃ  1 user cá»§a element Ä‘Ã³. VÃ  cÃ¢u tráº£ lá»i láº¡i Ä‘Æ¡n giáº£n: báº¡n cá»© style nÃ³ giá»‘ng nhÆ° cÃ¡ch báº¡n lÃ m vá»›i cÃ¡c element gá»‘c. 123456my-custom-element &#123; border-radius: 5px; width: 30%; height: 50%; // ...&#125; LÆ°u Ã½ ráº±ng style Ä‘á»‹nh nghÄ©a tá»« bÃªn ngoÃ i cÃ³ Ä‘á»™ Æ°u tiÃªn cao hÆ¡n vÃ  nÃ³ sáº½ ghi Ä‘Ã¨ style Ä‘á»‹nh nghÄ©a tá»« element. Báº¡n cÅ©ng biáº¿t cÃ³ 1 sá»‘ trÆ°á»ng há»£p khi trang Ä‘Æ°á»£c load nhÆ°ng ná»™i dung trÃªn trang váº«n á»Ÿ dáº¡ng HTML thÃ´ vÃ  chÆ°a Ä‘Æ°á»£c style (flash of unstyled content - FOUC). Báº¡n cÃ³ thá»ƒ ngÄƒn cháº·n tÃ¬nh huá»‘ng nÃ y báº±ng cÃ¡ch Ä‘á»‹nh nghÄ©a style cho cÃ¡c undefined component vÃ  sá»­ dá»¥ng má»™t sá»‘ cÃ¡ch transition khi chÃºng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a xong. Äá»ƒ lÃ m nhÆ° váº­y ta cáº§n dÃ¹ng selector :defined 12345my-button:not(:defined) &#123; height: 20px; width: 50px; opacity: 0;&#125; Element khÃ´ng tá»“n táº¡i (unknown) vÃ  custom element chÆ°a Ä‘á»‹nh nghÄ©a (undefined)TiÃªu chuáº©n HTML ráº¥t linh Ä‘á»™ng vÃ  cho phÃ©p khai bÃ¡o báº¥t ká»³ tháº» nÃ o ta muá»‘n. Náº¿u trÃ¬nh duyá»‡t khÃ´ng thá»ƒ nháº­n ra tháº» Ä‘Ã³ thÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c parse dÆ°á»›i dáº¡ng HTMLUnknownElement. 12345var element = document.createElement('thisElementIsUnknown');if (element instanceof HTMLUnknownElement) &#123; console.log('The selected element is unknown');&#125; Tuy nhiÃªn, Ä‘iá»u nÃ y láº¡i khÃ´ng Ã¡p dá»¥ng vá»›i custom element. Báº¡n cÃ³ nhá»› khi chÃºng ta bÃ n vá» viá»‡c cÃ³ 1 sá»‘ quy táº¯c Ä‘áº·t tÃªn Ä‘á»ƒ Ä‘á»‹nh nghÄ©a custom element? LÃ½ do lÃ  náº¿u nhÆ° trÃ¬nh duyá»‡t nháº­n ra tÃªn há»£p lá»‡ cho 1 custom element thÃ¬ nÃ³ sáº½ parse nÃ³ dÆ°á»›i dáº¡ng HTMLElement vÃ  trÃ¬nh duyá»‡t cÃ¢n nháº¯c Ä‘á»ƒ trá»Ÿ thÃ nh custom element chÆ°a Ä‘á»‹nh nghÄ©a. 12345var element = document.createElement('this-element-is-undefined');if (element instanceof HTMLElement) &#123; console.log('The selected element is undefined but not unknown');&#125; Máº·c dÃ¹ khÃ´ng cÃ³ sá»± khÃ¡c biá»‡t nÃ o cÃ³ thá»ƒ nhÃ¬n báº±ng máº¯t thÆ°á»ng giá»¯a HTMLElement vÃ  HTMLUnknownElement nhÆ°ng cÅ©ng cÃ³ vÃ i thá»© mÃ  ta cáº§n pháº£i nhá»›. Parser sáº½ Ä‘á»‘i xá»­ vá»›i chÃºng khÃ¡c nhau. Náº¿u má»™t element cÃ³ cÃ¡i tÃªn há»£p lá»‡ (theo kiá»ƒu custom element nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn) thÃ¬ sáº½ Ä‘Æ°á»£c kiá»ƒm tra xem nÃ³ cÃ³ pháº§n triá»ƒn khai nÃ o cho custom element khÃ´ng. NÃ³ sáº½ Ä‘Æ°á»£c Ä‘á»‘i xá»­ nhÆ° 1 div bÃ¬nh thÆ°á»ng cho tá»›i khi pháº§n triá»ƒn khai Ä‘Ã³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a. NgÆ°á»£c láº¡i element chÆ°a Ä‘á»‹nh nghÄ©a thÃ¬ khÃ´ng triá»ƒn khai báº¥t ká»³ phÆ°Æ¡ng thá»©c hay property nÃ o. Há»— trá»£ tá»« trÃ¬nh duyá»‡tPhiÃªn báº£n Ä‘áº§u tiÃªn cá»§a custom element Ä‘Æ°á»£c giá»›i thiá»‡u trong Chrome 36+. CÃ¡i gá»i lÃ  API v0 cá»§a custom element mÃ  giá» Ä‘Ã¢y Ä‘Ã£ khÃ´ng dÃ¹ng ná»¯a vÃ  cÃ¢n nháº¯c ráº±ng Ä‘Ã³ lÃ  nhá»¯ng yáº¿u kÃ©m máº·c dÃ¹ váº«n Ä‘ang tá»“n táº¡i. Náº¿u báº¡n muá»‘n tÃ¬m hiá»ƒu vá» v0 thÃ¬ cÃ³ thá»ƒ Ä‘á»c bÃ i viáº¿t á»Ÿ Ä‘Ã¢y. API v1 cá»§a custom element xuáº¥t hiá»‡n ká»ƒ tá»« Chrome 54 vÃ  Safari 10.1 (chá»‰ cÃ³ 1 pháº§n). Microsoft Edge thÃ¬ Ä‘ang trong giai Ä‘oáº¡n thá»­ máº«u vÃ  Mozilla Ä‘Ã£ cÃ³ tá»« v50 nhá»¯ng khÃ´ng Ä‘Æ°á»£c kÃ­ch hoáº¡t sáºµn vÃ  cáº§n ngÆ°á»i dÃ¹ng tá»± kÃ­ch hoáº¡t nÃ³. Hiá»‡n táº¡i chá»‰ cÃ³ cÃ¡c trÃ¬nh duyá»‡t webkit má»›i há»— trá»£ hoÃ n toÃ n. Tuy nhiÃªn nhÆ° Ä‘Ã£ nháº¯c á»Ÿ trÃªn, cÃ³ cÃ¡c polyfill tá»“n táº¡i cho phÃ©p báº¡n dÃ¹ng custom element trÃªn táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t, ká»ƒ cáº£ IE11. Kiá»ƒm tra tÃ­nh kháº£ dá»¥ngÄá»ƒ Ä‘áº£m báº£o trÃ¬nh duyá»‡t cÃ³ há»— trá»£ custom element báº¡n cÃ³ thá»ƒ lÃ m lÃ  thá»±c hiá»‡n 1 bÃ i kiá»ƒm tra nhá» Ä‘á»ƒ xem property customElements cÃ³ tá»“n táº¡i trong object window hay khÃ´ng: 12345const supportsCustomElements = 'customElements' in window;if (supportsCustomElements) &#123; // Báº¡n cÃ³ thá»ƒ dÃ¹ng API Custom elements á»Ÿ Ä‘Ã¢y&#125; Hoáº·c náº¿u ta dÃ¹ng thÆ° viá»‡n polifyll: 1234567891011121314151617181920function loadScript(src) &#123; return new Promise(function(resolve, reject) &#123; const script = document.createElement('script'); script.src = src; script.onload = resolve; script.onerror = reject; document.head.appendChild(script); &#125;);&#125;// Cháº¡y lazy load cho polyfill náº¿u cáº§n thiáº¿tif (supportsCustomElements) &#123; // TrÃ¬nh duyá»‡t há»— trá»£ sáºµn cho custom element. Báº¡n cÃ³ thá»ƒ dÃ¹ng bÃ¬nh thÆ°á»ng.&#125; else &#123; loadScript('path/to/custom-elements.min.js').then(_ =&gt; &#123; // Polyfill cho custom element Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t. Báº¡n cÃ³ thá»ƒ dÃ¹ng bÃ¬nh thÆ°á»ng. &#125;);&#125; Váº­y nÃ³i gá»n gá»n láº¡i, 1 pháº§n cá»§a tiÃªu chuáº©n web component lÃ  custom element cho báº¡n cÃ¡c kháº£ nÄƒng sau: LiÃªn káº¿t Javascript vÃ  CSS vá»›i HTML element Cho phÃ©p báº¡n má»Ÿ rá»™ng cÃ¡c element HTML sáºµn cÃ³ (cáº£ element gá»‘c vÃ  custom element) KhÃ´ng cáº§n thÆ° viá»‡n hay framework ngoÃ i. Báº¡n chá»‰ cáº§n Javascript, HTML vÃ  CSS gá»‘c vÃ  cÃ³ thá»ƒ cáº§n thÃªm thÆ° viá»‡n polyfill Ä‘á»ƒ há»— trá»£ trÃ¬nh duyá»‡t cÅ©. NÃ³ Ä‘Æ°á»£c xÃ¢y dá»±ng Ä‘á»ƒ hoáº¡t Ä‘á»™ng trÆ¡n tru, mÆ°á»£t mÃ  vá»›i cÃ¡c tÃ­nh nÄƒng khÃ¡c cá»§a web component (shadow DOM, template, slots, vÃ¢n vÃ¢n) LiÃªn káº¿t cháº·t cháº½ vá»›i cÃ´ng cá»¥ dev cá»§a trÃ¬nh duyá»‡t. Táº­n dá»¥ng cÃ¡c tÃ­nh nÄƒng tiáº¿p cáº­n sáºµn cÃ³. Custom element khÃ´ng khÃ¡c vá»›i nhá»¯ng thá»© chÃºng ta Ä‘Ã£ dÃ¹ng báº¥y lÃ¢u nay. NÃ³ chá»‰ lÃ  1 cÃ¡ch khÃ¡c Ä‘á»ƒ lÃ m cho má»i viá»‡c dá»… dÃ ng hÆ¡n khi phÃ¡t triá»ƒn webapp. NÃ³ má»Ÿ ra cÃ¡nh cá»•ng Ä‘áº¿n vá»›i viá»‡c xÃ¢y dá»±ng nhá»¯ng app phá»©c táº¡p vá»›i tá»‘c Ä‘á»™ nhanh. Tuy nhiÃªn cÃ ng phá»©c táº¡p thÃ¬ cÃ ng cÃ³ nhiá»u kháº£ nÄƒng cÃ³ lá»—i mÃ  khÃ³ tÃ¬m hiá»ƒu hoáº·c tÃ¡i láº­p. VÃ¬ tháº¿ khi debug ta cáº§n nhiá»u ngá»¯ cáº£nh vÃ  cÃ´ng cá»¥ nhÆ° SessionStack Ä‘á»ƒ há»— trá»£. SessionStack tÃ­ch há»£p vÃ o trong webapp vÃ  báº¯t Ä‘áº§u thu tháº­p cÃ¡c thÃ´ng tin nhÆ° sá»± kiá»‡n ngÆ°á»i dÃ¹ng, dá»¯ liá»‡u máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o debug, thay Ä‘á»•i trÃªn DOM, vÃ¢n vÃ¢n, vÃ  gá»­i chÃºng vá» server cá»§a há». Sau Ä‘Ã³, dá»¯ liá»‡u thu Ä‘Æ°á»£c sáº½ Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»ƒ táº¡o ra Ä‘oáº¡n video tráº£i nghiá»‡m Ä‘á»ƒ báº¡n cÃ³ thá»ƒ xem user Ä‘Ã£ tÆ°Æ¡ng tÃ¡c nhÆ° tháº¿ nÃ o vá»›i sáº£n pháº©m cá»§a báº¡n. BÃªn cáº¡nh nhá»¯ng thÃ´ng tin ká»¹ thuáº­t mÃ  SessionStack Ä‘Ã£ cung cáº¥p thÃ¬ nÃ³ cÃ²n cho phÃ©p báº¡n kháº£ nÄƒng Ä‘á»ƒ tÃ¡i hiá»‡n láº¡i cÃ¡c váº¥n Ä‘á» mÃ  báº¡n khÃ´ng bao giá» biáº¿t Ä‘Æ°á»£c khi debug trÆ°á»›c Ä‘Ã¢y. Äá»ƒ Ä‘áº£m báº£o cho SessionStack luÃ´n luÃ´n thá»±c hiá»‡n Ä‘Æ°á»£c cÃ¡c phiÃªn lÃ m viá»‡c hoÃ n háº£o Ä‘áº¿n tá»«ng pixel thÃ¬ team cá»§a há» Ä‘Ã£ bÃ¡m sÃ¡t láº¥y nhá»¯ng cÃ´ng nghá»‡, framework vÃ  tiÃªu chuáº©n web tiÃªn tiáº¿n cÅ©ng nhÆ° má»›i nháº¥t.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P18: WebRTC & cÆ¡ cháº¿ máº¡ng peer-to-peer","slug":"Cach-Javascript-hoat-dong-P18-WebRTC-co-che-mang-peer-to-peer","date":"2019-01-05T17:00:00.000Z","updated":"2019-01-06T10:16:09.777Z","comments":true,"path":"2019/01/Cach-Javascript-hoat-dong-P18-WebRTC-co-che-mang-peer-to-peer.html","link":"","permalink":"http://nthung2112.github.io/2019/01/Cach-Javascript-hoat-dong-P18-WebRTC-co-che-mang-peer-to-peer.html","excerpt":"ThÃªm má»™t bÃ i ná»¯a mang náº·ng kiáº¿n thá»©c vá» máº¡ng mÃ  mÃ¬nh láº¡i khÃ´ng chuyÃªn vá» máº£ng nÃ y, náº¿u mÃ¬nh dá»‹ch chá»— nÃ o khÃ´ng phÃ¹ há»£p thÃ¬ nhá» má»i ngÆ°á»i giÃºp Ä‘á»¡ nhÃ© @@_ Peer-To-Peer hay P2P: Máº¡ng ngang hÃ ng Real-time: thá»i gian thá»±c ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 18 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh.","text":"ThÃªm má»™t bÃ i ná»¯a mang náº·ng kiáº¿n thá»©c vá» máº¡ng mÃ  mÃ¬nh láº¡i khÃ´ng chuyÃªn vá» máº£ng nÃ y, náº¿u mÃ¬nh dá»‹ch chá»— nÃ o khÃ´ng phÃ¹ há»£p thÃ¬ nhá» má»i ngÆ°á»i giÃºp Ä‘á»¡ nhÃ© @@_ Peer-To-Peer hay P2P: Máº¡ng ngang hÃ ng Real-time: thá»i gian thá»±c ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 18 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tÄáº§u tiÃªn thÃ¬ WebRTC lÃ  cÃ¡i gÃ¬ váº­y? NÃ³ lÃ  viáº¿t táº¯t cá»§a chá»¯ Real Time Communication (Giao tiáº¿p thá»i gian thá»±c), nghe qua cháº¯c báº¡n cÅ©ng Ä‘Ã£ cÃ³ cÃ¡i gÃ¬ sÆ¡ sÆ¡ vá» cÃ´ng nghá»‡ nÃ y rá»“i nhá»‰. WebRTC láº¥p Ä‘áº§y 1 khoáº£ng trá»‘ng lá»›n trong ná»n táº£ng web. TrÆ°á»›c Ä‘Ã¢y, cÃ¡c cÃ´ng nghá»‡ P2P cháº³ng háº¡n nhÆ° nhá»¯ng app chat trÃªn desktop cÃ³ thá»ƒ lÃ m nhá»¯ng viá»‡c mÃ  web khÃ´ng lÃ m Ä‘Æ°á»£c. NhÆ°ng WebRTC Ä‘Ã£ thay Ä‘á»•i Ä‘iá»u Ä‘Ã³. Vá» cÆ¡ báº£n WebRTC cho phÃ©p webapp cÃ³ thá»ƒ thiáº¿t láº­p giao tiáº¿p Peer-To-Peer, chÃ­nh lÃ  ná»™i dung trong bÃ i viáº¿t nÃ y. Ta sáº½ tháº£o luáº­n vá» cÃ¡c chá»§ Ä‘á» sau Ä‘Ã¢y Ä‘á»ƒ cÃ³ thá»ƒ mang Ä‘áº¿n cho báº¡n 1 cÃ¡i nhÃ¬n toÃ n cáº£nh vá» â€œruá»™t gan phÃ¨o phá»•iâ€ cá»§a WebRTC: Giao tiáº¿p Peer-To-Peer TÆ°á»ng lá»­a vÃ  NAT Traversal TÃ­n hiá»‡u (Signaling), PhiÃªn (Session), Giao thá»©c (Protocol) CÃ¡c API cá»§a WebRTC Giao tiáº¿p Peer-To-PeerÄá»ƒ cÃ³ thá»ƒ giao tiáº¿p láº«n nhau thÃ´ng qua trÃ¬nh duyá»‡t web, má»—i trÃ¬nh duyá»‡t cá»§a user pháº£i thá»±c hiá»‡n nhá»¯ng bÆ°á»›c sau Ä‘Ã¢y: Äá»“ng Ã½ Ä‘á»ƒ báº¯t Ä‘áº§u giao tiáº¿p Biáº¿t cÃ¡ch xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a Ä‘á»‘i tÆ°á»£ng VÆ°á»£t qua an ninh vÃ  tÆ°á»Ÿng lá»­a báº£o vá»‡ Chuyá»ƒn giao táº¥t cáº£ cÃ¡c giao tiáº¿p Ä‘a phÆ°Æ¡ng tiá»‡n theo real-time 1 trong sá»‘ nhá»¯ng thÃ¡ch thá»©c lá»›n nháº¥t liÃªn quan Ä‘áº¿n cÃ¡c giao tiáº¿p P2P dá»±a trÃªn trÃ¬nh duyá»‡t lÃ  lÃ m sao Ä‘á»ƒ biáº¿t vá»‹ trÃ­ &amp; thiáº¿t láº­p 1 káº¿t ná»‘i socket máº¡ng (network socket connection) vá»›i 1 trÃ¬nh duyá»‡t khÃ¡c Ä‘á»ƒ váº­n chuyá»ƒn dá»¯ liá»‡u 2 chiá»u. Ta sáº½ xem xÃ©t nhá»¯ng khÃ³ khÄƒn liÃªn quan Ä‘áº¿n viá»‡c thiáº¿t láº­p káº¿t ná»‘i nÃ y. Khi webapp cá»§a báº¡n cáº§n dá»¯ liá»‡u hoáº·c tÃ i nguyÃªn, nÃ³ sáº½ láº¥y vá» tá»« cÃ¡c server. Tuy nhiÃªn, náº¿u báº¡n muá»‘n táº¡o ra 1 á»©ng dá»¥ng video chat cháº³ng háº¡n, báº±ng cÃ¡ch káº¿t ná»‘i trá»±c tiáº¿p Ä‘áº¿n trÃ¬nh duyá»‡t cá»§a ngÆ°á»i khÃ¡c - thÃ¬ Ä‘Ã¢y lÃ  váº¥n Ä‘á», vÃ¬ báº¡n khÃ´ng biáº¿t Ä‘á»‹a chá»‰ bá»Ÿi vÃ¬ trÃ¬nh duyá»‡t cá»§a ngÆ°á»i kia khÃ´ng pháº£i lÃ  1 web server. VÃ¬ váº­y Ä‘á»ƒ cÃ³ thá»ƒ thiáº¿t láº­p 1 káº¿t ná»‘i P2P ta cáº§n ráº¥t nhiá»u thá»©. TÆ°á»ng lá»­a vÃ  NAT TraversalThÆ°á»ng thÃ¬ mÃ¡y tÃ­nh cá»§a báº¡n khÃ´ng khÃ´ng cÃ³ Ä‘á»‹a chá»‰ IP public tÄ©nh. LÃ½ do lÃ  mÃ¡y tÃ­nh cá»§a báº¡n pháº£i nÃºp Ä‘áº±ng sau tÆ°á»ng lá»­a vÃ  thiáº¿t bá»‹ NAT (Network access translation - Bá»™ phiÃªn dá»‹ch truy cáº­p máº¡ng). Thiáº¿t bá»‹ NAT sáº½ dá»‹ch Ä‘á»‹a chá»‰ IP cÃ¡ nhÃ¢n tá»« bÃªn trong tÆ°á»ng lá»­a thÃ nh Ä‘á»‹a chá»‰ IP cÃ´ng khai (public-facing IP). Ta cáº§n cÃ¡c thiáº¿t bá»‹ NAT Ä‘á»ƒ báº£o máº­t vÃ  giáº£i quyáº¿t sá»± giá»›i háº¡n cá»§a IPv4 Ä‘á»‘i vá»›i nhá»¯ng Ä‘á»‹a chá»‰ IP cÃ´ng khai sáºµn cÃ³. ÄÃ³ lÃ  lÃ½ do táº¡i sao webapp khÃ´ng nÃªn giáº£ Ä‘á»‹nh ráº±ng thiáº¿t bá»‹ hiá»‡n táº¡i cÃ³ 1 Ä‘á»‹a chá»‰ IP public tÄ©nh. CÃ¹ng tÃ¬m hiá»ƒu 1 chÃºt vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a cÃ¡c thiáº¿t bá»‹ NAT. Náº¿u nhÆ° báº¡n Ä‘ang á»Ÿ trong mÃ´i trÆ°á»ng cÃ´ng cá»™ng vÃ  káº¿t ná»‘i vÃ o máº¡ng WiFi, mÃ¡y tÃ­nh cá»§a báº¡n sáº½ Ä‘Æ°á»£c gÃ¡n 1 Ä‘á»‹a chá»‰ IP mÃ  nÃ³ chá»‰ tá»“n táº¡i Ä‘áº±ng sau NAT. Giáº£ sá»­ IP lÃ  172.0.23.4, tuy nhiÃªn, vá»›i tháº¿ giá»›i bÃªn ngoÃ i, Ä‘á»‹a chá»‰ IP cá»§a báº¡n cÃ³ thá»ƒ mang giÃ¡ trá»‹ khÃ¡c, vÃ­ dá»¥ 164.53.27.98. VÃ¬ váº­y, tháº¿ giá»›i bÃªn ngoÃ i sáº½ tháº¥y cÃ¡c request cá»§a báº¡n Ä‘áº¿n tá»« Ä‘á»‹a chá»‰ 164.53.27.98 nhÆ°ng thiáº¿t bá»‹ NAT sáº½ Ä‘áº£m báº£o cÃ¡c response cho nhá»¯ng request (Ä‘Æ°á»£c gá»­i tá»« mÃ¡y cá»§a báº¡n) sáº½ tráº£ vá» Ä‘Ãºng chá»— lÃ  172.0.23.4. Æ n trá»i cÃ¡c báº£ng Ã¡nh xáº¡ (mapping table). LÆ°u Ã½ ráº±ng ngoÃ i Ä‘á»‹a chá»‰ IP thÃ¬ cá»•ng (port) cÅ©ng lÃ  Ä‘iá»u kiá»‡n cáº§n thiáº¿t cho cÃ¡c giao tiáº¿p máº¡ng. Do cÃ³ sá»± tham gia cá»§a cÃ¡c thiáº¿t bá»‹ NAT, trÃ¬nh duyá»‡t cá»§a báº¡n cáº§n tÃ¬m Ä‘Æ°á»£c Ä‘á»‹a chá»‰ IP cá»§a mÃ¡y tÃ­nh cÃ³ trÃ¬nh duyá»‡t mÃ  báº¡n muá»‘n giao tiáº¿p. Äáº¿n Ä‘Ã¢y thÃ¬ ta láº¡i pháº£i nhá» Ä‘áº¿n cÃ¡c server STUN (Session Traversal Utilities for NAT - Tiá»‡n Ã­ch truyá»n táº£i theo phiÃªn cho NAT) vÃ  TURN (Traversal Using Relays around NAT - Truyá»n táº£i sá»­ dá»¥ng Ä‘iá»ƒm chuyá»ƒn tiáº¿p vÃ²ng quanh NAT). Äá»ƒ cÃ¡c cÃ´ng nghá»‡ WebRTC hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c, Ä‘áº§u tiÃªn thÃ¬ 1 request há»i Ä‘á»‹a chá»‰ IP public cá»§a báº¡n sáº½ Ä‘Æ°á»£c gá»­i Ä‘áº¿n server STUN. Báº¡n cá»© nghÄ© theo hÆ°á»›ng kiá»ƒu nhÆ° mÃ¡y tÃ­nh Ä‘ang táº¡o truy váº¥n Ä‘áº¿n 1 server tá»« xa Ä‘á»ƒ há»i vá» Ä‘á»‹a chá»‰ IP mÃ  server Ä‘Ã³ nháº­n cÃ¢u truy váº¥n lÃ  bao nhiÃªu. Server tá»« xa sáº½ tráº£ vá» Ä‘á»‹a chá»‰ IP mÃ  nÃ³ tháº¥y. NÃ³i ngáº¯n gá»n lÃ  mÃ¡y tÃ­nh cá»§a báº¡n â€œhá»iâ€ 1 server tá»« xa Ä‘á»‹a chá»‰ IP cá»§a chÃ­nh mÃ¡y báº¡n lÃ  bao nhiÃªu. Giáº£ sá»­ tiáº¿n trÃ¬nh nÃ y hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng vÃ  báº¡n nháº­n Ä‘Æ°á»£c Ä‘á»‹a chá»‰ IP public cá»§a mÃ¬nh cÅ©ng nhÆ° sá»‘ port, báº¡n sáº½ cÃ³ thá»ƒ nÃ³i vá»›i nhá»¯ng peer ngang hÃ ng khÃ¡c lÃ m tháº¿ nÃ o Ä‘á»ƒ káº¿t ná»‘i trá»±c tiáº¿p Ä‘áº¿n báº¡n. Nhá»¯ng peer nÃ y cÅ©ng cÃ³ thá»ƒ lÃ m cÃ¹ng 1 viá»‡c lÃ  sá»­ dá»¥ng STUN &amp; server TURN vÃ  nÃ³i cho báº¡n biáº¿t nÃªn liÃªn láº¡c Ä‘áº¿n Ä‘á»‹a chá»‰ nÃ o. Signaling, Sessions, ProtocolsTÃ­n hiá»‡u, phiÃªn, giao thá»©c QuÃ¡ trÃ¬nh khÃ¡m phÃ¡ thÃ´ng tin máº¡ng Ä‘Æ°á»£c mÃ´ táº£ á»Ÿ trÃªn chá»‰ lÃ  1 pháº§n cá»§a chá»§ Ä‘á» vá» Signaling to bá»± hÆ¡n nhiá»u, trong trÆ°á»ng há»£p cá»§a WebRTC thÃ¬ pháº§n signaling nÃ y dá»±a trÃªn 1 chuáº©n JSEP (Javascript Session Establishment Protocol - Giao thá»©c thiáº¿t láº­p phiÃªn cá»§a Javascript). Signaling bao gá»“m cáº£ khÃ¡m phÃ¡ máº¡ng (network discovery) vÃ  NAT Traversal, táº¡o vÃ  quáº£n lÃ½ phiÃªn, báº£o máº­t giao tiáº¿p, siÃªu dá»¯ liá»‡u (metadata) vÃ  phá»‘i há»£p kháº£ nÄƒng cá»§a media, xá»­ lÃ½ lá»—i. Äá»ƒ káº¿t ná»‘i cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng, peer thu Ä‘Æ°á»£c nhá»¯ng Ä‘iá»u kiá»‡n vá» local media cho metadata (vÃ­ dá»¥: nhá»¯ng kháº£ nÄƒng vá» kÃ­ch thÆ°á»›c vÃ  kiá»ƒu codec) vÃ  gom gÃ³p cÃ¡c Ä‘á»‹a chá»‰ máº¡ng cÃ³ thá»ƒ cÃ³ cho host cá»§a á»©ng dá»¥ng. CÆ¡ cháº¿ signaling dÃ¹ng Ä‘á»ƒ truyá»n tá»›i/lui nhá»¯ng thÃ´ng tin quan trá»ng nÃ y khÃ´ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong API cá»§a WebRTC. Signaling khÃ´ng Ä‘Æ°á»£c quy Ä‘á»‹nh bá»Ÿi chuáº©n WebRTC vÃ  nÃ³ khÃ´ng Ä‘Æ°á»£c triá»ƒn khai báº±ng API cá»§a nÃ³ Ä‘á»ƒ cho phÃ©p sá»­ dá»¥ng má»™t cÃ¡ch linh Ä‘á»™ng cÃ¡c cÃ´ng nghá»‡ vÃ  giao thá»©c cáº§n thiáº¿t. CÃ¡c WebRTC developer sáº½ Ä‘á»‘i phÃ³ vá»›i signaling vÃ  server xá»­ lÃ½ signaling. Giáº£ sá»­ app WebRTC dá»±a trÃªn trÃ¬nh duyá»‡t cá»§a báº¡n cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c Ä‘á»‹a chá»‰ IP public cá»§a nÃ³ báº±ng cÃ¡ch sá»­ dá»¥ng STUN nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, bÆ°á»›c tiáº¿p theo thá»±c sá»± lÃ  1 mÃ n Ä‘Ã m phÃ¡n &amp; thiáº¿t láº­p phiÃªn káº¿t ná»‘i Ä‘áº¿n vá»›i peer. Pháº§n Ä‘Ã m phÃ¡n vÃ  thiáº¿t láº­p khá»Ÿi táº¡o phiÃªn xáº£y ra khi dÃ¹ng 1 giao thá»©c signaling/giao tiáº¿p Ä‘Æ°á»£c Ä‘áº·c táº£ trong cÃ¡c giao tiáº¿p Ä‘a phÆ°Æ¡ng tiá»‡n. Giao thá»©c nÃ y cÅ©ng chá»‹u trÃ¡ch nhiá»‡m cho viá»‡c Ä‘iá»u hÃ nh cÃ¡c quy Ä‘á»‹nh trong Ä‘Ã³ phiÃªn Ä‘Æ°á»£c quáº£n lÃ½ vÃ  há»§y bá». Má»™t trong sá»‘ cÃ¡c giao thá»©c nhÆ° váº­y cÃ³ tÃªn lÃ  Session Initiation Protocol (SIP - Giao thá»©c khá»Ÿi táº¡o phiÃªn). LÆ°u Ã½ ráº±ng do sá»± linh Ä‘á»™ng cá»§a WebRTC signaling, SIP khÃ´ng pháº£i lÃ  giao thá»©c signaling duy nháº¥t cÃ³ thá»ƒ dÃ¹ng. Giao thá»©c signaling Ä‘Æ°á»£c chá»n pháº£i hoáº¡t Ä‘á»™ng vá»›i 1 giao thá»©c á»Ÿ táº§ng á»©ng dá»¥ng gá»i lÃ  Session Description Protocol (SDP - Giao thá»©c mÃ´ táº£ phiÃªn), giao thá»©c nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng trong trÆ°á»ng há»£p cá»§a WebRTC. Táº¥t cáº£ cÃ¡c metadata Ä‘a phÆ°Æ¡ng tiá»‡n cá»¥ thá»ƒ Ä‘Æ°á»£c truyá»n Ä‘i báº±ng giao thá»©c SDP nÃ y. Báº¥t ká»³ peer nÃ o (vÃ­ dá»¥: app táº­n dá»¥ng WebRTC) thá»­ giao tiáº¿p vá»›i 1 peer khÃ¡c Ä‘á»u sinh ra 1 táº­p cÃ¡c á»©ng viÃªn giao thá»©c Interactive Connectivity Establishment (ICE - Thiáº¿t láº­p káº¿t ná»‘i tÆ°Æ¡ng tÃ¡c). Nhá»¯ng á»©ng viÃªn nÃ y biá»ƒu diá»…n 1 bá»™ káº¿t há»£p cá»§a Ä‘á»‹a chá»‰ IP, port, giao thá»©c giao váº­n Ä‘Æ°á»£c dÃ¹ng. LÆ°u Ã½ ráº±ng 1 mÃ¡y tÃ­nh cÃ³ thá»ƒ cÃ³ nhiá»u giao diá»‡n máº¡ng (khÃ´ng dÃ¢y, cÃ³ dÃ¢y, vÃ¢n vÃ¢n), vÃ¬ tháº¿ cÃ³ thá»ƒ Ä‘Æ°á»£c gÃ¡n nhiá»u Ä‘á»‹a chá»‰ IP cho má»—i giao diá»‡n. DÆ°á»›i Ä‘Ã¢y lÃ  sÆ¡ Ä‘á»“ láº¥y tá»« MDN mÃ´ táº£ láº¡i sá»± trao Ä‘á»•i: Thiáº¿t láº­p káº¿t ná»‘iMá»—i peer Ä‘áº§u tiÃªn pháº£i thiáº¿t láº­p Ä‘á»‹a chá»‰ IP public nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn. â€œKÃªnhâ€ (channel) dá»¯ liá»‡u signaling sau Ä‘Ã³ Ä‘Æ°á»£c tá»± Ä‘á»™ng táº¡o ra Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c peer vÃ  há»— trá»£ Ä‘Ã m phÃ¡n peer-to-peer vÃ  thiáº¿t láº­p phiÃªn. Tháº¿ giá»›i bÃªn ngoÃ i hoÃ n toÃ n khÃ´ng biáº¿t hoáº·c khÃ´ng thá»ƒ truy xuáº¥t Ä‘áº¿n nhá»¯ng â€œkÃªnhâ€ nÃ y vÃ  nÃ³ cÅ©ng yÃªu cáº§u 1 Ä‘á»‹nh danh duy nháº¥t náº¿u muá»‘n truy cáº­p. LÆ°u Ã½ ráº±ng, do sá»± linh Ä‘á»™ng cá»§a WebRTC vÃ  cÅ©ng bá»Ÿi tiáº¿n trÃ¬nh signaling khÃ´ng Ä‘Æ°á»£c cá»¥ thá»ƒ hÃ³a trong cÃ¡c tiÃªu chuáº©n, Ã½ tÆ°á»Ÿng vÃ  cÃ¡ch thá»±c hiá»‡n cá»§a â€œkÃªnhâ€ cÃ³ thá»ƒ sáº½ cÃ³ Ã­t nhiá»u khÃ¡c biá»‡t tuy vÃ o cÃ´ng nghá»‡ sá»­ dá»¥ng. RÃµ rÃ ng, 1 vÃ i giao thá»©c khÃ´ng cáº§n Ä‘áº¿n cÆ¡ cháº¿ â€œkÃªnhâ€ mÃ  vÃ£n giao tiáº¿p Ä‘Æ°á»£c. ChÃºng ta sáº½ giáº£ sá»­ ráº±ng â€œkÃªnhâ€ Ä‘Æ°á»£c dÃ¹ng trong viá»‡c triá»ƒn khai cho cÃ¡c má»¥c Ä‘Ã­ch Ä‘Æ°á»£c nháº¯c tá»›i á»Ÿ bÃ i viáº¿t nÃ y. Má»™t khi 2 hoáº·c nhiá»u peer Ä‘Ã£ cÃ¹ng káº¿t ná»‘i vÃ o 1 â€œkÃªnhâ€ thÃ¬ nhá»¯ng peer Ä‘Ã£ cÃ³ thá»ƒ giao tiáº¿p vÃ  trao Ä‘á»•i thÃ´ng tin phiÃªn. Tiáº¿n trÃ¬nh nÃ y vá» máº·t nÃ o Ä‘Ã³ thÃ¬ tÆ°Æ¡ng tá»± nhÆ° mÃ´ hÃ¬nh publish/subscribe. Vá» cÆ¡ báº£n, peer khá»Ÿi táº¡o ban Ä‘áº§u sáº½ gá»­i 1 â€œlá»i Ä‘á» nghá»‹â€ sá»­ dá»¥ng 1 giao thá»©c signaling cháº³ng háº¡n nhÆ° Session Initiation Protocol (SIP - Giao thá»©c khá»Ÿi táº¡o phiÃªn) vÃ  SDP. NgÆ°á»i khá»Ÿi táº¡o sáº½ chá» Ä‘á»ƒ nháº­n Ä‘Æ°á»£c â€œcÃ¢u tráº£ lá»iâ€ tá»« báº¥t ká»³ ngÆ°á»i nháº­n nÃ o Ä‘Ã£ káº¿t ná»‘i vá»›i â€œkÃªnhâ€. Khi Ä‘Ã£ nháº­n Ä‘Æ°á»£c cÃ¢u tráº£ lá»i, 1 tiáº¿n trÃ¬nh diá»…n ra Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vÃ  trao Ä‘á»•i giao thá»©c á»©ng viÃªn ICE tá»‘t nháº¥t (Interactive Connectivity Establishment - Thiáº¿t láº­p káº¿t ná»‘i tÆ°Æ¡ng tÃ¡c) mÃ  má»—i peer thu tháº­p Ä‘Æ°á»£c. Má»™t khi chá»n Ä‘Æ°á»£c á»©ng viÃªn ICE tá»‘i Æ°u thÃ¬ vá» cÆ¡ báº£n sáº½ cÃ³ nhiá»u thá»© theo sau Ä‘Ã³ Ä‘Æ°á»£c cháº¥p nháº­n, bao gá»“m: nhá»¯ng metadata cáº§n thiáº¿t, cÃ¡c Ä‘á»‹nh tuyáº¿n máº¡ng (Ä‘á»‹a chá»‰ IP vÃ  port) vÃ  cÃ¡c thÃ´ng tin media thÆ°á»ng dÃ¹ng Ä‘á»ƒ giao tiáº¿p vá»›i má»—i peer. PhiÃªn máº¡ng socket máº¡ng giá»¯a nhá»¯ng peer sau Ä‘Ã³ Ä‘Æ°á»£c thiáº¿t láº­p hoÃ n chá»‰nh vÃ  kÃ­ch hoáº¡t. Tiáº¿p Ä‘Ã³, cÃ¡c luá»“ng dá»¯ liá»‡u local vÃ  cÃ¡c endpoint kÃªnh dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra bá»Ÿi má»—i peer, dá»¯ liá»‡u Ä‘a phÆ°Æ¡ng tiá»‡n cuá»‘i cÃ¹ng Ä‘Æ°á»£c chuyá»ƒn Ä‘i theo cáº£ 2 Ä‘Æ°á»ng sá»­ dá»¥ng báº¥t ká»³ cÃ´ng nghá»‡ giao tiáº¿p 2 chiá»u nÃ o. Náº¿u nhÆ° tiáº¿n trÃ¬nh Ä‘á»“ng Ã½ cháº¥p nháº­n á»©ng viÃªn ICE tá»‘t nháº¥t bá»‹ tháº¥t báº¡i, thá»‰nh thoáº£ng nguyÃªn nhÃ¢n lÃ  do tÆ°á»ng lá»­a hoáº·c ká»¹ thuáº­t NAT Ä‘ang dÃ¹ng, thÃ¬ giáº£i phÃ¡p dá»± phÃ²ng sau Ä‘Ã³ lÃ  sá»­ dá»¥ng 1 server TURN dÆ°á»›i dáº¡ng 1 Ä‘iá»ƒm chuyá»ƒn tiáº¿p thay tháº¿. Tiáº¿n trÃ¬nh nÃ y vá» cÆ¡ báº£n sáº½ dÃ¹ng 1 server hoáº¡t Ä‘á»™ng nhÆ° ngÆ°á»i trung gian vÃ  nÃ³ chuyá»ƒn tiáº¿p báº¥t ká»³ dá»¯ liá»‡u nÃ o truyá»n qua láº¡i giá»¯a cÃ¡c peer. LÆ°u Ã½ ráº±ng Ä‘Ã¢y khÃ´ng pháº£i lÃ  giao tiáº¿p peer-to-peer thá»±c thá»¥ trong Ä‘Ã³ cÃ¡c peer truyá»n dá»¯ liá»‡u 2 chiá»u trá»±c tiáº¿p Ä‘áº¿n vá»›i nhau. Khi sá»­ dá»¥ng giáº£i phÃ¡p dá»± phÃ²ng TURN Ä‘á»ƒ giao tiáº¿p, má»—i peer sáº½ khÃ´ng cáº§n pháº£i biáº¿t lÃ m tháº¿ nÃ o Ä‘á»ƒ liÃªn láº¡c vÃ  truyá»n dá»¯ liá»‡u Ä‘áº¿n bÃªn kia. Thay vÃ o Ä‘Ã³, nÃ³ cáº§n biáº¿t server TURN public nÃ o Ä‘á»ƒ gá»­i vÃ  nháº­n dá»¯ liá»‡u Ä‘a phÆ°Æ¡ng tiá»‡n theo thá»i gian thá»±c xuyÃªn suá»‘t phiÃªn giao tiáº¿p. Äiá»u quan trá»ng cáº§n pháº£i hiá»ƒu ráº±ng Ä‘Ã¢y cháº¯c cháº³n lÃ  1 dáº¡ng â€œkáº¿ hoáº¡ch dá»± phÃ²ngâ€ vÃ  chá»‰ dÃ¹ng khi khÃ´ng cÃ²n cÃ¡ch nÃ o khÃ¡c. CÃ¡c server TURN pháº£i khÃ¡ vá»¯ng cháº¯c, cÃ³ bÄƒng thÃ´ng rá»™ng, kháº£ nÄƒng xá»­ lÃ½ vÃ  cÃ³ thá»ƒ xá»­ lÃ½ 1 lÆ°á»£ng lá»›n dá»¯ liá»‡u tiá»m tÃ ng. CÃ¡ch sá»­ dá»¥ng server TURN vÃ¬ tháº¿ rÃµ rÃ ng lÃ  sáº½ phÃ¡t sinh thÃªm chi phÃ­ vÃ  sá»± phá»©c táº¡p. CÃ¡c API cá»§a WebRTCCÃ³ 3 má»¥c phÃ¢n loáº¡i API chÃ­nh trong WebRTC: Media Capture and Streams (luá»“ng media vÃ  chá»¥p media) - cho phÃ©p báº¡n truy xuáº¥t vÃ o cÃ¡c thiáº¿t bá»‹ Ä‘áº§u vÃ o, cháº³ng háº¡n nhÆ° microphone hay web camera. API cho phÃ©p báº¡n láº¥y 1 luá»“ng media tá»« cÃ¡c thiáº¿t bá»‹ Ä‘Ã³. RTCPeerConnection - dÃ¹ng nhá»¯ng API nÃ y, báº¡n cÃ³ thá»ƒ gá»­i theo thá»i gian thá»±c 1 luá»“ng Ã¢m thanh &amp; hÃ¬nh áº£nh Ä‘Ã£ báº¯t Ä‘Æ°á»£c thÃ´ng qua internet Ä‘áº¿n 1 endpoint WebRTC khÃ¡c. Báº¡n cÃ³ thá»ƒ táº¡o ra káº¿t ná»‘i giá»¯a mÃ¡y local vÃ  peer tá»« xa. NÃ³ cÅ©ng cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c Ä‘á»ƒ káº¿t ná»‘i Ä‘áº¿n 1 peer tá»« xa, duy trÃ¬ vÃ  kiá»ƒm soÃ¡t káº¿t ná»‘i &amp; Ä‘Ã³ng káº¿t ná»‘i 1 khi ta khÃ´ng cáº§n Ä‘áº¿n nÃ³ ná»¯a. RTCDataChannel - API nÃ y cho phÃ©p báº¡n truyá»n dá»¯ liá»‡u tÃ¹y Ã½. Má»—i kÃªnh dá»¯ liá»‡u Ä‘Æ°á»£c liÃªn káº¿t vá»›i 1 RTCPeerConnection. ChÃºng ta sáº½ Ä‘i sÃ¢u vÃ o tháº£o luáº­n má»—i loáº¡i trÃªn. Media Capture &amp; StreamsAPI Media Capture &amp; Streams, thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  Media Stream API hoáº·c Stream API, lÃ  1 API há»— trá»£ nhá»¯ng luá»“ng (stream) dá»¯ liá»‡u Ã¢m thanh hay hÃ¬nh áº£nh, cÃ¡c phÆ°Æ¡ng thá»©c Ä‘á»ƒ lÃ m viá»‡c vá»›i chÃºng, nhá»¯ng háº¡n cháº¿ liÃªn káº¿t vá»›i tá»«ng loáº¡i dá»¯ liá»‡u, callback thÃ nh cÃ´ng/tháº¥t báº¡i khi sá»­ dá»¥ng dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™ vÃ  nhá»¯ng sá»± kiá»‡n Ä‘Æ°á»£c báº¯n ra suá»‘t quÃ¡ trÃ¬nh. PhÆ°Æ¡ng thá»©c getUserMedia() cá»§a MediaDevices nháº¯c nhá»Ÿ ngÆ°á»i dÃ¹ng cáº¥p quyá»n Ä‘á»ƒ sá»­ dá»¥ng Ä‘áº§u vÃ o media, nÃ³ táº¡o ra 1 MediaStream kÃ¨m vá»›i cÃ¡c track chá»©a kiá»ƒu request cá»§a media. Luá»“ng Ä‘Ã³ cÃ³ thá»ƒ chá»©a 1 track video (Ä‘Æ°á»£c táº¡o ra bá»Ÿi pháº§n cá»©ng hay nguá»“n video áº£o cháº³ng háº¡n nhÆ° camera, thiáº¿t bá»‹ ghi video, dá»‹ch vá»¥ chia sáº» mÃ n hÃ¬nh, vÃ¢n vÃ¢n), 1 track audio (tÆ°Æ¡ng tá»±, Ä‘Æ°á»£c táº¡o ra bá»Ÿi nguá»“n ghi váº­t lÃ½ hoáº·c nguá»“n ghi áº£o nhÆ° microphone, bá»™ chuyá»ƒn A/Dâ€¦) vÃ  cÃ³ thá»ƒ cÃ³ cáº£ nhá»¯ng loáº¡i track khÃ¡c. NÃ³ sáº½ tráº£ vá» 1 Promise vÃ  resolve thÃ nh object MediaStream. Náº¿u ngÆ°á»i dÃ¹ng tá»« chá»‘i cáº¥p quyá»n hoáº·c lÃ  media phÃ¹ há»£p khÃ´ng tá»“n táº¡i thÃ¬ promise Ä‘Ã³ sáº½ bá»‹ reject vá»›i PermissionDeniedError hoáº·c NotFoundError. MÃ´ hÃ¬nh singleton MediaDevice cÃ³ thá»ƒ Ä‘Æ°á»£c truy xuáº¥t thÃ´ng qua object navigator nhÆ° sau: 1234567navigator.mediaDevices.getUserMedia(constraints).then(function(stream) &#123; /* use the stream */&#125;).catch(function(err) &#123; /* handle the error */&#125;); LÆ°u Ã½ lÃ  báº¡n cáº§n truyá»n object constraints Ä‘á»ƒ nÃ³i cho API loáº¡i stream nÃ o Ä‘á»ƒ tráº£ vá». Báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh táº¥t cáº£ nhá»¯ng thá»© linh tinh liÃªn quan, bao gá»“m cáº£ camera mÃ  báº¡n dÃ¹ng (camera trÆ°á»›c/sau), táº§n suáº¥t khung hÃ¬nh, Ä‘á»™ phÃ¢n giáº£i, vÃ¢n vÃ¢n. Ká»ƒ tá»« phiÃªn báº£n 25, cÃ¡c trÃ¬nh duyá»‡t dá»±a trÃªn nhÃ¢n Chromium cho phÃ©p dá»¯ liá»‡u Ã¢m thanh tá»« getUserMedia() cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n Ä‘áº¿n element audio hoáº·c video (nhÆ°ng lÆ°u Ã½ ráº±ng máº·c Ä‘á»‹nh thÃ¬ cÃ¡c media element bá»‹ táº¯t tiáº¿ng (mute)) getUserMedia cÃ²n cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng nhÆ° 1 node Ä‘áº§u vÃ o cho Web Audio API 1234567891011function gotStream(stream) &#123; window.AudioContext = window.AudioContext || window.webkitAudioContext; var audioContext = new AudioContext(); // Táº¡o AudioNode tá»« stream var mediaStreamSource = audioContext.createMediaStreamSource(stream); // Káº¿t ná»‘i nÃ³ Ä‘áº¿n Ä‘iá»ƒm Ä‘Ã­ch Ä‘á»ƒ nghe báº¡n // hoáº·c báº¥t ká»³ node nÃ o khÃ¡c Ä‘ang xá»­ lÃ½ mediaStreamSource.connect(audioContext.destination);&#125;navigator.getUserMedia(&#123;audio:true&#125;, gotStream); Giá»›i háº¡n vá» sá»± riÃªng tÆ°LÃ  1 API cÃ³ thá»ƒ chá»©a nhiá»u Ä‘iá»u lo ngáº¡i Ä‘Ã¡ng ká»ƒ vá» quyá»n riÃªng tÆ°, getUserMedia() Ä‘Æ°á»£c tá»• chá»©c bá»Ÿi cÃ¡c Ä‘áº·c Ä‘iá»ƒm ká»¹ thuáº­t vá»›i nhá»¯ng yÃªu cáº§u ráº¥t cá»¥ thá»ƒ vá» thÃ´ng bÃ¡o ngÆ°á»i dÃ¹ng vÃ  quáº£n lÃ½ quyá»n truy cáº­p. getUserMedia() pháº£i luÃ´n luÃ´n xin quyá»n tá»« ngÆ°á»i dÃ¹ng trÆ°á»›c khi má»Ÿ báº¥t ká»³ thiáº¿t bá»‹ thu tháº­p thÃ´ng tin media nÃ o cháº³ng háº¡n nhÆ° webcam hay microphone. TrÃ¬nh duyá»‡t cÃ³ thá»ƒ cÃ³ tÃ­nh nÄƒng cáº¥p quyá»n trÃªn má»—i domain (once-per-domain), nhÆ°ng nÃ³ pháº£i há»i báº¡n Ã­t nháº¥t lÃ  láº§n Ä‘áº§u tiÃªn hoáº¡t Ä‘á»™ng vÃ  ngÆ°á»i dÃ¹ng pháº£i Ä‘áº·c biá»‡t cáº¥p quyá»n tiáº¿p theo náº¿u há» muá»‘n. Má»™t Ä‘iá»u quan trá»ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng lÃ  cÃ¡c quy Ä‘á»‹nh xung quanh thÃ´ng bÃ¡o (notification). TrÃ¬nh duyá»‡t Ä‘Æ°á»£c yÃªu cáº§u pháº£i hiá»ƒn thá»‹ 1 thÃ´ng sá»‘ thá»ƒ hiá»‡n camera hoáº·c microphone Ä‘ang hoáº¡t Ä‘á»™ng, hÆ¡n háº¿t tháº£y báº¥t ká»³ thÃ´ng sá»‘ thá»ƒ hiá»‡n pháº§n cá»©ng nÃ o khÃ¡c. Há» cÅ©ng pháº£i hiá»‡n 1 chá»‰ sá»‘ cho tháº¥y ráº±ng quyá»n Ä‘Æ°á»£c Ä‘Æ°á»£c cáº¥p Ä‘á»ƒ sá»­ dá»¥ng thiáº¿t bá»‹ Ä‘áº§u vÃ o, ká»ƒ cáº£ náº¿u nhÆ° thiáº¿t bá»‹ Ä‘Ã³ chÆ°a Ä‘Æ°á»£c kÃ­ch hoáº¡t Ä‘á»ƒ ghi chÃ©p táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³. RTCPeerConnectionGiao diá»‡n RTCPeerConnection thá»ƒ hiá»‡n 1 káº¿t ná»‘i WebRTC giá»¯a mÃ¡y tÃ­nh local vÃ  peer tá»« xa. NÃ³ cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c Ä‘á»ƒ káº¿t ná»‘i Ä‘áº¿n peer tá»« xa, duy trÃ¬, kiá»ƒm soÃ¡t káº¿t ná»‘i vÃ  ngáº¯t káº¿t ná»‘i má»™t khi nÃ³ khÃ´ng cáº§n dÃ¹ng tá»›i ná»¯a. DÆ°á»›i Ä‘Ã¢y lÃ  1 mÃ´ hÃ¬nh kiáº¿n trÃºc cá»§a WebRTC thá»ƒ hiá»‡n vai trÃ² cá»§a RTCPeerConnection: Tá»« gÃ³c Ä‘á»™ cá»§a Javascript, Ä‘iá»u cáº§n hiá»ƒu trong mÃ´ hÃ¬nh trÃªn lÃ  RTCPeerConnection trao cho cÃ¡c web developer má»™t cÃ¡i nhÃ¬n tinh táº¿ tá»« nhá»¯ng sá»± phá»©c táº¡p xuáº¥t phÃ¡t tá»« Ä‘á»‘ng â€œná»™i táº¡ngâ€ rá»‘i ráº¯m bÃªn dÆ°á»›i. CÃ¡c mÃ£ codec vÃ  giao thá»©c Ä‘Æ°á»£c dÃ¹ng bá»Ÿi WebRTC thá»±c hiá»‡n 1 lÆ°á»£ng lá»›n cÃ´ng viá»‡c dá»ƒ lÃ m cho giao tiáº¿p real-time hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c, ká»ƒ cáº£ vá»›i cÃ¡c máº¡ng khÃ´ng Ä‘Ã¡ng tin cáº­y: Che dáº¥u máº¥t gÃ³i tin (Package loss concealment - PLC, lÃ  1 ká»¹ thuáº­t dÃ¹ng Ä‘á»ƒ che Ä‘áº­y áº£nh hÆ°á»Ÿng cá»§a tÃ¬nh tráº¡ng máº¥t gÃ³i tin trong giao tiáº¿p VoIP) Há»§y bá» pháº£n há»“i (Echo cancellation - trong máº¡ng mÃ¡y tÃ­nh thÃ¬ â€œechoâ€ Ä‘Æ°á»£c hiá»ƒu lÃ  quÃ¡ trÃ¬nh gá»­i tráº£ vá» gÃ³i tin Ä‘Ã£ gá»­i Ä‘i) Kháº£ nÄƒng thÃ­ch á»©ng bÄƒng thÃ´ng Bá»™ Ä‘á»‡m jitter Ä‘á»™ng (jitter buffer - Trong ká»¹ thuáº­t VoIP thÃ¬ jitter buffer lÃ  vÃ¹ng dá»¯ liá»‡u chia sáº» nÆ¡i mÃ  cÃ¡c gÃ³i tin Ã¢m thanh cÃ³ thá»ƒ Ä‘Æ°á»£c thu tháº­p, lÆ°u trá»¯ vÃ  gá»­i Ä‘i Ä‘áº¿n bá»™ xá»­ lÃ½ Ã¢m thanh) Tá»± Ä‘á»™ng chiáº¿m quyá»n kiá»ƒm soÃ¡t Giáº£m nhiá»…u vÃ  xÃ³a nhiá»…u â€œDá»n dáº¹pâ€ hÃ¬nh áº£nh RTCDataChannelCÅ©ng nhÆ° hÃ¬nh áº£nh vÃ  Ã¢m thanh, WebRTC cÅ©ng há»— trá»£ giao tiáº¿p real-time cho cÃ¡c loáº¡i dá»¯ liá»‡u khÃ¡c. API RTCDataChannel cho phÃ©p peer-to-peer trao Ä‘á»•i cÃ¡c dá»¯ liá»‡u tÃ¹y Ã½. CÃ³ ráº¥t nhiá»u trÆ°á»ng há»£p sá»­ dá»¥ng API nÃ y, vÃ­ dá»¥: DÃ¹ng trong cÃ¡c game á»¨ng dá»¥ng chat real-time Truyá»n file CÃ¡c máº¡ng phi táº­p trung API cÅ©ng cÃ³ nhiá»u tÃ­nh nÄƒng Ä‘á»ƒ táº­n dá»¥ng tá»‘i Ä‘a RTCPeerConnection vÃ  kÃ­ch hoáº¡t sá»©c máº¡nh cÅ©ng nhÆ° sá»± linh Ä‘á»™ng cá»§a giao tiáº¿p peer-to-peer: Táº­n dá»¥ng cÃ i Ä‘áº·t phiÃªn cá»§a RTCPeerConnection Äa kÃªnh Ä‘á»“ng thá»i vá»›i kháº£ nÄƒng phÃ¢n chia má»©c Ä‘á»™ Æ°u tiÃªn Ngá»¯ cáº£nh váº­n chuyá»ƒn Ä‘Ã¡ng tin cáº­y vÃ  khÃ´ng Ä‘Ã¡ng tin cáº­y. TÃ­ch há»£p sáºµn báº£o máº­t (DTLS) vÃ  kiá»ƒm soÃ¡t táº¯c ngháº½n. CÃº phÃ¡p tÆ°Æ¡ng tá»± nhÆ° WebSocket mÃ  ta Ä‘Ã£ biáº¿t, vá»›i phÆ°Æ¡ng thá»©c send() vÃ  sá»± kiá»‡n message: 1234567891011121314151617var peerConnection = new webkitRTCPeerConnection(servers, &#123;optional: [&#123;RtpDataChannels: true&#125;]&#125;);peerConnection.ondatachannel = function(event) &#123; receiveChannel = event.channel; receiveChannel.onmessage = function(event)&#123; document.querySelector(\"#receiver\").innerHTML = event.data; &#125;;&#125;;sendChannel = peerConnection.createDataChannel(\"sendDataChannel\", &#123;reliable: false&#125;);document.querySelector(\"button#send\").onclick = function ()&#123; var data = document.querySelector(\"textarea#send\").value; sendChannel.send(data);&#125;; Sá»± giao tiáº¿p diá»…n ra trá»±c tiáº¿p giá»¯a cÃ¡c trÃ¬nh duyá»‡t, vÃ¬ tháº¿ RTCDataChannel cÃ³ thá»ƒ nhanh hÆ¡n nhiá»u so vá»›i WebSocket ká»ƒ cáº£ khi cáº§n Ä‘áº¿n 1 server chuyá»ƒn tiáº¿p (TURN). WebRTC trong tháº¿ giá»›i thá»±cTrong tháº¿ giá»›i thá»±c thÃ¬ WebRTC cáº§n cÃ³ server, tuy nhiÃªn thá»±c táº¿ láº¡i Ä‘Æ¡n giáº£n hÆ¡n: CÃ¡c user tá»± khÃ¡m phÃ¡ ra Ä‘á»‘i tÃ¡c cá»§a há» vÃ  trao Ä‘á»•i cÃ¡c chi tiáº¿t cháº³ng háº¡n nhÆ° tÃªn. CÃ¡c á»©ng dá»¥ng WebRTC phÃ­a client (cÃ¡c peer) trao Ä‘á»•i thÃ´ng tin máº¡ng. CÃ¡c peer trao Ä‘á»•i dá»¯ liá»‡u vá» media cháº³ng háº¡n nhÆ° Ä‘á»‹nh dáº¡ng hÃ¬nh áº£nh vÃ  Ä‘á»™ phÃ¢n giáº£i. CÃ¡c á»©ng dá»¥ng WebRTC phÃ­a client di chuyá»ƒn xuyÃªn qua cÃ¡c cá»•ng NAT vÃ  tÆ°á»ng lá»­a. NÃ³i cÃ¡ch khÃ¡c, WebRTC cáº§n pháº£i cÃ³ 4 tÃ­nh nÄƒng á»Ÿ phÃ­a server: User khÃ¡m phÃ¡ ra vÃ  giao tiáº¿p. Signaling Di chuyá»ƒn NAT/tÆ°á»ng lá»­a CÃ¡c server chuyá»ƒn tiáº¿p trong trÆ°á»ng há»£p giao tiáº¿p peer-to-peer tháº¥t báº¡i. Giao thá»©c STUN vÃ  báº£n má»Ÿ rá»™ng TURN cá»§a nÃ³ Ä‘Æ°á»£c dÃ¹ng bá»Ÿi ICE Ä‘á»ƒ kÃ­ch hoáº¡t RTCPeerConnection nháº±m Ä‘á»‘i phÃ³ vá»›i di chuyá»ƒn NAT vÃ  cÃ¡c thay Ä‘á»•i máº¡ng mÆ¡ há»“ khÃ¡c. NhÆ° Ä‘Ã£ nháº¯c Ä‘áº¿n trÆ°á»›c Ä‘Ã³, ICE lÃ  1 giao thá»©c Ä‘á»ƒ káº¿t ná»‘i cÃ¡c peer, cháº³ng háº¡n nhÆ° 2 á»©ng dá»¥ng video chat client. Khi khá»Ÿi táº¡o, ICE sáº½ thá»­ káº¿t ná»‘i trá»±c tiáº¿p Ä‘áº¿n cÃ¡c peer vá»›i Ä‘á»™ trá»… tháº¥p nháº¥t cÃ³ thá»ƒ thÃ´ng qua UDP. Trong tiáº¿n trÃ¬nh nÃ y, cÃ¡c server STUN cÃ³ 1 tÃ¡c vá»¥ duy nháº¥t: kÃ­ch hoáº¡t 1 peer phÃ­a sau NAT Ä‘á»ƒ tÃ¬m Ä‘á»‹a chá»‰ public &amp; sá»‘ port. Báº¡n cÃ³ thá»ƒ kiá»ƒm tra cÃ¡c server STUN Ä‘ang tá»“n táº¡i á»Ÿ danh sÃ¡ch nÃ y (Google cÅ©ng cÃ³ 1 sá»‘ server) | | # source : http://code.google.com/p/natvpn/source/browse/trunk/stun_server_list || | # A list of available STUN server. || | || | stun.l.google.com:19302 || | stun1.l.google.com:19302 || | stun2.l.google.com:19302 || | stun3.l.google.com:19302 || | stun4.l.google.com:19302 || | stun01.sipphone.com || | stun.ekiga.net || | stun.fwdnet.net || | stun.ideasip.com || | stun.iptel.org || | stun.rixtelecom.se || | stun.schlund.de || | stunserver.org || | stun.softjoys.com || | stun.voiparound.com || | stun.voipbuster.com || | stun.voipstunt.com || | stun.voxgratia.org || | stun.xten.com | view raw stuns hosted with â¤ by GitHub. TÃ¬m nhá»¯ng á»©ng viÃªn káº¿t ná»‘iNáº¿u nhÆ° UDP tháº¥t báº¡i, ICE sáº½ thá»­ TCP: Ä‘áº§u tiÃªn lÃ  HTTP, sau Ä‘Ã³ lÃ  HTTPS. Náº¿u káº¿t ná»‘i trá»±c tiáº¿p tháº¥t báº¡i - cá»¥ thá»ƒ lÃ  bá»Ÿi vÃ¬ dá»‹ch chuyá»ƒn NAT &amp; tÆ°á»ng lá»­a má»©c Ä‘á»™ doanh nghiá»‡p - ICE sáº½ dÃ¹ng 1 server TURN trung gian (Ä‘iá»ƒm chuyá»ƒn tiáº¿p). NÃ³i cÃ¡ch khÃ¡c, ICE Ä‘áº§u tiÃªn sáº½ dÃ¹ng STUN vá»›i UDP Ä‘á»ƒ káº¿t ná»‘i trá»±c tiáº¿p cÃ¡c peer vá»›i nhau, náº¿u tháº¥t báº¡i, nÃ³ sáº½ Ä‘á»•i káº¿ hoáº¡ch sang dÃ¹ng server chuyá»ƒn tiáº¿p TURN. Cá»¥m tá»« â€œtÃ¬m kiáº¿m á»©ng viÃªnâ€ nháº¯c Ä‘áº¿n quÃ¡ trÃ¬nh tÃ¬m kiáº¿m cÃ¡c giao diá»‡n máº¡ng &amp; port. Báº£o máº­tCÃ³ ráº¥t nhiá»u cÃ¡ch mÃ  1 á»©ng dá»¥ng hoáº·c plugin giao tiáº¿p real-time cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng vá» báº£o máº­t. VÃ­ dá»¥: Dá»¯ liá»‡u hoáº·c media khÃ´ng Ä‘Æ°á»£c mÃ£ hÃ³a cÃ³ thá»ƒ bá»‹ cháº·n trÃªn Ä‘Æ°á»ng Ä‘i giá»¯a cÃ¡c trÃ¬nh duyá»‡t hay giá»¯a trÃ¬nh duyá»‡t vÃ  server Má»™t á»©ng dá»¥ng cÃ³ thá»ƒ ghi chÃ©p vÃ  phÃ¢n phá»‘i Ã¢m thanh, hÃ¬nh áº£nh mÃ  user hoÃ n toÃ n khÃ´ng biáº¿t Malware hoáº·c virus mÃ¡y tÃ­nh cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t cÃ¹ng vá»›i 1 á»©ng dá»¥ng hoáº·c plugin vá»› váº©n. WebRTC cÃ³ nhiá»u tÃ­nh nÄƒng Ä‘á»ƒ trÃ¡nh cÃ¡c váº¥n Ä‘á» trÃªn: WebRTC triá»ƒn khai sá»­ dá»¥ng cÃ¡c giao thá»©c báº£o máº­t cháº³ng háº¡n nhÆ° DTLS vÃ  SRTP MÃ£ hÃ³a lÃ  Ä‘iá»u cáº§n thiáº¿t Ä‘á»‘i vá»›i táº¥t cáº£ cÃ¡c component cá»§a WebRTC, bao gá»“m cáº£ cÆ¡ cháº¿ signaling. WebRTC khÃ´ng pháº£i lÃ  1 plugin: cÃ¡c component cá»§a nÃ³ cháº¡y trong sandbox cá»§a trÃ¬nh duyá»‡t vÃ  khÃ´ng cháº¡y á»Ÿ luá»“ng riÃªng, cÃ¡c component khÃ´ng yÃªu cáº§u cÃ i Ä‘áº·t riÃªng láº» vÃ  Ä‘Æ°á»£c cáº­p nháº­t má»—i khi trÃ¬nh duyá»‡t Ä‘Æ°á»£c cáº­p nháº­t. Truy xuáº¥t camera vÃ  microphone pháº£i Ä‘Æ°á»£c cáº¥p quyá»n rÃµ rÃ ng vÃ  khi camera hoáº·c microphone Ä‘ang hoáº¡t Ä‘á»™ng thÃ¬ pháº£i Ä‘Æ°á»£c thá»ƒ hiá»‡n ra á»Ÿ phÃ­a giao diá»‡n ngÆ°á»i dÃ¹ng. WebRTC lÃ  1 cÃ´ng nghá»‡ cá»±c ká»³ thÃº vá»‹ &amp; máº¡nh máº½ dÃ nh cho cÃ¡c sáº£n pháº©m cáº§n lÃ m viá»‡c vá»›i mÃ´ hÃ¬nh truyá»n táº£i real-time giá»¯a cÃ¡c trÃ¬nh duyá»‡t. VÃ­ dá»¥, á»Ÿ SessionStack, há» cho phÃ©p user tÃ­ch há»£p thÆ° viá»‡n Javascript cá»§a há» vÃ o bÃªn trong webapp cá»§a user. Nhiá»‡m vá»¥ cá»§a nÃ³ lÃ  báº¯t Ä‘áº§u thu tháº­p cÃ¡c dá»¯ liá»‡u nhÆ° sá»± kiá»‡n ngÆ°á»i dÃ¹ng, thay Ä‘á»•i trÃªn DOM, dá»¯ liá»‡u máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o debug, vÃ¢n vÃ¢n, vÃ  gá»­i chÃºng vá» cho server. Trong khi Ä‘Ã³, user cá»§a báº¡n cÃ³ thá»ƒ vÃ o trong webapp cá»§a há», má»Ÿ 1 phiÃªn lÃ m viá»‡c bÃ¬nh thÆ°á»ng vÃ  xem nÃ³ hoáº¡t Ä‘á»™ng theo thá»i gian thá»±c. Sá»­ dá»¥ng cÃ¡c dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c, SessionStack cÃ³ thá»ƒ tÃ¡i táº¡o má»i thá»© Ä‘Ã£ tá»«ng xáº£y ra trÃªn trÃ¬nh duyá»‡t cá»§a user, káº¿t há»£p cÃ¡c thÃ´ng tin vá» hÃ¬nh áº£nh thuáº§n tÃºy vá»›i 1 bá»™ giáº£ láº­p console cá»§a trÃ¬nh duyá»‡t vÃ  má»i thá»© bÃªn trong nÃ³. Báº¡n cá»© nghÄ© nÃ³ giá»‘ng nhÆ° desktop tá»« xa nhÆ°ng khÃ´ng báº¯t ngÆ°á»i dÃ¹ng cuá»‘i pháº£i táº£i vá» báº¥t cá»© chÆ°Æ¡ng trÃ¬nh nÃ o. VÃ  trÃªn háº¿t táº¥t cáº£ cÃ¡c thÃ´ng tin hÃ¬nh áº£nh, báº¡n cÃ³ thá»ƒ thá»±c sá»± tháº¥y Ä‘Æ°á»£c cÃ¡c thÃ´ng tin ká»¹ thuáº­t láº¥y tá»« phiÃªn. Há» Ä‘Ã£ lÃ m Ä‘Æ°á»£c táº¥t cáº£ Ä‘iá»u Ä‘Ã³ thuáº§n tÃºy vá»›i cÃ¡c server, tuy nhiÃªn sá»­ dá»¥ng WebRTC há» cÃ³ thá»ƒ tháº­t sá»± khÃ´ng cáº§n phá»¥ thuá»™c vÃ o server ná»¯a mÃ  giao tiáº¿p trá»±c tiáº¿p giá»¯a cÃ¡c trÃ¬nh duyá»‡t vá»›i nhau, giáº£m Ä‘á»™ trá»… vÃ  sá»©c máº¡nh tÃ­nh toÃ¡n cáº§n thiáº¿t.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P17: BÃªn trong Shadow DOM + xÃ¢y dá»±ng component khÃ©p kÃ­n","slug":"Cach-Javascript-hoat-dong-P17-Ben-trong-Shadow-DOM-xay-dung-component-khep-kin","date":"2019-01-05T16:50:00.000Z","updated":"2019-01-06T10:16:19.727Z","comments":true,"path":"2019/01/Cach-Javascript-hoat-dong-P17-Ben-trong-Shadow-DOM-xay-dung-component-khep-kin.html","link":"","permalink":"http://nthung2112.github.io/2019/01/Cach-Javascript-hoat-dong-P17-Ben-trong-Shadow-DOM-xay-dung-component-khep-kin.html","excerpt":"Trong bÃ i cÃ³ nhiá»u tá»« mÃ¬nh Ä‘á»ƒ nguyÃªn mÃ  khÃ´ng dá»‹ch nhÃ©, vÃ¬ dá»‹ch ra thÃ¬ bay máº¥t nghÄ©a @@_ element: pháº§n tá»­ custom element: pháº§n tá»­ tá»± táº¡o component: thÃ nh pháº§n custom component: thÃ nh pháº§n tá»± táº¡o markup: nÃ³i chung lÃ  ngÃ´n ngá»¯ Ä‘Ã¡nh dáº¥u, hay nÃ³i dá»… hiá»ƒu hÆ¡n lÃ  code HTML (Hyper Text Markup Language) ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 17 trong series khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh.","text":"Trong bÃ i cÃ³ nhiá»u tá»« mÃ¬nh Ä‘á»ƒ nguyÃªn mÃ  khÃ´ng dá»‹ch nhÃ©, vÃ¬ dá»‹ch ra thÃ¬ bay máº¥t nghÄ©a @@_ element: pháº§n tá»­ custom element: pháº§n tá»­ tá»± táº¡o component: thÃ nh pháº§n custom component: thÃ nh pháº§n tá»± táº¡o markup: nÃ³i chung lÃ  ngÃ´n ngá»¯ Ä‘Ã¡nh dáº¥u, hay nÃ³i dá»… hiá»ƒu hÆ¡n lÃ  code HTML (Hyper Text Markup Language) ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 17 trong series khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tWeb Components (ThÃ nh pháº§n web) lÃ  1 bá»™ cÃ¡c cÃ´ng nghá»‡ khÃ¡c nhau cho phÃ©p ta táº¡o ra nhá»¯ng custom element cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng. TÃ­nh nÄƒng cá»§a chÃºng Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i tÃ¡ch hoÃ n toÃ n khá»i code vÃ  báº¡n cÃ³ thá»ƒ dÃ¹ng nÃ³ trong webapp cá»§a mÃ¬nh. CÃ³ 4 loáº¡i Web Component tiÃªu chuáº©n: Shadow DOM (BÃ³ng cá»§a DOM) HTML Templates (cÃ¡c máº«u HTML) Custom elements (CÃ¡c custom element) HTML Imports Trong bÃ i nÃ y ta sáº½ táº­p trung vÃ o Shadow DOM Shadow DOM Ä‘Æ°á»£c thiáº¿t káº¿ nhÆ° 1 cÃ´ng cá»¥ dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c app dá»±a trÃªn component. NÃ³ cung cáº¥p cÃ¡c giáº£i phÃ¡p cho cÃ¡c váº¥n Ä‘á» chung trong ngÃ nh phÃ¡t triá»ƒn web mÃ  báº¡n cháº¯c cháº¯n Ä‘Ã£ gáº·p qua: Isolated DOM (DOM cÃ´ láº­p): 1 DOM cá»§a component khÃ©p kÃ­n (vÃ­ dá»¥: document.querySelector() khÃ´ng tráº£ vá» cÃ¡c node trong Shadow DOM cá»§a component). Äiá»u nÃ y cÅ©ng lÃ m Ä‘Æ¡n giáº£n hÃ³a cÃ¡c CSS Selector trong webapp cá»§a báº¡n bá»Ÿi vÃ¬ cÃ¡c DOM component Ä‘á»u bá»‹ cÃ´ láº­p, nÃ³ cho phÃ©p báº¡n kháº£ nÄƒng sá»­ dá»¥ng chung nhiá»u id/class mÃ  khÃ´ng lo bá»‹ xung Ä‘á»™t vá» cÃ¡ch Ä‘áº·t tÃªn. Scoped CSS (CSS trong pháº¡m vi): CSS Ä‘á»‹nh nghÄ©a bÃªn trong Shadow DOM chá»‰ cÃ³ pháº¡m vi trong nÃ³. CÃ¡c quy táº¯c vá» style khÃ´ng lá»t ra ngoÃ i vÃ  style cá»§a trang cÅ©ng khÃ´ng can thiá»‡p vÃ o nÃ³. Composition (káº¿t há»£p): Thiáº¿t káº¿ 1 API khai bÃ¡o, dá»±a trÃªn markup cho component cá»§a báº¡n. Shadow DOMBÃ i viáº¿t nÃ y giáº£ Ä‘á»‹nh ráº±ng báº¡n Ä‘Ã£ quen thuá»™c vá»›i cÃ¡c khÃ¡i niá»‡m vÃ  API vá» DOM. Náº¿u báº¡n chÆ°a rÃµ thÃ¬ cÃ³ thá»ƒ Ä‘á»c bÃ i viáº¿t chi tiáº¿t vá» nÃ³ á»Ÿ Ä‘Ã¢y: https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction Shadow DOM cÅ©ng chá»‰ lÃ  1 DOM bÃ¬nh thÆ°á»ng, ngoáº¡i trá»« 2 Ä‘iá»u sau: CÃ¡ch táº¡o ra/sá»­ dá»¥ng trong má»‘i quan há»‡ vá»›i toÃ n bá»™ trang so vá»›i cÃ¡ch mÃ  báº¡n táº¡o/sá»­ dá»¥ng DOM thÆ°á»ng. CÃ¡ch tÆ°Æ¡ng tÃ¡c cá»§a nÃ³ trong má»‘i quan há»‡ vá»›i toÃ n bá»™ trang Má»™t cÃ¡ch tá»•ng quÃ¡t, báº¡n táº¡o ra cÃ¡c node DOM vÃ  ná»‘i (append) chÃºng dÆ°á»›i dáº¡ng children vÃ o element khÃ¡c. Trong trÆ°á»ng há»£p cá»§a Shadow DOM, báº¡n táº¡o ra 1 cÃ¢y DOM trong pháº¡m vi (scoped DOM) vÃ  Ä‘Æ°á»£c káº¿t ná»‘i vÃ o element tuy nhiÃªn nÃ³ tÃ¡ch biá»‡t vá»›i children cá»§a chÃ­nh nÃ³. CÃ¢y con trong pháº¡m vi nÃ y Ä‘Æ°á»£c gá»i lÃ  shadow tree. Element mÃ  nÃ³ ná»‘i vÃ o Ä‘Æ°á»£c gá»i lÃ  shadow host. Báº¥t cá»© thá»© gÃ¬ báº¡n thÃªm vÃ o shadow tree trá»Ÿ thÃ nh 1 pháº§n local cá»§a element chá»§, bao gá»“m cáº£ &lt;style&gt;. ÄÃ¢y lÃ  cÃ¡ch mÃ  Shadow DOM cÃ³ Ä‘Æ°á»£c pháº¡m vi cá»§a CSS style. Táº¡o Shadow DOMMá»™t shadow root lÃ  1 pháº§n cá»§a document vÃ  Ä‘Æ°á»£c ná»‘i vÃ o 1 element chá»§ (host element). Thá»i Ä‘iá»ƒm báº¡n ná»‘i 1 shadow root chÃ­nh lÃ  lÃºc element cÃ³ Ä‘Æ°á»£c shadow DOM cá»§a nÃ³. Äá»ƒ táº¡o shadow DOM cho 1 element, ta gá»i element.attachShadow(): 123456var header = document.createElement('header');var shadowRoot = header.attachShadow(&#123;mode: 'open'&#125;);var paragraphElement = document.createElement('p');paragraphElement.innerText = 'Shadow DOM';shadowRoot.appendChild(paragraphElement); Pháº§n thÃ´ng sá»‘ ká»¹ thuáº­t nÃ y Ä‘á»‹nh nghÄ©a 1 danh sÃ¡ch cÃ¡c element mÃ  shadow tree khÃ´ng thá»ƒ ná»‘i vÃ o. TÃ­nh káº¿t há»£p trong Shadow DOMTÃ­nh káº¿t há»£p lÃ  1 trong sá»‘ nhá»¯ng tÃ­nh nÄƒng quan trá»ng nháº¥t cá»§a Shadow DOM. Khi viáº¿t code HTML, â€œkáº¿t há»£pâ€ lÃ  cÃ¡ch mÃ  báº¡n xÃ¢y dá»±ng webapp. Báº¡n káº¿t ná»‘i vÃ  cÃ i Ä‘áº·t cÃ¡c viÃªn gáº¡ch khÃ¡c nhau (cÃ²n gá»i lÃ  cÃ¡c element) cháº³ng háº¡n nhÆ° &lt;div&gt;, &lt;header&gt;, &lt;form&gt;, vÃ¢n vÃ¢n, Ä‘á»ƒ xÃ¢y dá»±ng UI cho webapp. Má»™t sá»‘ tag tháº­m chÃ­ cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng vá»›i nhau. Sá»± káº¿t há»£p Ä‘á»‹nh nghÄ©a táº¡i sao cÃ¡c element nhÆ° &lt;select&gt;, &lt;form&gt;, &lt;video&gt;â€¦ láº¡i linh Ä‘á»™ng vÃ  cháº¥p nháº­n cÃ¡c element HTML cá»¥ thá»ƒ lÃ m children cá»§a nÃ³ Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c cÃ´ng viá»‡c Ä‘áº·c biá»‡t. VÃ­ dá»¥, &lt;select&gt; biáº¿t cÃ¡ch render cÃ¡c element &lt;option&gt; thÃ nh 1 danh sÃ¡ch dropdown vá»›i cÃ¡c item Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c. Shadow DOM giá»›i thiá»‡u cÃ¡c tÃ­nh nÄƒng sau mÃ  tá»« Ä‘Ã³ ta cÃ³ thá»ƒ thá»±c hiá»‡n tÃ­nh â€œkáº¿t há»£pâ€. Light DOM (DOM nháº¹)ÄÃ¢y lÃ  Ä‘oáº¡n markup mÃ  user cá»§a component cá»§a báº¡n viáº¿t ra. DOM nÃ y tá»“n táº¡i bÃªn ngoÃ i Shadow DOM cá»§a component. NÃ³ lÃ  má»™t children thá»±c cá»§a element. TÆ°á»Ÿng tÆ°á»£ng ráº±ng báº¡n Ä‘Ã£ táº¡o ra 1 custom component cÃ³ tÃªn &lt;extended-button&gt; cÃ³ thá»ƒ má»Ÿ rá»™ng button máº·c Ä‘á»‹nh cá»§a HTML vÃ  báº¡n muá»‘n thÃªm 1 bá»©c hÃ¬nh, thÃªm vÃ i Ä‘oáº¡n text bÃªn trong nÃ³, thÃ¬ dÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng gÃ¬ mÃ  nÃ³ nÃªn cÃ³: 12345&lt;extended-button&gt; &lt;!-- tháº» img vÃ  span lÃ  Light DOM cá»§a extended-button --&gt; &lt;img src=\"boot.png\" slot=\"image\"&gt; &lt;span&gt;Launch&lt;/span&gt;&lt;/extended-button&gt; extended-button lÃ  component tÃ¹y chá»n mÃ  báº¡n Ä‘á»‹nh nghÄ©a, Ä‘oáº¡n HTML bÃªn trong nÃ³ Ä‘Æ°á»£c gá»i lÃ  Light DOM vÃ  Ä‘Æ°á»£c thÃªm vÃ o bá»Ÿi user cá»§a component cá»§a báº¡n. Shadow DOM á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  component mÃ  báº¡n Ä‘Ã£ táº¡o ra (tá»©c lÃ  &lt;extended-button&gt;). Vá»›i component thÃ¬ Shadow DOM lÃ  local, nÃ³ Ä‘á»‹nh nghÄ©a cho chÃ­nh báº£n thÃ¢n nÃ³ cáº¥u trÃºc ná»™i bá»™, CSS trong pháº¡m vi vÃ  Ä‘Ã³ng gÃ³i toÃ n bá»™ cÃ¡c chi tiáº¿t vá» triá»ƒn khai. Flattened DOM tree (CÃ¢y DOM pháº³ng)Káº¿t quáº£ cá»§a trÃ¬nh duyá»‡t khi phÃ¢n phá»‘i Light DOM - má»™t sáº£n pháº©m Ä‘Æ°á»£c táº¡o ra bá»Ÿi user vÃ  Ä‘áº·t vÃ o trong Shadow DOM cá»§a báº¡n cÃ¹ng vá»›i pháº§n Ä‘á»‹nh nghÄ©a cá»§a custom component, sáº½ render ra sáº£n pháº©m cuá»‘i cÃ¹ng. CÃ¢y pháº³ng (flattened tree) lÃ  nhá»¯ng gÃ¬ sau cuá»‘i mÃ  báº¡n tháº¥y trong DevTools vÃ  Ä‘Æ°á»£c render trÃªn trang. 123456789101112&lt;extended-button&gt; #shadow-root &lt;style&gt;â€¦&lt;/style&gt; &lt;slot name=\"image\"&gt; &lt;img src=\"boot.png\" slot=\"image\"&gt; &lt;/slot&gt; &lt;span id=\"container\"&gt; &lt;slot&gt; &lt;span&gt;Launch&lt;/span&gt; &lt;/slot&gt; &lt;/span&gt;&lt;/extended-button&gt; TemplatesKhi báº¡n pháº£i tÃ¡i sá»­ dá»¥ng liÃªn tá»¥c 1 vÃ i Ä‘oáº¡n markup nÃ o Ä‘Ã³ trÃªn trang web, cÃ¡ch tá»‘t hÆ¡n lÃ  ta sá»­ dá»¥ng 1 kiá»ƒu template hÆ¡n lÃ  cá»© láº·p Ä‘i láº·p láº¡i cÃ¹ng 1 cáº¥u trÃºc Ä‘Ã³ háº¿t láº§n nÃ y Ä‘áº¿n láº§n khÃ¡c. TrÆ°á»›c Ä‘Ã¢y váº«n lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y nhÆ°ng bÃ¢y giá» thÃ¬ dá»… hÆ¡n nhiá»u vá»›i element HTML &lt;template&gt; há»— trá»£ sáºµn bá»Ÿi ráº¥t nhiá»u trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i. Element nÃ y vÃ  ná»™i dung cá»§a nÃ³ khÃ´ng Ä‘Æ°á»£c render trÃªn DOM nhÆ°ng nÃ³ váº«n cÃ³ thá»ƒ tham chiáº¿u Ä‘áº¿n báº±ng Javascript. CÃ¹ng xem 1 vÃ­ dá»¥ Ä‘Æ¡n giáº£n nÃ o: 123&lt;template id=\"my-paragraph\"&gt; &lt;p&gt; Paragraph content. &lt;/p&gt;&lt;/template&gt; Äoáº¡n code Ä‘Ã³ sáº½ khÃ´ng hiá»ƒn thá»‹ trÃªn trang cá»§a báº¡n trá»« khi báº¡n tham chiáº¿u Ä‘áº¿n nÃ³ báº±ng Javascript vÃ  ná»‘i nÃ³ vÃ o DOM báº±ng 1 cÃ¡ch nÃ o Ä‘Ã³, cháº³ng háº¡n nhÆ°: 123var template = document.getElementById('my-paragraph');var templateContent = template.content;document.body.appendChild(templateContent); Giá» Ä‘Ã¢y, Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c cÃ¹ng 1 má»¥c Ä‘Ã­ch chung thÃ¬ cÃ³ nhiá»u ká»¹ thuáº­t khÃ¡c nhau Ä‘á»ƒ lá»±a chá»n nhÆ°ng nhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã¢y, sáº½ dá»… dÃ ng hÆ¡n nhiá»u náº¿u nhÆ° cÃ¡c ká»¹ thuáº­t Ä‘Ã³ Ä‘Æ°á»£c há»— trá»£ natively. template Ä‘Æ°á»£c cÃ¡c trÃ¬nh duyá»‡t há»— trá»£ khÃ¡ tá»‘t (trá»« IE) Tá»± báº£n thÃ¢n template Ä‘Ã£ ráº¥t cÃ³ Ã­ch rá»“i, nhÆ°ng nÃ³ cÃ²n hoáº¡t Ä‘á»™ng tá»‘t hÆ¡n ná»¯a vá»›i cÃ¡c custom element. ChÃºng ta sáº½ Ä‘á»‹nh nghÄ©a vÃ i custom element trong 1 bÃ i viáº¿t khÃ¡c, cÃ²n bÃ¢y giá», trong lÃºc nÃ y thÃ¬ báº¡n nÃªn biáº¿t lÃ  cÃ³ 1 API customElement trÃªn trÃ¬nh duyá»‡t cho phÃ©p chÃºng ta Ä‘á»‹nh nghÄ©a tháº» (tag) riÃªng cá»§a ta vá»›i cÃ¡c tÃ¹y chá»n render. Giá» ta sáº½ Ä‘á»‹nh nghÄ©a 1 web component sá»­ dá»¥ng template trÃªn lÃ m ná»™i dung cho Shadow DOM, chÃºng ta gá»i nÃ³ lÃ  : 12345678910customElements.define('my-paragraph', class extends HTMLElement &#123; constructor() &#123; super(); let template = document.getElementById('my-paragraph'); let templateContent = template.content; const shadowRoot = this.attachShadow(&#123;mode: 'open'&#125;).appendChild(templateContent.cloneNode(true)); &#125;&#125;); Äiá»ƒm then chá»‘t cáº§n chÃº Ã½ á»Ÿ Ä‘Ã¢y lÃ  chÃºng ta ná»‘i 1 báº£n sao cá»§a ná»™i dung template vÃ o shadow root - thá»© Ä‘Æ°á»£c táº¡o ra báº±ng phÆ°Æ¡ng thá»©c Node.cloneNode() VÃ  bá»Ÿi vÃ¬ ta ná»‘i ná»™i dung cá»§a nÃ³ vá»›i 1 Shadow DOM nÃªn ta cÃ³ thá»ƒ Ä‘Æ°a thÃªm 1 vÃ i thÃ´ng tin vá» style bÃªn trong template vá»›i element &lt;style&gt;, sau Ä‘Ã³ pháº§n style nÃ y sáº½ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i bÃªn trong custom element. Pháº§n nÃ y sáº½ khÃ´ng hoáº¡t Ä‘á»™ng náº¿u ta chá»‰ ná»‘i nÃ³ vÃ o 1 DOM bÃ¬nh thÆ°á»ng. VÃ­ dá»¥ ta Ä‘á»•i template thÃ nh nhÆ° sau: 12345678910&lt;template id=\"my-paragraph\"&gt; &lt;style&gt; p &#123; color: white; background-color: #666; padding: 5px; &#125; &lt;/style&gt; &lt;p&gt;Paragraph content. &lt;/p&gt;&lt;/template&gt; Giá» thÃ¬ component tÃ¹y chá»n ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a vá»›i template trÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng nhÆ° tháº¿ nÃ y:&lt;my-paragraph&gt;&lt;/my-paragraph&gt; Slots (khe trá»‘ng)Templates cÃ³ má»™t vÃ i nhÆ°á»£c Ä‘iá»ƒm, 1 trong sá»‘ Ä‘Ã³ lÃ  ná»™i dung cá»§a nÃ³ thuá»™c loáº¡i â€œtÄ©nhâ€, khÃ´ng cho phÃ©p ta render kÃ¨m theo cÃ¡c dá»¯ liá»‡u hoáº·c biáº¿n Ä‘á»ƒ lÃ m cho nÃ³ hoáº¡t Ä‘á»™ng theo cÃ¡ch bÃ¬nh thÆ°á»ng nhÆ° cÃ¡c template HTML tiÃªu chuáº©n mÃ  ta thÆ°á»ng sá»­ dá»¥ng. VÃ  Ä‘Ã¢y lÃ  lÃºc mÃ  &lt;slot&gt; xuáº¥t hiá»‡n. Báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng ráº±ng slots giá»‘ng nhÆ° ngÆ°á»i giá»¯ chá»—, nÃ³ cho phÃ©p báº¡n Ä‘áº·t HTML riÃªng cá»§a mÃ¬nh vÃ o trong template. NÃ³ giÃºp cho báº¡n táº¡o ra cÃ¡c template HTML linh Ä‘á»™ng hÆ¡n, dá»… tÃ¹y biáº¿n hÆ¡n báº±ng cÃ¡ch thÃªm vÃ o nhiá»u slot. Viáº¿t láº¡i template á»Ÿ pháº§n trÃªn vá»›i slot: 12345&lt;template id=\"my-paragraph\"&gt; &lt;p&gt; &lt;slot name=\"my-text\"&gt;Default text&lt;/slot&gt; &lt;/p&gt;&lt;/template&gt; Náº¿u nhÆ° ná»™i dung cá»§a slot khÃ´ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a khi element Ä‘Æ°á»£c Ä‘Ã­nh kÃ¨m theo markup, hoáº·c náº¿u nhÆ° trÃ¬nh duyá»‡t khÃ´ng há»— trá»£ slot thÃ¬ &lt;my-paragraph&gt; sáº½ chá»‰ hiá»‡n dÃ²ng ná»™i dung backup â€œDefault textâ€. Äá»ƒ Ä‘á»‹nh nghÄ©a ná»™i dung slot, ta cáº§n Ä‘Ã­nh kÃ¨m 1 cáº¥u trÃºc HTML bÃªn trong element &lt;my-paragraph&gt; vá»›i thuá»™c tÃ­nh slot vÃ  gÃ¡n giÃ¡ trá»‹ cá»§a nÃ³ vá»›i name cá»§a slot mÃ  ta muá»‘n nÃ³ truyá»n vÃ o. Giá»‘ng nhÆ° code dÆ°á»›i Ä‘Ã¢y: 123&lt;my-paragraph&gt; &lt;span slot=\"my-text\"&gt;Let's have some different text!&lt;/span&gt;&lt;/my-paragraph&gt; CÃ¡c element cÃ³ thá»ƒ Ä‘Æ°á»£c chÃ¨n vÃ o trong slot Ä‘Æ°á»£c gá»i lÃ  Slotable; khi 1 element Ä‘Æ°á»£c chÃ¨n vÃ o trong slot thÃ¬ ta nÃ³i nÃ³ Ä‘Ã£ bá»‹ slotted. Äá»ƒ Ã½ ráº±ng vÃ­ dá»¥ trÃªn chÃºng ta Ä‘Ã£ chÃ¨n 1 element vÃ o, nÃ³ chÃ­nh lÃ  slotted element. NÃ³ cÃ³ 1 thuá»™c tÃ­nh slot giÃ¡ trá»‹ báº±ng my-text - cÃ¹ng giÃ¡ trá»‹ vá»›i thuá»™c tÃ­nh name trong pháº§n Ä‘á»‹nh nghÄ©a cá»§a slot á»Ÿ template. Sau khi Ä‘Æ°á»£c render trÃªn trÃ¬nh duyá»‡t, Ä‘oáº¡n code trÃªn sáº½ táº¡o ra 1 cÃ¢y Flattened DOM nhÆ° sau: 12345678&lt;my-paragraph&gt; #shadow-root &lt;p&gt; &lt;slot name=\"my-text\"&gt; &lt;span slot=\"my-text\"&gt;Let's have some different text!&lt;/span&gt; &lt;/slot&gt; &lt;/p&gt;&lt;/my-paragraph&gt; LÆ°u Ã½ Ä‘áº¿n pháº§n tá»­ #shadow-root - nÃ³ xuáº¥t hiá»‡n nhÆ° 1 chá»‰ thá»‹ ráº±ng Shadow DOM Ä‘ang tá»“n táº¡i á»Ÿ Ä‘Ã¢y. StylingMá»™t component sá»­ dá»¥ng Shadow DOM cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¹y chá»‰nh style tá»« trang chÃ­nh, cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a style cá»§a riÃªng nÃ³ hoáº·c cung cáº¥p hook dÆ°á»›i dáº¡ng thuá»™c tÃ­nh tÃ¹y chá»‰nh CSS Ä‘á»ƒ user cÃ³ thá»ƒ ghi Ä‘Ã¨ nhá»¯ng thiáº¿t láº­p máº·c Ä‘á»‹nh. Äá»‹nh nghÄ©a style cho componentScoped CSS (CSS trong pháº¡m vi) lÃ  1 trong sá»‘ cÃ¡c tÃ­nh nÄƒng tuyá»‡t vá»i nháº¥t cá»§a Shadow DOM: CÃ¡c CSS selector tá»« trang bÃªn ngoÃ i sáº½ khÃ´ng Ã¡p dá»¥ng Ä‘Æ°á»£c vÃ o bÃªn trong component cá»§a báº¡n CÃ¡c style Ä‘á»‹nh nghÄ©a bÃªn trong component sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n toÃ n bá»™ trang. ChÃºng Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i trong pháº¡m vi cá»§a element chá»§. CÃ¡c CSS selector Ä‘Æ°á»£c dÃ¹ng bÃªn trong Shadow DOM Ã¡p dá»¥ng vá»›i component má»™t cÃ¡ch cá»¥c bá»™. Trong thá»±c tiá»…n thÃ¬ Ä‘iá»u nÃ y nghÄ©a lÃ  ta cÃ³ thá»ƒ dÃ¹ng nhiá»u láº§n cÃ¡c tÃªn id/class phá»• biáº¿n mÃ  khÃ´ng cáº§n lo vá» sá»± xung Ä‘á»™t giá»¯a chÃºng trÃªn trang. CSS selector cÃ ng Ä‘Æ¡n giáº£n thÃ¬ cÃ ng cÃ³ hiá»‡u nÄƒng tá»‘t hÆ¡n. Giá» ta cÃ¹ng xem 1 Ä‘oáº¡n #shadow-root dÆ°á»›i Ä‘Ã¢y Ä‘á»‹nh nghÄ©a style: 123456789101112#shadow-root&lt;style&gt; #container &#123; background: white; &#125; #container-items &#123; display: inline-flex; &#125;&lt;/style&gt;&lt;div id=\"container\"&gt;&lt;/div&gt;&lt;div id=\"container-items\"&gt;&lt;/div&gt; Táº¥t cáº£ style á»Ÿ vÃ­ dá»¥ trÃªn Ä‘á»u náº±m trong vÃ¹ng local cá»§a #shadow-root Báº¡n cÃ³ thá»ƒ dÃ¹ng element &lt;link&gt; Ä‘á»ƒ chÃ¨n thÃªm stylesheets á»Ÿ ngoÃ i vÃ o trong #shadow-root vÃ  nÃ³ cÅ©ng sáº½ thuá»™c vá» vÃ¹ng local. pseudo-class :host_Ai chÆ°a biáº¿t vá» pseudo-class thÃ¬ cÃ³ thá»ƒ tham kháº£o á»Ÿ Ä‘Ã¢y: https://www.w3schools.com/css/css_pseudo_classes.asp_ :host cho phÃ©p báº¡n chá»n vÃ  chá»‰nh style cho element lÃ m host (chá»§) cá»§a shadow tree: 12345&lt;style&gt; :host &#123; display: block; /* máº·c Ä‘á»‹nh thÃ¬ cÃ¡c custom element cÃ³ thuá»™c tÃ­nh display: inline */ &#125;&lt;/style&gt; CÃ³ 1 Ä‘iá»u báº¡n cáº§n pháº£i cáº©n tháº­n khi sá»­ dá»¥ng :host: pháº§n Ä‘á»‹nh nghÄ©a :host trong cÃ¡c trang cha (parent) sáº½ cÃ³ Æ°u tiÃªn cao hÆ¡n Ä‘á»‹nh :host Ä‘á»‹nh nghÄ©a trong element. Äiá»u nÃ y cho phÃ©p ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ ghi Ä‘Ã¨ pháº§n Ä‘á»‹nh nghÄ©a style cao nháº¥t tá»« bÃªn ngoÃ i. BÃªn cáº¡nh Ä‘Ã³, :host chá»‰ hoáº¡t Ä‘á»™ng trong ngá»¯ cáº£nh cá»§a 1 shadow root, vÃ¬ váº­y báº¡n khÃ´ng thá»ƒ dÃ¹ng nÃ³ bÃªn ngoÃ i Shadow DOM. Dáº¡ng function :host() cho phÃ©p báº¡n trá» trá»±c tiáº¿p Ä‘áº¿n host náº¿u nÃ³ khá»›p vá»›i 1 . ÄÃ¢y lÃ  1 cÃ¡ch ráº¥t tuyá»‡t vá»i Ä‘á»ƒ component cá»§a báº¡n cÃ³ thá»ƒ Ä‘Ã³ng gÃ³i cÃ¡c hÃ nh vi pháº£n há»“i Ä‘áº¿n cÃ¡c tÆ°Æ¡ng tÃ¡c hoáº·c tráº¡ng thÃ¡i ngÆ°á»i dÃ¹ng vÃ  chá»‰nh style cho cÃ¡c node bÃªn trong dá»±a trÃªn host: 12345678910111213141516171819&lt;style&gt; :host &#123; opacity: 0.4; &#125; :host(:hover) &#123; opacity: 1; &#125; :host([disabled]) &#123; /* style khi host cÃ³ thuá»™c tÃ­nh disabled */ background: grey; pointer-events: none; opacity: 0.4; &#125; :host(.pink) &gt; #tabs &#123; color: pink; /* tÃ´ mÃ u cho node #tabs khi host cÃ³ class=\"pink\" */ &#125;&lt;/style&gt; Dá»±ng chá»§ Ä‘á» (theme) vÃ  element vá»›i pseudo-class :host-context(&lt;selector&gt;)Pseudo-class :host-context(&lt;selector&gt;) khá»›p host element náº¿u nÃ³ hoáº·c báº¥t ká»³ element cha (ancestor) nÃ o cá»§a nÃ³ khá»›p vá»›i . Má»™t vÃ­ dá»¥ phá»• biáº¿n cho trÆ°á»ng há»£p nÃ y lÃ  lÃ m viá»‡c vá»›i chá»§ Ä‘á»ƒ (theming). Thá»±c táº¿ lÃ  cÃ³ ráº¥t nhiá»u ngÆ°á»i khi lÃ m theme Ä‘á»u thÃªm class vÃ o tháº» &lt;html&gt; hoáº·c &lt;body&gt;: 12345&lt;body class=\"lightheme\"&gt; &lt;custom-container&gt; â€¦ &lt;/custom-container&gt;&lt;/body&gt; :host-context(.lightheme) sáº½ chá»‰nh style cho khi nÃ³ lÃ  con chÃ¡u (descendant) cá»§a .lightheme: 1234:host-context(.lightheme) &#123; color: black; background: white;&#125; :host-context() cÃ³ thá»ƒ cÃ³ Ã­ch cho theming nhÆ°ng cÃ³ 1 cÃ¡ch khÃ¡c cÃ²n tá»‘t hÆ¡n ná»¯a, Ä‘Ã³ lÃ  Ä‘á»‹nh nghÄ©a 1 style hooks sá»­ dá»¥ng cÃ¡c thuá»™c tÃ­nh custom cá»§a CSS, báº¡n cÃ³ thá»ƒ xem á»Ÿ Ä‘Ã¢y: https://developers.google.com/web/fundamentals/web-components/shadowdom#stylehooks Chá»‰nh style cho host element cá»§a component tá»« bÃªn ngoÃ iBáº¡n cÃ³ thá»ƒ chá»‰nh style cho host element cá»§a component tá»« bÃªn ngoÃ i vÃ o báº±ng cÃ¡ch dÃ¹ng tag name cá»§a nÃ³ nhÆ° 1 selector, kiá»ƒu váº­y nÃ¨: 123custom-container &#123; color: red;&#125; Style bÃªn ngoÃ i cÃ³ má»©c Æ°u tiÃªn cao hÆ¡n style Ä‘á»‹nh nghÄ©a bÃªn trong Shadow DOM. VÃ­ dá»¥, náº¿u user viáº¿t 1 selector nhÆ° sau: 123custom-container &#123; width: 500px;&#125; â€¦thÃ¬ nÃ³ sáº½ ghi Ä‘Ã¨ lÃªn rule cá»§a component: 123:host &#123; width: 300px;&#125; Tá»©c lÃ  width lÃºc nÃ y cÃ³ giÃ¡ trá»‹ 500px Styling chÃ­nh component thÃ¬ chá»‰ cÃ³ thá»ƒ Ä‘áº¿n má»©c nÃ y thÃ´i. Váº­y náº¿u báº¡n muá»‘n style cÃ¡c thÃ nh pháº§n sÃ¢u hÆ¡n bÃªn trong cá»§a component thÃ¬ sao? Ta sáº½ cáº§n Ä‘áº¿n cÃ¡c thuá»™c tÃ­nh custom cá»§a CSS. Táº¡o style hook sá»­ dá»¥ng thuá»™c tÃ­nh custom cá»§a CSSUser cÃ³ thá»ƒ dÃ¹ng máº¹o Ä‘á»ƒ chá»‰nh style cho cÃ¡c thÃ nh pháº§n bÃªn trong náº¿u nhÆ° tÃ¡c giáº£ cá»§a component Ä‘Ã³ cÃ³ cung cáº¥p styling hook sá»­ dá»¥ng thuá»™c tÃ­nh custom cá»§a CSS. Ã tÆ°á»Ÿng tÆ°Æ¡ng tá»± vá»›i &lt;slot&gt; nhÆ°ng Ã¡p dá»¥ng cho style. CÃ¹ng xem vÃ­ dá»¥ bÃªn dÆ°á»›i: 123456789&lt;!-- main page --&gt;&lt;style&gt; custom-container &#123; margin-bottom: 60px; - custom-container-bg: black; &#125;&lt;/style&gt;&lt;custom-container background&gt;â€¦&lt;/custom-container&gt; bÃªn trong Shadow DOM cá»§a nÃ³: 12345:host([background]) &#123; background: var( - custom-container-bg, #CECECE); border-radius: 10px; padding: 10px;&#125; Trong trÆ°á»ng há»£p nÃ y, component sáº½ sá»­ dá»¥ng mÃ u black lÃ m giÃ¡ trá»‹ cho background bá»Ÿi vÃ¬ user muá»‘n tháº¿. Náº¿u khÃ´ng thÃ¬ nÃ³ sáº½ dÃ¹ng giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  #CECECE. Náº¿u lÃ  tÃ¡c giáº£ cá»§a component, báº¡n cÃ³ trÃ¡ch nhiá»‡m cho developer biáº¿t vá» nhá»¯ng thuá»™c tÃ­nh custom cá»§a CSS mÃ  há» cÃ³ thá»ƒ sá»­ dá»¥ng. HÃ£y xem nhÆ° Ä‘Ã³ lÃ  luáº­t báº¥t thÃ nh vÄƒn khi public má»™t component. Javascript API cho slotShadow DOM API cung cáº¥p nhiá»u tiá»‡n Ã­ch há»¯u dá»¥ng Ä‘á»ƒ lÃ m viá»‡c vá»›i slot Sá»± kiá»‡n slotchangeSá»± kiá»‡n slotchange Ä‘Æ°á»£c báº¯n ra khi node phÃ¢n phá»‘i cá»§a slot bá»‹ thay Ä‘á»•i. VÃ­ dá»¥, náº¿u user thÃªm/bá»›t children tá»« light DOM. 1234var slot = this.shadowRoot.querySelector('#some_slot');slot.addEventListener('slotchange', function(e) &#123; console.log('Light DOM change');&#125;); Äá»ƒ kiá»ƒm soÃ¡t cÃ¡c kiá»ƒu thay Ä‘á»•i khÃ¡c trÃªn light DOM, báº¡n cÃ³ thá»ƒ dÃ¹ng MutationObserver trong constructor cá»§a element. ChÃºng ta Ä‘Ã£ tá»«ng tháº£o luáº­n vá» nÃ³ trong Pháº§n 10 rá»“i. PhÆ°Æ¡ng thá»©c assignedNodes()Sáº½ ráº¥t cÃ³ Ã­ch khi biáº¿t ráº±ng cÃ¡c element cÃ³ liÃªn káº¿t vá»›i slot. Gá»i slot.assignedNodes() sáº½ cho phÃ©p báº¡n biáº¿t nhá»¯ng element nÃ o mÃ  slot render. Option {flatten: true} cÅ©ng sáº½ tráº£ vá» ná»™i dung fallback cá»§a slot (náº¿u nhÆ° khÃ´ng cÃ³ node nÃ o Ä‘ang Ä‘Æ°á»£c phÃ¢n phá»‘i). CÃ¹ng xem vÃ­ dá»¥ sau Ä‘Ã¢y: 1&lt;slot name='slot1'&gt;&lt;p&gt;Default content&lt;/p&gt;&lt;/slot&gt; Giáº£ sá»­ nÃ³ náº±m trong 1 component gá»i lÃ  &lt;my-container&gt; Giá» ta sáº½ test thá»­ cÃ¡c cÃ¡ch sá»­ dá»¥ng khÃ¡c nhau cá»§a component nÃ y vÃ  káº¿t quáº£ tráº£ vá» cá»§a assignedNodes(): TrÆ°á»ng há»£p Ä‘áº§u tiÃªn, ta sáº½ thÃªm ná»™i dung vÃ o slot: 123&lt;my-container&gt; &lt;span slot=\"slot1\"&gt; container text &lt;/span&gt;&lt;/my-container&gt; Gá»i assignedNodes() sáº½ cÃ³ káº¿t quáº£ [&lt;span slot=&#39;slot1&#39;&gt; container text &lt;/span&gt;]. Äá»ƒ Ã½ ráº±ng káº¿t quáº£ lÃ  1 array cÃ¡c node. Trong trÆ°á»ng há»£p thá»© 2, ta Ä‘á»ƒ ná»™i dung trá»‘ng trÆ¡n:&lt;my-container&gt; &lt;/my-container&gt; Káº¿t quáº£ khi gá»i assignedNodes() lÃ  1 array rá»—ng []. Tuy nhiÃªn náº¿u nhÆ° báº¡n Ä‘áº©y thÃªm option {flatten: true} thÃ¬ nÃ³ sáº½ láº¥y giÃ¡ trá»‹ máº·c Ä‘á»‹nh vÃ  tráº£ vá» [Default content]. NgoÃ i ra, Ä‘á»ƒ cÃ³ thá»ƒ cháº¡m tá»›i 1 element bÃªn trong slot, báº¡n cÃ³ thá»ƒ gá»i assignedNodes() Ä‘á»ƒ xem náº¿u cÃ³ element nÃ o Ä‘ang Ä‘Æ°á»£c gÃ¡n vÃ o component slot hay khÃ´ng. MÃ´ hÃ¬nh sá»± kiá»‡n (event model)Tháº­t thÃº vá»‹ khi Ä‘á»ƒ Ã½ tháº¥y Ä‘iá»u gÃ¬ xáº£y ra khi 1 sá»± kiá»‡n náº±m trong Shadow DOM Ä‘Æ°á»£c báº¯n ra. Má»¥c tiÃªu cá»§a sá»± kiá»‡n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»ƒ báº£o trÃ¬ sá»± Ä‘Ã³ng gÃ³i, cÃ´ láº­p bá»Ÿi Shadow DOM. Khi 1 sá»± kiá»‡n Ä‘Æ°á»£c tÃ¡i-má»¥c-tiÃªu (re-target), trÃ´ng giá»‘ng nhÆ° lÃ  nÃ³ xuáº¥t phÃ¡t tá»« chÃ­nh component hÆ¡n lÃ  tá»« cÃ¡c element bÃªn trong cá»§a Shadow DOM - vá»‘n lÃ  1 pháº§n cá»§a component. DÆ°á»›i Ä‘Ã¢y lÃ  danh sÃ¡ch cÃ¡c sá»± kiá»‡n cÃ³ thá»ƒ phÃ¡t ra ngoÃ i Shadow DOM (1 sá»‘ thÃ¬ khÃ´ng): Sá»± kiá»‡n Focus: blur, focus, focusin, focusout Sá»± kiá»‡n cho con trá» chuá»™t: click, dbclick, mousedown, mouseenter, mousemove, vÃ¢n vÃ¢n. Sá»± kiá»‡n cho con lÄƒn chuá»™t: wheel Sá»± kiá»‡n cho input: beforeinput, input Sá»± kiá»‡n cho bÃ n phÃ­m: keydown, keyup Sá»± kiá»‡n káº¿t há»£p: compositionstart, compositionupdate, compositionend Sá»± kiá»‡n kÃ©o-tháº£: dragstart, drag, dragend, drop, vÃ¢n vÃ¢n. CÃ¡c sá»± kiá»‡n customCÃ¡c sá»± kiá»‡n custom máº·c Ä‘á»‹nh thÃ¬ khÃ´ng phÃ¡t ra bÃªn ngoÃ i Shadow DOM. Náº¿u báº¡n muá»‘n Ä‘iá»u phá»‘i 1 sá»± kiá»‡n custom vÃ  muá»‘n nÃ³ phÃ¡t ra ngoÃ i, báº¡n cáº§n thÃªm 2 option: bubbles: true vÃ  composed: true VÃ­ dá»¥: 12var container = this.shadowRoot.querySelector('#container');container.dispatchEvent(new Event('containerchanged', &#123;bubbles: true, composed: true&#125;)); Sá»± há»— trá»£ trÃ¬nh duyá»‡t: Äá»ƒ xÃ¡c Ä‘á»‹nh xem trÃ¬nh duyá»‡t cÃ³ sáºµn há»— trá»£ cho Shadow DOM hay khÃ´ng thÃ¬ ta cÃ³ thá»ƒ kiá»ƒm tra sá»± tá»“n táº¡i cá»§a attachShadow: 1const supportsShadowDOMV1 = !!HTMLElement.prototype.attachShadow; NhÆ°ng nÃ³i chung lÃ  khÃ´ng Ä‘Æ°á»£c nhiá»u cho láº¯m: NhÃ¬n chung thÃ¬ Shadow DOM cÃ³ lá»‘i hÃ nh xá»­ ráº¥t khÃ¡c vá»›i DOM thÆ°á»ng. Team SessionStack cÃ³ 1 chÃºt kinh nghiá»‡m khi sá»­ dá»¥ng chÃºng trong thÆ° viá»‡n cá»§a há». ThÆ° viá»‡n Ä‘Ã³ khi Ä‘Æ°á»£c tÃ­ch há»£p vÃ o trong webapp thÃ¬ sáº½ báº¯t Ä‘áº§u thu tháº­p cÃ¡c thÃ´ng tin cháº³ng háº¡n nhÆ° sá»± kiá»‡n ngÆ°á»i dÃ¹ng, dá»¯ liá»‡u máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o debug, thay Ä‘á»•i trÃªn DOM, vÃ¢n vÃ¢n, vÃ  gá»­i chÃºng vá» cho server cá»§a há». Sau Ä‘Ã³, há» sáº½ xá»­ lÃ½ cÃ¡c dá»¯ liá»‡u thu Ä‘Æ°á»£c Ä‘á»ƒ cho phÃ©p báº¡n cÃ³ thá»ƒ dÃ¹ng SessionStack Ä‘á»ƒ tÃ¡i hiá»‡n láº¡i cÃ¡c váº¥n Ä‘á» xáº£y ra trong sáº£n pháº©m cá»§a báº¡n. Sá»± khÃ³ khÄƒn há» gáº·p pháº£i trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn khi sá»­ dá»¥ng Shadow DOM: há» pháº£i kiá»ƒm soÃ¡t má»i thay Ä‘á»•i trÃªn DOM Ä‘á»ƒ cÃ³ thá»ƒ tÃ¡i táº¡o láº¡i sau nÃ y. Há» dÃ¹ng MutationObserver Ä‘á»ƒ lÃ m viá»‡c Ä‘Ã³. Tuy nhiÃªn, Shadow DOM khÃ´ng trigger cÃ¡c sá»± kiá»‡n MutationObserver trong pháº¡m vi toÃ n cá»¥c, nghÄ©a lÃ  há» pháº£i xá»­ lÃ½ cÃ¡c component nÃ y theo 1 cÃ¡ch hoÃ n toÃ n khÃ¡c.Há» cÅ©ng nháº­n tháº¥y ráº±ng ngÃ y nay, cÃ³ ráº¥t nhiá»u webapp Ä‘ang táº­n dá»¥ng sá»©c máº¡nh cá»§a Shadow DOM nÃªn cÃ³ váº» nhÆ° cÃ´ng nghá»‡ nÃ y sáº½ cÃ³ 1 tÆ°Æ¡ng lai ráº¥t ráº¡ng ngá»i.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P16: Engine lÆ°u trá»¯ + lá»±a chá»n API lÆ°u trá»¯ nÃ o cho phÃ¹ há»£p","slug":"Cach-Javascript-hoat-dong-P16-Engine-luu-tru-lua-chon-API-luu-tru-nao-cho-phu-hop","date":"2018-11-25T09:42:00.000Z","updated":"2018-11-25T09:44:30.253Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P16-Engine-luu-tru-lua-chon-API-luu-tru-nao-cho-phu-hop.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P16-Engine-luu-tru-lua-chon-API-luu-tru-nao-cho-phu-hop.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 16 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tLá»±a chá»n cÆ¡ cháº¿ lÆ°u trá»¯ Ä‘Ãºng Ä‘áº¯n cho thiáº¿t bá»‹ lÆ°u trá»¯ á»Ÿ local ráº¥t quan trá»ng khi thiáº¿t káº¿ webapp. Má»™t engine lÆ°u trá»¯ tá»‘t sáº½ Ä‘áº£m báº£o thÃ´ng tin cá»§a báº¡n Ä‘Æ°á»£c lÆ°u cháº¯c cháº¯n, giáº£m bÄƒng thÃ´ng vÃ  cáº£i thiá»‡n sá»± pháº£n há»“i. Chiáº¿n lÆ°á»£c lÆ°u trá»¯ bá»™ nhá»› Ä‘á»‡m phÃ¹ há»£p lÃ  thÃ nh pháº§n cá»‘t lÃµi cho phÃ©p tráº£i nghiá»‡m mobile web offline, cÃ ng ngÃ y cÃ ng cÃ³ nhiá»u ngÆ°á»i dÃ¹ng cáº£m tháº¥y ráº±ng nhÆ° Ä‘Ã³ lÃ  tráº£i nghiá»‡m máº·c Ä‘á»‹nh pháº£i cÃ³. Trong chÆ°Æ¡ng nÃ y, chÃºng ta sáº½ tháº£o luáº­n vá» nhá»¯ng API lÆ°u trá»¯ cÃ³ sáºµn &amp; cÃ¡c service vÃ  cung cáº¥p má»™t sá»‘ hÆ°á»›ng dáº«n lÃ m tháº¿ nÃ o Ä‘á»ƒ lá»±a chá»n Ä‘Ãºng loáº¡i cho webapp cá»§a báº¡n.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 16 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tLá»±a chá»n cÆ¡ cháº¿ lÆ°u trá»¯ Ä‘Ãºng Ä‘áº¯n cho thiáº¿t bá»‹ lÆ°u trá»¯ á»Ÿ local ráº¥t quan trá»ng khi thiáº¿t káº¿ webapp. Má»™t engine lÆ°u trá»¯ tá»‘t sáº½ Ä‘áº£m báº£o thÃ´ng tin cá»§a báº¡n Ä‘Æ°á»£c lÆ°u cháº¯c cháº¯n, giáº£m bÄƒng thÃ´ng vÃ  cáº£i thiá»‡n sá»± pháº£n há»“i. Chiáº¿n lÆ°á»£c lÆ°u trá»¯ bá»™ nhá»› Ä‘á»‡m phÃ¹ há»£p lÃ  thÃ nh pháº§n cá»‘t lÃµi cho phÃ©p tráº£i nghiá»‡m mobile web offline, cÃ ng ngÃ y cÃ ng cÃ³ nhiá»u ngÆ°á»i dÃ¹ng cáº£m tháº¥y ráº±ng nhÆ° Ä‘Ã³ lÃ  tráº£i nghiá»‡m máº·c Ä‘á»‹nh pháº£i cÃ³. Trong chÆ°Æ¡ng nÃ y, chÃºng ta sáº½ tháº£o luáº­n vá» nhá»¯ng API lÆ°u trá»¯ cÃ³ sáºµn &amp; cÃ¡c service vÃ  cung cáº¥p má»™t sá»‘ hÆ°á»›ng dáº«n lÃ m tháº¿ nÃ o Ä‘á»ƒ lá»±a chá»n Ä‘Ãºng loáº¡i cho webapp cá»§a báº¡n. Data model (mÃ´ hÃ¬nh dá»¯ liá»‡u)MÃ´ hÃ¬nh lÆ°u trá»¯ dá»¯ liá»‡u xÃ¡c Ä‘á»‹nh lÃ m tháº¿ nÃ o Ä‘á»ƒ dá»¯ liá»‡u Ä‘Æ°á»£c tá»• chá»©c ná»™i bá»™. Äiá»u nÃ y áº£nh hÆ°á»Ÿng toÃ n bá»™ thiáº¿t káº¿ cá»§a webapp, Ä‘á»‹nh nghÄ©a sá»± cÃ¢n báº±ng Ä‘á»ƒ lÃ m cho webapp hoáº¡t Ä‘á»™ng hiá»‡u quáº£ nhÆ°ng váº«n giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» cáº§n giáº£i quyáº¿t. Giá»‘ng nhÆ° báº¥t cá»© thá»© gÃ¬ liÃªn quan Ä‘áº¿n ká»¹ thuáº­t, khÃ´ng tá»“n táº¡i phÆ°Æ¡ng phÃ¡p nÃ o â€œtá»‘t hÆ¡nâ€ vÃ  cÅ©ng khÃ´ng cÃ³ giáº£i phÃ¡p má»™t-cho-táº¥t-cáº£ nÃ o háº¿t. CÃ¹ng xem qua 1 chÃºt vá» má»™t sá»‘ data model mÃ  ta cÃ³ thá»ƒ dÃ¹ng: Kiá»ƒu cáº¥u trÃºc: Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trong cÃ¡c báº£ng kÃ¨m vá»›i cÃ¡c trÆ°á»ng Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a, giá»‘ng nhÆ° cÃ¡c há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘áº·c trÆ°ng dá»±a trÃªn SQL, chÃºng cÃ³ tÃ­nh linh hoáº¡t vÃ  cÃ¡c cÃ¢u truy váº¥n Ä‘á»™ng. Má»™t vÃ­ dá»¥ ná»•i báº­t vá» kho dá»¯ liá»‡u kiá»ƒu cáº¥u trÃºc trÃªn trÃ¬nh duyá»‡t chÃ­nh lÃ  IndexedDB. key/value: kho dá»¯ liá»‡u key/value, vÃ  cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u NoSQL, cho phÃ©p lÆ°u trá»¯ vÃ  trÃ­ch xuáº¥t dá»¯ liá»‡u khÃ´ng cÃ³ cáº¥u trÃºc Ä‘Æ°á»£c Ä‘Ã¡nh index báº±ng 1 key duy nháº¥t. Kho dá»¯ liá»‡u kiá»ƒu key/value giá»‘ng nhÆ° báº£ng bÄƒm (hash table) á»Ÿ chá»— chÃºng cho phÃ©p truy cáº­p liÃªn tá»¥c vÃ o cÃ¡c dá»¯ liá»‡u áº©n Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh index. Má»™t vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh cho kho dá»¯ liá»‡u key/value lÃ  Cache API trÃªn trÃ¬nh duyá»‡t vÃ  Apache Cassandra trÃªn server. Byte Streams: mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n nÃ y lÆ°u dá»¯ liá»‡u dÆ°á»›i dáº¡ng 1 biáº¿n Ä‘á»™ dÃ i, má»™t chuá»—i áº©n cÃ¡c byte, vÃ  nÃ³ Ä‘á»ƒ láº¡i báº¥t ká»³ hÃ¬nh thá»©c tá»• chá»©c ná»™i bá»™ nÃ o cho lá»›p á»©ng dá»¥ng. MÃ´ hÃ¬nh nÃ y Ä‘áº·c biá»‡t tá»‘t cho cÃ¡c há»‡ thá»‘ng táº­p tin (file) vÃ  cÃ¡c blob dá»¯ liá»‡u cÃ³ tá»• chá»©c dáº¡ng phÃ¢n cáº¥p. VÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh cá»§a kho dá»¯ liá»‡u byte stream bao gá»“m nhá»¯ng há»‡ thá»‘ng file vÃ  cÃ¡c dá»‹ch vá»¥ lÆ°u trá»¯ cloud. TÃ­nh bá»n vá»¯ngCÃ³ thá»ƒ phÃ¢n tÃ­ch cÃ¡c phÆ°Æ¡ng phÃ¡p lÆ°u trá»¯ cho webapp vá»›i sá»± má»©c Ä‘á»™ Æ°u tiÃªn cho timeframe hÆ¡n lÃ  dá»¯ liá»‡u nÃ o cáº§n Ä‘Æ°á»£c bá»n vá»¯ng: Session Persistence (Bá»n vá»¯ng phiÃªn): dá»¯ liá»‡u trong má»¥c nÃ y chá»‰ Ä‘Æ°á»£c giá»¯ cá»‘ Ä‘á»‹nh miá»…n lÃ  má»™t session cá»§a web hoáº·c má»™t tab trÃªn trÃ¬nh duyá»‡t váº«n Ä‘ang hoáº¡t Ä‘á»™ng. VÃ­ dá»¥ vá» cÆ¡ cháº¿ lÆ°u trá»¯ vá»›i phiÃªn bá»n vá»¯ng chÃ­nh lÃ  Session Storage API Device Persistence (Bá»n vá»¯ng thiáº¿t bá»‹): dá»¯ liá»‡u trong má»¥c nÃ y Ä‘Æ°á»£c giá»¯ cá»‘ Ä‘á»‹nh xuyÃªn suá»‘t nhiá»u session vÃ  nhiá»u tab hoáº·c cá»­a sá»• trÃ¬nh duyá»‡t, trÃªn 1 thiáº¿t bá»‹ cá»¥ thá»ƒ. VÃ­ dá»¥: Cache API Global Persistence (Bá»n vá»¯ng toÃ n cá»¥c): dá»¯ liá»‡u trong má»¥c nÃ y Ä‘Æ°á»£c giá»¯ cá»‘ Ä‘á»‹nh xuyÃªn suá»‘t cÃ¡c session &amp; cÃ¡c thiáº¿t bá»‹. VÃ¬ tháº¿, Ä‘Ã¢y lÃ  dáº¡ng máº¡nh máº½ nháº¥t cá»§a bá»n vá»¯ng dá»¯ liá»‡u. NÃ³ khÃ´ng Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn chÃ­nh thiáº¿t bá»‹ vÃ  Ä‘iá»u Ä‘Ã³ nghÄ©a lÃ  báº¡n cáº§n pháº£i cÃ³ 1 kiá»ƒu lÆ°u trá»¯ á»Ÿ phÃ­a server. ChÃºng ta sáº½ khÃ´ng tháº£o luáº­n chi tiáº¿t vá» nÃ³ vÃ¬ bÃ i viáº¿t nÃ y chá»‰ táº­p trung vÃ o lÆ°u trá»¯ dá»¯ liá»‡u trÃªn thiáº¿t bá»‹. Bá»n vá»¯ng dá»¯ liá»‡u trÃªn trÃ¬nh duyá»‡tNgÃ y nay cÃ³ ráº¥t Ã­t cÃ¡c browser API cho phÃ©p báº¡n lÆ°u trá»¯ dá»¯ liá»‡u. ChÃºng ta sáº½ tÃ¬m hiá»ƒu qua má»™t vÃ i thá»© nhÆ° tháº¿ vÃ  táº¡o 1 báº£n so sÃ¡nh Ä‘á»ƒ cÃ³ thá»ƒ dá»… dÃ ng lá»±a chá»n giáº£i phÃ¡p phÃ¹ há»£p. Tuy nhiÃªn thÃ¬ Ä‘áº§u tiÃªn, cÃ³ vÃ i thá»© báº¡n cáº§n pháº£i cÃ¢n nháº¯c trÆ°á»›c khi chá»n lÃ m tháº¿ nÃ o Ä‘á»ƒ cá»‘ Ä‘á»‹nh dá»¯ liá»‡u. DÄ© nhiÃªn thÃ¬ thá»© Ä‘áº§u tiÃªn báº¡n cáº§n pháº£i hiá»ƒu ká»¹ chÃ­nh lÃ  webapp cá»§a báº¡n Ä‘Æ°á»£c dÃ¹ng nhÆ° tháº¿ nÃ o, sau Ä‘Ã³ cÃ²n cÃ³ báº£o trÃ¬ vÃ  nÃ¢ng cáº¥p. Tháº­m chÃ­ náº¿u báº¡n cÃ³ cÃ¢u tráº£ lá»i cho cÃ¡c cÃ¢u há»i Ä‘Ã³, báº¡n cÅ©ng sáº½ pháº£i káº¿t thÃºc vá»›i 1 sá»‘ lá»±a chá»n vÃ  chá»n chÃºng. VÃ¬ tháº¿ nÃªn dÆ°á»›i Ä‘Ã¢y lÃ  1 sá»‘ thá»© báº¡n nÃªn xem qua: TrÃ¬nh duyá»‡t há»— trá»£: báº¡n cáº§n pháº£i nhá»› ká»¹ 1 sá»± tháº­t lÃ  cÃ¡c API Ä‘Æ°á»£c xÃ¢y dá»±ng tá»‘t &amp; Ä‘Æ°á»£c chuáº©n hÃ³a cÃ³ má»©c Ä‘á»™ Æ°u Ã¡i cao hÆ¡n, bá»Ÿi vÃ¬ chÃºng hÆ°á»›ng tá»›i sá»± tá»“n táº¡i lÃ¢u dÃ i vÃ  Ä‘Æ°á»£c há»— trá»£ rá»™ng rÃ£i. Nhá»¯ng API Ä‘Ã³ cÅ©ng thÆ°á»ng cÃ³ tÃ i liá»‡u rá»™ng hÆ¡n vÃ  cá»™ng Ä‘á»“ng developer há»— trá»£ giÃ u kinh nghiá»‡m hÆ¡n. Transactions (giao dá»‹ch): Ä‘Ã´i khi transactions ráº¥t quan trá»ng Ä‘á»‘i vá»›i 1 táº­p há»£p cá»§a cÃ¡c hoáº¡t Ä‘á»™ng lÆ°u trá»¯ tá»± Ä‘á»™ng thÃ nh cÃ´ng hay tháº¥t báº¡i. CÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u theo truyá»n thá»‘ng luÃ´n há»— trá»£ tÃ­nh nÄƒng nÃ y sá»­ dá»¥ng 1 mÃ´ hÃ¬nh transaction, nhá»¯ng cáº­p nháº­t liÃªn quan Ä‘Æ°á»£c nhÃ³m láº¡i thÃ nh cÃ¡c Ä‘Æ¡n vá»‹ chuyÃªn biá»‡t. Sync/Async (Ä‘á»“ng bá»™/báº¥t Ä‘á»“ng bá»™): má»™t vÃ i API lÆ°u trá»¯ thá»ƒ hiá»‡n sá»± Ä‘á»“ng bá»™ khi mÃ  cÃ¡c request lÆ°u trá»¯ hoáº·c láº¥y dá»¯ liá»‡u sáº½ cháº·n tiáº¿n trÃ¬nh Ä‘ang hoáº¡t Ä‘á»™ng cho tá»›i khi request Ä‘Æ°á»£c hoÃ n thÃ nh. Sá»­ dá»¥ng API lÆ°u trá»¯ Ä‘á»“ng bá»™ cÃ³ thá»ƒ cháº·n tiáº¿n trÃ¬nh chÃ­nh vÃ  lÃ m cho tráº£i nghiá»‡m UI trÃªn webapp bá»‹ Ä‘Ã´ng cá»©ng khÃ´ng hoáº¡t Ä‘á»™ng. Náº¿u cÃ³ thá»ƒ, hÃ£y dÃ¹ng cÃ¡c API báº¥t Ä‘á»“ng bá»™. So sÃ¡nhTrong pháº§n nÃ y, chÃºng ta sáº½ so sÃ¡nh cÃ¡c API hiá»‡n cÃ³ dÃ nh cho web developer vÃ  so sÃ¡nh chÃºng vá»›i cÃ¡c tiÃªu chÃ­ Ä‘Ã£ nÃ³i á»Ÿ trÃªn API MÃ´ hÃ¬nh dá»¯ liá»‡u (Data model) TÃ­nh bá»n vá»¯ng (persistence) TrÃ¬nh duyá»‡t há»— trá»£ Transactions Sync/Async File System (há»‡ thá»‘ng file) Byte stream thiáº¿t bá»‹ 52% KhÃ´ng Async Local Storage key/value thiáº¿t bá»‹ 93% KhÃ´ng Sync Session Storage key/value session 93% KhÃ´ng Sync Cookies cáº¥u trÃºc thiáº¿t bá»‹ 100% KhÃ´ng Sync Cache key/value thiáº¿t bá»‹ 60% KhÃ´ng Async IndexedDB há»—n há»£p (hybrid) thiáº¿t bá»‹ 83% CÃ³ Async File System API (há»‡ thá»‘ng file) Vá»›i File System API, webapp cÃ³ thá»ƒ táº¡o, Ä‘á»c, Ä‘iá»u hÆ°á»›ng vÃ  ghi vÃ o 1 khu vá»±c sandbox thuá»™c há»‡ thá»‘ng local file cá»§a user. API Ä‘Æ°á»£c chia nhá» thÃ nh nhiá»u chá»§ Ä‘á»: Äá»c vÃ  sá»­a file: File/Blob, FileList, FileReader Táº¡o vÃ  ghi file: Blob(), FileWriter CÃ¡c thÆ° má»¥c vÃ  truy cáº­p há»‡ thá»‘ng file: DirectoryReader, FileEntry/DirectoryEntry, LocalFileSystem File System API khÃ´ng pháº£i lÃ  1 há»‡ thá»‘ng API tiÃªu chuáº©n. Báº¡n khÃ´ng nÃªn dÃ¹ng nÃ³ trÃªn sáº£n pháº©m webapp production bá»Ÿi vÃ¬ nÃ³ sáº½ khÃ´ng hoáº¡t Ä‘á»™ng vá»›i táº¥t cáº£ user. CÃ³ ráº¥t sá»± khÃ´ng tÆ°Æ¡ng thÃ­ch lá»›n giá»¯a cÃ¡c triá»ƒn khai khÃ¡c nhau vÃ  hÃ nh vi cá»§a chÃºng sáº½ cháº¯c cháº¯n bá»‹ thay Ä‘á»•i trong tÆ°Æ¡ng lai. FileSystem - interface cá»§a File &amp; Directory Entries API Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thá»ƒ hiá»‡n 1 há»‡ thá»‘ng file. Nhá»¯ng object nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c láº¥y tá»« thuá»™c tÃ­nh filesystem cá»§a báº¥t ká»³ entry thuá»™c há»‡ thá»‘ng file nÃ o. Má»™t vÃ i trÃ¬nh duyá»‡t cung cáº¥p thÃªm cÃ¡c API Ä‘á»ƒ táº¡o &amp; quáº£n lÃ½ cÃ¡c há»‡ thá»‘ng file. Interface nÃ y sáº½ khÃ´ng cáº¥p quyá»n cho báº¡n truy cáº­p vÃ o há»‡ thá»‘ng file cá»§a user. Thay vÃ o Ä‘Ã³, báº¡n sáº½ cÃ³ 1 â€œá»• Ä‘Ä©a áº£oâ€ (virtual drive) bÃªn trong sandbox cá»§a trÃ¬nh duyá»‡t. Náº¿u báº¡n muá»‘n truy cáº­p vÃ o há»‡ thá»‘ng file cá»§a user, báº¡n cáº§n pháº£i gá»i há»i user báº±ng cÃ¡ch vÃ­ dá»¥ nhÆ° cÃ i 1 Chrome extension. YÃªu cáº§u 1 há»‡ thá»‘ng fileMá»™t webapp cÃ³ thá»ƒ yÃªu cáº§u truy cáº­p Ä‘áº¿n má»™t há»‡ thá»‘ng file sandbox báº±ng cÃ¡ch gá»i: window.requestFileSystem(): 123// LÆ°u Ã½: Há»‡ thá»‘ng file Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh tiá»n tá»‘ tÃ­nh Ä‘áº¿n Google Chrome 12.window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;window.requestFileSystem(type, size, successCallback, opt_errorCallback) Náº¿u báº¡n gá»i hÃ m requestFileSystem() láº§n Ä‘áº§u tiÃªn thÃ¬ 1 vÃ¹ng lÆ°u trá»¯ má»›i Ä‘Æ°á»£c táº¡o ra. Quan trá»ng hÃ£y nhá»› ráº±ng há»‡ thá»‘ng file nÃ y Ä‘Æ°á»£c gÃ³i gá»n trong sandbox, nghÄ©a lÃ  1 webapp khÃ´ng thá»ƒ truy cáº­p file cá»§a webapp khÃ¡c. Sau khi báº¡n cÃ³ quyá»n truy cáº­p vÃ o há»‡ thá»‘ng file, báº¡n cÃ³ thá»ƒ lÃ m táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng cÆ¡ báº£n vá»›i file &amp; thÆ° má»¥c. FileSystem lÃ  1 lá»±a chá»n lÆ°u trá»¯ khÃ¡ khÃ¡c biá»‡t vá»›i cÃ¡c loáº¡i khÃ¡c vÃ¬ nÃ³ hÆ°á»›ng Ä‘áº¿n thá»a mÃ£n nhÆ° cáº§u lÆ°u trá»¯ á»Ÿ phÃ­a client trong nhá»¯ng tÃ¬nh huá»‘ng khÃ´ng dÃ¹ng Ä‘Æ°á»£c cÆ¡ sá»Ÿ dá»¯ liá»‡u. Má»™t cÃ¡ch tá»•ng quÃ¡t thÃ¬ Ä‘Ã³ lÃ  nhá»¯ng á»©ng dá»¥ng hoáº¡t Ä‘á»™ng vá»›i nhá»¯ng cá»¥c blob nhá»‹ phÃ¢n cá»¡ bá»± vÃ /hoáº·c chia sáº» dá»¯ liá»‡u vá»›i cÃ¡c á»©ng dá»¥ng khÃ¡c bÃªn ngoÃ i trÃ¬nh duyá»‡t. DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng trÆ°á»ng há»£p cÃ³ thá»ƒ sá»­ dá»¥ng FileSystem API: Táº£i lÃªn (upload) liÃªn tá»¥c: khi 1 file hay thÆ° má»¥c Ä‘Æ°á»£c chá»n Ä‘á»ƒ upload, nÃ³ copy cÃ¡c file vÃ o trong 1 vÃ¹ng local sandbox vÃ  upload tá»«ng pháº§n, tá»«ng pháº§n. Video game, Ã¢m nháº¡c hoáº·c cÃ¡c app khÃ¡c mÃ  cÃ³ nhiá»u tÃ i nguyÃªn media. Chá»‰nh sá»­a Ã¢m thanh/hÃ¬nh áº£nh vá»›i truy cáº­p offline hoáº·c lÃ  lÆ°u Ä‘á»‡m local Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ - nhá»¯ng cá»¥c blob dá»¯ liá»‡u nhÆ° tháº¿ thÆ°á»ng ráº¥t lá»›n khi Ä‘á»c-ghi. Xem video offline - cáº§n pháº£i download 1 lÆ°á»£ng lá»›n file Ä‘á»ƒ xem sau hoáº·c seek + streaming hiá»‡u quáº£. á»¨ng dá»¥ng Web Mail offline - download cÃ¡c file Ä‘Ã­nh kÃ¨m vÃ  lÆ°u chÃºng á»Ÿ local. TÃ¬nh hÃ¬nh há»— trá»£ cá»§a API: Local Storage API localstorage cho phÃ©p báº¡n truy cáº­p object Storage dÃ nh cho origin cá»§a Document. Dá»¯ liá»‡u lÆ°u trá»¯ xuyÃªn suá»‘t nhiá»u session trÃ¬nh duyá»‡t. localstorage tÆ°Æ¡ng tá»± nhÆ° sessionStorage, ngoáº¡i trá»« viá»‡c dá»¯ liá»‡u lÆ°u á»Ÿ trong dataStorage khÃ´ng bá»‹ háº¿t háº¡n, dá»¯ liá»‡u trong sessionStorage sáº½ bá»‹ dá»n dáº¹p khi session cá»§a trang káº¿t thÃºc, tá»©c lÃ  khi Ä‘Ã³ng tab trang Ä‘Ã³. Äá»ƒ Ã½ ráº±ng dá»¯ liá»‡u lÆ°u trong localStorage hay sessionStorage lÃ  cá»¥ thá»ƒ cho origin cá»§a tá»«ng trang, bao gá»“m sá»± káº¿t há»£p cá»§a giao thá»©c (protocol), host vÃ  cá»•ng (port). TÃ¬nh hÃ¬nh há»— trá»£ sÃ¡ng sá»§a cá»§a nÃ³: Session Storage sessionStorage cho phÃ©p báº¡n truy cáº­p vÃ o 1 object Storage cá»§a session cho origin hiá»‡n táº¡i. sessionStorage tÆ°Æ¡ng tá»± nhÆ° localStorage, nhÆ° Ä‘Ã£ giáº£i thÃ­ch ngáº¯n gá»n á»Ÿ trÃªn. Äiá»ƒm khÃ¡c biá»‡t duy nháº¥t lÃ  dá»¯ liá»‡u lÆ°u trong localStorage khÃ´ng bá»‹ háº¿t háº¡n, cÃ²n trong sessionStorage thÃ¬ bá»‹ xÃ³a khi session cá»§a trang káº¿t thÃºc. Má»™t session cá»§a trang tá»“n táº¡i miá»…n lÃ  cá»­a sá»• trÃ¬nh duyá»‡t váº«n cÃ²n má»Ÿ vÃ  tá»“n táº¡i khi trang reload hoáº·c restore. Má»Ÿ trang trong 1 tab má»›i hoáº·c cá»­a sá»• má»›i sáº½ táº¡o ra session má»›i, khÃ¡c vá»›i cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a session cookies. Dá»¯ liá»‡u lÆ°u trong sessionStorage hay localStorage lÃ  dÃ nh riÃªng cho origin cá»§a trang. TÃ¬nh hÃ¬nh há»— trá»£ cá»§a sessionStorage: Cookies Má»™t cookie (hay web cookie, cookie trÃ¬nh duyá»‡t) lÃ  1 cá»¥c dá»¯ liá»‡u nhá» xÃ­u mÃ  server gá»­i Ä‘áº¿n trÃ¬nh duyá»‡t cá»§a user. TrÃ¬nh duyá»‡t cÃ³ thá»ƒ lÆ°u nÃ³ vÃ  gá»­i ngÆ°á»£c vá» cÃ¹ng server Ä‘Ã³ trong request tiáº¿p theo. ThÃ´ng thÆ°á»ng, nÃ³ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ cho biáº¿t náº¿u 2 request Ä‘áº¿n tá»« cÃ¹ng 1 trÃ¬nh duyá»‡t - vÃ­ dá»¥: giá»¯ cho user tiáº¿p tá»¥c Ä‘Äƒng nháº­p. NÃ³ ghi nhá»› thÃ´ng tin tráº¡ng thÃ¡i cho giao thá»©c HTTP khÃ´ng tráº¡ng thÃ¡i (stateless). Cookies cÃ³ 3 trÆ°á»ng há»£p dÃ¹ng chÃ­nh: Quáº£n lÃ½ session: login, giá» hÃ ng online, lÆ°u Ä‘iá»ƒm game hay báº¥t cá»© thá»© gÃ¬ server cáº§n nhá»›. CÃ¡ nhÃ¢n hÃ³a (Personalization): cÃ¡c thiáº¿t Ä‘áº·t cá»§a ngÆ°á»i dÃ¹ng, chá»§ Ä‘á»ƒ vÃ  nhá»¯ng cÃ i Ä‘áº·t khÃ¡c. Theo dÃµi: ghi láº¡i vÃ  phÃ¢n tÃ­ch hÃ nh vi cá»§a ngÆ°á»i dÃ¹ng. Cookies Ä‘Ã£ tá»«ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ tá»•ng quÃ¡t á»Ÿ phÃ­a client. NhÆ° váº­y váº«n há»£p phÃ¡p vÃ¬ lÃºc Ä‘Ã³ nÃ³ lÃ  giáº£i phÃ¡p duy nháº¥t Ä‘á»ƒ lÆ°u trá»¯ thÃ´ng tin á»Ÿ phÃ­a client, ngÃ y nay thÃ¬ ngÆ°á»i ta thÆ°á»ng chá»n cÃ¡c API lÆ°u trá»¯ hiá»‡n Ä‘áº¡i hÆ¡n. Cookies Ä‘Æ°á»£c gá»­i vá» vá»›i má»—i request nÃªn cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng xáº¥u Ä‘áº¿n hiá»‡u nÄƒng (Ä‘áº·c biá»‡t vá»›i cÃ¡c káº¿t ná»‘i trÃªn thiáº¿t bá»‹ di Ä‘á»™ng). CÃ³ 2 loáº¡i cookies: Cookie phiÃªn (session cookies: ChÃºng bá»‹ xÃ³a khi client táº¯t. TrÃ¬nh duyá»‡t web cÃ³ thá»ƒ dÃ¹ng khÃ´i phá»¥c session Ä‘á»ƒ láº¥y láº¡i gáº§n háº¿t session cookies, giá»‘ng nhÆ° lÃ  trÃ¬nh duyá»‡t chÆ°a bao giá» bá»‹ táº¯t váº­y. Cookie dÃ i háº¡n (permanent cookie): thay vÃ¬ háº¿t háº¡n khi ngÆ°á»i dÃ¹ng táº¯t trÃ¬nh duyá»‡t, permanent cookie háº¿t háº¡n táº¡i 1 ngÃ y nháº¥t Ä‘á»‹nh (Expires) hoáº·c lÃ  sau 1 khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh (Max-Age). LÆ°u Ã½ ráº±ng cÃ¡c thÃ´ng tin bÃ­ máº­t vÃ  nháº¡y cáº£m khÃ´ng nÃªn lÆ°u hoáº·c váº­n chuyá»ƒn vá»›i HTTP Cookies bá»Ÿi vÃ¬ rÃµ rÃ ng toÃ n bá»™ cÆ¡ cháº¿ nÃ y vá»‘n khÃ´ng an toÃ n. VÃ  rÃµ rÃ ng lÃ  cookies hoáº¡t Ä‘á»™ng tá»‘t vá»›i táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t. Cache Interface Cache cung cáº¥p cÆ¡ cháº¿ lÆ°u trá»¯ cho cáº·p object Request/Response Ä‘Æ°á»£c lÆ°u Ä‘á»‡m. LÆ°u Ã½ ráº±ng interface Cache Ä‘Æ°á»£c dÃ¹ng trong pháº¡m vi window giá»‘ng nhÆ° workers. Báº¡n khÃ´ng pháº£i dÃ¹ng nÃ³ cÃ¹ng vá»›i service worker máº·c dÃ¹ nÃ³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong thÃ´ng tin cá»§a service worker. Má»™t origin cÃ³ thá»ƒ cÃ³ nhiá»u object Cache (cÃ³ tÃªn cá»¥ thá»ƒ). Báº¡n cÃ³ trÃ¡ch nhiá»‡m triá»ƒn khai code (vÃ­ dá»¥ nhÆ° trong ServiceWorker) Ä‘á»ƒ xá»­ lÃ½ cáº­p nháº­t cho Cache. CÃ¡c item trong Cache khÃ´ng Ä‘Æ°á»£c cáº­p nháº­t trá»« khi Ä‘Æ°á»£c yÃªu cáº§u tÆ°á»ng minh; chÃºng khÃ´ng háº¿t háº¡n trá»« khi bá»‹ xÃ³a. DÃ¹ng hÃ m CacheStorage.open() Ä‘á»ƒ má»Ÿ 1 object Cache vá»›i tÃªn cá»¥ thá»ƒ vÃ  gá»i báº¥t ká»³ phÆ°Æ¡ng thá»©c Cache nÃ o Ä‘á»ƒ báº£o trÃ¬ Cache. Báº¡n cÅ©ng cÃ³ trÃ¡ch nhiá»‡m dá»n dáº¹p Ä‘á»‹nh ká»³ cÃ¡c cache entry. Má»—i trÃ¬nh duyá»‡t cÃ³ 1 giá»›i háº¡n cá»©ng vá»›i sá»‘ lÆ°á»£ng cache lÆ°u trá»¯ cáº¥p cho 1 origin. Háº¡n má»©c sá»­ dá»¥ng Cache Æ°á»›c tÃ­nh tá»“n táº¡i trong API StorageEstimate. TrÃ¬nh duyá»‡t lÃ m cÃ´ng viá»‡c tá»‘t nháº¥t cá»§a nÃ³ Ä‘á»ƒ quáº£n lÃ½ dung lÆ°á»£ng Ä‘Ä©a nhá»› nhÆ°ng nÃ³ cÃ³ thá»ƒ xÃ³a lÆ°u trá»¯ Cache cá»§a 1 origin. Äáº¡i khÃ¡i lÃ  trÃ¬nh duyá»‡t hoáº·c sáº½ xÃ³a táº¥t cáº£ dá»¯ liá»‡u cá»§a 1 origin hoáº·c khÃ´ng lÃ m gÃ¬ cáº£. Äáº£m báº£o Ä‘Ã¡nh phiÃªn báº£n cá»§a cache báº±ng tÃªn vÃ  chá»‰ dÃ¹ng phiÃªn báº£n cache nÃ o mÃ  code cá»§a báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng an toÃ n. Báº¡n cÃ³ thá»ƒ xem thÃªm bÃ i XÃ³a cache cÅ© Ä‘á»ƒ hiá»ƒu thÃªm. Interface CacheStorage thá»ƒ hiá»‡n sá»± lÆ°u trá»¯ cho cÃ¡c object Cache Interface: Cung cáº¥p thÆ° má»¥c master cá»§a táº¥t cáº£ cÃ¡c cache cÃ³ tÃªn mÃ  cÃ³ thá»ƒ truy xuáº¥t bá»Ÿi ServiceWorker hoáº·c cÃ¡c loáº¡i worker khÃ¡c hoáº·c pháº¡m vi window (báº¡n khÃ´ng bá»‹ giá»›i háº¡n chá»‰ sá»­ dá»¥ng vá»›i service worker ká»ƒ cáº£ thÃ´ng tin cá»§a Service Worker cÃ³ Ä‘á»‹nh nghÄ©a nhÆ° váº­y). Duy trÃ¬ kháº£ nÄƒng Ã¡nh xáº¡ (mapping) tÃªn tÆ°Æ¡ng á»©ng vá»›i object Cache DÃ¹ng phÆ°Æ¡ng thá»©c CacheStorage.open() Ä‘á»ƒ láº¥y 1 instance cá»§a Cache DÃ¹ng phÆ°Æ¡ng thá»©c CacheStorage.match() Ä‘á»ƒ kiá»ƒm tra náº¿u 1 Request cÃ³ pháº£i lÃ  1 key trong báº¥t ká»³ object Cache nÃ o mÃ  object CacheStorage theo dÃµi. Báº¡n cÃ³ thá»ƒ truy cáº­p CacheStorage thÃ´ng qua thuá»™c tÃ­nh toÃ n cá»¥c caches IndexedDB IndexedDB lÃ  1 cÃ¡ch Ä‘á»ƒ báº¡n lÆ°u trá»¯ dá»¯ liá»‡u má»™t cÃ¡ch bá»n vá»¯ng bÃªn trong trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng. Bá»Ÿi vÃ¬ nÃ³ cho phÃ©p báº¡n táº¡o cÃ¡c webapp vá»›i kháº£ nÄƒng viáº¿t cÃ¢u truy váº¥n Ä‘a dáº¡ng báº¥t ká»ƒ tÃ¬nh tráº¡ng máº¡ng. Nhá»¯ng á»©ng dá»¥ng nÃ y cÃ³ thá»ƒ lÃ m viá»‡c online &amp; offline. IndexedDB cÃ³ Ã­ch cho cÃ¡c á»©ng dá»¥ng cáº§n lÆ°u trá»¯ 1 lÆ°á»£ng lá»›n dá»¯ liá»‡u (vÃ­ dá»¥: danh sÃ¡ch cÃ¡c DVD cho mÆ°á»£n trong thÆ° viá»‡n) vÃ  cÃ¡c á»©ng dá»¥ng khÃ´ng cáº§n sá»± káº¿t ná»‘i internet á»•n Ä‘á»‹nh Ä‘á»ƒ hoáº¡t Ä‘á»™ng (vÃ­ dá»¥: á»©ng dá»¥ng mail, danh sÃ¡ch to-do, notepad). Trong bÃ i nÃ y, nÃ³ lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u trá»¯ mÃ  chÃºng ta sáº½ tháº£o luáº­n chi tiáº¿t hÆ¡n 1 chÃºt bá»Ÿi vÃ¬ cÃ¡c API lÆ°u trá»¯ khÃ¡c Ä‘á»u Ä‘Æ°á»£c hiá»ƒu biáº¿t khÃ¡ rá»™ng. ThÃªm ná»¯a, IndexedDB cÃ ng ngÃ y cÃ ng phá»• biáº¿n vá»›i cÃ¡c webapp phá»©c táº¡p ngÃ y cÃ ng gia tÄƒng. BÃªn trong IndexedDBIndexedDB cho phÃ©p báº¡n lÆ°u trá»¯ vÃ  láº¥y cÃ¡c object Ä‘Æ°á»£c lÆ°u báº±ng cÃ¡ch dÃ¹ng key. Táº¥t cáº£ thay Ä‘á»•i báº¡n thá»±c hiá»‡n vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»u xáº£y ra trong pháº¡m vi transaction. Giá»‘ng nhÆ° nhiá»u giáº£i phÃ¡p lÆ°u trá»¯ web khÃ¡c, IndexedDB bÃ¡m sÃ¡t nguyÃªn táº¯c cÃ¹ng origin (same-origin policy). VÃ¬ tháº¿ báº¡n cÃ³ thá»ƒ truy cáº­p dá»¯ liá»‡u lÆ°u trá»¯ trong pháº¡m vi 1 domain nhÆ°ng khÃ´ng thá»ƒ truy cáº­p dá»¯ liá»‡u cá»§a cÃ¡c domain khÃ¡c. IndexedDB lÃ  API báº¥t Ä‘á»“ng bá»™ (asynchronous) cÃ³ thá»ƒ sá»­ dá»¥ng trong háº§u háº¿t cÃ¡c ngá»¯ cáº£nh, bao gá»“m cáº£ WebWorkers. NÃ³ thÆ°á»ng bao gá»“m cáº£ 1 phiÃªn báº£n Ä‘á»“ng bá»™ (synchronous) ná»¯a Ä‘á»ƒ dÃ¹ng trong web worker nhÆ°ng Ä‘Ã£ bá»‹ xÃ³a bá» bá»Ÿi vÃ¬ cá»™ng Ä‘á»“ng web khÃ´ng cÃ³ há»©ng thÃº vá»›i nÃ³. IndexedDB thÆ°á»ng cáº¡nh tranh vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u WebSQL nhÆ°ng nÃ³ Ä‘Ã£ bá»‹ há»§y bá»Ÿi W3C. Trong khi cáº£ 2 IndexedDB vÃ  WebSQL lÃ  cÃ¡c giáº£i phÃ¡p lÆ°u trá»¯, chÃºng láº¡i khÃ´ng cung cáº¥p cÃ¹ng tÃ­nh nÄƒng. CSDL WebSQL lÃ  1 há»‡ truy cáº­p CSDL quan há»‡ trong khi IndexedDB lÃ  há»‡ báº£ng Ä‘Ã¡nh sá»‘ (indexed table). Äá»«ng báº¯t Ä‘áº§u vá»›i IndexedDB náº¿u nhÆ° báº¡n chá»‰ nghe nÃ³i hoáº·c giáº£ Ä‘á»‹nh ráº±ng nÃ³ tá»‘t hÆ¡n cÃ¡c loáº¡i CSDL khÃ¡c. Thay vÃ¬ tháº¿ hÃ£y Ä‘á»c tháº­t ká»¹ tÃ i liá»‡u cá»§a nÃ³. DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ i Ã½ tÆ°á»Ÿng cáº§n thiáº¿t mÃ  báº¡n cáº§n pháº£i biáº¿t: CSDL IndexedDB lÆ°u theo cáº·p key-value: giÃ¡ trá»‹ cÃ³ thá»ƒ lÃ  object cáº¥u trÃºc phá»©c táº¡p vÃ  key cÃ³ thá»ƒ lÃ  thuá»™c tÃ­nh cá»§a nhá»¯ng object Ä‘Ã³. Báº¡n cÃ³ thá»ƒ táº¡o index dÃ¹ng báº¥t ká»³ thuá»™c tÃ­nh nÃ o cá»§a object Ä‘á»ƒ dá»… tÃ¬m kiáº¿m cÅ©ng nhÆ° khi cáº§n sáº¯p xáº¿p. Key cÅ©ng cÃ³ thá»ƒ lÃ  object nhá»‹ phÃ¢n. API IndexedDB Ä‘a pháº§n lÃ  báº¥t Ä‘á»“ng bá»™: API khÃ´ng Ä‘Æ°a dá»¯ liá»‡u cho báº¡n báº±ng cÃ¡ch tráº£ vá» giÃ¡ trá»‹. Thay vÃ¬ tháº¿ nÃ³ truyá»n vÃ o 1 hÃ m callback. Báº¡n khÃ´ng â€œlÆ°uâ€ 1 giÃ¡ trá»‹ vÃ o trong CSDL hoáº·c â€œláº¥yâ€ nÃ³ ra theo nghÄ©a Ä‘á»“ng bá»™. Thay vÃ o Ä‘Ã³, báº¡n â€œyÃªu cáº§uâ€ (request) má»™t hÃ nh Ä‘á»™ng trÃªn CSDL. Má»™t sá»± kiá»‡n thÃ´ng bÃ¡o cho báº¡n khi hÃ nh Ä‘á»™ng hoÃ n thÃ nh vÃ  kiá»ƒu sá»± kiá»‡n báº¡n nháº­n Ä‘Æ°á»£c náº¿u nhÆ° cÃ³ hÃ nh Ä‘á»™ng thÃ nh cÃ´ng hay tháº¥t báº¡i. KhÃ´ng khÃ¡c máº¥y so vá»›i cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a XMLHttpRequest (hoáº·c lÃ  cáº£ tÃ¡ thá»© khÃ¡c vá» Javascript) IndexedDB dÃ¹ng ráº¥t nhiá»u request: request lÃ  object nháº­n cÃ¡c sá»± kiá»‡n thÃ nh cÃ´ng hay tháº¥t báº¡i nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn. ChÃºng cÃ³ thuá»™c tÃ­nh onsuccess vÃ  onerror cÅ©ng nhÆ° readyState, result vÃ  errorCode sáº½ cho báº¡n biáº¿t vá» tráº¡ng thÃ¡i cá»§a request. IndexedDB hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng: IndexedDB khÃ´ng pháº£i CSDL quan há»‡ vá»›i cÃ¡c báº£ng thá»ƒ hiá»‡n táº­p há»£p hÃ ng &amp; cá»™t. Äiá»ƒm khÃ¡c biá»‡t cÆ¡ báº£n nÃ y áº£nh hÆ°á»Ÿng Ä‘áº¿n giai Ä‘oáº¡n thiáº¿t káº¿ vÃ  xÃ¢y dá»±ng á»©ng dá»¥ng cá»§a báº¡n. IndexedDB khÃ´ng dÃ¹ng ngÃ´n ngá»¯ truy váº¥n cáº¥u trÃºc (SQL): nÃ³ dÃ¹ng kiá»ƒu truy váº¥n trÃªn index Ä‘á»ƒ táº¡o ra con trá», chÃ­nh con trá» nÃ y dÃ¹ng Ä‘á»ƒ láº·p xuyÃªn suá»‘t táº­p káº¿t quáº£. Náº¿u báº¡n khÃ´ng quen vá»›i há»‡ thá»‘ng NoSQL thÃ¬ cÃ³ thá»ƒ xem thÃªm bÃ i nÃ y trÃªn Wikipedia IndexedDB dÃ¹ng nguyÃªn táº¯c cÃ¹ng origin: má»™t origin lÃ  domain, giao thá»©c táº§ng á»©ng dá»¥ng vÃ  cá»•ng (port) cá»§a URL cá»§a vÄƒn báº£n lÃ  nÆ¡i mÃ  code Ä‘Æ°á»£c thá»±c thi. Má»—i origin cÃ³ 1 táº­p cÃ¡c CSDL riÃªng cá»§a nÃ³. Má»—i CSDL cÃ³ 1 cÃ¡i tÃªn Ä‘á»‹nh danh nÃ³ trong origin. Giá»›i háº¡n cá»§a IndexedDBIndexedDB Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ dÃ¹ng vá»›i háº§u háº¿t cÃ¡c tÃ¬nh huá»‘ng cáº§n lÆ°u trá»¯ á»Ÿ phÃ­a client. NÃ³ khÃ´ng Ä‘Æ°á»£c thiáº¿t káº¿ cho 1 vÃ i trÆ°á»ng há»£p dÆ°á»›i Ä‘Ã¢y: Sáº¯p xáº¿p toÃ n cáº§u (Internationalized sorting): khÃ´ng pháº£i táº¥t cáº£ ngÃ´n ngá»¯ Ä‘á»u sáº¯p xáº¿p array theo cÃ¹ng 1 cÃ¡ch, vÃ¬ tháº¿ mÃ  Internationalized sorting khÃ´ng Ä‘Æ°á»£c há»— trá»£. CSDL khÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u theo 1 thá»© tá»± toÃ n cáº§u cá»¥ thá»ƒ, báº¡n cÃ³ thá»ƒ tá»± tay sáº¯p xáº¿p dá»¯ liá»‡u Ä‘á»c tá»« CSDL ra. Äá»“ng bá»™ hÃ³a: API khÃ´ng Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thá»±c hiá»‡n Ä‘á»“ng bá»™ hÃ³a vá»›i CSDL á»Ÿ phÃ­a server. Báº¡n pháº£i viáº¿t code riÃªng Ä‘á»ƒ Ä‘á»“ng bá»™ CSDL IndexedDB á»Ÿ client vá»›i CSDL á»Ÿ server. TÃ¬m kiáº¿m toÃ n vÄƒn báº£n (Full text searching ): API khÃ´ng cung cáº¥p giáº£i phÃ¡p tÆ°Æ¡ng tá»± nhÆ° LIKE trong SQL. ThÃªm vÃ o Ä‘Ã³, hÃ£y cáº©n tháº­n trÃ¬nh duyá»‡t cÃ³ thá»ƒ xÃ³a CSDL trong nhá»¯ng trÆ°á»ng há»£p sau Ä‘Ã¢y: User yÃªu cáº§u xÃ³a: nhiá»u trÃ¬nh duyá»‡t cÃ³ cÃ i Ä‘áº·t cho phÃ©p user xÃ³a táº¥t cáº£ dá»¯ liá»‡u lÆ°u trá»¯ cho 1 website, bao gá»“m cáº£ cookies, bookmarks, máº­t kháº©u Ä‘Æ°á»£c lÆ°u vÃ  dá»¯ liá»‡u IndexedDB. TrÃ¬nh duyá»‡t Ä‘ang cháº¡y cháº¿ Ä‘á»™ riÃªng tÆ°: má»™t vÃ i trÃ¬nh duyá»‡t cÃ³ cháº¿ Ä‘á»™ riÃªng tÆ° nhÆ° private browsing (Firefox) hay incognito (Chrome). Táº¡i cuá»‘i session, trÃ¬nh duyá»‡t sáº½ xÃ³a toÃ n bá»™ CSDL. á»” cá»©ng hoáº·c giá»›i háº¡n cho phÃ©p bá»‹ Ä‘áº§y Dá»¯ liá»‡u bá»‹ há»ng CÃ¡c trÆ°á»ng há»£p chÃ­nh xÃ¡c vÃ  kháº£ nÄƒng cá»§a trÃ¬nh duyá»‡t thay Ä‘á»•i theo thá»i gian, nhÆ°ng nguyÃªn lÃ½ chung cá»§a cÃ¡c nhÃ  phÃ¡t triá»ƒn trÃ¬nh duyá»‡t lÃ  táº¡o ra ná»— lá»±c tá»‘t nháº¥t Ä‘á»ƒ lÆ°u giá»¯ dá»¯ liá»‡u khi cÃ³ thá»ƒ. Lá»±a chá»n API lÆ°u trá»¯NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn, sáº½ tá»‘t hÆ¡n náº¿u chá»n cÃ¡c API Ä‘Æ°á»£c há»— trá»£ rá»™ng rÃ£i trong nhiá»u trÃ¬nh duyá»‡t vÃ  cung cáº¥p mÃ´ hÃ¬nh gá»i báº¥t Ä‘á»“ng bá»™ nháº±m nÃ¢ng tá»‘i Ä‘a kháº£ nÄƒng pháº£n há»“i cá»§a UI. NhÆ° 1 cÃ¡ch tá»± nhiÃªn, ngá»¯ cáº£nh nhÆ° tháº¿ nÃ y sáº½ dáº«n Ä‘áº¿n cÃ¡c lá»±a chá»n cÃ´ng nghá»‡: Vá»›i lÆ°u trá»¯ offline, dÃ¹ng Cache API. API nÃ y tá»“n táº¡i trong cÃ¡c trÃ¬nh duyá»‡t há»— trá»£ cÃ´ng nghá»‡ Service Worker, cáº§n thiáº¿t Ä‘á»ƒ xÃ¢y dá»±ng app offline. Äá»ƒ lÆ°u trá»¯ tráº¡ng thÃ¡i cá»§a á»©ng dá»¥ng vÃ  cÃ¡c dá»¯ liá»‡u do ngÆ°á»i dÃ¹ng táº¡o ra, sá»­ dá»¥ng IndexedDB. NÃ³ cho phÃ©p user lÃ m viá»‡c offline trÃªn nhiá»u trÃ¬nh duyá»‡t hÆ¡n so vá»›i nhá»¯ng trÃ¬nh duyá»‡t chá»‰ há»— trá»£ Cache API. SessionStack sá»­ dá»¥ng cÃ¡c API lÆ°u trá»¯ khÃ¡c nhau. VÃ­ dá»¥, thÆ° viá»‡n tÃ­ch há»£p vÃ o trong webapp cá»§a khÃ¡ch hÃ ng dÃ¹ng cáº£ cookies &amp; session storage. LÃ½ do lÃ  thÆ° viá»‡n Ä‘Ã³ cáº§n thu tháº­p cÃ¡c dá»¯ liá»‡u cháº³ng háº¡n nhÆ° cÃ¡c sá»± kiá»‡n, thay Ä‘á»•i trÃªn DOM, dá»¯ liá»‡u máº¡ng, biá»‡t lá»‡, thÃ´ng tin debug, vÃ¢n vÃ¢n, rá»“i sau Ä‘Ã³ gá»­i vá» server. Há» thu tháº­p dá»¯ liá»‡u nhÆ° váº­y tá»« session cá»§a ngÆ°á»i dÃ¹ng nhÆ°ng há» cáº§n 1 cÃ¡ch chÃ­nh xÃ¡c Ä‘á»ƒ xÃ¡c Ä‘á»‹nh khi nÃ o session cá»§a user báº¯t Ä‘áº§u vÃ  káº¿t thÃºc. Há» cÃ¢n nháº¯c 1 session sáº½ lÃ  toÃ n bá»™ chu ká»³ sá»­ dá»¥ng webapp tá»« lÃºc báº¯t Ä‘áº§u, bao gá»“m cáº£ xem trang vÃ  Ä‘iá»u hÆ°á»›ng cho Ä‘áº¿n khi user Ä‘Ã³ng trÃ¬nh duyá»‡t hay tab vÃ  khÃ´ng quay trá»Ÿ láº¡i trong vÃ i phÃºt, pháº§n nÃ y há» dÃ¹ng 1 sá»± káº¿t há»£p cá»§a session storage &amp; logic á»Ÿ phÃ­a server. CÃ²n gÃ¬ ná»¯a nÃ o, há» cho phÃ©p báº¡n xÃ¡c Ä‘á»‹nh tá»«ng ngÆ°á»i dÃ¹ng cuá»‘i Ä‘á»ƒ cÃ³ thá»ƒ cung cáº¥p cho báº¡n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng trÃªn má»—i session. Há» dá»±a vÃ o cookies Ä‘á»ƒ lÃ m viá»‡c nÃ y (giá»‘ng nhÆ° cÃ¡c cÃ´ng cá»¥ giÃ¡m sÃ¡t/phÃ¢n tÃ­ch). Trong á»©ng dá»¥ng cá»§a há», báº¡n cÃ³ thá»ƒ xem (xem theo yÃªu cáº§u hoáº·c thá»i gian thá»±c) nhá»¯ng sá»± kiá»‡n Ä‘Ã£ thu táº­p dÆ°á»›i dáº¡ng video Ä‘Æ°á»£c tÃ¡i táº¡o láº¡i cÃ¡ch mÃ  user gáº·p pháº£i cÃ¡c váº¥n Ä‘á»u, há» sá»­ dá»¥ng chá»§ yáº¿u lÃ  cookies bá»Ÿi vÃ¬ serivce RESTful cá»§a há» vá» cÆ¡ báº£n thÃ¬ cáº§n authentication token Ä‘á»ƒ authenticate, authorize vÃ  xÃ¡c nháº­n request.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P15: BÃªn trong Class & Inheritance + Transpiling vá»›i Babel & Typescript","slug":"Cach-Javascript-hoat-dong-P15-Ben-trong-Class-Inheritance-Transpiling-voi-Babel-Typescript","date":"2018-11-25T09:37:00.000Z","updated":"2018-11-25T09:40:14.437Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P15-Ben-trong-Class-Inheritance-Transpiling-voi-Babel-Typescript.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P15-Ben-trong-Class-Inheritance-Transpiling-voi-Babel-Typescript.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 15 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. NgÃ y nay, cÃ¡ch phá»• biáº¿n nháº¥t Ä‘á»ƒ dá»±ng cáº¥u trÃºc cá»§a báº¥t ká»³ dá»± Ã¡n pháº§n má»m nÃ o lÃ  sá»­ dá»¥ng class. Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ cÃ¹ng khÃ¡m phÃ¡ cÃ¡c cÃ¡ch khÃ¡c nhau Ä‘á»ƒ triá»ƒn khai class trong Javascript vÃ  lÃ m tháº¿ nÃ o ta cÃ³ thá»ƒ xÃ¢y dá»±ng cÃ¢y thá»© báº­c cá»§a class (class hierarchy). ChÃºng ta sáº½ báº¯t Ä‘áº§u báº±ng cÃ¡ch Ä‘Ã o sÃ¢u tÃ¬m hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a prototype vÃ  phÃ¢n tÃ­ch nhá»¯ng cÃ¡ch Ä‘á»ƒ giáº£ láº­p káº¿ thá»«a class trong cÃ¡c thÆ° viá»‡n ná»•i tiáº¿ng. Tiáº¿p Ä‘áº¿n ta sáº½ xem lÃ m cÃ¡ch nÃ o mÃ  transpiling cÃ³ thá»ƒ thÃªm nhá»¯ng tÃ­nh nÄƒng khÃ´ng Ä‘Æ°á»£c há»— trá»£ chÃ­nh thá»©c cho ngÃ´n ngá»¯ vÃ  cÃ¡ch mÃ  nÃ³ Ä‘Æ°á»£c dÃ¹ng trong Babel &amp; Typescript Ä‘á»ƒ giá»›i thiá»‡u vá» sá»± há»— trá»£ cá»§a class trong ECMAScript 2015. Cuá»‘i cÃ¹ng, ta sáº½ káº¿t thÃºc vá»›i má»™t vÃ i vÃ­ dá»¥ vá» class Ä‘Æ°á»£c triá»ƒn khai native trong V8.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 15 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. NgÃ y nay, cÃ¡ch phá»• biáº¿n nháº¥t Ä‘á»ƒ dá»±ng cáº¥u trÃºc cá»§a báº¥t ká»³ dá»± Ã¡n pháº§n má»m nÃ o lÃ  sá»­ dá»¥ng class. Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ cÃ¹ng khÃ¡m phÃ¡ cÃ¡c cÃ¡ch khÃ¡c nhau Ä‘á»ƒ triá»ƒn khai class trong Javascript vÃ  lÃ m tháº¿ nÃ o ta cÃ³ thá»ƒ xÃ¢y dá»±ng cÃ¢y thá»© báº­c cá»§a class (class hierarchy). ChÃºng ta sáº½ báº¯t Ä‘áº§u báº±ng cÃ¡ch Ä‘Ã o sÃ¢u tÃ¬m hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a prototype vÃ  phÃ¢n tÃ­ch nhá»¯ng cÃ¡ch Ä‘á»ƒ giáº£ láº­p káº¿ thá»«a class trong cÃ¡c thÆ° viá»‡n ná»•i tiáº¿ng. Tiáº¿p Ä‘áº¿n ta sáº½ xem lÃ m cÃ¡ch nÃ o mÃ  transpiling cÃ³ thá»ƒ thÃªm nhá»¯ng tÃ­nh nÄƒng khÃ´ng Ä‘Æ°á»£c há»— trá»£ chÃ­nh thá»©c cho ngÃ´n ngá»¯ vÃ  cÃ¡ch mÃ  nÃ³ Ä‘Æ°á»£c dÃ¹ng trong Babel &amp; Typescript Ä‘á»ƒ giá»›i thiá»‡u vá» sá»± há»— trá»£ cá»§a class trong ECMAScript 2015. Cuá»‘i cÃ¹ng, ta sáº½ káº¿t thÃºc vá»›i má»™t vÃ i vÃ­ dá»¥ vá» class Ä‘Æ°á»£c triá»ƒn khai native trong V8. KhÃ¡i quÃ¡tTrong Javascript, vá» báº£n cháº¥t khÃ´ng cÃ³ kiá»ƒu dá»¯ liá»‡u nguyÃªn thá»§y vÃ  má»i thá»© táº¡o ra Ä‘á»u lÃ  object. VÃ­ dá»¥, náº¿u ta táº¡o 1 string: 1const name = \"SessionStack\"; ThÃ¬ chÃºng ta cÃ³ thá»ƒ gá»i nhiá»u phÆ°Æ¡ng thá»©c khÃ¡c nhau trÃªn object vá»«a má»›i Ä‘Æ°á»£c táº¡o ra: 12console.log(a.repeat(2)); // SessionStackSessionStackconsole.log(a.toLowerCase()); // sessionstack KhÃ´ng giá»‘ng nhÆ° cÃ¡c ngÃ´n ngá»¯ khÃ¡c, trong Javascript, khai bÃ¡o string hay number sáº½ tá»± Ä‘á»™ng táº¡o ra má»™t object mÃ  nÃ³ sáº½ Ä‘Ã³ng gÃ³i giÃ¡ trá»‹ Ä‘Ã³ vÃ  cung cáº¥p nhiá»u phÆ°Æ¡ng thá»©c khÃ¡c nhau cÃ³ thá»ƒ thá»±c thi Ä‘Æ°á»£c ká»ƒ cáº£ vá»›i cÃ¡c kiá»ƒu dá»¯ liá»‡u nguyÃªn thá»§y. Má»™t sá»± tháº­t thÃº vá»‹ khÃ¡c lÃ  nhá»¯ng kiá»ƒu dá»¯ liá»‡u phá»©c táº¡p, cháº³ng háº¡n nhÆ° array, cÅ©ng lÃ  object. Náº¿u báº¡n nhÃ¬n ká»¹ hÆ¡n vÃ o typeof cá»§a má»™t array, báº¡n sáº½ tháº¥y nÃ³ lÃ  object. Sá»‘ index cá»§a má»—i pháº§n tá»­ trong danh sÃ¡ch chÃ­nh lÃ  thuá»™c tÃ­nh cá»§a object. VÃ¬ tháº¿ khi báº¡n truy xuáº¥t má»™t pháº§n tá»­ báº±ng sá»‘ index trong array, báº¡n thá»±c ra chá»‰ truy xuáº¥t vÃ o thuá»™c tÃ­nh cá»§a object array vÃ  tráº£ vá» giÃ¡ trá»‹ cá»§a nÃ³. Khi nÃ³i vá» váº¥n Ä‘á» lÆ°u trá»¯ dá»¯ liá»‡u thÃ¬ 2 Ä‘á»‹nh nghÄ©a sau lÃ  giá»‘ng há»‡t nhau: 123456let names = [â€œSessionStackâ€];let names = &#123; â€œ0â€: â€œSessionStackâ€, â€œlengthâ€: 1&#125; Káº¿t quáº£ lÃ  thá»i gian cáº§n Ä‘á»ƒ truy xuáº¥t 1 pháº§n tá»­ trong array vÃ  1 thuá»™c tÃ­nh cá»§a object lÃ  nhÆ° nhau. Tháº­t khÃ³ Ä‘á»ƒ nháº­n ra. TrÆ°á»›c Ä‘Ã¢y, trong 1 project, tÃ¡c giáº£ pháº£i thá»±c hiá»‡n quÃ¡ trÃ¬nh tá»‘i Æ°u hÃ³a ráº¥t lá»›n cho má»™t Ä‘oáº¡n code quan trá»ng. Sau khi thá»­ táº¥t cáº£ cÃ¡c lá»±a chá»n dá»…, tÃ¡c giáº£ Ä‘Ã£ thay tháº¿ toÃ n bá»™ object Ä‘Æ°á»£c dÃ¹ng trong project báº±ng array. Vá» lÃ½ thuyáº¿t, truy xuáº¥t 1 pháº§n tá»­ trong 1 array thÃ¬ nhanh hÆ¡n truy xuáº¥t 1 key trong hash map (báº£n Ä‘á»“ bÄƒm). TÃ¡c giáº£ Ä‘Ã£ ngáº¡c nhiÃªn ráº±ng cÃ¡ch lÃ m nÃ y khÃ´ng mang láº¡i má»™t chÃºt hiá»‡u quáº£ hÆ¡n vá»›i hiá»‡u nÄƒng. Trong Javascript, cáº£ array vÃ  object Ä‘á»u Ä‘Æ°á»£c triá»ƒn khai vá» viá»‡c truy xuáº¥t 1 key trong hash map vÃ  sáº½ tá»‘n cÃ¹ng 1 lÆ°á»£ng thá»i gian nhÆ° nhau. Giáº£ láº­p class vá»›i prototypeKhi nghÄ© vá» object, thá»© Ä‘áº§u tiÃªn xuáº¥t hiá»‡n chÃ­nh lÃ  class. Táº¥t cáº£ chÃºng ta thÃ´ng thÆ°á»ng Ä‘á»u xÃ¢y dá»±ng cáº¥u trÃºc cá»§a á»©ng dá»¥ng dá»±a trÃªn class vÃ  cÃ¡c má»‘i quan há»‡ giá»¯a chÃºng vá»›i nhau. Máº·c dÃ¹ object trong Javascript xuáº¥t hiá»‡n kháº¯p nÆ¡i, ngÃ´n ngá»¯ nÃ y láº¡i khÃ´ng sá»­ dá»¥ng kiá»ƒu káº¿ thá»«a truyá»n thá»‘ng dá»±a trÃªn class. Thay vÃ o Ä‘Ã³ nÃ³ dÃ¹ng prototype.[ Trong Javascript, má»i object Ä‘Æ°á»£c káº¿t ná»‘i Ä‘áº¿n object khÃ¡c - chÃ­nh lÃ  prototype cá»§a nÃ³. Khi báº¡n thá»­ truy xuáº¥t 1 thuá»™c tÃ­nh hoáº·c phÆ°Æ¡ng thá»©c trÃªn 1 object, quÃ¡ trÃ¬nh tÃ¬m kiáº¿m (thuá»™c tÃ­nh/phÆ°Æ¡ng thá»©c) sáº½ báº¯t Ä‘áº§u vá»›i chÃ­nh object Ä‘Ã³ trÆ°á»›c. Náº¿u khÃ´ng tÃ¬m tháº¥y thÃ¬ nÃ³ sáº½ tiáº¿p tá»¥c vá»›i prototype cá»§a object Ä‘Ã³. ChÃºng ta sáº½ thá»­ vá»›i 1 vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» Ä‘á»‹nh nghÄ©a constructor cho 1 class: 1234567function Component(content) &#123; this.content = content;&#125;Component.prototype.render = function() &#123; console.log(this.content);&#125; Ta thÃªm hÃ m render vÃ o prototype bá»Ÿi vÃ¬ chÃºng ta muá»‘n má»—i instance cá»§a Component Ä‘á»u cÃ³ thá»ƒ tÃ¬m tháº¥y nÃ³. Khi báº¡n gá»i phÆ°Æ¡ng thá»©c nÃ y trÃªn má»—i instance cá»§a class Component, quÃ¡ trÃ¬nh tÃ¬m kiáº¿m Ä‘áº§u tiÃªn sáº½ thá»±c hiá»‡n trÃªn chÃ­nh instance Ä‘Ã³. Sau Ä‘Ã³ nÃ³ tiáº¿p tá»¥c thá»±c hiá»‡n tÃ¬m trÃªn prototype vÃ  táº¡i Ä‘Ã¢y thÃ¬ phÆ°Æ¡ng thá»©c render Ä‘Æ°á»£c tÃ¬m tháº¥y. Giá» ta thá»­ má»Ÿ rá»™ng class Component ra, ta sáº½ thÃªm vÃ o má»™t class con: 123function InputField(value) &#123; this.content = `&lt;input type=\"text\" value=\"$&#123;value&#125;\" /&gt;`;&#125; Náº¿u ta muá»‘n InputField má»Ÿ rá»™ng chá»©c nÄƒng cá»§a class Component vÃ  cÃ³ thá»ƒ gá»i phÆ°Æ¡ng thá»©c render cá»§a nÃ³ thÃ¬ ta cáº§n pháº£i thay Ä‘á»•i prototype. Khi 1 phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c gá»i trÃªn instance cá»§a class con, ta khÃ´ng muá»‘n tÃ¬m kiáº¿m trong prototype trá»‘ng rá»—ng cá»§a nÃ³. QuÃ¡ trÃ¬nh tÃ¬m kiáº¿m sáº½ tiáº¿p tá»¥c á»Ÿ class Component. 1InputField.prototype = Object.create(new Component()); Báº±ng cÃ¡ch nÃ y, phÆ°Æ¡ng thá»©c render cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong prototype cá»§a class Component. Äá»ƒ cÃ³ thá»ƒ káº¿ thá»«a, ta cáº§n káº¿t ná»‘i prototype cá»§a InputField Ä‘áº¿n 1 instance cá»§a class Component. Nhiá»u thÆ° viá»‡n sá»­ dá»¥ng phÆ°Æ¡ng thá»©c Object.setPrototypeOf Ä‘á»ƒ lÃ m viá»‡c nÃ y. Tuy nhiÃªn Ä‘Ã¢y khÃ´ng pháº£i lÃ  viá»‡c duy nháº¥t mÃ  ta cáº§n lÃ m. Má»—i khi má»Ÿ rá»™ng 1 class, ta cáº§n chÃº Ã½: Äáº·t prototype cá»§a class con lÃ  1 instance cá»§a class cha Gá»i constructor cá»§a class cha trong constructor cá»§a class con Ä‘á»ƒ quÃ¡ trÃ¬nh khá»Ÿi táº¡o logic trong constructor cá»§a class cha cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c thi. Giá»›i thiá»‡u cÃ¡ch truy xuáº¥t phÆ°Æ¡ng thá»©c tá»« class cha. Báº¡n cáº§n pháº£i lÃ m tháº¿ khi muá»‘n ghi Ä‘Ã¨ 1 phÆ°Æ¡ng thá»©c vÃ  báº¡n muá»‘n gá»i Ä‘áº¿n pháº§n triá»ƒn khai gá»‘c trong phÆ°Æ¡ng thá»©c á»Ÿ class cha. NhÆ° báº¡n tháº¥y thÃ¬ náº¿u muá»‘n sá»­ dá»¥ng táº¥t cáº£ tÃ­nh nÄƒng cá»§a káº¿ thá»«a dá»±a trÃªn class thÃ¬ báº¡n cáº§n thá»±c thi pháº§n logic phá»©c táº¡p nÃ y má»—i láº§n káº¿ thá»«a. Má»—i khi báº¡n cáº§n táº¡o ra nhiá»u class thÃ¬ tá»‘t nháº¥t lÃ  Ä‘Ã³ng gÃ³i má»› logic áº¥y trong 1 (hoáº·c vÃ i) hÃ m Ä‘á»ƒ cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng. ÄÃ¢y lÃ  cÃ¡ch mÃ  cÃ¡c developer trÆ°á»›c Ä‘Ã¢y giáº£i quyáº¿t váº¥n Ä‘á» káº¿ thá»«a dá»±a trÃªn class - báº±ng cÃ¡ch giáº£ láº­p vá»›i nhiá»u thÆ° viá»‡n khÃ¡c nhau. Nhá»¯ng giáº£i phÃ¡p nÃ y trá»Ÿ nÃªn ráº¥t phá»• biáº¿n vÃ  rÃµ rÃ ng lÃ  cÃ³ thiáº¿u sÃ³t trong ngÃ´n ngá»¯ Javascript. ÄÃ³ lÃ  lÃ½ do mÃ  cÃº phÃ¡p má»›i Ä‘á»ƒ táº¡o class vÃ  há»— trá»£ káº¿ thá»«a class Ä‘Æ°á»£c giá»›i thiá»‡u trong báº£n sá»­a Ä‘á»•i lá»›n Ä‘áº§u tiÃªn cá»§a ECMAScript 2015. Transpiling classKhi tÃ­nh nÄƒng má»›i cá»§a ES6 (hay ECMAScript 2015) Ä‘Æ°á»£c Ä‘á» xuáº¥t, cá»™ng Ä‘á»“ng Javascript developer khÃ´ng ngá»“i yÃªn chá» Ä‘á»£i táº¥t cáº£ cÃ¡c engine vÃ  trÃ¬nh duyá»‡t báº¯t Ä‘áº§u há»— trá»£ nÃ³. Má»™t cÃ¡ch tá»‘t hÆ¡n Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c lÃ  thÃ´ng qua transpile. NÃ³ cho phÃ©p 1 Ä‘oáº¡n code viáº¿t trong ECMAScript 2015 Ä‘Æ°á»£c biáº¿n Ä‘á»•i thÃ nh Javascript mÃ  táº¥t cáº£ trÃ¬nh duyá»‡t Ä‘á»u cÃ³ thá»ƒ hiá»ƒu. Bao gá»“m cáº£ kháº£ nÄƒng viáº¿t class vá»›i káº¿ thá»«a dá»±a trÃªn class vÃ  transpile chÃºng thÃ nh code hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c. Má»™t trong sá»‘ nhá»¯ng transpiler ná»•i tiáº¿ng nháº¥t cho Javascript lÃ  Babel. Giá» thÃ¬ cÃ¹ng xem transpile hoáº¡t Ä‘á»™ng tháº¿ nÃ o, ta sáº½ Ã¡p dá»¥ng nÃ³ cho Ä‘oáº¡n code vá» Component viáº¿t á»Ÿ trÃªn nhÃ©: 123456789101112class Component &#123; constructor(content) &#123; this.content = content; &#125; render() &#123; console.log(this.content) &#125;&#125;const component = new Component('SessionStack');component.render(); VÃ  Ä‘Ã¢y lÃ  nhá»¯ng gÃ¬ Babel transpile ra: 12345678910111213141516var Component = function () &#123; function Component(content) &#123; _classCallCheck(this, Component); this.content = content; &#125; _createClass(Component, [&#123; key: 'render', value: function render() &#123; console.log(this.content); &#125; &#125;]); return Component;&#125;(); NhÆ° báº¡n tháº¥y, code Ä‘Æ°á»£c biáº¿n Ä‘á»•i thÃ nh ECMAScript 5, loáº¡i cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c thi trÃªn báº¥t ká»³ mÃ´i trÆ°á»ng nÃ o. NgoÃ i ra cÃ²n cÃ³ 1 sá»‘ hÃ m Ä‘Æ°á»£c thÃªm vÃ o. ChÃºng lÃ  1 pháº§n cá»§a thÆ° viá»‡n Babel tiÃªu chuáº©n. HÃ m _classCallCheck vÃ  _createClass cÃ³ máº·t nhÆ° 1 pháº§n trong káº¿t quáº£ biÃªn dá»‹ch. HÃ m Ä‘áº§u tiÃªn Ä‘áº£m báº£o hÃ m constructor khÃ´ng bao giá» Ä‘Æ°á»£c gá»i nhÆ° 1 hÃ m bÃ¬nh thÆ°á»ng. Äiá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng viá»‡c kiá»ƒm tra cÃ³ hay khÃ´ng ngá»¯ cáº£nh mÃ  trong Ä‘Ã³ hÃ m Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ lÃ  1 instance cá»§a object Component. Code sáº½ kiá»ƒm tra náº¿unÃ³ trá» Ä‘áº¿n instance. HÃ m thá»© 2 _createClass xá»­ lÃ½ viá»‡c táº¡o ra cÃ¡c thuá»™c tÃ­nh cho object vÃ  Ä‘Æ°á»£c truyá»n vÃ o dÆ°á»›i dáº¡ng danh sÃ¡ch cÃ¡c object vá»›i key &amp; value. Äá»ƒ khÃ¡m phÃ¡ vá» cÃ¡ch káº¿ thá»«a hoáº¡t Ä‘á»™ng ra sao thÃ¬ ta cÃ¹ng phÃ¢n tÃ­ch class InputField Ä‘Æ°á»£c káº¿ thá»«a tá»« Component 123456class InputField extends Component &#123; constructor(value) &#123; const content = `&lt;input type=\"text\" value=\"$&#123;value&#125;\" /&gt;`; super(content); &#125;&#125; Káº¿t quáº£ sau khi xá»­ lÃ½ transpile vá»›i Babel: 123456789101112var InputField = function (_Component) &#123; _inherits(InputField, _Component); function InputField(value) &#123; _classCallCheck(this, InputField); var content = '&lt;input type=\"text\" value=\"' + value + '\" /&gt;'; return _possibleConstructorReturn(this, (InputField.__proto__ || Object.getPrototypeOf(InputField)).call(this, content)); &#125; return InputField;&#125;(Component); Trong vÃ­ dá»¥ trÃªn, logic káº¿ thá»«a Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i trong hÃ m _inherits. NÃ³ thá»±c hiá»‡n cÃ¹ng y chang hÃ nh Ä‘á»™ng mÃ  chÃºng ta Ä‘Ã£ mÃ´ táº£ trong pháº§n trÆ°á»›c báº±ng cÃ¡ch cÃ i Ä‘áº·t prototype cá»§a class con trá»Ÿ thÃ nh 1 instance cá»§a class cha. Äá»ƒ transpile code, Babel thá»±c hiá»‡n nhiá»u quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i. Äáº§u tiÃªn code ECMAScript 2015 Ä‘Æ°á»£c parse vÃ  biáº¿n Ä‘á»•i thÃ nh má»™t dáº¡ng thá»ƒ hiá»‡n trung gian, gá»i lÃ  Abstract Syntax Tree, chÃ­nh lÃ  chá»§ Ä‘á» ta Ä‘Ã£ tháº£o luáº­n á»Ÿ bÃ i trÆ°á»›c. Sau Ä‘Ã³ cÃ¢y nÃ y Ä‘Æ°á»£c biáº¿n Ä‘á»•i láº§n ná»¯a thÃ nh 1 cÃ¢y AST khÃ¡c mÃ  má»—i node cá»§a nÃ³ Ä‘Æ°á»£c biáº¿n Ä‘á»•i thÃ nh pháº§n tÆ°Æ¡ng á»©ng trong ECMAScript 5. Cuá»‘i cÃ¹ng cÃ¢y AST Ä‘Æ°á»£c chuyá»ƒn ngÆ°á»£c láº¡i thÃ nh code. AST trong BabelMá»™t cÃ¢y AST sáº½ cÃ³ nhiá»u node, má»—i node chá»‰ cÃ³ duy nháº¥t 1 node cha. Trong Babel, tá»“n táº¡i 1 kiá»ƒu cÆ¡ báº£n cho cÃ¡c node. NÃ³ chÆ°a thÃ´ng tin vá» loáº¡i node vÃ  vá»‹ trÃ­ cá»§a chÃºng trong code. CÃ³ nhiá»u loáº¡i node khÃ¡c nhau, cháº³ng háº¡n nhÆ° Literals thá»ƒ hiá»‡n string, number, null, vÃ¢n vÃ¢n. CÅ©ng cÃ³ cáº£ node Statements dÃ nh cho cÃ¡c luá»“ng kiá»ƒm soÃ¡t (if) vÃ  vÃ²ng láº·p (for, while). CÃ³ cáº£ node Ä‘áº·c biá»‡t dÃ nh cho class. NÃ³ lÃ  1 con (child) cá»§a class Node cÆ¡ báº£n. NÃ³ má»Ÿ rá»™ng báº±ng cÃ¡ch thÃªm cÃ¡c trÆ°á»ng Ä‘á»ƒ lÆ°u tham chiáº¿u Ä‘áº¿n class cÆ¡ báº£n vÃ  body cá»§a class nhÆ° lÃ  1 node riÃªng biá»‡t. Giá» ta sáº½ biáº¿n Ä‘á»•i Ä‘oáº¡n code sau thÃ nh cÃ¢y AST 123456789class Component &#123; constructor(content) &#123; this.content = content; &#125; render() &#123; console.log(this.content) &#125;&#125; ÄÃ¢y lÃ  káº¿t quáº£: Sau khi táº¡o ra cÃ¢y AST, má»—i node Ä‘Æ°á»£c biáº¿n Ä‘á»•i thÃ nh node ECMAScript 5 tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i nÃ³ vÃ  chuyá»ƒn ngÆ°á»£c láº¡i thÃ nh code thÆ°á»ng theo tiÃªu chuáº©n cá»§a ECMAScript 5. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng 1 tiáº¿n trÃ¬nh tÃ¬m kiáº¿m node náº±m á»Ÿ vá»‹ trÃ­ xa nháº¥t vá»›i root node vÃ  biáº¿n Ä‘á»•i chÃºng thÃ nh code. Sau Ä‘Ã³ node cha cá»§a nÃ³ sáº½ Ä‘Æ°á»£c biáº¿n Ä‘á»•i báº±ng Ä‘oáº¡n code Ä‘Ã£ sinh ra cho cÃ¡c node con cá»§a nÃ³. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  depth-first traversal Trong vÃ­ dá»¥ trÃªn, Ä‘áº§u tiÃªn code cá»§a 2 node MethodDefinition sáº½ Ä‘Æ°á»£c sinh ra, theo sau nÃ³ lÃ  code cá»§a node ClassBody vÃ  cuá»‘i cÃ¹ng lÃ  node ClassDeclaration Transpile vá»›i TypeScriptMá»™t framework phá»• biáº¿n khÃ¡c há»— trá»£ kháº£ nÄƒng transpile chÃ­nh lÃ  TypeScript. NÃ³ giá»›i thiá»‡u cÃº phÃ¡p kiá»ƒu má»›i Ä‘á»ƒ viáº¿t á»©ng dá»¥ng Javascript vÃ  Ä‘Æ°á»£c biáº¿n Ä‘á»•i thÃ nh ECMAScript 5 mÃ  cÃ³ thá»ƒ cháº¡y trÃªn báº¥t ká»³ trÃ¬nh duyá»‡t hay engine nÃ o. DÆ°á»›i Ä‘Ã¢y lÃ  pháº§n triá»ƒn khai cá»§a class Component trong TypeScript: 123456789class Component &#123; content: string; constructor(content: string) &#123; this.content = content; &#125; render() &#123; console.log(this.content) &#125;&#125; VÃ  Ä‘Ã¢y lÃ  cÃ¢y AST Ä‘Æ°á»£c sinh ra: NÃ³ há»— trá»£ káº¿ thá»«a: 123456class InputField extends Component &#123; constructor(value: string) &#123; const content = `&lt;input type=\"text\" value=\"$&#123;value&#125;\" /&gt;`; super(content); &#125;&#125; Káº¿t quáº£ transpile ra: 12345678910var InputField = /** @class */ (function (_super) &#123; __extends(InputField, _super); function InputField(value) &#123; var _this = this; var content = \"&lt;input type=\\\"text\\\" value=\\\"\" + value + \"\\\" /&gt;\"; _this = _super.call(this, content) || this; return _this; &#125; return InputField;&#125;(Component)); Káº¿t quáº£ cuá»‘i cÃ¹ng má»™t láº§n ná»¯a láº¡i lÃ  ECMAScript 5 vá»›i 1 sá»‘ hÃ m thÃªm vÃ o tá»« thÆ° viá»‡n cá»§a TypeScript. Logic Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i trong __extends lÃ  giá»‘ng y há»‡t nhÆ° nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ tháº£o luáº­n á»Ÿ pháº§n trÆ°á»›c. Vá»›i Babel vÃ  TypeScript cÃ ng ngÃ y cÃ ng Ä‘Æ°á»£c Ä‘Ã³n nháº­n ná»“ng nhiá»‡t, class tiÃªu chuáº©n vÃ  káº¿ thá»«a dá»±a trÃªn class trá»Ÿ thÃ nh 1 cÃ¡ch chuáº©n cá»§a pháº§n cáº¥u trÃºc nhá»¯ng á»©ng dá»¥ng Javascript. Äiá»u nÃ y Ä‘áº©y nhanh tiáº¿n Ä‘á»™ vá» native support (há»— trá»£ tá»± nhiÃªn) cho class trÃªn trÃ¬nh duyá»‡t. Native support (há»— trá»£ tá»± nhiÃªn)VÃ o nÄƒm 2014, native support cho class Ä‘Æ°á»£c giá»›i thiá»‡u trong Chrome. NÃ³ cho phÃ©p cÃº phÃ¡p khai bÃ¡o class Ä‘Æ°á»£c thá»±c hiá»‡n mÃ  khÃ´ng cáº§n pháº£i dÃ¹ng Ä‘áº¿n cÃ¡c thÆ° viá»‡n hay transpiler. QuÃ¡ trÃ¬nh triá»ƒn khai class má»™t cÃ¡ch tá»± nhiÃªn Ä‘Æ°á»£c gá»i lÃ  syntax sugar (cÃº phÃ¡p ngá»t ngÃ o). ÄÃ¢y chá»‰ lÃ  1 cÃº phÃ¡p dá»… chá»‹u cÃ³ thá»ƒ biÃªn dá»‹ch xuá»‘ng thÃ nh cÃ¹ng loáº¡i vá»›i kiá»ƒu nguyÃªn thá»§y Ä‘ang Ä‘Æ°á»£c há»— trá»£ máº·c Ä‘á»‹nh trong ngÃ´n ngá»¯. Báº¡n cÃ³ thá»ƒ dÃ¹ng kiá»ƒu Ä‘á»‹nh nghÄ©a class má»›i, dá»… dÃ¹ng hÆ¡n, nhÆ°ng cuá»‘i cÃ¹ng nÃ³ cÅ©ng quay vá» táº¡o constructor vÃ  gÃ¡n prototypes Sá»± há»— trá»£ cá»§a V8CÃ¹ng xem cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a native support cho class trong ECMAScript 2015 trÃªn V8. NhÆ° ta Ä‘Ã£ tháº£o luáº­n á»Ÿ bÃ i trÆ°á»›c, Ä‘áº§u tiÃªn cÃº phÃ¡p má»›i cáº§n Ä‘Æ°á»£c parse thÃ nh code Javascript cÅ© vÃ  thÃªm vÃ o cÃ¢y AST. VÃ¬ tháº¿ káº¿t quáº£ cá»§a Ä‘á»‹nh nghÄ©a class lÃ  1 node má»›i (loáº¡i ClassLiteral) Ä‘Æ°á»£c thÃªm vÃ o cÃ¢y. Node nÃ y chá»©a 1 vÃ i thá»©. Äáº§u tiÃªn, nÃ³ giá»¯ constructor á»Ÿ 1 hÃ m khÃ¡c. NÃ³ cÅ©ng chá»©a 1 danh sÃ¡ch cÃ¡c thuá»™c tÃ­nh cá»§a class. ChÃºng cÃ³ thá»ƒ lÃ  phÆ°Æ¡ng thá»©c, getter, setter, cÃ¡c trÆ°á»ng public hay private. Node nÃ y cÅ©ng chá»©a luÃ´n tham chiáº¿u Ä‘áº¿n class cha mÃ  chÃ­nh class cha nÃ y láº¡i ná»¯a chá»©a constructor &amp; danh sÃ¡ch cÃ¡c thuá»™c tÃ­nh vÃ  class cha khÃ¡c (cá»§a nÃ³). Má»™t khi ClassLiteral nÃ y Ä‘Æ°á»£c chuyá»ƒn thÃ nh code, nÃ³ Ä‘Æ°á»£c dá»‹ch 1 láº§n ná»¯a thÃ nh cÃ¡c hÃ m vÃ  prototypes. Vá»›i team táº¡i SessionStack, tá»‘i Æ°u hÃ³a tá»«ng pháº§n nhá» cá»§a code lÃ  cá»±c ká»³ quan trá»ng nhá»¯ng cÅ©ng lÃ  1 cÃ´ng viá»‡c ráº¥t thÃ¡ch thá»©c. CÃ³ 2 lÃ½ do cho viá»‡c cáº§n thiáº¿t pháº£i tá»‘i Æ°u hÃ³a má»©c Ä‘á»™ cao. Äáº§u tiÃªn, thÆ° viá»‡n cá»§a há» sáº½ tÃ­ch há»£p vá»›i trong webapp, nÃ³ thu tháº­p dá»¯ liá»‡u tá»« phiÃªn lÃ m viá»‡c cá»§a user, cháº³ng háº¡n nhÆ° sá»± kiá»‡n, thay Ä‘á»•i trÃªn DOM, dá»¯ liá»‡u máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o lá»—i, vÃ¢n vÃ¢n. Thu tháº­p thÃ´ng tin mÃ  khÃ´ng lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u nÄƒng cá»§a webapp lÃ  1 thÃ¡ch thá»©c khÃ³ mÃ  team cá»§a tÃ¡c giáº£ Ä‘Ã£ giáº£i quyáº¿t thÃ nh cÃ´ng.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P14: Parsing, Abstract Syntax Tree & máº¹o giáº£m tá»‘i Ä‘a thá»i gian parse","slug":"Cach-Javascript-hoat-dong-P14-Parsing-Abstract-Syntax-Tree-meo-giam-toi-da-thoi-gian-parse","date":"2018-11-25T09:32:00.000Z","updated":"2018-11-25T09:35:26.778Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P14-Parsing-Abstract-Syntax-Tree-meo-giam-toi-da-thoi-gian-parse.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P14-Parsing-Abstract-Syntax-Tree-meo-giam-toi-da-thoi-gian-parse.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 14 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tChÃºng ta Ä‘á»u biáº¿t ráº±ng nhá»¯ng thá»© lá»™n xá»™n cÃ³ thá»ƒ há»£p thÃ nh 1 thá»© lá»›n hÆ¡n gá»i lÃ  Javascript. Má»™t Ä‘oáº¡n code khÃ´ng chá»‰ cÃ³ thá»ƒ di chuyá»ƒn qua máº¡ng mÃ  nÃ³ cÃ²n pháº£i Ä‘Æ°á»£c parse, biÃªn dá»‹ch sang bytecode vÃ  cuá»‘i cÃ¹ng thá»±c thi. Trong cÃ¡c bÃ i trÆ°á»›c, chÃºng ta Ä‘Ã£ tháº£o luáº­n vá» nhá»¯ng thá»© cháº³ng háº¡n nhÆ° JS engine, runtime, callstack cÅ©ng nhÆ° engine V8 Ä‘Æ°á»£c dÃ¹ng chá»§ yáº¿u trong Chrome vÃ  NodeJS. Táº¥t cáº£ Ä‘á»u Ä‘Ã³ng vai trÃ² quan trá»ng trong toÃ n bá»™ quÃ¡ trÃ¬nh thá»±c thi cá»§a Javascript. Chá»§ Ä‘á» mÃ  chÃºng ta sáº½ tÃ¬m hiá»ƒu hÃ´m nay cÅ©ng khÃ´ng kÃ©m quan trá»ng: chÃºng ta sáº½ nghiÃªn cá»©u xem lÃ m tháº¿ nÃ o mÃ  Ä‘a sá»‘ cÃ¡c engine JS parse vÄƒn báº£n thÃ nh má»™t thá»© gÃ¬ Ä‘Ã³ cÃ³ nghÄ©a Ä‘á»‘i vá»›i mÃ¡y mÃ³c, nhá»¯ng gÃ¬ xáº£y ra sau Ä‘Ã³ vÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ web developer nhÆ° chÃºng ta cÃ³ thá»ƒ táº­n dá»¥ng nhá»¯ng kiáº¿n thá»©c Ä‘Ã³ lÃ m Ä‘iá»ƒm máº¡nh.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 14 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tChÃºng ta Ä‘á»u biáº¿t ráº±ng nhá»¯ng thá»© lá»™n xá»™n cÃ³ thá»ƒ há»£p thÃ nh 1 thá»© lá»›n hÆ¡n gá»i lÃ  Javascript. Má»™t Ä‘oáº¡n code khÃ´ng chá»‰ cÃ³ thá»ƒ di chuyá»ƒn qua máº¡ng mÃ  nÃ³ cÃ²n pháº£i Ä‘Æ°á»£c parse, biÃªn dá»‹ch sang bytecode vÃ  cuá»‘i cÃ¹ng thá»±c thi. Trong cÃ¡c bÃ i trÆ°á»›c, chÃºng ta Ä‘Ã£ tháº£o luáº­n vá» nhá»¯ng thá»© cháº³ng háº¡n nhÆ° JS engine, runtime, callstack cÅ©ng nhÆ° engine V8 Ä‘Æ°á»£c dÃ¹ng chá»§ yáº¿u trong Chrome vÃ  NodeJS. Táº¥t cáº£ Ä‘á»u Ä‘Ã³ng vai trÃ² quan trá»ng trong toÃ n bá»™ quÃ¡ trÃ¬nh thá»±c thi cá»§a Javascript. Chá»§ Ä‘á» mÃ  chÃºng ta sáº½ tÃ¬m hiá»ƒu hÃ´m nay cÅ©ng khÃ´ng kÃ©m quan trá»ng: chÃºng ta sáº½ nghiÃªn cá»©u xem lÃ m tháº¿ nÃ o mÃ  Ä‘a sá»‘ cÃ¡c engine JS parse vÄƒn báº£n thÃ nh má»™t thá»© gÃ¬ Ä‘Ã³ cÃ³ nghÄ©a Ä‘á»‘i vá»›i mÃ¡y mÃ³c, nhá»¯ng gÃ¬ xáº£y ra sau Ä‘Ã³ vÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ web developer nhÆ° chÃºng ta cÃ³ thá»ƒ táº­n dá»¥ng nhá»¯ng kiáº¿n thá»©c Ä‘Ã³ lÃ m Ä‘iá»ƒm máº¡nh. NgÃ´n ngá»¯ láº­p trÃ¬nh hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?CÃ¹ng lÃ¹i láº¡i 1 chÃºt vÃ  xem xem ngÃ´n ngá»¯ láº­p trÃ¬nh hoáº¡t Ä‘á»™ng tháº¿ nÃ o. KhÃ´ng cáº§n biáº¿t lÃ  báº¡n Ä‘ang xÃ i ngÃ´n ngá»¯ gÃ¬, báº¡n sáº½ luÃ´n cáº§n má»™t pháº§n má»m cÃ³ thá»ƒ Ä‘á»c mÃ£ nguá»“n vÃ  khiáº¿n cho mÃ¡y tÃ­nh thá»±c hiá»‡n má»™t Ä‘iá»u gÃ¬ Ä‘Ã³. Pháº§n má»m nÃ y cÃ³ thá»ƒ lÃ  trÃ¬nh thÃ´ng dá»‹ch hoáº·c trÃ¬nh biÃªn dá»‹ch. KhÃ´ng cáº§n biáº¿t báº¡n Ä‘ang xÃ i ngÃ´n ngá»¯ thÃ´ng dá»‹ch (Javascript, Python, Ruby) hay ngÃ´n ngá»¯ biÃªn dá»‹ch (C#, Java, Rust), luÃ´n luÃ´n cÃ³ 1 Ä‘iá»ƒm chung giá»¯a chÃºng: parse Ä‘oáº¡n mÃ£ nguá»“n tá»« vÄƒn báº£n gá»‘c thÃ nh má»™t cáº¥u trÃºc dá»¯ liá»‡u Ä‘Æ°á»£c gá»i lÃ  Abstract Syntax Tree (AST). CÃ¡c AST khÃ´ng chá»‰ thá»ƒ hiá»‡n mÃ£ nguá»“n dÆ°á»›i dáº¡ng cáº¥u trÃºc mÃ  chÃºng cÃ²n Ä‘Ã³ng vai trÃ² quan trá»ng trong phÃ¢n tÃ­ch ngá»¯ nghÄ©a, chÃ­nh lÃ  nÆ¡i mÃ  trÃ¬nh biÃªn dá»‹ch xÃ¡c nháº­n tÃ­nh Ä‘Ãºng Ä‘áº¯n vÃ  cÃ¡ch sá»­ dá»¥ng phÃ¹ há»£p cá»§a chÆ°Æ¡ng trÃ¬nh cÅ©ng nhÆ° cÃ¡c pháº§n tá»­ cá»§a ngÃ´n ngá»¯. Vá» sau, cÃ¡c AST Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ sinh ra bytecode hoáº·c mÃ£ mÃ¡y. CÃ¡c á»©ng dá»¥ng ASTAST khÃ´ng chá»‰ Ä‘Æ°á»£c dÃ¹ng trong trÃ¬nh thÃ´ng dá»‹ch vÃ  trÃ¬nh biÃªn dá»‹ch ngÃ´n ngá»¯, chÃºng cÃ²n cÃ³ nhiá»u á»©ng dá»¥ng trong tháº¿ giá»›i mÃ¡y tÃ­nh. Má»™t trong sá»‘ Ä‘Ã³ lÃ  dÃ¹ng chÃºng lÃ  phÃ¢n tÃ­ch code tÄ©nh. CÃ¡c nhÃ  phÃ¢n tÃ­ch tÄ©nh khÃ´ng thá»±c thi code, há» cáº§n hiá»ƒu cáº¥u trÃºc cá»§a code. VÃ­ dá»¥: báº¡n muá»‘n triá»ƒn khai má»™t cÃ´ng cá»¥ tÃ¬m sá»± giá»‘ng nhau giá»¯a cÃ¡c kiáº¿n trÃºc code Ä‘á»ƒ tá»« Ä‘Ã³ báº¡n cÃ³ thá»ƒ refactor nháº±m giáº£m sá»± trÃ¹ng láº·p. Báº¡n cÃ³ thá»ƒ lÃ m viá»‡c nÃ y báº±ng cÃ¡ch so sÃ¡nh string bÃ¬nh thÆ°á»ng nhÆ°ng cÃ¡ch triá»ƒn khai thÃ¬ khÃ¡ cÆ¡ báº£n vÃ  giá»›i háº¡n. Má»™t cÃ¡ch tá»± nhiÃªn, náº¿u báº¡n cÃ³ há»©ng thÃº triá»ƒn khai má»™t cÃ´ng cá»¥ thÃ¬ báº¡n khÃ´ng cáº§n pháº£i viáº¿t riÃªng cho nÃ³ 1 cÃ¡i parser. CÃ³ ráº¥t nhiá»u triá»ƒn khai mÃ£ nguá»“n má»Ÿ cÃ³ sáºµn cÃ³ kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch toÃ n diá»‡n vá»›i thÃ´ng sá»‘ ká»¹ thuáº­t cá»§a Ecmascript. VÃ­ dá»¥: Esprima vÃ  Acorn. CÅ©ng cÃ³ ráº¥t nhiá»u cÃ´ng cá»¥ cÃ³ thá»ƒ giÃºp ta vá»›i sáº£n pháº©m nháº­n Ä‘Æ°á»£c tá»« parser, hay cÃ²n gá»i lÃ  AST. CÃ¡c AST cÅ©ng Ä‘Æ°á»£c dÃ¹ng nhiá»u trong pháº§n triá»ƒn khai cá»§a cÃ¡c code transpiler. VÃ­ dá»¥: báº¡n cáº§n triá»ƒn khai má»™t bá»™ transpiler Ä‘á»ƒ chuyá»ƒn code Python thÃ nh Javascript. Ã tÆ°á»Ÿng cÆ¡ báº£n lÃ  ta cáº§n má»™t Python transpiler Ä‘á»ƒ sinh ra cÃ¢y AST - thá»© mÃ  ta cáº§n Ä‘á»ƒ cÃ³ thá»ƒ sinh ra code Javascript sau nÃ y. Báº¡n cÃ³ thá»ƒ tá»± há»i, lÃ m sao nhÆ° váº­y Ä‘Æ°á»£c? Äiá»ƒm máº¥u chá»‘t lÃ  cÃ¡c AST chá»‰ lÃ  má»™t Ä‘iá»ƒm khÃ¡c biá»‡t vá» cÃ¡ch thá»ƒ hiá»‡n má»™t vÃ i ngÃ´n ngá»¯. TrÆ°á»›c khi parse, nÃ³ thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng vÄƒn báº£n Ä‘i kÃ¨m theo má»™t sá»‘ quy luáº­t nháº¥t Ä‘á»‹nh Ä‘á»ƒ hÃ¬nh thÃ nh nÃªn 1 ngÃ´n ngá»¯. Sau khi parse, nÃ³ thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng má»™t kiáº¿n trÃºc dáº¡ng cÃ¢y chá»©a chÃ­nh xÃ¡c cÃ¹ng 1 thÃ´ng tin vá»›i vÄƒn báº£n Ä‘áº§u vÃ o. VÃ¬ tháº¿, báº¡n cÃ³ thá»ƒ luÃ´n luÃ´n cÃ³ thá»ƒ lÃ m ngÆ°á»£c láº¡i vÃ  go back vá» dáº¡ng biá»ƒu diá»…n vÄƒn báº£n. Javascript parsingGiá» thÃ¬ cÃ¹ng tÃ¬m hiá»ƒu cÃ¢y AST Ä‘Æ°á»£c xÃ¢y dá»±ng nhÆ° tháº¿ nÃ o. Äáº§u tiÃªn ta cÃ³ má»™t hÃ m Javascript Ä‘Æ¡n giáº£n nhÆ° sau: 12345678function foo(x) &#123; if (x &gt; 10) &#123; var a = 2; return a * x; &#125; return x + 10;&#125; Parser sáº½ sáº£n sinh ra cÃ¢y AST nhÆ° sau: LÆ°u Ã½ ráº±ng vÃ¬ má»¥c Ä‘Ã­ch dá»… nhÃ¬n vÃ  Ä‘áº¹p thÃ¬ hÃ¬nh trÃªn chá»‰ lÃ  phiÃªn báº£n tá»‘i giáº£n cá»§a sáº£n pháº©m thá»±c sá»± tá»« parser. CÃ¢y AST tháº­t sáº½ phá»©c táº¡p hÆ¡n ráº¥t nhiá»u. Tuy nhiÃªn, má»¥c Ä‘Ã­ch cá»§a chÃºng ta lÃ  cÃ³ Ä‘Æ°á»£c Ã½ tÆ°á»Ÿng cÆ¡ báº£n vá» viá»‡c mÃ£ nguá»“n sáº½ biáº¿n thÃ nh cÃ¡i gÃ¬ trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c thá»±c thi. Náº¿u báº¡n muá»‘n xem cÃ¢y AST thá»© thiá»‡t trÃ´ng nhÆ° tháº¿ nÃ o thÃ¬ báº¡n cÃ³ thá»ƒ vÃ o Ä‘Ã¢y. ÄÃ³ lÃ  1 cÃ´ng cá»¥ online, báº¡n chá»‰ cáº§n nháº­p code Javascript vÃ o vÃ  nÃ³ sáº½ sinh ra cÃ¢y AST cho Ä‘oáº¡n code Ä‘Ã³. Báº¡n sáº½ tá»± há»i táº¡i sao chÃºng ta cáº§n biáº¿t vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Javascript parser. Sau táº¥t cáº£ thÃ¬ nÃ³ thuá»™c vá» trÃ¡ch nhiá»‡m cá»§a trÃ¬nh duyá»‡t. VÃ  vá» máº·t nÃ o Ä‘Ã³ thÃ¬ Ä‘Ãºng lÃ  nhÆ° tháº¿. Tuy nhiÃªn, báº¡n cÃ³ thá»ƒ xem hÃ¬nh bÃªn dÆ°á»›i, Ä‘Ã³ lÃ  Ä‘á»“ thá»‹ biá»ƒu diá»…n tá»•ng thá»i gian phÃ¢n phá»‘i cho tá»«ng bÆ°á»›c trong quÃ¡ trÃ¬nh thá»±c thi code Javascript. HÃ£y nhÃ¬n ká»¹ hÆ¡n vÃ  thá»­ xem cÃ³ tháº¥y Ä‘Æ°á»£c gÃ¬ thÃº vá»‹ khÃ´ng. Báº¡n cÃ³ tháº¥y Ä‘Æ°á»£c khÃ´ng? NhÃ¬n ká»¹ xem. Trung bÃ¬nh thÃ¬ trÃ¬nh duyá»‡t chiáº¿m khoáº£ng 15-20% tá»•ng thá»i gian thá»±c thi Ä‘á»ƒ parse Javascript. Nhá»¯ng con sá»‘ nÃ y khÃ´ng pháº£i lÃ  bá»‹a Ä‘áº·t. ChÃºng lÃ  sá»‘ liá»‡u thá»‘ng kÃª tá»« nhá»¯ng á»©ng dá»¥ng vÃ  website cÃ³ tháº­t Ä‘ang báº±ng cÃ¡ch nÃ y hay cÃ¡ch khÃ¡c sá»­ dá»¥ng Javascript. Giá» thÃ¬ 15% cÃ³ váº» nhÆ° khÃ´ng nhiá»u láº¯m, nhÆ°ng tin tÃ´i Ä‘i, nÃ³ cÃ³ giÃ¡ trá»‹ Ä‘áº¥y. Má»™t app SPA tiÃªu chuáº©n sáº½ load khoáº£ng 0.4MB code Javascript vÃ  trÃ¬nh duyá»‡t tiÃªu tá»‘n xáº¥p xá»‰ 370ms Ä‘á»ƒ parse nÃ³. ThÃªm má»™t láº§n ná»¯a, báº¡n sáº½ nÃ³i ráº±ng nÃ³ cháº³ng Ä‘Ã¡ng bao nhiÃªu thá»i gian cáº£. VÃ  rÃµ rÃ ng con sá»‘ Ä‘Ã³ quÃ¡ nhá». Tuy nhiÃªn nhá»› ká»¹ ráº±ng Ä‘Ã¢y chá»‰ lÃ  thá»i gian cáº§n Ä‘á»ƒ parse code Javascript thÃ nh cÃ¢y AST. ChÆ°a bao gá»“m thá»i gian thá»±c thi chÃ­nh nÃ³ hay báº¥t ká»³ tiáº¿n trÃ¬nh nÃ o diá»…n ra trong khi load trang (vÃ­ dá»¥ nhÆ° CSS &amp; HTML rendering). VÃ  táº¥t cáº£ thÃ´ng sá»‘ nÃ y má»›i chá»‰ thá»ƒ hiá»‡n cho desktop. Khi chÃºng ta Ä‘i sÃ¢u hÆ¡n trÃªn mobile, má»i thá»© sáº½ trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n nhiá»u. Thá»i gian dÃ nh cho viá»‡c parse trÃªn mobile thÆ°á»ng cÃ³ thá»ƒ nhiá»u hÆ¡n 2-5 láº§n so vá»›i trÃªn desktop. Äá»“ thá»‹ trÃªn thá»ƒ hiá»‡n thá»i gian parse cá»§a 1 gÃ³i code Javascript 1MB trÃªn ráº¥t nhiá»u thiáº¿t bá»‹ mobile &amp; desktop thuá»™c nhiá»u phÃ¢n khÃºc khÃ¡c nhau. GÃ¬ ná»¯a nÃ o? Web app Ä‘ang cÃ ng trá»Ÿ nÃªn phá»©c táº¡p theo tá»«ng phÃºt cÅ©ng nhÆ° cÃ ng cÃ³ nhiá»u business logic pháº£i xá»­ lÃ½ á»Ÿ phÃ­a client Ä‘á»ƒ cÃ³ thá»ƒ mang láº¡i tráº£i nghiá»‡m giá»‘ng há»‡t nhÆ° native app. Báº¡n cÃ³ thá»ƒ dá»… dÃ ng hiá»ƒu Ä‘Æ°á»£c nhá»¯ng Ä‘iá»u Ä‘Ã³ áº£nh hÆ°á»Ÿng nhÆ° tháº¿ nÃ o Ä‘áº¿n website/wepapp cá»§a báº¡n. Táº¥t cáº£ nhá»¯ng gÃ¬ báº¡n cáº§n lÃ  má»Ÿ dev tool cá»§a trÃ¬nh duyá»‡t lÃªn vÃ  Ä‘á»ƒ nÃ³ Ä‘o Ä‘áº¡c lÆ°á»£ng thá»i gian dÃ nh cho parsing, biÃªn dá»‹ch vÃ  má»i thá»© diá»…n ra trÃªn trÃ¬nh duyá»‡t cho tá»›i khi trang web Ä‘Æ°á»£c load hoÃ n toÃ n. Tháº­t khÃ´ng may, khÃ´ng cÃ³ dev tool nÃ o cho cÃ¡c trÃ¬nh duyá»‡t mobile. NhÆ°ng Ä‘á»«ng lo láº¯ng, Ä‘iá»u nÃ y khÃ´ng cÃ³ nghÄ©a ráº±ng báº¡n khÃ´ng thá»ƒ lÃ m gÃ¬ Ä‘Æ°á»£c. ÄÃ¢y lÃ  lÃ½ do nhá»¯ng cÃ´ng cá»¥ nhÆ° DeviceTiming tá»“n táº¡i. NÃ³ cÃ³ thá»ƒ giÃºp báº¡n Ä‘o Ä‘áº¡c thá»i gian parse vÃ  thá»±c thi cho cÃ¡c Ä‘oáº¡n code trong má»™t mÃ´i trÆ°á»ng kiá»ƒm soÃ¡t. NÃ³ hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch gÃ³i gá»n code local vá»›i Ä‘oáº¡n code Ä‘o lÆ°á»ng, vÃ¬ tháº¿ nÃªn má»—i láº§n trang web cá»§a báº¡n Ä‘Æ°á»£c truy cáº­p tá»« cÃ¡c thiáº¿t bá»‹ khÃ¡c nhau, báº¡n cÃ³ thá»ƒ Ä‘o Ä‘áº¡c thá»i gian parse vÃ  thá»±c thi. Äiá»u tá»‘t lÃ  engine Javascript Ä‘Ã£ lÃ m ráº¥t nhiá»u thá»© nháº±m trÃ¡nh cÃ¡ch cÃ´ng viá»‡c thá»«a thÃ£i vÃ  tá»‘i hÆ°u hÃ³a nhiá»u hÆ¡n. DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ i thá»© mÃ  cÃ¡c engine cá»§a nhá»¯ng trÃ¬nh duyá»‡t lá»›n Ä‘Ã£ lÃ m. VÃ­ dá»¥ vá»›i V8, nÃ³ thá»±c hiá»‡n script streaming &amp; code caching. Script streaming nghÄ©a lÃ  cÃ¡c Ä‘oáº¡n code báº¥t Ä‘á»“ng bá»™ &amp; bá»‹ trÃ¬ hoÃ£n sáº½ Ä‘Æ°á»£c parse trong 1 tiáº¿n trÃ¬nh riÃªng ngay khi quÃ¡ trÃ¬nh download báº¯t Ä‘áº§u. NÃ³ giÃºp cho quÃ¡ trÃ¬nh parsing gáº§n nhÆ° hoÃ n thÃ nh ngay láº­p tá»©c sau khi Ä‘oáº¡n code (script) Ä‘Æ°á»£c táº£i xong. Káº¿t quáº£ lÃ  cÃ¡c trang sáº½ load nhanh hÆ¡n khoáº£ng 10%. Code Javascript thÆ°á»ng Ä‘Æ°á»£c biÃªn dá»‹ch thÃ nh bytecode má»—i khi cÃ³ má»™t lÆ°á»£t truy cáº­p trang. Tuy nhiÃªn, cá»¥c bytecode nÃ y láº¡i bá»‹ bá» Ä‘i khi ngÆ°á»i dÃ¹ng truy cáº­p Ä‘áº¿n trang khÃ¡c. Äiá»u nÃ y xáº£y ra vÃ¬ code Ä‘Æ°á»£c biÃªn dá»‹ch phá»¥ thuá»™c ráº¥t nhiá»u vÃ o tráº¡ng thÃ¡i vÃ  ngá»¯ cáº£nh cá»§a mÃ¡y táº¡i thá»i Ä‘iá»ƒm biÃªn dá»‹ch. ÄÃ¢y lÃ  lÃ½ do Chrome 42 giá»›i thiá»‡u bytecode caching (bá»™ Ä‘á»‡m bytecode). ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t lÆ°u trá»¯ code Ä‘Ã£ biÃªn dá»‹ch á»Ÿ local Ä‘á»ƒ khi user quay trá»Ÿ láº¡i trang cÅ© trÆ°á»›c Ä‘Ã³ thÃ¬ táº¥t cáº£ má»i hoáº¡t Ä‘á»™ng nhÆ° download, parse, biÃªn dá»‹châ€¦ cÃ³ thá»ƒ bá» qua. NÃ³ cho phÃ©p Chrome tiáº¿t kiá»‡m 40% thá»i gian parse &amp; thá»±c thi. ThÃªm ná»¯a, káº¿t quáº£ nÃ³ tiáº¿t kiá»‡m pin nhiá»u hÆ¡n náº¿u cháº¡y trÃªn cÃ¡c thiáº¿t bá»‹ mobile. Trong Opera, engine Carakan cÃ³ thá»ƒ dÃ¹ng láº¡i káº¿t quáº£ biÃªn dá»‹ch tá»« chÆ°Æ¡ng trÃ¬nh khÃ¡c vá»«a má»›i Ä‘Æ°á»£c biÃªn dá»‹ch gáº§n Ä‘Ã¢y. KhÃ´ng cÃ³ cÃ¡c yÃªu cáº§u cá»¥ thá»ƒ nÃ o vá» viá»‡c code pháº£i Ä‘áº¿n tá»« cÃ¹ng 1 trang hay domain. Ká»¹ thuáº­t caching nÃ y thá»±c sá»± ráº¥t há»¯u Ã­ch vÃ  cÃ³ thá»ƒ hoÃ n toÃ n bá» qua bÆ°á»›c biÃªn dá»‹ch. NÃ³ phá»¥ thuá»™c vÃ o hÃ nh vi tiÃªu chuáº©n cá»§a user vÃ  ngá»¯ cáº£nh lÆ°Æ¡t web: má»—i khi user thá»±c hiá»‡n cÃ¹ng chuá»—i hÃ nh trÃ¬nh vá»›i má»™t user khÃ¡ch trÃªn app/website thÃ¬ cÃ¹ng 1 Ä‘oáº¡n code Javascript sáº½ Ä‘Æ°á»£c táº£i. Tuy nhiÃªn, Opera Ä‘Ã£ sá»›m thay tháº¿ Carakan báº±ng Google V8. Bá»™ engine SpiderMonkey cá»§a Firefox khÃ´ng lÆ°u cache báº¥t ká»³ thá»© gÃ¬. NÃ³ Ä‘áº¡i khÃ¡i lÃ  chuyá»ƒn qua dÃ¹ng má»™t thao tÃ¡c giÃ¡m sÃ¡t Ä‘á»ƒ Ä‘áº¿m xem 1 Ä‘oáº¡n code Javascript Ä‘Æ°á»£c thá»±c thi bao nhiÃªu láº§n. Dá»±a trÃªn sá»‘ Ä‘áº¿m nÃ y nÃ³ xÃ¡c Ä‘á»‹nh pháº§n nÃ o cá»§a code Ä‘ang hot vÃ  cáº§n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a. RÃµ rÃ ng cÃ³ má»™t sá»‘ ngÆ°á»i lá»±a chá»n khÃ´ng lÃ m gÃ¬ cáº£. Maciej Stachowiak, lead developer cá»§a Safari, chá»‰ Ä‘á»‹nh ráº±ng Safari khÃ´ng thá»±c hiá»‡n báº¥t ká»³ hoáº¡t Ä‘á»™ng cache nÃ o cho bytecode Ä‘Ã£ biÃªn dá»‹ch. CÃ³ váº» nhÆ° há» Ä‘Ã£ cÃ³ cÃ¢n nháº¯c vá» viá»‡c nÃ y nhÆ°ng khÃ´ng triá»ƒn khai nÃ³ bá»Ÿi vÃ¬ nÃ³ chá»‰ nhá» hÆ¡n 2% tá»•ng thá»i gian thá»±c thi. Nhá»¯ng hoáº¡t Ä‘á»™ng tá»‘i Æ°u hÃ³a khÃ´ng trá»±c tiáº¿p áº£nh hÆ°á»Ÿng Ä‘áº¿n chuyá»‡n parsing cá»§a code Javascript nhÆ°ng chÃºng cháº¯c cháº¯n Ä‘ang lÃ m tá»‘t nháº¥t cÃ³ thá»ƒ Ä‘á»ƒ bá» qua nÃ³ má»™t cÃ¡ch hoÃ n toÃ n. CÃ²n cÃ¡ch tá»‘i Æ°u hÃ³a nÃ o tá»‘t hÆ¡n lÃ  tá»‘i Æ°u hÃ³a hoÃ n toÃ n? CÃ³ nhiá»u thá»© chÃºng ta cÃ³ thá»ƒ lÃ m Ä‘á»ƒ cáº£i thiá»‡n thá»i gian load app ban Ä‘áº§u. Ta cÃ³ thá»ƒ lÃ m tá»‘i giáº£n lÆ°á»£ng code Javascript Ä‘ang sá»­ dá»¥ng: Ã­t code, Ã­t parse, Ã­t thá»±c hi. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y, ta cáº§n Ä‘Æ°a ra vá»«a Ä‘Ãºng lÆ°á»£ng code cáº§n thiáº¿t cho má»™t tÃ­nh nÄƒng cá»¥ thá»ƒ thay vÃ¬ load 1 cá»¥c thiá»‡t to lá»›n vÃ  dÃ¹ng nÃ³ vÃ o má»i thá»©. VÃ­ dá»¥, pattern PRPL cÃ³ thuyáº¿t giáº£ng vá» mÃ´ hÃ¬nh chuyá»ƒn giao code nhÆ° váº­y. NÃ³i cÃ¡ch khÃ¡c, ta cÃ³ thá»ƒ kiá»ƒm tra cÃ¡c dependency vÃ  xem náº¿u nhÆ° cÃ³ gÃ¬ Ä‘Ã³ thá»«a thÃ£i khÃ´ng cáº§n thiáº¿t lÃ m cháº­m code cá»§a chÃºng ta. Vá» pháº§n nÃ y thÃ¬ hi vá»ng lÃ  sáº½ cÃ³ 1 topic riÃªng Ä‘á»ƒ nÃ³i vá» nÃ³. Má»¥c Ä‘Ã­ch cá»§a bÃ i viáº¿t nÃ y lÃ  Ä‘á»ƒ tháº£o luáº­n chÃºng ta - nhá»¯ng web developer - cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c gÃ¬ Ä‘á»ƒ giÃºp cho Javascript parser cÃ³ thá»ƒ cháº¡y nhanh hÆ¡n. VÃ  chÃ­nh lÃ  Ä‘Ã¢y, cÃ¡c Javascript parser hiá»‡n Ä‘áº¡i sá»­ dá»¥ng cÃ¡c phá»ng Ä‘oÃ¡n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh náº¿u má»™t Ä‘oáº¡n code cá»¥ thá»ƒ nÃ o Ä‘Ã³ chuáº©n bá»‹ Ä‘Æ°á»£c thá»±c thi ngay hoáº·c quÃ¡ trÃ¬nh thá»±c thi sáº½ bá»‹ táº¡m ngÆ°ng vÃ  dá»i láº¡i trong má»™t thá»i Ä‘iá»ƒm khÃ¡c. Dá»±a trÃªn cÃ¡c phá»ng Ä‘oÃ¡n, parser sáº½ lÃ m hoáº·c lÃ  eager parsing (parse nhanh) hoáº·c lÃ  lazy parsing (parse tá»« tá»«). Eager parsing cháº¡y xuyÃªn suá»‘t cÃ¡c hÃ m nÃ o cáº§n Ä‘Æ°á»£c biÃªn dá»‹ch tá»©c thá»i. NÃ³ thá»±c hiá»‡n 3 viá»‡c chÃ­nh: xÃ¢y dá»±ng cÃ¢y AST, xÃ¢y dá»±ng há»‡ thá»‘ng cáº¥p báº­c (hierarchy) cho scope vÃ  tÃ¬m táº¥t cáº£ cÃ¡c lá»—i cÃº phÃ¡p. Lazy parsing thÃ¬ ngÆ°á»£c láº¡i, nÃ³ chá»‰ Ä‘Æ°á»£c dÃ¹ng cho cÃ¡c hÃ m chÆ°a cáº§n Ä‘Æ°á»£c biÃªn dá»‹ch. NÃ³ khÃ´ng xÃ¢y dá»±ng cÃ¢y AST vÃ  cÅ©ng khÃ´ng tÃ¬m lá»—i cÃº phÃ¡p. NÃ³ chá»‰ xÃ¢y dá»±ng há»‡ thá»‘ng cáº¥p báº­c cho scope vÃ  tiáº¿t kiá»‡m Ä‘Æ°á»£c má»™t ná»­a thá»i gian so vá»›i eager. RÃµ rÃ ng Ä‘Ã¢y khÃ´ng pháº£i lÃ  Ã½ tÆ°á»Ÿng má»›i. Ká»ƒ cáº£ trÃ¬nh duyá»‡t nhÆ° IE9 cÅ©ng há»— trá»£ tá»‘i Æ°u hÃ³a máº·c dÃ¹ nÃ³ cháº¡y hÆ¡i thÃ´ sÆ¡ náº¿u nhÆ° so vá»›i cÃ¡ch mÃ  parser ngÃ y nay hoáº¡t Ä‘á»™ng. Giá» thÃ¬ cÃ¹ng xem má»™t vÃ­ dá»¥ vá» cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng. Giáº£ sá»­ ta cÃ³ Ä‘oáº¡n code sau: 1234567891011function foo() &#123; function bar(x) &#123; return x + 10; &#125; function baz(x, y) &#123; return x + y; &#125; console.log(baz(100, 200));&#125; Giá»‘ng nhÆ° vÃ­ dá»¥ trÆ°á»›c, code Ä‘Æ°á»£c Ä‘Æ°a vÃ o parser Ä‘á»ƒ phÃ¢n tÃ­ch cÃº phÃ¡p vÃ  tráº£ ra cÃ¢y AST. Váº­y thÃ¬ Ä‘Ã¢y lÃ  nhá»¯ng gÃ¬ thá»±c hiá»‡n theo tá»«ng dÃ²ng: Äá»‹nh nghÄ©a hÃ m bar nháº­n 1 biáº¿n x vÃ  nÃ³ cÃ³ 1 cÃ¢u lá»‡nh return tráº£ vá» káº¿t quáº£ cá»§a phÃ©p tÃ­nh cá»™ng giá»¯a x vÃ  10. Äá»‹nh nghÄ©a hÃ m baz nháº­n 2 biáº¿n (x vÃ  y). NÃ³ cÃ³ 1 cÃ¢u lá»‡nh return. HÃ m nÃ y tráº£ vá» káº¿t quáº£ cá»§a phÃ©p tÃ­nh cá»™ng giá»¯a x vÃ  y. Gá»i hÃ m baz vá»›i 2 Ä‘á»‘i sá»‘ lÃ  100 vÃ  200. Táº¡o ra 1 lá»i gá»i hÃ m Ä‘áº¿n console.log vá»›i giÃ¡ trá»‹ lÃ  káº¿t quáº£ cá»§a lá»i gá»i hÃ m trÆ°á»›c Ä‘Ã³. Äiá»u gÃ¬ vá»«a xáº£y ra váº­y? Parser tháº¥y cÃ³ má»™t Ä‘á»‹nh nghÄ©a hÃ m foo, Ä‘á»‹nh nghÄ©a bar vÃ  1 hÃ m baz, má»™t lá»i gá»i Ä‘áº¿n hÃ m baz, má»™t lá»i gá»i Ä‘áº¿n hÃ m console.log. Chá» Ä‘Ã£â€¦ cÃ³ má»™t sá»‘ thá»© parser Ä‘Ã£ lÃ m hoÃ n toÃ n khÃ´ng liÃªn quan. ÄÃ³ lÃ  viá»‡c parse hÃ m bar. Táº¡i sao láº¡i khÃ´ng liÃªn quan? Bá»Ÿi vÃ¬ hÃ m bar chÆ°a bao giá» Ä‘Æ°á»£c gá»i (Ã­t nháº¥t lÃ  cho tá»›i thá»i Ä‘iá»ƒm nÃ y). ÄÃ¢y chá»‰ lÃ  má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vÃ  cÃ³ váº» nhÆ° khÃ´ng bÃ¬nh thÆ°á»ng nhÆ°ng nÃ³ xuáº¥t hiá»‡n trÃªn ráº¥t nhiá»u app thá»±c, cÃ³ ráº¥t nhiá»u hÃ m Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ°ng khÃ´ng bao giá» dÃ¹ng Ä‘áº¿n. Thay vÃ¬ parse hÃ m bar, chÃºng ta cÃ³ thá»ƒ Ä‘Ã¡nh dáº¥u nÃ³ Ä‘Ã£ Ä‘Æ°á»£c khai bÃ¡o nhÆ°ng khÃ´ng chá»‰ ra cá»¥ thá»ƒ nÃ³ lÃ m gÃ¬. Parsing sáº½ diá»…n ra khi cáº§n thiáº¿t ngay trÆ°á»›c khi hÃ m Ä‘Æ°á»£c thá»±c thi. VÃ  dÄ© nhiÃªn lÃ  lazy parsing cÅ©ng váº«n cáº§n thiáº¿t Ä‘á»ƒ tÃ¬m toÃ n bá»™ body cá»§a hÃ m vÃ  táº¡o má»™t khai bÃ¡o cho hÃ m Ä‘Ã³. NÃ³ khÃ´ng cáº§n cÃ¢y cÃº phÃ¡p bá»Ÿi vÃ¬ nÃ³ váº«n chÆ°a Ä‘Æ°á»£c xá»­ lÃ½. ThÃªm ná»¯a, bá»™ nhá»› heap váº«n chÆ°a Ä‘Æ°á»£c cáº¥p phÃ¡t (pháº§n nÃ y cÅ©ng chiáº¿m 1 lÆ°á»£ng tÆ°Æ¡ng Ä‘á»‘i trong tÃ i nguyÃªn há»‡ thá»‘ng). NÃ³i ngáº¯n gá»n thÃ¬ bá» qua má»™t sá»‘ bÆ°á»›c trÃªn sáº½ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u nÄƒng. Váº­y nÃªn nhÃ¬n láº¡i vÃ­ dá»¥ trÃªn, ta cÃ³ cÃ¢y AST má»›i sáº½ nhÆ° tháº¿ nÃ y: LÆ°u Ã½ ráº±ng hÃ m bar Ä‘Æ°á»£c khai bÃ¡o vÃ  cháº¥p nháº­n, nhÆ°ng chá»‰ cÃ³ tháº¿ thÃ´i. ChÃºng ta khÃ´ng lÃ m gÃ¬ vá»›i body cá»§a hÃ m. Trong trÆ°á»ng há»£p nÃ y, body cá»§a hÃ m chá»‰ cÃ³ 1 cÃ¢u lá»‡nh return. Tuy nhiÃªn, trong háº§u háº¿t cÃ¡c á»©ng dá»¥ng thá»±c táº¿, nÃ³ cÃ³ thá»ƒ lá»›n hÆ¡n ráº¥t nhiá»u, bao gá»“m nhiá»u cÃ¢u lá»‡nh return, Ä‘iá»n kiá»‡n, vÃ²ng láº·p, Ä‘á»‹nh nghÄ©a cÃ¡c biáº¿n vÃ  ká»ƒ cáº£ cÃ¡c khai bÃ¡o hÃ m lá»“ng nhau. Táº¥t cáº£ nhá»¯ng thá»© nÃ y sáº½ gÃ¢y tá»‘n thá»i gian cÅ©ng nhÆ° tÃ i nguyÃªn há»‡ thá»‘ng bá»Ÿi vÃ¬ hÃ m khÃ´ng bao giá» Ä‘Æ°á»£c gá»i. ÄÃ¢y lÃ  má»™t Ã½ tÆ°á»Ÿng cá»±c ká»³ Ä‘Æ¡n giáº£n nhÆ°ng trong thá»±c táº¿ cÃ´ng viá»‡c thÃ¬ viá»‡c triá»ƒn khai nÃ³ láº¡i khÃ´ng Ä‘Æ¡n giáº£n. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ mÃ  cháº¯c cháº¯n khÃ´ng pháº£i lÃ  trÆ°á»ng há»£p duy nháº¥t. ToÃ n bá»™ phÆ°Æ¡ng thá»©c sá»­ dá»¥ng cÃ¡c hÃ m, vÃ²ng láº·p, Ä‘iá»u kiá»‡n, object, vÃ¢n vÃ¢n. CÆ¡ báº£n lÃ  toÃ n bá»™ code cáº§n Ä‘Æ°á»£c parse. VÃ­ dá»¥ má»™t mÃ´ hÃ¬nh phá»• biáº¿n Ä‘á»ƒ triá»ƒn khai Javascript module: 1234var myModule = (function() &#123; // toÃ n bá»™ logic cá»§a module // return vá» module.&#125;)(); MÃ´ hÃ¬nh nÃ y dá»… dÃ ng nháº­n ra bá»Ÿi cÃ¡c Javascript parser hiá»‡n Ä‘áº¡i vÃ  lÃ  má»™t dáº¥u hiá»‡u cho tháº¥y code bÃªn trong cÃ³ thá»ƒ dÃ¹ng eager parsing. Váº­y táº¡i sao parser khÃ´ng máº·c Ä‘á»‹nh lazy parsing? Náº¿u cÃ³ gÃ¬ Ä‘Ã³ Ä‘Æ°á»£c parse lazy thÃ¬ nÃ³ pháº£i Ä‘Æ°á»£c thá»±c thi ngay láº­p tá»©c vÃ  Ä‘iá»u nÃ y thá»±c sá»± gÃ¢y ra sá»± cháº­m cháº¡p. Má»™t lazy parse Ä‘Æ°á»£c thá»±c hiá»‡n vÃ  ngay sau Ä‘Ã³ lÃ  eager parse. Káº¿t quáº£ lÃ  tá»‘c Ä‘á»™ cháº­m hÆ¡n 50% khi so sÃ¡nh vá»›i chá»‰ dÃ¹ng 1 eager parse. Äáº¿n lÃºc nÃ y ta Ä‘Ã£ cÃ³ kiáº¿n thá»©c cÆ¡ báº£n vá» phÃ­a háº­u trÆ°á»ng, giá» thÃ¬ thá»­ xem chÃºng ta cÃ³ giÃºp gÃ¬ cho parser Ä‘Æ°á»£c khÃ´ng. Ta cÃ³ thá»ƒ viáº¿t code theo cÃ¡ch mÃ  cÃ¡c hÃ m cÃ³ thá»ƒ Ä‘Æ°á»£c parse táº¡i thá»i Ä‘iá»ƒm phÃ¹ há»£p. CÃ³ má»™t pattern Ä‘Æ°á»£c xÃ i chung giá»¯a cÃ¡c parser: Ä‘Ã³ng gÃ³i hÃ m bÃªn trong dáº¥u ngoáº·c (). ÄÃ¢y luÃ´n lÃ  má»™t dáº¥u hiá»‡u tÃ­ch cá»±c cho parser hiá»ƒu ráº±ng hÃ m sáº½ Ä‘Æ°á»£c thá»±c thi ngay láº­p tá»©c. Náº¿u parser báº¯t gáº·p má»™t dáº¥u má»Ÿ ngoáº·c ( vÃ  ngay liá»n sau Ä‘Ã³ lÃ  má»™t Ä‘á»‹nh nghÄ©a hÃ m, nÃ³ sáº½ parse eager hÃ m Ä‘Ã³. ChÃºng ta cÃ³ thá»ƒ giÃºp parser báº±ng cÃ¡ch khai bÃ¡o hÃ m má»™t cÃ¡ch tÆ°á»ng minh nhÆ° váº­y hÃ m sáº½ Ä‘Æ°á»£c thá»±c thi ngay láº­p tá»©c. Giáº£ sá»­ ta cÃ³ hÃ m Javascript nhÆ° sau: 123function foo(x) &#123; return x * 10;&#125; Bá»Ÿi vÃ¬ khÃ´ng cÃ³ dáº¥u hiá»‡u rÃµ rÃ ng ráº±ng hÃ m sáº½ Ä‘Æ°á»£c thá»±c thi ngay láº­p tá»©c nÃªn trÃ¬nh duyá»‡t sáº½ thá»±c hiá»‡n lazy parse. Tuy nhiÃªn, chÃºng ta biáº¿t ráº±ng nhÆ° váº­y lÃ  khÃ´ng Ä‘Ãºng nÃªn ta cÃ³ thá»ƒ lÃ m 2 viá»‡c. Äáº§u tiÃªn, ta lÆ°u hÃ m vÃ o trong 1 biáº¿n: 123var foo = function foo(x) &#123; return x * 10;&#125;; LÆ°u Ã½ ráº±ng ta váº«n giá»¯ láº¡i tÃªn hÃ m foo giá»¯a tá»« khÃ³a function vÃ  dáº¥u má»Ÿ ngoáº·c (. Äiá»u nÃ y tuy khÃ´ng cáº§n thiáº¿t nhÆ°ng báº¡n bÃªn lÃ m vÃ¬ trong trÆ°á»ng há»£p xá»­ lÃ½ biá»‡t lá»‡, stacktrace sáº½ hiá»‡n ra tÃªn cá»¥ thá»ƒ cá»§a hÃ m thay vÃ¬ má»™t chá»¯ khÃ´ khan. Parser váº«n thá»±c hiá»‡n lazy parse. Ta cÃ³ thá»ƒ ngÄƒn cháº·n Ä‘iá»u nÃ y báº±ng cÃ¡ch thÃªm má»™t chi tiáº¿t nhá»: gÃ³i hÃ m Ä‘Ã³ láº¡i trong dáº¥u ngoáº·c. 123var foo = (function foo(x) &#123; return x * 10;&#125;); Táº¡i thá»i Ä‘iá»ƒm nÃ y, khi parser tháº¥y dáº¥u má»Ÿ ngoáº·c ( ngay trÆ°á»›c tá»« khÃ³a function nÃ³ sáº½ ngay láº­p tá»©c thá»±c hiá»‡n eager parsing. Sáº½ hÆ¡i khÃ³ Ä‘á»ƒ quáº£n lÃ½ bá»Ÿi vÃ¬ chÃºng ta sáº½ cáº§n pháº£i biáº¿t trong trÆ°á»ng há»£p nÃ o thÃ¬ parser chá»n parse lazy hay eager. ThÃªm ná»¯a ta cáº§n pháº£i suy nghÄ© vÃ  tÃ¬m hiá»ƒu má»™t hÃ m cá»¥ thá»ƒ nÃ o Ä‘Ã³ cÃ³ Ä‘Æ°á»£c gá»i ngay láº­p tá»©c hay khÃ´ng. ChÃºng ta cháº¯c cháº¯n khÃ´ng muá»‘n lÃ m váº­y. Ãt nháº¥t thÃ¬ nÃ³ sáº½ lÃ m cho code khÃ³ Ä‘á»c &amp; khÃ³ hiá»ƒu hÆ¡n. CÃ´ng cá»¥ nhÆ° Optimize.js cÃ³ thá»ƒ giÃºp ta ráº¥t nhiá»u. Má»¥c Ä‘Ã­ch duy nháº¥t cá»§a nÃ³ lÃ  tá»‘i Æ°u hÃ³a thá»i gian loaing ban Ä‘áº§u cá»§a code Javascript. ChÃºng thá»±c hiá»‡n phÃ¢n tÃ­ch code tÄ©nh vÃ  chá»‰nh sá»­a láº¡i Ä‘á»ƒ Ä‘Ã³ng gÃ³i nhá»¯ng hÃ m nÃ o cáº§n Ä‘Æ°á»£c thá»±c thi bÃªn trong dáº¥u ngoáº·c (), trÃ¬nh duyá»‡t sáº½ cÃ³ thá»ƒ parse eager vÃ  chuáº©n bá»‹ chÃºng sáºµn sÃ ng Ä‘á»ƒ thá»±c thi. ChÃºng ta cÃ³ thá»ƒ tiáº¿p tá»¥c code bÃ¬nh thÆ°á»ng vÃ  cÃ³ Ä‘c Ä‘oáº¡n code sau: 123(function() &#123; console.log('Hello, World!');&#125;)(); Má»i thá»© cÃ³ váº» tá»‘t, hoáº¡t Ä‘á»™ng Ä‘Ãºng nhÆ° mong Ä‘á»£i vÃ  nhanh ná»¯a. Bá»Ÿi vÃ¬ cÃ³ dáº¥u má»Ÿ ngoáº·c ( trÆ°á»›c khi khai bÃ¡o hÃ m. Ráº¥t tuyá»‡t. DÄ© nhiÃªn rá»“i, trÆ°á»›c khi Ä‘Æ°a lÃªn production ta cáº§n minify Ä‘á»ƒ tiáº¿t kiá»‡m dung lÆ°á»£ng. Äoáº¡n code sau lÃ  sáº£n pháº©m cuá»‘i cÃ¹ng: 1!function()&#123;console.log('Hello, World!')&#125;(); Má»™t láº§n ná»¯a, chÃºng cÃ³ váº» tá»‘t pháº£i khÃ´ng? Code hoáº¡t Ä‘á»™ng y nhÆ° cÅ©. NhÆ°ng cÃ³ gÃ¬ Ä‘Ã³ thiáº¿u thiáº¿u. TrÃ¬nh minify Ä‘Ã£ gá»¡ dáº¥u ngoáº·c Ä‘Ã³ng gÃ³i bÃªn ngoÃ i hÃ m vÃ  thay vÃ o Ä‘Ã³ thÃªm 1 dáº¥u cháº¥m than ! ngay trÆ°á»›c hÃ m. Äiá»u nÃ y nghÄ©a lÃ  parser sáº½ bá» qua nÃ³ vÃ  thá»±c hiá»‡n lazy parse. TrÃªn háº¿t thÃ¬ Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi hÃ m nÃ³ sáº½ thá»±c hiá»‡n eager parse ngay sau khi lazy parse. Váº­y thÃ¬ láº¡i lÃ m code cháº¡y cháº­m hÆ¡n. May máº¯n thay, chÃºng ta cÃ³ nhá»¯ng cÃ´ng cá»¥ nhÆ° Optimize.js giÃºp ta trong nhá»¯ng trÆ°á»ng há»£p nÃ y. Truyá»n Ä‘oáº¡n code Ä‘Ã£ minify vÃ o Optimize.js vÃ  Ä‘Ã¢y lÃ  káº¿t quáº£ Ä‘áº§u ra: 1!(function()&#123;console.log('Hello, World!')&#125;)(); Giá» thÃ¬ ta Ä‘Ã£ cÃ³ thÃ nh pháº©m tá»‘t nháº¥t: code Ä‘Æ°á»£c minify vÃ  parser dá»… dÃ ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c nhá»¯ng hÃ m nÃ o cáº§n parse eager hÃ m nÃ o cáº§n parse lazy. BiÃªn dá»‹ch trÆ°á»›c (Pre-compilation)Váº­y táº¡i sao ta khÃ´ng thá»±c hiá»‡n toÃ n bá»™ cÃ¡c bÆ°á»›c nÃ y á»Ÿ phÃ­a server. DÄ© nhiÃªn thÃ¬ sáº½ tá»‘t hÆ¡n náº¿u chÃºng ta thá»±c hiá»‡n 1 láº§n rá»“i triá»ƒn khai káº¿t quáº£ cho táº¥t cáº£ client, thay vÃ¬ báº¯t má»—i client pháº£i thá»±c hiá»‡n nÃ³ má»—i láº§n cháº¡y. Tháº­t ra thÃ¬ cÃ³ nhá»¯ng tháº£o luáº­n vá» viá»‡c engine nÃªn cung cáº¥p má»™t cÃ¡ch Ä‘á»ƒ thá»±c thi nhá»¯ng Ä‘oáº¡n code Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch trÆ°á»›c Ä‘á»ƒ Ä‘á»¡ tá»‘n thá»i gian cho trÃ¬nh duyá»‡t. Vá» báº£n cháº¥t thÃ¬ Ã½ tÆ°á»Ÿng chÃ­nh lÃ  cÃ³ má»™t cÃ´ng cá»¥ á»Ÿ phÃ­a server cÃ³ thá»ƒ sinh ra bytecode rá»“i truyá»n trá»±c tiáº¿p vá» phÃ­a client vÃ  thá»±c thi. Náº¿u thá»±c sá»± Ä‘Æ°á»£c nhÆ° váº­y thÃ¬ thá»i gian khá»Ÿi Ä‘á»™ng app phÃ­a client sáº½ Ä‘Æ°á»£c cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ. Nghe ráº¥t háº¥p dáº«n, nhÆ°ng má»i viá»‡c khÃ´ng Ä‘Æ¡n giáº£n nhÆ° váº­y. Äiá»u nÃ y cÃ³ thá»ƒ gÃ¢y ra hiá»‡u á»©ng ngÆ°á»£c láº¡i, hiá»‡u á»©ng lá»›n lÃ  Ä‘áº±ng khÃ¡c, vÃ¬ háº§u háº¿t code cÃ³ thá»ƒ sáº½ cáº§n pháº£i Ä‘Æ°á»£c kÃ½ &amp; xá»­ lÃ½ vÃ¬ nhá»¯ng lÃ½ do báº£o máº­t. Äá»™i ngÅ© V8 Ä‘ang lÃ m viá»‡c ná»™i bá»™ vá»›i nhau Ä‘á»ƒ trÃ¡nh re-parsing Ä‘á»ƒ quÃ¡ trÃ¬nh biÃªn dá»‹ch trÆ°á»›c sáº½ cÃ³ lá»£i Ã­ch nhÆ° tháº¿. Má»™t vÃ i máº¹o váº·t báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘á»ƒ app cháº¡y nhanh hÆ¡n Kiá»ƒm tra cÃ¡c dependency. Loáº¡i bá» nhá»¯ng thá»© khÃ´ng cáº§n thiáº¿t. Chia nhá» code thÃ nh nhiá»u pháº§n nhá» hÆ¡n thay vÃ¬ load nguyÃªn 1 cá»¥c bá»±. TrÃ¬ hoÃ£n quÃ¡ trÃ¬nh load Javascript náº¿u cÃ³ thá»ƒ. Báº¡n chá»‰ cáº§n load pháº§n code nÃ o cáº§n thiáº¿t dá»±a trÃªn route hiá»‡n táº¡i mÃ  thÃ´i. DÃ¹ng dev tool &amp; DeviceTiming Ä‘á»ƒ tÃ¬m hiá»ƒu pháº§n nÃ o Ä‘ang bá»‹ tháº¯t cá»• chai. DÃ¹ng cÃ´ng cá»¥ nhÆ° Optimize.js Ä‘á»ƒ giÃºp parser quyáº¿t Ä‘á»‹nh khi nÃ o nÃªn parse eager &amp; lazy. SessionStack lÃ  cÃ´ng cá»¥ há»— trá»£ tÃ¡i táº¡o láº¡i má»i thá»© xáº£y ra Ä‘á»‘i vá»›i ngÆ°á»i dÃ¹ng cuá»‘i táº¡i thá»i Ä‘iá»ƒm há» gáº·p pháº£i váº¥n Ä‘á» khi Ä‘ang tÆ°Æ¡ng tÃ¡c vá»›i webapp. CÃ´ng cá»¥ nÃ y khÃ´ng dá»±ng láº¡i phiÃªn lÃ m viá»‡c Ä‘Ã³ thÃ nh 1 video tháº­t mÃ  chá»‰ giáº£ láº­p táº¥t cáº£ cÃ¡c sá»± kiá»‡n trong má»™t mÃ´i trÆ°á»ng sandbox trÃªn trÃ¬nh duyá»‡t. Äiá»u nÃ y cÃ³ Ã½ nghÄ©a nháº¥t Ä‘á»‹nh, vÃ­ dá»¥ trong trÆ°á»ng há»£p codebase cá»§a page hiá»‡n táº¡i lá»›n vÃ  phá»©c táº¡p. Nhá»¯ng ká»¹ thuáº­t trÃªn lÃ  nhá»¯ng thá»© mÃ  team tÃ¡c giáº£ gáº§n Ä‘Ã¢y káº¿t há»£p trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn SessionStack. Nhá»¯ng tá»‘i Æ°u hÃ³a Ä‘Ã³ cho phÃ©p há» load SessionStack nhanh hÆ¡n. SessionStack cháº¡y cÃ ng nhanh nÃ³ cÃ ng cÃ³ thá»ƒ giáº£i phÃ³ng tÃ i nguyÃªn cá»§a trÃ¬nh duyá»‡t nhanh hÆ¡n vÃ  mang láº¡i tráº£i nghiá»‡m má»™t cÃ¡ch liÃªn tá»¥c &amp; tá»± nhiÃªn cho ngÆ°á»i dÃ¹ng khi há» load &amp; xem láº¡i cÃ¡c session lÃ m viá»‡c.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P13: BÃªn trong CSS & JS animation & cÃ¡c giáº£i phÃ¡p tá»‘i Æ°u hiá»‡u nÄƒng cá»§a nÃ³","slug":"Cach-Javascript-hoat-dong-P13-Ben-trong-CSS-JS-animation-cac-giai-phap-toi-uu-hieu-nang-cua-no","date":"2018-11-25T09:11:00.000Z","updated":"2018-11-25T09:14:13.336Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P13-Ben-trong-CSS-JS-animation-cac-giai-phap-toi-uu-hieu-nang-cua-no.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P13-Ben-trong-CSS-JS-animation-cac-giai-phap-toi-uu-hieu-nang-cua-no.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 13 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tMá»i ngÆ°á»i Ä‘Ã£ biáº¿t rÃµ animation Ä‘Ã³ng vai trÃ² cáº§n thiáº¿t trong viá»‡c táº¡o ra cÃ¡c webapp háº¥p dáº«n. Khi ngÆ°á»i dÃ¹ng dáº§n dáº§n chuyá»ƒn sá»± chÃº Ã½ cá»§a há» sang UX vÃ  cÃ¡c doanh nghiá»‡p báº¯t Ä‘áº§u nháº­n ra sá»± quan trá»ng cá»§a tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng thÃº vá»‹ &amp; hoÃ n háº£o thÃ¬ cÃ¡c á»©ng dá»¥ng web dáº§n trá»Ÿ nÃªn náº·ng ná» hÆ¡n &amp; cáº§n thá»ƒ hiá»‡n nhiá»u UI Ä‘á»™ng hÆ¡n. Táº¥t cáº£ nhá»¯ng thá»© nÃ y cáº§n Ä‘áº¿n cÃ¡c animation phá»©c táº¡p Ä‘á»ƒ táº¡o ra cÃ¡c chuyá»ƒn dá»‹ch tráº¡ng thÃ¡i mÆ°á»£t mÃ  xuyÃªn suá»‘t hÃ nh trÃ¬nh tráº£i nghiá»‡m cá»§a ngÆ°á»i dÃ¹ng. Giá» Ä‘Ã¢y thÃ¬ Ä‘iá»u Ä‘Ã³ khÃ´ng cÃ²n lÃ  thá»© gÃ¬ Ä‘áº·c biá»‡t ná»¯a. User cÃ ng lÃºc cÃ ng giá»i vÃ  há» mong Ä‘á»£i á»Ÿ nhá»¯ng giao diá»‡n ngÆ°á»i dÃ¹ng cÃ³ tÃ­nh tÆ°Æ¡ng tÃ¡c vÃ  pháº£n há»“i cao. Tuy nhiÃªn animating giao diá»‡n khÃ´ng nháº¥t thiáº¿t pháº£i Ä‘Æ¡n giáº£n, minh báº¡ch. Thá»© gÃ¬ cáº§n Ä‘Æ°á»£c animated, khi nÃ o vÃ  cáº£m giÃ¡c mÃ  má»™t animation mang láº¡i, Ä‘Ã³ má»›i lÃ  nhá»¯ng cÃ¢u há»i khÃ³ tráº£ lá»i.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 13 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. KhÃ¡i quÃ¡tMá»i ngÆ°á»i Ä‘Ã£ biáº¿t rÃµ animation Ä‘Ã³ng vai trÃ² cáº§n thiáº¿t trong viá»‡c táº¡o ra cÃ¡c webapp háº¥p dáº«n. Khi ngÆ°á»i dÃ¹ng dáº§n dáº§n chuyá»ƒn sá»± chÃº Ã½ cá»§a há» sang UX vÃ  cÃ¡c doanh nghiá»‡p báº¯t Ä‘áº§u nháº­n ra sá»± quan trá»ng cá»§a tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng thÃº vá»‹ &amp; hoÃ n háº£o thÃ¬ cÃ¡c á»©ng dá»¥ng web dáº§n trá»Ÿ nÃªn náº·ng ná» hÆ¡n &amp; cáº§n thá»ƒ hiá»‡n nhiá»u UI Ä‘á»™ng hÆ¡n. Táº¥t cáº£ nhá»¯ng thá»© nÃ y cáº§n Ä‘áº¿n cÃ¡c animation phá»©c táº¡p Ä‘á»ƒ táº¡o ra cÃ¡c chuyá»ƒn dá»‹ch tráº¡ng thÃ¡i mÆ°á»£t mÃ  xuyÃªn suá»‘t hÃ nh trÃ¬nh tráº£i nghiá»‡m cá»§a ngÆ°á»i dÃ¹ng. Giá» Ä‘Ã¢y thÃ¬ Ä‘iá»u Ä‘Ã³ khÃ´ng cÃ²n lÃ  thá»© gÃ¬ Ä‘áº·c biá»‡t ná»¯a. User cÃ ng lÃºc cÃ ng giá»i vÃ  há» mong Ä‘á»£i á»Ÿ nhá»¯ng giao diá»‡n ngÆ°á»i dÃ¹ng cÃ³ tÃ­nh tÆ°Æ¡ng tÃ¡c vÃ  pháº£n há»“i cao. Tuy nhiÃªn animating giao diá»‡n khÃ´ng nháº¥t thiáº¿t pháº£i Ä‘Æ¡n giáº£n, minh báº¡ch. Thá»© gÃ¬ cáº§n Ä‘Æ°á»£c animated, khi nÃ o vÃ  cáº£m giÃ¡c mÃ  má»™t animation mang láº¡i, Ä‘Ã³ má»›i lÃ  nhá»¯ng cÃ¢u há»i khÃ³ tráº£ lá»i. So sÃ¡nh Javascript &amp; CSS animationCÃ³ 2 phÆ°Æ¡ng phÃ¡p chÃ­nh Ä‘á»ƒ táº¡o web animation lÃ  dÃ¹ng Javascript hoáº·c CSS. KhÃ´ng cÃ³ lá»±a chá»n nÃ o Ä‘Ãºng hay sai cáº£, táº¥t cáº£ tÃ¹y thuá»™c vÃ o thá»© mÃ  báº¡n muá»‘n Ä‘áº¡t Ä‘Æ°á»£c. Animate vá»›i CSSAnimating vá»›i CSS lÃ  cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t Ä‘á»ƒ lÃ m má»™t thá»© gÃ¬ Ä‘Ã³ chuyá»ƒn Ä‘á»™ng trÃªn mÃ n hÃ¬nh. ChÃºng ta sáº½ báº¯t Ä‘áº§u vá»›i má»™t vÃ­ dá»¥ nhanh vá» viá»‡c di chuyá»ƒn má»™t pháº§n tá»­ 50px theo cáº£ 2 trá»¥c X vÃ  Y. CÃ³ thá»ƒ thá»±c hiá»‡n báº±ng cÃ¡ch Ä‘áº·t má»™t CSS transition vá»›i thá»i gian 1000ms. 123456789101112.box &#123; -webkit-transform: translate(0, 0); -webkit-transition: -webkit-transform 1000ms; transform: translate(0, 0); transition: transform 1000ms;&#125;.box.move &#123; -webkit-transform: translate(50px, 50px); transform: translate(50px, 50px);&#125; Khi class move Ä‘Æ°á»£c thÃªm vÃ o, giÃ¡ trá»‹ transform bá»‹ thay Ä‘á»•i vÃ  transition báº¯t Ä‘áº§u. BÃªn cáº¡nh transition duration (thá»i gian dá»‹ch chuyá»ƒn), cÃ³ nhá»¯ng tÃ¹y chá»n cho easing, vá» báº£n cháº¥t thÃ¬ Ä‘Ã¢y lÃ  cáº£m giÃ¡c cá»§a animation. ChÃºng ta sáº½ tÃ¬m hiá»ƒu easing chi tiáº¿t hÆ¡n trong cÃ¡c pháº§n sau cá»§a bÃ i viáº¿t nÃ y. Náº¿u nhÆ° trong Ä‘oáº¡n code trÃªn, báº¡n táº¡o ra nhá»¯ng class CSS riÃªng biá»‡t Ä‘á»ƒ quáº£n lÃ½ animation thÃ¬ báº¡n cÃ³ thá»ƒ dÃ¹ng Javascript Ä‘á»ƒ táº¯t/má»Ÿ má»—i animation. Náº¿u nhÆ° báº¡n cÃ³ pháº§n tá»­ sau: 123&lt;div class=\"box\"&gt; Sample content.&lt;/div&gt; Báº¡n cÃ³ thá»ƒ dÃ¹ng Javascript Ä‘á»ƒ táº¯t/má»Ÿ animation cá»§a nÃ³: 1234567var boxElements = document.getElementsByClassName('box'), boxElementsLength = boxElements.length, i;for (i = 0; i &lt; boxElementsLength; i++) &#123; boxElements[i].classList.add('move');&#125; Äoáº¡n code trÃªn láº¥y táº¥t cáº£ nhá»¯ng pháº§n tá»­ cÃ³ class box vÃ  thÃªm class move vÃ o Ä‘á»ƒ trigger animation. LÃ m nhÆ° tháº¿ nÃ y táº¡o sá»± cÃ¢n báº±ng cho app cá»§a báº¡n. Báº¡n cÃ³ thá»ƒ táº­p trung vÃ o quáº£n lÃ½ tráº¡ng thÃ¡i vá»›i Javascript vÃ  chá»‰ cáº§n Ä‘Æ¡n giáº£n Ä‘áº·t nhá»¯ng class thÃ­ch há»£p vÃ o pháº§n tá»­ cáº§n pháº£i Ä‘áº·t, Ä‘á»ƒ cho trÃ¬nh duyá»‡t xá»­ lÃ½ cÃ¡c animation. Náº¿u báº¡n tiáº¿p tá»¥c tÃ¬m hiá»ƒu theo hÆ°á»›ng nÃ y, báº¡n cÃ³ thá»ƒ listen sá»± kiá»‡n transitioned trÃªn má»—i pháº§n tá»­, nhÆ°ng chá»‰ náº¿u nhÆ° báº¡n pháº£i support cho máº¥y phiÃªn báº£n cÅ© cá»§a IE: Listen sá»± kiá»‡n transitioned (Ä‘Æ°á»£c báº¯n ra táº¡i cuá»‘i thá»i Ä‘iá»ƒm transition) giá»‘ng nhÆ° tháº¿ nÃ y: 123456var boxElement = document.querySelector('.box'); // Láº¥y pháº§n tá»­ Ä‘áº§u tiÃªn cÃ³ class `box`boxElement.addEventListener('transitionend', onTransitionEnd, false);function onTransitionEnd() &#123; // Xá»­ lÃ½ sá»± kiá»‡n transition Ä‘Ã£ hoÃ n thÃ nh.&#125; ThÃªm ná»¯a, khi sá»­ dá»¥ng CSS transition, báº¡n cÃ³ thá»ƒ dÃ¹ng CSS animation, nÃ³ cho phÃ©p báº¡n cÃ³ quyá»n nhiá»u hÆ¡n Ä‘á»ƒ kiá»ƒm soÃ¡t má»—i animation keyframe, duration vÃ  iteration. Keyframes Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ hÆ°á»›ng dáº«n chá»‰ Ä‘á»‹nh trÃ¬nh duyá»‡t nhá»¯ng giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh CSS cáº§n pháº£i cÃ³ táº¡i má»—i thá»i Ä‘iá»ƒm nháº¥t Ä‘á»‹nh vÃ  nÃ³ sáº½ giÃºp xá»­ lÃ½ pháº§n cÃ²n láº¡i. VÃ­ dá»¥: 123456789101112131415161718192021222324252627282930313233343536373839/** * ÄÃ¢y lÃ  phiÃªn báº£n Ä‘Æ¡n giáº£n, khÃ´ng cÃ³ * tiá»n tá»‘ vendor. Náº¿u cÃ³ thÃªm chÃºng thÃ¬ * sáº½ cÃ²n dÃ i dÃ²ng hÆ¡n ná»¯a. */.box &#123; /* Chá»n animation */ animation-name: movingBox; /* duration cá»§a animation */ animation-duration: 2300ms; /* sá»‘ láº§n mÃ  ta muá»‘n animation cháº¡y */ animation-iteration-count: infinite; /* lÃ m cho animation Ä‘áº£o ngÆ°á»£c vÃ o má»—i vÃ²ng láº·p láº» */ animation-direction: alternate;&#125;@keyframes movingBox &#123; 0% &#123; transform: translate(0, 0); opacity: 0.4; &#125; 25% &#123; opacity: 0.9; &#125; 50% &#123; transform: translate(150px, 200px); opacity: 0.2; &#125; 100% &#123; transform: translate(40px, 30px); opacity: 0.8; &#125;&#125; Animation trÃ´ng nhÆ° tháº¿ nÃ y Ä‘Ã¢y: https://sessionstack.github.io/blog/demos/keyframes/ Vá»›i CSS animation, báº¡n Ä‘á»‹nh nghÄ©a chÃ­nh animation Ä‘á»™c láº­p vá»›i pháº§n tá»­ Ä‘Ã­ch vÃ  sá»­ dá»¥ng thuá»™c tÃ­nh animation-name Ä‘á»ƒ chá»n animation Ä‘Æ°á»£c yÃªu cáº§u. CÃ¡c CSS animation pháº§n nÃ o Ä‘Æ°á»£c Ä‘áº·t sáºµn tiá»n tá»‘ vender, vá»›i -webkit- Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng trong Safari, Safari Mobile vÃ  Android. Chrome, Opera, Internet Explorer vÃ  Firefox táº¥t cáº£ Ä‘á»u khÃ´ng cÃ³ sáºµn tiá»n tá»‘. Nhiá»u cÃ´ng cá»¥ cÃ³ thá»ƒ giÃºp báº¡n thÃªm phiÃªn báº£n tiá»n tá»‘ cá»§a CSS mÃ  báº¡n cáº§n, cho phÃ©p báº¡n viáº¿t code mÃ  khÃ´ng cáº§n pháº£i thÃªm tiá»n tá»‘. Animate vá»›i JavascriptTáº¡o animation vá»›i Javascript phá»©c táº¡p hÆ¡n nhiá»u so vá»›i sá»­ dá»¥ng CSS transition hay animation nhÆ°ng thÆ°á»ng thÃ¬ nÃ³ cung cáº¥p cho developer nhiá»u sá»©c máº¡nh Ä‘Ã¡ng ká»ƒ. Javascript animation Ä‘Æ°á»£c viáº¿t ná»™i tuyáº¿n nhÆ° lÃ  1 pháº§n cá»§a code. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘Ã³ng gÃ³i nÃ³ bÃªn trong cÃ¡c object. BÃªn dÆ°á»›i lÃ  code Javascript mÃ  báº¡n cáº§n Ä‘á»ƒ viáº¿t láº¡i Ä‘oáº¡n CSS transition á»Ÿ pháº§n trÃªn: 12345678var boxElement = document.querySelector('.box');var animation = boxElement.animate([ &#123;transform: 'translate(0)'&#125;, &#123;transform: 'translate(150px, 200px)'&#125;], 500);animation.addEventListener('finish', function() &#123; boxElement.style.transform = 'translate(150px, 200px)';&#125;); Máº·c Ä‘á»‹nh thÃ¬ Web Animation chá»‰ chá»‰nh sá»­a pháº§n trÃ¬nh bÃ y cá»§a má»™t pháº§n tá»­. Náº¿u nhÆ° báº¡n muá»‘n object cá»§a mÃ¬nh váº«n giá»¯ nguyÃªn vá»‹ trÃ­ lÃºc nÃ³ Ä‘Æ°á»£c di chuyá»ƒn tá»›i thÃ¬ báº¡n nÃªn sá»­a láº¡i style cá»§a nÃ³ khi animation káº¿t thÃºc. ÄÃ¢y lÃ  lÃ½ do táº¡i sao chÃºng ta listen sá»± kiá»‡n finish trong code trÃªn, Ä‘áº·t thuá»™c tÃ­nh box.style.transform báº±ng giÃ¡ trá»‹ translate(150px, 200px) thÃ¬ nÃ³ sáº½ thá»ƒ hiá»‡n giá»‘ng nhÆ° trÆ°á»ng há»£p transform thá»© 2 trong CSS animation á»Ÿ trÃªn. Vá»›i Javascript animation, báº¡n hoÃ n toÃ n kiá»ƒm soÃ¡t style cá»§a pháº§n tá»­ táº¡i thá»i Ä‘iá»ƒm báº¥t ká»³. NghÄ©a lÃ  báº¡n cÃ³ thá»ƒ lÃ m animation cháº­m láº¡i, táº¡m ngÆ°ng, dá»«ng háº³n, Ä‘áº£o ngÆ°á»£c vÃ  Ä‘iá»u khiá»ƒn pháº§n tá»­ cho tá»›i khi phÃ¹ há»£p. Äiá»u nÃ y cá»±c ká»³ há»¯u Ã­ch náº¿u báº¡n muá»‘n xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng phá»©c táº¡p bá»Ÿi vÃ¬ báº¡n cÃ³ thá»ƒ Ä‘Ã³ng gÃ³i cÃ¡c hÃ nh vi cá»§a app má»™t cÃ¡ch chÃ­nh xÃ¡c. Easing lÃ  gÃ¬?Chuyá»ƒn Ä‘á»™ng tá»± nhiÃªn lÃ m cho user cáº£m tháº¥y dá»… chá»‹u hÆ¡n vá»›i webapp cá»§a báº¡n vÃ  mang Ä‘áº¿n tráº£i nghiá»‡m UX tá»‘t hÆ¡n. Má»™t cÃ¡ch tá»± nhiÃªn, khÃ´ng cÃ³ thá»© gÃ¬ di chuyá»ƒn theo Ä‘Æ°á»ng tháº³ng tá»« Ä‘iá»ƒm nÃ y Ä‘áº¿n Ä‘iá»ƒm khÃ¡c. Tháº­t ra thÃ¬ má»i thá»© Ä‘á»u cÃ³ xu hÆ°á»›ng tÄƒng tá»‘c vÃ  giáº£m tá»‘c khi chÃºng di chuyá»ƒn trong tháº¿ giá»›i váº­t lÃ½ cá»§a chÃºng ta vÃ  cÃ³ ráº¥t nhiá»u yáº¿u tá»‘ khÃ¡c nhau áº£nh hÆ°á»Ÿng. Bá»™ nÃ£o con ngÆ°á»i Ä‘Æ°á»£c thiáº¿t káº¿ báº©m sinh Ä‘á»ƒ cáº£m nháº­n nhá»¯ng chuyá»ƒn Ä‘á»™ng nÃªn khi báº¡n thá»±c hiá»‡n animation trÃªn webapp hÃ£y nhá»› nhá»¯ng kiáº¿n thá»©c nÃ y. Má»™t vÃ i thuáº­t ngá»¯ báº¡n cáº§n hiá»ƒu: ease in: lÃ  khi chuyá»ƒn Ä‘á»™ng báº¯t Ä‘áº§u cháº­m vÃ  tÄƒng tá»‘c dáº§n lÃªn. ease out: chuyá»ƒn Ä‘á»™ng báº¯t Ä‘áº§u nhanh vÃ  giáº£m tá»‘c dáº§n. Easing cho phÃ©p báº¡n táº¡o cÃ¡c animation cho cáº£m giÃ¡c tá»± nhiÃªn hÆ¡n. CÃ¡c tá»« khÃ³a cho easingCSS transition vÃ  animation cho phÃ©p báº¡n chá»n loáº¡i easing mÃ  báº¡n muá»‘n. CÃ³ nhiá»u tá»« khÃ³a khÃ¡c nhau áº£nh hÆ°á»Ÿng Ä‘áº¿n easing cá»§a animation. Báº¡n cÅ©ng cÃ³ thá»ƒ táº¡o ra easing hoÃ n toÃ n cá»§a riÃªng báº¡n. DÆ°á»›i Ä‘Ã¢y lÃ  1 sá»‘ tá»« khÃ³a báº¡n cÃ³ thá»ƒ dÃ¹ng trong CSS Ä‘á»ƒ Ä‘iá»u khiá»ƒn easing: linear ease-in ease-out ease-in-out Giá» thÃ¬ cÃ¹ng tÃ¬m hiá»ƒu vá» chÃºng nÃ o. Linear animationCÃ¡c animation khÃ´ng cÃ³ báº¥t cá»© kiá»ƒu easing nÃ o thÃ¬ Ä‘Æ°á»£c gá»i lÃ  linear (tháº³ng hÃ ng, cÃ²n hÃ n lÃ¢m hÆ¡n thÃ¬ â€œTuyáº¿n tÃ­nhâ€).Äá»“ thá»‹ thá»ƒ hiá»‡n má»™t linear animation: Thá»i gian cÃ ng tÄƒng thÃ¬ giÃ¡ trá»‹ cÅ©ng tÄƒng vá»›i lÆ°á»£ng tÆ°Æ¡ng á»©ng. Vá»›i chuyá»ƒn Ä‘á»™ng linear, má»i thá»© cÃ³ xu hÆ°á»›ng thiáº¿u tá»± nhiÃªn. NÃ³i chung báº¡n nÃªn trÃ¡nh sá»­ dá»¥ng chuyá»ƒn Ä‘á»™ng linear. ÄÃ¢y lÃ  cÃ¡ch triá»ƒn khai má»™t linear animation Ä‘Æ¡n giáº£n: 1transition: transform 500ms linear; Ease-out animationNhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, ease out lÃ m cho animation báº¯t Ä‘áº§u nhanh hÆ¡n so vá»›i kiá»ƒu linear trong khi Ä‘Ã³ nÃ³ láº¡i cháº­m dáº§n khi káº¿t thÃºc. Äá»“ thá»‹ trÃ´ng nhÆ° tháº¿ nÃ y: NhÃ¬n chung, ease out lÃ  sá»± lá»±a chá»n tá»‘t nháº¥t cho UI bá»Ÿi vÃ¬ khá»Ÿi Ä‘á»™ng nhanh lÃ m cho animation cá»§a báº¡n cÃ³ cáº£m giÃ¡c pháº£n há»“i tá»‘t trong khi cháº­m dáº§n khi káº¿t thÃºc mang láº¡i cáº£m giÃ¡c tá»± nhiÃªn do sá»± chuyá»ƒn Ä‘á»™ng khÃ´ng Ä‘á»“ng nháº¥t. CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ triá»ƒn khai hiá»‡u á»©ng ease out nhÆ°ng cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t lÃ  tá»« khÃ³a ease-out trong CSS: 1transition: transform 500ms ease-out; Ease-in animationÄÃ¢y lÃ  kiá»ƒu Ä‘á»‘i láº­p láº¡i vá»›i ease-out animation: báº¯t Ä‘áº§u cháº­m cháº¡p vÃ  káº¿t thÃºc nhanh. Äá»“ thá»‹ mÃ´ táº£: So vá»›i ease-out animation thÃ¬ ease-in cÃ³ hÆ¡i khÃ´ng bÃ¬nh thÆ°á»ng vÃ¬ chÃºng táº¡o ra cáº£m giÃ¡c thiáº¿u sá»± pháº£n há»“i, bá»Ÿi vÃ¬ chÃºng khá»Ÿi Ä‘á»™ng cháº­m. Káº¿t thÃºc nhanh cÃ³ thá»ƒ cÅ©ng táº¡o ra cáº£m giÃ¡c láº¡ tÆ°Æ¡ng tá»±, toÃ n bá»™ animation Ä‘á»u tÄƒng tá»‘c trong khi Ä‘á»‘i tÆ°á»£ng á»Ÿ tháº¿ giá»›i thá»±c cÃ³ xu hÆ°á»›ng giáº£m tá»‘c khi dá»«ng láº¡i Ä‘á»™t ngá»™t. Äá»ƒ dÃ¹ng ease-in animation thÃ¬ báº¡n cÃ³ thá»ƒ dÃ¹ng tá»« khÃ³a tÆ°Æ¡ng tá»± nhÆ° trÃªn: 1transition: transform 500ms ease-in; Ease-in-out animationÄÃ¢y lÃ  animation káº¿t há»£p cá»§a ease-in vÃ  ease-out. Äá»“ thá»‹: KhÃ´ng nÃªn sá»­ dá»¥ng anmation-duration quÃ¡ lÃ¢u bá»Ÿi vÃ¬ nÃ³ mang láº¡i cáº£m giÃ¡c ráº±ng UI cá»§a báº¡n thiáº¿u sá»± pháº£n há»“i. CÃ¡ch sá»­ dá»¥ng ease-in-out animation: 1transition: transform 500ms ease-in-out; TÃ¹y biáº¿n easingBáº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a Ä‘Æ°á»ng cung easing cho riÃªng báº¡n Ä‘á»ƒ cÃ³ thá»ƒ kiá»ƒm soÃ¡t nhiá»u hÆ¡n nhá»¯ng cáº£m giÃ¡c mÃ  animation cÃ³ thá»ƒ táº¡o ra. TrÃªn thá»±c táº¿, cÃ¡c tá»« khÃ³a ease-in, ease-out, liner, ease Ä‘Æ°á»£c ná»‘i vá»›i nhá»¯ng Ä‘Æ°á»ng cung Bezier (BÃ©zier curves) Ä‘Ã£ Ä‘á»‹nh nghÄ©a sáºµn, báº¡n cÃ³ thá»ƒ xem chi tiáº¿t á»Ÿ ThÃ´ng sá»‘ ká»¹ thuáº­t cá»§a CSS transition hoáº·c cá»§a Web Animation ÄÆ°á»ng cung BezierCÃ¹ng tÃ¬m hiá»ƒu vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Ä‘Æ°á»ng cung Bezier nÃ o.Má»™t cung Bezier nháº­n 4 giÃ¡ trá»‹, hoáº·c nÃ³i rÃµ hÆ¡n thÃ¬ nÃ³ nháº­n vÃ o 2 cáº·p sá»‘. Má»—i cáº·p Ä‘á»‹nh nghÄ©a tá»a Ä‘á»™ X vÃ  Y cá»§a 1 Ä‘iá»ƒm kiá»ƒm soÃ¡t thuá»™c khá»‘i cung Bezier. Äiá»ƒm báº¯t Ä‘áº§u cá»§a cung Bezier cÃ³ tá»a Ä‘á»™ (0, 0) vÃ  káº¿t thÃºc lÃ  á»Ÿ (1, 1). Báº¡n cÃ³ thá»ƒ Ä‘áº·t cáº£ 2 cáº·p sá»‘. GiÃ¡ trá»‹ X cho 2 kiá»ƒm kiá»ƒm soÃ¡t pháº£i náº±m trong khoáº£ng [0, 1] cÃ²n giÃ¡ trá»‹ cá»§a Y thÃ¬ cÃ³ thá»ƒ vÆ°á»£t quÃ¡ giá»›i háº¡n [0, 1], máº·c dÃ¹ thÃ´ng sá»‘ ká»¹ thuáº­t khÃ´ng nÃ³i rÃµ lÃ  bao nhiÃªu. Ká»ƒ cáº£ nhá»¯ng thay Ä‘á»•i nhá» trong giÃ¡ trá»‹ X vÃ  Y cá»§a má»—i Ä‘iá»ƒm kiá»ƒm soÃ¡t mang Ä‘áº¿n cho báº¡n má»™t cung hoÃ n toÃ n khÃ¡c biá»‡t. á» 2 Ä‘á»“ thá»‹ bÃªn dÆ°á»›i, cung Bezier cÃ³ cÃ¡c Ä‘iá»ƒm gáº§n nhau nhÆ°ng khÃ¡c tá»a Ä‘á»™. vÃ  NhÆ° báº¡n tháº¥y thÃ¬ Ä‘á»“ thá»‹ khÃ¡ lÃ  khÃ¡c nhau. Äiá»ƒm kiá»ƒm soÃ¡t Ä‘áº§u tiÃªn cÃ³ vector vá»›i giÃ¡ trá»‹ sai khÃ¡c lÃ  (0.045, 0.183) cÃ²n Ä‘iá»ƒm thá»© 2 lÃ  (-0.427, -0.054) CÃ²n Ä‘Ã¢y lÃ  pháº§n CSS cho Ä‘Æ°á»ng cung thá»© 2: 1transition: transform 500ms cubic-bezier(0.465, 0.183, 0.153, 0.946); 2 sá»‘ Ä‘áº§u tiÃªn lÃ  tá»a Ä‘á»™ X vÃ  Y cá»§a Ä‘iá»ƒm kiá»ƒm soÃ¡t thá»© nháº¥t, 2 sá»‘ tiáº¿p theo lÃ  cá»§a Ä‘iá»ƒm kiá»ƒm soÃ¡t thá»© 2. Tá»‘i Æ°u hÃ³a hiá»‡u nÄƒngBáº¡n cáº§n pháº£i duy trÃ¬ 60 khung hÃ¬nh/giÃ¢y (60 fps - game thá»§ hiá»ƒu cÃ¡i nÃ y láº¯m nÃ¨ :D) khi lÃ m animation náº¿u khÃ´ng thÃ¬ nÃ³ sáº½ áº£nh hÆ°á»Ÿng tiÃªu cá»±c Ä‘áº¿n UX. VÃ  nhÆ° 1 láº½ dÄ© nhiÃªn thÃ¬ animation khÃ´ng há» miá»…n phÃ­. KhÃ´ng pháº£i lÃ  chuyá»‡n tiá»n nong, mÃ  lÃ  hiá»‡u nÄƒng. Animate má»™t vÃ i thuá»™c tÃ­nh cÃ³ thá»ƒ khÃ´ng tá»‘n kÃ©m nhÆ° má»™t sá»‘ khÃ¡c. VÃ­ dá»¥: animate width vÃ  height cá»§a 1 pháº§n tá»­ sáº½ thay Ä‘á»•i tráº¡ng thÃ¡i hÃ¬nh há»c cá»§a nÃ³ vÃ  lÃ  nguyÃªn nhÃ¢n áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c pháº§n tá»­ khÃ¡c trÃªn trang bá»‹ thay Ä‘á»•i vá»‹ trÃ­ hoáº·c kÃ­ch thÆ°á»›c. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  layout. ChÃºng ta cÅ©ng Ä‘Ã£ tháº£o luáº­n chi tiáº¿t vá» layout vÃ  rendering trong bÃ i trÆ°á»›c rá»“i. NÃ³i chung, báº¡n cáº§n trÃ¡nh animate nhá»¯ng thuá»™c tÃ­nh nÃ o cÃ³ thá»ƒ trigger quÃ¡ trÃ¬nh layout hoáº·c tÃ´ mÃ u (paint). Vá»›i Ä‘a sá»‘ cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i thÃ¬ Ä‘iá»u nÃ y nghÄ©a lÃ  háº¡n cháº¿ animation vá»›i opacity vÃ  transform Will-changeBáº¡n cÃ³ thá»ƒ dÃ¹ng will-change Ä‘á»ƒ thÃ´ng bÃ¡o cho trÃ¬nh duyá»‡t biáº¿t báº¡n cÃ³ Ã½ Ä‘á»‹nh thay Ä‘á»•i thuá»™c tÃ­nh cá»§a 1 pháº§n tá»­. NÃ³ cho phÃ©p trÃ¬nh duyá»‡t cÃ i Ä‘áº·t sáºµn sÃ ng trÆ°á»›c nhá»¯ng tá»‘i hÆ°u hÃ³a thÃ­ch há»£p nháº¥t khi báº¡n cáº§n thay Ä‘á»•i. Tuy nhiÃªn cÅ©ng Ä‘á»«ng láº¡m dá»¥ng will-change, bá»Ÿi vÃ¬ lÃ m nhÆ° tháº¿ cÃ³ thá»ƒ lÃ m cho trÃ¬nh duyá»‡t hao tá»‘n tÃ i nguyÃªn vÃ  quay ngÆ°á»£c láº¡i gÃ¢y ra nhiá»u váº¥n Ä‘á» hÆ¡n vá» hiá»‡u nÄƒng. CÃ¡ch Ä‘á»ƒ thÃªm will-change cho transform vÃ  opacity: 123.box &#123; will-change: transform, opacity;&#125; TrÃ¬nh duyá»‡t há»— trá»£: Chá»n Javascript hay CSSCÃ³ láº½ báº¡n cÅ©ng Ä‘Ã£ tháº¥y ráº±ng khÃ´ng cÃ³ cÃ¢u tráº£ lá»i Ä‘Ãºng cho cÃ¢u há»i nÃ y, tÃ¹y thuá»™c vÃ o nhiá»u yáº¿u tá»‘, dÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng thá»© báº¡n cáº§n cÃ¢n nháº¯c má»—i khi lá»±a chá»n: CÃ¡c animation dá»±a trÃªn CSS vÃ  Web Animation Ä‘Æ°á»£c há»— trá»£ native vÃ  Ä‘Æ°á»£c xá»­ lÃ½ trong tiáº¿n trÃ¬nh gá»i lÃ  â€œtiáº¿n trÃ¬nh tá»•ng há»£pâ€ (compositor thread). KhÃ¡c vá»›i â€œtiáº¿n trÃ¬nh chÃ­nhâ€ cá»§a trÃ¬nh duyá»‡t, nÆ¡i mÃ  styling, layout, painting vÃ  code Javascript Ä‘Æ°á»£c thá»±c thi. NghÄ©a lÃ  náº¿u nhÆ° trÃ¬nh duyá»‡t Ä‘ang báº­n xá»­ lÃ½ 1 sá»‘ tÃ¡c vá»¥ náº·ng kÃ½ trÃªn tiáº¿n trÃ¬nh chÃ­nh thÃ¬ nhá»¯ng animation Ä‘Ã³ váº«n cÃ³ thá»ƒ tiáº¿p tá»¥c thá»±c hiá»‡n mÃ  khÃ´ng bá»‹ can thiá»‡p. Trong má»™t vÃ i trÆ°á»ng há»£p. cÃ¡c thay Ä‘á»•i Ä‘á»‘i vá»›i transform vÃ  opacity cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi tiáº¿n trÃ¬nh tá»•ng há»£p. Náº¿u animation trigger paint, layout hoáº·c cáº£ 2 thÃ¬ tiáº¿n trÃ¬nh chÃ­nh sáº½ cáº§n pháº£i tham gia xá»­ lÃ½. TrÆ°á»ng há»£p nÃ y xáº£y ra cho cáº£ CSS vÃ  Javascript animation, vÃ  dÄ© nhiÃªn lÃ  viá»‡c thá»±c hiá»‡n layout hoáº·c paint nhÆ° váº­y sáº½ lÃ m cháº­m báº¥t ká»³ tÃ¡c vá»¥ nÃ o liÃªn quan Ä‘áº¿n thá»±c thi CSS hay Javascript Chá»n Ä‘Ãºng thá»© Ä‘á»ƒ animateNhá»¯ng animation tuyá»‡t vá»i thÆ°á»ng táº¡o nÃªn sá»± thÃ­ch thÃº vÃ  gáº¯n káº¿t giá»¯a project cá»§a báº¡n vá»›i ngÆ°á»i dÃ¹ng. Báº¡n cÃ³ thá»ƒ animate báº¥t cá»© thá»© gÃ¬ báº¡n muá»‘n, dÃ¹ lÃ  width, height, position, color, background, vÃ¢n vÃ¢n, nhÆ°ng cáº§n pháº£i chÃº Ã½ Ä‘áº¿n nhá»¯ng nÃºt tháº¯t cá»• chai tiá»m tÃ ng vá» hiá»‡u nÄƒng. Nhá»¯ng animation Ä‘Æ°á»£c chá»n lá»±a 1 cÃ¡ch báº¥t cáº©n cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng tiÃªu cá»±c Ä‘áº¿n UX, vÃ¬ váº­y animation cáº§n pháº£i vá»«a phÃ¹ há»£p vá»«a tá»‘t cho hiá»‡u nÄƒng. Animate cÃ ng Ã­t cÃ ng tá»‘t, chá»‰ nÃªn animate khi báº¡n cáº§n UX trá»Ÿ nÃªn tá»± nhiÃªn hÆ¡n nhÆ°ng Ä‘á»«ng láº¡m dá»¥ng nÃ³. DÃ¹ng animation Ä‘á»ƒ há»— trá»£ tÆ°Æ¡ng tÃ¡cKhÃ´ng nÃªn animate chá»‰ vÃ¬ báº¡n thÃ­ch tháº¿. Thay vÃ¬ váº­y, sá»­ dá»¥ng animation táº¡i nhá»¯ng vá»‹ trÃ­ chiáº¿n lÆ°á»£c Ä‘á»ƒ cá»§ng cá»‘ thÃªm vá» tÆ°Æ¡ng tÃ¡c ngÆ°á»i dÃ¹ng. TrÃ¡nh animation lÃ m ngáº¯t quÃ£ng hoáº·c cáº£n trá»Ÿ má»™t cÃ¡ch khÃ´ng cáº§n thiáº¿t cÃ¡c hoáº¡t Ä‘á»™ng cá»§a user TrÃ¡nh animate nhá»¯ng thuá»™c tÃ­nh phá»©c táº¡pChá»‰ cÃ³ duy nháº¥t 1 thá»© tá»‡ hÆ¡n cáº£ animation Ä‘áº·t sai chá»— chÃ­nh lÃ  nhá»¯ng animation lÃ m cho trang web bá»‹ lag. Kiá»ƒu animation nÃ y lÃ m cho user cáº£m tháº¥y bá»±c bá»™i vÃ  chÃ¡n náº£n. Team tÃ¡c giáº£ sá»­ dá»¥ng animation khÃ¡ dá»… dÃ ng vá»›i SessionStack. NÃ³i chung, há» theo sÃ¡t nhá»¯ng nguyÃªn táº¯c Ä‘Ã£ nÃªu á»Ÿ trÃªn nhÆ°ng cÅ©ng cÃ³ má»™t sá»‘ trÆ°á»ng há»£p mÃ  há» pháº£i dÃ¹ng animation vÃ¬ sá»± phá»©c táº¡p cá»§a UI. SessionStack pháº£i tÃ¡i táº¡o láº¡i dÆ°á»›i dáº¡ng video toÃ n bá»™ nhá»¯ng thá»© xáº£y ra vá»›i ngÆ°á»i dÃ¹ng cuá»‘i táº¡i thá»i Ä‘iá»ƒm há» gáº·p pháº£i váº¥n Ä‘á» khi Ä‘ang lÆ°á»›t web hay dÃ¹ng webapp. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y SessionStack táº­n dá»¥ng duy nháº¥t nhá»¯ng dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c xuyÃªn suá»‘t phiÃªn lÃ m viá»‡c: sá»± kiá»‡n tá»« user, thay Ä‘á»•i trÃªn DOM, request máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o debug, vÃ¢n vÃ¢n. TrÃ¬nh chÆ¡i cá»§a há» Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a khÃ¡ tá»‘t Ä‘á»ƒ cÃ³ thá»ƒ render má»™t cÃ¡ch chÃ­nh xÃ¡c vÃ  sá»­ dá»¥ng toÃ n bá»™ dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c Ä‘á»ƒ giáº£ láº­p chÃ­nh xÃ¡c Ä‘áº¿n tá»«ng pixel trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng vÃ  nhá»¯ng thá»© xáº£y ra trÃªn nÃ³, cáº£ vá» khÃ­a cáº¡nh nhÃ¬n tháº¥y Ä‘Æ°á»£c vÃ  gÃ³c nhÃ¬n ká»¹ thuáº­t. Äá»ƒ Ä‘áº£m báº£o quÃ¡ trÃ¬nh tÃ¡i táº¡o diá»…n ra má»™t cÃ¡ch tá»± nhiÃªn, Ä‘áº·c biá»‡t vá»›i nhá»¯ng phiÃªn lÃ m viá»‡c kÃ©o dÃ i vÃ  náº·ng dá»¯ liá»‡u, team tÃ¡c giáº£ sá»­ dá»¥ng cÃ¡c animation Ä‘á»ƒ chá»‰ Ä‘á»‹nh chÃ­nh xÃ¡c hoáº¡t Ä‘á»™ng loading/buffering vÃ  bÃ¡m sÃ¡t cÃ¡c nguyÃªn táº¯c tá»‘t nháº¥t Ä‘á»ƒ triá»ƒn khai chÃºng, do Ä‘Ã³ há» khÃ´ng cáº§n quÃ¡ nhiá»u CPU vÃ  váº«n cÃ³ thá»ƒ Ä‘á»ƒ cho event loop Ä‘Æ°á»£c ráº£nh tay render cÃ¡c session.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P12: BÃªn trong lá»›p Network + LÃ m sao Ä‘á»ƒ tá»‘i Æ°u hÃ³a hiá»‡u nÄƒng vÃ  báº£o máº­t Javascript","slug":"Cach-Javascript-hoat-dong-P12-Ben-trong-lop-Network-Lam-sao-de-toi-uu-hoa-hieu-nang-va-bao-mat-Javascript","date":"2018-11-25T09:06:00.000Z","updated":"2018-11-25T09:10:31.361Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P12-Ben-trong-lop-Network-Lam-sao-de-toi-uu-hoa-hieu-nang-va-bao-mat-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P12-Ben-trong-lop-Network-Lam-sao-de-toi-uu-hoa-hieu-nang-va-bao-mat-Javascript.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 12 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. NhÆ° Ä‘Ã£ nÃ³i trong bÃ i trÆ°á»›c vá» render engine, tÃ¡c giáº£ bÃ i viáº¿t tin ráº±ng sá»± khÃ¡c biá»‡t giá»¯a má»™t Javascript developer tá»‘t (good) vÃ  tuyá»‡t vá»i (great) lÃ  dev tuyá»‡t vá»i khÃ´ng nhá»¯ng hiá»ƒu vá» cÃ¡c thÃ nh pháº§n cÆ¡ báº£n cá»§a má»™t ngÃ´n ngá»¯ mÃ  cÃ²n cáº£ pháº§n cá»‘t lÃµi cÅ©ng nhÆ° mÃ´i trÆ°á»ng xung quanh nÃ³.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 12 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. NhÆ° Ä‘Ã£ nÃ³i trong bÃ i trÆ°á»›c vá» render engine, tÃ¡c giáº£ bÃ i viáº¿t tin ráº±ng sá»± khÃ¡c biá»‡t giá»¯a má»™t Javascript developer tá»‘t (good) vÃ  tuyá»‡t vá»i (great) lÃ  dev tuyá»‡t vá»i khÃ´ng nhá»¯ng hiá»ƒu vá» cÃ¡c thÃ nh pháº§n cÆ¡ báº£n cá»§a má»™t ngÃ´n ngá»¯ mÃ  cÃ²n cáº£ pháº§n cá»‘t lÃµi cÅ©ng nhÆ° mÃ´i trÆ°á»ng xung quanh nÃ³. Nháº¯c sÆ¡ qua vá» lá»‹ch sá»­ má»™t chÃºt49 nÄƒm trÆ°á»›c, má»™t thá»© gá»i lÃ  ARPAnet Ä‘Æ°á»£c táº¡o ra. NÃ³ chÃ­nh lÃ  má»™t máº¡ng chuyá»ƒn Ä‘á»•i gÃ³i tin sá»›m vÃ  cÅ©ng lÃ  máº¡ng Ä‘áº§u tiÃªn triá»ƒn khai bá»™ TCP/IP. Máº¡ng nÃ y cÃ i Ä‘áº·t má»™t liÃªn káº¿t giá»¯a trÆ°á»ng Ä‘áº¡i há»c California vÃ  Há»c viá»‡n nghiÃªn cá»©u Stanford. 20 nÄƒm sau, Tim Berners-Lee phÃ¡t hÃ nh má»™t lá»i Ä‘á» nghá»‹ cho â€œMeshâ€ - thá»© mÃ  sau nÃ y Ä‘Æ°á»£c biáº¿t Ä‘áº¿n lÃ  World Wide Web. Trong 49 nÄƒm Ä‘Ã³, internet Ä‘Ã£ Ä‘i Ä‘Æ°á»£c má»™t quÃ£ng Ä‘Æ°á»ng dÃ i, báº¯t Ä‘áº§u chá»‰ vá»›i 2 mÃ¡y tÃ­nh trao Ä‘á»•i cÃ¡c gÃ³i dá»¯ liá»‡u vÃ  giá» Ä‘áº¡t tá»›i hÆ¡n 75 triá»‡u server, 3.8 tá»‰ ngÆ°á»i dÃ¹ng internet vÃ  1.3 tá»‰ websites. Trong bÃ i nÃ y, chÃºng ta sáº½ thá»­ phÃ¢n tÃ­ch nhá»¯ng ká»¹ thuáº­t nÃ o trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i sá»­ dá»¥ng Ä‘á»ƒ tá»± Ä‘á»™ng Ä‘áº©y máº¡nh hiá»‡u nÄƒng (tháº­m chÃ­ báº¡n khÃ´ng biáº¿t Ä‘áº¿n Ä‘iá»u Ä‘Ã³), vÃ  chÃºng ta sáº½ Ä‘áº·c biá»‡t soi ká»¹ vÃ o lá»›p networking cá»§a trÃ¬nh duyá»‡t. á» cuá»‘i bÃ i, tÃ¡c giáº£ sáº½ cung cáº¥p má»™t sá»‘ Ã½ tÆ°á»Ÿng lÃ m tháº¿ nÃ o Ä‘á»ƒ giÃºp trÃ¬nh duyá»‡t Ä‘áº©y máº¡nh hÆ¡n ná»¯a hiá»‡u nÄƒng cá»§a webapp cá»§a báº¡n. KhÃ¡i quÃ¡tTrÃ¬nh duyá»‡t web hiá»‡n Ä‘áº¡i Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘áº·c trá»‹ cho viá»‡c truyá»n táº£i webapp/website má»™t cÃ¡ch nhanh chÃ³ng, hiá»‡u quáº£ vÃ  an toÃ n báº£o máº­t. Vá»›i hÃ ng trÄƒm component cÃ¹ng hoáº¡t Ä‘á»™ng trÃªn nhiá»u layer khÃ¡c nhau, tá»« quáº£n lÃ½ tiáº¿n trÃ¬nh vÃ  báº£o máº­t sandbox Ä‘áº¿n cÃ¡c GPU pipeline, audio vÃ  video, vÃ  cÃ²n nhiá»u thá»© khÃ¡c ná»¯a, trÃ¬nh duyá»‡t trÃ´ng giá»‘ng nhÆ° má»™t há»‡ Ä‘iá»u hÃ nh hÆ¡n lÃ  má»™t pháº§n má»m bÃ¬nh thÆ°á»ng. Hiá»‡u nÄƒng tá»•ng quÃ¡t cá»§a trÃ¬nh duyá»‡t Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng má»™t cÆ¡ sá»‘ cÃ¡c component lá»›n: parsing (phÃ¢n giáº£i), layout, tÃ­nh toÃ¡n style, quÃ¡ trÃ¬nh thá»±c thi Javascript &amp; WebAssembly, rendering vÃ  dÄ© nhiÃªn lÃ  cáº£ networking stack (ngÄƒn xáº¿p máº¡ng). CÃ¡c ká»¹ sÆ° thÆ°á»ng nghÄ© ráº±ng networking stack lÃ  má»™t nÃºt cá»• chai. Äiá»u nÃ y xáº£y ra thÆ°á»ng xuyÃªn vÃ¬ táº¥t cáº£ cÃ¡c tÃ i nguyÃªn Ä‘á»u cáº§n pháº£i Ä‘Æ°á»£c láº¥y vá» tá»« internet trÆ°á»›c khi cÃ¡c bÆ°á»›c cÃ²n láº¡i Ä‘Æ°á»£c thá»±c hiá»‡n. Vá»›i networking layer, Ä‘á»ƒ hoáº¡t Ä‘á»™ng hiá»‡u quáº£ nÃ³ cáº§n pháº£i Ä‘Ã³ng vai trÃ² nhiá»u hÆ¡n lÃ  má»™t bá»™ quáº£n lÃ½ socket Ä‘Æ¡n giáº£n. Vá»›i chÃºng ta, nÃ³ nhÆ° má»™t thá»© nÃºp dÆ°á»›i dáº¡ng má»™t cÆ¡ cháº¿ ráº¥t Ä‘Æ¡n giáº£n Ä‘á»ƒ kÃ©o tÃ i nguyÃªn vá» nhÆ°ng Ä‘Ã³ thá»±c sá»± lÃ  má»™t ná»n táº£ng (platform) Ä‘áº§y Ä‘á»§ vá»›i cÃ¡c tiÃªu chÃ­ tá»‘i Æ°u hÃ³a, APIs vÃ  service cá»§a riÃªng nÃ³. LÃ  web developer, chÃºng ta khÃ´ng cáº§n pháº£i lo nghÄ© vá» tá»«ng gÃ³i tin TCP hay UDP, Ä‘á»‹nh dáº¡ng request, caching vÃ  táº¥t cáº£ nhá»¯ng thá»© liÃªn quan. ToÃ n bá»™ sá»± phá»©c táº¡p nÃ y Ä‘Æ°á»£c trÃ¬nh duyá»‡t gÃ¡nh dÃ¹m nÃªn ta chá»‰ cáº§n táº­p trung vÃ o á»©ng dá»¥ng mÃ  chÃºng ta Ä‘ang táº¡o ra. Tuy nhiÃªn, hiá»ƒu rÃµ Ä‘iá»u gÃ¬ thá»±c sá»± Ä‘ang diá»…n ra bÃªn trong cÃ³ thá»ƒ giÃºp chÃºng ta táº¡o ra app nhanh hÆ¡n vÃ  báº£o máº­t tá»‘t hÆ¡n. Vá» báº£n cháº¥t thÃ¬ dÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng gÃ¬ xáº£y ra khi user báº¯t Ä‘áº§u tÆ°Æ¡ng tÃ¡c vá»›i trÃ¬nh duyá»‡t: User nháº­p má»™t URL vÃ o thanh Ä‘á»‹a chá»‰ trÃªn trÃ¬nh duyá»‡t Giáº£ sá»­ URL Ä‘Ã³ chá»‰ Ä‘áº¿n 1 tÃ i nguyÃªn trÃªn máº¡ng, trÃ¬nh duyá»‡t sáº½ báº¯t Ä‘áº§u kiá»ƒm tra local cache vÃ  cache cá»§a á»©ng dá»¥ng vÃ  cá»‘ thá»­ sá»­ dá»¥ng má»™t pháº£i copy cÃ³ sáºµn á»Ÿ local Ä‘á»ƒ Ä‘Ã¡p á»©ng request. Náº¿u cache khÃ´ng dÃ¹ng Ä‘Æ°á»£c, tÃ¬nh duyá»‡t sáº½ láº¥y tÃªn miá»n tá»« URL vÃ  yÃªu cáº§u Ä‘á»‹a chá»‰ IP cá»§a server tá»« má»™t DNS. Náº¿u tÃªn miá»n Ä‘Ã£ Ä‘Æ°á»£c cache sáºµn thÃ¬ khÃ´ng cáº§n truy váº¥n Ä‘áº¿n DNS. TrÃ¬nh duyá»‡t táº¡o ra má»™t gÃ³i tin HTTP nÃ³i ráº±ng nÃ³ yÃªu cáº§u má»™t trang web Ä‘ang cÆ° trÃº táº¡i má»™t server tá»« xa. GÃ³i tin Ä‘Æ°á»£c gá»­i Ä‘áº¿n TCP layer, layer nÃ y sáº½ thÃªm thÃ´ng tin cá»§a chÃ­nh nÃ³ vÃ o vá»‹ trÃ­ trÃªn cÃ¹ng cá»§a gÃ³i tin HTTP. ThÃ´ng tin nÃ y cáº§n thiáº¿t Ä‘á»ƒ duy trÃ¬ phiÃªn khá»Ÿi Ä‘á»™ng. GÃ³i tin sau Ä‘Ã³ Ä‘Æ°á»£c trao cho IP layer vá»›i cÃ´ng viá»‡c chÃ­nh lÃ  tÃ¬m hiá»ƒu má»™t cÃ¡ch Ä‘á»ƒ gá»­i gÃ³i tin tá»« user Ä‘áº¿n server tá»« xa. ThÃ´ng tin nÃ y cÅ©ng Ä‘Æ°á»£c lÆ°u vÃ o vá»‹ trÃ­ trÃªn cÃ¹ng cá»§a gÃ³i tin. GÃ³i tin Ä‘Æ°á»£c gá»­i Ä‘áº¿n server tá»« xa. Khi Ä‘Ã£ nháº­n gÃ³i tin, má»™t pháº£n há»“i Ä‘Æ°á»£c gá»­i ngÆ°á»£c láº¡i theo cÃ¡ch thá»©c tÆ°Æ¡ng tá»±. Äáº·c tÃ­nh ká»¹ thuáº­t cá»§a Navigation Timing tá»« W3C cung cáº¥p má»™t API trÃ¬nh duyá»‡t cÅ©ng nhÆ° kháº£ nÄƒng hiá»ƒn thá»‹ dá»¯ liá»‡u vá» thá»i gian vÃ  hiá»‡u nÄƒng Ä‘áº±ng sau má»—i request trÃªn trÃ¬nh duyá»‡t. Giá» thÃ¬ cÃ¹ng quan sÃ¡t cÃ¡c component, má»—i pháº§n sáº½ Ä‘Ã³ng má»™t vai trÃ² quan trá»ng trong viá»‡c cung cáº¥p cÃ¡c tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng (UX) tá»‘i Æ°u: ToÃ n bá»™ tiáº¿n trÃ¬nh networking ráº¥t phá»©c táº¡p vÃ  cÃ³ nhiá»u layer khÃ¡c nhau cÃ³ thá»ƒ trá»Ÿ thÃ nh má»™t nÃºt cá»• chai. ÄÃ¢y lÃ  lÃ½ do cÃ¡c trÃ¬nh duyá»‡t cá»‘ gáº¯ng pháº¥n Ä‘áº¥u Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u nÄƒng báº£n thÃ¢n báº±ng cÃ¡ch sá»­ dá»¥ng ráº¥t nhiá»u ká»¹ thuáº­t Ä‘a dáº¡ng Ä‘á»ƒ giáº£m thiá»ƒu tá»‘i Ä‘a sá»± áº£nh hÆ°á»Ÿng cá»§a toÃ n bá»™ giao tiáº¿p network. Quáº£n lÃ½ socketCÃ¹ng khá»Ÿi Ä‘á»™ng vá»›i má»™t sá»‘ thuáº­t ngá»¯ nÃ o: Origin: má»™t bá»™ 3 chá»©a cÃ¡c giao thá»©c á»©ng dá»¥ng, tÃªn miá»n vÃ  sá»‘ port (vÃ­ dá»¥: https, www.example.com, 443) Socket pool: má»™t nhÃ³m cÃ¡c socket thuá»™c vá» cÃ¹ng origin (táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t lá»›n Ä‘á»u giá»›i háº¡n pool size lá»›n nháº¥t lÃ  6 socket). Javascript vÃ  WebAssembly khÃ´ng cho phÃ©p chÃºng ta quáº£n lÃ½ vÃ²ng Ä‘á»i cá»§a cÃ¡c network socket riÃªng tÆ°, vÃ  dÄ© nhiÃªn nhÆ° váº­y lÃ  tá»‘t! Äiá»u nÃ y khÃ´ng nhá»¯ng giÃºp chÃºng ta dá»… dÃ ng hÆ¡n mÃ  cÃ²n cho phÃ©p trÃ¬nh duyá»‡t tá»± Ä‘á»™ng thá»±c hiá»‡n ráº¥t nhiá»u tá»‘i Æ°u hÃ³a hiá»‡u nÄƒng, má»™t trong sá»‘ Ä‘Ã³ bao gá»“m: sá»­ dá»¥ng láº¡i socket, yÃªu cáº§u sá»± Æ°u tiÃªn vÃ  rÃ ng buá»™c muá»™n (late binding), giao dá»‹ch giao thá»©c, Ã©p buá»™c giá»›i háº¡n káº¿t ná»‘i, vÃ¢n vÃ¢n. Tháº­t ra cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i Ä‘Ã£ lÃ m tá»‘t trong viá»‡c chia tÃ¡ch vÃ²ng quáº£n lÃ½ request khá»i pháº§n quáº£n lÃ½ socket. CÃ¡c socket Ä‘Æ°á»£c tá»• chá»©c trong cÃ¡c pool vÃ  Ä‘Æ°á»£c nhÃ³m láº¡i theo origin, má»—i pool báº¯t buá»™c pháº£i giá»›i háº¡n káº¿t ná»‘i vÃ  cÃ¡c rÃ ng buá»™c báº£o máº­t. CÃ¡c request chá» Ä‘Æ°á»£c xáº¿p vÃ o trong hÃ ng Ä‘á»£i, Ä‘Ã¡nh thá»© tá»± Æ°u tiÃªn vÃ  sau Ä‘Ã³ gáº¯n káº¿t vá»›i nhá»¯ng socket riÃªng tÆ° trong pool. Trá»« khi server cÃ³ Ã½ Ä‘á»‹nh Ä‘Ã³ng káº¿t ná»‘i thÃ¬ cÃ¹ng má»™t socket cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i má»™t cÃ¡ch tá»± Ä‘á»™ng xuyÃªn suá»‘t nhiá»u request. Bá»Ÿi vÃ¬ má»Ÿ má»›i 1 káº¿t ná»‘i TCP thÆ°á»ng kÃ¨m theo chi phÃ­ tá»‘n kÃ©m cho nÃªn tÃ¡i sá»­ dá»¥ng láº¡i cÃ¡c káº¿t ná»‘i cÅ© sáº½ Ä‘áº£m báº£o hiá»‡u nÄƒng tá»‘t hÆ¡n nhiá»u. Máº·c Ä‘á»‹nh thÃ¬ trÃ¬nh duyá»‡t sá»­ dá»¥ng cÆ¡ cháº¿ gá»i lÃ  â€œkeepaliveâ€ (giá»¯ cho sá»‘ng) Ä‘á»ƒ tiáº¿t kiá»‡m thá»i gian tá»« viá»‡c má»Ÿ má»›i káº¿t ná»‘i Ä‘áº¿n server khi cÃ³ request Ä‘Æ°á»£c táº¡o ra. Thá»i gian trung bÃ¬nh Ä‘á»ƒ má»Ÿ 1 káº¿t ná»‘i TCP lÃ : Request Ä‘áº¿n mÃ¡y local: 23ms Request trong ná»™i bá»™ chÃ¢u lá»¥c: 120ms Request giá»¯a cÃ¡c chÃ¢u lá»¥c vá»›i nhau: 225ms Kiá»ƒu kiáº¿n trÃºc nÃ y má»Ÿ ra cÃ¡nh cá»­a Ä‘áº¿n vá»›i ráº¥t nhiá»u cÆ¡ há»™i Ä‘á»ƒ tá»‘i Æ°u hÃ³a. Request cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c thi vá»›i nhá»¯ng thá»© tá»± khÃ¡c nhau tÃ¹y thuá»™c vÃ o Ä‘á»™ Æ°u tiÃªn cá»§a nÃ³. TrÃ¬nh duyá»‡t cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a sá»± phÃ¢n chia bÄƒng thÃ´ng giá»¯a toÃ n bá»™ cÃ¡c socket hoáº·c lÃ  nÃ³ cÃ³ thá»ƒ má»Ÿ socket khi dá»± Ä‘oÃ¡n trÆ°á»›c vá» má»™t request. NhÆ° Ä‘Ã£ nÃ³i trÆ°á»›c Ä‘Ã³, toÃ n bá»™ Ä‘á»u Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi trÃ¬nh duyá»‡t vÃ  khÃ´ng yÃªu cáº§u chÃºng ta giÃºp báº¥t cá»© thá»© gÃ¬. NhÆ°ng nÃ³ khÃ´ng nháº¥t thiáº¿t nghÄ©a lÃ  chÃºng ta khÃ´ng thá»ƒ lÃ m gÃ¬. Chá»n lá»±a Ä‘Ãºng pattern vá» giao tiáº¿p máº¡ng, loáº¡i vÃ  táº§n suáº¥t transfer, lá»±a chá»n cÃ¡c giao thá»©c vÃ  tinh chá»‰nh/tá»‘i Æ°u hÃ³a server stack cÃ³ thá»ƒ Ä‘Ã³ng vai trÃ² ráº¥t lá»›n trong viá»‡c cáº£i thiá»‡n hiá»‡u nÄƒng tá»•ng thá»ƒ cá»§a á»©ng dá»¥ng. Má»™t vÃ i trÃ¬nh duyá»‡t tháº­m chÃ­ cÃ²n Ä‘i xa hÆ¡n. VÃ­ dá»¥, Chrome cÃ³ thá»ƒ tá»± dáº¡y cho chÃ­nh nÃ³ hoáº¡t Ä‘á»™ng nhanh hÆ¡n khi báº¡n sá»­ dá»¥ng nÃ³. NÃ³ há»c há»i dá»±a trÃªn nhá»¯ng trang báº¡n Ä‘Ã£ ghÃ© thÄƒm vÃ  kiá»ƒu duyá»‡t web Ä‘iá»ƒn hÃ¬nh cho nÃªn nÃ³ cÃ³ thá»ƒ dá»± Ä‘oÃ¡n hÃ nh vi ngÆ°á»i dÃ¹ng cÃ³ kháº£ nÄƒng vÃ  thá»±c hiá»‡n hÃ nh Ä‘á»™ng trÆ°á»›c khi user lÃ m gÃ¬ Ä‘Ã³. VÃ­ dá»¥ Ä‘Æ¡n giáº£n nháº¥t lÃ  tá»± Ä‘á»™ng render trÆ°á»›c ná»™i dung cá»§a trang khi user rÃª chuá»™t lÃªn 1 link. Náº¿u báº¡n tháº¥y há»©ng thÃº vá» chá»§ Ä‘á» tá»‘i Æ°u hÃ³a cá»§a Chrome thÃ¬ cÃ³ thá»ƒ Ä‘á»c thÃªm chÆ°Æ¡ng nÃ y https://www.igvita.com/posa/high-performance-networking-in-google-chrome/ náº±m trong quyá»ƒn sÃ¡ch High-Performance Browser Networking Báº£o máº­t máº¡ng vÃ  Ä‘Ã³ng gÃ³i sandboxCho phÃ©p trÃ¬nh duyá»‡t quáº£n lÃ½ cÃ¡c socket riÃªng biá»‡t cÃ³ má»™t Ã½ nghÄ©a ráº¥t quan trá»ng: báº±ng cÃ¡ch nÃ y trÃ¬nh duyá»‡t cho phÃ©p Ã¡p Ä‘áº·t má»™t há»‡ thá»‘ng Ä‘á»“ng nháº¥t cÃ¡c rÃ ng buá»™c vá» chÃ­nh sÃ¡ch vÃ  báº£o máº­t lÃªn nhá»¯ng nguá»“n tÃ i nguyÃªn á»©ng dá»¥ng khÃ´ng Ä‘Ã¡ng tin cáº­y. VÃ­ dá»¥ nhÆ° trÃ¬nh duyá»‡t sáº½ khÃ´ng cháº¥p nháº­n API truy xuáº¥t trá»±c tiáº¿p vÃ o network socket thÃ´ vÃ¬ nhÆ° váº­y cÃ³ thá»ƒ cho phÃ©p cÃ¡c á»©ng dá»¥ng Ä‘á»™c háº¡i táº¡o káº¿t ná»‘i tÃ¹y tiá»‡n Ä‘áº¿n báº¥t cá»© host nÃ o. TrÃ¬nh duyá»‡t cÅ©ng Ã¡p Ä‘áº·t cÃ¡c giá»›i háº¡n káº¿t ná»‘i Ä‘á»ƒ báº£o vá»‡ server cÅ©ng nhÆ° client khá»i cáº¡n kiá»‡t tÃ i nguyÃªn. TrÃ¬nh duyá»‡t Ä‘á»‹nh dáº¡ng táº¥t cáº£ cÃ¡c request Ä‘i ra Ä‘á»ƒ Ã¡p Ä‘áº·t sá»± Ä‘á»“ng nháº¥t vÃ  cÃ¡c ngá»¯ nghÄ©a giao thá»©c tá»‘t Ä‘á»ƒ báº£o vá»‡ server. TÆ°Æ¡ng tá»±, giáº£i mÃ£ response Ä‘Æ°á»£c thá»±c hiá»‡n má»™t cÃ¡ch tá»± Ä‘á»™ng Ä‘á»ƒ báº£o vá»‡ user tá»« nhá»¯ng server Ä‘á»™c háº¡i. Trao Ä‘á»•i TLSTransport Layer Security (TLS) lÃ  má»™t giao thá»©c máº­t mÃ£ cung cáº¥p giao tiáº¿p báº£o máº­t trong máº¡ng mÃ¡y tÃ­nh. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong nhiá»u á»©ng dá»¥ng, má»™t trong sá»‘ Ä‘Ã³ lÃ  trÃ¬nh duyá»‡t web. Website cÃ³ thá»ƒ dÃ¹ng TLS Ä‘á»ƒ báº£o Ä‘áº£m an ninh cho táº¥t cáº£ cÃ¡c giao tiáº¿p giá»¯a server vÃ  trÃ¬nh duyá»‡t web. ToÃ n bá»™ quÃ¡ trÃ¬nh báº¯t tay TLS bao gá»“m cÃ¡c bÆ°á»›c sau: Client gá»­i má»™t lá»i nháº¯n â€œClient helloâ€ Ä‘áº¿n server, cÃ¹ng vá»›i má»™t giÃ¡ trá»‹ ngáº«u nhiÃªn cá»§a client vÃ  bá»™ mÃ£ hÃ³a Ä‘Æ°á»£c há»— trá»£. Server tráº£ lá»i báº±ng cÃ¡ch gá»­i lá»i nháº¯n â€œServer helloâ€ vá» cho client, cÃ¹ng vá»›i giÃ¡ trá»‹ ngáº«u nhiÃªn cá»§a server. Server gá»­i chá»©ng chá»‰ xÃ¡c thá»±c cá»§a nÃ³ vá» cho client vÃ  cÃ³ thá»ƒ yÃªu cáº§u má»™t chá»©ng chá»‰ tÆ°Æ¡ng tá»± tá»« phÃ­a client. Server gá»­i lá»i nháº¯n â€œServer hello doneâ€. Náº¿u server Ä‘Ã£ yÃªu cáº§u má»™t chá»©ng chá»‰ tá»« client thÃ¬ client pháº£i gá»­i nÃ³. Client táº¡o ra má»™t Pre-Master Secret ngáº«u nhiÃªn vÃ  mÃ£ hÃ³a nÃ³ vá»›i public key tá»« chá»©ng chá»‰ cá»§a server, gá»­i Pre-Master Secret Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a vá» cho server. Server nháº­n Pre-Master Secret. Server vÃ  client má»—i bÃªn sáº½ sinh ra Master Secret vÃ  session key (chÃ¬a khÃ³a phiÃªn) dá»±a trÃªn Pre-Master Secret. Client gá»­i thÃ´ng bÃ¡o â€œChange cipher specâ€ Ä‘áº¿n server Ä‘á»ƒ xÃ¡c Ä‘á»‹nh ráº±ng client sáº½ báº¯t Ä‘áº§u sá»­ dá»¥ng session key má»›i Ä‘á»ƒ bÄƒm vÃ  mÃ£ hÃ³a message. Client cÅ©ng Ä‘á»“ng thá»i gá»­i tin nháº¯n â€œClient finishedâ€. Server nháº­n â€œChange cipher specâ€ vÃ  chuyá»ƒn Ä‘á»•i tráº¡ng thÃ¡i báº£o máº­t cá»§a record layer cá»§a nÃ³ sang tráº¡ng thÃ¡i báº£o máº­t mÃ£ hÃ³a Ä‘á»‘i xá»©ng báº±ng session key. Server gá»­i lá»i nháº¯n â€œserver finishedâ€ vá» cho client. Client vÃ  server giá» cÃ³ thá»ƒ trao Ä‘á»•i dá»¯ liá»‡u á»©ng dá»¥ng thÃ´ng qua kÃªnh báº£o máº­t mÃ  chÃºng Ä‘Ã£ thiáº¿t láº­p. Táº¥t cáº£ message Ä‘Æ°á»£c gá»­i tá»« client Ä‘áº¿n server vÃ  ngÆ°á»£c láº¡i Ä‘á»u Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng session key. User Ä‘Æ°á»£c cáº£nh bÃ¡o trong trÆ°á»ng há»£p má»™t trong sá»‘ xÃ¡c thá»±c nÃ o Ä‘Ã³ bá»‹ sai, vÃ­ dá»¥: server Ä‘ang dÃ¹ng má»™t chá»©ng chá»‰ tá»± cáº¥p. ChÃ­nh sÃ¡ch cÃ¹ng originHai trang cÃ³ cÃ¹ng origin náº¿u nhÆ° giao thá»©c, cá»•ng (náº¿u Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh) vÃ  host Ä‘á»u giá»‘ng nhau giá»¯a 2 trang DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ i vÃ­ dá»¥ vá» cÃ¡c tÃ i nguyÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c nhÃºng cross-origin (xuyÃªn origin): Javascript vá»›i code &lt;script src=&quot;â€¦&quot;&gt;&lt;/script&gt;. ThÃ´ng bÃ¡o lá»—i cÃº phÃ¡p chá»‰ tá»“n táº¡i cho nhá»¯ng Ä‘oáº¡n script cÃ¹ng origin. CSS vá»›i &lt;link rel=&quot;stylesheet&quot; href=&quot;â€¦&quot;&gt;. Do quy táº¯c cÃº phÃ¡p thoáº£i mÃ¡i cá»§a CSS nÃªn CSS cross-origin cáº§n má»™t header Content-Type Ä‘Ãºng loáº¡i. Sá»± háº¡n cháº¿ thÃ¬ tÃ¹y thuá»™c vÃ o trÃ¬nh duyá»‡t. HÃ¬nh áº£nh vá»›i tháº» &lt;img /&gt; File Ä‘a phÆ°Æ¡ng tiá»‡n vá»›i &lt;video&gt; vÃ  &lt;audio&gt; Plug in vá»›i &lt;object&gt;, &lt;embed&gt; and &lt;applet&gt; Fonts vá»›i @font-face. VÃ i trÃ¬nh duyá»‡t cho phÃ©p cÃ¡c font cross-origin, má»™t sá»‘ khÃ¡c thÃ¬ yÃªu cáº§u fonts trong cÃ¹ng origin. Báº¥t cá»© thá»© gÃ¬ vá»›i &lt;frame&gt; vÃ  &lt;iframe&gt;. Má»™t trang cÃ³ thá»ƒ sá»­ dá»¥ng header X-Frame-Options Ä‘á»ƒ ngÄƒn cháº·n trÆ°á»ng há»£p tÆ°Æ¡ng tÃ¡c cross-origin nÃ y. Danh sÃ¡ch trÃªn váº«n cÃ²n thiáº¿u sÃ³t nhiá»u, má»¥c Ä‘Ã­ch cá»§a nÃ³ lÃ  lÃ m ná»•i báº­t nguyÃªn táº¯c â€œquyá»n háº¡n tá»‘i thiá»ƒuâ€ (least privilege). TrÃ¬nh duyá»‡t chá»‰ phÃ´ ra nhá»¯ng API vÃ  tÃ i nguyÃªn cáº§n thiáº¿t cho code cá»§a chÆ°Æ¡ng trÃ¬nh: á»©ng dá»¥ng há»— trá»£ dá»¯ liá»‡u vÃ  URL, trÃ¬nh duyá»‡t Ä‘á»‹nh dáº¡ng cÃ¡c request vÃ  xá»­ lÃ½ toÃ n bá»™ vÃ²ng Ä‘á»i cá»§a má»—i káº¿t ná»‘i. Ráº¥t Ä‘Ã¡ng Ä‘á»ƒ lÆ°u tÃ¢m ráº±ng hoÃ n toÃ n khÃ´ng cÃ³ má»™t concept cá»¥ thá»ƒ nÃ o cá»§a â€œchÃ­nh sÃ¡ch cÃ¹ng originâ€ (same-origin policy). Thay vÃ o Ä‘Ã³, chá»‰ cÃ³ 1 bá»™ cÆ¡ cháº¿ liÃªn quan Ã¡p Ä‘áº·t cÃ¡c rÃ ng buá»™c lÃªn viá»‡c truy xuáº¥t DOM, cookie vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a session, máº¡ng vÃ  cÃ¡c thÃ nh pháº§n khÃ¡c cá»§a trÃ¬nh duyá»‡t. LÆ°u Ä‘á»‡m tÃ i nguyÃªn vÃ  tráº¡ng thÃ¡i cá»§a clientRequest nhanh nháº¥t vÃ  tá»‘t nháº¥t chÃ­nh lÃ  khÃ´ng gá»i request nÃ o cáº£. TrÆ°á»›c khi Ä‘iá»u phá»‘i má»™t request, trÃ¬nh duyá»‡t tá»± Ä‘á»™ng kiá»ƒm tra bá»™ Ä‘á»‡m tÃ i nguyÃªn cá»§a nÃ³, thá»±c hiá»‡n cÃ¡c kiá»ƒm tra xÃ¡c nháº­n cáº§n thiáº¿t vÃ  tráº£ vá» má»™t báº£n copy local cá»§a tÃ i nguyÃªn Ä‘Ã³ náº¿u phÃ¹ há»£p vá»›i nhá»¯ng Ä‘iá»u kiá»‡n cá»¥ thá»ƒ. Náº¿u tÃ i nguyÃªn á»Ÿ local khÃ´ng tá»“n táº¡i trong cache thÃ¬ request lÃªn máº¡ng Ä‘Æ°á»£c gá»i vÃ  response sáº½ Ä‘Æ°á»£c chÃ¨n tá»± Ä‘á»™ng vÃ o trong cache Ä‘á»ƒ cho láº§n truy cáº­p tiáº¿p theo náº¿u Ä‘Æ°á»£c phÃ©p. TrÃ¬nh duyá»‡t tá»± Ä‘á»™ng Ä‘Ã¡nh giÃ¡ cÃ¡c chá»‰ thá»‹ lÆ°u Ä‘á»‡m (cache directives) cho má»—i tÃ i nguyÃªn. TrÃ¬nh duyá»‡t tá»± Ä‘á»™ng xÃ¡c nháº­n láº¡i cÃ¡c tÃ i nguyÃªn háº¿t háº¡n khi nÃ³ cÃ³ thá»ƒ. TrÃ¬nh duyá»‡t tá»± Ä‘á»™ng quáº£n lÃ½ kÃ­ch cá»¡ cá»§a bá»™ Ä‘á»‡m vÃ  thu há»“i tÃ i nguyÃªn. Quáº£n lÃ½ bá»™ Ä‘á»‡m tÃ i nguyÃªn má»™t cÃ¡ch hiá»‡u quáº£ vÃ  tá»‘i Æ°u lÃ  ráº¥t khÃ³. Æ n trá»i trÃ¬nh duyá»‡t Ä‘Ã£ xá»­ lÃ½ toÃ n bá»™ nhá»¯ng thá»© phá»©c táº¡p áº¥y giÃºp chÃºng ta rá»“i, táº¥t cáº£ nhá»¯ng gÃ¬ ta cáº§n lÃ m lÃ  Ä‘áº£m báº£o server cá»§a mÃ¬nh tráº£ vá» cache directive phÃ¹ há»£p, Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n thÃ¬ báº¡n cÃ³ thá»ƒ Ä‘á»c bÃ i Cache Resources on the Client. Báº¡n cung cáº¥p cÃ¡c response headers nhÆ° Cache-Control, ETag vÃ  Last-Modified cho táº¥t cáº£ nguá»“n tÃ i nguyÃªn trÃªn trang cá»§a báº¡n, pháº£i khÃ´ng? Cuá»‘i cÃ¹ng, má»™t chá»©c nÄƒng thÆ°á»ng bá»‹ bá» quáº£ nhÆ°ng khÃ¡ quan trá»ng cá»§a trÃ¬nh duyá»‡t chÃ­nh lÃ  nhiá»‡m vá»¥ cung cáº¥p xÃ¡c thá»±c, session vÃ  quáº£n lÃ½ cookie. TrÃ¬nh duyá»‡t duy trÃ¬ cÃ¡c gÃ³i cookie (cookie jars - tÃ¡c giáº£ chÆ¡i chá»¯ â€œcookie - bÃ¡nh quyâ€) riÃªng biá»‡t cho má»—i origin, cung cáº¥p cÃ¡c á»©ng dá»¥ng cáº§n thiáº¿t vÃ  server APIs Ä‘á»ƒ Ä‘á»c/ghi cookie, session vÃ  dá»¯ liá»‡u xÃ¡c thá»±c má»›i, tá»± Ä‘á»™ng ná»‘i &amp; xá»­ lÃ½ cÃ¡c header HTTP phÃ¹ há»£p Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a toÃ n bá»™ quÃ¡ trÃ¬nh thay cho chÃºng ta. VÃ­ dá»¥:Má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n nhÆ°ng dá»… minh há»a nháº¥t vá» sá»± tiá»‡n dá»¥ng cá»§a viá»‡c hoÃ£n quáº£n lÃ½ tráº¡ng thÃ¡i session vá»›i trÃ¬nh duyá»‡t: má»™t session Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c thá»±c cÃ³ thá»ƒ chia sáº» giá»¯a nhiá»u tab vá»›i nhau hoáº·c nhiá»u cá»­a sá»• trÃ¬nh duyá»‡t vÃ  ngÆ°á»£c láº¡i; má»™t hÃ nh Ä‘á»™ng Ä‘Äƒng xuáº¥t (sign-out) á»Ÿ 1 tab sáº½ vÃ´ hiá»‡u hÃ³a cÃ¡c session Ä‘ang má»Ÿ á»Ÿ toÃ n bá»™ cÃ¡c cá»­a sá»• Ä‘ang má»Ÿ khÃ¡c. CÃ¡c API á»©ng dá»¥ng vÃ  giao thá»©cCÃ ng Ä‘i sÃ¢u tÃ¬m hiá»ƒu vá» cÃ¡c dá»‹ch vá»¥ network sáºµn cÃ³ thÃ¬ cuá»‘i cÃ¹ng chÃºng ta cÅ©ng Ä‘Ã£ tiáº¿n Ä‘áº¿n cÃ¡c API á»©ng dá»¥ng vÃ  giao thá»©c (Application APIs &amp; Protocols). NhÆ° ta Ä‘Ã£ biáº¿t, nhá»¯ng layer tháº¥p thÃ¬ cung cáº¥p má»™t máº£ng rá»™ng cÃ¡c dá»‹ch vá»¥ quan trá»ng: quáº£n lÃ½ socket &amp; káº¿t ná»‘i, xá»­ lÃ½ request &amp; response, Ã¡p Ä‘áº·t nhiá»u chÃ­nh sÃ¡ch báº£o máº­t, lÆ°u Ä‘á»‡m &amp; cÃ²n nhiá»u ná»¯a. Má»—i khi chÃºng ta khá»Ÿi táº¡o HTTP hay XMLHttpRequest, sá»± kiá»‡n long-lived Server-Sent hay WebSocket session, hoáº·c má»Ÿ káº¿t ná»‘i WebRTCâ€¦ chÃºng ta Ä‘ang tÆ°Æ¡ng tÃ¡c vá»›i má»™t hoáº·c nhiá»u cÃ¡c dá»‹ch vá»¥ Ä‘Ã³. KhÃ´ng cÃ³ giao thá»©c hay API nÃ o tá»‘t nháº¥t. Má»—i á»©ng dá»¥ng phá»©c táº¡p sáº½ cáº§n má»™t tá»• há»£p cÃ¡c giao váº­n (transports) khÃ¡c nhau dá»±a trÃªn sá»± Ä‘a dáº¡ng cá»§a cÃ¡c yÃªu cáº§u: giao tiáº¿p vá»›i bá»™ Ä‘á»‡m trÃ¬nh duyá»‡t, protocol overhead (metadata hoáº·c thÃ´ng tin Ä‘iá»u hÆ°á»›ng máº¡ng Ä‘Æ°á»£c gá»­i bá»Ÿi á»©ng dá»¥ng), Ä‘á»™ trá»… cá»§a message, Ä‘á»™ tin cáº­y, kiá»ƒu truyá»n táº£i dá»¯ liá»‡u, vÃ¢n vÃ¢n. Má»™t sá»‘ giao thá»©c cÃ³ thá»ƒ Ä‘Ã¡p á»©ng vá»›i Ä‘á»™ trá»… tháº¥p (vÃ­ dá»¥: Server-Sent Events, WebSocket), nhÆ°ng khÃ´ng yÃªu cáº§u cÃ¡c tiÃªu chÃ­ quan trá»ng khÃ¡c, cháº³ng háº¡n nhÆ° kháº£ nÄƒng táº­n dá»¥ng bá»™ Ä‘á»‡m trÃ¬nh duyá»‡t hoáº·c há»— trá»£ truyá»n táº£i nhá»‹ phÃ¢n hiá»‡u quáº£ trong má»i trÆ°á»ng há»£p. Má»™t vÃ i thá»© báº¡n cÃ³ thá»ƒ lÃ m Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u nÄƒng vÃ  báº£o máº­t cá»§a Webapp LuÃ´n luÃ´n sá»­ dá»¥ng header Connection: Keep-Alive trong cÃ¡c request. TrÃ¬nh duyá»‡t Ä‘Ã£ máº·c Ä‘á»‹nh sáºµn rá»“i. Äáº£m báº£o server sá»­ dá»¥ng cÆ¡ cháº¿ tÆ°Æ¡ng tá»±. Sá»­ dá»¥ng header Cache-Control, Etag vÃ  Last-Modified phÃ¹ há»£p Ä‘á»ƒ tiáº¿t kiá»‡m thá»i gian download cho trÃ¬nh duyá»‡t. DÃ nh thá»i gian Ä‘á»ƒ tinh chá»‰nh vÃ  tá»‘i Æ°u hÃ³a web server, phÃ©p mÃ u sáº½ xáº£y ra! Nhá»› ráº±ng quÃ¡ trÃ¬nh nÃ y ráº¥t cá»¥ thá»ƒ cho tá»«ng loáº¡i webapp vÃ  kiá»ƒu dá»¯ liá»‡u mÃ  báº¡n trao Ä‘á»•i. LuÃ´n luÃ´n dÃ¹ng TLS! Äáº·c biá»‡t náº¿u nhÆ° báº¡n cÃ³ báº¥t ká»³ xÃ¡c thá»±c nÃ o trong á»©ng dá»¥ng cá»§a báº¡n. NghiÃªn cá»©u trÃ¬nh duyá»‡t cung cáº¥p cÃ¡c chÃ­nh sÃ¡ch báº£o máº­t nÃ o vÃ  Ã¡p Ä‘áº·t chÃºng vÃ o trong á»©ng dá»¥ng cá»§a báº¡n. Hiá»‡u nÄƒng vÃ  báº£o máº­t lÃ  Æ°u tiÃªn hÃ ng Ä‘áº§u trong SessionStack. LÃ½ do táº¡i sao team tÃ¡c giáº£ khÃ´ng thá»ƒ nghiÃªng vá» má»™t bÃªn nÃ o hÆ¡n lÃ  bá»Ÿi vÃ¬ má»™t khi Ä‘Ã£ tÃ­ch há»£p SessionStack vÃ o webapp, nÃ³ báº¯t Ä‘áº§u giÃ¡m sÃ¡t má»i thá»© tá»« thay Ä‘á»•i trÃªn DOM, tÆ°Æ¡ng tÃ¡c ngÆ°á»i dÃ¹ng Ä‘áº¿n request máº¡ng, biá»‡t lá»‡ vÃ  thÃ´ng bÃ¡o debug. Táº¥t cáº£ thÃ´ng tin nÃ y Ä‘Æ°á»£c truyá»n vá» server theo thá»i gian thá»±c vÃ  cho phÃ©p user cÃ³ thá»ƒ cháº¡y láº¡i cÃ¡c váº¥n Ä‘á» Ä‘Ã£ xáº£y ra dÆ°á»›i dáº¡ng video &amp; xem má»i thá»© xáº£y ra vá»›i ngÆ°á»i dÃ¹ng cá»§a báº¡n. Táº¥t cáº£ hoáº¡t Ä‘á»™ng nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i Ä‘á»™ trá»… tá»‘i thiá»ƒu vÃ  khÃ´ng áº£nh hÆ°á»Ÿng tá»›i hiá»‡u nÄƒng cá»§a app cá»§a báº¡n.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P11: Render engine & máº¹o tá»‘i Æ°u hÃ³a hiá»‡u nÄƒng render","slug":"Cach-Javascript-hoat-dong-P11-Render-engine-meo-toi-uu-hoa-hieu-nang-render","date":"2018-11-25T08:29:00.000Z","updated":"2018-11-25T08:33:25.317Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P11-Render-engine-meo-toi-uu-hoa-hieu-nang-render.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P11-Render-engine-meo-toi-uu-hoa-hieu-nang-render.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 11 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Trong nhá»¯ng bÃ i trÆ°á»›c cá»§a series â€œÄá»¥c khoÃ©t Javascriptâ€, chÃºng ta Ä‘Ã£ táº­p trung vÃ o tÃ¬m hiá»ƒu ngÃ´n ngá»¯ Javascript, cÃ¡c tÃ­nh nÄƒng cá»§a nÃ³, cÃ¡ch chÃºng Ä‘Æ°á»£c thá»±c thi trÃªn trÃ¬nh duyá»‡t, lÃ m tháº¿ nÃ o Ä‘á»ƒ tá»‘i Æ°u hÃ³a, vÃ¢n vÃ¢n. Tuy nhiÃªn, khi báº¡n xÃ¢y dá»±ng webapp, báº¡n khÃ´ng chá»‰ viáº¿t code Javascript. Code cá»§a báº¡n cÃ²n tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng. Tháº¥u hiá»ƒu mÃ´i trÆ°á»ng, cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³ sáº½ cho phÃ©p báº¡n xÃ¢y dá»±ng app tá»‘t hÆ¡n vÃ  cÃ³ ná»n táº£ng chuáº©n bá»‹ tá»‘t Ä‘á»ƒ Ä‘á» phÃ²ng nhá»¯ng nguy cÆ¡ tiá»m tÃ ng cÃ³ thá»ƒ xáº£y Ä‘áº¿n báº¥t cá»© lÃºc nÃ o khi lÃªn production.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 11 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Trong nhá»¯ng bÃ i trÆ°á»›c cá»§a series â€œÄá»¥c khoÃ©t Javascriptâ€, chÃºng ta Ä‘Ã£ táº­p trung vÃ o tÃ¬m hiá»ƒu ngÃ´n ngá»¯ Javascript, cÃ¡c tÃ­nh nÄƒng cá»§a nÃ³, cÃ¡ch chÃºng Ä‘Æ°á»£c thá»±c thi trÃªn trÃ¬nh duyá»‡t, lÃ m tháº¿ nÃ o Ä‘á»ƒ tá»‘i Æ°u hÃ³a, vÃ¢n vÃ¢n. Tuy nhiÃªn, khi báº¡n xÃ¢y dá»±ng webapp, báº¡n khÃ´ng chá»‰ viáº¿t code Javascript. Code cá»§a báº¡n cÃ²n tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng. Tháº¥u hiá»ƒu mÃ´i trÆ°á»ng, cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³ sáº½ cho phÃ©p báº¡n xÃ¢y dá»±ng app tá»‘t hÆ¡n vÃ  cÃ³ ná»n táº£ng chuáº©n bá»‹ tá»‘t Ä‘á»ƒ Ä‘á» phÃ²ng nhá»¯ng nguy cÆ¡ tiá»m tÃ ng cÃ³ thá»ƒ xáº£y Ä‘áº¿n báº¥t cá»© lÃºc nÃ o khi lÃªn production. CÃ¡c thÃ nh pháº§n chÃ­nh cá»§a trÃ¬nh duyá»‡t: Giao diá»‡n (User interface): pháº§n nÃ y bao gá»“m thanh Ä‘á»‹a chá»‰ (address bar), nÃºt back &amp; forward, menu bookmark, vÃ¢n vÃ¢n. Vá» báº£n cháº¥t, Ä‘Ã¢y lÃ  nhá»¯ng pháº§n thuá»™c vá» trÃ¬nh duyá»‡t hiá»ƒn thá»‹ lÃªn cho báº¡n tháº¥y, ngoáº¡i trá»« khung hiá»ƒn thá»‹ trang web. Engine trÃ¬nh duyá»‡t (Browser engine): nÃ³ xá»­ lÃ½ cÃ¡c giao tiáº¿p giá»¯a user interface vÃ  rendering engine Engine dá»±ng hÃ¬nh (Rendering engine): chá»‹u trÃ¡ch nhiá»‡m hiá»ƒn thá»‹ trang web. Rendering engine sáº½ phÃ¢n giáº£i HTML &amp; CSS vÃ  hiá»ƒn thá»‹ ná»™i dung Ä‘Ã³ lÃªn mÃ n hÃ¬nh. Máº¡ng (Networking): Ä‘Ã¢y lÃ  nhá»¯ng lá»i gá»i máº¡ng cháº³ng háº¡n nhÆ° XHR request, chÃºng Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch sá»­ dá»¥ng nhiá»u triá»ƒn khai khÃ¡c nhau cho nhiá»u ná»n táº£ng khÃ¡c nhau náº±m phÃ­a sau má»™t interface Ä‘á»™c láº­p ná»n táº£ng (platform-independent interface). ChÃºng ta sáº½ tháº£o luáº­n vá» lá»›p network chi tiáº¿t hÆ¡n á»Ÿ bÃ i tiáº¿p theo (sá»‘ 12) trong series nÃ y nhÃ©. Giao diá»‡n á»Ÿ backend (UI Backend): dÃ¹ng Ä‘á»ƒ váº½ nÃªn cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, vÃ­ dá»¥ nhÆ° checkbox hay cá»­a sá»•. Pháº§n nÃ y thá»ƒ hiá»‡n má»™t interface chung khÃ´ng phá»¥ thuá»™c hay Ä‘áº·c trÆ°ng cho ná»n táº£ng. NÃ³ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng thá»©c vá» UI cá»§a há»‡ Ä‘iá»u hÃ nh. Javascript engine: ChÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu vá» pháº§n nÃ y trong bÃ i trÆ°á»›c. Vá» cÆ¡ báº£n, Ä‘Ã¢y lÃ  nÆ¡i code Javascript Ä‘Æ°á»£c thá»±c thi. Cá»‘ Ä‘á»‹nh dá»¯ liá»‡u (Data persistence): app cá»§a báº¡n cÃ³ thá»ƒ cáº§n lÆ°u trá»¯ dá»¯ liá»‡u á»Ÿ phÃ­a local. CÃ¡c loáº¡i kiáº¿n trÃºc lÆ°u trá»¯ Ä‘Æ°á»£c há»— trá»£ á»Ÿ Ä‘Ã¢y gá»“m cÃ³ localStorage, indexDB, WebSQL vÃ  FileSystem Trong bÃ i nÃ y, chÃºng ta sáº½ táº­p trung vÃ o rendering engine (engine dá»±ng hÃ¬nh), bá»Ÿi vÃ¬ nÃ³ xá»­ lÃ½ quÃ¡ trÃ¬nh phÃ¢n giáº£i vÃ  hÃ¬nh áº£nh hÃ³a (visualization) code HTML &amp; CSS, lÃ  pháº§n mÃ  Ä‘a sá»‘ app Javascript cáº§n tÆ°Æ¡ng tÃ¡c liÃªn tá»¥c. KhÃ¡i quÃ¡t vá» rendering engineCÃ´ng viá»‡c chÃ­nh cá»§a rendering engine lÃ  hiá»ƒn thá»‹ trang Ä‘Æ°á»£c yÃªu cáº§u lÃªn mÃ n hÃ¬nh cá»§a trÃ¬nh duyá»‡t. Rendering engine cÃ³ thá»ƒ hiá»ƒn thá»‹ HTML, vÄƒn báº£n XML vÃ  áº£nh. Náº¿u báº¡n sá»­ dá»¥ng thÃªm plugin á»Ÿ ngoÃ i thÃ¬ engine cÃ³ thá»ƒ hiá»ƒn thá»‹ cÃ¡c loáº¡i vÄƒn báº£n khÃ¡c, cháº³ng háº¡n nhÆ° PDF. Rendering enginesTÆ°Æ¡ng tá»± nhÆ° Javascript engine, trÃ¬nh duyá»‡t khÃ¡c nhau cÅ©ng sá»­ dá»¥ng cÃ¡c rendering engine khÃ¡c nhau. Má»™t vÃ i bá»™ engine ná»•i tiáº¿ng: Gecko â€” Firefox WebKit â€” Safari Blink â€” Chrome, Opera (tá»« phiÃªn báº£n 15 trá»Ÿ Ä‘i) QuÃ¡ trÃ¬nh renderRendering engine nháº­n ná»™i dung cá»§a vÄƒn báº£n Ä‘Æ°á»£c yÃªu cáº§u tá»« lá»›p networking. XÃ¢y dá»±ng DOM treeBÆ°á»›c Ä‘áº§u tiÃªn cá»§a cÃ´ng cuá»™c rendering lÃ  phÃ¢n giáº£i vÄƒn báº£n HTML vÃ  chuyá»ƒn nhá»¯ng pháº§n tá»­ Ä‘Ã£ phÃ¢n giáº£i thÃ nh nhá»¯ng DOM node thá»±c sá»± trong DOM tree. Giáº£ sá»­ báº¡n cÃ³ Ä‘oáº¡n input nhÆ° sau: 123456789101112&lt;html&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"theme.css\"&gt; &lt;/head&gt; &lt;body&gt; &lt;p&gt; Hello, &lt;span&gt; friend! &lt;/span&gt; &lt;/p&gt; &lt;div&gt; &lt;img src=\"smiley.gif\" alt=\"Smiley face\" height=\"42\" width=\"42\"&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; DOM tree cá»§a Ä‘oáº¡n HTML trÃªn sáº½ giá»‘ng nhÆ° sau: Vá» cÆ¡ báº£n thÃ¬ má»—i pháº§n tá»­ Ä‘Æ°á»£c thá»ƒ hiá»‡n nhÆ° lÃ  má»™t node cha cá»§a táº¥t cáº£ cÃ¡c element khÃ¡c náº±m trá»±c tiáº¿p ngay bÃªn dÆ°á»›i (bÃªn trong) nÃ³. NguyÃªn táº¯c nÃ y Ä‘Æ°á»£c Ã¡p dá»¥ng má»™t cÃ¡ch Ä‘á»‡ quy. XÃ¢y dá»±ng CSSOM treeCSSOM viáº¿t táº¯t cá»§a CSS Object Model. Trong khi trÃ¬nh duyá»‡t Ä‘ang xÃ¢y dá»±ng DOM, nÃ³ báº¯t gáº·p má»™t tháº» link trong pháº§n head vÃ  dáº«n tá»›i má»™t file CSS tÃªn lÃ  theme.css á»Ÿ bÃªn ngoÃ i. Dá»± Ä‘oÃ¡n ráº±ng nÃ³ cÃ³ thá»ƒ cáº§n Ä‘áº¿n tÃ i nguyÃªn nÃ y Ä‘á»ƒ render trang, ngay láº­p tá»©c nÃ³ Ä‘iá»u phá»‘i 1 request Ä‘áº¿n. Giáº£ sá»­ file theme.css cÃ³ ná»™i dung nhÆ° sau: 12345678910111213141516171819body &#123; font-size: 16px;&#125;p &#123; font-weight: bold; &#125;span &#123; color: red; &#125;p span &#123; display: none; &#125;img &#123; float: right; &#125; TÆ°Æ¡ng tá»± HTML, engine cáº§n chuyá»ƒn táº¥t cáº£ CSS sang má»™t thá»© gÃ¬ Ä‘Ã³ mÃ  trÃ¬nh duyá»‡t cÃ³ thá»ƒ xá»­ lÃ½, chÃ­nh lÃ  CSSOM. DÆ°á»›i Ä‘Ã¢y lÃ  mÃ´ phá»ng cá»§a CSSOM tree: Báº¡n cÃ³ tá»± há»i táº¡i sao CSSOM láº¡i cÃ³ cáº¥u trÃºc dáº¡ng cÃ¢y (tree)? Khi tÃ­nh toÃ¡n bá»™ style cuá»‘i cÃ¹ng cho má»—i object tren trang, trÃ¬nh duyá»‡t sáº½ báº¯t Ä‘áº§u vá»›i rule Ã¡p dá»¥ng toÃ n cá»¥c nháº¥t cho node Ä‘Ã³ (vÃ­ dá»¥: náº¿u nÃ³ lÃ  con cá»§a pháº§n tá»­ body thÃ¬ Ã¡p dá»¥ng táº¥t cáº£ style cá»§a body) vÃ  tinh chá»‰nh má»™t cÃ¡ch Ä‘á»‡ quy nhá»¯ng style Ä‘Ã£ Ä‘Æ°á»£c tÃ­nh toÃ¡n báº±ng cÃ¡ch Ã¡p dá»¥ng cÃ¡c rule cá»¥ thá»ƒ hÆ¡n. Vá»›i vÃ­ dá»¥ á»Ÿ trÃªn, báº¥t ká»³ text nÃ o náº±m bÃªn trong tháº» span mÃ  span náº±m trong pháº§n tá»­ body thÃ¬ Ä‘á»u cÃ³ font-size 16 vÃ  mÃ u Ä‘á». Nhá»¯ng style nÃ y Ä‘Æ°á»£c káº¿ thá»«a tá»« pháº§n tá»­ body. Náº¿u nhÆ° span lÃ  con cá»§a pháº§n tá»­ p thÃ¬ ná»™i dung cá»§a nÃ³ sáº½ bá»‹ áº©n bá»Ÿi vÃ¬ cÃ³ style khÃ¡c cá»¥ thá»ƒ hÆ¡n Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng cho nÃ³ (á»Ÿ Ä‘Ã¢y lÃ  display: none). ThÃªm ná»¯a, lÆ°u Ã½ ráº±ng tree á»Ÿ trÃªn chÆ°a pháº£i lÃ  CSSOM tree hoÃ n chá»‰nh vÃ  chá»‰ thá»ƒ hiá»‡n nhá»¯ng style mÃ  ta Ä‘Ã£ ghi Ä‘Ã¨ trong style sheet. Má»—i trÃ¬nh duyá»‡t cung cáº¥p 1 bá»™ style máº·c Ä‘á»‹nh, cÃ²n Ä‘Æ°á»£c biáº¿t tá»›i lÃ  user agent styles - Ä‘Ã¢y chÃ­nh nhá»¯ng gÃ¬ ta tháº¥y náº¿u nhÆ° khÃ´ng cung cáº¥p style cá»¥ thá»ƒ. Style cá»§a chÃºng ta thÃªm vÃ o chá»‰ Ä‘Æ¡n giáº£n lÃ  ghi Ä‘Ã¨ láº¡i nhá»¯ng pháº§n máº·c Ä‘á»‹nh nÃ y. XÃ¢y dá»±ng render treeCÃ¹ng vá»›i pháº§n thá»ƒ hiá»‡n trá»±c quan trong HTML káº¿t há»£p vá»›i dá»¯ liá»‡u style tá»« CSSOM tree lÃ  chÃºng ta Ä‘Ã£ cÃ³ Ä‘á»§ nguyÃªn liá»‡u Ä‘á»ƒ táº¡o ra render tree. Báº¡n sáº½ tháº¯c máº¯c â€œrender treeâ€ lÃ  gÃ¬? NÃ³ lÃ  1 cÃ¢y (tree) cá»§a cÃ¡c pháº§n tá»­ trá»±c quan Ä‘Æ°á»£c xÃ¢y dá»±ng theo thá»© tá»± trong Ä‘Ã³ chÃºng Ä‘Æ°á»£c hiá»ƒn thá»‹ trÃªn mÃ n hÃ¬nh. ÄÃ³ lÃ  sá»± thá»ƒ hiá»‡n 1 cÃ¡ch trá»±c quan cá»§a HTML cÃ¹ng vá»›i CSS tÆ°Æ¡ng á»©ng. Má»¥c Ä‘Ã­ch cá»§a cÃ¢y nÃ y lÃ  cho phÃ©p tÃ´ mÃ u ná»™i dung theo Ä‘Ãºng thá»© tá»±. Má»—i node trong render tree Ä‘Æ°á»£c gá»i lÃ  1 renderer hoáº·c render object trong Webkit. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch mÃ  render tree cá»§a DOM &amp; CSSOM á»Ÿ trÃªn thá»ƒ hiá»‡n: Äá»ƒ xÃ¢y dá»±ng render tree, trÃ¬nh duyá»‡t vá» cÆ¡ báº£n sáº½ lÃ m nhá»¯ng bÆ°á»›c sau Ä‘Ã¢y: Báº¯t Ä‘áº§u tá»« root cá»§a DOM tree, nÃ³ sáº½ Ä‘i qua má»—i node tháº¥y Ä‘Æ°á»£c. VÃ i node cÃ³ thá»ƒ bá»‹ áº©n Ä‘i (vÃ­ dá»¥ nhÆ° tag script, meta, vÃ¢n vÃ¢n) hoáº·c bá» qua bá»Ÿi vÃ¬ chÃºng khÃ´ng pháº£n chiáº¿u trong káº¿t quáº£ render Ä‘áº§u ra. VÃ i node bá»‹ áº©n bá»Ÿi CSS vÃ  cÅ©ng bá»‹ bá» qua khá»i render tree. VÃ­ dá»¥ nhÆ° node span trong vÃ­ dá»¥ trÃªn thÃ¬ nÃ³ sáº½ khÃ´ng cÃ³ máº·t trong render tree vÃ¬ Ä‘Ã£ Ä‘Æ°á»£c set style display: none rá»“i. Vá»›i má»—i node tháº¥y Ä‘Æ°á»£c, trÃ¬nh duyá»‡t sáº½ tÃ¬m cÃ¡c rule CSSOM phÃ¹ há»£p vÃ  khá»›p vá»›i nÃ³ rá»“i Ã¡p dá»¥ng vÃ o. TrÃ¬nh duyá»‡t sáº½ xuáº¥t ra cÃ¡c node tháº¥y Ä‘Æ°á»£c vá»›i ná»™i dung vÃ  style tÆ°Æ¡ng á»©ng. Báº¡n cÃ³ thá»ƒ xem qua source code cá»§a RenderObject (WebKit) á»Ÿ Ä‘Ã¢y: https://github.com/WebKit/webkit/blob/fde57e46b1f8d7dde4b2006aaf7ebe5a09a6984b/Source/WebCore/rendering/RenderObject.h CÃ¹ng nghÃ­a qua má»™t vÃ i dÃ²ng cá»‘t lÃµi trong class nÃ y nhÃ©: 1234567891011class RenderObject : public CachedImageClient &#123; // TÃ´ mÃ u láº¡i toÃ n bá»™ object. NÃ³ sáº½ Ä‘Æ°á»£c gá»i khi border color thay Ä‘á»•i hoáº·c // border style thay Ä‘á»•i. Node* node() const &#123; ... &#125; RenderStyle* style; // the computed style const RenderStyle&amp; style() const; ...&#125; Má»—i renderer thá»ƒ hiá»‡n má»™t khu vá»±c hÃ¬nh chá»¯ nháº­t tÆ°Æ¡ng á»©ng vá»›i CSS box cá»§a má»™t node. NÃ³ bao gá»“m cáº£ thÃ´ng tin hÃ¬nh há»c nhÆ° Ä‘á»™ rá»™ng (width), chiá»u cao (height) hay vá»‹ trÃ­ (position). CÃ¡ch bá»‘ trÃ­ cá»§a render treeKhi renderer Ä‘Æ°á»£c táº¡o ra vÃ  thÃªm vÃ o tree, nÃ³ khÃ´ng cÃ³ thÃ´ng tin vá»‹ trÃ­ hay kÃ­ch thÆ°á»›c, pháº§n tÃ­nh toÃ¡n cÃ¡c giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c gá»i lÃ  layout. HTML sá»­ dá»¥ng mÃ´ hÃ¬nh layout theo dÃ²ng (flow-based layout), nghÄ©a lÃ  háº§u nhÆ° toÃ n bá»™ thá»i gian nÃ³ cÃ³ thá»ƒ tÃ­nh toÃ¡n thÃ´ng sá»‘ hÃ¬nh há»c chá»‰ trong 1 láº§n duyá»‡t. Há»‡ thá»‘ng tá»a Ä‘á»™ cÃ³ liÃªn quan Ä‘áº¿n root renderer. ThÃ´ng sá»‘ tá»a Ä‘á»™ top vÃ  left Ä‘Æ°á»£c sá»­ dá»¥ng. Layout lÃ  1 quÃ¡ trÃ¬nh Ä‘á»‡ quy, nÃ³ báº¯t Ä‘áº§u á»Ÿ root renderer, chÃ­nh lÃ  thá»© tÆ°Æ¡ng á»©ng vá»›i pháº§n tá»­ trong vÄƒn báº£n HTML. Layout tiáº¿p tá»¥c duyá»‡t Ä‘á»‡ quy qua má»™t hoáº·c toÃ n bá»™ cÃ¢y cáº¥p báº­c(hierarchy) renderer, tÃ­nh toÃ¡n cÃ¡c thÃ´ng tin hÃ¬nh há»c cáº§n thiáº¿t cho má»—i renderer. Vá»‹ trÃ­ cá»§a root renderer lÃ  0,0 vÃ  kÃ­ch thÆ°á»›c cá»§a nÃ³ báº±ng pháº§n nhÃ¬n tháº¥y Ä‘Æ°á»£c cá»§a cá»­a sá»• hiá»ƒn thá»‹ trÃªn trÃ¬nh duyá»‡t (cÃ²n gá»i lÃ  viewport). Báº¯t Ä‘áº§u quÃ¡ trÃ¬nh táº¡o layout chÃ­nh lÃ  truyá»n Ä‘áº¡t láº¡i cho má»—i node tá»a Ä‘á»™ chÃ­nh xÃ¡c mÃ  nÃ³ cáº§n pháº£i xuáº¥t hiá»‡n trÃªn mÃ n hÃ¬nh lÃ  á»Ÿ Ä‘Ã¢u. TÃ´ mÃ u cho render treeTrong giai Ä‘oáº¡n nÃ y, renderer tree Ä‘Ã£ Ä‘Æ°á»£c duyá»‡t qua vÃ  phÆ°Æ¡ng thá»©c paint() cá»§a renderer Ä‘Æ°á»£c gá»i Ä‘á»ƒ hiá»ƒn thá»‹ ná»™i dung lÃªn mÃ n hÃ¬nh. TÃ´ mÃ u cÃ³ thá»ƒ theo cÃ¡ch global hoáº·c incremantal tÆ°Æ¡ng tá»± nhÆ° layout): Global (toÃ n cá»¥c): toÃ n bá»™ tree Ä‘Æ°á»£c lÃªn mÃ u. Incremental (gia tÄƒng): chá»‰ cÃ³ má»™t vÃ i renderer thay Ä‘á»•i theo cÃ¡ch khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n toÃ n bá»™ tree. Renderer vÃ´ hiá»‡u hÃ³a khung chá»¯ nháº­t cá»§a chÃ­nh nÃ³ trÃªn mÃ n hÃ¬nh. Äiá»u nÃ y lÃ m cho OS (há»‡ Ä‘iá»u thÃ nh) hiá»ƒu ráº±ng vÃ¹ng Ä‘Ã³ cáº§n pháº£i Ä‘Æ°á»£c tÃ´ mÃ u láº¡i vÃ  sinh ra má»™t paint event. OS thá»±c hiá»‡n Ä‘iá»u Ä‘Ã³ má»™t cÃ¡ch thÃ´ng minh báº±ng cÃ¡ch gá»™p nhiá»u vÃ¹ng thÃ nh má»™t. Vá» tá»•ng quÃ¡t thÃ¬ quan trá»ng lÃ  cáº§n pháº£i hiá»ƒu ráº±ng tÃ´ mÃ u lÃ  quÃ¡ trÃ¬nh diá»…n ra tá»« tá»«. Äá»ƒ cÃ³ UX tá»‘t hÆ¡n, render engine sáº½ cá»‘ hiá»ƒn thá»‹ ná»™i dung trÃªn mÃ n hÃ¬nh ngay khi cÃ³ thá»ƒ. NÃ³ sáº½ khÃ´ng ngá»“i yÃªn Ä‘á»£i cho tá»›i khi toÃ n bá»™ HTML Ä‘Æ°á»£c parse Ä‘á»ƒ báº¯t Ä‘áº§u xÃ¢y dá»±ng vÃ  bá»‘ trÃ­ render tree. Tá»«ng pháº§n cá»§a ná»™i dung sáº½ Ä‘Æ°á»£c parse vÃ  hiá»ƒn thá»‹ lÃªn trong khi tiáº¿n trÃ¬nh tiáº¿p tá»¥c vá»›i nhá»¯ng item ná»™i dung tiáº¿p theo Ä‘ang Ä‘Æ°á»£c truyá»n vá» trÃªn máº¡ng. Thá»© tá»± xá»­ lÃ½ script vÃ  styleCÃ¡c script Ä‘Æ°á»£c parse vÃ  thá»±c thi ngay láº­p tá»©c khi parser vá»«a gáº·p tháº» &lt;script&gt;. QuÃ¡ trÃ¬nh parse cá»§a toÃ n bá»™ vÄƒn báº£n sáº½ táº¡m dá»«ng cho Ä‘áº¿n khi script thá»±c thi xong. NghÄ©a lÃ  tiáº¿n trÃ¬nh nÃ y diá»…n ra Ä‘á»“ng bá»™. Náº¿u nhÆ° script lÃ  file á»Ÿ ngoÃ i thÃ¬ viá»‡c Ä‘áº§u tiÃªn nÃ³ cáº§n pháº£i Ä‘Æ°á»£c láº¥y vá» tá»« máº¡ng (báº¥t Ä‘á»“ng bá»™). Táº¥t cáº£ cÃ´ng viá»‡c parse sáº½ dá»«ng láº¡i cho Ä‘áº¿n khi láº¥y xong file. HTML5 cÃ³ thÃªm 1 tÃ¹y chá»n Ä‘á»ƒ Ä‘Ã¡nh dáº¥u script lÃ  báº¥t Ä‘á»“ng bá»™, do Ä‘Ã³ nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c parse vÃ  thá»±c thi trong 1 tiáº¿n trÃ¬nh khÃ¡c. Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t renderNáº¿u báº¡n muá»‘n tá»‘i Æ°u hÃ³a app thÃ¬ cÃ³ 5 Ä‘iá»ƒm chÃ­nh mÃ  báº¡n cáº§n táº­p trung vÃ o dÆ°á»›i Ä‘Ã¢y: Javascript - trong cÃ¡c bÃ i trÆ°á»›c chÃºng ta Ä‘Ã£ nghiÃªn cá»©u vá» chá»§ Ä‘á» viáº¿t code tá»‘i Æ°u vÃ  cÃ³ hiá»‡u quáº£ bá»™ nhá»› cao mÃ  khÃ´ng lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n UI. Vá»›i trÆ°á»ng há»£p cá»§a render, chÃºng ta cáº§n pháº£i suy nghÄ© vá» cÃ¡ch mÃ  code Javascript sáº½ tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c pháº§n tá»­ DOM trÃªn trang. Javascript cÃ³ thá»ƒ táº¡o ra ráº¥t nhiá»u thay Ä‘á»•i vá»›i UI, Ä‘áº·c biá»‡t lÃ  cÃ¡c app SPA. TÃ­nh toÃ¡n Style - Ä‘Ã¢y lÃ  tiáº¿n trÃ¬nh xÃ¡c Ä‘á»‹nh CSS rule nÃ o sáº½ Ã¡p dá»¥ng vÃ o pháº§n tá»­ nÃ o dá»±a trÃªn cÃ¡c selector. Má»™t khi cÃ¡c rule Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a, chÃºng sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng vÃ  tÃ­nh toÃ¡n style cuá»‘i cÃ¹ng cho má»—i pháº§n tá»­. Layout - khi trÃ¬nh duyá»‡t biáº¿t rule nÃ o Ã¡p dá»¥ng cho pháº§n tá»­ nÃ o, nÃ³ cÃ³ thá»ƒ báº¯t Ä‘áº§u tÃ­nh toÃ¡n bao nhiÃªu khÃ´ng gian má»™t pháº§n tá»­ sáº½ chiáº¿m dá»¥ng vÃ  vá»‹ trÃ­ cá»§a nÃ³ sáº½ náº±m á»Ÿ Ä‘Ã¢u trÃªn mÃ n hÃ¬nh cá»§a trÃ¬nh duyá»‡t. MÃ´ hÃ¬nh layout cá»§a trang web xÃ¡c Ä‘á»‹nh má»™t pháº§n tá»­ cÃ³ thá»ƒ gÃ¢y áº£nh hÆ°á»Ÿng Ä‘áº¿n pháº§n tá»­ khÃ¡c. VÃ­ dá»¥, Ä‘á»™ rá»™ng cá»§a cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘á»™ rá»™ng cá»§a pháº§n tá»­ con cá»§a nÃ³. Äiá»u nÃ y nghÄ©a lÃ  quÃ¡ trÃ¬nh layout sáº½ lÃ  quÃ¡ trÃ¬nh náº·ng vá» tÃ­nh toÃ¡n sá»‘ há»c. Pháº§n â€œváº½â€ Ä‘Æ°á»£c thá»±c hiá»‡n trong nhiá»u layer khÃ¡c nhau. TÃ´ mÃ u - Ä‘Ã¢y lÃ  lÃºc mÃ  cÃ¡c pixel thá»±c sá»± Ä‘Æ°á»£c lÃªn mÃ u. Tiáº¿n trÃ¬nh bao gá»“m cáº£ pháº§n váº½ cÃ¡c cÃ¢u chá»¯, mÃ u sáº¯c, hÃ¬nh áº£nh, viá»n, Ä‘á»• bÃ³ng, váº¥n vÃ¢n, tá»«ng pháº§n nhÃ¬n tháº¥y Ä‘Æ°á»£c cá»§a tá»«ng pháº§n tá»­. Káº¿t há»£p (Compositing) - Bá»Ÿi vÃ¬ cÃ¡c pháº§n nhá» cá»§a webpage Ä‘Æ°á»£c váº½ vÃ o trong nhiá»u lá»›p khÃ¡c nhau, chÃºng cáº§n Ä‘Æ°á»£c káº¿t há»£p vÃ o má»™t mÃ n hÃ¬nh theo Ä‘Ãºng thá»© tá»± Ä‘á»ƒ page cÃ³ thá»ƒ render má»™t cÃ¡ch chÃ­nh xÃ¡c. Äiá»u nÃ y ráº¥t quan trá»ng, Ä‘áº·c biá»‡t lÃ  vá»›i cÃ¡c pháº§n tá»­ chá»“ng nhau. Tá»‘i Æ°u hÃ³a JavaScriptJavascript thÆ°á»ng trigger nhá»¯ng thay Ä‘á»•i nhÃ¬n tháº¥y Ä‘Æ°á»£c trÃªn trÃ¬nh duyá»‡t. VÃ  nhá»¯ng tÃ¡c vá»¥ Ä‘Ã³ nhÃ¢n lÃªn nhiá»u láº§n khi xÃ¢y dá»±ng á»©ng dá»¥ng SPA. DÆ°á»›i Ä‘Ã¢y lÃ  1 sá»‘ máº¹o nhá» Ä‘á»ƒ báº¡n biáº¿t nÃªn tá»‘i Æ°u pháº§n nÃ o cá»§a code Javascript nháº±m cáº£i thiá»‡n render: TrÃ¡nh sá»­ dá»¥ng setTimeout vÃ  setInterval Ä‘á»‘i vá»›i nhá»¯ng cáº­p nháº­t nhÃ¬n tháº¥y Ä‘Æ°á»£c. Hai hÃ m nÃ y sáº½ gá»i callback táº¡i 1 thá»i Ä‘iá»ƒm nÃ o Ä‘Ã³ trong frame, cÃ³ thá»ƒ lÃ  cuá»‘i frame. Thá»© chÃºng ta cáº§n lÃ  trigger thay Ä‘á»•i ngay khi báº¯t Ä‘áº§u frame Ä‘á»ƒ trÃ¡nh bá»‹ sÃ³t. ÄÆ°a nhá»¯ng tÃ­nh toÃ¡n Javascript phá»©c táº¡p vÃ  tá»‘n thá»i gian vÃ o trong Web Workers nhÆ° chÃºng ta Ä‘Ã£ tháº£o luáº­n á»Ÿ bÃ i trÆ°á»›c. Sá»­ dá»¥ng cÃ¡c tÃ¡c vá»¥ siÃªu nhá» (micro-tasks) Ä‘á»ƒ thÃ´ng bÃ¡o sá»± thay Ä‘á»•i cá»§a DOM vá»›i nhiá»u frame. DÃ¹ng trong trÆ°á»ng há»£p cÃ¡c tÃ¡c vá»¥ cáº§n truy xuáº¥t vÃ o DOM, Ä‘iá»u nÃ y Web Workers khÃ´ng lÃ m Ä‘Æ°á»£c. Vá» cÆ¡ báº£n thÃ¬ nÃ³ nghÄ©a lÃ  báº¡n cáº§n chia nhá» 1 tÃ¡c vá»¥ lá»›n thÃ nh nhiá»u pháº§n nhá» hÆ¡n vÃ  cháº¡y chÃºng bÃªn trong cÃ¡c hÃ m requestAnimationFrame, setTimeout, setInterval tÃ¹y thuá»™c vÃ o Ä‘áº·c tÃ­nh cá»§a má»—i tÃ¡c vá»¥. Tá»‘i Æ°u hÃ³a CSSChá»‰nh sá»­a DOM báº±ng cÃ¡ch thÃªm bá»›t cÃ¡c pháº§n tá»­, thay Ä‘á»•i cÃ¡c thuá»™c tÃ­nhâ€¦ sáº½ lÃ m cho trÃ¬nh duyá»‡t pháº£i tÃ­nh toÃ¡n láº¡i style cá»§a pháº§n tá»­ vÃ  trong nhiá»u trÆ°á»ng há»£p, lÃ  pháº£i tÃ­nh láº¡i layout cá»§a toÃ n bá»™ trang hoáº·c 1 pháº§n cá»§a trang. Äá»ƒ tá»‘i Æ°u quÃ¡ trÃ¬nh render, báº¡n cáº§n cÃ¢n nháº¯c nhá»¯ng Ä‘iá»u sau: Giáº£m thiá»ƒu sá»± phá»©c táº¡p trong cÃ¡c selector. Sá»± phá»©c táº¡p cá»§a selector cÃ³ thá»ƒ chiáº¿m Ä‘áº¿n hÆ¡n 50% thá»i gian cáº§n thiáº¿t Ä‘á»ƒ tÃ­nh toÃ¡n style cho 1 pháº§n tá»­ (pháº§n cÃ²n láº¡i lÃ  thá»i gian Ä‘á»ƒ xÃ¢y dá»±ng style). Giáº£m sá»‘ lÆ°á»£ng pháº§n tá»­ cáº§n Ä‘Æ°á»£c tÃ­nh toÃ¡n style. Vá» báº£n cháº¥t thÃ¬ thay Ä‘á»•i style trá»±c tiáº¿p cho 1 vÃ i pháº§n tá»­ thÃ¬ tá»‘t hÆ¡n lÃ  vÃ´ hiá»‡u toÃ n bá»™ page. Tá»‘i Æ°u hÃ³a layoutTÃ­nh toÃ¡n láº¡i layout cÃ³ thá»ƒ ngá»‘n nhiá»u tÃ i nguyÃªn cá»§a trÃ¬nh duyá»‡t nÃªn báº¡n cáº§n cÃ¢n nháº¯c nhá»¯ng Ä‘iá»u sau: Giáº£m sá»‘ lÆ°á»£ng layout báº¥t cá»© khi nÃ o cÃ³ thá»ƒ. Khi báº¡n thay Ä‘á»•i style thÃ¬ trÃ¬nh duyá»‡t kiá»ƒm tra Ä‘á»ƒ xem thá»­ cÃ³ thay Ä‘á»•i nÃ o cáº§n layout pháº£i Ä‘Æ°á»£c tÃ­nh toÃ¡n láº¡i khÃ´ng. CÃ¡c thay Ä‘á»•i vá» property nhÆ° width, height, left, top vÃ  trÃªn háº¿t lÃ  nhá»¯ng property nÃ o liÃªn quan Ä‘áº¿n hÃ¬nh há»c, cáº§n cÃ³ layout. VÃ¬ tháº¿ trÃ¡nh thay Ä‘á»•i chÃºng háº¿t má»©c cÃ³ thá»ƒ. DÃ¹ng flexbox báº¥t cá»© khi nÃ o cÃ³ thá»ƒ dÃ¹ng. NÃ³ cháº¡y nhanh hÆ¡n vÃ  cÃ³ thá»ƒ cáº£i thiá»‡n hiá»‡u nÄƒng má»™t cÃ¡ch Ä‘Ã¡ng ká»ƒ. TrÃ¡nh Ã©p buá»™c layout Ä‘á»“ng bá»™. Nhá»› ráº±ng khi Javascript cháº¡y, táº¥t cáº£ giÃ¡ trá»‹ cá»§a layout cÅ© tá»« frame trÆ°á»›c Ä‘Ã³ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh vÃ  sáºµn sÃ ng cho báº¡n truy váº¥n. KhÃ´ng váº¥n Ä‘á» gÃ¬ náº¿u nhÆ° báº¡n muá»‘n truy xuáº¥t box.offsetHeight. Tuy nhiÃªn, náº¿u báº¡n thay Ä‘á»•i style cá»§a box trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c truy xuáº¥t (vÃ­ dá»¥: cá»‘ tÃ¬nh thÃªm CSS class vÃ o 1 pháº§n tá»­), trÃ¬nh duyá»‡t Ä‘áº§u tiÃªn sáº½ Ã¡p dá»¥ng thay Ä‘á»•i cá»§a style rá»“i sau Ä‘Ã³ má»›i cháº¡y Ä‘áº¿n pháº§n layout. Äiá»u cÃ³ cÃ³ thá»ƒ gÃ¢y tá»‘n thá»i gian vÃ  lÃ m áº£nh hÆ°á»Ÿng náº·ng Ä‘áº¿n tÃ i nguyÃªn mÃ¡y tÃ­nh, vÃ¬ tháº¿ nÃªn trÃ¡nh cÃ ng xa nÃ³ cÃ ng tá»‘t. Tá»‘i Æ°u hÃ³a tÃ´ mÃ uÄÃ¢y thÆ°á»ng lÃ  tÃ¡c vá»¥ cháº¡y lÃ¢u nháº¥t trong sá»‘ cÃ¡c tÃ¡c vá»¥ nÃªn quan trá»ng lÃ  trÃ¡nh máº·t nÃ³ cÃ ng xa cÃ ng tá»‘t. Nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ lÃ m: Thay Ä‘á»•i báº¥t ká»³ property nÃ o khÃ¡c ngoÃ i transform hay opacity sáº½ trigger tÃ¡c vá»¥ tÃ´ mÃ u. Nhá»› sá»­ dá»¥ng tiáº¿t kiá»‡m nhÃ©. Náº¿u báº¡n trigger má»™t layout, báº¡n cÅ©ng sáº½ trigger luÃ´n tÃ¡c vá»¥ tÃ´ mÃ u bá»Ÿi vÃ¬ thay Ä‘á»•i vá» kÃ­ch thÆ°á»›c hÃ¬nh há»c cÅ©ng sáº½ thay Ä‘á»•i pháº§n nhÃ¬n tháº¥y Ä‘Æ°á»£c cá»§a pháº§n tá»­. Giáº£m diá»‡n tÃ­ch tÃ´ mÃ u thÃ´ng qua thÄƒng cáº¥p layer vÃ  dÃ n dá»±ng cÃ¡c animation. Render lÃ  má»™t khÃ­a cáº¡nh quan trá»ng trong cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a SessionStack. SessionStack pháº£i tÃ¡i táº¡o láº¡i má»™t video vá» má»i thá»© Ä‘Ã£ diá»…n ra vá»›i user táº¡i thá»i Ä‘iá»ƒm há» tráº£i nghiá»‡m qua má»™t váº¥n Ä‘á» khi Ä‘ang lÆ°á»›t webapp cá»§a báº¡n. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y, SessionStack chá»‰ xá»­ lÃ½ duy nháº¥t nhá»¯ng dá»¯ liá»‡u mÃ  thÆ° viá»‡n cá»§a nÃ³ thu tháº­p Ä‘Æ°á»£c: cÃ¡c sá»± kiá»‡n tá»« user, thay Ä‘á»•i trÃªn DOM, request lÃªn máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o debug, vÃ¢n vÃ¢n. TrÃ¬nh phÃ¡t video Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a tá»‘i Ä‘a Ä‘á»ƒ cÃ³ thá»ƒ render má»™t cÃ¡ch chÃ­nh xÃ¡c vÃ  sá»­ dá»¥ng toÃ n bá»™ nhá»¯ng dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c Ä‘á»ƒ cÃ³ thá»ƒ Ä‘Æ°a ra má»™t báº£n giáº£ láº­p trÃ¬nh duyá»‡t cá»§a user hoÃ n-háº£o-Ä‘áº¿n-tá»«ng-pixel cÅ©ng nhÆ° nhá»¯ng gÃ¬ Ä‘Ã£ xáº£y ra trÃªn Ä‘Ã³, cáº£ vá» máº·t ká»¹ thuáº­t láº«n quan sÃ¡t.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P10: Quan sÃ¡t thay Ä‘á»•i trÃªn DOM báº±ng MutationObserver","slug":"Cach-Javascript-hoat-dong-P10-Quan-sat-thay-doi-tren-DOM-bang-MutationObserver","date":"2018-11-25T08:24:00.000Z","updated":"2018-11-25T08:29:18.823Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P10-Quan-sat-thay-doi-tren-DOM-bang-MutationObserver.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P10-Quan-sat-thay-doi-tren-DOM-bang-MutationObserver.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 10 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Webapp cÃ ng ngÃ y cÃ ng náº·ng hÆ¡n á»Ÿ phÃ­a client bá»Ÿi vÃ¬ nhiá»u lÃ½ do Ä‘áº¡i loáº¡i nhÆ° UI pháº£i â€œphÃ¬ nhiÃªuâ€ Ä‘á»ƒ chá»©a Ä‘á»±ng nhá»¯ng thá»© logic phá»©c táº¡p bÃªn trong bao gá»“m cáº£ tÃ­nh toÃ¡n theo thá»i gian thá»±c (real-time), vÃ  nhiá»u nhiá»u thá»© khÃ¡c ná»¯a. Sá»± phá»©c táº¡p gia tÄƒng lÃ m cho chÃºng ta khÃ³ náº¯m báº¯t chÃ­nh xÃ¡c tráº¡ng thÃ¡i cá»§a UI táº¡i má»—i thá»i Ä‘iá»ƒm trong vÃ²ng Ä‘á»i cá»§a webapp. Äiá»u nÃ y cÃ ng khÃ³ hÆ¡n ná»¯a náº¿u chÃºng ta xÃ¢y dá»±ng má»™t vÃ i thá»© cháº³ng háº¡n nhÆ° library hay framework mÃ  cáº§n pháº£i pháº£n á»©ng cÅ©ng nhÆ° xá»­ lÃ½ nhá»¯ng hÃ nh Ä‘á»™ng dá»±a trÃªn DOM.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 10 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Webapp cÃ ng ngÃ y cÃ ng náº·ng hÆ¡n á»Ÿ phÃ­a client bá»Ÿi vÃ¬ nhiá»u lÃ½ do Ä‘áº¡i loáº¡i nhÆ° UI pháº£i â€œphÃ¬ nhiÃªuâ€ Ä‘á»ƒ chá»©a Ä‘á»±ng nhá»¯ng thá»© logic phá»©c táº¡p bÃªn trong bao gá»“m cáº£ tÃ­nh toÃ¡n theo thá»i gian thá»±c (real-time), vÃ  nhiá»u nhiá»u thá»© khÃ¡c ná»¯a. Sá»± phá»©c táº¡p gia tÄƒng lÃ m cho chÃºng ta khÃ³ náº¯m báº¯t chÃ­nh xÃ¡c tráº¡ng thÃ¡i cá»§a UI táº¡i má»—i thá»i Ä‘iá»ƒm trong vÃ²ng Ä‘á»i cá»§a webapp. Äiá»u nÃ y cÃ ng khÃ³ hÆ¡n ná»¯a náº¿u chÃºng ta xÃ¢y dá»±ng má»™t vÃ i thá»© cháº³ng háº¡n nhÆ° library hay framework mÃ  cáº§n pháº£i pháº£n á»©ng cÅ©ng nhÆ° xá»­ lÃ½ nhá»¯ng hÃ nh Ä‘á»™ng dá»±a trÃªn DOM. KhÃ¡i quÃ¡tMutationObserver (táº¡m dá»‹ch: NgÆ°á»i quan sÃ¡t sá»± biáº¿n Ä‘á»•i) lÃ  má»™t WebAPI Ä‘Æ°á»£c cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i cung cáº¥p Ä‘á»ƒ phÃ¡t hiá»‡n cÃ¡c thay Ä‘á»•i trÃªn DOM. Vá»›i API nÃ y má»™t ngÆ°á»i cÃ³ thá»ƒ listen cÃ¡c node má»›i Ä‘Æ°á»£c thÃªm vÃ o hoáº·c gá»¡ ra, thuá»™c tÃ­nh thay Ä‘á»•i hoáº·c nhá»¯ng thay Ä‘á»•i vá» ná»™i dung vÄƒn báº£n trong má»™t text node. Táº¡i sao pháº£i cáº§n lÃ m tháº¿? CÃ³ má»™t sá»‘ Ã­t trÆ°á»ng há»£p trong Ä‘Ã³ MutationObserver API thá»±c sá»± há»¯u Ã­ch. VÃ­ dá»¥: Báº¡n muá»‘n thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng webapp ráº±ng má»™t vÃ i sá»± thay Ä‘á»•i Ä‘Ã£ xáº£y ra trÃªn trang mÃ  ngÆ°á»i Ä‘Ã³ Ä‘ang sá»­ dá»¥ng. Báº¡n Ä‘ang lÃ m viá»‡c vá»›i 1 Javascript framework sang cháº£nh má»›i, nÃ³ cáº§n load ráº¥t nhiá»u JS module má»™t cÃ¡ch tá»± Ä‘á»™ng dá»±a trÃªn sá»± thay Ä‘á»•i cá»§a DOM. Báº¡n Ä‘ang lÃ m viá»‡c vá»›i bá»™ soáº¡n tháº£o WYSIWYG vÃ  thá»­ triá»ƒn khai tÃ­nh nÄƒng undo/redo. Báº±ng cÃ¡ch táº­n dá»¥ng MutationObserver API, báº¥t ká»³ lÃºc nÃ o báº¡n cÅ©ng cÃ³ thá»ƒ biáº¿t pháº§n nÃ o Ä‘Ã£ thay Ä‘á»•i vÃ  dá»… dÃ ng undo chÃºng. TrÃªn Ä‘Ã¢y chá»‰ lÃ  1 sá»‘ vÃ­ dá»¥ vá» lá»£i Ã­ch cá»§a MutationObserver. CÃ¡ch sá»­ dá»¥ng MutationObserverTriá»ƒn khai MutationObserver khÃ¡ dá»… dÃ ng. Báº¡n cáº§n táº¡o 1 instance MutationObserver báº±ng cÃ¡ch truyá»n cho nÃ³ 1 hÃ m vÃ  hÃ m nÃ y Ä‘Æ°á»£c gá»i má»—i khi 1 sá»± thay Ä‘á»•i xáº£y ra. Äá»‘i sá»‘ Ä‘áº§u tiÃªn cá»§a hÃ m lÃ  1 táº­p há»£p táº¥t cáº£ cÃ¡c sá»± thay Ä‘á»•i xáº£y ra trÃªn 1 khá»‘i duy nháº¥t. Má»—i sá»± thay Ä‘á»•i cung cáº¥p thÃ´ng tin vá» loáº¡i cá»§a nÃ³ cÅ©ng nhÆ° thay Ä‘á»•i nÃ o Ä‘Ã£ xáº£y ra. 12345var mutationObserver = new MutationObserver(function(mutations) &#123; mutations.forEach(function(mutation) &#123; console.log(mutation); &#125;);&#125;); Object táº¡o ra cÃ³ 3 phÆ°Æ¡ng thá»©c: observe: báº¯t Ä‘áº§u láº¯ng nghe sá»± thay Ä‘á»•i. NÃ³ nháº­n 2 Ä‘á»‘i sá»‘: DOM node mÃ  báº¡n muá»‘n quan sÃ¡t vÃ  má»™t object chÆ°a cÃ¡c thiáº¿t láº­p. disconnect: dá»«ng quÃ¡ trÃ¬nh láº¯ng nghe thay Ä‘á»•i. takeRecords: tráº£ vá» khá»‘i thay Ä‘á»•i cuá»‘i cÃ¹ng trÆ°á»›c khi callback Ä‘Æ°á»£c kÃ­ch hoáº¡t. Äoáº¡n code sau thá»ƒ hiá»‡n quÃ¡ trÃ¬nh quan sÃ¡t (observing) diá»…n ra: 123456789// Báº¯t Ä‘áº§u láº¯ng nghe thay Ä‘á»•i trong root HTML cá»§a trang.mutationObserver.observe(document.documentElement, &#123; attributes: true, characterData: true, childList: true, subtree: true, attributeOldValue: true, characterDataOldValue: true&#125;); Giá» giáº£ sá»­ ta cÃ³ 1 div cá»±c ká»³ Ä‘Æ¡n giáº£n trong DOM: 1&lt;div id=\"sample-div\" class=\"test\"&gt; Simple div &lt;/div&gt; Sá»­ dá»¥ng jQuery, báº¡n cÃ³ thá»ƒ xÃ³a thuá»™c tÃ­nh class tá»« div Ä‘Ã³: 1$(\"#sample-div\").removeAttr(\"class\"); Khi Ä‘Ã£ báº¯t Ä‘áº§u quan sÃ¡t, sau khi gá»i hÃ m mutationObserver.observe(â€¦) ta cÃ³ thá»ƒ xem thÃ´ng tin log Ä‘Æ°á»£c in ra trong console cá»§a MutationRecord. ÄÃ¢y lÃ  sá»± biáº¿n Ä‘á»•i táº¡o ra bá»Ÿi ta Ä‘Ã£ xÃ³a thuá»™c tÃ­nh class. Cuá»‘i cÃ¹ng, Ä‘á»ƒ dá»«ng sá»± quan sÃ¡t DOM sau khi Ä‘Ã£ xong viá»‡c, ta lÃ m nhÆ° sau: 12// Dá»«ng MutationObserver, khÃ´ng láº¯ng nghe thay Ä‘á»•i ná»¯a.mutationObserver.disconnect(); NgÃ y nay MutationObserver Ä‘Æ°á»£c há»— trá»£ khÃ¡ tá»‘t: Giáº£i phÃ¡p thay tháº¿Tuy nhiÃªn, MutationObserver cÅ©ng chá»‰ má»›i xuáº¥t hiá»‡n chÆ°a lÃ¢u. Váº­y thÃ¬ trÆ°á»›c khi cÃ³ nÃ³, cÃ¡c developer dÃ¹ng cÃ¡i gÃ¬? DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ i lá»±a chá»n: Polling MutationEvents CSS animations PollingGiáº£i phÃ¡p Ä‘Æ¡n giáº£n nháº¥t vÃ  kÃ©m tinh táº¿ nháº¥t lÃ  polling (bá» phiáº¿u bÃ¬nh chá»n). Sá»­ dá»¥ng WebAPI setInterval báº¡n cÃ³ thá»ƒ thiáº¿t láº­p 1 tÃ¡c vá»¥ kiá»ƒm tra sá»± thay Ä‘á»•i theo chu ká»³ nháº¥t Ä‘á»‹nh. DÄ© nhiÃªn thÃ¬ cÃ¡ch nÃ y lÃ m giáº£m hiá»‡u nÄƒng cá»§a webapp 1 cÃ¡ch Ä‘Ã¡ng sá»£. MutationEventsMutationEvents API Ä‘Æ°á»£c giá»›i thiá»‡u vÃ o nÄƒm 2000. Máº·c dÃ¹ nÃ³ cÃ³ Ã­ch, cÃ¡c sá»± kiá»‡n thay Ä‘á»•i (mutation events) Ä‘Æ°á»£c báº¯n ra má»—i khi cÃ³ 1 sá»± thay Ä‘á»•i báº¥t ká»³ trÃªn DOM vÃ  má»™t láº§n ná»¯a lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u nÄƒng. NgÃ y nay thÃ¬ MutationEvents API Ä‘Ã£ bá»‹ há»§y bá» vÃ  nhá»¯ng trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i sáº½ sá»›m ngá»«ng há»— trá»£ nÃ³. Danh má»¥c trÃ¬nh duyá»‡t há»— trá»£ cho MutationEvents: CSS animationsMá»™t giáº£i phÃ¡p thay tháº¿ hÆ¡i ká»³ cá»¥c Ä‘Ã³ lÃ  dá»±a trÃªn CSS Animations. Nghe cÃ³ váº» bá»‘i rá»‘i nhá»‰. Vá» cÆ¡ báº£n thÃ¬ Ã½ tÆ°á»Ÿng cá»§a nÃ³ lÃ  táº¡o ra 1 animation cÃ³ thá»ƒ Ä‘Æ°á»£c trigger khi cÃ³ má»™t element Ä‘Æ°á»£c thÃªm vÃ o DOM. Khoáº£nh kháº¯c animation báº¯t Ä‘áº§u, sá»± kiá»‡n animationstart sáº½ Ä‘Æ°á»£c báº¯n ra: náº¿u báº¡n Ä‘Ã£ gáº¯n 1 event handler vÃ o sá»± kiá»‡n Ä‘Ã³ thÃ¬ báº¡n sáº½ biáº¿t 1 cÃ¡ch chÃ­nh xÃ¡c khi nÃ o element Ä‘Æ°á»£c thÃªm vÃ o DOM. Thá»i gian thá»±c hiá»‡n cá»§a animation pháº£i cá»±c nhá» Ä‘á»ƒ cho nÃ³ dÆ°á»ng nhÆ° vÃ´ hÃ¬nh trÆ°á»›c con máº¯t user. Äáº§u tiÃªn ta cáº§n má»™t element cha, bÃªn trong nÃ³ ta sáº½ listen sá»± kiá»‡n chÃ¨n node: 1&lt;div id=â€container-elementâ€&gt;&lt;/div&gt; Äá»ƒ cÃ³ thá»ƒ xá»­ lÃ½ khi cÃ³ node chÃ¨n vÃ o, ta cáº§n thiáº¿t láº­p má»™t chuá»—i cÃ¡c keyframe animation khá»Ÿi Ä‘á»™ng khi node Ä‘Æ°á»£c thÃªm vÃ o: 1234@keyframes nodeInserted &#123; from &#123; opacity: 0.99; &#125; to &#123; opacity: 1; &#125; &#125; Vá»›i keyframe Ä‘Æ°á»£c táº¡o ra Ä‘Ã³, animation cáº§n pháº£i Ä‘Æ°á»£c Ã¡p dá»¥ng vÃ o cÃ¡c element mÃ  ta muá»‘n láº¯ng nghe. LÆ°u Ã½ lÃ  thá»i gian duration ráº¥t nhá», má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ kÃ©o dÃ£n dáº¥u váº¿t cá»§a animation trÃªn trÃ¬nh duyá»‡t: 1234#container-element * &#123; animation-duration: 0.001s; animation-name: nodeInserted;&#125; BÆ°á»›c thiáº¿t láº­p nÃ y sáº½ thÃªm animation vÃ o táº¥t cáº£ cÃ¡c node con cá»§a container-element. Khi animation káº¿t thÃºc (sau 0.001s nhÆ° trÃªn), sá»± kiá»‡n chÃ¨n node sáº½ Ä‘Æ°á»£c báº¯n ra. Ta cáº§n má»™t hÃ m event listener Javascript. Trong hÃ m Ä‘Ã³ ta pháº£i gá»i event.animationName Ä‘á»ƒ Ä‘áº£m báº£o Ä‘Ã³ chÃ­nh lÃ  animation mÃ  ta cáº§n. 123456var insertionListener = function(event) &#123; // Äáº£m báº£o Ä‘Ã¢y lÃ  animation mÃ  ta cáº§n xá»­ lÃ½. if (event.animationName === \"nodeInserted\") &#123; console.log(\"Node has been inserted: \" + event.target); &#125;&#125; Giá» thÃ¬ thÃªm event listener vÃ o node cha: 123document.addEventListener(â€œanimationstartâ€, insertionListener, false); // standard + firefoxdocument.addEventListener(â€œMSAnimationStartâ€, insertionListener, false); // IEdocument.addEventListener(â€œwebkitAnimationStartâ€, insertionListener, false); // Chrome + Safari TrÃ¬nh duyá»‡t há»— trá»£ CSS animation: MutationObserver cung cáº¥p má»™t sá»‘ tÃ­nh nÄƒng nÃ¢ng cao hÆ¡n táº¥t cáº£ 3 giáº£i phÃ¡p trÃªn. Vá» báº£n cháº¥t, nÃ³ bao phá»§ toÃ n bá»™ má»—i thay Ä‘á»•i cÃ³ thá»ƒ diá»…n ra trÃªn DOM vÃ  nÃ³ Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a khi báº¯n ra cÃ¡c thay Ä‘á»•i trong 1 chuá»—i hÃ ng loáº¡t. TrÃªn háº¿t MutationObserver Ä‘Æ°á»£c há»— trá»£ bá»Ÿi táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i Ä‘i kÃ¨m vá»›i 1 sá»‘ polyfills Ä‘á»ƒ dÃ¹ng MutationEvents MutationObserver chiáº¿m giá»¯ má»™t vá»‹ trÃ­ trung tÃ¢m trong thÆ° viá»‡n cá»§a SessionStack. Khi báº¡n Ä‘Ã£ tÃ­ch há»£p thÆ° viá»‡n cá»§a SessionStack vÃ o webapp, nÃ³ báº¯t Ä‘áº§u thu tháº­p cÃ¡c thÃ´ng tin cháº³ng háº¡n nhÆ° thay Ä‘á»•i trÃªn DOM, request máº¡ng, biá»‡t lá»‡, thÃ´ng bÃ¡o debug, vÃ¢n vÃ¢n, vÃ  gá»­i chÃºng vá» server. SessionStack dÃ¹ng chÃ­nh nhá»¯ng dá»¯ liá»‡u nÃ y Ä‘á»ƒ tÃ¡i táº¡o láº¡i má»i thá»© Ä‘Ã£ xáº£y ra vá»›i user cá»§a báº¡n vÃ  hiá»ƒn thá»‹ cÃ¡c váº¥n Ä‘á» cá»§a sáº£n pháº©m trong cÃ¹ng 1 tÃ¬nh huá»‘ng mÃ  nÃ³ diá»…n ra vá»›i user. KhÃ¡ nhiá»u ngÆ°á»i nghÄ© ráº±ng SessionStack ghi láº¡i video, nhÆ°ng khÃ´ng pháº£i váº­y. Ghi video ráº¥t tá»‘n kÃ©m, máº·t khÃ¡c lÆ°á»£ng dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c láº¡i ráº¥t nháº¹ vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n UX cÅ©ng nhÆ° hiá»‡u nÄƒng cá»§a webapp cá»§a báº¡n.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P9: Cáº¥u táº¡o cá»§a Web Push Notifications","slug":"Cach-Javascript-hoat-dong-P9-Cau-tao-cua-Web-Push-Notifications","date":"2018-11-24T15:51:00.000Z","updated":"2018-11-24T15:53:39.773Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P9-Cau-tao-cua-Web-Push-Notifications.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P9-Cau-tao-cua-Web-Push-Notifications.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 9 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. HÃ´m nay chÃºng ta sáº½ chuyá»ƒn hÆ°á»›ng sá»± chÃº Ã½ qua web push notifications (táº¡m dá»‹ch: thÃ´ng bÃ¡o Ä‘áº©y trÃªn trang web): chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» thÃ nh pháº§n cá»§a nÃ³, khÃ¡m phÃ¡ cÃ¡c quy trÃ¬nh gá»­i/nháº­n thÃ´ng bÃ¡o phÃ­a sau vÃ  cuá»‘i bÃ i sáº½ cÃ¹ng tÃ¬m hiá»ƒu lÃ m sao SessionStack sá»­ dá»¥ng chÃºng Ä‘á»ƒ xÃ¢y dá»±ng chá»©c nÄƒng cá»§a sáº£n pháº©m. Push Notifications ráº¥t phá»• biáº¿n trong tháº¿ giá»›i cá»§a Ä‘iá»‡n thoáº¡i. VÃ¬ lÃ½ do nÃ y hay lÃ½ do khÃ¡c, chÃºng bÆ°á»›c chÃ¢n vÃ o tháº¿ giá»›i web láº¡i khÃ¡ muá»™n máº·c dÃ¹ nÃ³ lÃ  tÃ­nh nÄƒng ráº¥t Ä‘Æ°á»£c cÃ¡c developer Æ°a chuá»™ng vÃ  Ä‘á» xuáº¥t.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 9 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. HÃ´m nay chÃºng ta sáº½ chuyá»ƒn hÆ°á»›ng sá»± chÃº Ã½ qua web push notifications (táº¡m dá»‹ch: thÃ´ng bÃ¡o Ä‘áº©y trÃªn trang web): chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» thÃ nh pháº§n cá»§a nÃ³, khÃ¡m phÃ¡ cÃ¡c quy trÃ¬nh gá»­i/nháº­n thÃ´ng bÃ¡o phÃ­a sau vÃ  cuá»‘i bÃ i sáº½ cÃ¹ng tÃ¬m hiá»ƒu lÃ m sao SessionStack sá»­ dá»¥ng chÃºng Ä‘á»ƒ xÃ¢y dá»±ng chá»©c nÄƒng cá»§a sáº£n pháº©m. Push Notifications ráº¥t phá»• biáº¿n trong tháº¿ giá»›i cá»§a Ä‘iá»‡n thoáº¡i. VÃ¬ lÃ½ do nÃ y hay lÃ½ do khÃ¡c, chÃºng bÆ°á»›c chÃ¢n vÃ o tháº¿ giá»›i web láº¡i khÃ¡ muá»™n máº·c dÃ¹ nÃ³ lÃ  tÃ­nh nÄƒng ráº¥t Ä‘Æ°á»£c cÃ¡c developer Æ°a chuá»™ng vÃ  Ä‘á» xuáº¥t. KhÃ¡i quÃ¡tWeb Push Notifications cho phÃ©p user tham gia vÃ o cÃ¡c cáº­p nháº­t theo thá»i gian tá»« webapp nháº±m má»¥c Ä‘Ã­ch thu hÃºt ngÆ°á»i dÃ¹ng dá»±a trÃªn ná»™i dung thÃº vá»‹, quan trá»ng vÃ  Ä‘Ãºng lÃºc Ä‘á»‘i vá»›i há». Push dá»±a trÃªn Service Workers - chÃ­nh lÃ  chá»§ Ä‘á» mÃ  chÃºng ta Ä‘Ã£ tháº£o luáº­n á»Ÿ bÃ i trÆ°á»›c. LÃ½ do lá»±a chá»n dÃ¹ng Service Workers trong trÆ°á»ng há»£p nÃ y lÃ  vÃ¬ chÃºng hoáº¡t Ä‘á»™ng trong background. Ráº¥t phÃ¹ há»£p cho Push Notifications vÃ¬ nhÆ° váº­y nghÄ©a lÃ  code chá»‰ Ä‘Æ°á»£c thá»±c thi khi user tÆ°Æ¡ng tÃ¡c vá»›i chÃ­nh notification Ä‘Ã³. Push &amp; notificationPush vÃ  notification lÃ  2 API khÃ¡c nhau. Push: Ä‘Æ°á»£c gá»i khi server cung cáº¥p thÃ´ng tin cho Server Worker Notification: hÃ nh Ä‘á»™ng cá»§a Service Worker hoáº·c má»™t Ä‘oáº¡n script trÃªn webapp nháº±m hiá»ƒn thá»‹ thÃ´ng tin Ä‘áº¿n user. PushCÃ³ 3 bÆ°á»›c cÆ¡ báº£n Ä‘á»ƒ triá»ƒn khai 1 push: Giao diá»‡n (UI): thÃªm vÃ o nhá»¯ng logic cáº§n thiáº¿t á»Ÿ phÃ­a client Ä‘á»ƒ Ä‘Äƒng kÃ½ user vá»›i push. ÄÃ¢y lÃ  pháº§n logic Javascript mÃ  UI cá»§a webapp cáº§n Ä‘á»ƒ cho phÃ©p user Ä‘Äƒng kÃ½ vÃ o push message. Gá»­i push message: triá»ƒn khai lá»i gá»i API trÃªn server Ä‘á»ƒ trigger má»™t push message tá»›i thiáº¿t bá»‹ cá»§a user. Nháº­n push message: xá»­ lÃ½ push message má»™t khi nÃ³ vá» tá»›i trÃ¬nh duyá»‡t. Giá» thÃ¬ chÃºng ta sáº½ tÃ¬m hiá»ƒu toÃ n bá»™ quÃ¡ trÃ¬nh má»™t cÃ¡ch chi tiáº¿t hÆ¡n. XÃ¡c nháº­n há»— trá»£ tá»« trÃ¬nh duyá»‡tÄáº§u tiÃªn lÃ  cáº§n pháº£i kiá»ƒm tra xem trÃ¬nh duyá»‡t báº¡n Ä‘ang dÃ¹ng cÃ³ há»— trá»£ cho push message hay khÃ´ng. ChÃºng ta cÃ³ 2 bÃ i check Ä‘Æ¡n giáº£n: Kiá»ƒm tra serviceWorker trong object navigator Kiá»ƒm tra PushManager trong object window Code kiá»ƒm tra: 123456789if (!('serviceWorker' in navigator)) &#123; // Service Worker khÃ´ng Ä‘Æ°á»£c há»— trá»£, vÃ´ hiá»‡u hÃ³a hoáº·c áº©n UI Ä‘i. return; &#125;if (!('PushManager' in window)) &#123; // Push khÃ´ng Ä‘Æ°á»£c há»— trá»£, vÃ´ hiá»‡u hÃ³a hoáº·c áº©n UI Ä‘i. return; &#125; ÄÄƒng kÃ½ má»™t Service WorkerTáº¡i thá»i Ä‘iá»ƒm nÃ y, ta Ä‘Ã£ biáº¿t cÃ¡c chá»©c nÄƒng Ä‘á»u Ä‘Æ°á»£c há»— trá»£. BÆ°á»›c tiáº¿p theo sáº½ lÃ  Ä‘Äƒng kÃ½ Service Worker. ÄÄƒng kÃ½ má»™t Service Worker nhÆ° tháº¿ nÃ o thÃ¬ báº¡n cÅ©ng Ä‘Ã£ quen vá»›i nhá»¯ng diá»…n giáº£i tá»« bÃ i trÆ°á»›c rá»“i. YÃªu cáº§u Ä‘Æ°á»£c cáº¥p quyá»nXong pháº§n vá»›i Service Worker thÃ¬ ta cÃ³ thá»ƒ Ä‘i tiáº¿p Ä‘áº¿n pháº§n Ä‘Äƒng kÃ½ user. Báº¡n cáº§n pháº£i cÃ³ quyá»n cá»§a user thÃ¬ má»›i gá»­i push message Ä‘áº¿n há» Ä‘Æ°á»£c. API dÃ¹ng Ä‘á»ƒ láº¥y quyá»n (permission) cÅ©ng tÆ°Æ¡ng Ä‘á»•i Ä‘Æ¡n giáº£n, tuy nhiÃªn Ä‘iá»ƒm báº¥t lá»£i lÃ  API Ä‘Ã£ thay Ä‘á»•i tá»« viá»‡c dÃ¹ng callback sang tráº£ vá» Promise. NÃ³ sinh ra váº¥n Ä‘á» khÃ¡c: chÃºng ta khÃ´ng thá»ƒ biáº¿t version cá»§a API Ä‘Ã£ Ä‘Æ°á»£c triá»ƒn khai trÃªn trÃ¬nh duyá»‡t hiá»‡n táº¡i, vÃ¬ tháº¿ chÃºng ta pháº£i xá»­ lÃ½ cáº£ 2 trÆ°á»ng há»£p. NÃ³ trÃ´ng nhÆ° tháº¿ nÃ y Ä‘Ã¢y: 1234567891011121314151617function requestPermission() &#123; return new Promise(function(resolve, reject) &#123; const permissionResult = Notification.requestPermission(function(result) &#123; // Xá»­ lÃ½ phiÃªn báº£n cÅ© vá»›i callback. resolve(result); &#125;); if (permissionResult) &#123; permissionResult.then(resolve, reject); &#125; &#125;) .then(function(permissionResult) &#123; if (permissionResult !== 'granted') &#123; throw new Error('Permission not granted.'); &#125; &#125;);&#125; Lá»i gá»i Ä‘áº¿n Notification.requestPermission() sáº½ hiá»ƒn thá»‹ 1 báº£ng thÃ´ng bÃ¡o nhá»: Má»™t khi quyá»n Ä‘Ã£ Ä‘Æ°á»£c cáº¥p, Ä‘Æ°á»£c Ä‘Ã³ng hoáº·c block thÃ¬ chÃºng ta cÅ©ng nháº­n Ä‘Æ°á»£c nhá»¯ng káº¿t quáº£ tÆ°Æ¡ng tá»± dÆ°á»›i dáº¡ng string: granted, default, denied. Nhá»› ráº±ng náº¿u user click chuá»™t vÃ o nÃºt Block thÃ¬ webapp cá»§a báº¡n sáº½ khÃ´ng thá»ƒ há»i user vá» chuyá»‡n cáº¥p quyá»n má»™t láº§n ná»¯a, cho tá»›i khi user tá»± â€œunblockâ€ app cá»§a báº¡n báº±ng cÃ¡ch thay Ä‘á»•i tráº¡ng thÃ¡i cá»§a quyá»n. TÃ¹y chá»n nÃ y Ä‘Æ°á»£c giáº¥u trong báº£ng cÃ i Ä‘áº·t. ÄÄƒng kÃ½ má»™t user vá»›i PushManagerKhi Service Worker Ä‘Ã£ Ä‘Æ°á»£c Ä‘Äƒng kÃ½ vÃ  chÃºng ta Ä‘Æ°á»£c user cáº¥p quyá»n, ta cÃ³ thá»ƒ subscribe 1 user báº±ng cÃ¡ch gá»i registration.pushManager.subscribe() khi Ä‘Äƒng kÃ½ Service Worker cá»§a báº¡n. ToÃ n bá»™ Ä‘oáº¡n code nhÆ° sau (bao gá»“m cáº£ pháº§n Ä‘Äƒng kÃ½ Service Worker): 1234567891011121314151617function subscribeUserToPush() &#123; return navigator.serviceWorker.register('service-worker.js') .then(function(registration) &#123; var subscribeOptions = &#123; userVisibleOnly: true, applicationServerKey: btoa( 'BEl62iUYgUivxIkv69yViEuiBIa-Ib9-SkvMeAtA3LFgDzkrxZJjSgSnfckjBJuBkr3qBUYIHBQFLXYp5Nksh8U' ) &#125;; return registration.pushManager.subscribe(subscribeOptions); &#125;) .then(function(pushSubscription) &#123; console.log('PushSubscription: ', JSON.stringify(pushSubscription)); return pushSubscription; &#125;);&#125; registration.pushManager.subscribe(options) nháº­n má»™t object options gá»“m 1 param báº¯t buá»™c vÃ  1 param tÃ¹y chá»n: userVisibleOnly: má»™t boolean chá»‰ Ä‘á»‹nh push subscription tráº£ vá» sáº½ chá»‰ Ä‘Æ°á»£c dÃ¹ng cho message mÃ  hiá»‡u á»©ng cá»§a message Ä‘Ã³ user cÃ³ thá»ƒ nhÃ¬n tháº¥y Ä‘Æ°á»£c. NÃ³ pháº£i Ä‘Æ°á»£c gÃ¡n báº±ng true náº¿u khÃ´ng thÃ¬ sáº½ lá»—i (CÃ³ cáº£ 1 quÃ¡ khá»© lá»‹ch sá»­ vá» nÃ³). applicationServerKey: má»™t DOMString hoáº·c ArrayBufffer chá»©a public key Ä‘Æ°á»£c mÃ£ hÃ³a thÃ nh Base64 mÃ  server push sáº½ dÃ¹ng Ä‘á»ƒ xÃ¡c thá»±c server cá»§a app. Server cá»§a báº¡n cáº§n sinh ra má»™t cáº·p server key cho app, chÃºng cÃ²n Ä‘Æ°á»£c biáº¿t Ä‘áº¿n lÃ  key VAPID duy nháº¥t cho server. ÄÃ¢y lÃ  1 cáº·p public-private key. Private key thÃ¬ Ä‘Æ°á»£c giá»¯ má»™t cÃ¡ch bÃ­ máº­t á»Ÿ phÃ­a báº¡n trong khi public key Ä‘Æ°á»£c trao Ä‘á»•i vá»›i client. Nhá»¯ng key nÃ y cho phÃ©p push service biáº¿t app server nÃ o Ä‘Ã£ Ä‘Äƒng kÃ½ user vÃ  Ä‘áº£m báº£o Ä‘Ã³ chÃ­nh lÃ  server trigger cÃ¡c push message Ä‘áº¿n ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ. Báº¡n chá»‰ cáº§n táº¡o ra cáº·p private/public key 1 láº§n duy nháº¥t cho á»©ng dá»¥ng. CÃ³ 1 cÃ¡ch lÃ m nhanh Ä‘Ã³ lÃ  dÃ¹ng trang nÃ y https://web-push-codelab.glitch.me/ TrÃ¬nh duyá»‡t truyá»n applicationServerKey (public key) lÃªn má»™t push server khi Ä‘Äƒng kÃ½ user, nghÄ©a lÃ  push server cÃ³ thá»ƒ liÃªn káº¿t public key cá»§a app báº¡n vá»›i PushSubscription cá»§a user. ÄÃ¢y lÃ  nhá»¯ng gÃ¬ diá»…n ra: Webapp cá»§a báº¡n Ä‘Æ°á»£c load xong vÃ  báº¡n gá»i subscribe(), truyá»n server key vÃ o. TrÃ¬nh duyá»‡t táº¡o 1 request lÃªn máº¡ng Ä‘áº¿n má»™t push service Ä‘á»ƒ sinh ra má»™t endpoint, sau Ä‘Ã³ liÃªn káº¿t endpoint nÃ y vá»›i key vÃ  tráº£ vá» cho trÃ¬nh duyá»‡t. TrÃ¬nh duyá»‡t sáº½ thÃªm endpoint nÃ y vÃ o trong object PushSubscription, chÃ­nh lÃ  object Ä‘Æ°á»£c tráº£ vá» tá»« subscribe() promise. Vá» sau, cá»© má»—i khi báº¡n muá»‘n gá»­i 1 push message, báº¡n chá»‰ cáº§n táº¡o má»™t Authorization header cÃ³ chÆ°a thÃ´ng tin Ä‘Ã£ kÃ½ (signed) vá»›i private key tá»« server á»©ng dá»¥ng cá»§a báº¡n. Khi push service nháº­n request Ä‘á»ƒ gá»­i má»™t push message, nÃ³ sáº½ xÃ¡c minh header báº±ng cÃ¡ch tÃ¬m public key Ä‘Ã£ liÃªn káº¿t vá»›i endpoint cá»¥ thá»ƒ Ä‘Ã³ (á»Ÿ bÆ°á»›c thá»© 2) Object PushSubscriptionMá»™t PushSubscription chá»©a nhá»¯ng thÃ´ng tin cáº§n thiáº¿t Ä‘á»ƒ gá»­i push message Ä‘áº¿n thiáº¿t bá»‹ cá»§a user: 12345678&#123; \"endpoint\": \"https://domain.pushservice.com/some-id\", \"keys\": &#123; \"p256dh\":\"BIPUL12DLfytvTajnryr3PJdAgXS3HGMlLqndGcJGabyhHheJYlNGCeXl1dn18gSJ1WArAPIxr4gK0_dQds4yiI=\", \"auth\":\"FPssMOQPmLmXWmdSTdbKVw==\" &#125;&#125; endpoint á»Ÿ Ä‘Ã¢y lÃ  URL cá»§a push service. Äá»ƒ trigger má»™t push mesage ta cáº§n táº¡o request POST Ä‘áº¿n URL nÃ y.Object keys chá»©a giÃ¡ trá»‹ dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u thÃ´ng tin Ä‘Æ°á»£c gá»­i Ä‘i vá»›i push message.Má»™t khi user Ä‘Ã£ Ä‘Æ°á»£c Ä‘Äƒng kÃ½ vÃ  báº¡n cÃ³ PushSubscription thÃ¬ báº¡n cáº§n gá»­i nÃ³ vá» cho server. Táº¡i Ä‘Ã¢y (trÃªn server) báº¡n sáº½ lÆ°u thÃ´ng tin tham gia cá»§a user vÃ o database vÃ  ká»ƒ tá»« bÃ¢y giá» sáº½ dÃ¹ng nÃ³ Ä‘á»ƒ gá»­i push message vá» cho user Ä‘Ã³. Gá»­i push messageKhi báº¡n cáº§n gá»­i má»™t push message cho nhiá»u user, Ä‘iá»u Ä‘áº§u tiÃªn báº¡n cáº§n lÃ  push service. Báº¡n Ä‘ang chá»‰ báº£o cho push service (thÃ´ng qua API) dá»¯ liá»‡u Ä‘á»ƒ gá»­i, gá»­i Ä‘áº¿n ai vÃ  cÃ¡c tÃ¬nh huá»‘ng vá» viá»‡c lÃ m tháº¿ nÃ o Ä‘á»ƒ gá»­i message. ThÃ´ng thÆ°á»ng, lá»i gá»i API nÃ y sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn server. Push ServicesPush service lÃ  thá»© dÃ¹ng Ä‘á»ƒ nháº­n cÃ¡c request, xÃ¡c nháº­n chÃºng vÃ  chuyá»ƒn giao push message cho trÃ¬nh duyá»‡t phÃ¹ há»£p. LÆ°u Ã½ ráº±ng báº¡n khÃ´ng quáº£n lÃ½ push service, nÃ³ lÃ  1 dá»‹ch vá»¥ cá»§a bÃªn thá»© 3. Server cá»§a báº¡n giao tiáº¿p vá»›i push service thÃ´ng qua API. Má»™t vÃ­ dá»¥ vá» push service chÃ­nh lÃ  Googleâ€™s FCM Push service xá»­ lÃ½ táº¥t cáº£ nhá»¯ng viá»‡c náº·ng nhá»c. VÃ­ dá»¥: Náº¿u nhÆ° trÃ¬nh duyá»‡t Ä‘ang offline, push service sáº½ xáº¿p message vÃ o hÃ ng Ä‘á»£i vÃ  chá» cho Ä‘áº¿n khi trÃ¬nh duyá»‡t online láº¡i trÆ°á»›c khi gá»­i message Ä‘i 1 cÃ¡ch tuáº§n tá»±. Má»—i tÃ¬nh duyá»‡t cÃ³ thá»ƒ dÃ¹ng báº¥t ká»³ push service nÃ o vÃ  Ä‘iá»u nÃ y vÆ°á»£t ngoÃ i kháº£ nÄƒng kiá»ƒm soÃ¡t cá»§a developer. Tuy nhiÃªn táº¥t cáº£ cÃ¡c push service cÃ³ chung API nÃªn viá»‡c nÃ y khÃ´ng lÃ m cho quÃ¡ trÃ¬nh triá»ƒn khai trá»Ÿ nÃªn khÃ³ khÄƒn. Äá»ƒ láº¥y Ä‘Æ°á»£c URL xá»­ lÃ½ cÃ¡c request cho push message, báº¡n cáº§n pháº£i kiá»ƒm tra giÃ¡ trá»‹ cá»§a endpoint trong object PushSubscription. Push Service APIPush Service API cung cáº¥p 1 cÃ¡ch Ä‘á»ƒ gá»­i message Ä‘áº¿n cho user. API lÃ  1 Web Push Protocol theo tiÃªu chuáº©n IETF Ä‘á»‹nh nghÄ©a cÃ¡ch ta gá»i API Ä‘áº¿n má»™t push service Dá»¯ liá»‡u báº¡n gá»­i vá»›i push message pháº£i Ä‘Æ°á»£c mÃ£ hÃ³a. Báº±ng cÃ¡ch nÃ y, báº¡n ngÄƒn cháº·n push service Ä‘á»c dá»¯ liá»‡u gá»­i Ä‘i. Äiá»u nÃ y ráº¥t quan trá»ng vÃ¬ trÃ¬nh duyá»‡t chÃ­nh lÃ  ngÆ°á»i quyáº¿t Ä‘á»‹nh nÃªn dÃ¹ng push service nÃ o (cÃ³ thá»ƒ Ä‘Ã³ lÃ  push service khÃ´ng Ä‘Ã¡ng tin cáº­y vÃ  báº£o máº­t kÃ©m) Vá»›i má»—i push message, báº¡n cÃ³ thá»ƒ Ä‘Æ°a ra hÆ°á»›ng dáº«n nhÆ° sau: TTL: Ä‘á»‹nh nghÄ©a má»™t message nÃªn chá» bao lÃ¢u trong hÃ ng Ä‘á»£i trÆ°á»›c khi nÃ³ bá»‹ gá»¡ ra vÃ  khÃ´ng Ä‘Æ°á»£c chuyá»ƒn Ä‘i. Má»©c Ä‘á»™ Æ°u tiÃªn (priority): Ä‘á»‹nh nghÄ©a má»©c Ä‘á»™ Æ°u tiÃªn cá»§a má»—i message, cÃ¡ch nÃ y giÃºp cho push service chá»‰ gá»­i nhá»¯ng thÃ´ng tin cÃ³ má»©c Ä‘á»™ Æ°u tiÃªn cao, vÃ­ dá»¥ trong trÆ°á»ng há»£p pin thiáº¿t bá»‹ cá»§a ngÆ°á»i dÃ¹ng sáº¯p cáº¡n. Chá»§ Ä‘á» (topic): cung cáº¥p cho push message má»™t tÃªn chá»§ Ä‘á» sáº½ thay tháº¿ message Ä‘ang chá» xá»­ lÃ½ (pending) cÃ³ cÃ¹ng chá»§ Ä‘á» Ä‘á»ƒ khi thiáº¿t bá»‹ Ä‘ang hoáº¡t Ä‘á»™ng, user sáº½ khÃ´ng nháº­n thÃ´ng tin cÅ©, lá»—i thá»i. Sá»± kiá»‡n Push trÃªn trÃ¬nh duyá»‡tMá»™t khi báº¡n gá»­i message Ä‘áº¿n push service nhÆ° giáº£i thÃ­ch á»Ÿ trÃªn, message sáº½ chuyá»ƒn sang tráº¡ng thÃ¡i chá» (pending) cho Ä‘áº¿n khi 1 trong sá»‘ nhá»¯ng Ä‘iá»u sau Ä‘Ã¢y xáº£y ra: Thiáº¿t bá»‹ online Message háº¿t háº¡n trÃªn hÃ ng Ä‘á»£i do TTL. Khi push service truyá»n má»™t message, trÃ¬nh duyá»‡t sáº½ nháº­n nÃ³, giáº£i mÃ£ vÃ  Ä‘iá»u phá»‘i má»™t sá»± kiá»‡n push trong Service Worker cá»§a báº¡n. Äiá»u tuyá»‡t vá»i lÃ  trÃ¬nh duyá»‡t thá»±c thi code Service Worker cá»§a báº¡n tháº­m chÃ­ cáº£ khi web page chÆ°a má»Ÿ lÃªn: Push message Ä‘Æ°á»£c gá»­i tá»›i trÃ¬nh duyá»‡t vÃ  Ä‘Æ°á»£c giáº£i mÃ£. TrÃ¬nh duyá»‡t Ä‘Ã¡nh thá»©c Service Worker Má»™t sá»± kiá»‡n push Ä‘Æ°á»£c phÃ¢n phá»‘i Ä‘áº¿n Service Worker Code Ä‘á»ƒ cÃ i Ä‘áº·t má»™t listener cho push even cÅ©ng khÃ¡ tÆ°Æ¡ng Ä‘á»“ng vá»›i cÃ¡c loáº¡i event listener khÃ¡c trong Javascript: 1234567self.addEventListener('push', function(event) &#123; if (event.data) &#123; console.log('This push event has data: ', event.data.text()); &#125; else &#123; console.log('This push event has no data.'); &#125;&#125;); Má»™t Ä‘iá»u cáº§n pháº£i hiá»ƒu vá» Service Worker lÃ  báº¡n cÃ³ Ã­t quyá»n kiá»ƒm soÃ¡t vá» thá»i gian cháº¡y cá»§a code Service Worker. TrÃ¬nh duyá»‡t quyáº¿t Ä‘á»‹nh khi nÃ o thÃ¬ Ä‘Ã¡nh thá»©c nÃ³ dáº­y vÃ  khi nÃ o thÃ¬ há»§y nÃ³. Trong Service Worker, event.waitUntil(promise) cho trÃ¬nh duyá»‡t biáº¿t cÃ´ng viá»‡c váº«n Ä‘ang thá»±c hiá»‡n cho tá»›i khi promise Ä‘Æ°á»£c giáº£i quyáº¿t xong vÃ  trÃ¬nh duyá»‡t sáº½ khÃ´ng há»§y service worker náº¿u nÃ³ cáº§n quÃ¡ trÃ¬nh Ä‘Ã³ hoÃ n thÃ nh. DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ vá» xá»­ lÃ½ sá»± kiá»‡n push: 12345self.addEventListener('push', function(event) &#123; var promise = self.registration.showNotification('Push notification!'); event.waitUntil(promise);&#125;); Gá»i self.registration.showNotification() hiá»ƒn thá»‹ má»™t thÃ´ng bÃ¡o Ä‘áº¿n user vÃ  nÃ³ tráº£ vá» promise, promise nÃ y Ä‘Æ°á»£c resolve khi thÃ´ng bÃ¡o Ä‘Ã£ Ä‘Æ°á»£c hiá»ƒn thá»‹ lÃªn. PhÆ°Æ¡ng thá»©c showNotification(title, options) cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰nh sá»­a Ä‘á»ƒ phÃ¹ há»£p vá»›i nhu cáº§u. Param title lÃ  1 string, cÃ²n options lÃ  object nhÆ° dÆ°á»›i Ä‘Ã¢y: 1234567891011121314151617181920212223&#123; \"//\": \"Visual Options\", \"body\": \"&lt;String&gt;\", \"icon\": \"&lt;URL String&gt;\", \"image\": \"&lt;URL String&gt;\", \"badge\": \"&lt;URL String&gt;\", \"vibrate\": \"&lt;Array of Integers&gt;\", \"sound\": \"&lt;URL String&gt;\", \"dir\": \"&lt;String of 'auto' | 'ltr' | 'rtl'&gt;\", \"//\": \"Behavioural Options\", \"tag\": \"&lt;String&gt;\", \"data\": \"&lt;Anything&gt;\", \"requireInteraction\": \"&lt;boolean&gt;\", \"renotify\": \"&lt;Boolean&gt;\", \"silent\": \"&lt;Boolean&gt;\", \"//\": \"Both Visual &amp; Behavioural Options\", \"actions\": \"&lt;Array of Strings&gt;\", \"//\": \"Information Option. No visual affect.\", \"timestamp\": \"&lt;Long&gt;\"&#125; Báº¡n cÃ³ thá»ƒ tÃ¬m hiá»ƒu chi tiáº¿t vá» má»—i options á»Ÿ Ä‘Ã¢y: https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/showNotification Push Notification lÃ  má»™t cÃ¡ch tuyá»‡t vá»i Ä‘á»ƒ thu tháº­p sá»± chÃº Ã½ cá»§a user nhá»¯ng khi cÃ³ thÃ´ng tin gáº¥p, quan trá»ng hoáº·c cáº§n thá»i Ä‘iá»ƒm nháº¡y cáº£m mÃ  báº¡n muá»‘n chia sáº» vá»›i há». Team SessionStack thá»±c hiá»‡n push notifications Ä‘á»ƒ bÃ¡o cho user biáº¿t khi cÃ³ crash, váº¥n Ä‘á» hoáº·c Ä‘iá»u gÃ¬ Ä‘Ã³ báº¥t thÆ°á»ng trong sáº£n pháº©m cá»§a há». Viá»‡c nÃ y giÃºp cho user biáº¿t ngay láº­p tá»©c náº¿u cÃ³ gÃ¬ khÃ´ng Ä‘Ãºng Ä‘ang xáº£y ra. Sau Ä‘Ã³ há» cÃ³ thá»ƒ replay láº¡i issue Ä‘Ã³ dÆ°á»›i dáº¡ng video vÃ  xem má»i thá»© diá»…n ra vá»›i ngÆ°á»i dÃ¹ng cuá»‘i cá»§a há» báº±ng cÃ¡ch táº­n dá»¥ng dá»¯ liá»‡u Ä‘Æ°á»£c thu tháº­p vá»›i thÆ° viá»‡n cá»§a SessionStack, cháº³ng háº¡n nhÆ° thay Ä‘á»•i trÃªn DOM, tÆ°Æ¡ng tÃ¡c ngÆ°á»i dÃ¹ng, request máº¡ng, biá»‡t lá»‡ khÃ´ng Ä‘Æ°á»£c xá»­ lÃ½ vÃ  cÃ¡c thÃ´ng bÃ¡o lá»—i. TÃ­nh nÄƒng nÃ y khÃ´ng chá»‰ sáº½ giÃºp user sá»­ dá»¥ng SessionStack hiá»ƒu vÃ  tÃ¡i hiá»‡n láº¡i báº¥t ká»³ váº¥n Ä‘á» nÃ o mÃ  nÃ³ cÃ²n cho phÃ©p há» nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o ngay khi nÃ³ xuáº¥t hiá»‡n.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P8: Service Workers, vÃ²ng Ä‘á»i vÃ  cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng","slug":"Cach-Javascript-hoat-dong-P8-Service-Workers-vong-doi-va-cac-truong-hop-su-dung","date":"2018-11-24T15:04:00.000Z","updated":"2018-11-24T15:16:23.564Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P8-Service-Workers-vong-doi-va-cac-truong-hop-su-dung.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P8-Service-Workers-vong-doi-va-cac-truong-hop-su-dung.html","excerpt":"Báº¡n cÃ³ láº½ Ä‘Ã£ biáº¿t ráº±ng Progressive Web Apps chá»‰ cÃ³ thá»ƒ phá»• biáº¿n hÆ¡n khi chÃºng hÆ°á»›ng tá»›i tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng (UX) mÆ°á»£t mÃ  hÆ¡n, giá»‘ng nhÆ° lÃ  táº¡o 1 native app hÆ¡n lÃ  má»™t tráº£i nghiá»‡m mang phong cÃ¡ch trÃ¬nh duyá»‡t. Má»™t trong sá»‘ nhá»¯ng yÃªu cáº§u khi xÃ¢y dá»±ng PWA lÃ  lÃ m nÃ³ cá»±c ká»³ Ä‘Ã¡ng tin cáº­y á»Ÿ khoáº£n loading: nÃ³ cÃ³ thá»ƒ cháº¡y ká»ƒ cáº£ trong tÃ¬nh tráº¡ng internet khÃ´ng á»•n Ä‘á»‹nh hoáº·c rá»›t máº¡ng. Trong bÃ i nÃ y, chÃºng ta sáº½ Ä‘Ã o sÃ¢u vÃ o Service Workers: cÃ¡ch chÃºng hoáº¡t Ä‘á»™ng vÃ  chÃºng ta nÃªn quan tÃ¢m Ä‘áº¿n Ä‘Ã¢u. Cuá»‘i bÃ i, team tÃ¡c giáº£ cÃ³ má»™t sá»‘ lá»£i Ã­ch Ä‘á»™c Ä‘Ã¡o cá»§a Service Workers mÃ  chÃºng ta nÃªn dÃ¹ng Ä‘á»“ng thá»i chia sáº» kinh nghiá»‡m cá»§a há» táº¡i SessionStack.","text":"Báº¡n cÃ³ láº½ Ä‘Ã£ biáº¿t ráº±ng Progressive Web Apps chá»‰ cÃ³ thá»ƒ phá»• biáº¿n hÆ¡n khi chÃºng hÆ°á»›ng tá»›i tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng (UX) mÆ°á»£t mÃ  hÆ¡n, giá»‘ng nhÆ° lÃ  táº¡o 1 native app hÆ¡n lÃ  má»™t tráº£i nghiá»‡m mang phong cÃ¡ch trÃ¬nh duyá»‡t. Má»™t trong sá»‘ nhá»¯ng yÃªu cáº§u khi xÃ¢y dá»±ng PWA lÃ  lÃ m nÃ³ cá»±c ká»³ Ä‘Ã¡ng tin cáº­y á»Ÿ khoáº£n loading: nÃ³ cÃ³ thá»ƒ cháº¡y ká»ƒ cáº£ trong tÃ¬nh tráº¡ng internet khÃ´ng á»•n Ä‘á»‹nh hoáº·c rá»›t máº¡ng. Trong bÃ i nÃ y, chÃºng ta sáº½ Ä‘Ã o sÃ¢u vÃ o Service Workers: cÃ¡ch chÃºng hoáº¡t Ä‘á»™ng vÃ  chÃºng ta nÃªn quan tÃ¢m Ä‘áº¿n Ä‘Ã¢u. Cuá»‘i bÃ i, team tÃ¡c giáº£ cÃ³ má»™t sá»‘ lá»£i Ã­ch Ä‘á»™c Ä‘Ã¡o cá»§a Service Workers mÃ  chÃºng ta nÃªn dÃ¹ng Ä‘á»“ng thá»i chia sáº» kinh nghiá»‡m cá»§a há» táº¡i SessionStack. KhÃ¡i quÃ¡tNáº¿u báº¡n muá»‘n hiá»ƒu rÃµ má»i thá»© vá» Service Workers, báº¡n cáº§n pháº£i báº¯t Ä‘áº§u vá»›i bÃ i viáº¿t trÆ°á»›c vá» Web Workers. Vá» cÆ¡ báº£n, Service Worker chá»‰ lÃ  1 loáº¡i cá»§a Web Worker vÃ  cá»¥ thá»ƒ hÆ¡n lÃ  nÃ³ giá»‘ng nhÆ° 1 Shared Worker: Service Worker cháº¡y trong global context cá»§a chÃ­nh nÃ³ NÃ³ khÃ´ng thá»ƒ gáº¯n káº¿t vá»›i 1 trang cá»¥ thá»ƒ KhÃ´ng thá»ƒ truy cáº­p vÃ o DOM Má»™t trong nhá»¯ng lÃ½ do táº¡i sao Service Worker API ráº¥t tuyá»‡t vá»i lÃ  chÃºng cho phÃ©p webapp há»— trá»£ tráº£i nghiá»‡m khi offline, cho phÃ©p developer hoÃ n toÃ n Ä‘iá»u khiá»ƒn luá»“ng sá»­ dá»¥ng. VÃ²ng Ä‘á»i cá»§a Service WorkerVÃ²ng Ä‘á»i cá»§a má»™t service worker lÃ  hoÃ n toÃ n tÃ¡ch biá»‡t vá»›i web page. NÃ³ bao gá»“m cÃ¡c giai Ä‘oáº¡n sau: Táº£i vá» (Download) CÃ i Ä‘áº·t (Installation) KÃ­ch hoáº¡t (Activation) DownloadÄÃ¢y lÃ  khi trÃ¬nh duyá»‡t táº£i file .js chá»©a Service Worker CÃ i Ä‘áº·tÄá»ƒ cÃ i Ä‘áº·t má»™t Service Worker cho webapp cá»§a báº¡n thÃ¬ báº¡n cáº§n pháº£i Ä‘Äƒng kÃ½ nÃ³ trÆ°á»›c trong code Javascript. Khi Service Worker Ä‘Ã£ Ä‘Äƒng kÃ½ xong, nÃ³ sáº½ nháº¯c nhá»Ÿ tÃ¬nh duyá»‡t khá»Ÿi Ä‘á»™ng má»™t bÆ°á»›c cÃ i Ä‘áº·t cháº¡y ná»n Service Worker. Báº±ng cÃ¡ch Ä‘Äƒng kÃ½ Service Worker, báº¡n Ä‘Ã£ thÃ´ng bÃ¡o cho trÃ¬nh duyá»‡t file Javascript cá»§a worker náº±m á»Ÿ Ä‘Ã¢u. CÃ¹ng xem vÃ­ dá»¥ bÃªn dÆ°á»›i: 1234567891011if ('serviceWorker' in navigator) &#123; window.addEventListener('load', function() &#123; navigator.serviceWorker.register('/sw.js').then(function(registration) &#123; // ÄÄƒng kÃ½ thÃ nh cÃ´ng console.log('ServiceWorker registration successful'); &#125;, function(err) &#123; // ÄÄƒng kÃ½ tháº¥t báº¡i console.log('ServiceWorker registration failed: ', err); &#125;); &#125;);&#125; Code sáº½ kiá»ƒm tra náº¿u mÃ´i trÆ°á»ng hiá»‡n táº¡i cÃ³ support Service Worker hay khÃ´ng. Náº¿u nhÆ° cÃ³ thÃ¬ file /sw.js sáº½ Ä‘Æ°á»£c Ä‘Äƒng kÃ½. Báº¡n cÃ³ thá»ƒ gá»i phÆ°Æ¡ng thá»©c register() má»—i khi má»™t trang load lÃªn mÃ  khÃ´ng pháº£i lo láº¯ng gÃ¬, trÃ¬nh duyá»‡t sáº½ sáº½ tá»± kiá»ƒm tra náº¿u service worker Ä‘Ã£ Ä‘Æ°á»£c Ä‘Äƒng kÃ½ hay chÆ°a vÃ  tá»± xá»­ lÃ½ má»™t cÃ¡ch phÃ¹ há»£p. Má»™t Ä‘iá»ƒm quan trá»ng á»Ÿ phÆ°Æ¡ng thá»©c register() lÃ  vá»‹ trÃ­ cá»§a file service worker. Trong trÆ°á»ng há»£p nÃ y báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng file service worker Ä‘ang á»Ÿ root cá»§a domain. NghÄ©a lÃ  pháº¡m vi (scope) cá»§a service worker sáº½ bao hÃ m toÃ n bá»™ origin. NÃ³i cÃ¡ch khÃ¡c, service worker nÃ y sáº½ nháº­n cÃ¡c sá»± kiá»‡n fetch (mÃ  chÃºng ta sáº½ tháº£o luáº­n sau) cho má»i thá»© trÃªn domain nÃ y. Náº¿u ta Ä‘Äƒng kÃ½ file service worker á»Ÿ /example/sw.js thÃ¬ service worker chá»‰ cÃ³ thá»ƒ tháº¥y cÃ¡c sá»± kiá»‡n fetch cho trang cÃ³ URL báº¯t Ä‘áº§u vá»›i /example/ (vÃ­ dá»¥: /example/page/1, /example/page/2) Trong giai Ä‘oáº¡n cÃ i Ä‘áº·t, tá»‘t nháº¥t ta nÃªn load vÃ  cache nhá»¯ng tÃ i nguyÃªn dáº¡ng tÄ©nh (static asset). Má»™t khi cÃ¡c tÃ i nguyÃªn Ä‘Ã£ Ä‘Æ°á»£c cache thÃ nh cÃ´ng thÃ¬ quÃ¡ trÃ¬nh cÃ i Ä‘áº·t Service Worker cÅ©ng hoÃ n thÃ nh. Náº¿u khÃ´ng (load fail), Service Worker sáº½ thá»­ láº¡i (retry). Má»™t khi Ä‘Ã£ thÃ nh cÃ´ng, báº¡n sáº½ biáº¿t cÃ¡c static asset Ä‘ang náº±m trong cache. Báº¡n sáº½ tá»± há»i náº¿u nhÆ° quÃ¡ tÃ¬nh Ä‘Äƒng kÃ½ diá»…n ra sau sá»± kiá»‡n load thÃ¬ Ä‘Æ°á»£c khÃ´ng. Äiá»u nÃ y khÃ´ng báº¯t buá»™c, nhÆ°ng Ä‘Ã³ lÃ  cÃ¡ch tá»‘t nháº¥t vÃ  Ä‘Æ°á»£c Ä‘á» nghá»‹ lÃ m theo. Táº¡i sao? Giáº£ sá»­ má»™t user láº§n Ä‘áº§u tiÃªn ghÃ© thÄƒm webapp cá»§a báº¡n. KhÃ´ng cÃ³ service worker nÃ o cáº£ vÃ  trÃ¬nh duyá»‡t khÃ´ng cÃ³ cÃ¡ch nÃ o Ä‘á»ƒ biáº¿t trÆ°á»›c cÃ³ hay khÃ´ng má»™t service worker cáº§n Ä‘Æ°á»£c cÃ i Ä‘áº·t. Náº¿u nhÆ° Service Worker Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t, trÃ¬nh duyá»‡t sáº½ dÃ nh ra 1 lÆ°á»£ng CPU vÃ  bá»™ nhá»› cho tiáº¿n trÃ¬nh Ä‘Ã³, ngÆ°á»£c láº¡i thÃ¬ trÃ¬nh duyá»‡t sáº½ dÃ nh toÃ n bá»™ cho quÃ¡ trÃ¬nh render web page. Äiá»ƒm máº¥u chá»‘t lÃ  náº¿u báº¡n chá»‰ cÃ i Ä‘áº·t Service Worker trÃªn trang cá»§a báº¡n thÃ¬ báº¡n Ä‘ang máº¡o hiá»ƒm vá» Ä‘á»™ delay cá»§a quÃ¡ trÃ¬nh loading &amp; render chá»© khÃ´ng pháº£i Ä‘ang lÃ m cho trang cÃ³ thá»ƒ sáºµn sÃ ng cho ngÆ°á»i dÃ¹ng má»™t cÃ¡ch nhanh nháº¥t cÃ³ thá»ƒ. LÆ°u Ã½ ráº±ng Ä‘iá»u nÃ y chá»‰ quan trá»ng cho láº§n Ä‘áº§u tiÃªn ghÃ© thÄƒm trang. Nhá»¯ng láº§n ghÃ© thÄƒm sau thÃ¬ khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng vá»›i quÃ¡ trÃ¬nh cÃ i Ä‘áº·t Service Worker. Má»™t khi Service Worker Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t trong láº§n Ä‘áº§u ghÃ© thÄƒm trang, nÃ³ cÃ³ thá»ƒ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n loading/caching cho nhá»¯ng láº§n ghÃ© thÄƒm káº¿ tiáº¿p. Äiá»u nÃ y ráº¥t cÃ³ Ã½ nghÄ©a bá»Ÿi vÃ¬ nÃ³ cáº§n pháº£i sáºµn sÃ ng Ä‘á»ƒ xá»­ lÃ½ trÆ°á»ng há»£p káº¿t ná»‘i máº¡ng bá»‹ háº¡n cháº¿. KÃ­ch hoáº¡tSau khi Service Worker cÃ i Ä‘áº·t, bÆ°á»›c tiáº¿p theo lÃ  kÃ­ch hoáº¡t nÃ³. BÆ°á»›c nÃ y lÃ  cÆ¡ há»™i tuyá»‡t vá»i Ä‘á»ƒ quáº£n lÃ½ cache trÆ°á»›c Ä‘Ã³. Má»™t khi Ä‘Ã£ kÃ­ch hoáº¡t, Service Worker sáº½ báº¯t Ä‘áº§u kiá»ƒm soÃ¡t toÃ n trang náº±m trong pháº¡m vi cá»§a nÃ³. Má»™t sá»± tháº­t ráº¥t thÃº vá»‹: page nÃ o Ä‘Äƒng kÃ½ Service Worker láº§n Ä‘áº§u tiÃªn sáº½ khÃ´ng bá»‹ Ä‘iá»u khiá»ƒn cho Ä‘áº¿n khi nÃ³ load láº¡i. Má»™t khi Service Worker kiá»ƒm soÃ¡t, nÃ³ sáº½ cÃ³ nhá»¯ng tráº¡ng thÃ¡i sau: NÃ³ sáº½ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n fetch &amp; message diá»…n ra khi má»™t request máº¡ng hoáº·c message Ä‘Æ°á»£c táº¡o ra tá»« page. NÃ³ sáº½ bá»‹ há»§y bá» Ä‘á»ƒ giáº£i phÃ³ng bá»™ nhá»›. DÆ°á»›i Ä‘Ã¢y lÃ  vÃ²ng Ä‘á»i cá»§a nÃ³: Xá»­ lÃ½ quÃ¡ trÃ¬nh cÃ i Ä‘áº·t bÃªn trong Service WorkerSau khi page xoay vÃ²ng quÃ¡ trÃ¬nh Ä‘Äƒng kÃ½, ta cÃ¹ng tÃ¬m hiá»ƒu Ä‘iá»u gÃ¬ diá»…n ra bÃªn trong script cá»§a Service Worker, code nÃ y xá»­ lÃ½ sá»± kiá»‡n cÃ i Ä‘áº·t báº±ng cÃ¡ch thÃªm má»™t event listener vÃ o instance cá»§a Service Worker. ÄÃ¢y lÃ  nhá»¯ng bÆ°á»›c cáº§n thiáº¿t khi xá»­ lÃ½ sá»± kiá»‡n cÃ i Ä‘áº·t Má»Ÿ cache Cache cÃ¡c file XÃ¡c nháº­n táº¥t cáº£ cÃ¡c asset cáº§n thiáº¿t Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c cache. DÆ°á»›i Ä‘Ã¢y lÃ  quÃ¡ trÃ¬nh cÃ i Ä‘áº·t Ä‘Æ¡n giáº£n bÃªn trong Service Worker: 12345678910111213141516171819var CACHE_NAME = 'my-web-app-cache';var urlsToCache = [ '/', '/styles/main.css', '/scripts/app.js', '/scripts/lib.js'];self.addEventListener('install', function(event) &#123; // event.waitUntil nháº­n má»™t promise Ä‘á»ƒ biáº¿t quÃ¡ trÃ¬nh // cÃ i Ä‘áº·t máº¥t bao lÃ¢u vÃ  cÃ³ thÃ nh cÃ´ng hay khÃ´ng. event.waitUntil( caches.open(CACHE_NAME) .then(function(cache) &#123; console.log('Opened cache'); return cache.addAll(urlsToCache); &#125;) );&#125;); Náº¿u táº¥t cáº£ cÃ¡c file Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u cache thÃ nh cÃ´ng thÃ¬ service worker sáº½ Ä‘Æ°á»£c cÃ i Ä‘áº·t. Náº¿u má»™t file nÃ o Ä‘Ã³ khÃ´ng download Ä‘Æ°á»£c thÃ¬ bÆ°á»›c cÃ i Ä‘áº·t sáº½ bá»‹ fail. VÃ¬ tháº¿ hÃ£y cáº©n tháº­n vá»›i nhá»¯ng file báº¡n truyá»n vÃ o. Xá»­ lÃ½ sá»± kiá»‡n cÃ i Ä‘áº·t hoÃ n toÃ n khÃ´ng báº¯t buá»™c vÃ  báº¡n cÃ³ thá»ƒ bá» qua, trong trÆ°á»ng há»£p Ä‘Ã³ báº¡n khÃ´ng cáº§n pháº£i thá»±c hiá»‡n thÃªm bÆ°á»›c nÃ o ná»¯a. Cache request trong quÃ¡ trÃ¬nh thá»±c thi (runtime)Pháº§n nÃ y thá»±c sá»± thÃº vá»‹ má»™t cÃ¡ch xuáº¥t sáº¯c. ÄÃ¢y lÃ  nÆ¡i báº¡n sáº½ biáº¿t lÃ m tháº¿ nÃ o Ä‘á»ƒ can thiá»‡p request vÃ  tráº£ vá» cache Ä‘Ã£ Ä‘Æ°á»£c táº¡o (vÃ  táº¡o má»›i). Sau khi Service Worker cÃ i Ä‘áº·t xong vÃ  user Ä‘iá»u hÆ°á»›ng Ä‘áº¿n page khÃ¡c hoáº·c refresh láº¡i page hiá»‡n táº¡i, Service Worker sáº½ nháº­n Ä‘Æ°á»£c sá»± kiá»‡n fetch. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ thá»ƒ hiá»‡n lÃ m tháº¿ nÃ o Ä‘á»ƒ tráº£ vá» nhá»¯ng asset Ä‘Ã£ cache hoáº·c thá»±c hiá»‡n má»™t request má»›i vÃ  cache káº¿t quáº£: 1234567891011121314151617181920212223242526272829303132333435363738394041424344self.addEventListener('fetch', function(event) &#123; event.respondWith( // PhÆ°Æ¡ng thá»©c nÃ y xem xÃ©t request vÃ  tÃ¬m xem cÃ³ // káº¿t quáº£ nÃ o Ä‘Ã£ Ä‘Æ°á»£c cache tá»« táº¥t cáº£ cÃ¡c cache // mÃ  Service Worker Ä‘Ã£ táº¡o. caches.match(event.request) .then(function(response) &#123; // Náº¿u tÃ¬m tháº¥y cache thÃ¬ tráº£ vá» response. if (response) &#123; return response; &#125; // NhÃ¢n báº£n request. Má»™t request lÃ  1 stream vÃ  chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng 1 láº§n. // Bá»Ÿi vÃ¬ chÃºng ta Ä‘ang xÃ i 1 cÃ¡i cho cache vÃ  1 cÃ¡i cho trÃ¬nh duyá»‡t Ä‘á»ƒ fetch, // náº¿n ta cáº§n pháº£i nhÃ¢n báº£n request. var fetchRequest = event.request.clone(); // Cache khÃ´ng tÃ¬m tháº¥y nÃªn ta cáº§n thá»±c hiá»‡n fetch // Ä‘á»ƒ táº¡o request tá»›i máº¡ng vÃ  tráº£ vá» dá»¯ liá»‡u náº¿u tÃ¬m tháº¥y // thá»© gÃ¬ Ä‘Ã³. return fetch(fetchRequest).then( function(response) &#123; // Kiá»ƒm tra náº¿u ta nháº­n Ä‘Æ°á»£c response há»£p lá»‡. if(!response || response.status !== 200 || response.type !== 'basic') &#123; return response; &#125; // NhÃ¢n báº£n response bá»Ÿi vÃ¬ nÃ³ cÅ©ng khÃ´ng pháº£i lÃ  1 stream. // Bá»Ÿi vÃ¬ chÃºng ta muá»‘n trÃ¬nh duyá»‡t sá»­ dá»¥ng response cÅ©ng nhÆ° // cache sá»­ dá»¥ng response, ta cáº§n nhÃ¢n báº£n nÃ³ thÃ nh 2 stream. var responseToCache = response.clone(); caches.open(CACHE_NAME) .then(function(cache) &#123; // ThÃªm request vÃ o cache phá»¥c vá»¥ sau nÃ y cache.put(event.request, responseToCache); &#125;); return response; &#125; ); &#125;) );&#125;); TÃ³m gá»n láº¡i thÃ¬ Ä‘Ã¢y lÃ  nhá»¯ng Ä‘iá»u Ä‘Ã£ diá»…n ra: event.respondWith() sáº½ xÃ¡c Ä‘á»‹nh lÃ m tháº¿ nÃ o chÃºng ta pháº£n há»“i vá»›i sá»± kiá»‡n fetch. Ta truyá»n má»™t promise tá»« caches.match(), hÃ m Ä‘ang kiá»ƒm tra request vÃ  tÃ¬m kiáº¿m náº¿u cÃ³ báº¥t ká»³ káº¿t quáº£ Ä‘Ã£ Ä‘Æ°á»£c cache sáºµn nÃ o tá»« nhá»¯ng cache Ä‘Ã£ Ä‘Æ°á»£c táº¡o trÆ°á»›c Ä‘Ã³. Náº¿u cÃ³ cache, response Ä‘Æ°á»£c láº¥y ra. NgÆ°á»£c láº¡i, fetch Ä‘Æ°á»£c thá»±c thi. Kiá»ƒm tra náº¿u tráº¡ng thÃ¡i lÃ  200. ChÃºng ta sáº½ kiá»ƒm tra kiá»ƒu response lÃ  cÆ¡ báº£n, nghÄ©a lÃ  nÃ³ sáº½ chá»‰ ra request tá»« origin cá»§a chÃºng ta. Request Ä‘áº¿n cÃ¡c asset cá»§a bÃªn thá»© 3 khÃ´ng thá»ƒ cache Ä‘Æ°á»£c trong trÆ°á»ng há»£p nÃ y. Response Ä‘Æ°á»£c thÃªm vÃ o cache. Request vÃ  response pháº£i Ä‘Æ°á»£c nhÃ¢n báº£n (clone) vÃ¬ chÃºng lÃ  stream. ThÃ¢n (body) cá»§a má»™t stream chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng 1 láº§n. VÃ  khi ta cáº§n dÃ¹ng nÃ³, ta pháº£i nhÃ¢n báº£n nÃ³ bá»Ÿi vÃ¬ trÃ¬nh duyá»‡t cÅ©ng cáº§n sá»­ dá»¥ng nÃ³ ná»¯a. Cáº­p nháº­t Service WorkerKhi má»™t user ghÃ© thÄƒm webapp cá»§a báº¡n, trÃ¬nh duyá»‡t sáº½ thá»­ download láº¡i file .js chá»©a code Service Worker. TÃ¡c vá»¥ nÃ y sáº½ Ä‘Æ°á»£c cháº¡y ná»n. Náº¿u cÃ³ má»™t chÃºt khÃ¡c biá»‡t dÃ¹ chá»‰ má»™t byte giá»¯a file Service Worker má»›i download vá» vÃ  file cÅ© thÃ¬ trÃ¬nh duyá»‡t cÅ©ng sáº½ giáº£ Ä‘á»‹nh ráº±ng cÃ³ sá»± thay Ä‘á»•i vÃ  Service Worker má»›i pháº£i khá»Ÿi táº¡o láº¡i. Service Worker má»›i sáº½ báº¯t Ä‘áº§u khá»Ÿi táº¡o vÃ  cÃ i Ä‘áº·t. Tuy nhiÃªn vÃ o thá»i Ä‘iá»ƒm nÃ y, Service Worker cÅ© váº«n Ä‘ang kiá»ƒm soÃ¡t page trÃªn webapp cá»§a báº¡n, nghÄ©a lÃ  Service Worker má»›i sáº½ náº±m trong tráº¡ng thÃ¡i chá» Ä‘á»£i. Má»™t khi trang Ä‘ang má»Ÿ Ä‘Æ°á»£c Ä‘Ã³ng láº¡i, Service Worker cÅ© sáº½ bá»‹ há»§y bá»Ÿi trÃ¬nh duyá»‡t vÃ  Service Worker má»›i cÃ i Ä‘áº·t sáº½ chiáº¿m quyá»n kiá»ƒm soÃ¡t toÃ n bá»™. ÄÃ¢y lÃ  khi sá»± kiá»‡n kÃ­ch hoáº¡t cá»§a nÃ³ Ä‘Æ°á»£c kÃ­ch hoáº¡t. Táº¡i sao láº¡i cáº§n pháº£i lÃ m táº¥t cáº£ Ä‘iá»u nÃ y? LÃ  Ä‘á»ƒ trÃ¡nh váº¥n Ä‘á» khi cÃ³ 2 phiÃªn báº£n webapp cháº¡y Ä‘á»“ng thá»i trong cÃ¡c tab khÃ¡c nhau. Viá»‡c nÃ y diá»…n ra má»™t cÃ¡ch ráº¥t phá»• biáº¿n vÃ  cÃ³ thá»ƒ táº¡o ra nhá»¯ng lá»—i tá»“i tá»‡ (vÃ­ dá»¥: báº¡n cÃ³ schema khÃ¡c nhau trong khi lÆ°u trá»¯ dá»¯ liá»‡u local trÃªn trÃ¬nh duyá»‡t). XÃ³a dá»¯ liá»‡u trong cacheBÆ°á»›c phá»• biáº¿n nháº¥t trong callback kÃ­ch hoáº¡t lÃ  quáº£n lÃ½ cache. Báº¡n sáº½ cáº§n pháº£i lÃ m Ä‘iá»u nÃ y ngay bá»Ÿi vÃ¬ náº¿u báº¡n dá»n dáº¹p cache cÅ© trong bÆ°á»›c cÃ i Ä‘áº·t, Service Worker cÅ© sáº½ dá»«ng láº¡i má»™t cÃ¡ch Ä‘á»™t ngá»™t vÃ  khÃ´ng thá»ƒ phÃ¢n phá»‘i cÃ¡c file tá»« cache Ä‘Ã³ ná»¯a. DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ cÃ¡ch báº¡n cÃ³ thá»ƒ xÃ³a vÃ i file khÃ´ng náº±m trong danh sÃ¡ch an toÃ n trong cache (trong trÆ°Æ¡ng há»£p nÃ y lÃ  cÃ³ chá»¯ page-1 vÃ  page-2 trong tÃªn cá»§a nÃ³) 1234567891011121314151617181920self.addEventListener('activate', function(event) &#123; var cacheWhitelist = ['page-1', 'page-2']; event.waitUntil( // Láº¥y táº¥t cáº£ key tá»« cache. caches.keys().then(function(cacheNames) &#123; return Promise.all( // Láº·p qua máº£ng cÃ¡c file. cacheNames.map(function(cacheName) &#123; // Náº¿u file trong cache khÃ´ng náº±m trong danh sÃ¡ch an toÃ n // thÃ¬ nÃ³ sáº½ bá»‹ xÃ³a. if (cacheWhitelist.indexOf(cacheName) === -1) &#123; return caches.delete(cacheName); &#125; &#125;) ); &#125;) );&#125;); YÃªu cáº§u HTTPSKhi xÃ¢y dá»±ng webapp, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Service Worker qua localhost nhÆ°ng má»™t khi Ä‘Ã£ deploy nÃ³ lÃªn production, báº¡n cáº§n chuáº©n bá»‹ HTTPS (vÃ  Ä‘Ã³ cÅ©ng lÃ  lÃ½ do cuá»‘i cÃ¹ng báº¡n cáº§n Ä‘áº¿n HTTPS). Sá»­ dá»¥ng Service Worker, báº¡n cÃ³ thá»ƒ chiáº¿m quyá»n káº¿t ná»‘i vÃ  ngá»¥y táº¡o response. Náº¿u khÃ´ng dÃ¹ng HTTPS, webapp cá»§a báº¡n trá»Ÿ thÃ nh Ä‘á»‘i tÆ°á»£ng cá»§a cÃ¡ch táº¥n cÃ´ng káº»-trung-gian (man-in-the-middle). Äá»ƒ an toÃ n hÆ¡n, báº¡n cáº§n pháº£i Ä‘Äƒng kÃ½ Service Worker vá»›i page Ä‘Æ°á»£c phÃ¢n phá»‘i qua HTTPS Ä‘á»ƒ báº¡n biáº¿t Ä‘Æ°á»£c Service Worker nÃ o trÃ¬nh duyá»‡t nháº­n vá» mÃ  khÃ´ng bá»‹ thay Ä‘á»•i khi lÆ°u thÃ´ng qua máº¡ng. CÃ¡c trÃ¬nh duyá»‡t há»— trá»£Sá»± há»— trá»£ cho Service Worker ngÃ y cÃ ng Ä‘Æ°á»£c cáº£i thiá»‡n: Báº¡n cÃ³ thá»ƒ theo dÃµi tiáº¿n Ä‘á»™ cho táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t táº¡i Ä‘Ã¢y: https://jakearchibald.github.io/isserviceworkerready/ Service Workers má»Ÿ ra chÃ¢n trá»i má»›iMá»™t sá»‘ tÃ­nh nÄƒng Ä‘á»™c Ä‘Ã¡o mÃ  Service Worker cung cáº¥p: Push notifications : cho phÃ©p user tham gia vÃ o láº¯ng nghe cáº­p nháº­t theo thá»i gian Äá»“ng bá»™ dÆ°á»›i ná»n (background sync): cho phÃ©p báº¡n táº¡m hoÃ£n cÃ¡c hÃ nh Ä‘á»™ng cho tá»›i khi user cÃ³ káº¿t ná»‘i á»•n Ä‘á»‹nh. Báº±ng cÃ¡ch nÃ y báº¡n cÃ³ thá»ƒ Ä‘áº£m báº£o ráº±ng báº¥t ká»³ thá»© gÃ¬ mÃ  user cáº§n gá»­i thÃ¬ cháº¯c cháº¯n nÃ³ sáº½ Ä‘Æ°á»£c gá»­i Ä‘i. Äá»“ng bá»™ Ä‘á»‹nh ká»³ (periodic sync - tÆ°Æ¡ng lai): API cung cáº¥p kháº£ nÄƒng quáº£n lÃ½ Ä‘á»“ng bá»™ dÆ°á»›i ná»n theo chu ká»³. Ranh giá»›i áº£o (Geofencing - tÆ°Æ¡ng lai): báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a params, cÃ²n gá»i lÃ  nhá»¯ng geofence bao quanh má»™t khu vá»±c. Webapp sáº½ nháº­n thÃ´ng bÃ¡o khi cÃ³ má»™t thiáº¿t bá»‹ vÆ°á»£t qua geofence, Ä‘iá»u nÃ y cho phÃ©p báº¡n cung cáº¥p tráº£ nghiá»‡m cÃ³ Ã­ch dá»±a trÃªn vá»‹ trÃ­ Ä‘á»‹a lÃ½ cá»§a user. Má»—i má»¥c nÃ y sáº½ Ä‘Æ°á»£c tháº£o luáº­n chi tiáº¿t hÆ¡n trong cÃ¡c bÃ i viáº¿t khÃ¡c. Team tÃ¡c giáº£ Ä‘ang ná»— lá»±c khÃ´ng ngá»«ng Ä‘á»ƒ mang láº¡i tráº£i nghiá»‡m UX mÆ°á»£t mÃ  nháº¥t cÃ³ thá»ƒ cho SessionStack, tá»‘i Æ°u hÃ³a thá»i gian táº£i trang vÃ  thá»i gian pháº£n há»“i. Khi báº¡n replay láº¡i 1 session cá»§a user trÃªn SessionStack (hoáº·c xem nÃ³ trong thá»i gian thá»±c), pháº§n SessionStack front-end sáº½ khÃ´ng ngá»«ng láº¥y dá»¯ liá»‡u tá»« server vá» Ä‘á»ƒ táº¡o ra má»™t tráº£i nghiá»‡m liá»n máº¡ch nhÆ° lÆ°u trong buffer. Má»™t khi báº¡n Ä‘Ã£ tÃ­ch há»£p thÆ° viá»‡n cá»§a SessionStack vÃ o trong webapp, nÃ³ sáº½ báº¯t Ä‘áº§u thu tháº­p dá»¯ liá»‡u liÃªn tá»¥c vá» thay Ä‘á»•i trÃªn DOM, tÆ°Æ¡ng tÃ¡c ngÆ°á»i dÃ¹ng, request máº¡ng, biá»‡t lá»‡ khÃ´ng Ä‘Æ°á»£c xá»­ lÃ½ vÃ  thÃ´ng bÃ¡o lá»—i. Khi má»™t phiÃªn lÃ m viá»‡c Ä‘Æ°á»£c replay hoáº·c stream theo thá»i gian thá»±c thÃ¬ SessionStack phá»¥c vá»¥ táº¥t cáº£ dá»¯ liá»‡u cho phÃ©p báº¡n tháº¥y má»i thá»© vá» tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng á»Ÿ gÃ³c Ä‘á»™ trÃ¬nh duyá»‡t cá»§a user (cáº£ vá» máº·t ká»¹ thuáº­t láº«n hÃ¬nh áº£nh). Nhá»¯ng cÃ´ng viá»‡c nÃ y cáº§n pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n cá»±c nhanh Ä‘á»ƒ khÃ´ng lÃ m cho user pháº£i chá» Ä‘á»£i. Bá»Ÿi vÃ¬ dá»¯ liá»‡u Ä‘Æ°á»£c front-end kÃ©o vá» nÃªn Ä‘Ã¢y lÃ  má»™t sÃ n diá»…n tuyá»‡t vá»i cho Service Worker cÃ³ thá»ƒ â€œtá»a sÃ¡ngâ€ mÃ  xá»­ lÃ½ nhá»¯ng trÆ°á»ng há»£p nhÆ° reload player vÃ  stream má»i thá»© thÃªm vÃ i láº§n ná»¯a. Xá»­ lÃ½ káº¿t ná»‘i máº¡ng bá»‹ cháº­m cÅ©ng cá»±c ká»³ quan trá»ng.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P7: ThÃ nh pháº§n cá»§a WebWorker + 5 trÆ°á»ng há»£p sá»­ dá»¥ng","slug":"Cach-Javascript-hoat-dong-P7-Thanh-phan-cua-WebWorker-5-truong-hop-su-dung","date":"2018-11-16T00:27:00.000Z","updated":"2018-11-16T00:30:02.825Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P7-Thanh-phan-cua-WebWorker-5-truong-hop-su-dung.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P7-Thanh-phan-cua-WebWorker-5-truong-hop-su-dung.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 7 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Trong bÃ i nÃ y chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» Web Workers: má»™t cÃ¡i nhÃ¬n tá»•ng quan, tháº£o luáº­n vá» cÃ¡c loáº¡i worker khÃ¡ch nhau, cÃ¡c thÃ nh pháº§n cá»§a nÃ³ hoáº¡t Ä‘á»™ng vá»›i nhau nhÆ° tháº¿ nÃ o vÃ  nhá»¯ng Ä‘iá»ƒm máº¡nh cÅ©ng nhÆ° Ä‘iá»ƒm yáº¿u cá»§a nÃ³ trong cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau. Cuá»‘i cÃ¹ng, team tÃ¡c giáº£ sáº½ cung cáº¥p 5 trÆ°á»ng há»£p mÃ  trong Ä‘Ã³ Web Worker lÃ  sá»± lá»±a chá»n Ä‘Ãºng Ä‘áº¯n. Báº¡n Ä‘Ã£ quen vá»›i sá»± tháº­t ráº±ng Javascript cháº¡y Ä‘Æ¡n luá»“ng nhÆ° chÃºng ta Ä‘Ã£ tháº£o luáº­n chi tiáº¿t á»Ÿ bÃ i trÆ°á»›c. JS cÅ©ng giÃºp cÃ¡c developer viáº¿t code báº¥t Ä‘á»“ng bá»™.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 7 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Trong bÃ i nÃ y chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» Web Workers: má»™t cÃ¡i nhÃ¬n tá»•ng quan, tháº£o luáº­n vá» cÃ¡c loáº¡i worker khÃ¡ch nhau, cÃ¡c thÃ nh pháº§n cá»§a nÃ³ hoáº¡t Ä‘á»™ng vá»›i nhau nhÆ° tháº¿ nÃ o vÃ  nhá»¯ng Ä‘iá»ƒm máº¡nh cÅ©ng nhÆ° Ä‘iá»ƒm yáº¿u cá»§a nÃ³ trong cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau. Cuá»‘i cÃ¹ng, team tÃ¡c giáº£ sáº½ cung cáº¥p 5 trÆ°á»ng há»£p mÃ  trong Ä‘Ã³ Web Worker lÃ  sá»± lá»±a chá»n Ä‘Ãºng Ä‘áº¯n. Báº¡n Ä‘Ã£ quen vá»›i sá»± tháº­t ráº±ng Javascript cháº¡y Ä‘Æ¡n luá»“ng nhÆ° chÃºng ta Ä‘Ã£ tháº£o luáº­n chi tiáº¿t á»Ÿ bÃ i trÆ°á»›c. JS cÅ©ng giÃºp cÃ¡c developer viáº¿t code báº¥t Ä‘á»“ng bá»™. Nhá»¯ng háº¡n cháº¿ cá»§a láº­p trÃ¬nh báº¥t Ä‘á»“ng bá»™ChÃºng ta Ä‘Ã£ tháº£o luáº­n á»Ÿ bÃ i trÆ°á»›c vá» láº­p trÃ¬nh báº¥t Ä‘á»“ng bá»™ vÃ  khi nÃ o thÃ¬ nÃªn dÃ¹ng. Láº­p trÃ¬nh báº¥t Ä‘á»“ng bá»™ cho phÃ©p UI cá»§a app trá»Ÿ nÃªn mÆ°á»£t mÃ , báº±ng cÃ¡ch â€œlÃªn lá»‹châ€ cho tá»«ng pháº§n cá»§a code Ä‘Æ°á»£c thá»±c thi á»Ÿ thá»i gian phÃ¹ há»£p trong event loop, do Ä‘Ã³ nÃ³ cho phÃ©p render UI Ä‘Æ°á»£c thá»±c hiá»‡n trÆ°á»›c. Má»™t trÆ°á»ng há»£p tá»‘t Ä‘á»ƒ dÃ¹ng láº­p trÃ¬nh báº¥t Ä‘á»“ng bá»™ lÃ  khi ta gá»i Ajax request. Bá»Ÿi vÃ¬ request cÃ³ thá»ƒ tá»‘n nhiá»u thá»i gian nÃªn cÃ³ thá»ƒ Ä‘á»ƒ cho nÃ³ cháº¡y báº¥t Ä‘á»“ng bá»™ vÃ  trong khi client chá» káº¿t quáº£ tráº£ vá», nhá»¯ng code khÃ¡c váº«n Ä‘Æ°á»£c thá»±c thi. 1234567// Giáº£ sá»­ báº¡n dÃ¹ng jQueryjQuery.ajax(&#123; url: 'https://api.example.com/endpoint', success: function(response) &#123; // code Ä‘Æ°á»£c thá»±c thi khi response tráº£ vá» &#125;&#125;); NhÆ°ng Ä‘iá»u nÃ y láº¡i gÃ¢y ra váº¥n Ä‘á» khÃ¡c: request Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi Web API cá»§a trÃ¬nh duyá»‡t, nhÆ°ng lÃ m tháº¿ nÃ o mÃ  code khÃ¡c cÃ³ thá»ƒ cháº¡y báº¥t Ä‘á»“ng bá»™? VÃ­ dá»¥ náº¿u nhÆ° code bÃªn trong má»™t success callback láº¡i cháº¡y ngá»‘n ráº¥t nhiá»u CPU: 1var result = performCPUIntensiveCalculation(); Náº¿u nhÆ° performCPUIntensiveCalculation khÃ´ng pháº£i lÃ  má»™t request HTTP nhÆ°ng láº¡i block code xá»­ lÃ½ (vÃ­ dá»¥: 1 vÃ²ng láº·p ráº¥t lá»›n), khÃ´ng cÃ³ cÃ¡ch nÃ o Ä‘á»ƒ giáº£i phÃ³ng event loop vÃ  unblock cho UI trÃ¬nh duyá»‡t, nÃ³ sáº½ Ä‘Ã³ng bÄƒng vÃ  khÃ´ng pháº£n há»“i láº¡i vá»›i user. NghÄ©a lÃ  trong Javascript, nhá»¯ng hÃ m báº¥t Ä‘á»“ng bá»™ chá»‰ giáº£i quyáº¿t váº¥n Ä‘á» nhá» cá»§a háº¡n cháº¿ á»Ÿ Ä‘Æ¡n luá»“ng. Trong nhá»¯ng trÆ°á»ng há»£p Ä‘Ã³, báº¡n cÃ³ thá»ƒ lÃ m cho unblock UI khá»i quÃ¡ trÃ¬nh tÃ­nh toÃ¡n quÃ¡ lÃ¢u báº±ng cÃ¡ch sá»­ dá»¥ng setTimeout. VÃ­ dá»¥, tÃ¡ch má»™t chuá»—i xá»­ lÃ½ tÃ­nh toÃ¡n phá»©c táº¡p vÃ o trong nhiá»u lá»i gá»i setTimeout, báº±ng cÃ¡ch Ä‘Ã³ báº¡n cÃ³ thá»ƒ Ä‘áº·t chÃºng vÃ o nhá»¯ng â€œvá»‹ trÃ­â€ khÃ¡c nhau trong event loop vÃ  cÃ¡ch nÃ y cÃ³ thá»ƒ giÃºp cho render UI Ä‘Æ°á»£c tá»‘t hÆ¡n. CÃ¹ng xem má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» tÃ­nh toÃ¡n sá»‘ trung bÃ¬nh cá»§a 1 máº£ng sá»‘ nguyÃªn: 123456789101112131415function average(numbers) &#123; var len = numbers.length, sum = 0, i; if (len === 0) &#123; return 0; &#125; for (i = 0; i &lt; len; i++) &#123; sum += numbers[i]; &#125; return sum / len;&#125; DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch ta viáº¿t láº¡i code trÃªn vÃ  â€œgiáº£ láº­pâ€ trÆ°á»ng há»£p báº¥t Ä‘á»“ng bá»™: 1234567891011121314151617181920212223function averageAsync(numbers, callback) &#123; var len = numbers.length, sum = 0; if (len === 0) &#123; return 0; &#125; function calculateSumAsync(i) &#123; if (i &lt; len) &#123; // ÄÆ°a hÃ m tiáº¿p theo vÃ o event loop setTimeout(function() &#123; sum += numbers[i]; calculateSumAsync(i + 1); &#125;, 0); &#125; else &#123; // háº¿t máº£ng, gá»i callback callback(sum / len); &#125; &#125; calculateSumAsync(0);&#125; CÃ¡ch nÃ y sáº½ dÃ¹ng setTimeout Ä‘á»ƒ thÃªm má»—i bÆ°á»›c thá»±c hiá»‡n tÃ­nh toÃ¡n vÃ o trong event loop. Giá»¯a má»—i láº§n tÃ­nh toÃ¡n sáº½ cÃ³ Ä‘á»§ thá»i gian cho cÃ¡c tÃ­nh toÃ¡n Ä‘Æ°á»£c thÃªm vÃ o vÃ  giáº£i phÃ³ng trÃ¬nh duyá»‡t khá»i bá»‹ Ä‘Ã³ng bÄƒng. Web Workers Ä‘áº¿n giáº£i cá»©uHTML5 mang Ä‘áº¿n cho chÃºng ta ráº¥t nhiá»u thá»© tuyá»‡t vá»i: SSE (Ä‘Ã£ tháº£o luáº­n vÃ  so sÃ¡nh vá»›i WebSocket á»Ÿ bÃ i trÆ°á»›c) Geolocation Application cache Local Storage Drag and Drop Web Workers Web Workers lÃ  tiáº¿n trÃ¬nh trong trÃ¬nh duyá»‡t nhÆ°ng cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thá»±c thi Javascript code mÃ  khÃ´ng cáº£n trá»Ÿ event loop Äiá»u nÃ y thá»±c sá»± ká»³ diá»‡u. ToÃ n bá»™ mÃ´ hÃ¬nh cá»§a Javascript dá»±a trÃªn Ã½ tÆ°á»Ÿng vá» mÃ´i trÆ°á»ng Ä‘Æ¡n luá»“ng nhÆ°ng giá» Ä‘Ã¢y lÃ  cÃ³ Web Workers vÃ  nÃ³ gá»¡ bá» (1 pháº§n nÃ o) sá»± háº¡n cháº¿ Ä‘Ã³. Web Workers cho phÃ©p developer Ä‘áº·t nhá»¯ng cÃ´ng viá»‡c cÃ³ thá»i gian cháº¡y dÃ i vÃ  nhá»¯ng cÃ´ng viá»‡c náº·ng vá» xá»­ lÃ½ tÃ­nh toÃ¡n trong background mÃ  khÃ´ng gÃ¢y trá»Ÿ ngáº¡i Ä‘áº¿n UI, lÃ m app cá»§a báº¡n mÆ°á»£t mÃ  hÆ¡n. NgoÃ i ra, khÃ´ng cáº§n pháº£i xÃ i trick vá»›i setTimeout Ä‘á»ƒ Ä‘Ã¡nh lá»«a event loop ná»¯a. á» Ä‘Ã¢y cÃ³ má»™t demo máº«u thá»ƒ hiá»‡n sá»± khÃ¡c nhau khi thá»±c hiá»‡n sáº¯p xáº¿p máº£ng dÃ¹ng vÃ  khÃ´ng dÃ¹ng Web Workers. KhÃ¡i quÃ¡t vá» Web WorkersWeb Workers cho phÃ©p báº¡n lÃ m nhá»¯ng viá»‡c nhÆ° thá»±c thi cÃ¡c Ä‘oáº¡n code xá»­ lÃ½ tá»‘n thá»i gian Ä‘á»ƒ tÃ­nh toÃ¡n cÃ¡c phÃ©p tÃ­nh hao tá»•n nheiefu CPU nhÆ°ng khÃ´ng lÃ m cáº£n trá»Ÿ UI. Thá»±c ra, nÃ³ sáº½ cháº¡y song song. Web Workers lÃ  Ä‘a luá»“ng. Báº¡n sáº½ tháº¯c máº¯c: â€œChá»© khÃ´ng pháº£i Javascript lÃ  ngÃ´n ngá»¯ Ä‘Æ¡n luá»“ng Ã ?â€ ÄÃ¢y lÃ  lÃºc mÃ  báº¡n sáº½ thá»‘t lÃªn aha ngáº¡c nhiÃªn khi nháº­n ra Javascript lÃ  má»™t ngÃ´n ngá»¯ khÃ´ng Ä‘á»‹nh nghÄ©a mÃ´ hÃ¬nh tiáº¿n trÃ¬nh. Web Workers khÃ´ng pháº£i lÃ  má»™t pháº§n cá»§a Javascript, nÃ³ lÃ  tÃ­nh nÄƒng cá»§a trÃ¬nh duyá»‡t mÃ  cÃ³ thá»ƒ truy xuáº¥t thÃ´ng qua Javascript. Äa sá»‘ cÃ¡c trÃ¬nh duyá»‡t cÃ³ lá»‹ch sá»­ vá» Ä‘Æ¡n tiáº¿n trÃ¬nh (giá» thÃ¬ thay Ä‘á»•i rá»“i), vÃ  Ä‘a sá»‘ cÃ¡c triá»ƒn khai cá»§a Javascript Ä‘á»u diá»…n ra trÃªn trÃ¬nh duyá»‡t. Web Workers khÃ´ng Ä‘Æ°á»£c triá»ƒn khai trÃªn Node.js, nÃ³ cÃ³ khÃ¡i niá»‡m hÆ¡i khÃ¡c má»™t chÃºt vá» cluster hay child_process. CÃ³ 3 loáº¡i Web Workers Ä‘Æ°á»£c Ä‘á» cáº­p Ä‘áº¿n trong thÃ´ng sá»‘ ká»¹ thuáº­t: Dedicated Workers Shared Workers Service workers Dedicated Workers (Worker chuyÃªn dá»¥ng)Dedicated Web Workers Ä‘Æ°á»£c khá»Ÿi táº¡o bá»Ÿi tiáº¿n trÃ¬nh chÃ­nh vÃ  chá»‰ cÃ³ thá»ƒ giao tiáº¿p vá»›i tiáº¿n trÃ¬nh Ä‘Ã³. Shared Workers (Worker chia sáº»)Shared Workers cÃ³ thá»ƒ Ä‘Æ°á»£c truy cáº­p bá»Ÿi táº¥t cáº£ cÃ¡c tiáº¿n trÃ¬nh cháº¡y trÃªn cÃ¹ng origin (khÃ¡c tab trÃ¬nh duyá»‡t, iframe hoáº·c lÃ  cÃ¡c shared worker khÃ¡c) Náº¿u báº¡n muá»‘n dÃ¹ng thá»­ SessionStack Ä‘á»ƒ hiá»ƒu vÃ  khÃ¡m phÃ¡ láº¡i nhá»¯ng váº¥n Ä‘á» ká»¹ thuáº­t cÅ©ng nhÆ° UX trÃªn webapp cá»§a báº¡n, team SessionStack Ä‘ang cÃ³ báº£n dÃ¹ng thá»­ miá»…n phÃ­, á»Ÿ Ä‘Ã¢y nhÃ©. Service Workers (Worker dá»‹ch vá»¥)Má»™t Service Worker lÃ  worker hÆ°á»›ng sá»± kiá»‡n (event-driven) Ä‘Æ°á»£c Ä‘Äƒng kÃ½ vá»›i origin vÃ  path. NÃ³ cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn web page/site mÃ  nÃ³ liÃªn káº¿t, can thiá»‡p vÃ  chá»‰nh sá»­a sá»± Ä‘iá»u hÆ°á»›ng vÃ  cÃ¡c yÃªu cáº§u tÃ i nguyÃªn, lÆ°u Ä‘á»‡m tÃ i nguyÃªn vá»›i phong cÃ¡ch ráº¥t chi tiáº¿t Ä‘á»ƒ cho phÃ©p báº¡n cÃ³ toÃ n quyá»n Ä‘iá»u khiá»ƒn vá» viá»‡c app cá»§a báº¡n xá»­ lÃ½ nhÆ° tháº¿ nÃ o trong tá»«ng trÆ°á»ng há»£p cá»¥ thá»ƒ (vÃ­ dá»¥ nhÆ° khi rá»›t máº¡ng) Trong bÃ i nÃ y chÃºng ta sáº½ táº­p trung vÃ o Dedicated Worker vÃ  chá»‰ gá»i nÃ³ dÆ°á»›i cÃ¡i tÃªn Web Workers hoáº·c Worker Web Workers hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?Web Workers Ä‘Æ°á»£c triá»ƒn khai dÆ°á»›i dáº¡ng Ä‘uÃ´i .js vÃ  Ä‘Æ°á»£c Ä‘Ã­nh kÃ¨m theo request HTTP báº¥t Ä‘á»“ng bá»™ trong web cá»§a báº¡n. Nhá»¯ng request nÃ y Ä‘Æ°á»£c áº©n hoÃ n toÃ n bá»Ÿi Web Worker API Workers sá»­ dá»¥ng message kiá»ƒu tiáº¿n trÃ¬nh Ä‘á»ƒ thá»±c hiá»‡n quÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng song song. ChÃºng cÃ³ thá»ƒ giá»¯ cho UI Ä‘Æ°á»£c cáº­p nháº­t má»›i nháº¥t, cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vÃ  mÆ°á»£t mÃ  vá»›i ngÆ°á»i dÃ¹ng má»™t cÃ¡ch hoÃ n háº£o. Web Workers cháº¡y trong má»™t tiáº¿n trÃ¬nh cÃ´ láº­p trong trÃ¬nh duyá»‡t. Do Ä‘Ã³ lÃ  code chÃºng thá»±c thi cáº§n pháº£i Ä‘áº·t trong 1 file riÃªng biá»‡t. Äiá»u nÃ y ráº¥t quan trá»ng nhÃ©. CÃ¡ch táº¡o worker cÆ¡ báº£n 1var worker = new Worker('task.js'); Náº¿u task.js tá»“n táº¡i vÃ  cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c, trÃ¬nh duyá»‡t sáº½ thiáº¿t láº­p má»™t tiáº¿n trÃ¬nh má»›i Ä‘á»ƒ táº£i file báº¥t Ä‘á»“ng bá»™. Sau khi quÃ¡ trÃ¬nh táº£i file hoÃ n táº¥t, nÃ³ sáº½ thá»±c thi code trong Ä‘Ã³ vÃ  worker báº¯t Ä‘áº§u lÃ m viá»‡c. Trong trÆ°á»ng há»£p file lá»—i khÃ´ng load Ä‘Æ°á»£c thÃ¬ tráº£ vá» 404 vÃ  worker sáº½ dá»«ng láº¡i má»™t cÃ¡ch yÃªn láº·ng nhÆ° chÆ°a cÃ³ gÃ¬ xáº£y ra. Äá»ƒ báº¯t Ä‘áº§u táº¡o worker, báº¡n cáº§n gá»i phÆ°Æ¡ng thá»©c postMessage: 1worker.postMessage(); Giao tiáº¿p cá»§a Web WorkerÄá»ƒ giao tiáº¿p giá»¯a má»™t Web Worker vÃ  trang cá»§a báº¡n thÃ¬ báº¡n cáº§n pháº£i sá»­ dá»¥ng phÆ°Æ¡ng thá»©c postMessage hoáº·c kÃªnh phÃ¡t sÃ³ng (Broadcast channel). PhÆ°Æ¡ng thá»©c postMessageCÃ¡c trÃ¬nh duyá»‡t má»›i há»— trá»£ object JSON nhÆ° lÃ  param Ä‘áº§u tiÃªn cá»§a phÆ°Æ¡ng thá»©c trong khi cÃ¡c trÃ¬nh duyá»‡t cÅ© hÆ¡n thÃ¬ chá»n string DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ vá» má»™t page cÃ³ worker cÃ³ thá»ƒ giao tiáº¿p qua láº¡i vá»›i nÃ³ nhÆ° tháº¿ nÃ o báº±ng cÃ¡ch truyá»n má»™t object JSON. Truyá»n string cÅ©ng tÆ°Æ¡ng tá»±: 123456789101112&lt;button onclick=\"startComputation()\"&gt;Start computation&lt;/button&gt;&lt;script&gt; function startComputation() &#123; worker.postMessage(&#123;'cmd': 'average', 'data': [1, 2, 3, 4]&#125;); &#125; var worker = new Worker('doWork.js'); worker.addEventListener('message', function(e) &#123; console.log(e.data); &#125;, false);&lt;/script&gt; VÃ  Ä‘oáº¡n code cá»§a worker: 1234567891011self.addEventListener('message', function(e) &#123; var data = e.data; switch (data.cmd) &#123; case 'average': var result = calculateAverage(data); // TÃ­nh trung bÃ¬nh cá»™ng tá»« má»™t array self.postMessage(result); break; default: self.postMessage('Unknown command'); &#125;&#125;, false); Khi click vÃ o button, trang chÃ­nh sáº½ gá»i tá»›i postMessage. DÃ²ng worker.postMessage truyá»n má»™t object JSON vÃ o worker, object chá»©a thÃ´ng tin lÃ  cmd vÃ  data. Worker sáº½ xá»­ lÃ½ message thÃ´ng qua má»™t message handler Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a. Khi message Ä‘áº¿n, cÃ¡c thao tÃ¡c tÃ­nh toÃ¡n thá»±c sá»± sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n trong worker mÃ  khÃ´ng cáº£n trá»Ÿ event loop. Worker kiá»ƒm tra event e Ä‘Æ°á»£c truyá»n vÃ o vÃ  thá»±c thi giá»‘ng nhÆ° má»™t hÃ m Javascript bÃ¬nh thÆ°á»ng. Khi xong viá»‡c káº¿t quáº£ sáº½ Ä‘Æ°á»£c tráº£ ngÆ°á»£c láº¡i cho trang chÃ­nh. Trong ngá»¯ cáº£nh cá»§a worker, cáº£ self vÃ  this Ä‘á»u Ä‘ang tham chiáº¿u Ä‘áº¿n global scope. CÃ³ 2 cÃ¡ch Ä‘á»ƒ dá»«ng worker: gá»i hÃ m worker.terminate() tá»« ngoÃ i trang chÃ­nh hoáº·c gá»i self.close() bÃªn trong worker. KÃªnh phÃ¡t sÃ³ng (Broadcast Channel)Broadcast Channel giá»‘ng nhÆ° má»™t API giao tiáº¿p tá»•ng quÃ¡t. NÃ³ cho phÃ©p chÃºng ta broadcast message tá»›i táº¥t cáº£ cÃ¡c ngá»¯ cáº£nh cÃ¹ng chia sáº» chung origin. Táº¥t cáº£ cÃ¡c tab trÃ¬nh duyá»‡t, iframe hoáº·c worker phá»¥c vá»¥ chung origin cÃ³ thá»ƒ phÃ¡t vÃ  nháº­n message. 1234567891011121314// Káº¿t ná»‘i Ä‘áº¿n má»™t broadcast channelvar bc = new BroadcastChannel('test_channel');// VÃ­ dá»¥ gá»­i má»™t message Ä‘Æ¡n giáº£nbc.postMessage('This is a test message.');// VÃ­ dá»¥ vá» má»™t event handler cÃ³ chá»©c// nÄƒng in message ra consolebc.onmessage = function (e) &#123; console.log(e.data); &#125;// Ngáº¯t káº¿t ná»‘ibc.close() Xem hÃ¬nh minh há»a thÃ¬ báº¡n sáº½ hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Broadcast Channel rÃµ rÃ ng hÆ¡n: Broadcast Channel bá»‹ háº¡n cháº¿ há»— trá»£ tá»« cÃ¡c trÃ¬nh duyá»‡t: KÃ­ch thÆ°á»›c messageCÃ³ 2 cÃ¡ch Ä‘á»ƒ gá»­i message trong Web Workers: Sao chÃ©p message: message Ä‘Æ°á»£c serialized, sao chÃ©p, gá»­i Ä‘i vÃ  Ä‘Æ°á»£c de-serialized á»Ÿ Ä‘áº§u kia. Trang web vÃ  worker khÃ´ng dÃ¹ng chung instance, vÃ¬ tháº¿ cuá»‘i cÃ¹ng lÃ  káº¿t quáº£ sáº½ bá»‹ trÃ¹ng láº·p á»Ÿ cáº£ 2 phÃ­a. Äa sá»‘ cÃ¡c trÃ¬nh duyá»‡t triá»ƒn khai tÃ­nh nÄƒng nÃ y báº±ng cÃ¡ch encoding/decoding giÃ¡ trá»‹ á»Ÿ cáº£ 2 phÃ­a thÃ nh JSON má»™t cÃ¡ch tá»± Ä‘á»™ng. ÄÃºng nhÆ° dá»± Ä‘oÃ¡n thÃ¬ cÃ¡c hoáº¡t Ä‘á»™ng dá»¯ liá»‡u nhÆ° tháº¿ nÃ y bá»• sung thÃªm chi phÃ­ Ä‘Ã¡ng ká»ƒ vÃ o viá»‡c truyá»n táº£i message. Message cÃ ng lá»›n thÃ¬ thá»i gian gá»­i cÃ ng lÃ¢u. Truyá»n táº£i message: Ä‘iá»u nÃ y nghÄ©a lÃ  bÃªn gá»­i sáº½ khÃ´ng thá»ƒ sá»­ dá»¥ng nÃ³ má»™t khi Ä‘Ã£ gá»­i Ä‘i. Truyá»n táº£i dá»¯ liá»‡u gáº§n nhÆ° tá»©c thá»i. Háº¡n cháº¿ lÃ  chá»‰ duy nháº¥t ArrayBuffer lÃ  cÃ³ thá»ƒ gá»­i Ä‘Æ°á»£c. TÃ­nh nÄƒng cÃ³ sáºµn cá»§a Web WorkersWeb Workder chá»‰ cÃ³ truy xuáº¥t tá»›i má»™t táº­p há»£p nhá» cÃ¡c tÃ­nh nÄƒng cá»§a Javascript bá»Ÿi vÃ¬ báº£n cháº¥t Ä‘a luá»“ng cá»§a nÃ³, dÆ°á»›i Ä‘Ã¢y lÃ  danh sÃ¡ch cÃ¡c tÃ­nh nÄƒng: Object navigator Object location (chá»‰ Ä‘á»c - read only) XMLHttpRequest setTimeout()/clearTimeout() vÃ  setInterval()/clearInterval() Bá»™ Ä‘á»‡m á»©ng dá»¥ng (Application Cache) Import script bÃªn ngoÃ i thÃ´ng qua importScripts() Táº¡o cÃ¡c web worker khÃ¡c Háº¡n cháº¿ cá»§a Web WorkersHÆ¡i buá»“n lÃ  Web Worker khÃ´ng cÃ³ quyá»n truy cáº­p Ä‘áº¿n má»™t sá»‘ tÃ­nh nÄƒng quan trá»ng cá»§a Javascript: DOM (not thread-safe) Object window Object document Object parent Äiá»u nÃ y nghÄ©a lÃ  Web Worker khÃ´ng thá»ƒ thay Ä‘á»•i DOM (vÃ  UI). NÃ³ cÃ³ thá»ƒ hÆ¡i khÃ³ khÄƒn, nhÆ°ng náº¿u báº¡n Ä‘Ã£ quen vá»›i viÃªc sá»­ dá»¥ng Web Worker Ä‘Ãºng cÃ¡ch thÃ¬ báº¡n sáº½ báº¯t Ä‘áº§u sá»­ dá»¥ng kháº£ nÄƒng â€œtÃ­nh toÃ¡n Ä‘á»™c láº­pâ€ cá»§a nÃ³ trong khi cÃ¡c code thay Ä‘á»•i UI Ä‘ang Ä‘Æ°á»£c xá»­ lÃ½ vÃ  hoáº¡t Ä‘á»™ng. Worker sáº½ chÄƒm sÃ³c táº¥t cáº£ nhá»¯ng pháº§n náº·ng nhá»c cho báº¡n vÃ  khi Ä‘Ã£ xong viÃªc thÃ¬ báº¡n chá»‰ cáº§n gá»­i káº¿t quáº£ ra mÃ n hÃ¬nh Ä‘á»ƒ cáº­p nháº­t UI cho phÃ¹ há»£p. Xá»­ lÃ½ lá»—iGiá»‘ng nhÆ° code Javascript khÃ¡c, báº¡n sáº½ cáº§n xá»­ lÃ½ lá»—i khi Web Worker báº¯n ra. Náº¿u cÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh worker thá»±c thi, ErrorEvent sáº½ Ä‘Æ°á»£c báº¯n. Interface nÃ y sáº½ bao gá»“m 3 thuá»™c tÃ­nh há»¯u Ã­ch cho viá»‡c tÃ¬m ra báº¡n Ä‘ang sai chá»— nÃ o: filename: tÃªn cá»§a worker script gÃ¢y ra lá»—i lineno: sá»‘ cá»§a dÃ²ng gÃ¢y ra lá»—i message: mÃ´ táº£ lá»—i VÃ­ dá»¥: 1234567891011function onError(e) &#123; console.log('Line: ' + e.lineno); console.log('In: ' + e.filename); console.log('Message: ' + e.message);&#125;var worker = new Worker('workerWithError.js');worker.addEventListener('error', onError, false);worker.postMessage(); // Khá»Ÿi táº¡o worker mÃ  khÃ´ng truyá»n messageself.addEventListener('message', function(e) &#123; postMessage(x * 2); // Intentional error. 'x' is not defined.&#125;; á» Ä‘Ã¢y báº¡n tháº¥y ráº±ng chÃºng ta táº¡o worker vÃ  báº¯t Ä‘áº§u listen sá»± kiá»‡n error. BÃªn trong worker (file workerWithError.js) chÃºng ta cá»‘ tÃ¬nh táº¡o má»™t exception báº±ng cÃ¡ch nhÃ¢n x vá»›i 2 trong khi x khÃ´ng há» tá»“n táº¡i trong scope Ä‘Ã³. Exception Ä‘Æ°á»£c báº¯n ra khi khá»Ÿi táº¡o script vÃ  hÃ m onError Ä‘Æ°á»£c gá»i vá»›i thÃ´ng tin vá» lá»—i. TrÆ°á»ng há»£p nÃªn sá»­ dá»¥ng Web WorkersCho Ä‘áº¿n bÃ¢y giá» thÃ¬ chÃºng ta Ä‘Ã£ nghiÃªn cá»©u vá» Ä‘iá»ƒm máº¡nh vÃ  háº¡n cháº¿ cá»§a Web Workers. CÃ¹ng xem nhá»¯ng trÆ°á»ng hÆ¡p nÃ o thÃ¬ dÃ¹ng chÃºng lÃ  tá»‘t nháº¥t: DÃ² tia (Ray tracing): ray tracing lÃ  má»™t ká»¹ thuáº­t render Ä‘á»ƒ sinh ra nhá»¯ng hÃ¬nh áº£nh báº±ng cÃ¡ch dÃ² theo váº¿t Ä‘Æ°á»ng Ä‘i cá»§a Ã¡nh sÃ¡ng theo dáº¡ng pixel. Ray traycing sá»­ dá»¥ng ráº¥t nhiá»u phÃ©p tÃ­nh toÃ¡n há»c cÃ³ áº£nh hÆ°á»›ng lá»›n Ä‘áº¿n CPU Ä‘á»ƒ giáº£ láº­p Ä‘Æ°á»ng Ä‘i cá»§a Ã¡nh sÃ¡ng. Ã tÆ°á»Ÿng vá» giáº£ láº­p nhá»¯ng hiá»‡u á»©ng nhÆ° pháº£n chiáº¿u (reflection), khÃºc xáº¡ (refraction), váº­t liá»‡u, vÃ¢n vÃ¢n. Táº¥t cáº£ cÃ¡c logic tÃ­nh toÃ¡n nhÆ° váº­y Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°a vÃ o Web Worker Ä‘á»ƒ trÃ¡nh gÃ¢y trá»Ÿ ngáº¡i vá»›i UI thread. Tháº­m chÃ­ cÃ³ thá»ƒ tá»‘t hÆ¡n náº¿u báº¡n cÃ³ thá»ƒ chia nhá» quÃ¡ trÃ¬nh render hÃ¬nh áº£nh ra nhiá»u worker (vÃ  chia ra nhiá»u CPU). ÄÃ¢y lÃ  1 minh há»a Ä‘Æ¡n giáº£n cá»§a ray tracing sá»­ dá»¥ng Web Workers: https://nerget.com/rayjs-mt/rayjs.html MÃ£ hÃ³a (Encryption): MÃ£ hÃ³a end-to-end (E2EE) cÃ ng ngÃ y cÃ ng phá»• biáº¿n do sá»± gia tÄƒng kháº¯t khe vá» cÃ¡c quy Ä‘á»‹nh cá»§a dá»¯ liá»‡u nháº¡y cáº£m &amp; cÃ¡ nhÃ¢n. MÃ£ hÃ³a cÃ³ thá»ƒ khÃ¡ tá»‘n thá»i gian, Ä‘áº·c biá»‡t náº¿u cÃ³ ráº¥t nhiá»u dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c mÃ£ hÃ³a thÆ°á»ng xuyÃªn (trÆ°á»›c khi gá»­i vá» server cháº³ng háº¡n). ÄÃ¢y lÃ  má»™t trÆ°á»ng há»£p trong Ä‘Ã³ Web Worker lÃ  lá»±a chá»n ráº¥t tá»‘t vÃ¬ nÃ³ khÃ´ng yÃªu cáº§u truy xuáº¥t Ä‘áº¿n DOM hay cÃ¡c thá»© khÃ¡c, chá»‰ thuáº§n tÃºy lÃ  thuáº­t toÃ¡n mÃ£ hÃ³a. Má»™t khi Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº©y vÃ o worker xá»­ lÃ½, nÃ³ sáº½ hoáº¡t Ä‘á»™ng ráº¥t trÆ¡n tru vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n tráº£i nghiá»‡m cá»§a ngÆ°á»i dÃ¹ng. Táº£i trÆ°á»›c dá»¯ liá»‡u: Äá»ƒ tá»‘i Æ°u website hoáº·c webapp vÃ  cáº£i thiá»‡n thá»i gian loading, báº¡n cÃ³ thá»ƒ nhá» váº£ Web Workers Ä‘á»ƒ load vÃ  lÆ°u dá»¯ liá»‡u trÆ°á»›c vÃ  sá»­ dá»¥ng chÃºng vá» sau khi cáº§n Ä‘áº¿n. Web Workers ráº¥t tá»‘t trong trÆ°á»ng há»£p nÃ y vÃ¬ nÃ³ khÃ´ng áº£nh hÆ°á»›ng Ä‘áº¿n UI, khÃ´ng giá»‘ng nhÆ° khi ta dÃ¹ng mÃ  khÃ´ng cÃ³ workers. Progressive Web Apps: ChÃºng cáº§n Ä‘Æ°á»£c load tháº­t nhanh ká»ƒ cáº£ khi káº¿t ná»‘i máº¡ng khÃ´ng á»•n Ä‘á»‹nh. NghÄ©a lÃ  dá»¯ liá»‡u cáº§n pháº£i Ä‘Æ°á»£c lÆ°u trÃªn trÃ¬nh duyá»‡t. IndexDB hoáº·c nhá»¯ng API tÆ°Æ¡ng tá»± há»— trá»£ tá»‘t khoáº£n nÃ y. Vá» cÆ¡ báº£n thÃ¬ lÆ°u trá»¯ á»Ÿ phÃ­a client lÃ  cáº§n thiáº¿t. Äá»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng mÃ  khÃ´ng gÃ¢y cáº£n trá»Ÿ Ä‘áº¿n UI, cÃ´ng viá»‡c cáº§n pháº£i Ä‘Æ°á»£c hoÃ n thÃ nh trong Web Workers. Trong trÆ°á»ng há»£p cá»§a IndexDB, cÃ³ má»™t API báº¥t Ä‘á»“ng bá»™ cho phÃ©p báº¡n lÃ m viá»‡c nÃ y mÃ  khÃ´ng dÃ¹ng workers, tuy nhiÃªn cÅ©ng cÃ³ má»™t API Ä‘á»“ng bá»™ trÆ°á»›c Ä‘Ã¢y (cÃ³ thá»ƒ sáº½ Ä‘Æ°á»£c giá»›i thiá»‡u láº¡i) chá»‰ Ä‘Æ°á»£c phÃ©p cháº¡y bÃªn trong workers. Kiá»ƒm tra chÃ­nh táº£ (Spell checking): má»™t bá»™ spell checker cÆ¡ báº£n hoáº¡t Ä‘á»™ng nhÆ° sau: chÆ°Æ¡ng trÃ¬nh sáº½ Ä‘á»c má»™t file tá»« Ä‘iá»ƒn vá»›i danh sÃ¡ch cÃ¡c tá»« Ä‘Ãºng chÃ­nh táº£. Tá»« Ä‘iá»ƒn sáº½ Ä‘Æ°á»£c parse thÃ nh cÃ¢y tÃ¬m kiáº¿m (search tree) Ä‘á»ƒ cÃ³ thá»ƒ tÃ¬m kiáº¿m vÄƒn báº£n hiá»‡u quáº£. Khi má»™t tá»« Ä‘Æ°á»£c Ä‘Æ°a vÃ o checker, chÆ°Æ¡ng trÃ¬nh sáº½ kiá»ƒm tra náº¿u nÃ³ tá»“n táº¡i trong cÃ¢y tÃ¬m kiáº¿m. Náº¿u tá»« Ä‘Ã³ khÃ´ng tá»“n táº¡i, chÆ°Æ¡ng trÃ¬nh sáº½ cung cáº¥p tá»« thay tháº¿ báº±ng cÃ¡ch thay Ä‘á»•i kÃ½ tá»± thay tháº¿ vÃ  kiá»ƒm tra náº¿u Ä‘Ã³ lÃ  1 tá»« há»£p lá»‡ náº¿u nÃ³ lÃ  tá»« mÃ  user muá»‘n viáº¿t ra. Táº¥t cáº£ quÃ¡ trÃ¬nh nÃ y cÃ³ thá»ƒ dá»… dÃ ng giáº£m táº£i cho há»‡ thá»‘ng báº±ng Web Workers vÃ  user cÃ³ thá»ƒ gÃµ chá»¯, viáº¿t cÃ¢u mÃ  khÃ´ng gÃ¢y cáº£n trá»Ÿ vá»›i UI trong khi worker thá»±c thi táº¥t cáº£ cÃ¡c pháº§n tÃ¬m kiáº¿m vÃ  Ä‘Æ°a ra Ä‘á» xuáº¥t. Hiá»‡u nÄƒng vÃ  Ä‘á»™ tin cáº­y lÃ  ráº¥t quan trá»ng Ä‘á»‘i vá»›i team SessionStack. LÃ½ do lÃ  vÃ¬ má»™t khi Ä‘Ã£ tÃ­ch há»£p SessionStack vÃ o web app cá»§a báº¡n, chÆ°Æ¡ng trÃ¬nh sáº½ báº¯t Ä‘áº§u ghi láº¡i má»i thá»© tá»« thay Ä‘á»•i trÃªn DOM vÃ  tÆ°Æ¡ng tÃ¡c ngÆ°á»i dÃ¹ng Ä‘áº¿n cÃ¡c request máº¡ng, exception khÃ´ng Ä‘Æ°á»£c xá»­ lÃ½ vÃ  cÃ¡c thÃ´ng bÃ¡o lá»—i. Táº¥t cáº£ dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n vá» cho server cá»§a chÆ°Æ¡ng trÃ¬nh trong thá»i gian thá»±c Ä‘á»ƒ cÃ³ thá»ƒ cho phÃ©p báº¡n cháº¡y láº¡i nhá»¯ng issue tá»« webapp dÆ°á»›i dáº¡ng video vÃ  xem thá»­ Ä‘iá»u gÃ¬ Ä‘ang diá»…n ra vá»›i user. Táº¥t cáº£ Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i Ä‘á»™ trá»… tá»‘i thiá»ƒu vÃ  khÃ´ng cÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u nÄƒng cá»§a app cá»§a báº¡n. ÄÃ¢y lÃ  lÃ½ do mÃ  team tÃ¡c giáº£ Ä‘Ã£ Ä‘Æ°a toÃ n bá»™ logic (pháº§n nÃ o cÃ³ thá»ƒ) tá»« cáº£ thÆ° viá»‡n Ä‘iá»u hÃ nh &amp; pháº§n player vÃ o Web Worker Ä‘á»ƒ xá»­ lÃ½ cÃ¡c cÃ´ng viÃªc náº·ng táº£i vá»›i CPU nhÆ° bÄƒm Ä‘á»ƒ xÃ¡c nháº­n tÃ­nh toÃ n váº¹n dá»¯ liá»‡u, render, vÃ¢n vÃ¢n. CÃ´ng nghá»‡ web liÃªn tá»¥c thay Ä‘á»•i vÃ  phÃ¡t triá»ƒn vÃ¬ tháº¿ team tÃ¡c giáº£ Ä‘Ã£ Ä‘i thÃªm 1 cháº·ng Ä‘Æ°á»ng dÃ i Ä‘á»ƒ Ä‘áº£m báº£o SessionStack tháº­t nháº¹ vÃ  khÃ´ng gÃ¢y áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u nÄƒng cá»§a ngÆ°á»i dÃ¹ng.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P6: So sÃ¡nh vá»›i WebAssembly + Má»™t sá»‘ trÆ°á»ng há»£p tá»‘t hÆ¡n nÃªn sá»­ dá»¥ng","slug":"Cach-Javascript-hoat-dong-P6-So-sanh-voi-WebAssembly-Mot-so-truong-hop-tot-hon-nen-su-dung","date":"2018-11-16T00:19:00.000Z","updated":"2018-11-16T00:21:12.978Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P6-So-sanh-voi-WebAssembly-Mot-so-truong-hop-tot-hon-nen-su-dung.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P6-So-sanh-voi-WebAssembly-Mot-so-truong-hop-tot-hon-nen-su-dung.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 6 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Láº§n nÃ y chÃºng ta sáº½ khÃ¡m phÃ¡ vá» WebAssembly vÃ  phÃ¢n tÃ­ch cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³, quan trá»ng hÆ¡n lÃ  nhá»¯ng Ä‘iá»ƒm vÆ°á»£t trá»™i hÆ¡n so vá»›i Javascript vá» máº·t hiá»‡u nÄƒng: thá»i gian táº£i, tá»‘c Ä‘á»™ thá»±c thi, dá»n rÃ¡c (GC), sá»­ dá»¥ng bá»™ nhá»›, truy cáº­p API, debugging, Ä‘a luá»“ng vÃ  tÃ­nh di Ä‘á»™ng (portability). CÃ¡ch chÃºng ta xÃ¢y dá»±ng web app trÃªn bá» vá»±c cÃ¡ch máº¡ng - váº«n Ä‘ang trong nhá»¯ng ngÃ y Ä‘áº§u nhÆ°ng cÃ¡ch chÃºng ta suy nghÄ© vá» web app Ä‘ang dáº§n thay Ä‘á»•i.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 6 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Láº§n nÃ y chÃºng ta sáº½ khÃ¡m phÃ¡ vá» WebAssembly vÃ  phÃ¢n tÃ­ch cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³, quan trá»ng hÆ¡n lÃ  nhá»¯ng Ä‘iá»ƒm vÆ°á»£t trá»™i hÆ¡n so vá»›i Javascript vá» máº·t hiá»‡u nÄƒng: thá»i gian táº£i, tá»‘c Ä‘á»™ thá»±c thi, dá»n rÃ¡c (GC), sá»­ dá»¥ng bá»™ nhá»›, truy cáº­p API, debugging, Ä‘a luá»“ng vÃ  tÃ­nh di Ä‘á»™ng (portability). CÃ¡ch chÃºng ta xÃ¢y dá»±ng web app trÃªn bá» vá»±c cÃ¡ch máº¡ng - váº«n Ä‘ang trong nhá»¯ng ngÃ y Ä‘áº§u nhÆ°ng cÃ¡ch chÃºng ta suy nghÄ© vá» web app Ä‘ang dáº§n thay Ä‘á»•i. CÃ¹ng xem WebAssembly cÃ³ thá»ƒ lÃ m gÃ¬WebAssembly (gá»i táº¯t wasm) lÃ  má»™t loáº¡i bytecode cáº¥p Ä‘á»™ tháº¥p vÃ  hiá»‡u quáº£ cho web. WASM cho phÃ©p báº¡n sá»­ dá»¥ng ngÃ´n ngá»¯ khÃ¡c Javascript (nhÆ° C, C++, Rustâ€¦), viáº¿t chÆ°Æ¡ng trÃ¬nh vá»›i nhá»¯ng ngÃ´n ngá»¯ Ä‘Ã³, vÃ  biÃªn dá»‹ch trÆ°á»›c (ahead of time) sang WebAssembly. Káº¿t quáº£ lÃ  webapp sáº½ load vÃ  thá»±c thi ráº¥t nhanh. Thá»i gian táº£i (loading time)Äá»ƒ load Javascript, trÃ¬nh duyá»‡t pháº£i load táº¥t cáº£ file .js Ä‘Ãºng nguyÃªn vÄƒn báº£n. WebAssembly load nhanh hÆ¡n trong trÃ¬nh duyá»‡t bá»Ÿi vÃ¬ chá»‰ cÃ³ nhá»¯ng file wasm Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch lÃ  Ä‘Æ°á»£c truyá»n táº£i qua internet. VÃ  bá»Ÿi vÃ¬ wasm lÃ  ngÃ´n ngá»¯ báº­c tháº¥p gáº§n giá»‘ng assembly cÃ³ format nhá»‹ phÃ¢n ráº¥t nhá» gá»n. Thá»±c thi (execution)Wasm cháº¡y cháº­m hÆ¡n 20% so vá»›i native code. DÃ¹ gÃ¬ Ä‘i ná»¯a thÃ¬ Ä‘Ã¢y lÃ  má»™t káº¿t quáº£ Ä‘Ã¡ng kinh ngáº¡c. NÃ³ lÃ  má»™t Ä‘á»‹nh dáº¡ng Ä‘Æ°á»£c biÃªn dá»‹ch sang mÃ´i trÆ°á»ng sandbox vÃ  cháº¡y cÃ¹ng ráº¥t nhiá»u rÃ ng buá»™c Ä‘á»ƒ Ä‘áº£m báº£o nÃ³ khÃ´ng cÃ³ nhá»¯ng Ä‘iá»ƒm yáº¿u báº£o máº­t hoáº·c ráº¥t khÃ³ Ä‘á»ƒ chá»‘ng láº¡i. Tá»‘c Ä‘á»™ cháº­m lÃ  khÃ´ng Ä‘Ã¡ng ká»ƒ khi so vá»›i native code. HÆ¡n ná»¯a, nÃ³ sáº½ Ä‘Æ°á»£c cáº£i thiá»‡n cháº¡y nhanh hÆ¡n trong tÆ°Æ¡ng lai. NgoÃ i ra, kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch ráº¥t tá»‘t vá»›i trÃ¬nh duyá»‡t lÃ  Ä‘iá»ƒm máº¡nh, táº¥t cáº£ nhá»¯ng engine lá»›n Ä‘á»u cÃ³ há»— trá»£ WebAssembly vÃ  Ä‘á»u Ä‘Æ°a ra thá»i gian thá»±c thi tÆ°Æ¡ng Ä‘Æ°Æ¡ng nhau. Äá»ƒ hiá»ƒu WebAssembly thá»±c thi nhanh nhÆ° tháº¿ nÃ o so vá»›i Javascript, báº¡n nÃªn Ä‘á»c bÃ i trÆ°á»›c trong series Äá»¥c khoÃ©t Javascript CÃ¹ng xem Ä‘iá»u gÃ¬ xáº£y ra trong V8: CÃ¡ch tiáº¿p cáº­n cá»§a V8: biÃªn dá»‹ch cháº­m á» bÃªn trÃ¡i, chÃºng ta cÃ³ Javascript source, bao gá»“m cÃ¡c hÃ m. Äáº§u tiÃªn thÃ¬ nÃ³ cáº§n pháº£i Ä‘Æ°á»£c parse (phÃ¢n tÃ­ch cÃº phÃ¡p) Ä‘á»ƒ chuyá»ƒn táº¥t cáº£ string sang token vÃ  sinh ra Abstract Syntax Tree (AST - CÃ¢y cÃº phÃ¡p trá»«u tÆ°á»£ng, chÃºng ta sáº½ cÃ³ má»™t bÃ i viáº¿t vá» nÃ³ sau). CÃ¢y AST lÃ  Ä‘áº¡i diá»‡n biá»ƒu thá»‹ logic cá»§a chÆ°Æ¡ng trÃ¬nh JS trong bá»™ nhá»›. Má»™t khi nÃ³ Ä‘Æ°á»£c sinh ra, V8 sáº½ Ä‘i tháº³ng Ä‘áº¿n mÃ£ mÃ¡y. Vá» cÆ¡ báº£n thÃ¬ báº¡n sáº½ duyá»‡t qua cÃ¢y Ä‘Ã³, táº¡o ra mÃ£ mÃ¡y vÃ  hÃ m cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch. KhÃ´ng cÃ³ tiáº¿n trÃ¬nh nÃ o cá»‘ gáº¯ng tÄƒng tá»‘c nÃ³. Giá» thÃ¬ lÆ°á»›t qua xem V8 pipeline lÃ m gÃ¬ tiáº¿p theo: ChÃºng ta cÃ³ TurboFan, 1 trong nhá»¯ng trÃ¬nh biÃªn dá»‹ch tá»‘i Æ°u hÃ³a cá»§a V8. Trong khi app Javascript Ä‘ang cháº¡y thÃ¬ cÃ²n cÃ³ ráº¥t nhiá»u code khÃ¡c cháº¡y trong V8. TurboFan thá»±c hiá»‡n Ä‘iá»u hÃ nh, náº¿u cÃ³ gÃ¬ cháº¡y cháº­m báº¥t ká»ƒ lÃ  Ä‘ang ngháº½n cá»• chai (bottleneck) hay nhá»¯ng Ä‘iá»ƒm nÃ³ng (hot spots), thÃ¬ sáº½ Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a. NÃ³ Ä‘áº©y pháº§n code Ä‘ang ngá»‘n tÃ i nguyÃªn CPU Ä‘Ã³ qua má»™t bá»™ JIT tá»‘i Æ°u Ä‘á»ƒ táº¡o ra code nhanh hÆ¡n nhiá»u. NÃ³ giáº£i quyáº¿t váº¥n Ä‘á», nhÆ°ng bÃªn cáº¡nh Ä‘Ã³ quÃ¡ trÃ¬nh phÃ¢n tÃ­ch code vÃ  quyáº¿t Ä‘á»‹nh nÃªn tá»‘i Æ°u nhÆ° tháº¿ nÃ o cÅ©ng lÃ m tá»‘n tÃ i nguyÃªn CPU. Äiá»u nÃ y, lÃ m hao tá»•n thá»i lÆ°á»£ng pin nhiá»u hÆ¡n, Ä‘áº·c biá»‡t lÃ  trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng. ChÃ , wasm thÃ¬ khÃ´ng cáº§n. NÃ³ Ä‘i tháº³ng vÃ o quÃ¡ trÃ¬nh lÃ m viá»‡c nhÆ° dÆ°á»›i Ä‘Ã¢y: Wasm Ä‘Ã£ duyá»‡t qua quÃ¡ trÃ¬nh tá»‘i Æ°u hÃ³a ngay trong giai Ä‘oáº¡n biÃªn dá»‹ch. TrÃªn háº¿t thÃ¬ parsing Ä‘Ã£ khÃ´ng cÃ²n cáº§n thiáº¿t ná»¯a. Báº¡n cÃ³ mÃ£ nhá»‹ phÃ¢n tá»‘i Æ°u cÃ³ thá»ƒ gáº¯n trá»±c tiáº¿p vÃ o bá»™ pháº­n backend Ä‘á»ƒ sinh ra mÃ£ mÃ¡y. Táº¥t cáº£ cÃ¡c sá»± tá»‘i Æ°u hÃ³a Ä‘Ã£ Ä‘Æ°á»£c hoÃ n thÃ nh bá»Ÿi trÃ¬nh biÃªn dá»‹ch á»Ÿ frontend. Äiá»u nÃ y lÃ m cho quÃ¡ trÃ¬nh thá»±c thi wasm trá»Ÿ nÃªn hiá»‡u quáº£ hÆ¡n ráº¥t nhiá»u bá»Ÿi vÃ¬ ta cÃ³ thá»ƒ bá» qua 1 sá»‘ bÆ°á»›c trong khi xá»­ lÃ½. MÃ´ hÃ¬nh bá»™ nhá»› Bá»™ nhá»› cá»§a 1 chÆ°Æ¡ng trÃ¬nh C++ lÃ  chuá»—i liá»n ká» cÃ¡c block nhá»› khÃ´ng cÃ³ â€œlá»—â€. Má»™t trong sá»‘ cÃ¡c tÃ­nh nÄƒng cá»§a wasm giÃºp Ä‘áº©y máº¡nh sá»± báº£o máº­t lÃ  Ã½ tÆ°á»Ÿng vá» stack thá»±c thi Ä‘áº·t riÃªng biá»‡t vá»›i bá»™ nhá»› tháº³ng hÃ ng (linear). Trong C++ ta cÃ³ heap, cáº¥p phÃ¡t tá»« Ä‘Ã¡y cá»§a heap vÃ  phÃ¡t triá»ƒn stack á»Ÿ Ä‘á»‰nh heap. Ta cÃ³ thá»ƒ láº¥y con trá» vÃ  tÃ¬m kiáº¿m trong bá»™ nhá»› stack Ä‘á»ƒ chÆ¡i Ä‘Ã¹a vá»›i nhá»¯ng biáº¿n mÃ  chÃºng ta cÃ²n khÃ´ng Ä‘á»¥ng tá»›i. ÄÃ¢y lÃ  má»™t Ä‘iá»ƒm cáº¡m báº«y mÃ  ráº¥t nhiá»u malware khai thÃ¡c. WebAssembly sá»­ dá»¥ng má»™t mÃ´ hÃ¬nh hoÃ n toÃ n khÃ¡c. Stack thá»±c thi tÃ¡ch biá»‡t vá»›i chÆ°Æ¡ng trÃ¬nh chÃ­nh WebAssembly nÃªn khÃ´ng cÃ³ cÃ¡ch nÃ o báº¡n cÃ³ thá»ƒ chá»‰nh sá»­a vÃ  thay Ä‘á»•i nhá»¯ng biáº¿n bÃªn trong nÃ³. ThÃªm ná»¯a lÃ  cÃ¡c hÃ m cÃ³ offset lÃ  sá»‘ nguyÃªn chá»© ko dÃ¹ng contror. HÃ m trá» vÃ o má»™t báº£ng chá»©c nÄƒng vÃ´ hÆ°á»›ng. Sau Ä‘Ã³, cÃ¡c con sá»‘ Ä‘Æ°á»£c tÃ­nh toÃ¡n trá»±c tiáº¿p nÃ y Ä‘Æ°á»£c Ä‘Æ°a vÃ o bÃªn trong module. NÃ³ Ä‘Æ°á»£c xÃ¢y dá»±ng theo cÃ¡ch nÃ y Ä‘á»ƒ cÃ³ thá»ƒ load nhiá»u wasm cÃ¹ng láº§n, Ä‘Ã¡nh offset táº¥t cáº£ cÃ¡c index vÃ  nÃ³ sáº½ cháº¡y tá»‘t. Äá»ƒ tÃ¬m hiá»ƒu sÃ¢u hÆ¡n vá» mÃ´ hÃ¬nh bá»™ nhá»› vÃ  cÃ¡c cÃ¡ch quáº£n lÃ½ trong Javascript, báº¡n cÃ³ thá»ƒ xem láº¡i bÃ i trÆ°á»›c. Dá»n rÃ¡c (GC)ChÃºng ta Ä‘Ã£ biáº¿t quáº£n lÃ½ bá»™ nhá»› cá»§a Javascript cÃ³ bao gá»“m cáº£ xá»­ lÃ½ dá»n rÃ¡c Garbage Collector. Äá»‘i vá»›i WebAssembly thÃ¬ hÆ¡i khÃ¡c má»™t chÃºt. NÃ³ há»— trá»£ nhá»¯ng ngÃ´n ngá»¯ quáº£n lÃ½ bá»™ nhá»› thá»§ cÃ´ng. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng GC cá»§a chÃ­nh báº¡n vá»›i cÃ¡c wasm module, nhÆ°ng cÃ´ng viá»‡c Ä‘Ã³ hÆ¡i phá»©c táº¡p. Hiá»‡n táº¡i, WebAssembly Ä‘Æ°á»£c thiáº¿t káº¿ xoay quanh cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng cá»§a C++ vÃ  RUST. Bá»Ÿi vÃ¬ wasm lÃ  ngÃ´n ngá»¯ tháº¥p nÃªn sáº½ dá»… hiá»ƒu hÆ¡n náº¿u sá»­ dá»¥ng nhá»¯ng ngÃ´n ngá»¯ láº­p trÃ¬nh gáº§n gÅ©i &amp; dá»… biÃªn dá»‹ch ra ngÃ´n ngá»¯ assembly. C cÃ³ thá»ƒ sá»­ dá»¥ng malloc thÆ°á»ng, C++ cÃ³ thá»ƒ dÃ¹ng con trá» thÃ´ng minh. Rust dÃ¹ng má»™t mÃ´ hÃ¬nh khÃ¡c hoÃ n toÃ n (nhÆ°ng lÃ  1 chá»§ Ä‘á» khÃ¡c nhÃ©). Nhá»¯ng ngÃ´n ngá»¯ nÃ y khÃ´ng dÃ¹ng GC, do Ä‘Ã³ chÃºng khÃ´ng cáº§n cÃ¡c tÃ¡c vá»¥ runtime Ä‘á»ƒ theo dÃµi bá»™ nhá»›. WebAssembly phÃ¹ há»£p vá»›i chÃºng. ThÃªm ná»¯a, nhá»¯ng ngÃ´n ngá»¯ nÃ y khÃ´ng pháº£i Ä‘Æ°á»£c thiáº¿t káº¿ 100% cho viá»‡c truy váº¥n nhá»¯ng thá»© phá»©c táº¡p thuá»™c vá» Javascript, vÃ­ dá»¥ nhÆ° thay Ä‘á»•i DOM. NÃ³ khÃ¡ vÃ´ nghÄ©a khi pháº£i viáº¿t toÃ n bá»™ app HTML trÃªn ná»n C++ bá»Ÿi vÃ¬ C++ khÃ´ng Ä‘Æ°á»£c thiáº¿t káº¿ vá»›i má»¥c Ä‘Ã­ch lÃ m webapp. Äa sá»‘ cÃ¡c trÆ°á»ng há»£p cÃ¡c ká»¹ sÆ° dÃ¹ng C++ hoáº·c Rust, há» hÆ°á»›ng tá»›i WebGL hoáº·c nhá»¯ng thÆ° viá»‡n cÃ³ tÃ­nh tá»‘i Æ°u hÃ³a cao. (VÃ­ dá»¥: phÃ©p tÃ­nh toÃ¡n há»c khÃ³ vÃ  phá»©c táº¡p) Tuy nhiÃªn, trong tÆ°Æ¡ng lai WebAssembly sáº½ há»— trá»£ nhá»¯ng ngÃ´n ngá»¯ cÃ³ sáºµn GC. Truy xuáº¥t Platform APITÃ¹y thuá»™c vÃ o mÃ´i trÆ°á»ng runtime thá»±c thi Javascript, quyá»n truy xuáº¥t vÃ o nhá»¯ng API Ä‘ang tá»“n táº¡i Ä‘áº·c trÆ°ng cho platform cÃ³ thá»ƒ Ä‘Æ°á»£c truy cáº­p trá»±c tiáº¿p thÃ´ng qua app JS cá»§a báº¡n. VÃ­ dá»¥: báº¡n cháº¡y JS code trÃªn trÃ¬nh duyá»‡t, báº¡n cÃ³ 1 cá»¥c cÃ¡c Web API mÃ  webapp cÃ³ thá»ƒ gá»i vÃ  Ä‘iá»u khiá»ƒn trÃ¬nh duyá»‡t hoáº·c chá»©c nÄƒng thiáº¿t bá»‹ vÃ  cÃ³ quyá»n truy xuáº¥t vÃ o DOM, CSSOM, WebGL, IndexedDB, Web Audio API, vÃ¢n vÃ¢n. WebAssembly module khÃ´ng cÃ³ quyá»n truy cáº­p vÃ o platform API. Má»i thá»© Ä‘á»u trung gian qua Javascript. Náº¿u báº¡n muá»‘n truy xuáº¥t vÃ o má»™t sá»‘ API Ä‘áº·c trÆ°ng cho platform bÃªn trong module WebAssembly thÃ¬ báº¡n pháº£i gá»i nÃ³ thÃ´ng qua Javascript. VÃ­ dá»¥, náº¿u muá»‘n dÃ¹ng console.log, báº¡n gá»i nÃ³ thÃ´ng qua JS thay vÃ¬ C++. VÃ  dÄ© nhiÃªn lÃ  sáº½ cÃ³ nhá»¯ng háº¡n cháº¿ vá» JS mÃ  ta pháº£i cháº¥p nháº­n. NhÆ°ng trÆ°á»ng há»£p nÃ y sáº½ sá»›m Ä‘Æ°á»£c kháº¯c phá»¥c khi mÃ  Ä‘áº·c Ä‘iá»ƒm ká»¹ thuáº­t sáº½ cung cáº¥p cÃ¡c platform API cho wasm trong tÆ°Æ¡ng lai, báº¡n sáº½ cÃ³ thá»ƒ sá»›m phÃ¡t triá»ƒn app mÃ  khÃ´ng cáº§n Javascript. Ãnh xáº¡ mÃ£ nguá»“n (Source map)Khi báº¡n lÃ m tá»‘i giáº£n code JS, báº¡n cáº§n Ä‘áº£m báº£o cÃ³ thá»ƒ debug nÃ³. ÄÃ³ lÃ  khi mÃ  ta cáº§n Ä‘áº¿n Source Map. Vá» cÆ¡ báº£n, Source Map lÃ  1 cÃ¡ch Ä‘á»ƒ map má»™t file tá»‘i giáº£n vá» vá»›i tráº¡ng thÃ¡i ban Ä‘áº§u cá»§a nÃ³. Khi báº¡n build sáº£n pháº©m cho mÃ´i trÆ°á»ng production, cÃ¹ng vá»›i file JS Ä‘Ã£ káº¿t há»£p &amp; tá»‘i gian, báº¡n sáº½ sinh ra 1 file source map chá»©a thÃ´ng tin vá» file JS gá»‘c. Khi báº¡n query má»™t dÃ²ng cá»¥ thá»ƒ vá»›i sá»‘ cá»™t nÃ o Ä‘Ã³ file JS, báº¡n cÃ³ thá»ƒ tra cá»©u trong source map Ä‘á»ƒ tÃ¬m ra vá»‹ trÃ­ gá»‘c ban Ä‘áº§u cá»§a nÃ³. WebAssembly khÃ´ng há»— trá»£ source map vÃ¬ nÃ³ chÆ°a cÃ³ mÃ´ táº£ ká»¹ thuáº­t cho pháº§n nÃ y nhÆ°ng hi vá»ng lÃ  tÆ°Æ¡ng lai gáº§n sáº½ há»— trá»£. Khi báº¡n Ä‘áº·t breakpoint trong code C++, báº¡n sáº½ tháº¥y code C++ thay vÃ¬ WebAssembly, Ã­t nháº¥t lÃ  váº«n cÃ²n cÃ³ Ã­ch. Äa luá»“ng (Multithreading)Ai cÅ©ng biáº¿t Javascript lÃ  Ä‘Æ¡n luá»“ng. CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ cáº£i thiá»‡n Event Loop vÃ  nÃ¢ng cáº¥p pháº§n láº­p trÃ¬nh báº¥t Ä‘á»“ng bá»™ mÃ  chÃºng tÃ´i Ä‘Ã£ giá»›i thiá»‡u trong bÃ i trÆ°á»›c. Javascript cÃ³ thá»ƒ dÃ¹ng Web Workers nhÆ°ng nÃ³ ráº¥t háº¡n cháº¿ trÆ°á»ng há»£p. Vá» cÆ¡ báº£n, báº¥t ká»³ tÃ­nh toÃ¡n nÃ o áº£nh hÆ°á»Ÿng náº·ng Ä‘áº¿n CPU vÃ  block luá»“ng xá»­ UI Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº©y ra load riÃªng vá»›i WebWorker. Tuy nhiÃªn, WebWorker láº¡i khÃ´ng truy xuáº¥t Ä‘Æ°á»£c vÃ o DOM. WebAssembly hiá»‡n táº¡i khÃ´ng há»— trá»£ Ä‘a luá»“ng. Tuy nhiÃªn, Ä‘iá»u nÃ y cháº¯c cháº¯n sáº½ Ä‘Æ°á»£c thay Ä‘á»•i. Wasm Ä‘ang tiáº¿n gáº§n tá»›i nhá»¯ng tiáº¿n trÃ¬nh native (vÃ­ dá»¥: luá»“ng kiá»ƒu C++). CÃ³ nhá»¯ng luá»“ng â€œthá»±câ€ sáº½ táº¡o ra ráº¥t nhiá»u cÆ¡ há»™i má»›i trÃªn trÃ¬nh duyá»‡t. VÃ  láº½ dÄ© nhiÃªn, nÃ³ cÅ©ng sáº½ bá»‹ láº¡m dá»¥ng nhiá»u hÆ¡n. TÃ­nh di Ä‘á»™ng (Portability)NgÃ y nay Javascript cÃ³ thá»ƒ cháº¡y á»Ÿ báº¥t ká»³ Ä‘Ã¢u, tá»« trÃ¬nh duyá»‡t Ä‘áº¿n server, ká»ƒ cáº£ trong cÃ¡c há»‡ thá»‘ng nhÃºng. WebAssembly Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ an toÃ n vÃ  linh Ä‘á»™ng. NhÆ° Javascript, nÃ³ cháº¡y trÃªn nhiá»u mÃ´i trÆ°á»ng há»— trá»£ wasm (vÃ­ dá»¥: má»i trÃ¬nh duyá»‡t) WebAssembly cÃ³ cÃ¹ng má»¥c tiÃªu di Ä‘á»™ng nhÆ° cÃ¡ch mÃ  Java Ä‘ang cá»‘ thá»±c hiá»‡n trong nhá»¯ng ngÃ y Ä‘áº§u vá»›i Applets. Khi nÃ o thÃ¬ dÃ¹ng WebAssembly tá»‘t hÆ¡n JavaScript?Trong cÃ¡c phiÃªn báº£n Ä‘áº§u cá»§a WebAssembly, chá»©c nÄƒng chÃ­nh chá»‰ táº­p trung vÃ o cÃ¡c phÃ©p tÃ­nh náº·ng táº£i trÃªn CPU (cÃ¡c bÃ i toÃ¡n phá»©c táº¡p cháº³ng háº¡n). á»¨ng dá»¥ng chá»§ yáº¿u nháº¥t khi nghÄ© Ä‘áº¿n lÃ  games - cÃ³ cáº£ hÃ ng táº¥n pixel cáº§n thao tÃ¡c xá»­ lÃ½ trÃªn mÃ n hÃ¬nh. Báº¡n cÃ³ thá»ƒ viáº¿t app báº±ng ngÃ´n ngá»¯ mÃ  báº¡n quen thuá»™c nhÆ° C++/Rust báº±ng OpenGL sao Ä‘Ã³ biÃªn dá»‹ch sang wasm vÃ  nÃ³ sáº½ cháº¡y trÃªn trÃ¬nh duyá»‡t. Báº¡n cÃ³ thá»ƒ xem vÃ­ dá»¥ sau (tá»‘t nháº¥t lÃ  dÃ¹ng Firefox): http://s3.amazonaws.com/mozilla-games/tmp/2017-02-21-SunTemple/SunTemple.html. NÃ³ cháº¡y trÃªn ná»n Unreal engine. Má»™t trÆ°á»ng há»£p khÃ¡c tiÃªu biá»ƒu cho viÃªc sá»­ dá»¥ng WebAssembly (vá» máº·t hiá»‡u nÄƒng) lÃ  triá»ƒn khai má»™t sá»‘ thÆ° viá»‡n cháº¡y cÃ¡c tÃ¡c vá»¥ náº·ng vá»›i CPU, vÃ­ dá»¥ nhÆ° xá»­ lÃ½ áº£nh. NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÆ°á»›c, wasm cÃ³ thá»ƒ giáº£m khÃ¡ nhiá»u lÆ°á»£ng tiÃªu thá»¥ pin trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng (phá»¥ thuá»™c vÃ o engine), bá»Ÿi vÃ¬ Ä‘a sá»‘ cÃ¡c bÆ°á»›c xá»­ lÃ½ Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c hoÃ n thÃ nh trÆ°á»›c trong khi biÃªn dá»‹ch. Trong tÆ°Æ¡ng lai, báº¡n sáº½ cÃ³ thá»ƒ sá»­ dá»¥ng code WASM nhá»‹ phÃ¢n ká»ƒ cáº£ khi báº¡n khÃ´ng thá»±c sá»± viáº¿t code cÃ³ thá»ƒ biÃªn dá»‹ch ra nÃ³. Báº¡n cÃ³ thá»ƒ tÃ¬m vÃ i projects trÃªn NPM Ä‘ang báº¯t Ä‘áº§u triá»ƒn khai theo hÆ°á»›ng nÃ y. Vá»›i trÆ°á»ng há»£p thay Ä‘á»•i DOM vÃ  sá»­ dá»¥ng nhiá»u platform API thÃ¬ tá»‘t nháº¥t váº«n lÃ  dÃ¹ng Javascript, bá»Ÿi vÃ¬ rÃµ rÃ ng nÃ³ há»— trá»£ tá»‘t vá»›i cÃ¡c API Ä‘Ã³. á» SessionStack, tÃ¡c giáº£ liÃªn tá»¥c má»Ÿ rá»™ng biÃªn giá»›i hiá»‡u nÄƒng cá»§a Javascript nháº±m viáº¿t Ä‘Æ°á»£c nhiá»u code tá»‘i Æ°u vÃ  hiá»‡u quáº£ cao. Giáº£i phÃ¡p cá»§a há» cáº§n cung cáº¥p hiá»‡u nÄƒng nhanh chÃ³ng máº·t vÃ¬ khÃ´ng thá»ƒ gÃ¢y áº£nh hÆ°á»Ÿng lÃªn hiá»‡u nÄƒng cá»§a app cá»§a khÃ¡ch hÃ ng. Má»™t khi báº¡n Ä‘Ã£ tÃ­ch há»£p SessionStack vÃ o web app cá»§a báº¡n, nÃ³ sáº½ ghi láº¡i má»i thá»© diá»…n ra trÃªn app/website: nhá»¯ng thay Ä‘á»•i trÃªn DOM, tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng, JS exception, stack trace, nhá»¯ng request bá»‹ fail vÃ  cáº£ thÃ´ng bÃ¡o debug, cho phÃ©p báº¡n cháº¡y láº¡i (replay) nhá»¯ng issue Ä‘Ã£ xáº£y ra dÆ°á»›i dáº¡ng video vÃ  xem chÃºng diá»…n ra nhÆ° tháº¿ nÃ o vá»›i ngÆ°á»i dÃ¹ng. Táº¥t cáº£ Ä‘á»u hoáº¡t Ä‘á»™ng theo thá»i gian thá»±c (real-time) vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u nÄƒng cá»§a webapp. SessionStack pháº£i tá»‘i Æ°u hÃ³a code má»™t cÃ¡ch tá»‘i Ä‘a vÃ  lÃ m cho quÃ¡ trÃ¬nh nÃ y báº¥t Ä‘á»“ng bá»™ nháº¥t cÃ³ thá»ƒ. KhÃ´ng chá»‰ lÃ  má»™t thÆ° viá»‡n! Khi báº¡n cháº¡y láº¡i má»™t session cá»§a ngÆ°á»i dÃ¹ng trong SessionStack thÃ¬ nÃ³ pháº£i render láº¡i toÃ n bá»™ nhá»¯ng gÃ¬ mÃ  trÃ¬nh duyá»‡t cá»§a user thá»±c hiá»‡n táº¡i thá»i Ä‘iá»ƒm váº¥n Ä‘á» xáº£y ra vÃ  team tÃ¡c giáº£ pháº£i xÃ¢y dá»±ng láº¡i toÃ n bá»™ tráº¡ng thÃ¡i, cho phÃ©p báº¡n cÃ³ thá»ƒ nháº£y tá»›i nháº£y lui trong timeline session. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³, team tÃ¡c giáº£ Ä‘Ã£ táº­n dá»¥ng tá»‘i Ä‘a kháº£ nÄƒng báº¥t Ä‘á»“ng bá»™ mÃ  Javascript cung cáº¥p trong khi thiáº¿u sÃ³t nhá»¯ng giáº£i phÃ¡p tá»‘t hÆ¡n. Vá»›i WebAssembly, team tÃ¡c giáº£ cÃ³ thá»ƒ Ä‘áº©y nhá»¯ng tiáº¿n trÃ¬nh xá»­ lÃ½ vÃ  render náº·ng nháº¥t vÃ o má»™t ngÃ´n ngá»¯ phÃ¹ há»£p hÆ¡n vá»›i cÃ´ng viá»‡c nÃ y vÃ  Ä‘á»ƒ pháº§n thu tháº­p dá»¯ liá»‡u, thay Ä‘á»•i DOM cho Javascript lÃ m.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P5: Hiá»ƒu sÃ¢u vá» WebSocket & HTTP/2 vá»›i SSE","slug":"Cach-Javascript-hoat-dong-P5-Hieu-sau-ve-WebSocket-HTTP-2-voi-SSE","date":"2018-11-16T00:04:00.000Z","updated":"2018-11-16T00:16:38.066Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P5-Hieu-sau-ve-WebSocket-HTTP-2-voi-SSE.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P5-Hieu-sau-ve-WebSocket-HTTP-2-voi-SSE.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 5 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Trong pháº§n nÃ y chÃºng ta sáº½ Ä‘Ã o sÃ¢u vá»›i tháº¿ giá»›i cá»§a nhá»¯ng giao thá»©c giao tiáº¿p, Ã¡nh xáº¡ (mapping) vÃ  tháº£o luáº­n vá» nhá»¯ng thuá»™c tÃ­nh cÅ©ng nhÆ° thÃ nh pháº§n cá»§a chÃºng. ChÃºng ta sáº½ Ä‘Æ°a ra 1 so sÃ¡nh nhá» giá»¯a WebSockets vÃ  HTTP/s. Cuá»‘i cÃ¹ng, team SessionStack sáº½ chia sáº» má»™t vÃ i Ã½ tÆ°á»Ÿng vá» viá»‡c lá»±a chá»n phÆ°Æ¡ng thá»©c nÃ o cho phÃ¹ há»£p vá»›i giao thá»©c máº¡ng.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 5 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Trong pháº§n nÃ y chÃºng ta sáº½ Ä‘Ã o sÃ¢u vá»›i tháº¿ giá»›i cá»§a nhá»¯ng giao thá»©c giao tiáº¿p, Ã¡nh xáº¡ (mapping) vÃ  tháº£o luáº­n vá» nhá»¯ng thuá»™c tÃ­nh cÅ©ng nhÆ° thÃ nh pháº§n cá»§a chÃºng. ChÃºng ta sáº½ Ä‘Æ°a ra 1 so sÃ¡nh nhá» giá»¯a WebSockets vÃ  HTTP/s. Cuá»‘i cÃ¹ng, team SessionStack sáº½ chia sáº» má»™t vÃ i Ã½ tÆ°á»Ÿng vá» viá»‡c lá»±a chá»n phÆ°Æ¡ng thá»©c nÃ o cho phÃ¹ há»£p vá»›i giao thá»©c máº¡ng. Giá»›i thiá»‡uNgÃ y nay nhá»¯ng webapp phá»©c táº¡p cÃ³ nhiá»u tÃ­nh nÄƒng, UI Ä‘á»™ng xuáº¥t hiá»‡n nhÆ° trÄƒm hoa Ä‘ua ná»Ÿ. CÅ©ng khÃ´ng pháº£i báº¥t ngá», internet cÅ©ng Ä‘Ã£ phÃ¡t triá»ƒn Ä‘Æ°á»£c má»™t quÃ£ng Ä‘Æ°á»ng khÃ¡ dÃ i ká»ƒ tá»« khi báº¯t Ä‘áº§u. Ban Ä‘áº§u, internet khÃ´ng Ä‘Æ°á»£c xÃ¢y dá»±ng Ä‘á»ƒ dÃ nh cho nhá»¯ng app Ä‘á»™ng vÃ  phá»©c táº¡p. NÃ³ Ä‘Æ°á»£c hÃ¬nh thÃ nh nhÆ° lÃ  má»™t táº­p há»£p cá»§a cÃ¡c trang HTML, káº¿t ná»‘i vá»›i nhau Ä‘á»ƒ cáº¥u thÃ nh nÃªn khÃ¡i niá»‡m vá» â€œWebâ€ chá»©a thÃ´ng tin. Pháº§n lá»›n má»i thá»© Ä‘Æ°á»£c xÃ¢y dá»±ng xung quanh mÃ´ hÃ¬nh request/response ná»•i tiáº¿ng cá»§a HTTP. Má»™t client táº£i trang vÃ  khÃ´ng cÃ³ gÃ¬ xáº£y ra cho Ä‘áº¿n khi user báº¯t Ä‘áº§u click vÃ  di chuyá»ƒn Ä‘áº¿n trang tiáº¿p theo. Khoáº£ng nÄƒm 2005, AJAX Ä‘Æ°á»£c giá»›i thiá»‡u vÃ  ráº¥t nhiá»u ngÆ°á»i Ä‘Ã£ khÃ¡m phÃ¡ kháº£ nÄƒng táº¡o káº¿t ná»‘i giá»¯a client vÃ  server theo 2 chiá»u (bidirectional). VÃ  váº«n nhÆ° tháº¿, táº¥t cáº£ giao tiáº¿p HTTP Ä‘Æ°á»£c chá»‰ Ä‘áº¡o bá»Ÿi client yÃªu cáº§u user tÆ°Æ¡ng tÃ¡c hoáº·c thá»±c hiá»‡n theo chu ká»³ Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i tá»« server. Táº¡o má»™t HTTP â€œ2 chiá»uâ€CÃ´ng nghá»‡ cho phÃ©p server gá»­i dá»¯ liá»‡u vá» client má»™t cÃ¡ch â€œchá»§ Ä‘á»™ngâ€ Ä‘Ã£ phÃ¡t triá»ƒn Ä‘Æ°á»£c 1 thá»i gian. Push vÃ  Comet lÃ  vÃ­ dá»¥. Má»™t trong sá»‘ máº¹o ná»•i tiáº¿ng Ä‘á»ƒ táº¡o ra áº£o giÃ¡c ráº±ng server Ä‘ang gá»­i dá»¯ liá»‡u vá» client Ä‘Æ°á»£c gá»i lÃ  long polling. Vá»›i long polling, client má»Ÿ káº¿t ná»‘i HTTP Ä‘áº¿n server vÃ  giá»¯ nÃ³ tiáº¿p tá»¥c má»Ÿ cho Ä‘áº¿n khi cÃ³ response tráº£ vá». Má»—i khi server cÃ³ dá»¯ liá»‡u má»›i cáº§n Ä‘Æ°á»£c gá»­i, nÃ³ chuyá»ƒn giao thÃ´ng tin dÆ°á»›i dáº¡ng má»™t response. CÃ¹ng xem má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» long polling: 123456789101112131415(function poll()&#123; setTimeout(function()&#123; $.ajax(&#123; url: 'https://api.example.com/endpoint', success: function(data) &#123; // LÃ m gÃ¬ Ä‘Ã³ vá»›i `data` // ... // CÃ i Ä‘áº·t poll má»›i theo Ä‘á»‡ quy poll(); &#125;, dataType: 'json' &#125;); &#125;, 10000);&#125;)(); ÄÃ¢y lÃ  má»™t hÃ m tá»± thá»±c thi cÆ¡ báº£n cháº¡y má»™t cÃ¡ch tá»± Ä‘á»™ng láº§n Ä‘áº§u tiÃªn. NÃ³ sáº½ cÃ i Ä‘áº·t má»™t khoáº£ng thá»i gian 10 giÃ¢y vÃ  sau má»—i lá»i gá»i Ajax báº¥t Ä‘á»“ng bá»™ Ä‘áº¿n server, callback láº¡i gá»i ajax láº§n ná»¯a. VÃ i ká»¹ thuáº­t khÃ¡c cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n nhÆ° Flash, request nhiá»u thÃ nh pháº§n XHR vÃ  htmlfiles ná»•i tiáº¿ng. Táº¥t cáº£ nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y Ä‘á»u cÃ³ chung má»™t váº¥n Ä‘á»: ChÃºng qua máº·t HTTP, lÃ m cho chÃºng khÃ´ng phÃ¹ há»£p vá»›i nhá»¯ng app cÃ³ Ä‘á»™ trá»… tháº¥p. Giáº£ sá»­ nhÆ° game báº¯n sÃºng nhiá»u ngÆ°á»i chÆ¡i trÃªn trÃ¬nh duyá»‡t hoáº·c báº¥t ká»³ game onlinen nÃ o cÃ³ Ä‘á»‘i thá»§ thá»±c. Giá»›i thiá»‡u WebSocketsThÃ´ng sá»‘ ká»¹ thuáº­t cá»§a WebSocket Ä‘á»‹nh nghÄ©a má»™t káº¿t ná»‘i API dáº¡ng â€œsocketâ€ (á»• cáº¯m Ä‘iá»‡n!) giá»¯a trÃ¬nh duyá»‡t vÃ  server. Theo nghÄ©a Ä‘en thÃ¬ cÃ³ 1 káº¿t ná»‘i cá»‘ Ä‘á»‹nh giá»¯a client vÃ  server vÃ  cáº£ 2 bÃªn cÃ³ thá»ƒ gá»­i dá»¯ liá»‡u báº¥t ká»³ lÃºc nÃ o. Client thiáº¿t láº­p má»™t káº¿t ná»‘i WebSocket thÃ´ng qua má»™t tiáº¿n trÃ¬nh Ä‘Æ°á»£c gá»i lÃ  WebSocket handshake (báº¯t tay WebSocket). Tiáº¿n trÃ¬nh nÃ y báº¯t Ä‘áº§u vá»›i client gá»­i má»™t request HTTP thÃ´ng thÆ°á»ng Ä‘áº¿n server. NÃ³ kÃ¨m theo header Upgrade Ä‘á»ƒ thÃ´ng bÃ¡o cho server ráº±ng client muá»‘n táº¡o má»™t káº¿t ná»‘i WebSocket. CÃ¹ng xem thá»­ quÃ¡ trÃ¬nh má»Ÿ káº¿t ná»‘i WebSocket nhÆ° tháº¿ nÃ o á»Ÿ phÃ­a client: 12// Create a new WebSocket with an encrypted connection.var socket = new WebSocket('ws://websocket.example.com'); WebSocket URL sá»­ dá»¥ng ws scheme. ChÃºng ta cÃ²n cÃ³ cáº£ wss cho nhá»¯ng káº¿t ná»‘i WebSocket báº£o máº­t hÆ¡n, tÆ°Æ¡ng tá»± nhÆ° HTTPS. Scheme nÃ y báº¯t Ä‘áº§u má»™t tiáº¿n trÃ¬nh má»Ÿ káº¿t ná»‘i WebSocket Ä‘áº¿n websocket.example.com. DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ Ä‘Æ¡n giáº£n cá»§a header cá»§a request khá»Ÿi táº¡o. 12345GET ws://websocket.example.com/ HTTP/1.1Origin: http://example.comConnection: UpgradeHost: websocket.example.comUpgrade: websocket Náº¿u server há»— trá»£ giao thá»©c WebSocket, nÃ³ sáº½ Ä‘á»“ng Ã½ Ä‘á»ƒ nÃ¢ng cáº¥p vÃ  giao tiáº¿p thÃ´ng qua header Upgrade trong response. CÃ¹ng xem pháº§n thiáº¿t láº­p cá»§a nÃ³ trong Node.js nhÆ° tháº¿ nÃ o: 1234567891011121314151617181920212223242526272829// ChÃºng ta sáº½ dÃ¹ng https://github.com/theturtle32/WebSocket-Node// Triá»ƒn khai WebSocketvar WebSocketServer = require('websocket').server;var http = require('http');var server = http.createServer(function(request, response) &#123; // xá»­ lÃ½ HTTP request. &#125;);server.listen(1337, function() &#123; &#125;);// táº¡o serverwsServer = new WebSocketServer(&#123; httpServer: server&#125;);// WebSocket serverwsServer.on('request', function(request) &#123; var connection = request.accept(null, request.origin); // ÄÃ¢y lÃ  callback quan trá»ng nháº¥t,chÃºng ta sáº½ // xá»­ lÃ½ thÃ´ng tin cá»§a client á»Ÿ Ä‘Ã¢y. connection.on('message', function(message) &#123; // Xá»­ lÃ½ thÃ´ng tin WebSocket &#125;); connection.on('close', function(connection) &#123; // ÄÃ³ng káº¿t ná»‘i &#125;);&#125;); Sau khi thÃ nh láº­p káº¿t ná»‘i, server tráº£ vá»: 1234HTTP/1.1 101 Switching ProtocolsDate: Wed, 25 Oct 2017 10:07:34 GMTConnection: UpgradeUpgrade: WebSocket Khi káº¿t ná»‘i Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p, sá»± kiá»‡n open sáº½ Ä‘Æ°á»£c báº¯n ra cho instance WebSocket á»Ÿ phÃ­a client: 123456var socket = new WebSocket('ws://websocket.example.com');// Hiá»‡n thÃ´ng bÃ¡o khi káº¿t ná»‘i WebSocket thÃ nh cÃ´ng.socket.onopen = function(event) &#123; console.log('WebSocket is connected.');&#125;; Giá» thÃ¬ quÃ¡ trÃ¬nh â€œbáº¯t tayâ€ Ä‘Ã£ hoÃ n táº¥t, káº¿t ná»‘i khá»Ÿi táº¡o HTTP Ä‘Æ°á»£c thay tháº¿ báº±ng WebSocket vÃ  sá»­ dá»¥ng cÃ¹ng loáº¡i ná»n táº£ng káº¿t ná»‘i TCP/IP. Táº¡i thá»i Ä‘iá»ƒm nÃ y, cáº£ 2 bÃªn Ä‘á»u cÃ³ thá»ƒ gá»­i dá»¯ liá»‡u. Vá»›i WebSocket, báº¡n cÃ³ thá»ƒ truyá»n bao nhiÃªu thÃ´ng tin tÃ¹y thÃ­ch mÃ  khÃ´ng cáº§n pháº£i gÃ¡nh chá»‹u nhá»¯ng chi phÃ­ khÃ´ng Ä‘Ã¡ng cÃ³ liÃªn quan Ä‘áº¿n request HTTP truyá»n thá»‘ng. Dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n Ä‘i thÃ´ng qua WebSocket dÆ°á»›i dáº¡ng tin nháº¯n (message), má»—i tin nháº¯n bao gá»“m má»™t hoáº·c nhiá»u frame chá»©a dá»¯ liá»‡u báº¡n gá»­i Ä‘i (gá»i lÃ  kiá»‡n hÃ ng - payload). Äá»ƒ Ä‘áº£m báº£o message cÃ³ thá»ƒ tÃ¡i cáº¥u trÃºc má»™t cÃ¡ch chÃ­nh xÃ¡c khi nÃ³ Ä‘áº¿n vá»›i client, má»—i frame Ä‘Æ°á»£c gÃ¡n cá»©ng tá»« 4-12 byte thÃ´ng tin vá» payload. Sá»­ dá»¥ng há»‡ thá»‘ng thÃ´ng tin dá»±a trÃªn frame nhÆ° tháº¿ nÃ y giÃºp giáº£m táº£i khá»‘i lÆ°á»£ng dá»¯ liá»‡u dÆ° thá»«a (non-payload data) pháº£i truyá»n Ä‘i, cÃ³ thá»ƒ lÃ m cho Ä‘á»™ trá»… giáº£m Ä‘i Ä‘Ã¡ng ká»ƒ. LÆ°u Ã½: Äáº·c biá»‡t chÃº Ã½ lÃ  client chá»‰ Ä‘Æ°á»£c thÃ´ng bÃ¡o vá» message má»›i má»™t khi táº¥t cáº£ frame Ä‘á»u Ä‘Æ°á»£c nháº­n vÃ  payload message gá»‘c Ä‘Æ°á»£c tÃ¡i cáº¥u trÃºc Ä‘áº§y Ä‘á»§ WebSocket URLsChÃºng ta cÃ³ Ä‘á» cáº­p sÆ¡ qua vá» WebSocket URL scheme á»Ÿ trÃªn. Trong thá»±c tháº¿, chÃºng giá»›i thiá»‡u cÃ³ 2 scheme má»›i lÃ  ws:// vÃ  wss:// URL cÃ³ cáº¥u trÃºc ngá»¯ phÃ¡p cá»¥ thá»ƒ vá» scheme. WebSocket URL Ä‘áº·c biá»‡t vÃ¬ nÃ³ khÃ´ng há»— trá»£ nhÃ³m kÃ½ tá»± anchor (cÃ³ dáº¥u thÄƒng á»Ÿ trÆ°á»›c, vÃ­ dá»¥: #Ä‘Ã¢y_lÃ _anchor). CÃ³ nhá»¯ng luáº­t chung Ä‘Æ°á»£c Ã¡p dá»¥ng cho cáº£ style cá»§a WebSocket URL vÃ  HTTP URL. ws khÃ´ng Ä‘Æ°á»£c mÃ£ hÃ³a, nÃ³ cÃ³ cá»•ng máº·c Ä‘á»‹nh lÃ  80 trong khi Ä‘Ã³ wss yÃªu cáº§u mÃ£ hÃ³a TLS vÃ  dÃ¹ng cá»•ng 443 máº·c Ä‘á»‹nh. Framing protocol (Giao thá»©c framing)CÃ¹ng Ä‘Ã o sÃ¢u má»™t chÃºt vá» framing protocol vá»›i nhá»¯ng gÃ¬ RFC cung cáº¥p: 1234567891011121314151617180 1 2 30 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1+-+-+-+-+-------+-+-------------+-------------------------------+|F|R|R|R| opcode|M| Payload len | Extended payload length ||I|S|S|S| (4) |A| (7) | (16/64) ||N|V|V|V| |S| | (if payload len==126/127) || |1|2|3| |K| | |+-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +| Extended payload length continued, if payload len == 127 |+ - - - - - - - - - - - - - - - +-------------------------------+| |Masking-key, if MASK set to 1 |+-------------------------------+-------------------------------+| Masking-key (continued) | Payload Data |+-------------------------------- - - - - - - - - - - - - - - - +: Payload Data continued ... :+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +| Payload Data continued ... |+---------------------------------------------------------------+ Theo nhÆ° RFC Ä‘á»‹nh nghÄ© vá» WebSocket thÃ¬ nÃ³ chá»‰ cÃ³ duy nháº¥t má»™t header trÆ°á»›c má»—i gÃ³i tin, vÃ  nÃ³ khÃ¡ phá»©c táº¡p. ChÃºng ta cÃ¹ng tÃ¬m hiá»ƒu: fin (1 bit): biá»ƒu thá»‹ náº¿u frame Ä‘Ã³ lÃ  frame cuá»‘i cÃ¹ng táº¡o nÃªn message. Háº§u háº¿t message Ä‘á»u cÃ³ thá»ƒ chá»©a trong má»™t frame duy nháº¥t vÃ  bit nÃ y luÃ´n cÃ³ giÃ¡ trá»‹. Thá»±c nghiá»‡m cho tháº¥y Firefox táº¡o 1 frame thá»© 2 sau má»—i 32K. rsv1, rsv2, rsv3 (Má»—i thá»© 1 bit): pháº£i báº±ng 0 trá»« khi cÃ³ má»™t extension (Ä‘áº¡i khÃ¡i nhÆ° tiá»‡n Ã­ch má»Ÿ rá»™ng) Ä‘Æ°á»£c trao Ä‘á»•i vÃ  nÃ³ Ä‘á»‹nh nghÄ©a Ã½ nghÄ©a cho giÃ¡ trá»‹ khÃ¡c 0. Náº¿u nháº­n vá» má»™t giÃ¡ trá»‹ khÃ¡c 0 vÃ  khÃ´ng cÃ³ extension nÃ o xÃ¡c Ä‘á»‹nh Ã½ nghÄ©a cá»§a giÃ¡ trá»‹ khÃ¡c 0 Ä‘Ã³ Ä‘Æ°á»£c trao Ä‘á»•i thÃ¬ ngÆ°á»i nháº­n cuá»‘i sáº½ bá»‹ máº¥t káº¿t ná»‘i. opcode (4 bit): nÃ³ cho biáº¿t nhá»¯ng gÃ¬ frame Ä‘áº¡i diá»‡n. CÃ³ nhá»¯ng giÃ¡ trá»‹ sau Ä‘Ã¢y Ä‘Æ°á»£c dÃ¹ng: 0x00: frame nÃ y tiáº¿p tá»¥c payload tá»« frame trÆ°á»›c Ä‘Ã³. 0x01: frame nÃ y chá»©a dá»¯ liá»‡u chá»¯ (text). 0x02: frame nÃ y chá»©a dá»¯ liá»‡u nhá»‹ phÃ¢n (binary). 0x08: frame nÃ y há»§y káº¿t ná»‘i. 0x09: frame nÃ y lÃ  ping. 0x0a: frame nÃ y lÃ  pong. (Báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng cÃ³ nhiá»u giÃ¡ trá»‹ khÃ´ng sá»­ dá»¥ng, chÃºng Ä‘Æ°á»£c dá»± trá»¯ cho tÆ°Æ¡ng lai khi cáº§n) mask (1 bit): biá»ƒu thá»‹ náº¿u káº¿t ná»‘i Ä‘Ã£ Ä‘Æ°á»£c che Ä‘áº­y (mask). RÃµ rÃ ng lÃ  má»—i message tá»« client Ä‘áº¿n server pháº£i Ä‘Æ°á»£c che Ä‘áº­y vÃ  vá» máº·t ká»¹ thuáº­t thÃ¬ nÃ³ sáº½ há»§y káº¿t ná»‘i náº¿u khÃ´ng Ä‘Æ°á»£c che Ä‘áº­y. payload_len (7 bit): Ä‘á»™ dÃ i cá»§a payload. WebSocket frame cÃ³ nhá»¯ng Ä‘á»™ dÃ i theo cÃ¡c khoáº£ng tÃ­nh theo byte nhÆ° sau: 0-125 biá»ƒu thá»‹ Ä‘á»™ dÃ i cá»§a payload Náº¿u lÃ  126 byte thÃ¬ 2 byte tiáº¿p theo biá»ƒu thá»‹ Ä‘á»™ dÃ i payload dÆ°á»›i dáº¡ng sá»‘ nguyÃªn 16bit khÃ´ng dáº¥u Náº¿u lÃ  127 byte thÃ¬ 8 byte tiáº¿p theo biá»ƒu thá»‹ Ä‘á»™ dÃ i payload dÆ°á»›i dáº¡ng sá»‘ nguyÃªn 64bit khÃ´ng dáº¥u Váº­y lÃ  Ä‘á»™ dÃ i payload sáº½ vÃ o khoáº£ng ~7bit, 16bit hoáº·c 64bit. masking-key (32 bit): táº¥t cáº£ frame Ä‘Æ°á»£c gá»­i tá»« client Ä‘áº¿n server sáº½ Ä‘Æ°á»£c che Ä‘áº­y (mask) báº±ng má»™t giÃ¡ trá»‹ 32bit Ä‘Ã­nh kÃ¨m trong frame. payload: Dá»¯ liá»‡u tháº­t sá»± cáº§n Ä‘Æ°á»£c che Ä‘áº­y. Äá»™ dÃ i cá»§a nÃ³ chÃ­nh lÃ  payload_len Táº¡i sao WebSocket láº¡i dá»±a trÃªn frame (frame-based) mÃ  khÃ´ng dá»±a trÃªn dÃ²ng cháº£y (stream-based)? CÃ³ trá»i má»›i biáº¿t, tÃ¡c giáº£ cÅ©ng khÃ´ng biáº¿t vÃ¬ sao nÃªn náº¿u báº¡n cÃ³ thÃ´ng tin gÃ¬ vá» Ä‘iá»u nÃ y thÃ¬ cÃ³ thá»ƒ nháº¯n tin Ä‘áº¿n tÃ¡c giáº£. NgoÃ i ra thÃ¬ cÃ³ má»™t topic tháº£o luáº­n ráº¥t tá»‘t vá» váº¥n Ä‘á» nÃ y trÃªn HackerNews, báº¡n cÃ³ thá»ƒ tham kháº£o. Dá»¯ liá»‡u trÃªn frameNhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, dá»¯ liá»‡u cÃ³ thá»ƒ phÃ¢n máº£nh thÃ nh nhiá»u frame. Frame Ä‘áº§u tiÃªn chuyá»ƒn giao dá»¯ liá»‡u cÃ³ má»™t opcode biá»ƒu thá»‹ kiá»ƒu dá»¯ liá»‡u Ä‘ang Ä‘Æ°á»£c truyá»n. Äiá»u nÃ y cáº§n thiáº¿t bá»Ÿi vÃ¬ Javascript háº§u nhÆ° khÃ´ng cÃ³ há»— trá»£ cho kiá»ƒu dá»¯ liá»‡u nhá»‹ phÃ¢n (binary) khi nÃ³ Ä‘Æ°á»£c xÃ¢y dá»±ng. 0x01 biá»ƒu thá»‹ kiá»ƒu encode vÄƒn báº£n UTF-8, 0x02 lÃ  dá»¯ liá»‡u nhá»‹ phÃ¢n. Äa sá»‘ má»i ngÆ°á»i sáº½ chuyá»ƒn giao JSON trong trÆ°á»ng há»£p báº¡n muá»‘n chá»n opcode vÄƒn báº£n. Khi báº¡n phÃ¡t tÃ­n hiá»‡u (emit) dá»¯ liá»‡u nhá»‹ phÃ¢n nÃ³ sáº½ Ä‘Æ°á»£c thá»ƒ hiá»‡n trÃªn trÃ¬nh duyá»‡t dÆ°á»›i dáº¡ng cá»¥ thá»ƒ lÃ  Blob. API Ä‘á»ƒ gá»­i dá»¯ liá»‡u thÃ´ng qua WebSocket khÃ¡ Ä‘Æ¡n giáº£n: 1234var socket = new WebSocket('ws://websocket.example.com');socket.onopen = function(event) &#123; socket.send('Some message'); // Gá»­i dá»¯ liá»‡u Ä‘áº¿n server.&#125;; Khi WebSocket nháº­n dá»¯ liá»‡u (á»Ÿ phÃ­a client), má»™t sá»± kiá»‡n message Ä‘Æ°á»£c báº¯n ra. Sá»± kiá»‡n nÃ y bao gá»“m má»™t thuá»™c tÃ­nh gá»i lÃ  data cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ truy cáº­p ná»™i dung cá»§a message. 12345// Xá»­ lÃ½ message gá»­i Ä‘i tá»« server.socket.onmessage = function(event) &#123; var message = event.data; console.log(message);&#125;; Báº¡n cÃ³ thá»ƒ khÃ¡m phÃ¡ dá»¯ liá»‡u má»™t cÃ¡ch dá»… dÃ ng trong má»—i frame trong káº¿t ná»‘i WebSocket sá»­ dá»¥ng tab Network trong Chrome DevTools: Sá»± phÃ¢n máº£nhDá»¯ liá»‡u payload cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh nhiá»u frame riÃªng. NÆ¡i nháº­n cÃ³ nhiá»‡m vá»¥ lÆ°u Ä‘á»‡m chÃºng cho Ä‘áº¿n khi bit fin Ä‘Æ°á»£c set. Tháº¿ nÃªn báº¡n cÃ³ thá»ƒ chuyá»ƒn 1 chuá»—i â€œHello Worldâ€ trong 11 gÃ³i tin cá»§a 6 (Ä‘á»™ dÃ i header) + 1 byte cho má»—i gÃ³i. Sá»± phÃ¢n máº£nh khÃ´ng Ä‘Æ°á»£c cháº¥p nháº­n cho gÃ³i tin Ä‘iá»u khiá»ƒn (control packages). Tuy nhiÃªn, Ä‘áº·c Ä‘iá»ƒm ká»¹ thuáº­t muá»‘n báº¡n cÃ³ thá»ƒ xá»­ lÃ½ nhá»¯ng frame Ä‘iá»u khiá»ƒn xen káº½ nhau. ÄÃ³ lÃ  trÆ°á»ng há»£p gÃ³i tin TCP nháº­n Ä‘Æ°á»£c cÃ³ thá»© tá»± lá»™n xá»™n. Logic Ä‘á»ƒ káº¿t ná»‘i frame Ä‘Æ°á»£c mÃ´ táº£ sÆ¡ lÆ°á»£c nhÆ° sau: Nháº­n frame Ä‘áº§u tiÃªn Ghi nhá»› opcode Ná»‘i cÃ¡c frame payload láº¡i vá»›i nhau cho Ä‘áº¿n khi bit fin Ä‘Æ°á»£c set. Giáº£ Ä‘á»‹nh ráº±ng opcode cho má»—i gÃ³i tin lÃ  0 Má»¥c Ä‘Ã­ch chÃ­nh cá»§a sá»± phÃ¢n máº£nh lÃ  cho phÃ©p gá»­i message khi khÃ´ng biáº¿t rÃµ kÃ­ch thÆ°á»›c ban Ä‘áº§u cá»§a message. Vá»›i sá»± phÃ¢n máº£nh, server cÃ³ thá»ƒ chá»n má»™t kÃ­ch thÆ°á»›c buffer (bá»™ Ä‘á»‡m) phÃ¹ há»£p vÃ  khi buffer Ä‘áº§y thÃ¬ ghi máº£nh (fragment) Ä‘Ã³ vÃ o network. TrÆ°á»ng há»£p sá»­ dá»¥ng phá»¥ cá»§a sá»± phÃ¢n máº£nh lÃ  truyá»n tin Ä‘a luá»“ng (multiplexing), vá»‘n dÄ© khÃ´ng cáº§n má»™t message lá»›n trÃªn má»™t kÃªnh logic Ä‘á»ƒ tiáº¿p nháº­n toÃ n bá»™ kÃªnh Ä‘áº§u ra, vÃ¬ tháº¿ multiplexing cáº§n pháº£i giáº£i phÃ³ng Ä‘á»ƒ cáº¯t message ra thÃ nh nhiá»u máº£nh Ä‘á»ƒ cÃ³ thá»ƒ chia sáº» Ä‘áº¿n kÃªnh Ä‘áº§u ra tá»‘t hÆ¡n. Heartbeating (nhá»‹p tim) lÃ  gÃ¬ ?Táº¡i má»™t thá»i Ä‘iá»ƒm sau khi â€œbáº¯t tayâ€ (handshake), cáº£ client vÃ  server cÃ³ thá»ƒ lá»±a chá»n Ä‘á»ƒ gá»­i Ä‘i má»™t ping Ä‘áº¿n phÃ­a kia. Khi ping Ä‘Æ°á»£c nháº­n, ngÆ°á»i nháº­n pháº£i gá»­i ngÆ°á»£c láº¡i má»™t pong ngay khi cÃ³ thá»ƒ. ÄÃ³ gá»i lÃ  heartbeat (nhá»‹p tim Ä‘áº­p). Báº¡n cÃ³ thá»ƒ dÃ¹ng nÃ³ Ä‘á»ƒ Ä‘áº£m báº£o client váº«n Ä‘ang Ä‘Æ°á»£c káº¿t ná»‘i. Má»™t ping hay pong chá»‰ lÃ  frame bÃ¬nh thÆ°á»ng, khÃ´ng pháº£i frame Ä‘iá»u khiá»ƒn. Ping cÃ³ opcode lÃ  0x9 vÃ  opcode cá»§a pong lÃ  0xA. Khi báº¡n nháº­n Ä‘Æ°á»£c ping, gá»­i ngÆ°á»£c láº¡i pong vá»›i chÃ­nh xÃ¡c cÃ¹ng dá»¯ liá»‡u Payload nhÆ° ping (vá»›i ping vÃ  pong thÃ¬ Ä‘á»™ dÃ i payload tá»‘i Ä‘a lÃ  125). Báº¡n cÅ©ng cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c pong mÃ  chÆ°a tá»«ng gá»­i ping. Náº¿u nÃ³ xáº£y ra thÃ¬ bá» qua, quÃªn nÃ³ Ä‘i. Heartbeat cÃ³ thá»ƒ ráº¥t cÃ³ Ã­ch. CÃ³ nhiá»u dá»‹ch vá»¥ (cháº³ng háº¡n nhÆ° bá»™ cÃ¢n báº±ng táº£i - load balancer) sáº½ há»§y nhá»¯ng káº¿t ná»‘i Ä‘á»©ng yÃªn (idle). ThÃªm ná»¯a, bÃªn nháº­n khÃ´ng thá»ƒ biáº¿t náº¿u bÃªn kia (bÃªn gá»­i) Ä‘Ã£ bá»‹ káº¿t thÃºc hay chÆ°a. Chá»‰ cÃ³ Ä‘áº¿n láº§n gá»­i thÃ´ng tin tiáº¿p theo ta má»›i nháº­n ra cÃ³ gÃ¬ Ä‘Ã³ khÃ´ng á»•n. Xá»­ lÃ½ lá»—iBáº¡n cÃ³ thá»ƒ xá»­ lÃ½ bao nhiÃªu lá»—i xáº£y ra cÅ©ng Ä‘Æ°á»£c báº±ng cÃ¡ch listen Ä‘áº¿n sá»± kiá»‡n error.VÃ­ dá»¥: 123456var socket = new WebSocket('ws://websocket.example.com');// Xá»­ lÃ½ lá»—i xáº£y ra.socket.onerror = function(error) &#123; console.log('WebSocket Error: ' + error);&#125;; ÄÃ³ng káº¿t ná»‘iÄá»ƒ Ä‘Ã³ng káº¿t ná»•i thÃ¬ client hoáº·c server pháº£i gá»­i má»™t frame Ä‘iá»u khiá»ƒn vá»›i dá»¯ liá»‡u chá»©a opcode 0x8. Ngay khi nháº­n Ä‘Æ°á»£c frame Ä‘Ã³ thÃ¬ bÃªn nháº­n sáº½ gá»­i tráº£ má»™t frame Ä‘Ã³ng (close). BÃªn gá»­i sáº½ Ä‘Ã³ng káº¿t ná»‘i. Báº¥t ká»³ thÃ´ng tin nÃ o nháº­n Ä‘Æ°á»£c sau khi Ä‘Ã³ng káº¿t ná»‘i Ä‘á»u bá»‹ vá»©t bá». ÄÃ¢y lÃ  cÃ¡ch báº¡n khá»Ÿi táº¡o quÃ¡ trÃ¬nh Ä‘Ã³ng káº¿t ná»‘i WebSocket tá»« client: 1234// ÄÃ³ng náº¿u káº¿t ná»‘i Ä‘ang Ä‘Æ°á»£c má»Ÿ.if (socket.readyState === WebSocket.OPEN) &#123; socket.close();&#125; Äá»ƒ thá»±c hiá»‡n dá»n dáº¹p sau khi Ä‘Ã³ng káº¿t ná»‘i thÃ nh cÃ´ng, báº¡n cÃ³ thá»ƒ thÃªm má»™t event listener vÃ o sá»± kiá»‡n close: 1234// Dá»n dáº¹p nhá»¯ng thá»© cáº§n thiáº¿t.socket.onclose = function(event) &#123; console.log('Disconnected from WebSocket.');&#125;; Server láº¯ng nghe sá»± kiá»‡n close Ä‘á»ƒ xá»­ lÃ½ náº¿u cáº§n: 123connection.on('close', function(reasonCode, description) &#123; // Káº¿t ná»‘i Ä‘ang bá»‹ Ä‘Ã³ng.&#125;); So sÃ¡nh WebSockets vÃ  HTTP/2Trong khi HTTP/2 cung cáº¥p nhiá»u thá»©, nÃ³ láº¡i khÃ´ng hoÃ n toÃ n thay tháº¿ sá»± cáº§n thiáº¿t cho cÃ¡c cÃ´ng nghá»‡ push/streaming hiá»‡n cÃ³. Äiá»u quan trá»ng Ä‘áº§u tiÃªn vá» HTTP/2 mÃ  ta cáº§n chÃº Ã½ lÃ  nÃ³ khÃ´ng pháº£i lÃ  má»™t thay tháº¿ cho táº¥t cáº£ HTTP. Nhá»¯ng Ä‘á»™ng tá»«, mÃ£ status vÃ  Ä‘a sá»‘ cÃ¡c loáº¡i header sáº½ váº«n nhÆ° cÅ©. HTTP/2 hÆ°á»›ng Ä‘áº¿n cáº£i thiá»‡n sá»± hiá»‡u quáº£ trong cÃ¡ch mÃ  dá»¯ liá»‡u truyá»n trÃªn Ä‘Æ°á»ng dÃ¢y. Giá» náº¿u so sÃ¡nh HTTP/2 vá»›i WebSocket thÃ¬ ta cÃ³ nhiá»u thá»© tÆ°Æ¡ng Ä‘á»“ng: HTTP/2 WebSocket Headers ÄÆ°á»£c nÃ©n (HPACK) KhÃ´ng nÃ©n Binary CÃ³ Nhá»‹ PhÃ¢n hoáº·c VÄƒn Báº£n Multiplexing CÃ³ CÃ³ Sá»± Æ°u tiÃªn CÃ³ KhÃ´ng NÃ©n CÃ³ CÃ³ Äinh hÆ°á»›ng Client/Server hoáº·c lÃ  Server Push 2 chiá»u Full-duplex CÃ³ CÃ³ NhÆ° Ä‘Ã£ tháº¥y á»Ÿ trÃªn, HTTP/2 giá»›i thiá»‡u tÃ­nh nÄƒng Server Push Ä‘á»ƒ cho phÃ©p server gá»­i tÃ i nguyÃªn má»™t cÃ¡ch chá»§ Ä‘á»™ng Ä‘áº¿n bá»™ Ä‘á»‡m phÃ­a client. Tuy nhiÃªn, nÃ³ khÃ´ng cho phÃ©p tá»± Ã½ push dá»¯ liá»‡u xuá»‘ng client. Server push chá»‰ Ä‘Æ°á»£c xá»­ lÃ½ báº±ng browser vÃ  khÃ´ng Ä‘Æ°á»£c báº­t trong code cá»§a á»©ng dá»¥ng, nghÄ©a lÃ  khÃ´ng cÃ³ API cho app Ä‘á»ƒ get thÃ´ng bÃ¡o tá»« nhá»¯ng sá»± kiá»‡n nhÆ° tháº¿ nÃ y. ÄÃ¢y lÃ  nÆ¡i Sá»± kiá»‡n server gá»­i thÃ´ng tin (Server-Sent Events - SSE) trá»Ÿ nÃªn ráº¥t cÃ³ Ã­ch. SSE lÃ  1 cÆ¡ cháº¿ cho phÃ©p server push dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™ vá» client má»™t khi káº¿t ná»‘i client-server Ä‘Æ°á»£c thiáº¿t láº­p. Server cÃ³ thá»ƒ lá»±a chá»n Ä‘á»ƒ gá»­i dá»¯ liá»‡u khi nÃ o má»™t â€œcá»¥câ€ dá»¯ liá»‡u má»›i Ä‘Ã£ sáºµn sÃ ng. NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ¢n nháº¯c nhÆ° lÃ  mÃ´ hÃ¬nh Ä‘Äƒng kÃ½-xuáº¥t báº£n (publish-subscribe) 1 chiá»u. NÃ³ cÅ©ng cung cáº¥p má»™t chuáº©n Javascript client API tÃªn lÃ  EventSource Ä‘Æ°á»£c triá»ƒn khai trong Ä‘a sá»‘ cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i nhÆ° lÃ  1 pháº§n cá»§a tiÃªu chuáº©n HTML5 bá»Ÿi W3C. ChÃº Ã½ ráº±ng trÃ¬nh duyá»‡t khÃ´ng há»— trá»£ EventSource API cÅ©ng cÃ³ thá»ƒ dá»… dÃ ng polyfill. Bá»Ÿi vÃ¬ SSE dá»±a trÃªn HTTP, nÃ³ cÃ³ thá»ƒ phÃ¹ há»£p vá»›i HTTP/2 vÃ  cÃ³ thá»ƒ káº¿t há»£p Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c sá»± tá»‘t nháº¥t cá»§a cáº£ 2 bÃªn: HTTP/2 xá»­ lÃ½ táº§ng giao váº­n (transport layer) hiá»‡u quáº£ dá»±a trÃªn cÃ¡c luá»“ng multiplex vÃ  SSE cung cáº¥p API cho app Ä‘á»ƒ thá»±c hiá»‡n push. Äá»ƒ hiá»ƒu hoÃ n toÃ n vá» Stream vÃ  Multiplexing, Ä‘áº§u tiÃªn ta cáº§n biáº¿t sÆ¡ lÆ°á»£c vá» Ä‘á»‹nh nghÄ©a táº¡i IETF: má»™t â€œstreamâ€ lÃ  chuá»—i tuáº§n tá»± 2 chiá»u vÃ  Ä‘á»™c láº­p cá»§a nhiá»u frame Ä‘Æ°á»£c trao Ä‘á»•i giá»¯a client vÃ  server trong má»™t káº¿t ná»‘i HTTP/2. Má»™ trong sá»‘ nhá»¯ng Ä‘áº·c tÃ­nh chÃ­nh cá»§a nÃ³ lÃ  má»™t káº¿t ná»‘i HTTP/2 cÃ³ thá»ƒ chá»©a Ä‘á»“ng thá»i nhiá»u stream Ä‘ang má»Ÿ vá»›i frame endpoint xen káº½ tá»« nhiá»u stream. Pháº£i nhá»› ráº±ng SSE lÃ  dá»±a trÃªn HTTP. NghÄ©a lÃ  vá»›i HTTP/2, khÃ´ng chá»‰ nhiá»u stream SSE Ä‘Æ°á»£c xen káº½ trÃªn má»™t káº¿t ná»‘i TCP mÃ  cÅ©ng cÆ¡ cháº¿ Ä‘Ã³ cÃ³ thá»ƒ thá»±c hiá»‡n vá»›i sá»± káº¿t há»£p cá»§a nhiá»u stream SSE (push tá»« server Ä‘áº¿n client) vÃ  nhiá»u client request (client Ä‘áº¿n server). Nhá» Æ¡n HTTP/2 vÃ  SSE mÃ  giá» Ä‘Ã¢y chÃºng ta Ä‘Ã£ cÃ³ má»™t káº¿t ná»‘i HTTP 2 chiá»u thuáº§n tÃºy vá»›i API Ä‘Æ¡n giáº£n Ä‘á»ƒ code á»©ng dá»¥ng cÃ³ thá»ƒ Ä‘Äƒng kÃ½ cho server push. Thiáº¿u Ä‘i kháº£ nÄƒng giao tiáº¿p 2 chiá»u thÆ°á»ng Ä‘Æ°á»£c xem nhÆ° lÃ  má»™t bÆ°á»›c cáº£i lÃ¹i khi so sÃ¡nh SSE vá»›i WebSocket. Cáº£m Æ¡n HTTP/2, nhá» nÃ³ mÃ  Ä‘iá»u nÃ y khÃ´ng cÃ²n lÃ  váº§n Ä‘á» ná»¯a. ThÃªm ná»¯a lÃ  nÃ³ má»Ÿ ra cÆ¡ há»™i Ä‘á»ƒ bá» qua WebSocket vÃ  táº­p trung vÃ o nhá»¯ng cÃ´ng nghá»‡ thay tháº¿ dá»±a trÃªn HTTP. LÃ m tháº¿ nÃ o Ä‘á»ƒ chá»n giá»¯a WebSocket &amp; HTTP/2?WebSocket cháº¯c cháº¯n sáº½ tá»“n táº¡i trong sá»± thá»‘ng trá»‹ cá»§a HTTP/2 + SSE, chá»§ yáº¿u bá»Ÿi vÃ¬ nÃ³ lÃ  cÃ´ng nghá»‡ Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã³n nháº­n vÃ  trong nhiá»u trÆ°á»ng há»£p cá»¥ thá»ƒ nÃ³ cÃ³ sá»± vÆ°á»£t trá»™i so vá»›i HTTP/2 nhÆ° cÃ¡ch nÃ³ Ä‘Æ°á»£c xÃ¢y dá»±ng cho kháº£ nÄƒng giao tiáº¿p 2 chiá»u vá»›i Ã­t chi phÃ­ tá»‘n kÃ©m (vÃ­ dá»¥: headers). Giáº£ sá»­ báº¡n muá»‘n xÃ¢y dá»±ng game MMO (Massive Multiplayer Online: Game nhiá»u ngÆ°á»i chÆ¡i trá»±c tuyáº¿n) cáº§n má»™t lÆ°á»£ng khá»•ng lá»“ message tá»« cáº£ 2 Ä‘áº§u káº¿t ná»‘i. Trong nhá»¯ng trÆ°á»ng há»£p nhÆ° tháº¿ thÃ¬ WebSocket thá»ƒ hiá»‡n ráº¥t ráº¥t tá»‘t. Tá»•ng quÃ¡t thÃ¬ sá»­ dá»¥ng WebSocket khi nÃ o báº¡n cáº§n má»™t káº¿t ná»‘i vá»›i Ä‘á»™ trá»… ráº¥t tháº¥p, gáº§n nhÆ° lÃ  realtime giá»¯a client &amp; server. Nhá»› ká»¹ ráº±ng viá»‡c nÃ y cÃ³ thá»ƒ yÃªu cáº§u báº¡n cÃ¢n nháº¯c láº¡i cÃ¡ch xÃ¢y dá»±ng á»©ng dá»¥ng server-side cá»§a báº¡n, cÅ©ng nhÆ° chuyá»ƒn sang táº­p trung vÃ o nhá»¯ng cÃ´ng nghá»‡ nhÆ° event queue. Náº¿u trÆ°á»ng há»£p cá»§a báº¡n cáº§n hiá»ƒn thá»‹ tin tá»©c thá»‹ trÆ°á»ng, dá»¯ liá»‡u thá»‹ trÆ°á»ng, á»©ng dá»¥ng chatâ€¦ theo thá»i gian thá»±c, sá»­ dá»¥ng HTTP/2 + SSE sáº½ cung cáº¥p cho báº¡n kÃªnh giao tiáº¿p 2 chiá»u hiá»‡u quáº£ trong khi gáº·t hÃ¡i nhiá»u lá»£i Ã­ch khi hoáº¡t Ä‘á»™ng trong tháº¿ giá»›i cá»§a HTTP: WebSocket thÆ°á»ng gÃ¢y ra khÃ³ khÄƒn khi cÃ¢n nháº¯c sá»± tÆ°Æ¡ng thÃ­ch vá»›i háº¡ táº§ng web hiá»‡n táº¡i cÅ©ng nhÆ° nÃ³ nÃ¢ng cáº¥p káº¿t ná»‘i HTTP Ä‘áº¿n má»™t giao thá»©c hoÃ n toÃ n khÃ¡c mÃ  khÃ´ng cÃ³ gÃ¬ dÃ­nh dÃ¡ng tá»›i HTTP. Má»Ÿ rá»™ng vÃ  báº£o máº­t: nhá»¯ng thÃ nh pháº§n cá»§a web (firewall, phÃ¡t hiá»‡n xÃ¢m nháº­p, cÃ¢n báº±ng táº£i) Ä‘Æ°á»£c xÃ¢y dá»±ng, báº£o trÃ¬ vÃ  thiáº¿t Ä‘áº·t vá»›i tÆ° tÆ°á»Ÿng cá»§a HTTP, má»™t mÃ´i trÆ°á»ng cho á»©ng dá»¥ng lá»›n vÃ  nghiÃªm ngáº·t sáº½ Æ°u tiÃªn kháº£ nÄƒng phá»¥c há»“i, báº£o váº­t vÃ  kháº£ nÄƒng má»Ÿ rá»™ng. Báº¡n cÅ©ng cáº§n pháº£i cÃ¢n nháº¯c vá» váº¥n Ä‘á» há»— trá»£ cá»§a trÃ¬nh duyá»‡t: KhÃ¡ tá»‘t pháº£i khÃ´ng nÃ o? NhÆ°ng vá»›i HTTP/2 thÃ¬ khÃ´ng háº³n: Chá»‰ cÃ³ TLS (CÅ©ng khÃ´ng tá»‡ láº¯m) Há»— trá»£ má»™t pháº§n cho IE11 nhÆ°ng chá»‰ trÃªn Windows 10 Chá»‰ há»— trá»£ OSX 10.11 trá»Ÿ lÃªn trÃªn Safari Chá»‰ há»— trá»£ HTTP/2 náº¿u báº¡n cÃ³ thá»ƒ Ä‘iá»u hÆ°á»›ng nÃ³ qua APLN (server cá»§a báº¡n cÅ©ng cáº§n pháº£i há»— trá»£ nÃ³ rÃµ rÃ ng) Há»— trá»£ SSE thÃ¬ tá»‘t hÆ¡n má»™t chÃºt: Chá»‰ cÃ³ IE/Edge lÃ  khÃ´ng há»— trá»£ (Opera Mini cÅ©ng tháº¿). Váº«n cÃ³ nhá»¯ng polyfill khÃ¡ tá»‘t Ä‘á»ƒ giÃºp chÃºng ta lÃ m viÃªc vá»›i SSE trÃªn IE/Edge. SessionStack lá»±a chá»n nhÆ° tháº¿ nÃ o?Team SessionStack sá»­ dá»¥ng cáº£ 2 WebSocket vÃ  HTTP, tÃ¹y thuá»™c vÃ o tá»«ng trÆ°á»ng há»£p. Má»™t khi báº¡n Ä‘Ã£ tÃ­ch há»£p SessionStack vÃ o web app cá»§a báº¡n, nÃ³ sáº½ ghi láº¡i má»i thá»© diá»…n ra trÃªn app/website: nhá»¯ng thay Ä‘á»•i trÃªn DOM, tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng, JS exception, stack trace, nhá»¯ng request bá»‹ fail vÃ  cáº£ thÃ´ng bÃ¡o debug, cho phÃ©p báº¡n cháº¡y láº¡i (replay) nhá»¯ng issue Ä‘Ã£ xáº£y ra dÆ°á»›i dáº¡ng video vÃ  xem chÃºng diá»…n ra nhÆ° tháº¿ nÃ o vá»›i ngÆ°á»i dÃ¹ng. Táº¥t cáº£ Ä‘á»u hoáº¡t Ä‘á»™ng theo thá»i gian thá»±c (real-time) vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u nÄƒng cá»§a webapp. Äiá»u Ä‘Ã³ nghÄ©a lÃ  báº¡n cÃ³ thá»ƒ tham gia vÃ o má»™t phiÃªn lÃ m viá»‡c cá»§a user, trong khi user Ä‘ang hoáº¡t Ä‘á»™ng trÃªn trÃ¬nh duyá»‡t. Trong trÆ°á»ng há»£p nÃ y, team tÃ¡c giáº£ chá»n sá»­ dá»¥ng HTTP bá»Ÿi vÃ¬ khÃ´ng cáº§n giao tiáº¿p 2 chiá»u (server chá»‰ cáº§n stream dá»¯ liá»‡u Ä‘áº¿n trÃ¬nh duyá»‡t). Náº¿u dÃ¹ng WebSocket á»Ÿ Ä‘Ã¢y thÃ¬ sáº½ ráº¥t tá»‡, cÃ ng khÃ³ Ä‘á»ƒ báº£o trÃ¬ vÃ  má»Ÿ rá»™ng. Tuy nhiÃªn, thÆ° viá»‡n SessionStack tÃ­ch há»£p vÃ o trong webapp cá»§a báº¡n sá»­ dá»¥ng WebSocket (náº¿u cÃ³ thá»ƒ, cÃ²n khÃ´ng thÃ¬ HTTP). NÃ³ sáº¯p xáº¿p vÃ  gá»­i dá»¯ liá»‡u vá» server vÃ  cÅ©ng lÃ  giao tiáº¿p 1 chiá»u. Team tÃ¡c giáº£ chá»n WebSocket vÃ¬ trong trÆ°á»ng há»£p nÃ y vÃ i tÃ­nh nÄƒng cáº§n thiáº¿t sá»­ dá»¥ng giao tiáº¿p 2 chiá»u.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P4: Event loop, láº­p trÃ¬nh báº¥t Ä‘á»“ng bá»™ & 5 máº¹o cáº£i thiá»‡n Async/Await","slug":"Cach-Javascript-hoat-dong-P4-Event-loop-lap-trinh-bat-dong-bo-5-meo-cai-thien-Async-Await","date":"2018-11-13T16:34:00.000Z","updated":"2018-11-13T16:39:26.827Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P4-Event-loop-lap-trinh-bat-dong-bo-5-meo-cai-thien-Async-Await.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P4-Event-loop-lap-trinh-bat-dong-bo-5-meo-cai-thien-Async-Await.html","excerpt":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 4 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Láº§n nÃ y chÃºng ta sáº½ má»Ÿ rá»™ng nhá»¯ng gÃ¬ cÃ³ trong bÃ i Ä‘áº§u tiÃªn báº±ng cÃ¡ch Ä‘Ã¡nh giÃ¡ nhá»¯ng nhÆ°á»£c Ä‘iá»ƒm cá»§a mÃ´i trÆ°á»ng Ä‘Æ¡n luá»“ng (single thread) vÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ vÆ°á»£t qua chÃºng nháº±m xÃ¢y dá»±ng nhá»¯ng Javascript UI áº¥n tÆ°á»£ng. VÃ  váº«n nhÆ° cÅ©, cuá»‘i bÃ i viáº¿t tÃ¡c giáº£ sáº½ chia sáº» 5 máº¹o nhá» Ä‘á»ƒ viáº¿t code tá»‘t hÆ¡n vá»›i async/await.","text":"ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i thá»© 4 trong series Ä‘á»¥c khoÃ©t vÃ  khÃ¡m phÃ¡ Javascript cÅ©ng nhÆ° cÃ¡c thÃ nh pháº§n cá»§a nÃ³. Trong quÃ¡ trÃ¬nh xÃ¡c Ä‘á»‹nh vÃ  tÃ¬m hiá»ƒu cÃ¡c thÃ nh pháº§n cá»‘t lÃµi, tÃ¡c giáº£ cÅ©ng chia sáº» má»™t sá»‘ nguyÃªn táº¯c mÃ  há» Ä‘ang dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng SessionStack, má»™t á»©ng dá»¥ng Javascript hÆ°á»›ng Ä‘áº¿n sá»± máº¡nh máº½, hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh. Láº§n nÃ y chÃºng ta sáº½ má»Ÿ rá»™ng nhá»¯ng gÃ¬ cÃ³ trong bÃ i Ä‘áº§u tiÃªn báº±ng cÃ¡ch Ä‘Ã¡nh giÃ¡ nhá»¯ng nhÆ°á»£c Ä‘iá»ƒm cá»§a mÃ´i trÆ°á»ng Ä‘Æ¡n luá»“ng (single thread) vÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ vÆ°á»£t qua chÃºng nháº±m xÃ¢y dá»±ng nhá»¯ng Javascript UI áº¥n tÆ°á»£ng. VÃ  váº«n nhÆ° cÅ©, cuá»‘i bÃ i viáº¿t tÃ¡c giáº£ sáº½ chia sáº» 5 máº¹o nhá» Ä‘á»ƒ viáº¿t code tá»‘t hÆ¡n vá»›i async/await. Táº¡i sao Ä‘Æ¡n luá»“ng láº¡i lÃ  giá»›i háº¡n.Trong bÃ i Ä‘áº§u tiÃªn cá»§a series, chÃºng ta suy ngáº«m vá» cÃ¢u há»i Ä‘iá»u gÃ¬ xáº£y ra khi chÃºng ta cÃ³ 1 hÃ m trong callstack vÃ  hÃ m Ä‘Ã³ láº¡i ngá»‘n quÃ¡ nhiá»u thá»i gian Ä‘á»ƒ thá»±c thi. HÃ£y tÆ°á»Ÿng tÆ°á»£ng, ta thá»±c hiá»‡n má»™t thuáº­t toÃ¡n chuyá»ƒn Ä‘á»•i hÃ¬nh áº£nh phá»©c táº¡p cháº¡y trÃªn browser. Trong khi callstack Ä‘ang thá»±c thi cÃ¡c hÃ m, trÃ¬nh duyá»‡t láº¡i khÃ´ng thá»ƒ lÃ m gÃ¬ cáº£, nÃ³ bá»‹ káº¹t. NghÄ©a lÃ  trÃ¬nh duyá»‡t khÃ´ng thá»ƒ váº½, render, nÃ³ khÃ´ng thá»ƒ cháº¡y code khÃ¡c, chá»‰ Ä‘Æ¡n giáº£n lÃ  káº¹t. VÃ  váº¥n Ä‘á» lÃ  á»Ÿ Ä‘Ã¢y, giao diá»‡n (UI) cá»§a app báº¡n sáº½ hoáº¡t Ä‘á»™ng khÃ´ng hiá»‡u quáº£. App cá»§a báº¡n bá»‹ káº¹t. Trong má»™t vÃ i trÆ°á»ng há»£p thÃ¬ Ä‘Ã¢y khÃ´ng pháº£i váº¥n Ä‘á» nghiÃªm trá»ng. Tuy nhiÃªn, cÃ³ váº¥n Ä‘á» cÃ²n lá»›n hÆ¡n ná»¯a. Má»™t khi trÃ¬nh duyá»‡t cá»§a báº¡n xá»­ lÃ½ quÃ¡ nhiá»u thá»© trong callstack, nÃ³ sáº½ bá»‹ â€œÄ‘á»¡â€ trong 1 khoáº£ng thá»i gian dÃ i. Táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³, Ä‘a sá»‘ cÃ¡c browser sáº½ chá»n giáº£i phÃ¡p hiá»‡n lá»—i, há»i ngÆ°á»i dÃ¹ng cÃ³ muá»‘n há»§y trang hiá»‡n táº¡i khÃ´ng. Äiá»u nÃ y tháº­t lÃ  xáº¥u xÃ­ vÃ  áº£nh hÆ°á»Ÿng nghiÃªm trá»ng Ä‘áº¿n tráº£i nghiá»‡m (UX): Nhá»¯ng thÃ nh pháº§n xÃ¢y dá»±ng nÃªn 1 chÆ°Æ¡ng trÃ¬nh JSBáº¡n cÃ³ thá»ƒ viáº¿t toÃ n bá»™ code JS trong 1 file .js duy nháº¥t nhÆ°ng chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n cháº¯c cháº¯n chá»©a nhiá»u thÃ nh pháº§n nhá» (gá»i lÃ  nhá»¯ng block), chá»‰ cÃ³ má»™t sá»‘ block sáº½ Ä‘Æ°á»£c thá»±c thi ngay (gá»i lÃ  nhÃ³m A) vÃ  pháº§n cÃ²n láº¡i thÃ¬ cháº¡y sau (nhÃ³m B). ÄÆ¡n vá»‹ block phá»• biáº¿n nháº¥t lÃ  function (hÃ m). Váº¥n Ä‘á» mÃ  Ä‘a sá»‘ cÃ¡c developer JS má»›i gáº·p pháº£i lÃ  há» nghÄ© ráº±ng nhÃ³m B khÃ´ng cáº§n pháº£i Ä‘Æ°á»£c thá»±c thi má»™t cÃ¡ch nghiÃªm ngáº·t ngay sau khi thá»±c thi nhÃ³m A. NÃ³i cÃ¡ch khÃ¡c, nhá»¯ng nhiá»‡m vá»¥ khÃ´ng Ä‘Æ°á»£c hoÃ n thÃ nh ngay bÃ¢y giá» thÃ¬ theo lá»¹ thuyáº¿t nÃ³ sáº½ Ä‘Æ°á»£c hoÃ n thÃ nh má»™t cÃ¡ch báº¥t Ä‘á»“ng bá»™, nghÄ©a lÃ  báº¡n sáº½ khÃ´ng pháº£i gáº·p tÃ¬nh huá»‘ng blocking (bá»‹ cháº·n) nhÆ° Ä‘á» cáº­p á»Ÿ trÃªn VÃ­ dá»¥: 12345// Giáº£ sá»­ ajax(..) lÃ  má»™t hÃ m Ajax thuá»™c thÆ° viá»‡n nÃ o Ä‘Ã³var response = ajax('https://example.com/api');console.log(response);// `response` sáº½ khÃ´ng chá»©a dá»¯ liá»‡u tráº£ vá» Cháº¯c báº¡n cÅ©ng nháº­n tháº¥y ráº±ng nhá»¯ng request Ajax nhÆ° tháº¿ nÃ y khÃ´ng cháº¡y Ä‘á»“ng bá»™ vá»›i nhau, nghÄ©a lÃ  táº¡i thá»i Ä‘iá»ƒm code thá»±c thi, hÃ m ajax(â€¦) chÆ°a cÃ³ dá»¯ liá»‡u tráº£ vá» Ä‘á»ƒ gÃ¡n vÃ o biáº¿n response Má»™t cÃ¡ch Ä‘Æ¡n giáº£n cho thÆ°á»ng gáº·p Ä‘á»ƒ â€œchá»â€ má»™t hÃ m xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ tráº£ káº¿t quáº£ vá» Ä‘Ã³ lÃ  sá»­ dá»¥ng callback: 123ajax('https://example.com/api', function(response) &#123; console.log(response); // \"response\" giá» Ä‘Ã£ cÃ³ dá»¯ liá»‡u&#125;); ChÃº Ã½: Báº¡n cÃ³ thá»ƒ viáº¿t nhá»¯ng Ajax request Ä‘á»“ng bá»™, tuy nhiÃªn Ä‘á»«ng bao giá» lÃ m tháº¿. Náº¿u báº¡n viáº¿t Ajax nhÆ° váº­y thÃ¬ UI sáº½ bá»‹ block cá»©ng Ä‘Æ¡ vÃ  ngÆ°á»i dÃ¹ng sáº½ khÃ´ng thá»ƒ thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng nhÆ° click, nháº­p dá»¯ liá»‡u, Ä‘iá»u hÆ°á»›ng, lÄƒn chuá»™tâ€¦ Má»™t tráº£i nghiá»‡m kinh khá»§ng. ÄÃ¢y lÃ  cÃ¡ch mÃ  Ajax Ä‘Æ°á»£c viáº¿t Ä‘á»“ng bá»™, nhÆ°ng lÃ m Æ¡n, Ä‘á»«ng bao giá» sá»­ dá»¥ng nÃ³ trong app cá»§a báº¡n: 12345678// Giáº£ sá»­ báº¡n Ä‘ang dÃ¹ng jQueryjQuery.ajax(&#123; url: 'https://api.example.com/endpoint', success: function(response) &#123; // callback á»Ÿ Ä‘Ã¢y. &#125;, async: false // Má»™t Ã½ tÆ°á»Ÿng cá»±c ká»³ tá»“i tá»‡&#125;); ChÃºng ta Ä‘Ã£ sá»­ dá»¥ng Ajax request Ä‘á»ƒ vÃ­ dá»¥. NgoÃ i ra báº¡n cÃ³ thá»ƒ dÃ¹ng báº¥t ká»³ Ä‘oáº¡n code nÃ o Ä‘á»ƒ thá»±c hiá»‡n báº¥t Ä‘á»“ng bá»™. DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ khÃ¡c vá»›i hÃ m setTimeout(callback, milliseconds). CÃ¡ch thá»©c mÃ  hÃ m setTimeout hoáº¡t Ä‘á»™ng lÃ  nÃ³ sáº½ Ä‘áº·t 1 sá»± kiá»‡n (á»Ÿ Ä‘Ã¢y lÃ  sá»± kiá»‡n timeout) vÃ  Ä‘á»ƒ nÃ³ thá»±c hiá»‡n sau: 123456789101112function first() &#123; console.log('first');&#125;function second() &#123; console.log('second');&#125;function third() &#123; console.log('third');&#125;first();setTimeout(second, 1000); // gá»i hÃ m `second` sau 1000msthird(); VÃ  Ä‘Ã¢y lÃ  káº¿t quáº£ cá»§a Ä‘oáº¡n code trÃªn: 123firstthirdsecond Má»• xáº» Event Loop (vÃ²ng láº·p sá»± kiá»‡n)ChÃºng ta sáº½ báº¯t Ä‘áº§u vá»›i má»™t chÃºt â€œká»³ quáº·câ€ - máº·c dÃ¹ JS cháº¥p nháº­n code cháº¡y báº¥t Ä‘á»“ng bá»™ (nhÆ° trÆ°á»ng há»£p cá»§a setTimeout) thÃ¬ cho Ä‘áº¿n khi giá»›i thiá»‡u ES6, JS cÅ©ng khÃ´ng thá»±c sá»± cÃ³ má»™t khÃ¡i niá»‡m trá»±c tiáº¿p nÃ o vá» báº¥t Ä‘á»“ng bá»™. Bá»™ engine JS chÆ°a bao giá» lÃ m gÃ¬ vÆ°á»£t ra khá»i viá»‡c thá»±c thi má»™t khá»‘i lá»‡nh trong chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n táº¡i 1 thá»i Ä‘iá»ƒm cá»‘ Ä‘á»‹nh. Báº¡n cÃ³ thá»ƒ xem chi tiáº¿t hÆ¡n vá» cÃ¡ch engine JS (cá»¥ thá»ƒ lÃ  Google V8) hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o á»Ÿ bÃ i viáº¿t trÆ°á»›c. Váº­y thÃ¬ ai lÃ  ngÆ°á»i ra lá»‡nh cho engine JS pháº£i thá»±c thi nhá»¯ng khá»‘i lá»‡nh trong chÆ°Æ¡ng trÃ¬nh? TrÃªn thá»±c táº¿, engine JS khÃ´ng cháº¡y cÃ´ láº­p, nÃ³ hoáº¡t Ä‘á»™ng bÃªn trong má»™t mÃ´i trÆ°á»ng chá»§ (hosting environment), mÃ´i trÆ°á»ng nÃ y Ä‘á»‘i vá»›i Ä‘a sá»‘ cÃ¡c developer chÃ­nh lÃ  trÃ¬nh duyá»‡t web hoáº·c Node.js. Thá»±c ra, ngÃ y nay, JS Ä‘Ã£ vÃ  Ä‘ang Ä‘Æ°á»£c nhÃºng vÃ o ráº¥t nhiá»u loáº¡i thiáº¿t bá»‹ khÃ¡c nhau, tá»« robot cho tá»›i bÃ³ng Ä‘Ã¨n. Má»—i má»™t thiáº¿t bá»‹ cÃ³ thá»ƒ xem nhÆ° lÃ  1 loáº¡i khÃ¡c nhau cá»§a mÃ´i trÆ°á»ng chá»§ cho engine JS. Máº«u sá»‘ chung cá»§a táº¥t cáº£ cÃ¡c mÃ´i trÆ°á»ng Ä‘Ã³ lÃ  má»™t cÆ¡ cháº¿ tÃ­ch há»£p sáºµn Ä‘Æ°á»£c gá»i lÃ  event-loop (vÃ²ng láº·p sá»± kiá»‡n), nÃ³ xá»­ lÃ½ quÃ¡ trÃ¬nh thá»±c thi cá»§a nhiá»u khá»‘i lá»‡nh trong chÆ°Æ¡ng trÃ¬nh theo thá»i gian, má»—i láº§n Ä‘á»u gá»i engine JS. Äiá»u nÃ y nghÄ©a lÃ  engine JS chá»‰ lÃ  1 mÃ´i trÆ°á»ng thá»±c thi theo yÃªu cáº§u cho báº¥t ká»³ Ä‘oáº¡n code JS tÃ¹y Ã½ nÃ o. NÃ³ chá»‰ lÃ  mÃ´i trÆ°á»ng bao quanh cÃ³ lá»‹ch trÃ¬nh cho cÃ¡c sá»± kiá»‡n (quÃ¡ trÃ¬nh thá»±c thi code JS). VÃ­ dá»¥, khi code JS cá»§a báº¡n gá»i Ajax request Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« server, báº¡n cÃ i Ä‘áº·t má»™t Ä‘oáº¡n code response trong má»™t hÃ m (gá»i lÃ  callback), vÃ  engine JS sáº½ truyá»n Ä‘áº¡t láº¡i vá»›i mÃ´i trÆ°á»ng chá»§: NÃ y, tao chuáº©n bá»‹ táº¡m ngÆ°ng quÃ¡ trÃ¬nh thá»±c thi ngay bÃ¢y giá», nhÆ°ng mÃ  khi nÃ o mÃ y xong viá»‡c vá»›i request Ä‘Ã³ vÃ  cÃ³ má»™t vÃ i cá»¥c dá»¯ liá»‡u thÃ¬ nhá»› gá»i láº¡i hÃ m nÃ y nhÃ©. TrÃ¬nh duyá»‡t sau Ä‘Ã³ sáº½ láº¯ng nghe vá» response tá»« máº¡ng, vÃ  khi nÃ³ cÃ³ gÃ¬ Ä‘Ã³ tráº£ vá» cho báº¡n, nÃ³ sáº½ lÃªn lá»‹ch cho hÃ m callback Ä‘Æ°á»£c thá»±c thi báº±ng cÃ¡ch chÃ¨n nÃ³ vÃ o trong event loop CÃ¹ng xem sÆ¡ Ä‘á»“ nÃ y nÃ o: Báº¡n cÃ³ thá»ƒ xem láº¡i pháº§n bÃ i viáº¿t vá» Memory Heap &amp; Call Stack trong bÃ i viáº¿t trÆ°á»›c Ä‘Ã¢y Váº­y thÃ¬ nhá»¯ng Web APIs nÃ y lÃ  gÃ¬? Vá» báº£n cháº¥t, chÃºng lÃ  nhá»¯ng tiáº¿n trÃ¬nh mÃ  báº¡n khÃ´ng thá»ƒ truy xuáº¥t (access), báº¡n chá»‰ cÃ³ thá»ƒ gá»i nÃ³. ChÃºng lÃ  nhá»¯ng thÃ nh pháº§n cá»§a trÃ¬nh duyá»‡t mÃ  trong Ä‘Ã³ cÃ¡ch xá»­ lÃ½ Ä‘á»“ng bá»™ Ä‘Æ°á»£c báº¯t Ä‘áº§u. Náº¿u báº¡n lÃ  má»™t Node.js developer thÃ¬ chÃºng lÃ  nhá»¯ng C++ APIs. Váº­y cuá»‘i cÃ¹ng thÃ¬ event loop lÃ  cÃ¡i Ã©o gÃ¬ ? Event Loop cÃ³ má»™t cÃ´ng viá»‡c Ä‘Æ¡n giáº£n: theo dÃµi Call Stack vÃ  Callback Queue (hÃ ng Ä‘á»£i cÃ¡c hÃ m callback). Náº¿u Call Stack Ä‘ang trá»‘ng, nÃ³ sáº½ láº¥y event Ä‘áº§u tiÃªn tá»« trong hÃ ng Ä‘á»£i ra vÃ  Ä‘áº©y nÃ³ váº£o trong Call Stack - tá»©c lÃ  thá»±c thi nÃ³. Má»—i vÃ²ng láº·p nhÆ° tháº¿ Ä‘Æ°á»£c gá»i lÃ  1 tick trong Event Loop. Má»—i sá»± kiá»‡n chá»‰ lÃ  1 hÃ m callback. 12345console.log('Hi');setTimeout(function cb1() &#123; console.log('cb1');&#125;, 5000);console.log('Bye'); CÃ¹ng thá»±c thi Ä‘oáº¡n code trÃªn vÃ  xem Ä‘iá»u gÃ¬ xáº£y ra nÃ o: Tráº¡ng thÃ¡i Ä‘ang trá»‘ng, console cá»§a trÃ¬nh duyá»‡t Ä‘ang trá»‘ng, Call Stack Ä‘ang trá»‘ng. console.log(â€˜Hiâ€™) Ä‘Æ°á»£c thÃªm vÃ o Call Stack. console.log(â€˜Hiâ€™) Ä‘Æ°á»£c thá»±c thi. console.log(â€˜Hiâ€™) bá»‹ xÃ³a khá»i Call Stack. setTimeout(function cb1() { â€¦ }) Ä‘Æ°á»£c thÃªm vÃ o Call Stack. setTimeout(function cb1() { â€¦ }) Ä‘Æ°á»£c thá»±c thi. TrÃ¬nh duyá»‡t táº¡o má»™t timer - vá»‘n lÃ  má»™t pháº§n cá»§a Web APIs. NÃ³ sáº½ thá»±c hiá»‡n pháº§n Ä‘áº¿m ngÆ°á»£c cho báº¡n. The setTimeout(function cb1() { â€¦ }) Ä‘Æ°á»£c thá»±c hiá»‡n xong vÃ  bá»‹ xÃ³a khá»i Call Stack. console.log(â€˜Byeâ€™) Ä‘Æ°á»£c thÃªm vÃ o Call Stack. console.log(â€˜Byeâ€™) Ä‘Æ°á»£c thá»±c thi. console.log(â€˜Byeâ€™) bá»‹ xÃ³a khá»i Call Stack. Sau Ã­t nháº¥t 5000ms, timer hoÃ n thÃ nh cÃ´ng viá»‡c cá»§a nÃ³ vÃ  Ä‘áº©y cb1 callback vÃ o trong Callback Queue. Event Loop láº¥y cb1 tá»« trong Callback Queue vÃ  Ä‘Æ°a nÃ³ vÃ o trong Call Stack. cb1 Ä‘Æ°á»£c thá»±c thi vÃ  nÃ³ thÃªm console.log(â€˜cb1â€™) vÃ o trong Call Stack. console.log(â€˜cb1â€™) Ä‘Æ°á»£c thá»±c thi. console.log(â€˜cb1â€™) bá»‹ xÃ³a khá»i Call Stack. cb1 bá»‹ xÃ³a khá»i Call Stack. áº¢nh gif tá»•ng há»£p láº¡i quÃ¡ trÃ¬nh 16 bÆ°á»›c á»Ÿ trÃªn: Tháº­t thÃº vá»‹ khi biáº¿t ráº±ng ES6 cÃ³ mÃ´ táº£ event loop hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o, nghÄ©a lÃ  vá» máº·t ká»¹ thuáº­t, nÃ³ náº±m trong pháº¡m vi trÃ¡ch nghiá»‡m cá»§a má»™t JS engine, tá»©c lÃ  khÃ´ng cÃ²n chá»‰ Ä‘Ã³ng vai trÃ² mÃ´i trÆ°á»ng chá»§. Má»™t lÃ½ do chÃ­nh Ä‘Ã¡ng cho sá»± thay Ä‘á»•i nÃ y chÃ­nh lÃ  viá»‡c giá»›i thiá»‡u Promise trong ES6 bá»Ÿi vÃ¬ promise má»›i cáº§n truy xuáº¥t trá»±c tiáº¿p, kiá»ƒm soÃ¡t tá»‘i Ä‘a lá»‹ch trÃ¬nh Ä‘iá»u hÃ nh Ä‘á»‘i vá»›i event loop queue (Sau nÃ y chÃºng ta sáº½ tháº£o luáº­n chi tiáº¿t hÆ¡n) setTimeout(â€¦) hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?Äiá»u quan trá»ng cáº§n pháº£i biáº¿t lÃ  setTimeout(â€¦) khÃ´ng tá»± Ä‘á»™ng Ä‘áº·t callback vÃ o trong event loop queue. NÃ³ thiáº¿t láº­p má»™t bá»™ Ä‘áº¿m. Khi bá»™ Ä‘áº¿m káº¿t thÃºc, mÃ´i trÆ°á»ng Ä‘áº·t callback vÃ o trong event loop, vÃ¬ tháº¿ nhá»¯ng tick tiáº¿p theo cÃ³ thá»ƒ láº¥y nÃ³ ra vÃ  thá»±c thi: 1setTimeout(myCallback, 1000); NÃ³ khÃ´ng cÃ³ nghÄ©a lÃ  myCallback sáº½ Ä‘Æ°á»£c thá»±c thi sau 1000ms, mÃ  Ä‘Ãºng hÆ¡n lÃ , trong 1000ms, myCallback sáº½ Ä‘Æ°á»£c thÃªm vÃ o trong queue. Tuy nhiÃªn queue nÃ y cÃ³ thá»ƒ Ä‘ang cÃ³ event khÃ¡c Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o trÆ°á»›c Ä‘Ã³, vÃ  vÃ¬ tháº¿ callback cá»§a báº¡n sáº½ pháº£i chá». CÃ³ má»™t vÃ i bÃ i biáº¿t hoáº·c bÃ i hÆ°á»›ng dáº«n dÃ nh cho ngÆ°á»i má»›i báº¯t Ä‘áº§u vá»›i báº¥t Ä‘á»“ng bá»™ trong JS hÆ°á»›ng dáº«n ráº±ng ta nÃªn setTimeout(callback, 0). BÃ¢y giá» báº¡n Ä‘Ã£ biáº¿t cÃ¡ch event loop lÃ m viá»‡c vÃ  cÃ¡ch setTimeout hoáº¡t Ä‘á»™ng rá»“i: gá»i setTimeout vá»›i thá»i gian lÃ  0 chá»‰ vÃ¬ má»¥c Ä‘Ã­ch hoÃ£n callback láº¡i cho tá»›i khi Call Stack rá»—ng hoÃ n toÃ n. HÃ£y xem vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y: 12345console.log('Hi');setTimeout(function() &#123; console.log('callback');&#125;, 0);console.log('Bye'); Máº·c dÃ¹ thá»i gian chá» cá»§a callback lÃ  0ms nhÆ°ng káº¿t quáº£ in ra láº¡i nhÆ° tháº¿ nÃ y: 123HiByecallback Jobs (cÃ´ng viá»‡c) trong ES6 lÃ  gÃ¬?Má»™t khÃ¡i niá»‡m má»›i gá»i lÃ  Job Queue (HÃ ng Ä‘á»£i cÃ´ng viá»‡c) Ä‘Æ°á»£c giá»›i thiá»‡u trong ES6. NÃ³ lÃ  lá»›p trÃªn cÃ¹ng cá»§a event loop queue. Nhiá»u kháº£ nÄƒng báº¡n sáº½ gáº·p pháº£i nÃ³ khi xá»­ lÃ½ váº¥n Ä‘á» liÃªn quan Ä‘áº¿n báº¥t Ä‘á»“ng bá»™ cá»§a Promise (ChÃºng ta sáº½ nÃ³i vá» nÃ³ sau). BÃ¢y giá» thÃ¬ chÃºng ta chá»‰ tÃ¬m hiá»ƒu vá» máº·t Ã½ tÆ°á»Ÿng cÆ¡ báº£n Ä‘á»ƒ sau nÃ y khi tháº£o luáº­n vá» báº¥t Ä‘á»“ng bá»™ vá»›i Promise, báº¡n cÃ³ thá»ƒ hiá»ƒu vá» nhá»¯ng hÃ nh Ä‘á»™ng Ä‘Ã£ Ä‘Æ°á»£c lÃªn lá»‹ch vÃ  xá»­ lÃ½. TÆ°á»Ÿng tÆ°á»£ng nÃ³ nhÆ° tháº¿ nÃ y: Job queue lÃ  1 queue Ä‘Æ°á»£c gáº¯n vÃ o cuá»‘i má»—i tick trong event loop queue. Má»—i hÃ nh Ä‘á»™ng báº¥t Ä‘á»“ng bá»™ nháº¥t Ä‘á»‹nh khi xáº£y ra trong 1 tick sáº½ khÃ´ng lÃ m cho toÃ n bá»™ event Ä‘Æ°á»£c thÃªm vÃ o event loop queue nhÆ°ng thay vÃ¬ tháº¿ sáº½ thÃªm 1 item (tá»©c lÃ  job) vÃ o cuá»‘i job queue cá»§a tick hiá»‡n táº¡i. Äiá»u nÃ y nghÄ©a lÃ  báº¡n cÃ³ thá»ƒ thÃªm nhá»¯ng tÃ­nh nÄƒng khÃ¡c Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi sau vÃ  báº¡n cÃ³ thá»ƒ cháº¯c cháº¯n ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c thá»±c thi ngay sau Ä‘Ã³, trÆ°á»›c báº¥t ká»³ Ä‘oáº¡n code nÃ o khÃ¡c. Má»™t job cÃ³ thá»ƒ thÃªm nhiá»u job khÃ¡c vÃ o Ä‘oáº¡n cuá»‘i cá»§a cÃ¹ng 1 queue. TrÃªn lÃ½ thuyáº¿t, job cÃ³ thá»ƒ láº·p (loop) vÃ´ thá»i háº¡n (má»™t job thá»±c hiá»‡n thÃªm nhiá»u job khÃ¡c, v..vâ€¦), do Ä‘Ã³ nÃ³ sáº½ lÃ m cho chÆ°Æ¡ng trÃ¬nh bá»‹ quÃ¡ táº£i tÃ i nguyÃªn cáº§n thiáº¿t Ä‘á»ƒ tiáº¿p tá»¥c cháº¡y. Vá» máº·t khÃ¡i niá»‡m thÃ¬ Ä‘iá»u nÃ y tÆ°Æ¡ng tá»± nhÆ° má»™t cÃ´ng viá»‡c cÃ³ thá»i gian thá»±c thi dÃ i hoáº·c lÃ  má»™t vÃ²ng láº·p vÃ´ háº¡n (vÃ­ dá»¥: while(true)). Job cÅ©ng giá»‘ng nhÆ° trick setTimeout(callback, 0) (set thá»i gian báº±ng _0_) nhÆ°ng Ä‘Æ°á»£c triá»ƒn khai theo cÃ¡ch cÃ³ váº» nhÆ° â€œchÃ­nh thá»‘ngâ€ hÆ¡n vÃ  cÃ³ sá»± Ä‘áº£m báº£o vá» thá»© tá»±: thá»±c hiá»‡n sau, nhÆ°ng pháº£i lÃ m ngay khi cÃ³ thá»ƒ. CallbacksNhÆ° báº¡n Ä‘Ã£ biáº¿t, callback lÃ  cÃ¡ch phá»• biáº¿n nháº¥t Ä‘á»ƒ thá»ƒ hiá»‡n &amp; quáº£n lÃ½ sá»± báº¥t Ä‘á»“ng bá»™ trong JS. RÃµ rÃ ng, callback lÃ  mÃ´ hÃ¬nh báº¥t Ä‘á»“ng bá»™ cÆ¡ báº£n nháº¥t trong JS. VÃ´ sá»‘ chÆ°Æ¡ng trÃ¬nh JS, ká»ƒ cáº£ nhá»¯ng app tinh vi vÃ  phá»©c táº¡p nháº¥t thÃ¬ cÅ©ng pháº£i dÃ¹ng tá»›i callback. Ngoáº¡i trá»« viá»‡c callback khÃ´ng xuáº¥t hiá»‡n mÃ  khÃ´ng cÃ³ thiáº¿u sÃ³t. Nhiá»u developer Ä‘ang cá»‘ gáº¯ng tÃ¬m kiáº¿m nhá»¯ng mÃ´ hÃ¬nh báº¥t Ä‘á»“ng bá»™ tá»‘t hÆ¡n. Tuy nhiÃªn, chÃºng ta khÃ´ng thá»ƒ sá»­ dá»¥ng báº¥t ká»³ phÆ°Æ¡ng phÃ¡p thay tháº¿ nÃ o khÃ¡c náº¿u nhÆ° báº¡n chÆ°a thá»±c sá»± hiá»ƒu rÃµ vá» callback. á» chÆ°Æ¡ng tiáº¿p theo, chÃºng ta sáº½ khÃ¡m phÃ¡ sÃ¢u hÆ¡n vá» váº¥n Ä‘á» nÃ y Ä‘á»ƒ tÃ¬m hiá»ƒu táº¡i sao nhá»¯ng mÃ´ hÃ¬nh báº¥t Ä‘á»“ng bá»™ tinh vi khÃ¡c (sáº½ nÃ³i á»Ÿ nhá»¯ng bÃ i sau) lÃ  cáº§n thiáº¿t vÃ  Ä‘Æ°á»£c Ä‘á» nghá»‹ nÃªn sá»­ dá»¥ng. Callback lá»“ng nhau (nested callback)Xem Ä‘oáº¡n code dÆ°á»›i Ä‘Ã¢y: 123456789101112listen('click', function (e)&#123; setTimeout(function()&#123; ajax('https://api.example.com/endpoint', function (text)&#123; if (text == \"hello\") &#123; doSomething(); &#125; else if (text == \"world\") &#123; doSomethingElse(); &#125; &#125;); &#125;, 500);&#125;); ChÃºng ta cÃ³ 3 hÃ m lá»“ng nhau, má»—i hÃ m thá»ƒ hiá»‡n 1 bÆ°á»›c trong chuá»—i báº¥t Ä‘á»“ng bá»™. Kiá»ƒu code nhÆ° tháº¿ nÃ y thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  callback hell. NhÆ°ng callback hell thá»±c sá»± khÃ´ng pháº£i váº¥n Ä‘á» vá» lá»“ng nhau hay cÃ¡ch dÃ²ng, thá»¥t lá». CÃ¢u chuyá»‡n thá»±c sá»± sÃ¢u xa hÆ¡n tháº¿ nhiá»u. Äáº§u tiÃªn, chÃºng ta listen má»™t event click, sau Ä‘Ã³ thÃ¬ chá» timer hoáº¡t Ä‘á»™ng, rá»“i cuá»‘i cÃ¹ng lÃ  chá» cho Ajax tráº£ káº¿t quáº£ vá» vÃ  quÃ¡ trÃ¬nh nÃ y cÃ³ thá»ƒ láº·p láº¡i nhiá»u láº§n má»—i khi chÃºng ta click. Thoáº¡t nhÃ¬n Ä‘oáº¡n code nÃ y thá»ƒ hiá»‡n sá»± Ä‘á»“ng bá»™ má»™t cÃ¡ch tá»± nhiÃªn theo thá»© tá»± cÃ¡c bÆ°á»›c nhÆ° sau: 123listen('click', function (e) &#123; // ..&#125;); â€¦rá»“i sau Ä‘Ã³: 123setTimeout(function()&#123; // ..&#125;, 500); â€¦tiáº¿p theo lÃ : 123ajax('https://api.example.com/endpoint', function (text)&#123; // ..&#125;); â€¦vÃ  cuá»‘i cÃ¹ng: 123456if (text == \"hello\") &#123; doSomething();&#125;else if (text == \"world\") &#123; doSomethingElse();&#125; ChÃ , Ä‘Ãºng lÃ  má»™t cÃ¡ch thá»ƒ hiá»‡n code báº¥t Ä‘á»“ng bá»™ má»™t cÃ¡ch ráº¥t tá»± nhiÃªn, pháº£i khÃ´ng nÃ o? cÆ°á»i PromisesCÃ¹ng xem Ä‘oáº¡n code sau: 123var x = 1;var y = 2;console.log(x + y); Ráº¥t rÃµ rÃ ng ráº±ng nÃ³ tÃ­nh tá»•ng cá»§a x vÃ  y rá»“i in káº¿t quáº£ ra console. Tuy nhiÃªn, náº¿u nhÆ° giÃ¡ trá»‹ cá»§a x vÃ  y chÆ°a tá»“n táº¡i vÃ  váº«n cÃ²n Ä‘ang chá» Ä‘á»ƒ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh thÃ¬ sao? Giáº£ sá»­ chÃºng ta cáº§n láº¥y giÃ¡ trá»‹ cá»§a x vÃ  y tá»« server trÆ°á»›c khi chÃºng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ tÃ­nh tá»•ng.TÆ°á»Ÿng tÆ°á»£ng ráº±ng chÃºng ta cÃ³ má»™t hÃ m loadX vÃ  loadY Ä‘á»ƒ thá»±c hiá»‡n load dá»¯ liá»‡u cho x vÃ  y tá»« server vÃ  má»™t hÃ m Ä‘á»ƒ tÃ­nh tá»•ng 2 sá»‘ sau khi chÃºng Ä‘Æ°á»£c load xong.Äoáº¡n code sáº½ giá»‘ng nhÆ° tháº¿ nÃ y (xáº¥u xÃ­ vÃ  phá»©c táº¡p, pháº£i khÃ´ng nÃ o?): 123456789101112131415161718192021222324252627function sum(getX, getY, callback) &#123; var x, y; getX(function(result) &#123; x = result; if (y !== undefined) &#123; callback(x + y); &#125; &#125;); getY(function(result) &#123; y = result; if (x !== undefined) &#123; callback(x + y); &#125; &#125;);&#125;// Má»™t hÃ m Ä‘á»“ng bá»™ hoáº·c báº¥t Ä‘á»“ng bá»™ Ä‘á»ƒ get giÃ¡ trá»‹ cá»§a \"x\"function fetchX() &#123; // ..&#125;// Má»™t hÃ m Ä‘á»“ng bá»™ hoáº·c báº¥t Ä‘á»“ng bá»™ Ä‘á»ƒ get giÃ¡ trá»‹ cá»§a \"y\"function fetchY() &#123; // ..&#125;sum(fetchX, fetchY, function(result) &#123; console.log(result);&#125;); CÃ³ má»™t Ä‘iá»u quan trá»ng cáº§n pháº£i nÃªu lÃªn á»Ÿ Ä‘Ã¢y: trong Ä‘oáº¡n code trÃªn, chÃºng ta xem x vÃ  y nhÆ° nhá»¯ng giÃ¡ trá»‹ tÆ°Æ¡ng lai vÃ  hÃ m sum() khÃ´ng quan tÃ¢m vá» viá»‡c x hay y hay cáº£ 2 biáº¿n cÃ³ hay khÃ´ng cÃ³ tá»“n táº¡i giÃ¡ trá»‹. DÄ© nhiÃªn lÃ  cÃ¡ch tiáº¿p cáº­n thÃ´ dá»±a trÃªn callback nÃ y cho ta nhiá»u thá»© Ä‘Ã¡ng mong Ä‘á»£i. ÄÃ¢y chá»‰ lÃ  1 bÆ°á»›c tiáº¿n nhá» Ä‘á»ƒ hiá»ƒu vá» Ã­ch lá»£i cá»§a giÃ¡ trá»‹ tÆ°Æ¡ng lai mÃ  khÃ´ng cáº§n lo láº¯ng vá» khÃ­a cáº¡nh thá»i gian khi chÃºng sáºµn cÃ³. GiÃ¡ trá»‹ cá»§a PromiseCÃ¹ng xem vÃ­ dá»¥ vá» x + y Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i Promise: 12345678910111213141516171819202122232425function sum(xPromise, yPromise) &#123; // `Promise.all([ .. ])` nháº­n vÃ o 1 máº£ng cÃ¡c promise, // vÃ  tráº£ vá» 1 promise chá» Ä‘á»£i táº¥t cáº£ chÃºng hoÃ n thÃ nh return Promise.all([xPromise, yPromise]) // khi má»™t promise Ä‘Æ°á»£c phÃ¢n giáº£i (resolve), // ta láº¥y giÃ¡ trá»‹ x, y tráº£ vá» vÃ  cá»™ng chÃºng láº¡i. .then(function(values)&#123; // `values` lÃ  máº£ng chá»©a giÃ¡ trá»‹ cá»§a cÃ¡c object // tá»« nhá»¯ng promise Ä‘Ã£ Ä‘Æ°á»£c resolve return values[0] + values[1]; &#125; );&#125;// `fetchX()` vÃ  `fetchY()` tráº£ vá» promise // chá»©a káº¿t quáº£ tÆ°Æ¡ng á»©ng, cÃ³ thá»ƒ cÃ³ // luÃ´n hoáº·c chá» sau má»›i cÃ³ dá»¯ liá»‡usum(fetchX(), fetchY())// Ta cÃ³ 1 promise cho tá»•ng cá»§a 2 sá»‘.// Giá» thÃ¬ gá»i máº¯t xÃ­ch (chain-call) hÃ m `.then(...)` Ä‘á»ƒ chá» // káº¿t quáº£ cá»§a promise tráº£ vá»..then(function(sum)&#123; console.log(sum);&#125;); CÃ³ 2 lá»›p Promise trong Ä‘oáº¡n code nÃ y. fetchX() vÃ  fetchY() Ä‘Æ°á»£c gá»i trá»±c tiáº¿p vÃ  giÃ¡ trá»‹ tráº£ vá» cá»§a chÃºng (promise!) Ä‘Æ°á»£c Ä‘áº©y vÃ o hÃ m sum(â€¦). GiÃ¡ trá»‹ mÃ  nhá»¯ng promise nÃ y thá»ƒ hiá»‡n cÃ³ thá»ƒ sáºµn sÃ ng Ä‘á»ƒ dÃ¹ng ngay lÃºc gá»i hÃ m hoáº·c lÃ  sau Ä‘Ã³ 1 chÃºt nhÆ°ng báº¥t ká»ƒ sá»›m hay muá»™n thÃ¬ má»—i promise Ä‘á»u chuáº©n hÃ³a hÃ nh vi cá»§a nÃ³ cho giá»‘ng nhau. ChÃºng ta suy Ä‘oÃ¡n vá» giÃ¡ trá»‹ cá»§a x vÃ  y theo hÆ°á»›ng Ä‘á»™c láº­p thá»i gian. Theo chu ká»³, chÃºng lÃ  nhá»¯ng giÃ¡ trá»‹ tÆ°Æ¡ng lai. Lá»›p thá»© 2 lÃ  promise do hÃ m sum(â€¦) táº¡o ra (thÃ´ng qua Promise.all([ â€¦ ])) vÃ  tráº£ vá», vÃ  cÅ©ng chá» nÃ³ get giÃ¡ trá»‹ khi gá»i .then(â€¦). Khi hÃ m sum(â€¦) hoÃ n táº¥t, tá»•ng giÃ¡ trá»‹ tÆ°Æ¡ng lai Ä‘Ã£ sáºµn sÃ ng vÃ  cÃ³ thá»ƒ in nÃ³ ra. ChÃºng ta áº©n pháº§n logic chá» giÃ¡ trá»‹ tÆ°Æ¡ng lai cá»§a x vÃ  y trong hÃ m `sum(â€¦). LÆ°u Ã½: BÃªn trong sum(â€¦), lá»i gá»i Ä‘áº¿n Promise.all([ â€¦ ]) táº¡o má»™t promise (cÃ¡i nÃ y sáº½ gá»i Ä‘áº¿n xPromise vÃ  yPromise rá»“i phÃ¢n giáº£i chÃºng). Chain-call Ä‘áº¿n .then() sáº½ táº¡o ra 1 promise khÃ¡c vÃ  promise nÃ y sáº½ tráº£ vá» values[0] + values[1] ngay khi resolve (vá»›i giÃ¡ trá»‹ káº¿t quáº£ cá»§a phÃ©p cá»™ng). Do Ä‘Ã³ lá»i gá»i .then(â€¦) ta Ä‘áº·t á»Ÿ cuá»‘i hÃ m .sum(â€¦), tá»©c lÃ  cuá»‘i Ä‘oáº¡n code, thá»±c ra lÃ  xá»­ lÃ½ trÃªn giÃ¡ trá»‹ tráº£ vá» cá»§a promise thá»© 2 hÆ¡n lÃ  promise thá»© nháº¥t Ä‘Æ°á»£c táº¡o ra bá»Ÿi Promise.all([ â€¦ ]). Máº·c dÃ¹ váº­y thÃ¬ chÃºng ta khÃ´ng chain-call vÃ o cuá»‘i hÃ m .then(â€¦) sau vÃ¬ lÃ m váº­y sáº½ táº¡o thÃªm 1 promise vÃ  ta láº¡i pháº£i xá»­ lÃ½ nÃ³. Pháº§n Promise chain-call nÃ y sáº½ Ä‘Æ°á»£c giáº£i thÃ­ch ká»¹ hÆ¡n á»Ÿ cÃ¡c pháº§n sau trong chÆ°Æ¡ng nÃ y. Vá»›i Promise, lá»i gá»i .then(â€¦) cÃ³ thá»ƒ nháº­n 2 hÃ m param, hÃ m thá»© nháº¥t lÃ  Ä‘á»ƒ thá»±c hiá»‡n thao tÃ¡c vá»›i response hoÃ n thÃ nh (nhÆ° trÃªn), hÃ m thá»© 2 lÃ  vá»›i trÆ°á»ng há»£p bá»‹ lá»—i vÃ  bÃ¡c bá» (rejection). 1234567891011sum(fetchX(), fetchY()).then( // HÃ m xá»­ lÃ½ hoÃ n thÃ nh function(sum) &#123; console.log( sum ); &#125;, // HÃ m xá»­ lÃ½ bÃ¡c bá» function(err) &#123; console.error( err ); // bummer! &#125;); Náº¿u cÃ³ gÃ¬ Ä‘Ã³ khÃ´ng Ä‘Ãºng trong quÃ¡ trÃ¬nh get x vÃ  y hoáº·c lÃ  cÃ³ sai sÃ³t khÃ¡c thÃ¬ promise mÃ  .sum(â€¦) tráº£ vá» sáº½ bá»‹ reject, hÃ m callback thá»© 2 xá»­ lÃ½ lá»—i Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº©y vÃ o .then(â€¦) sáº½ nháº­n giÃ¡ trá»‹ reject tá»« promise. Bá»Ÿi vÃ¬ promise Ä‘Ã³ng gÃ³i tráº¡ng thÃ¡i Ä‘á»™c láº­p thá»i gian tá»« bÃªn ngoÃ i - chá» cho giÃ¡ trá»‹ Ä‘Æ°á»£c xá»­ lÃ½ hoÃ n thÃ nh/reject, vÃ  báº£n thÃ¢n promise Ä‘Ã£ lÃ  Ä‘á»™c láº­p thá»i gian, do Ä‘Ã³ nhiá»u promise cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p vá»›i nhau theo nhá»¯ng cÃ¡ch cÃ³ thá»ƒ Ä‘oÃ¡n trÆ°á»›c Ä‘Æ°á»£c báº¥t ká»ƒ lÃ  thá»i gian hay káº¿t quáº£. HÆ¡n ná»¯a, má»™t khi promise Ä‘Æ°á»£c resolve thÃ¬ nÃ³ sáº½ tá»“n táº¡i vÄ©nh viá»…n: nÃ³ trá»Ÿ thÃ nh má»™t giÃ¡ trá»‹ báº¥t biáº¿n táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³, vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c láº¥y ra sá»­ dá»¥ng bao nhiÃªu láº§n cÅ©ng Ä‘Æ°á»£c Thá»±c sá»± lÃ  ráº¥t há»¯u Ã­ch khi ta ná»‘i promise thanhf 1 chuá»—i: 12345678910111213141516171819function delay(time) &#123; return new Promise(function(resolve, reject)&#123; setTimeout(resolve, time); &#125;);&#125;delay(1000).then(function()&#123; console.log(\"after 1000ms\"); return delay(2000);&#125;).then(function()&#123; console.log(\"after another 2000ms\");&#125;).then(function()&#123; console.log(\"step 4 (next Job)\"); return delay(5000);&#125;)// ... Gá»i hÃ m delay(2000) sáº½ táº¡o ra 1 promise mÃ  nÃ³ Ä‘Æ°á»£c hoÃ n thÃ nh trong 2000ms, sau Ä‘Ã³ tráº£ nÃ³ vá» tá»« hÃ m hoÃ n thÃ nh trong .then() Ä‘áº§u tiÃªn, Ä‘iá»u nÃ y lÃ m cho hÃ m .then(â€¦) thá»© hai sáº½ chá» 2000ms LÆ°u Ã½: Bá»Ÿi vÃ¬ giÃ¡ promise lÃ  báº¥t biáº¿n sau khi Ä‘Ã£ Ä‘Æ°á»£c resolve, chÃºng ta cÃ³ thá»ƒ truyá»n nÃ³ Ä‘i kháº¯p nÆ¡i mÃ  khÃ´ng cáº§n lo láº¯ng vá» viá»‡c nÃ³ báº¥t ngá» bá»‹ thay Ä‘á»•i. Äiá»u nÃ y Ä‘áº·c biá»‡t cÃ³ Ã­ch khi cÃ³ nhiá»u Ä‘oáº¡n code cÃ¹ng sá»­ dá»¥ng káº¿t quáº£ cá»§a 1 promise. TÃ­nh báº¥t biáº¿n nghe cÃ³ váº» nhÆ° lÃ  má»™t chá»§ Ä‘á» liÃªn quan Ä‘áº¿n há»c thuáº­t, nhÆ°ng tháº­t ra nÃ³ lÃ  1 pháº§n ráº¥t cÆ¡ báº£n vÃ  cÃ³ khÃ­a cáº¡nh quan trá»ng trong thiáº¿t káº¿ promise mÃ  ta khÃ´ng nÃªn bá» qua. Promise hay khÃ´ng Promise ?Má»™t chi tiáº¿t quan trá»ng vá» promise lÃ  pháº£i biáº¿t má»™t giÃ¡ trá»‹ thá»±c sá»± lÃ  promise hay khÃ´ng pháº£i. NÃ³i cÃ¡ch khÃ¡c, Ä‘Ã³ cÃ³ pháº£i lÃ  1 giÃ¡ trá»‹ sáº½ hÃ nh xá»­ nhÆ° 1 promise? ChÃºng ta biáº¿t ráº±ng promise Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng lá»‡nh new Promise(â€¦), vÃ  báº¡n cho ráº±ng p instanceof Promise lÃ  Ä‘á»§ Ä‘á»ƒ kiá»ƒm tra? Thá»±c ra thÃ¬ khÃ´ng háº³n. Chá»§ yáº¿u bá»Ÿi vÃ¬ báº¡n cÃ³ thá»ƒ nháº­n giÃ¡ trá»‹ promise tá»« má»™t cá»­a sá»• trÃ¬nh duyá»‡t khÃ¡c (vÃ­ dá»¥: iframe), nÃ³ sáº½ cÃ³ promise riÃªng cá»§a nÃ³, khÃ¡c vá»›i promise trong cá»­a sá»•/frame hiá»‡n táº¡i cá»§a báº¡n, vÃ  cÃ¢u lá»‡nh check á»Ÿ trÃªn sáº½ fail khi xÃ¡c Ä‘á»‹nh instance cá»§a promise. HÆ¡n ná»¯a, má»™t thÆ° viá»‡n hay framework cÃ³ thá»ƒ sá»­ dá»¥ng promise cá»§a riÃªng nÃ³ mÃ  khÃ´ng dÃ¹ng promise máº·c Ä‘á»‹nh cá»§a ES6. Tháº­t ra, báº¡n cÃ³ thá»ƒ dÃ¹ng promise cá»§a thÆ° viá»‡n trÃªn nhá»¯ng trÃ¬nh duyá»‡t cÅ© khÃ´ng há»— trá»£ promise. Nuá»‘t chá»­ng ngoáº¡i lá»‡ (exception)Náº¿u trong quÃ¡ trÃ¬nh táº¡o promise hoáº·c lÃ  khi tiáº¿p nháº­n káº¿t quáº£ tá»« nÃ³, má»™t lá»—i biá»‡t lá»‡ JS xáº£y ra, vÃ­ dá»¥ nhÆ° TypeError hoáº·c ReferenceError, exception sáº½ Ä‘Æ°á»£c báº¯t, khi Ä‘Ã³ nÃ³ sáº½ Ã©p (force) cho promise Ä‘ang cháº¡y bá»‹ reject. VÃ­ dá»¥: 1234567891011121314var p = new Promise(function(resolve, reject)&#123; foo.bar(); // `foo` chÆ°a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a, lá»—i! resolve(374); // Code sáº½ khÃ´ng Ä‘áº¿n Ä‘Æ°á»£c Ä‘Ã¢y :(&#125;);p.then( function fulfilled()&#123; // khÃ´ng Ä‘áº¿n Ä‘Ã¢y luÃ´n :( &#125;, function rejected(err)&#123; // `err` sáº½ lÃ  má»™t object cá»§a exception`TypeError` // tá»« dÃ²ng `foo.bar()`. &#125;); NhÆ°ng náº¿u nhÆ° má»™t promise Ä‘Æ°á»£c hoÃ n thÃ nh nhÆ°ng cÃ³ lá»—i exception JS trong quÃ¡ trÃ¬nh tiáº¿p nháº­n (vÃ­ dá»¥ nhÆ° trong callback cá»§a .then(â€¦) )? Ká»ƒ cáº£ nhÆ° tháº¿ thÃ¬ nÃ³ cÅ©ng khÃ´ng bá»‹ máº¥t, báº¡n sáº½ tháº¥y má»™t chÃºt ngáº¡c nhiÃªn khi biáº¿t cÃ¡ch mÃ  chÃºng Ä‘Æ°á»£c xá»­ lÃ½. ÄÃ o sÃ¢u thÃªm 1 tÃ­ nÃ o: 123456789101112var p = new Promise( function(resolve,reject)&#123; resolve(374);&#125;);p.then(function fulfilled(message)&#123; foo.bar(); console.log(message); // khÃ´ng Ä‘áº¿n Ä‘Æ°á»£c Ä‘Ã¢y nÃ¨.&#125;, function rejected(err)&#123; // khÃ´ng Ä‘áº¿n Ä‘Æ°á»£c Ä‘Ã¢y nÃ¨. &#125;); CÃ³ váº» nhÆ° exception tá»« foo.bar() thá»±c sá»± Ä‘Ã£ bá»‹ nuá»‘t trÃ´i (swallow). ÄÃºng lÃ  nhÆ° tháº¿. CÃ³ gÃ¬ Ä‘Ã³ sÃ¢u hÆ¡n bÃªn trong Ä‘Ã£ hoáº¡t Ä‘á»™ng sai tuy nhiÃªn chÃºng ta láº¡i khÃ´ng biáº¿t. Lá»i gá»i p.then(â€¦) cho chÃ­nh nÃ³ tráº£ vá» 1 promise khÃ¡c vÃ  nÃ³ sáº½ bá»‹ reject vá»›i ReferenceError exception. Xá»­ lÃ½ nhá»¯ng biá»‡t lá»‡ khÃ´ng bá»‹ báº¯t (Uncaught exception)CÃ³ nhiá»u cÃ¡ch tiáº¿p cáº­n khÃ¡c mÃ  nhiá»u ngÆ°á»i cho ráº±ng sáº½ tá»‘t hÆ¡n. Má»™t Ä‘á» nghá»‹ phá»• biáº¿n Ä‘Ã³ lÃ  promise nÃªn cÃ³ thÃªm má»™t phÆ°Æ¡ng thá»©c done(â€¦), nÃ³ sáº½ Ä‘Ã¡nh dáº¥u chuá»—i promise lÃ  Ä‘Ã£ xong (done). .done(â€¦)khÃ´ng táº¡o ra vÃ  tráº£ vá» má»™t promise vÃ¬ tháº¿ callback truyá»n qua .done(â€¦) rÃµ rÃ ng lÃ  khÃ´ng liÃªn quan Ä‘áº¿n viá»‡c bÃ¡o cÃ¡o cÃ¡c váº¥n Ä‘á» xáº£y ra vá»›i má»™t chuá»—i promise khÃ´ng tá»“n táº¡i. NÃ³ hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° báº¡n Ä‘Ã£ biáº¿t trong cÃ¡c Ä‘iá»u kiá»‡n uncaught error: cÃ¡c exception bÃªn trong má»™t hÃ m reject trong .done(â€¦) sáº½ bá»‹ báº¯n ra ngoÃ i developer console dÆ°á»›i dáº¡ng global uncaught error. 12345678910var p = Promise.resolve(374);p.then(function fulfilled(msg)&#123; // Sá»‘ number khÃ´ng cÃ³ hÃ m cá»§a string, // nÃªn sáº½ báº¯n ra lá»—i console.log(msg.toLowerCase());&#125;).done(null, function() &#123; // Náº¿u cÃ³ uncaught exception á»Ÿ Ä‘Ã¢y thÃ¬ nÃ³ sáº½ bá»‹ báº¯n ra nhÆ° lÃ  má»™t global exception&#125;); Äiá»u gÃ¬ xáº£y ra trong ES8 vÃ  Async/awaitJavascript ES8 giá»›i thiá»‡u async/await Ä‘á»ƒ giÃºp cho cÃ´ng viá»‡c xá»­ lÃ½ promise dá»… dÃ ng hÆ¡n. ChÃºng ta sáº½ lÆ°á»›t sÆ¡ qua nhá»¯ng kháº£ nÄƒng mÃ  async/await cung cáº¥p vÃ  xem thá»­ lÃ m tháº¿ nÃ o Ä‘á»ƒ dÃ¹ng chÃºng Ä‘á»ƒ viáº¿t code báº¥t Ä‘á»“ng bá»™ má»™t cÃ¡ch phÃ¹ há»£p. Váº­y thÃ¬ Ä‘áº§u tiÃªn lÃ  xem thá»­ hoáº¡t Ä‘á»™ng cá»§a async/await. Báº¡n Ä‘á»‹nh nghÄ©a má»™t hÃ m báº¥t Ä‘á»“ng bá»™ sá»­ dá»¥ng Ä‘á»‹nh nghÄ©a hÃ m async. Nhá»¯ng hÃ m nhÆ° váº­y sáº½ tráº£ vá» object AsyncFunction. Object AsyncFunction biá»ƒu diá»…n hÃ m báº¥t Ä‘á»“ng bá»™ trong Ä‘Ã³ nÃ³ thá»±c thi code bÃªn trong nÃ³. Khi má»™t hÃ m async Ä‘Æ°á»£c gá»i, nÃ³ sáº½ tráº£ vá» Promise. Khi hÃ m async tráº£ vá» giÃ¡ trá»‹, nÃ³ láº¡i khÃ´ng pháº£i promise, má»™t promise sáº½ Ä‘Æ°á»£c táº¡o ra tá»± Ä‘á»™ng vÃ  Ä‘Æ°á»£c phÃ¢n giáº£i (resolve) vá»›i giÃ¡ trá»‹ tráº£ vá» tá»« hÃ m. Khi hÃ m async báº¯n ra exception, promise sáº½ reject vá»›i giÃ¡ trá»‹ báº¯n ra. Má»™t hÃ m async cÃ³ thá»ƒ chá»©a thá»ƒ hiá»‡n await, nÃ³ sáº½ dá»«ng quÃ¡ trÃ¬nh thá»±c thi cá»§a hÃ m vÃ  Ä‘á»£i cho promise giáº£i quyáº¿t xong rá»“i quay láº¡i thá»±c thi tiáº¿p vÃ  tráº£ vá» giÃ¡ trá»‹ Ä‘Ã£ Ä‘Æ°á»£c resolve. Báº¡n cÃ³ thá»ƒ xem nhÆ° promise trong JS tÆ°Æ¡ng tá»± vá»›i Java Future hay C# Task. Má»¥c Ä‘Ã­ch cá»§a async/await lÃ  lÃ m Ä‘Æ¡n giáº£n hÃ³a quÃ¡ trÃ¬nh sá»­ dá»¥ng promise. Xem vÃ­ dá»¥ sau: 12345678// HÃ m JS bÃ¬nh thÆ°á»ngfunction getNumber1() &#123; return Promise.resolve('374');&#125;// Giá»‘ng nhÆ° hÃ m trÃªnasync function getNumber2() &#123; return 374;&#125; TÆ°Æ¡ng tá»±, nhá»¯ng hÃ m báº¯n ra exception tÆ°Æ¡ng tá»± vá»›i nhá»¯ng hÃ m tráº£ vá» promise bá»‹ reject: 123456function f1() &#123; return Promise.reject('Some error');&#125;async function f2() &#123; throw 'Some error';&#125; Tá»« khÃ³a await chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng bÃªn trong hÃ m async vÃ  cho phÃ©p báº¡n chá» promise má»™t cÃ¡ch Ä‘á»“ng bá»™. Náº¿u chÃºng ta sá»­ dá»¥ng promise bÃªn ngoÃ i má»™t hÃ m async thÃ¬ pháº£i dÃ¹ng tá»›i callback: 1234567891011121314async function loadData() &#123; // `rp` lÃ  má»™t hÃ m gá»i promise. var promise1 = rp('https://api.example.com/endpoint1'); var promise2 = rp('https://api.example.com/endpoint2'); // Hiá»‡n táº¡i cáº£ 2 request Ä‘á»u Ä‘Æ°á»£c gá»i Ä‘á»“ng thá»i vÃ  // ta pháº£i Ä‘á»£i cho nÃ³ hoÃ n thÃ nh. var response1 = await promise1; var response2 = await promise2; return response1 + ' ' + response2;&#125;// Bá»Ÿi vÃ¬ ta khÃ´ng á»Ÿ trong hÃ m `async` // nÃªn chÃºng ta pháº£i dÃ¹ng `then()`.loadData().then(() =&gt; console.log('Done')); Báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a hÃ m async báº±ng cÃ¡ch sá»­ dá»¥ng async function expression (AFE - Thá»ƒ hiá»‡n hÃ m async). Má»™t AFE tÆ°Æ¡ng tá»± vÃ  gáº§n giá»‘ng nhÆ° má»™t async function statement (AFS). Äiá»ƒm khÃ¡c biá»‡t chÃ­nh giá»¯a AFE vÃ  AFS lÃ  tÃªn cá»§a hÃ m, trong AFE ta cÃ³ thá»ƒ bá» qua tÃªn Ä‘á»ƒ táº¡o hÃ m vÃ´ danh (anonymous function). Má»™t AFE cÃ³ thá»ƒ sá»­ dá»¥ng nhÆ° má»™t IIFE (Immediately Invoked Function Expression), loáº¡i hÃ m Ä‘Æ°á»£c thá»±c thi ngay sau khi nÃ³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a. NÃ³ trÃ´ng nhÆ° tháº¿ nÃ y: 1234567891011var loadData = async function() &#123; // `rp` lÃ  má»™t hÃ m gá»i promise. var promise1 = rp('https://api.example.com/endpoint1'); var promise2 = rp('https://api.example.com/endpoint2'); // Hiá»‡n táº¡i cáº£ 2 request Ä‘á»u Ä‘Æ°á»£c gá»i Ä‘á»“ng thá»i vÃ  // ta pháº£i Ä‘á»£i cho nÃ³ hoÃ n thÃ nh. var response1 = await promise1; var response2 = await promise2; return response1 + ' ' + response2;&#125; Quan trá»ng lÃ  async/await Ä‘Æ°á»£c há»— trá»£ vÃ  cÃ³ thá»ƒ cháº¡y trÃªn Ä‘a sá»‘ cÃ¡c trÃ¬nh duyá»‡t: Náº¿u nhÆ° trÃ¬nh duyá»‡t nÃ o khÃ´ng há»— trá»£ thÃ¬ ta váº«n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c JS transpiler nhÆ° Babel hay TypeScript Cuá»‘i cÃ¹ng thÃ¬ Ä‘iá»u quan trá»ng nháº¥t lÃ  khÃ´ng nÃªn chá»n lá»±a má»™t cÃ¡ch mÃ¹ quÃ¡ng nhá»¯ng cÃ¡ch tiáº¿p cáº­n â€œmá»›i nháº¥tâ€ Ä‘á»ƒ viáº¿t code báº¥t Ä‘á»“ng bá»™. Tá»‘t hÆ¡n lÃ  báº¡n hiá»ƒu vá» cáº¥u trÃºc báº¥t Ä‘á»“ng bá»™ cá»§a JS, nghiÃªn cá»©u táº¡i sao nÃ³ láº¡i lÃ  má»™t váº¥n Ä‘á» nghiÃªm tÃºc vÃ  hiá»ƒu má»™t cÃ¡ch sÃ¢u sáº¯c vá» cÃ¡c thÃ nh pháº§n bÃªn trong cá»§a giáº£i phÃ¡p mÃ  báº¡n lá»±a chá»n. Má»—i cÃ¡ch tiáº¿p cáº­n khÃ¡c nhau Ä‘á»u cÃ³ nhá»¯ng Ä‘iá»ƒm máº¡nh vÃ  Ä‘iá»ƒm yáº¿u, hÃ£y cÃ¢n nháº¯c. 5 máº¹o Ä‘á»ƒ viáº¿t code báº¥t Ä‘á»“ng bá»™ vá»«a cháº¯c cháº¯n vá»«a dá»… báº£o trÃ¬1. Clean code (code sáº¡ch):Sá»­ dá»¥ng async/await cho phÃ©p báº¡n viáº¿t code Ã­t hÆ¡n nhiá»u. Má»—i láº§n sá»­ dá»¥ng async/await báº¡n cÃ³ thá»ƒ bá» qua má»™t sá»‘ bÆ°á»›c khÃ´ng cáº§n thiáº¿t, vÃ­ dá»¥: .then(), viáº¿t hÃ m anonymous Ä‘á»ƒ xá»­ lÃ½ responsive, Ä‘áº·t tÃªn response tá»« callbackâ€¦ 1234// `rp` lÃ  má»™t hÃ m gá»i promiserp(â€˜https://api.example.com/endpoint1').then(function(data) &#123; // â€¦&#125;); â€¦so vá»›i 12// `rp` lÃ  má»™t hÃ m gá»i promisevar response = await rp(â€˜https://api.example.com/endpoint1'); 2. Xá»­ lÃ½ lá»—i:Async/await giÃºp chÃºng ta cÃ³ thá»ƒ xá»­ lÃ½ cáº£ lá»—i Ä‘á»“ng bá»™ vÃ  báº¥t Ä‘á»“ng bá»™ vá»›i cÃ¹ng má»™t cáº¥u trÃºc code: chÃ­nh lÃ  try/catch ná»•i tiáº¿ng. VÃ­ dá»¥: 123456789101112function loadData() &#123; try &#123; // Catches synchronous errors. getJSON().then(function(response) &#123; var parsed = JSON.parse(response); console.log(parsed); &#125;).catch(function(e) &#123; // Catches asynchronous errors console.log(e); &#125;); &#125; catch(e) &#123; console.log(e); &#125;&#125; â€¦so vá»›i 12345678async function loadData() &#123; try &#123; var data = JSON.parse(await getJSON()); console.log(data); &#125; catch(e) &#123; console.log(e); &#125;&#125; 3. Äiá»u kiá»‡n:Viáº¿t code Ä‘iá»u kiá»‡n vá»›i async/await rÃµ rÃ ng hÆ¡n ráº¥t nhiá»u: 123456789101112131415function loadData() &#123; return getJSON() .then(function(response) &#123; if (response.needsAnotherRequest) &#123; return makeAnotherRequest(response) .then(function(anotherResponse) &#123; console.log(anotherResponse) return anotherResponse &#125;) &#125; else &#123; console.log(response) return response &#125; &#125;)&#125; â€¦so vá»›i 1234567891011async function loadData() &#123; var response = await getJSON(); if (response.needsAnotherRequest) &#123; var anotherResponse = await makeAnotherRequest(response); console.log(anotherResponse) return anotherResponse &#125; else &#123; console.log(response); return response; &#125;&#125; 4. Stack Frames:KhÃ´ng giá»‘ng nhÆ° async/await, stack lá»—i tráº£ vá» tá»« má»™t chuá»—i promise lÃ m chÃºng ta khÃ´ng biáº¿t lá»—i xuáº¥t phÃ¡t tá»« Ä‘Ã¢u mÃ  láº§n: 1234567891011121314function loadData() &#123; return callAPromise() .then(callback1) .then(callback2) .then(callback3) .then(() =&gt; &#123; throw new Error(\"boom\"); &#125;)&#125;loadData() .catch(function(e) &#123; console.log(err);// Error: boom at callAPromise.then.then.then.then (index.js:8:13)&#125;); â€¦so vá»›i 1234567891011121314async function loadData() &#123; await callAPromise1() await callAPromise2() await callAPromise3() await callAPromise4() await callAPromise5() throw new Error(\"boom\");&#125;loadData() .catch(function(e) &#123; console.log(err); // output // Error: boom at loadData (index.js:7:9)&#125;); 5. QuÃ¡ trÃ¬nh Debug:Náº¿u báº¡n Ä‘Ã£ tá»«ng sá»­ dá»¥ng promise, báº¡n sáº½ biáº¿t ráº±ng debug vá»›i chÃºng thá»±c sá»± lÃ  Ã¡c má»™ng. Giáº£ sá»­ báº¡n Ä‘áº·t breakpoint bÃªn trong .then() vÃ  dÃ¹ng nhá»¯ng lá»‡nh debug nhÆ° stop-over, debugger sáº½ khÃ´ng Ä‘i Ä‘áº¿n .then() tiáº¿p theo bá»Ÿi vÃ¬ nÃ³ â€œlá»¡ chÃ¢nâ€ bÆ°á»›c vÃ o code báº¥t Ä‘á»“ng bá»™.Vá»›i async/await báº¡n cÃ³ thá»ƒ duyá»‡t qua nhá»¯ng lá»i gá»i await chÃ­nh xÃ¡c nhÆ° nhá»¯ng hÃ m Ä‘á»“ng bá»™ thÃ´ng thÆ°á»ng. Viáº¿t code Javascript báº¥t Ä‘á»“ng bá»™ lÃ  ráº¥t quan trá»ng khÃ´ng chá»‰ cho app mÃ  cáº£ cho nhá»¯ng thÆ° viá»‡n ná»¯a.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P3: Quáº£n lÃ½ bá»™ nhá»› & 4 trÆ°á»ng há»£p memory leaks phá»• biáº¿n","slug":"Cach-Javascript-hoat-dong-P3-Quan-ly-bo-nho-4-truong-hop-memory-leaks-pho-bien","date":"2018-11-13T16:03:00.000Z","updated":"2018-11-13T16:05:48.137Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P3-Quan-ly-bo-nho-4-truong-hop-memory-leaks-pho-bien.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P3-Quan-ly-bo-nho-4-truong-hop-memory-leaks-pho-bien.html","excerpt":"Máº¥y hÃ´m trÆ°á»›c chÃºng ta Ä‘Ã£ báº¯t Ä‘áº§u series bÃ i viáº¿t Ä‘á»¥c khoÃ©t vá» Javascript vÃ  cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o, báº±ng cÃ¡ch hiá»ƒu vá» nhá»¯ng thÃ nh pháº§n cÆ¡ báº£n vÃ  cÃ¡ch chÃºng tÆ°Æ¡ng tÃ¡c vá»›i nhau thÃ¬ chÃºng ta cÃ³ thá»ƒ viáº¿t code tá»‘t hÆ¡n vÃ  ngon hÆ¡n. BÃ i Ä‘áº§u tiÃªn lÃ  tá»•ng quan vá» series, cung cáº¥p cÃ¡i nhÃ¬n toÃ n cáº£nh vá» engine, runtime &amp; callstack. BÃ i thá»© 2 lÃ  má»™t cÃ¡i nhÃ¬n cá»¥ thá»ƒ hÆ¡n vá» nhá»¯ng thÃ nh pháº§n bÃªn trong cá»§a bá»™ engine V8 cá»§a Google vÃ  má»™t sá»‘ máº¹o váº·t Ä‘á»ƒ tá»‘i Æ°u Javascript code. á» bÃ i thá»© 3 nÃ y, chÃºng ta sáº½ tháº£o luáº­n vá» má»™t váº¥n Ä‘á» khÃ´ng kÃ©m pháº§n quan trá»ng nhÆ°ng láº¡i thÆ°á»ng bá»‹ cÃ¡c dev bá» qua do sá»± phá»©c táº¡p ngÃ y cÃ ng gia tÄƒng cá»§a cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh thÆ°á»ng dÃ¹ng: quáº£n lÃ½ bá»™ nhá»›. ChÃºng ta cÅ©ng sáº½ tÃ¬m hiá»ƒu má»™t sá»‘ máº¹o Ä‘á»ƒ cÃ³ thá»ƒ xá»­ lÃ½ nhá»¯ng trÆ°á»ng há»£p rÃ² rÃ¬ bá»™ nhá»› cá»§a Javascript mÃ  team SesstionStack Ä‘Ã£ Ã¡p dá»¥ng Ä‘á»ƒ trÃ¡nh bá»‹ rÃ² rá»‰ vÃ  khÃ´ng lÃ m tá»‘n bá»™ nhá»› cá»§a webapp.","text":"Máº¥y hÃ´m trÆ°á»›c chÃºng ta Ä‘Ã£ báº¯t Ä‘áº§u series bÃ i viáº¿t Ä‘á»¥c khoÃ©t vá» Javascript vÃ  cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o, báº±ng cÃ¡ch hiá»ƒu vá» nhá»¯ng thÃ nh pháº§n cÆ¡ báº£n vÃ  cÃ¡ch chÃºng tÆ°Æ¡ng tÃ¡c vá»›i nhau thÃ¬ chÃºng ta cÃ³ thá»ƒ viáº¿t code tá»‘t hÆ¡n vÃ  ngon hÆ¡n. BÃ i Ä‘áº§u tiÃªn lÃ  tá»•ng quan vá» series, cung cáº¥p cÃ¡i nhÃ¬n toÃ n cáº£nh vá» engine, runtime &amp; callstack. BÃ i thá»© 2 lÃ  má»™t cÃ¡i nhÃ¬n cá»¥ thá»ƒ hÆ¡n vá» nhá»¯ng thÃ nh pháº§n bÃªn trong cá»§a bá»™ engine V8 cá»§a Google vÃ  má»™t sá»‘ máº¹o váº·t Ä‘á»ƒ tá»‘i Æ°u Javascript code. á» bÃ i thá»© 3 nÃ y, chÃºng ta sáº½ tháº£o luáº­n vá» má»™t váº¥n Ä‘á» khÃ´ng kÃ©m pháº§n quan trá»ng nhÆ°ng láº¡i thÆ°á»ng bá»‹ cÃ¡c dev bá» qua do sá»± phá»©c táº¡p ngÃ y cÃ ng gia tÄƒng cá»§a cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh thÆ°á»ng dÃ¹ng: quáº£n lÃ½ bá»™ nhá»›. ChÃºng ta cÅ©ng sáº½ tÃ¬m hiá»ƒu má»™t sá»‘ máº¹o Ä‘á»ƒ cÃ³ thá»ƒ xá»­ lÃ½ nhá»¯ng trÆ°á»ng há»£p rÃ² rÃ¬ bá»™ nhá»› cá»§a Javascript mÃ  team SesstionStack Ä‘Ã£ Ã¡p dá»¥ng Ä‘á»ƒ trÃ¡nh bá»‹ rÃ² rá»‰ vÃ  khÃ´ng lÃ m tá»‘n bá»™ nhá»› cá»§a webapp. Tá»•ng quanNhá»¯ng ngÃ´n ngá»¯ nhÆ° C cÃ³ bá»™ quáº£n lÃ½ bá»™ nhá»› level tháº¥p khÃ¡ cÆ¡ báº£n lÃ  malloc() vÃ  free(). Nhá»¯ng phÆ°Æ¡ng thá»©c nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº¥p phÃ¡t má»™t cÃ¡ch tÆ°á»ng minh vÃ  giáº£i phÃ³ng bá»™ nhá»› trÃªn há»‡ Ä‘iá»u hÃ nh. Má»™t cÃ¡ch tÆ°Æ¡ng tá»±, Javascript cáº¥p phÃ¡t bá»™ nhá»› khi object, string, â€¦ Ä‘Æ°á»£c táº¡o ra vÃ  tá»± Ä‘á»™ng giáº£i phÃ³ng nÃ³ má»—i khi khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a bá»Ÿi má»™t tiáº¿n trÃ¬nh dá»n rÃ¡c (garbage collection). QuÃ¡ trÃ¬nh giáº£i phÃ³ng tÃ i nguyÃªn má»™t cÃ¡ch tá»± Ä‘á»™ng hÃ³a nhÆ° tháº¿ nÃ y gÃ¢y ra sá»± nháº§m láº«n vÃ  lÃ m cho Javascript (vÃ  nhá»¯ng ngÃ´n ngá»¯ báº­c cao khÃ¡c) developer cáº£m tháº¥y â€œáº¥n tÆ°á»£ngâ€ nÃªn há» thÆ°á»ng bá» qua váº¥n Ä‘á» quáº£n lÃ½ bá»™ nhá»›. ÄÃ¢y lÃ  má»™t sai láº§m lá»›n. Ká»ƒ cáº£ khi lÃ m viá»‡c vá»›i ngÃ´n ngá»¯ báº­c cao, developer cÅ©ng nÃªn hiá»ƒu vá» váº¥n Ä‘á» quáº£n lÃ½ bá»™ nhá»› (Ã­t nháº¥t lÃ  nhá»¯ng thá»© cÆ¡ báº£n). Thá»‰nh thoáº£ng cÃ³ nhá»¯ng váº¥n Ä‘á» xáº£y ra vá»›i quáº£n lÃ½ bá»™ nhá»› tá»± Ä‘á»™ng (bug hay sá»± giá»›i háº¡n thá»±c hiá»‡n trong GCâ€¦) mÃ  developer cáº§n pháº§n hiá»ƒu Ä‘á»ƒ cÃ³ thá»ƒ xá»­ lÃ½ má»™t cÃ¡ch Ä‘Ãºng Ä‘áº¯n (hoáº·c tÃ¬m cÃ¡ch â€œÄ‘i Ä‘Æ°á»ng vÃ²ngâ€ vÆ°á»£t qua nÃ³ vá»›i Ã­t thiá»‡t háº¡i nháº¥t). VÃ²ng Ä‘á»i cá»§a bá»™ nhá»›DÃ¹ cho báº¡n Ä‘ang dÃ¹ng ngÃ´n ngá»¯ láº­p trÃ¬nh nÃ o Ä‘i ná»¯a thÃ¬ vÃ²ng Ä‘á»i bá»™ nhá»› háº§u nhÆ° Ä‘á»u giá»‘ng nhau: ÄÃ¢y lÃ  nhá»¯ng gÃ¬ xáº£y ra á»Ÿ má»—i bÆ°á»›c trong vÃ²ng Ä‘á»i: Cáº¥p phÃ¡t bá»™ nhá»›: bá»™ nhá»› Ä‘Æ°á»£c cáº¥p phÃ¡t bá»Ÿi há»‡ Ä‘iá»u hÃ nh vÃ  cho phÃ©p chÆ°Æ¡ng trÃ¬nh sá»­ dá»¥ng nÃ³. á» ngÃ´n ngá»¯ báº­c tháº¥p (nhÆ° C), Ä‘Ã¢y lÃ  má»™t quÃ¡ trÃ¬nh tÆ°á»ng minh, rÃµ rÃ ng mÃ  developer pháº£i xá»­ lÃ½. Trong cÃ¡c ngÃ´n ngá»¯ báº­c cao thÃ¬ pháº§n nÃ y ngÃ´n ngá»¯ sáº½ lÃ m giÃºp báº¡n. Sá»­ dá»¥ng bá»™ nhá»›: ÄÃ¢y lÃ  thá»i Ä‘iá»ƒm khi chÆ°Æ¡ng tÃ¬nh cá»§a báº¡n sá»­ dá»¥ng nhá»¯ng vÃ¹ng nhá»› Ä‘Ã£ Ä‘Æ°á»£c cáº¥p phÃ¡t trÆ°á»›c Ä‘Ã³. CÃ¡c thao tÃ¡c Äá»c vÃ  Ghi Ä‘Æ°á»£c thá»±c hiá»‡n khi chÃºng ta thá»±c thi nhá»¯ng biáº¿n Ä‘Ã£ Ä‘Æ°á»£c khai bÃ¡o trong code. Giáº£i phÃ³ng bá»™ nhá»›: Giá» lÃ  lÃºc giáº£i phÃ³ng toÃ n bá»™ nhá»¯ng vÃ¹ng nhá»› mÃ  báº¡n khÃ´ng cÃ²n dÃ¹ng Ä‘áº¿n ná»¯a Ä‘á»ƒ sá»­ dá»¥ng láº¡i vá» sau. Giá»‘ng nhÆ° pháº§n cáº¥p phÃ¡t, bÆ°á»›c nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n má»™t cÃ¡ch tÆ°á»ng minh trong cÃ¡c ngÃ´n ngá»¯ báº­c tháº¥p. Äá»ƒ hiá»ƒu thÃªm vá» cÃ¡c khÃ¡i niá»‡m cá»§a callstack vÃ  heap thÃ¬ má»i báº¡n xem láº¡i Pháº§n 1 cá»§a series. Bá»™ nhá»› lÃ  gÃ¬?TrÆ°á»›c khi Ä‘i sÃ¢u vÃ o bá»™ nhá»› cá»§a Javascript, chÃºng ta sáº½ duyá»‡t sÆ¡ qua bá»™ nhá»› cÆ¡ báº£n vÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³. á» pháº§n cá»©ng, bá»™ nhá»› mÃ¡y tÃ­nh bao gá»“m má»™t cÆ¡ sá»‘ cÃ¡c flip flops (Ä‘áº¡i khÃ¡i lÃ  1 tráº¡ng thÃ¡i Ä‘Ã³ng-má»Ÿ). Má»—i flip-flop chá»©a má»™t vÃ i transistor vÃ  cÃ³ thá»ƒ lÆ°u trá»¯ 1 bit thÃ´ng tin. Má»™t flip-flop Ä‘á»™c láº­p cÃ³ thá»ƒ Ä‘Æ°á»£c truy xuáº¥t báº±ng sá»‘ Ä‘á»‹nh danh duy nháº¥t (unique identifier), do Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ Ä‘á»c vÃ  ghi lÃªn chÃºng. VÃ  láº½ dÄ© nhiÃªn, vá» máº·t Ã½ tÆ°á»Ÿng chÃºng ta cÃ³ thá»ƒ cÃ´ng nháº­n ráº±ng toÃ n bá»™ bá»™ nhá»› mÃ¡y tÃ­nh lÃ  1 máº£ng khá»•ng lá»“ cÃ¡c bit cÃ³ thá»ƒ Ä‘á»c &amp; ghi. Vá» pháº§n con ngÆ°á»i thÃ¬ há» khÃ´ng giá»i lÃ m viá»‡c vá»›i bit nÃªn tá»• chá»©c chÃºng vÃ o nhá»¯ng nhÃ³m lá»›n hÆ¡n, 8 bit thÃ nh 1 byte. NgoÃ i byte cÃ²n cÃ³ word (16 hoáº·c 32 bit) CÃ³ ráº¥t nhiá»u thá»© Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»›: Táº¥t cáº£ cÃ¡c biáº¿n vÃ  dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c chÆ°Æ¡ng trÃ¬nh. Code cá»§a chÆ°Æ¡ng trÃ¬nh cháº¡y, ká»ƒ cáº£ code cá»§a há»‡ Ä‘iá»u hÃ nh. TrÃ¬nh biÃªn dá»‹ch vÃ  há»‡ Ä‘iá»u hÃ nh lÃ m viá»‡c vá»›i nhau Ä‘á»ƒ xá»­ lÃ½ háº§u nhÆ° toÃ n bá»™ pháº§n quáº£n lÃ½ bá»™ nhá»› nhÆ°ng chÃºng tÃ´i khuyáº¿n cÃ¡o báº¡n nÃªn cÃ³ cÃ¡i nhÃ¬n sÆ¡ lÆ°á»£c vá» nhá»¯ng gÃ¬ xáº£y ra á»Ÿ ná»™i bá»™ bÃªn trong. Khi biÃªn dá»‹ch code, trÃ¬nh biÃªn dá»‹ch sáº½ xem xÃ©t cÃ¡c kiá»ƒu dá»¯ liá»‡u nguyÃªn thá»§y (string, number, booleanâ€¦) vÃ  tÃ­nh toÃ¡n trÆ°á»›c bao nhiÃªu bá»™ nhá»› mÃ  chÃºng cáº§n sá»­ dá»¥ng. LÆ°á»£ng bá»™ nhá»› cáº§n thiáº¿t sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c cáº¥p phÃ¡t cho chÆ°Æ¡ng tÃ¬nh trong khÃ´ng gian callstack. VÃ¹ng khÃ´ng gian Ä‘Æ°á»£c cáº¥p phÃ¡t Ä‘Æ°á»£c gá»i lÃ  stack space bá»Ÿi vÃ¬ khi gá»i hÃ m, bá»™ nhá»› cá»§a nÃ³ Ä‘Æ°á»£c thÃªm vÃ o vá»‹ trÃ­ trÃªn cÃ¹ng cá»§a bá»™ nhá»› hiá»‡n táº¡i. VÃ  khi há»§y bá», chÃºng bá»‹ gá»¡ bá» theo quy táº¯c LIFO (last-in-first-out, vÃ o sau ra trÆ°á»›c). VÃ­ dá»¥: 123int n; // 4 bytesint x[4]; // máº£ng 4 pháº§n tá»­, má»—i pháº§n tá»­ 4 bytesdouble m; // 8 bytes TrÃ¬nh biÃªn dá»‹ch sáº½ tÃ­nh toÃ¡n ngay láº­p tá»©c Ä‘oáº¡n code nÃ y cáº§n 4 + 4 * 4 + 8 = 28 bytes ÄÃ³ lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a kÃ­ch thÆ°á»›c vÃ¹ng nhá»› cho kiá»ƒu sá»‘ integer vÃ  double. Khoáº£ng 20 nÄƒm trÆ°á»›c, integer lÃ  2 byte vÃ  double lÃ  4 byte. Code cá»§a báº¡n khÃ´ng pháº£i phá»¥ thuá»™c vÃ o kÃ­ch thÆ°á»›c cá»§a cÃ¡c kiá»ƒu dá»¯ liá»‡u cÆ¡ báº£n. TrÃ¬nh biÃªn dá»‹ch sáº½ chÃ¨n code tÆ°Æ¡ng tÃ¡c vá»›i há»‡ Ä‘iá»u hÃ nh Ä‘á»ƒ yÃªu cáº§u sá»‘ lÆ°á»£ng byte cáº§n thiáº¿t Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c biáº¿n. Trong vÃ­ dá»¥ trÃªn, trÃ¬nh biÃªn dá»‹ch biáº¿t chÃ­nh xÃ¡c bao nhiÃªu bá»™ nhá»› cáº§n thiáº¿t cho má»—i biáº¿n. Thá»±c táº¿ thÃ¬ má»—i khi ghi dá»¯ liá»‡u vÃ o biáº¿n n, nÃ³ sáº½ Ä‘Æ°á»£c dá»‹ch ná»™i bá»™ thÃ nh má»™ thá»© Ä‘áº¡i loáº¡i nhÆ° â€œÄ‘á»‹a chá»‰ vÃ¹ng nhá»› 4127963â€ Äá»ƒ Ã½ ráº±ng náº¿u ta thá»­ truy xuáº¥t x[4] thÃ¬ ta sáº½ truy xuáº¥t nháº§m sang dá»¯ liá»‡u Ä‘ang liÃªn káº¿t vá»›i m. Bá»Ÿi vÃ¬ chÃºng ta Ä‘ang cá»‘ truy xuáº¥t vÃ o má»™t pháº§n tá»­ khÃ´ng tá»“n táº¡i trong máº£ng: 4 byte nÃ y náº±m ngoÃ i vÃ¹ng x[3] vá»‘n lÃ  vÃ¹ng nhá»› Ä‘Æ°á»£c cáº¥p phÃ¡t cuá»‘i cÃ¹ng cá»§a máº£ng (index Ä‘Ã¡nh tá»« 0 :v), vÃ  váº­y lÃ  cÃ³ thá»ƒ ta Ä‘á»c/ghi nháº§m sang cÃ¡c bit cá»§a biáº¿n m. Äiá»u nÃ y cÃ³ thá»ƒ gÃ¢y ra nhiá»u háº­u quáº£ khÃ´ng mong muá»‘n cho toÃ n bá»™ chÆ°Æ¡ng trÃ¬nh. Xem hÃ¬nh cho rÃµ hÆ¡n nhÃ©: Khi má»™t hÃ m gá»i má»™t hÃ m khÃ¡c thÃ¬ má»—i hÃ m sáº½ chiáº¿m má»™t pháº§n cá»§a stack. Pháº§n Ä‘Ã³ sáº½ lÆ°u giá»¯ táº¥t cáº£ nhá»¯ng biáº¿n cá»¥c bá»™ cÅ©ng nhÆ° má»™t bá»™ Ä‘áº¿m Ä‘á»ƒ ghi nhá»› vá»‹ trÃ­ mÃ  quÃ¡ trÃ¬nh thá»±c thi cá»§a hÃ m dá»«ng láº¡i. Khi hÃ m káº¿t thÃºc thÃ¬ vÃ¹ng bá»™ nhá»› láº¡i Ä‘Æ°á»£c giáº£i phÃ³ng cho tháº±ng khÃ¡c dÃ¹ng. Cáº¥p phÃ¡t Ä‘á»™ngTháº­t khÃ´ng may lÃ  má»i thá»© dÆ°á»ng nhÆ° khÃ´ng dá»… nhÆ° ta tÆ°á»Ÿng khi mÃ  ta khÃ´ng biáº¿t bao nhiÃªu bá»™ nhá»› 1 biáº¿n cÃ³ thá»ƒ cáº§n táº¡i thá»i Ä‘iá»ƒm thá»±c thi. Giáº£ sá»­ chÃºng ta muá»‘n lÃ m nhÆ° sau: 123int n = readInput(); // Ä‘á»c input tá»« ngÆ°á»i dÃ¹ng...// táº¡o 1 máº£ng vá»›i \"n\" pháº§n tá»­ Táº¡i thá»i Ä‘iá»ƒm biÃªn dá»‹ch, trÃ¬nh biÃªn dá»‹ch khÃ´ng biáº¿t máº£ng sáº½ cáº§n bao nhiÃªu bá»™ nhá»› bá»Ÿi vÃ¬ nÃ³ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi dá»¯ liá»‡u nháº­p vÃ o tá»« phÃ­a ngÆ°á»i dÃ¹ng. VÃ¬ tháº¿ nÃ³ khÃ´ng thá»ƒ cáº¥p phÃ¡t vÃ¹ng nhá»› cho biáº¿n trÃªn stack. Thay vÃ¬ tháº¿, chÆ°Æ¡ng trÃ¬nh cá»§a chÃºng ta cáº§n há»i há»‡ Ä‘iá»u hÃ nh vá» kÃ­ch thÆ°á»›c bá»™ nhá»› phÃ¹ há»£p trong khi thá»±c thi (run-time). VÃ¹ng nhá»› nÃ y Ä‘Æ°á»£c gÃ¡n tá»« khÃ´ng gian heap. Sá»± khÃ¡c biá»‡t giá»¯a cáº¥p phÃ¡t bá»™ nhá»› Ä‘á»™ng vÃ  tÄ©nh Ä‘Æ°á»£c tá»•ng káº¿t trong báº£ng sau: Cáº¥p phÃ¡t tÄ©nh Cáº¥p phÃ¡t Ä‘á»™ng Biáº¿t kÃ­ch thÆ°á»›c táº¡i thá»i Ä‘iá»ƒm biÃªn dá»‹ch. KhÃ´ng biáº¿t kÃ­ch thá»©c lÃºc biÃªn dá»‹ch Thá»±c hiá»‡n lÃºc biÃªn dá»‹ch Thá»±c hiá»‡n lÃºc thá»±c thi (runtime) GÃ¡n vÃ o stack GÃ¡n vÃ o heap GÃ¡n theo thá»© tá»± FILO (first-in-last-out) GÃ¡n khÃ´ng theo thá»© tá»± cá»¥ thá»ƒ nÃ o cáº£ Äá»ƒ cÃ³ thá»ƒ cÃ³ cÃ¡i nhÃ¬n sÃ¢u sáº¯c vá» cáº¥p phÃ¡t bá»™ nhá»› Ä‘á»™ng, cÃ³ thá»ƒ chÃºng ta cáº§n dÃ nh thÃªm thá»i gian tÃ¬m hiá»ƒu vá» con trá», nhÆ°ng nhÆ° váº­y thÃ¬ hÆ¡i bá»‹ láº¡c Ä‘á». Náº¿u báº¡n tháº¥y cÃ³ há»©ng thÃº vá»›i chá»§ Ä‘á» nÃ y thÃ¬ xin lá»—i pháº£i háº¹n báº¡n trong 1 bÃ i viáº¿t khÃ¡c rá»“i. Cáº¥p phÃ¡t trong JavascriptJavascript giÃºp developer giáº£m bá»›t trÃ¡ch nhiá»‡m trong viá»‡c cáº¥p phÃ¡t bá»™ nhá»›. JS tá»± lÃ m háº¿t má»i thá»©. 123456789101112131415var n = 374; // cáº¥p phÃ¡t bá»™ nhá»› cho sá»‘var s = 'sessionstack'; // cáº¥p phÃ¡t cho string var o = &#123; a: 1, b: null&#125;; // cáº¥p phÃ¡t cho object vÃ  cÃ¡c thuá»™c tÃ­nh cá»§a nÃ³var a = [1, null, 'str']; // (giá»‘ng nhÆ° object) cáº¥p phÃ¡t cho // máº£ng vÃ  cÃ¡c giÃ¡ tá»‹ cá»§a nÃ³function f(a) &#123; return a + 3;&#125; // cáº¥p phÃ¡t cho hÃ m (lÃ  1 object cÃ³ thá»ƒ thá»±c thi)// function expressions cÅ©ng cáº¥p phÃ¡t objectsomeElement.addEventListener('click', function() &#123; someElement.style.backgroundColor = 'blue';&#125;, false); Má»™t vÃ i lá»i gá»i hÃ m cÅ©ng tráº£ vá» dáº¡ng cáº¥p phÃ¡t object: 12var d = new Date(); // cáº¥p phÃ¡t Date objectvar e = document.createElement('div'); // cáº¥p phÃ¡t 1 pháº§n tá»­ DOM PhÆ°Æ¡ng thá»©c cÃ³ thá»ƒ cáº¥p phÃ¡t giÃ¡ trá»‹ hoáº·c object: 12345678910var s1 = 'sessionstack';var s2 = s1.substr(0, 3); // s2 lÃ  1 string má»›i// Bá»Ÿi vÃ¬ string lÃ  báº¥t biáº¿n, // JavaScript cÃ³ thá»ƒ chá»n khÃ´ng cáº¥p phÃ¡t bá»™ nhá»›// mÃ  lÆ°u trá»¯ pháº¡m vi [0, 3]var a1 = ['str1', 'str2'];var a2 = ['str3', 'str4'];var a3 = a1.concat(a2); // máº£ng má»›i gá»“m 4 pháº§n tá»­ lÃ // sá»± káº¿t há»£p cá»§a máº£ng a1 vÃ  a2 Sá»­ dá»¥ng bá»™ nhá»› trong JavascriptSá»­ dá»¥ng bá»™ nhá»› Ä‘Ã£ Ä‘Æ°á»£c cáº¥p phÃ¡t trong Javascript cÃ³ thá»ƒ gÃ³i gá»n má»™t cÃ¡ch Ä‘Æ¡n giáº£n trong 2 chá»¯ Ä‘á»c/ghi Viá»‡c nÃ y cÃ³ thá»ƒ thá»±c hiá»‡n báº±ng cÃ¡ch Ä‘á»c/ghi giÃ¡ trá»‹ cá»§a biáº¿n hoáº·c thuá»™c tÃ­nh cá»§a object hoáº·c truyá»n Ä‘á»‘i sá»‘ (argument) vÃ o 1 hÃ m. Giáº£i phÃ³ng khi khÃ´ng dÃ¹ng bá»™ nhá»› ná»¯aÄa sá»‘ cÃ¡c pháº§n Ä‘á» vá» quáº£n lÃ½ bá»™ nhá»› xáº£y ra á»Ÿ giai Ä‘oáº¡n nÃ y. CÃ´ng viá»‡c khÃ³ nháº¥t á»Ÿ Ä‘Ã¢y lÃ  tÃ¬m hiá»ƒu khi nÃ o bá»™ nhá»› Ä‘Ã£ Ä‘Æ°á»£c cáº¥p phÃ¡t cÃ³ cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng hay khÃ´ng. ThÆ°á»ng thÃ¬ nÃ³ yÃªu cáº§u developer xÃ¡c Ä‘á»‹nh vÃ¹ng nhá»› nÃ o trong chÆ°Æ¡ng trÃ¬nh khÃ´ng dÃ¹ng ná»¯a vÃ  giáº£i phÃ³ng nÃ³. NgÃ´n ngá»¯ báº­c cao thÃªm vÃ o 1 chÆ°Æ¡ng tÃ¬nh gá»i lÃ  bá»™ dá»n rÃ¡c (garbage collector - GC) thá»±c hiá»‡n cÃ´ng viá»‡c Ä‘i tÃ¬m nhá»¯ng vÃ¹ng nhá»› Ä‘Ã£ Ä‘Æ°á»£c cáº¥p phÃ¡t vÃ  tÃ¬m hiá»ƒu xem nÃ³ cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng hay khÃ´ng, náº¿u khÃ´ng dÃ¹ng ná»¯a thÃ¬ sáº½ tá»± Ä‘á»™ng giáº£i phÃ³ng nÃ³. Äiá»u hÆ¡i chuá»‘i lÃ  tiáº¿n trÃ¬nh nÃ y chá»‰ tÆ°Æ¡ng Ä‘á»‘i Ä‘Ãºng, bá»Ÿi vÃ¬ váº¥n Ä‘á» tá»•ng quÃ¡t vá» viá»‡c xÃ¡c Ä‘á»‹nh má»™t vÃ¹ng nhá»› cÃ³ cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng hay khÃ´ng lÃ  báº¥t kháº£ thi (khÃ´ng thá»ƒ thá»±c hiá»‡n báº±ng thuáº­t toÃ¡n). Äa sá»‘ GC hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch thu tháº­p nhá»¯ng vÃ¹ng nhá»› khÃ´ng cÃ²n bá»‹ truy xuáº¥t Ä‘áº¿n, vÃ­ dá»¥: táº¥t cáº£ biáº¿n Ä‘ang trá» Ä‘áº¿n nÃ³ Ä‘á»u Ä‘i ra khá»i pháº¡m vi thá»±c thi. Tuy nhiÃªn, Ä‘iá»u nÃ y cÅ©ng láº¡i khÃ´ng háº³n lÃ  chÃ­nh xÃ¡c vÃ¬ táº¡i báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o má»™t Ä‘á»‹a chá»‰ vÃ¹ng nhá»› Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c trá» tá»›i bá»Ÿi 1 biáº¿n, nhÆ°ng biáº¿n Ä‘Ã³ láº¡i khÃ´ng bao giá» Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a. QuÃ¡ trÃ¬nh dá»n rÃ¡cRÃµ rÃ ng cÃ¡ch thá»©c Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c vÃ¹ng nhá»› â€œkhÃ´ng cÃ²n dÃ¹ng ná»¯aâ€ lÃ  báº¥t kháº£ thi cho nÃªn GC thá»±c hiá»‡n má»™t giáº£i phÃ¡p háº¡n cháº¿ cho váº¥n Ä‘á» chung. Pháº§n nÃ y sáº½ giáº£i thÃ­ch nhá»¯ng khÃ¡i niá»‡m cáº§n thiáº¿t Ä‘á»ƒ báº¡n cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c nhá»¯ng thuáº­t toÃ¡n GC vÃ  cÃ¡c giá»›i háº¡n cá»§a chÃºng. Tham chiáº¿u bá»™ nhá»›Ã tÆ°á»Ÿng chÃ­nh cá»§a nhá»¯ng thuáº­t toÃ¡n GC dá»±a trÃªn tham chiáº¿u Trong ngá»¯ cáº£nh quáº£n lÃ½ bá»™ nhá»›, má»™t object A tham chiáº¿u Ä‘áº¿n object B khÃ¡c náº¿u nhÆ° A cÃ³ truy xuáº¥t Ä‘áº¿n B (cÃ³ thá»ƒ tÆ°á»ng minh hoáº·c khÃ´ng tÆ°á»ng minh). VÃ­ dá»¥: má»™t Javascript object cÃ³ tham chiáº¿u Ä‘áº¿n prototype cá»§a chÃ­nh nÃ³ (khÃ´ng tÆ°á»ng minh) vÃ  tham chiáº¿u Ä‘áº¿n giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh cá»§a nÃ³ (tÆ°á»ng minh). Trong trÆ°á»ng há»£p nÃ y, khÃ¡i niá»‡m cá»§a 1 â€œobjectâ€ Ä‘Æ°á»£c má»Ÿ rá»™ng thÃ nh má»™t thá»© gÃ¬ Ä‘Ã³ hÆ¡n lÃ  JS object thÃ´ng thÆ°á»ng vÃ  bao trÃ¹m cáº£ function scope (hoáº·c lÃ  lexical scope toÃ n cá»¥c). Lexical scoping Ä‘á»‹nh nghÄ©a cÃ¡ch mÃ  nhá»¯ng tÃªn biáº¿n Ä‘Æ°á»£c phÃ¢n giáº£i trong cÃ¡c hÃ m lá»“ng nhau: nhá»¯ng hÃ m con chÆ°a scope cá»§a hÃ m cha ká»ƒ cáº£ khi hÃ m cha Ä‘Ã£ Ä‘Æ°á»£c return. Bá»™ Ä‘áº¿m tham chiáº¿uÄÃ¢y lÃ  thuáº­t toÃ¡n dá»n rÃ¡c Ä‘Æ¡n giáº£n nháº¥t. Má»™t object Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ lÃ  â€œrÃ¡c cÃ³ thá»ƒ dá»nâ€ náº¿u nhÆ° khÃ´ng cÃ³ tham chiáº¿u nÃ o trá» Ä‘áº¿n nÃ³. VÃ­ dá»¥: 123456789101112131415161718192021222324252627var o1 = &#123; o2: &#123; x: 1 &#125;&#125;;// Táº¡o 2 object// 'o1' tham chiáº¿u Ä‘áº¿n 'o2' vÃ¬ nÃ³ lÃ  1 thuá»™c tÃ­nh cá»§a 'o1'// Hiá»‡n táº¡i khÃ´ng cÃ³ rÃ¡c Ä‘á»ƒ dá»n.var o3 = o1; // biáº¿n 'o3' Ä‘ang tham chiáº¿u tá»›i cÃ¹ng 1 object vá»›i 'o1'o1 = 1; // giá» thÃ¬ object Ä‘Æ°á»£c tham chiáº¿u trÆ°á»›c Ä‘Ã³ bá»Ÿi 'o1' // chá»‰ cÃ²n láº¡i 1 tham chiáº¿u duy nháº¥t lÃ  'o3'var o4 = o3.o2; // tham chiáº¿u Ä‘áº¿n thuá»™c tÃ­nh 'o2' // object nÃ y giá» cÃ³ 2 tham chiáº¿u: // má»™t lÃ  thuá»™c tÃ­nh cá»§a 'o3': o3.o2 // hai lÃ  biáº¿n 'o4'o3 = '374'; // Giá» thÃ¬ object trÆ°á»›c Ä‘Ã¢y lÃ  cá»§a o1 khÃ´ng cÃ²n tham chiáº¿u ná»¯a. // NÃ³ cÃ³ thá»ƒ bá»‹ dá»n dáº¹p bá»Ÿi GC // Tuy nhiÃªn thuá»™c tÃ­nh 'o2' cá»§a nÃ³ thÃ¬ váº«n cÃ²n // Ä‘Æ°á»£c tham chiáº¿u bá»Ÿi biáº¿n 'o4' nÃªn chÆ°a bá»‹ dá»no4 = null; // thuá»™c tÃ­nh 'o2' trÆ°á»›c Ä‘Ã¢y trong 'o1' giá» // Ä‘Ã£ khÃ´ng cÃ²n gÃ¬ tham chiáº¿u Ä‘áº¿n nÃ³ // láº§n nÃ y thÃ¬ GC cÃ³ thá»ƒ dá»n nÃ³ Ä‘Æ°á»£c rá»“i. Váº¥n Ä‘á» tá»« tham chiáº¿u vÃ²ng trÃ²nCÃ³ má»™t sá»‘ giá»›i háº¡n liÃªn quan Ä‘áº¿n tham chiáº¿u vÃ²ng trÃ²n. Trong vÃ­ dá»¥ sau, 2 object Ä‘Æ°á»£c táº¡o ra vÃ  Ä‘Æ°á»£c tham chiáº¿u láº«n nhau, táº¡o thÃ nh 1 vÃ²ng trÃ²n. ChÃºng sáº½ Ä‘Æ°á»£c Ä‘áº©y ra ngoÃ i scope sau khi hÃ m káº¿t thÃºc nÃªn vá» máº·t lÃ½ thuyáº¿t thÃ¬ chÃºng vÃ´ dá»¥ng vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i phÃ³ng. Tuy nhiÃªn, thuáº­t toÃ¡n Ä‘áº¿m tham chiáº¿u xem xÃ©t ráº±ng má»—i object Ä‘á»u Ä‘ang cÃ³ Ã­t nháº¥t 1 tham chiáº¿u Ä‘áº¿n object Ä‘Ã³ nÃªn thuáº­t toÃ¡n sáº½ bá» qua mÃ  khÃ´ng dá»n dáº¹p. 123456789function f() &#123; var o1 = &#123;&#125;; var o2 = &#123;&#125;; o1.p = o2; // o1 tham chiáº¿u Ä‘áº¿n o2 o2.p = o1; // o2 tham chiáº¿u Ä‘áº¿n o1\\. // 2 thanh niÃªn nÃ y táº¡o thÃ nh 1 vÃ²ng trÃ²n tham chiáº¿u.&#125;f(); Thuáº­t toÃ¡n ÄÃ¡nh dáº¥u vÃ  dá»n dáº¹p (Mark-and-sweep)Äá»ƒ xÃ¡c Ä‘á»‹nh xem object cÃ³ cÃ²n cáº§n thiáº¿t khÃ´ng thÃ¬ thuáº­t toÃ¡n nÃ y thá»­ xem object Ä‘Ã³ cÃ³ thá»ƒ truy cáº­p tá»›i hay khÃ´ng. Thuáº­t toÃ¡n Mark-and-sweep cÃ³ 3 bÆ°á»›c: Roots: NhÃ¬n chung, roots lÃ  nhá»¯ng biáº¿n toÃ n cá»¥c (global) Ä‘Æ°á»£c tham chiáº¿u Ä‘áº¿n trong code. Vá»›i Javascript, má»™t biáº¿n toÃ n cá»¥c cÃ³ vai trÃ² nhÆ° 1 root chÃ­nh lÃ  object window. Trong Node.js thÃ¬ nÃ³ gá»i lÃ  global. Danh sÃ¡ch hoÃ n chá»‰nh cÃ¡c roots Ä‘Æ°á»£c xÃ¢y dá»±ng bá»Ÿi GC. Thuáº­t toÃ¡n sáº½ Ä‘iá»u tra táº¥t cáº£ cÃ¡c roots vÃ  con chÃ¡u (children) cá»§a nÃ³ rá»“i Ä‘Ã¡nh dáº¥u chÃºng lÃ  Ä‘ang hoáº¡t Ä‘á»™ng (active) (nghÄ©a lÃ , chÃºng khÃ´ng pháº£i rÃ¡c). Thá»© gÃ¬ mÃ  khÃ´ng pháº£i con chÃ¡u cá»§a root, root khÃ´ng truy xuáº¥t Ä‘áº¿n Ä‘Æ°á»£c thÃ¬ Ä‘á»u bá»‹ coi lÃ  rÃ¡c. Cuá»‘i cÃ¹ng, GC sáº½ giáº£i phÃ³ng cÃ¡c vÃ¹ng nhá»› khÃ´ng Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u active vÃ  tráº£ bá»™ nhá»› láº¡i cho há»‡ Ä‘iá»u hÃ nh. Thuáº­t toÃ¡n nÃ y tá»‘t hÆ¡n thuáº­t toÃ¡n trÆ°á»›c vÃ¬ â€œÄ‘á»‘i tÆ°á»£ng khÃ´ng cÃ³ tham chiáº¿uâ€ dáº«n tá»›i trÆ°á»ng há»£p Ä‘á»‘i tÆ°á»£ng khÃ´ng thá»ƒ truy cáº­p, á»Ÿ hÆ°á»›ng ngÆ°á»£c láº¡i thÃ¬ nÃ³ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» cá»§a tham chiáº¿u vÃ²ng trÃ²n. NÄƒm 2012, táº¥t cáº£ trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i Ä‘á»u tÃ­ch há»£p sáºµn bá»™ GC Mark-and-sweep. Nhá»¯ng cáº£i tiáº¿n dÃ nh cho bá»™ Javascript GC (nhÆ° GC Tháº¿ há»‡ (Generational)/ Gia tÄƒng (Incremental)/ Äá»“ng thá»i (Concurrent)/ Song song (Parallel)) trong nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y Ä‘á»u lÃ  nhá»¯ng nÃ¢ng cáº¥p cá»§a thuáº­t toÃ¡n Mark-and-sweep, nhÆ°ng khÃ´ng pháº£i lÃ  cáº£i tiáº¿n thuáº­t toÃ¡n GC, cÅ©ng khÃ´ng pháº£i quyáº¿t Ä‘á»‹nh xem 1 object cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c hay lÃ  khÃ´ng. Trong bÃ i viáº¿t nÃ y, báº¡n cÃ³ thá»ƒ tÃ¬m hiá»ƒu chi tiáº¿t hÆ¡n vá» quÃ¡ trÃ¬nh truy tÃ¬m rÃ¡c, nÃ³ cÅ©ng bao gá»“m luÃ´n cáº£ thuáº­t toÃ¡n Mark-and-sweep vÃ  cÃ¡ch tá»‘i Æ°u hÃ³a cá»§a nÃ³. Tham chiáº¿u vÃ²ng trÃ²n chá»‰ lÃ  muá»—iTrong vÃ­ dá»¥ Ä‘áº§u tiÃªn, sau khi hÃ m Ä‘Æ°á»£c tráº£ vá», 2 object Ä‘á»u khÃ´ng Ä‘Æ°á»£c tham chiáº¿u Ä‘áº¿n bá»Ÿi má»™t object cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c tá»« Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c. Má»™t láº½ dÄ© nhiÃªn, thÃ¬ chÃºng sáº½ bá»‹ GC Ä‘Ã¡nh dáº¥u vÃ  dá»n sáº¡ch sáº½. Máº·c dÃ¹ giá»¯a 2 object Ä‘á»u cÃ³ tham chiáº¿u láº«n nhau nhÆ°ng chÃºng khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c tá»« root HÃ nh vi pháº£n trá»±c quan cá»§a GCMáº·c dÃ¹ GC ráº¥t tiá»‡n lá»£i nhÆ°ng chÃºng cÅ©ng Ä‘i kÃ¨m vá»›i nhá»¯ng khuyáº¿t Ä‘iá»ƒm. Má»™t trong sá»‘ Ä‘Ã³ lÃ  sá»± khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c. NÃ³i cÃ¡ch khÃ¡c, GC lÃ  khÃ´ng thá»ƒ Ä‘oÃ¡n trÆ°á»›c Ä‘Æ°á»£c. Ta khÃ´ng thá»ƒ biáº¿t rÃµ khi nÃ o thÃ¬ GC Ä‘Æ°á»£c thá»±c thi. CÃ³ nghÄ©a lÃ  trong má»™t vÃ i trÆ°á»ng há»£p chÆ°Æ¡ng trÃ¬nh sá»­ dá»¥ng nhiá»u bá»™ nhá»› hÆ¡n sá»‘ lÆ°á»£ng mÃ  chÃºng cáº§n. Trong trÆ°á»ng há»£p khÃ¡c, nhá»¯ng thá»i Ä‘iá»ƒm táº¡m dá»«ng ngáº¯n háº¡n (short-pauses) cÃ³ thá»ƒ Ä‘Ã¡ng Ä‘Æ°á»£c chÃº Ã½ trong má»™t sá»‘ á»©ng dá»¥ng Ä‘áº·c biá»‡t nháº¡y cáº£m.Máº·c dÃ¹ khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c nghÄ©a lÃ  khÃ´ng biáº¿t khi nÃ o GC sáº½ cháº¡y, Ä‘a sá»‘ GC Ä‘á»u dÃ¹ng chung má»™t mÃ´ hÃ¬nh thu tháº­p trong quÃ¡ trÃ¬nh cáº¥p phÃ¡t. Náº¿u nhÆ° cáº¥p phÃ¡t khÃ´ng cháº¡y, háº§u nhÆ° GC cÅ©ng khÃ´ng cháº¡y. Cáº§n cÃ¢n nháº¯c trÆ°á»ng há»£p sau: Cáº¥p phÃ¡t má»™t sá»‘ lÆ°á»£c bá»™ nhá»› lá»›n. Äa sá»‘ cÃ¡c pháº§n tá»­ nÃ y (hoáº·c toÃ n bá»™) Ä‘á»u Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  khÃ´ng thá»ƒ truy cáº­p (Giáº£ sá»­ chÃºng ta vÃ´ hiá»‡u hÃ³a má»™t tham chiáº¿u Ä‘ang trá» Ä‘áº¿n bá»™ nhá»› cache mÃ  chÃºng ta khÃ´ng cáº§n ná»¯a.) KhÃ´ng cÃ³ cáº¥p phÃ¡t nÃ o Ä‘Æ°á»£c thá»±c thi ná»¯a. Trong trÆ°á»ng há»£p nÃ y, Ä‘a sá»‘ cÃ¡c GC sáº½ khÃ´ng cháº¡y báº¥t ká»³ má»™t thu gom nÃ o. NÃ³i cÃ¡ch khÃ¡c, máº·c dÃ¹ cÃ³ nhá»¯ng tham chiáº¿u khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c Ä‘ang tá»“n táº¡i nhÆ°ng chÃºng láº¡i khÃ´ng Ä‘Æ°á»£c GC â€œÄ‘á»ƒ máº¯tâ€ Ä‘áº¿n. ÄÃ¢y khÃ´ng pháº£i lÃ  má»™t loáº¡i rÃ² rá»‰ nghiÃªm trá»ng nhÆ°ng dÄ© nhiÃªn nÃ³ váº«n sá»­ dá»¥ng bá»™ nhá»› nhiá»u hÆ¡n bÃ¬nh thÆ°á»ng. RÃ² rá»‰ bá»™ nhá»› lÃ  gÃ¬ ?Náº¿u báº¡n Ä‘á»c háº¿t nhá»¯ng pháº§n á»Ÿ trÃªn thÃ¬ cÅ©ng dá»… hiá»ƒu thÃ´i, rÃ² rá»‰ bá»™ nhá»› lÃ  nhá»¯ng vÃ¹ng nhá»› Ä‘Æ°á»£c cáº¥p phÃ¡t vÃ  sá»­ dá»¥ng trong chÆ°Æ¡ng trÃ¬nh nhÆ°ng sau Ä‘Ã³, khi khÃ´ng cÃ²n dÃ¹ng ná»¯a, chÃºng váº«n khÃ´ng Ä‘Æ°á»£c giáº£i phÃ³ng vÃ  tráº£ vá» cho há»‡ Ä‘iá»u hÃ nh hoáº·c lÃ  kho chá»©a bá»™ nhá»›. CÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh cÃ³ nhiá»u cÃ¡ch khÃ¡c nhau Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»›. Tuy nhiÃªn, má»™t vÃ¹ng nhá»› cá»¥ thá»ƒ Ä‘Æ°á»£c dÃ¹ng hay khÃ´ng thá»±c sá»± lÃ  váº¥n Ä‘á» khÃ³ Ä‘oÃ¡n. NÃ³i cÃ¡ch khÃ¡c, chá»‰ cÃ³ developer má»›i biáº¿t khi nÃ o thÃ¬ má»™t vÃ¹ng nhá»› nÃªn Ä‘Æ°á»£c giáº£i phÃ³ng vÃ  tráº£ láº¡i cho há»‡ Ä‘iá»u hÃ nh. Nhá»¯ng ngÃ´n ngá»¯ láº­p trÃ¬nh cung cáº¥p cÃ¡c tÃ­nh nÄƒng giÃºp developer lÃ m viá»‡c nÃ y. Trong khi má»™t sá»‘ ngÃ´n ngá»¯ khÃ¡c muá»‘n developer hiá»ƒu tÆ°á»ng táº­n vá» viá»‡c khi nÃ o thÃ¬ 1 vÃ¹ng nhá»› khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a. Wikipedia cÃ³ bÃ i viáº¿t hay vá» viá»‡c quáº£n lÃ½ bá»™ nhá»› tá»± Ä‘á»™ng vÃ  báº±ng tay, báº¡n cÃ³ thá»ƒ xem qua. 4 loáº¡i rÃ² rá»‰ phá»• biáº¿n trong Javascript1. Biáº¿n toÃ n cá»¥cJavascript xá»­ lÃ½ nhá»¯ng biáº¿n khÃ´ng Ä‘Æ°á»£c khai bÃ¡o má»™t cÃ¡ch khÃ¡ thÃº vá»‹: khi má»™t biáº¿n khÃ´ng Ä‘Æ°á»£c khai bÃ¡o Ä‘Æ°á»£c tham chiáº¿u Ä‘áº¿n thÃ¬ má»™t biáº¿n má»›i sáº½ Ä‘Æ°á»£c táº¡o ra trong object toÃ n cá»¥c (global). TrÃªn trÃ¬nh duyá»‡t thÃ¬ tÃªn cá»§a nÃ³ lÃ  window, nghÄ©a lÃ  Ä‘oáº¡n nÃ y 123function foo(arg) &#123; bar = \"some text\";&#125; â€¦tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i 123function foo(arg) &#123; window.bar = \"some text\";&#125; Giáº£ sá»­ má»¥c Ä‘Ã­ch cá»§a bar chá»‰ Ä‘á»ƒ tham chiáº¿u Ä‘áº¿n 1 biáº¿n trong hÃ m foo thÃ¬ má»™t biáº¿n toÃ n cá»¥c dÆ° thá»«a lÃºc nÃ y Ä‘Ã£ Ä‘Æ°á»£c táº¡o ra bá»Ÿi vÃ¬ ta Ä‘á»‹nh nghÄ©a bar mÃ  khÃ´ng dÃ¹ng var. á» vÃ­ dá»¥ trÃªn, nÃ³ khÃ´ng gÃ¢y ra nhiá»u tá»•n háº¡i, nhÆ°ng dÄ© nhiÃªn báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng ra bá»‘i cáº£nh Ä‘Ã¡ng lo ngáº¡i hÆ¡n nhiá»u. VÃ­ dá»¥ nhÆ° gÃ¡n 1 object phá»©c táº¡p trong bar cháº³ng háº¡n. Thá»‰nh thoáº£ng báº¡n cÅ©ng cÃ³ thá»ƒ vÃ´ tÃ¬nh táº¡o biáº¿n toÃ n cá»¥c báº±ng this: 12345function foo() &#123; this.var1 = \"potential accidental global\";&#125;// trong hÃ m foo() á»Ÿ Ä‘Ã¢y thÃ¬ \"this\" Ä‘ang trá» tá»›i biáº¿n toÃ n cá»¥c foo(); Báº¡n cÃ³ thá»ƒ trÃ¡nh trÆ°á»ng há»£p Ä‘Ã¡ng tiáº¿c nÃ y báº±ng cÃ¡ch thÃªm dÃ²ng use strict vÃ o Ä‘áº§u file Javascript, nÃ³ sáº½, nÃ³i nÃ´m na, lÃ  báº­t cháº¿ Ä‘á»™ â€œnghiÃªm tÃºcâ€ lÃªn khi phÃ¢n tÃ­ch cÃº phÃ¡p (parse) code JS vÃ  sáº½ ngÄƒn cháº·n trÆ°á»ng há»£p vÃ´ tÃ¬nh táº¡o biáº¿n toÃ n cá»¥c. Nhá»¯ng biáº¿n toÃ n cá»¥c ngoÃ i dá»± tÃ­nh nhÆ° trÃªn rÃµ rÃ ng lÃ  1 váº¥n Ä‘á», tuy nhiÃªn, thÆ°á»ng thÃ¬ code cá»§a báº¡n sáº½ bá»‹ â€œnhiá»…m Ä‘á»™câ€ bá»Ÿi nhá»¯ng biáº¿n toÃ n cá»¥c tÆ°á»ng minh mÃ  nhá»¯ng biáº¿n Ä‘Ã³ láº¡i khÃ´ng thá»ƒ thu tháº­p bá»Ÿi GC. Äáº·c biá»‡t chÃº Ã½ Ä‘áº¿n cÃ¡c biáº¿n toÃ n cá»¥c thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ táº¡m thá»i vÃ  xá»­ lÃ½ 1 sá»‘ lÆ°á»£ng lá»›n thÃ´ng tin. Sá»­ dá»¥ng biáº¿n toÃ n cá»¥c Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u náº¿u báº¡n pháº£i lÃ m tháº¿, nhÆ°ng nhá»› ká»¹ lÃ  gÃ¡n nÃ³ báº±ng null hoáº·c gÃ¡n láº¡i 1 giÃ¡ trá»‹ khÃ¡c khi Ä‘Ã£ xong viá»‡c vá»›i nÃ³. 2. Timers hoáº·c callbacks bá»‹ bá» quÃªnLáº§n nÃ y ta láº¥y setInterval lÃ m vÃ­ dá»¥ vÃ¬ nÃ³ thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng trong JS. Nhá»¯ng thÆ° viá»‡n cÃ³ dÃ¹ng callback cung cáº¥p observer vÃ  cÃ¡c cÃ´ng cá»¥ tÆ°Æ¡ng tá»± thÆ°á»ng Ä‘áº£m báº£o tham chiáº¿u Ä‘áº¿n callback sáº½ khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c má»™t khi instance cá»§a nÃ³ khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c. VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y khÃ´ng pháº£i hiáº¿m: 1234567var serverData = loadData();setInterval(function() &#123; var renderer = document.getElementById('renderer'); if(renderer) &#123; renderer.innerHTML = JSON.stringify(serverData); &#125;&#125;, 5000); // hÃ m sáº½ Ä‘Æ°á»£c thá»±c thi sau má»—i 5 giÃ¢y. Äoáº¡n code trÃªn cho tháº¥y háº­u quáº£ cá»§a viá»‡c sá»­ dá»¥ng timer cÃ³ tham chiáº¿u Ä‘áº¿n node hay dá»¯ liá»‡u cÅ©, khÃ´ng cÃ²n dÃ¹ng ná»¯a. Object renderer cÃ³ thá»ƒ Ä‘Æ°á»£c thay tháº¿ hoáº·c gá»¡ bá» á»Ÿ Ä‘Ã¢u Ä‘Ã³ trong quÃ¡ trÃ¬nh thá»±c thi, Ä‘iá»u nÃ y lÃ m cho hÃ m callback trong setInterval trá»Ÿ nÃªn thá»«a thÃ£i. Náº¿u Ä‘iá»u nÃ y xáº£y ra, dÃ¹ cho callback hay nhá»¯ng thá»© bÃªn trong cÃ³ Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘á»ƒ Ä‘Æ°á»£c dá»n dáº¹p thÃ¬ trÆ°á»›c háº¿t cÃ¡i interval Ä‘Ã³ pháº£i dá»«ng láº¡i trÆ°á»›c Ä‘Ã£ (bá»i vÃ¬ nÃ³ váº«n Ä‘ang hoáº¡t Ä‘á»™ng mÃ ). DÄ© nhiÃªn náº¿u nhÆ° serverData Ä‘ang chá»©a hay Ä‘ang xá»­ lÃ½ cáº£ 1 Ä‘á»‘ng dá»¯ liá»‡u thÃ¬ cÅ©ng khÃ´ng thá»ƒ bá»‹ thu dá»n Ä‘Æ°á»£c. Khi sá»­ dá»¥ng observer, báº¡n cáº§n Ä‘áº£m báº£o pháº£i cÃ³ má»™t cÃ¢u lá»‡nh tÆ°á»ng minh Ä‘á»ƒ gá»¡ bá» chÃºng má»—i khi xong viá»‡c (DÃ¹ lÃ  observer Ä‘Ã³ khÃ´ng cáº§n dÃ¹ng ná»¯a hay object khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c). May máº¯n thay, Ä‘a sá»‘ cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i Ä‘á»u lÃ m giÃºp báº¡n viá»‡c Ä‘Ã³ rá»“i: chÃºng sáº½ tá»± Ä‘á»™ng thu tháº­p cÃ¡c observer má»—i khi object trong Ä‘Ã³ trá»Ÿ nÃªn khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c ká»ƒ cáº£ náº¿u nhÆ° báº¡n quÃªn gá»¡ cÃ¡c listener. TrÆ°á»›c Ä‘Ã¢y, má»™t sá»‘ trÃ¬nh duyá»‡t khÃ´ng lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y (IE6 cháº³ng háº¡n). NhÆ°ng cÃ¡ch tá»‘t nháº¥t váº«n lÃ  gá»¡ bá» observer khi Ä‘Ã£ xong viá»‡c vá»›i nÃ³. Báº¡n xem vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y: 123456789101112var element = document.getElementById('launch-button');var counter = 0;function onClick(event) &#123; counter++; element.innerHtml = 'text ' + counter;&#125;element.addEventListener('click', onClick);// Do stuff element.removeEventListener('click', onClick);element.parentNode.removeChild(element);// Giá» thÃ¬ \"element\" Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a ra khá»i pháº¡m vi thá»±c thi,// Cáº£ \"element\" vÃ  \"onClick\" sáº½ Ä‘Æ°á»£c dá»n dáº¹p ká»ƒ cáº£ trÃªn cÃ¡c trÃ¬nh duyá»‡t cÅ© Báº¡n khÃ´ng cÃ n pháº£i gá»i hÃ m removeEventListener trÆ°á»›c khi lÃ m cho node khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c vÃ¬ cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i há»— trá»£ GC cÃ³ thá»ƒ tá»± Ä‘á»™ng xÃ¡c Ä‘á»‹nh vÃ  xá»­ lÃ½ chÃºng má»™t cÃ¡ch thÃ­ch há»£p. Náº¿u báº¡n dÃ¹ng jQuery APIs (cÃ³ nhiá»u thÆ° viá»‡n vÃ  frameworks khÃ¡c cÅ©ng há»— trá»£), báº¡n cÅ©ng cÃ³ thá»ƒ gá»¡ bá» cÃ¡c listener trÆ°á»›c khi node bá»‹ Ä‘Æ°a vÃ o â€œdÄ© vÃ£ngâ€ vÃ  khÃ´ng dÃ¹ng ná»¯a. Nhá»¯ng thÆ° viá»‡n cÅ©ng Ä‘áº£m báº£o khÃ´ng cÃ³ rÃ² rá»‰ bá»™ nhá»› ká»ƒ cáº£ khi á»©ng dá»¥ng cá»§a báº¡n cháº¡y trÃªn nhá»¯ng trÃ¬nh duyá»‡t cÅ©. 3. ClosuresMá»™t pháº§n quan trá»ng cá»§a Javascript chÃ­nh lÃ  closure: má»™t hÃ m con cÃ³ thá»ƒ truy xuáº¥t Ä‘áº¿n biáº¿n cá»§a hÃ m bÃªn ngoÃ i nÃ³. Trong quÃ¡ tÃ¬nh triá»ƒn khai chi tiáº¿t mÃ´i trÆ°á»ng thá»±c thi (runtime) cá»§a JS thÃ¬ cÃ³ thá»ƒ xáº£y ra tÃ¬nh tráº¡ng rÃ² rá»‰ bá»™ nhá»› vá»›i closure nhÆ° sau: 123456789101112131415var theThing = null;var replaceThing = function () &#123; var originalThing = theThing; var unused = function () &#123; if (originalThing) // má»™t tham chiáº¿u Ä‘áº¿n 'originalThing' console.log(\"hi\"); &#125;; theThing = &#123; longStr: new Array(1000000).join('*'), someMethod: function () &#123; console.log(\"message\"); &#125; &#125;;&#125;;setInterval(replaceThing, 1000); Má»™t khi replaceThing Ä‘Æ°á»£c gá»i, theThing sáº½ trá»Ÿ thÃ nh má»™t object má»›i chá»©a 1 máº£ng ráº¥t lá»›n vÃ  1 closure someMethod. Tuy nhiÃªn, originalThing Ä‘Æ°á»£c tham chiáº¿u bá»Ÿi 1 closure mÃ  nÃ³ láº¡i náº±m trong biáº¿n unused (chÃ­nh lÃ  biáº¿n theThing tá»« lá»i gá»i Ä‘áº¿n replaceThing trÆ°á»›c Ä‘Ã³). Nhá»› ráº±ng á»Ÿ Ä‘Ã¢y má»™t khi pháº¡m vi (scope) cá»§a closure Ä‘Æ°á»£c táº¡o ra cho closure trong cÃ¹ng parent scope thÃ¬ scope Ä‘Ã³ Ä‘Æ°á»£c dÃ¹ng chung. Trong trÆ°á»ng há»£p nÃ y, scope táº¡o ra cho closure someMethod Ä‘Æ°á»£c chia sáº» vá»›i unused. unused cÃ³ tham chiáº¿u Ä‘áº¿n originalThing. Máº·c dÃ¹ unused khÃ´ng bao giá» Ä‘Æ°á»£c dÃ¹ng, someMehod cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng thÃ´ng qua theThing bÃªn ngoÃ i scope cá»§a replaceThing (vÃ­ dá»¥: á»Ÿ 1 nÆ¡i toÃ n cá»¥c nÃ o Ä‘Ã³). VÃ  khi someMethod chia sáº» closure vá»›i unused, tham chiáº¿u Ä‘áº¿n originalThing trong unused Ã©p nÃ³ pháº£i á»Ÿ trong tráº¡ng thÃ¡i hoáº¡t Ä‘á»™ng (toÃ n bá»™ scope chia sáº» giá»¯a 2 closure). Äiá»u nÃ y ngÄƒn cháº·n GC hoáº¡t Ä‘á»™ng. Trong vÃ­ dá»¥ trÃªn, scope Ä‘Æ°á»£c táº¡o ra cho closure someMethod Ä‘Æ°á»£c chia sáº» vá»›i unused, trong khi unused tham chiáº¿u tá»›i originalThing. someMethod cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i thÃ´ng qua theThing bÃªn ngoÃ i scope cá»§a replaceThing, máº·c dÃ¹ sá»± tháº­t lÃ  unused khÃ´ng bao giá» Ä‘Æ°á»£c sá»­ dá»¥ng. RÃµ rÃ ng unused tham chiáº¿u Ä‘áº¿n originalThing yÃªu cáº§u nÃ³ pháº£i giá»¯ tráº¡ng thÃ¡i Ä‘ang hoáº¡t Ä‘á»™ng bá»Ÿi vÃ¬ someMethod chia sáº» closure scope vá»›i unused. Táº¥t cáº£ nhá»¯ng Ä‘iá»u nÃ y cÃ³ thá»ƒ lÃ m bá»™ nhá»› bá»‹ rÃ² rá»‰ Ä‘Ã¡ng ká»ƒ. Báº¡n cÃ³ thá»ƒ tháº¥y biá»ƒu Ä‘á»“ sá»­ dá»¥ng bá»™ nhá»› dÃ¢ng lÃªn cao ngáº¥t khi Ä‘oáº¡n code trÃªn bá»‹ láº·p Ä‘i láº·p láº¡i. KÃ­ch thÆ°á»›c cá»§a nÃ³ khÃ´ng bá»‹ giáº£m Ä‘i khi GC hoáº¡t Ä‘á»™ng. Má»™t danh sÃ¡ch liÃªn káº¿t cÃ¡c closure Ä‘Æ°á»£c táº¡o ra (root cá»§a nÃ³ lÃ  theThing) vÃ  má»—i closure scope láº¡i chÆ°a má»™t tham chiáº¿u giÃ¡n tiáº¿p tá»›i máº£ng khá»•ng lá»“. Váº¥n Ä‘á» nÃ y Ä‘Æ°á»£c tÃ¬m tháº¥y bá»Ÿi Meteor team vÃ  há» cÃ³ 1 bÃ i viáº¿t cá»¥ thá»ƒ mÃ´ táº£ vá» nÃ³ á»Ÿ Ä‘Ã¢y. 4. Tham chiáº¿u ngoÃ i DOMCÃ³ nhá»¯ng trÆ°á»ng há»£p mÃ  developer lÆ°u trá»¯ DOM node bÃªn trong cáº¥u trÃºc dá»¯ liá»‡u. Giáº£ sá»­ báº¡n muá»‘n cáº­p nháº­t má»™t cÃ¡ch nhanh chÃ³ng dá»¯ liá»‡u cá»§a nhiá»u row trong 1 table. Náº¿u báº¡n lÆ°u tham chiáº¿u Ä‘áº¿n má»—i DOM row trong 1 dictionary hay máº£ng, sáº½ cÃ³ 2 tham chiáº¿u Ä‘áº¿n cÃ¹ng 1 pháº§n tá»­ DOM: 1 lÃ  tá»« cÃ¢y DOME, vÃ  1 lÃ  tá»« dictionary. Náº¿u báº¡n chá»n lá»±a xÃ³a bá» nhá»¯ng row nÃ y, báº¡n cÅ©ng pháº£i nhá»› lÃ m cho 2 tham chiáº¿u trÃªn khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c. 1234567891011121314var elements = &#123; button: document.getElementById('button'), image: document.getElementById('image')&#125;;function doStuff() &#123; elements.image.src = 'http://example.com/image_name.png';&#125;function removeImage() &#123; // CÃ¡i áº£nh lÃ  1 node con trá»±c tiáº¿p cá»§a body document.body.removeChild(document.getElementById('image')); // á» thá»i Ä‘iá»ƒm nÃ y ta váº«n cÃ³ 1 tham chiáº¿u Ä‘áº¿n #button trong // biáº¿n toÃ n cá»¥c \"element\". NÃ³i cÃ¡ch khÃ¡c, \"button\" váº«n cÃ²n náº±m // trong bá»™ nhá»› vÃ  GC khÃ´ng thá»ƒ dá»n dáº¹p nÃ³ Ä‘Æ°á»£c.&#125; Cáº§n pháº£i xem xÃ©t ká»¹ lÆ°á»¡ng khi tham chiáº¿u Ä‘áº¿n node con hay node lÃ¡ bÃªn trong cÃ¢y DOME. Náº¿u báº¡n giá»¯ tham chiáº¿u Ä‘áº¿n 1 table cell (tháº» ) trong code vÃ  chá»n xÃ³a table khá»i DOM tuy nhiÃªn váº«n giá»¯ tham chiáº¿u Ä‘áº¿n cell Ä‘Ã³, báº¡n cÃ³ thá»ƒ sáº½ pháº£i Ä‘á»‘i máº·t vá»›i 1 vá»¥ rÃ² rá»‰ lá»›n. Báº¡n nghÄ© ráº±ng GC sáº½ giáº£i phÃ³ng táº¥t cáº£ má»i thá»© ngoáº¡i trá»« cell Ä‘Ã³. Tuy nhiÃªn, Ä‘iá»u nÃ y khÃ´ng dá»… dÃ ng nhÆ° váº­y. Bá»Ÿi vÃ¬ cell lÃ  1 node con cá»§a table vÃ  nhá»¯ng node con thÃ¬ cÃ³ tham chiáº¿u Ä‘áº¿n parent cá»§a chÃºng, vÃ¬ tháº¿ 1 tham chiáº¿u Ä‘áº¿n 1 cell cÃ³ thá»ƒ giá»¯ cáº£ 1 table lá»›n trong bá»™ nhá»›.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P2: BÃªn trong engine V8 & 5 máº¹o Ä‘á»ƒ tá»‘i Æ°u hÃ³a code","slug":"Cach-Javascript-hoat-dong-P2-Ben-trong-engine-V8-5-meo-de-toi-uu-hoa-code","date":"2018-11-13T15:52:00.000Z","updated":"2018-11-13T15:58:38.369Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P2-Ben-trong-engine-V8-5-meo-de-toi-uu-hoa-code.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P2-Ben-trong-engine-V8-5-meo-de-toi-uu-hoa-code.html","excerpt":"HÃ´m trÆ°á»›c chÃºng ta Ä‘Ã£ cÃ³ bÃ i báº¯t Ä‘áº§u má»™t chuá»—i series Ä‘Ã o sÃ¢u nghiÃªn cá»©u vá» Javascript vÃ  cÃ¡ch thá»©c nÃ³ hoáº¡t Ä‘á»™ng: ChÃºng tÃ´i nghÄ© ráº±ng, báº±ng cÃ¡ch hiá»ƒu Ä‘Æ°á»£c nhá»¯ng thÃ nh pháº§n cá»§a JS vÃ  cÃ¡ch chÃºng tÆ°Æ¡ng tÃ¡c vá»›i nhau thÃ¬ chÃºng ta cÃ³ thá»ƒ viáº¿t code tá»‘t hÆ¡n vÃ  ngon hÆ¡n BÃ i Ä‘áº§u tiÃªn cá»§a series Ä‘Ã£ cho chÃºng ta cÃ³ má»™t cÃ¡i nhÃ¬n tá»•ng quan vá» engine, runtime vÃ  callstack. Trong bÃ i thá»© 2 nÃ y, chÃºng ta sáº½ Ä‘á»¥c khoÃ©t vÃ o nhá»¯ng thÃ nh pháº§n bÃªn trong cá»§a bá»™ engine V8 cá»§a Google. TÃ¡c giáº£ cÅ©ng sáº½ cung cáº¥p má»™t sá»‘ máº¹o váº·t Ä‘á»ƒ cÃ³ thá»ƒ viáº¿t code Javascript tá»‘t hÆ¡n - nhá»¯ng thá»© tá»‘t nháº¥t (best practices) mÃ  team SessionStack Ä‘Ã£ vÃ  Ä‘ang thá»±c hiá»‡n Ä‘á»ƒ xÃ¢y dá»±ng nhá»¯ng sáº£n pháº©m cá»§a há».","text":"HÃ´m trÆ°á»›c chÃºng ta Ä‘Ã£ cÃ³ bÃ i báº¯t Ä‘áº§u má»™t chuá»—i series Ä‘Ã o sÃ¢u nghiÃªn cá»©u vá» Javascript vÃ  cÃ¡ch thá»©c nÃ³ hoáº¡t Ä‘á»™ng: ChÃºng tÃ´i nghÄ© ráº±ng, báº±ng cÃ¡ch hiá»ƒu Ä‘Æ°á»£c nhá»¯ng thÃ nh pháº§n cá»§a JS vÃ  cÃ¡ch chÃºng tÆ°Æ¡ng tÃ¡c vá»›i nhau thÃ¬ chÃºng ta cÃ³ thá»ƒ viáº¿t code tá»‘t hÆ¡n vÃ  ngon hÆ¡n BÃ i Ä‘áº§u tiÃªn cá»§a series Ä‘Ã£ cho chÃºng ta cÃ³ má»™t cÃ¡i nhÃ¬n tá»•ng quan vá» engine, runtime vÃ  callstack. Trong bÃ i thá»© 2 nÃ y, chÃºng ta sáº½ Ä‘á»¥c khoÃ©t vÃ o nhá»¯ng thÃ nh pháº§n bÃªn trong cá»§a bá»™ engine V8 cá»§a Google. TÃ¡c giáº£ cÅ©ng sáº½ cung cáº¥p má»™t sá»‘ máº¹o váº·t Ä‘á»ƒ cÃ³ thá»ƒ viáº¿t code Javascript tá»‘t hÆ¡n - nhá»¯ng thá»© tá»‘t nháº¥t (best practices) mÃ  team SessionStack Ä‘Ã£ vÃ  Ä‘ang thá»±c hiá»‡n Ä‘á»ƒ xÃ¢y dá»±ng nhá»¯ng sáº£n pháº©m cá»§a há». Tá»•ng quanJavascript engine lÃ  má»™t trÃ¬nh thÃ´ng dá»‹ch thá»±c thi mÃ£ Javascript. Má»™t JS engine cÃ³ thá»ƒ Ä‘Æ°á»£c triá»ƒn khai thá»±c hiá»‡n nhÆ° lÃ  1 trÃ¬nh thÃ´ng dá»‹ch Ä‘á»™c láº­p, hoáº·c lÃ  má»™t trÃ¬nh biÃªn dá»‹ch tá»©c thá»i (Just-In-Time Compiler) mÃ  nÃ³ sáº½ biÃªn dá»‹ch code Javascript thÃ nh bytecode (chÆ°a pháº£i mÃ£ mÃ¡y, nhÆ°ng gáº§n nhÆ° lÃ  mÃ£ mÃ¡y). DÆ°á»›i Ä‘Ã¢y lÃ  danh sÃ¡ch cÃ¡c dá»± Ã¡n phá»• biáº¿n Ä‘Ã£ triá»ƒn khai cho Javascript engine: V8 - Nguá»“n má»Ÿ, phÃ¡t triá»ƒn bá»Ÿi Google trÃªn ná»n C++ Rhino - ÄÆ°á»£c quáº£n lÃ½ bá»Ÿi quá»¹ Mozilla Foundation, nguá»“n má»Ÿ, phÃ¡t triá»ƒn hoÃ n toÃ n báº±ng Java SpiderMonkey - Bá»™ JS engine Ä‘áº§u tiÃªn, ngÃ y xÆ°a Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Netscape Navigator, ngÃ y nay lÃ  Firefox JavaScriptCore - nguá»“n má»Ÿ, cÃ²n Ä‘Æ°á»£c gá»i lÃ  Nitro, Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Apple cho Safari KJS - Engine cá»§a KDE, phÃ¡t triá»ƒn bá»Ÿi Harri Porten cho dá»± Ã¡n trÃ¬nh duyá»‡t Konqueror cá»§a KDE Chakra (JScript9) - Internet Explorer Chakra (JavaScript) - Microsoft Edge Nashorn - Nguá»“n má»Ÿ vÃ  lÃ  1 pháº§n cá»§a OpenJDK, viáº¿t báº±ng Java bá»Ÿi Oracle vÃ  Tool Group JerryScript - lÃ  1 bá»™ engine nháº¹ dÃ nh cho Váº¡n váº­t káº¿t ná»‘i (Internet of Things) Táº¡i sao V8 Ä‘Æ°á»£c táº¡o ra?Há»i vá»› váº©n V8 engine Ä‘Æ°á»£c xÃ¢y dá»±ng bá»Ÿi Google báº±ng C++ vÃ  nÃ³ lÃ  pháº§n má»m nguá»“n má»Ÿ. Bá»™ engine nÃ y Ä‘Æ°á»£c dÃ¹ng trong trÃ¬nh duyá»‡t Google Chrome. KhÃ´ng giá»‘ng nhÆ° cÃ¡c engine khÃ¡c, V8 cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng trong mÃ´i trÆ°á»ng runtime cá»§a Node.js V8 Ä‘áº§u tiÃªn Ä‘Æ°á»£c thiáº¿t káº¿ nháº±m gia tÄƒng hiá»‡u suáº¥t cá»§a tiáº¿n trÃ¬nh thá»±c thi JavaScript bÃªn trong trÃ¬nh duyá»‡t. Äá»ƒ cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ tá»‘t, V8 dá»‹ch mÃ£ Javascript thÃ nh mÃ£ mÃ¡y thay vÃ¬ sá»­ dá»¥ng trÃ¬nh thÃ´ng dá»‹ch. NÃ³ biÃªn dá»‹ch mÃ£ JS thÃ nh mÃ£ mÃ¡y ngay khi thá»±c thi báº±ng bá»™ JIT compiler (Just-In-Time compiler) giá»‘ng nhÆ° Ä‘a sá»‘ cÃ¡c JS engine hiá»‡n Ä‘áº¡i khÃ¡c nhÆ° SpiderMoney hay Rhino. Äiá»ƒm khÃ¡c biá»‡t chÃ­nh Ä‘Ã³ lÃ  V8 khÃ´ng sinh ra bytecode hay mÃ£ trung gian. V8 sá»­ dá»¥ng 2 trÃ¬nh biÃªn dá»‹chTrÆ°á»›c khi phÃ¡t hÃ nh phiÃªn báº£n 5.9 (Ä‘áº§u nÄƒm 2017), engine V8 sá»­ dá»¥ng 2 trÃ¬nh biÃªn dá»‹ch: full-codegen - má»™t trÃ¬nh biÃªn dá»‹ch vá»«a Ä‘Æ¡n giáº£n vá»«a cá»±c nhanh, sinh mÃ£ mÃ¡y Ä‘Æ¡n giáº£n vÃ  tÆ°Æ¡ng Ä‘á»‘i cháº­m Crankshaft - má»™t trÃ¬nh biÃªn dá»‹ch tá»‘i Æ°u cÃ³ hÆ¡i phá»©c táº¡p (Just-In-Time) sinh mÃ£ Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u tá»‘t nháº¥t. V8 engine cÃ²n sá»­ dá»¥ng nhiá»u tiáº¿n trÃ¬nh ná»™i bá»™ khÃ¡c: Tiáº¿n trÃ¬nh chÃ­nh thá»±c hiá»‡n nhá»¯ng gÃ¬ báº¡n thÆ°á»ng tháº¥y: láº¥y code, biÃªn dá»‹ch vÃ  thá»±c thi nÃ³. CÃ³ má»™t tiáº¿n trÃ¬nh riÃªng khÃ¡c cho viá»‡c biÃªn dá»‹ch, báº±ng cÃ¡ch nÃ y thÃ¬ trong khi tiáº¿n trÃ¬nh chÃ­nh biÃªn dá»‹ch, tiáº¿n trÃ¬nh phá»¥ tá»‘i Æ°u (optimize) code. Má»™t tiáº¿n trÃ¬nh Profiler (khÃ´ng biáº¿t dá»‹ch) sáº½ thÃ´ng bÃ¡o cho runtime nhá»¯ng phÆ°Æ¡ng thá»©c nÃ o Ä‘ang chiáº¿m dá»¥ng nhiá»u thá»i gian xá»­ lÃ½ Ä‘á»ƒ cho Crankshaft cÃ³ thá»ƒ tá»‘i Æ°u chÃºng. Má»™t vÃ i tiáº¿n trÃ¬nh khÃ¡c Ä‘á»ƒ xá»­ lÃ½ dá»n rÃ¡c (Garbage Collector) Khi láº§n Ä‘áº§u thá»±c thi mÃ£ Javascript, V8 engine sáº½ gá»i full-codegen Ä‘á»ƒ dá»‹ch trá»±c tiáº¿p nhá»¯ng Ä‘oáº¡n code JS Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n tÃ­ch thÃ nh mÃ£ mÃ¡y mÃ  khÃ´ng thÃ´ng qua bÆ°á»›c chuyá»ƒn Ä‘á»•i (transformation). Äiá»u nÃ y cho phÃ©p thá»±c thi mÃ£ mÃ¡y ráº¥t nhanh. Äá»ƒ Ã½ ráº±ng V8 khÃ´ng sá»­ dá»¥ng bytecode trung gian, cho tháº¥y ráº±ng cÃ¡ch lÃ m nÃ y loáº¡i bá» sá»± khÃ´ng cáº§n thiáº¿t cá»§a 1 trÃ¬nh thÃ´ng dá»‹ch. Khi code Ä‘Ã£ cháº¡y Ä‘Æ°á»£c má»™t thá»i gian thÃ¬ tiáº¿n trÃ¬nh profiler Ä‘Ã£ thu tháº­p Ä‘á»§ dá»¯ liá»‡u Ä‘á»ƒ cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh phÆ°Æ¡ng thá»©c nÃ o cáº§n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a. á» bÆ°á»›c tiáº¿p theo, Crankshaft sáº½ báº¯t Ä‘áº§u 1 tiáº¿n trÃ¬nh khÃ¡c. NÃ³ dá»‹ch cÃ¢y cÃº phÃ¡p trá»«u tÆ°á»£ng (Abstract Syntax Tree - AST, sáº½ cÃ³ 1 bÃ i riÃªng Ä‘á»ƒ nÃ³i vá» cÃ¡i nÃ y nhÃ©) cá»§a Javascript thÃ nh má»™t dáº¡ng cáº¥p Ä‘á»™ cao cá»§a static single assignment (SSA - vá»‘n ngÃ´n ngá»¯ cÃ³ háº¡n nÃªn khÃ´ng biáº¿t dá»‹ch), cÃ²n Ä‘Æ°á»£c gá»i lÃ  Hydrogen, vÃ  cá»‘ gáº¯ng tá»‘i Æ°u Ä‘á»“ thá»‹ Hydrogen Ä‘Ã³. Äa sá»‘ sá»± tá»‘i Æ°u hÃ³a Ä‘Æ°á»£c hoÃ n thÃ nh lÃ  giai Ä‘oáº¡n nÃ y. Inlining (Ná»™i tuyáº¿n)BÆ°á»›c tá»‘i Æ°u hÃ³a Ä‘áº§u tiÃªn lÃ  triá»ƒn khai ná»™i tuyáº¿n (Inlining) nhiá»u code nháº¥t cÃ³ thá»ƒ. Inlining lÃ  tiáº¿n trÃ¬nh thay tháº¿ má»™t vá»‹ trÃ­ gá»i (call site - dÃ²ng code nÆ¡i hÃ m Ä‘Æ°á»£c gá»i) vá»›i thÃ¢n (body) cá»§a hÃ m Ä‘Æ°á»£c gá»i. BÆ°á»›c thá»±c hiá»‡n Ä‘Æ¡n giáº£n nÃ y cho phÃ©p nhá»¯ng tá»‘i Æ°u hÃ³a sau nÃ y Ä‘Æ°á»£c Ã½ nghÄ©a hÆ¡n. Lá»›p áº©n (Hidden class)Javascript lÃ  ngÃ´n ngá»¯ dá»±a trÃªn cÃ¡c nguyÃªn máº«u (prototype-based): khÃ´ng cÃ³ cÃ¡c lá»›p (class) hay Ä‘á»‘i tÆ°á»£ng (object) nÃ o Ä‘Æ°á»£c táº¡o ra báº±ng tiáº¿n trÃ¬nh nhÃ¢n báº£n (cloning process). Javascript cÅ©ng lÃ  ngÃ´n ngá»¯ Ä‘á»™ng (dynamic), nghÄ©a lÃ  nhá»¯ng thuá»™c tÃ­nh (property) cÃ³ thá»ƒ Ä‘Æ°á»£c dá»… dÃ ng thÃªm vÃ o hoáº·c xÃ³a Ä‘i tá»« object sau khi object Ä‘Ã³ Ä‘Æ°á»£c khá»Ÿi táº¡o. Äa sá»‘ cÃ¡c trÃ¬nh thÃ´ng dá»‹ch JS sá»­ dá»¥ng cáº¥u trÃºc dáº¡ng nhÆ° tá»« Ä‘iá»ƒn (hash function based) Ä‘á»ƒ lÆ°u trá»¯ vá»‹ trÃ­ cá»§a nhá»¯ng giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh trong object trÃªn bá»™ nhá»›. Cáº¥u trÃºc nÃ y lÃ m cho quÃ¡ trÃ¬nh láº¥y giÃ¡ trá»‹ (get) trong JS trá»Ÿ nÃªn tá»‘n kÃ©m hÆ¡n nhiá»u so vá»›i nhá»¯ng ngÃ´n ngá»¯ láº­p trÃ¬nh non-dynamic khÃ¡c nhÆ° Java hay C#.Trong Java, táº¥t cáº£ cÃ¡c thuá»™c tÃ­nh cá»§a object Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi cáº¥u trÃºc object cá»‘ Ä‘á»‹nh trÆ°á»›c khi biÃªn dá»‹ch vÃ  khÃ´ng thá»ƒ thÃªm hay bá»›t thuá»™c tÃ­nh táº¡i thá»i Ä‘iá»ƒm thá»±c thi (C# cÅ©ng cÃ³ kiá»ƒu dynamic, nhÆ°ng cÃ¡i Ä‘Ã³ hÆ¡i láº¡c Ä‘á» rá»“i nÃªn mÃ¬nh khÃ´ng Ä‘á» cáº­p).Káº¿t quáº£ lÃ , giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh (hay con trá» Ä‘áº¿n thuá»™c tÃ­nh Ä‘Ã³) Ä‘Æ°á»£c lÆ°u dÆ°á»›i dáº¡ng bá»™ Ä‘á»‡m liÃªn tá»¥c (continuous buffer) trÃªn vÃ¹ng nhá»› vá»›i má»™t offset cá»‘ Ä‘á»‹nh giá»¯a cÃ¡c vÃ¹ng nhá»›. Äá»™ dÃ i cá»§a 1 offset cÃ³ thá»ƒ dá»… dÃ ng xÃ¡c Ä‘á»‹nh dá»±a trÃªn loáº¡i thuá»™c tÃ­nh, trong khi Ä‘Ã³ Ä‘iá»u nÃ y lÃ  báº¥t kháº£ thi Ä‘á»‘i vá»›i Javascript khi mÃ  loáº¡i thuá»™c tÃ­nh cÃ³ thá»ƒ bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh thá»±c thi. Bá»Ÿi vÃ¬ sá»­ dá»¥ng cáº¥u trÃºc tá»« Ä‘iá»ƒn Ä‘á»ƒ tÃ¬m vá»‹ trÃ­ cá»§a thuá»™c tÃ­nh cá»§a object trong vÃ¹ng nhá»› lÃ  khÃ´ng hiá»‡u quáº£ nÃªn V8 sá»­ dá»¥ng má»™t phÆ°Æ¡ng phÃ¡p khÃ¡c: lá»›p áº©n (hidden class). Lá»›p áº©n hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»± nhÆ° má»™t cáº¥u trÃºc object (class) cá»‘ Ä‘á»‹nh trong Java, ngoáº¡i trá»« viá»‡c nÃ³ Ä‘Æ°á»£c táº¡o ra á»Ÿ quÃ¡ trÃ¬nh thá»±c thi (runtime). Giá» thÃ¬ xem vÃ­ dá»¥ bÃªn dÆ°á»›i nhÃ©: 12345function Point(x, y) &#123; this.x = x; this.y = y;&#125;var p1 = new Point(1, 2); Khi cÃ¢u lá»‡nh new Point(1, 2) Ä‘Æ°á»£c gá»i, V8 sáº½ táº¡o ra 1 lá»›p áº©n, táº¡m gá»i lÃ  C0 KhÃ´ng cÃ³ thuá»™c tÃ­nh nÃ o Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Point, vÃ¬ tháº¿ táº¡m thá»i C0 Ä‘ang rá»—ng. Khi cÃ¢u lá»‡nh this.x = x Ä‘Æ°á»£c thá»±c thi (bÃªn trong hÃ m Point), V8 sáº½ táº¡o ra 1 lá»›p áº©n thá»© hai dá»±a trÃªn C0, ta táº¡m gá»i lÃ  C1. C1 mÃ´ táº£ láº¡i vá»‹ trÃ­ trÃªn vÃ¹ng nhá»› (tÆ°Æ¡ng tá»± nhÆ° con trá») nÆ¡i mÃ  thuá»™c tÃ­nh x Ä‘Æ°á»£c lÆ°u.Trong trÆ°á»ng há»£p nÃ y, x sáº½ náº±m á»Ÿ offset 0, nghÄ©a lÃ  khi chÃºng ta view má»™t object Point trÃªn vÃ¹ng nhá»› dÆ°á»›i dáº¡ng bá»™ Ä‘á»‡m liÃªn tá»¥c (continuous buffer) thÃ¬ offset Ä‘áº§u tiÃªn sáº½ tÆ°Æ¡ng á»©ng vá»›i thuá»™c tÃ­nh x.V8 cÅ©ng sáº½ cáº­p nháº­t C0 vá»›i má»™t sá»± chuyá»ƒn Ä‘á»•i lá»›p (class transition) vÃ  tuyÃªn bá»‘ ráº±ng thuá»™c tÃ­nh x Ä‘Æ°á»£c thÃªm vÃ o trong object Point, lá»›p áº©n lÃºc nÃ y sáº½ chuyá»ƒn tá»« C0 sang C1.Lá»›p áº©n cho object Point á»Ÿ hÃ¬nh dÆ°á»›i lÃºc nÃ y lÃ  C1 Má»—i khi cÃ³ thuá»™c tÃ­nh má»›i Ä‘Æ°á»£c thÃªm vÃ o object, lá»›p áº©n cÅ© Ä‘Æ°á»£c cáº­p nháº­t vÃ  sáº½ chuyá»ƒn tiáº¿p (transition) sang lá»›p áº©n má»›i. Sá»± chuyá»ƒn tiáº¿p lá»›p áº©n lÃ  ráº¥t quan trá»ng bá»Ÿi vÃ¬ chÃºng cho phÃ©p nhá»¯ng object Ä‘Æ°á»£c táº¡o ra theo nhá»¯ng cÃ¡ch giá»‘ng nhau cÃ³ thá»ƒ cÃ¹ng chia sáº» cÃ¡c lá»›p áº©n. Náº¿u 2 object cÃ¹ng dÃ¹ng chung 1 lá»›p áº©n vÃ  1 thuá»™c tÃ­nh Ä‘Æ°á»£c thÃªm vÃ o cáº£ 2 object Ä‘Ã³, sá»± chuyá»ƒn tiáº¿p sáº½ Ä‘áº£m báº£o ráº±ng cáº£ 2 object Ä‘á»u nháº­n Ä‘Æ°á»£c cÃ¹ng 1 lá»›p áº©n má»›i vÃ  sáº½ Ä‘Æ°á»£c tá»‘i Æ°u cÃ¹ng nhau. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c láº·p láº¡i khi cÃ¢u lá»‡nh tiáº¿p theo this.y = y Ä‘Æ°á»£c thá»±c thi (bÃªn trong hÃ m Point, ngay sau dÃ²ng this.x = x). Má»™t lá»›p áº©n má»›i, táº¡m gá»i lÃ  C2 Ä‘Æ°á»£c táº¡o ra, má»™t lá»›p chuyá»ƒn tiáº¿p (class transition) Ä‘Æ°á»£c thÃªm vÃ o C1 biá»ƒu thá»‹ ráº±ng náº¿u thuá»™c tÃ­nh y Ä‘Æ°á»£c thÃªm vÃ o object Point (object Ä‘Ã£ chá»©a thuá»™c tÃ­nh x) thÃ¬ lá»›p áº©n sáº½ Ä‘Æ°á»£c thay Ä‘á»•i sang C2, vÃ  lá»›p áº©n cá»§a object Point sáº½ Ä‘Æ°á»£c cáº­p nháº­t thÃ nh C2 Sá»± chuyá»ƒn tiáº¿p lá»›p áº©n phá»¥ thuá»™c vÃ o thá»© tá»± mÃ  nhá»¯ng thuá»™c tÃ­nh Ä‘Æ°á»£c thÃªm vÃ o 1 object. VÃ­ dá»¥: 123456789101112function Point(x, y) &#123; this.x = x; this.y = y;&#125;var p1 = new Point(1, 2);p1.a = 5;p1.b = 6;var p2 = new Point(3, 4);p2.b = 7;p2.a = 8; NhÃ¬n vÃ o Ä‘oáº¡n code trÃªn, báº¡n sáº½ nghÄ© ráº±ng cáº£ p1 vÃ  p2 sáº½ dÃ¹ng chung lá»›p áº©n vÃ  sá»± chuyá»ƒn tiáº¿p giá»¯a cÃ¡c lá»›p. NhÆ°ng sá»± tháº­t khÃ´ng pháº£i nhÆ° váº­y. Äá»‘i vá»›i p1, thuá»™c tÃ­nh thá»© nháº¥t lÃ  a sáº½ Ä‘Æ°á»£c thÃªm vÃ o vÃ  sau Ä‘Ã³ Ä‘áº¿n b. Vá»›i p2 thÃ¬ ngÆ°á»£c láº¡i, b trÆ°á»›c rá»“i má»›i Ä‘áº¿n a.VÃ¬ váº­y, p1 vÃ  p2 sáº½ sinh ra 2 lá»›p áº©n khÃ¡c nhau vÃ  cÃ³ sá»± chuyá»ƒn tiáº¿p lá»›p áº©n cÅ©ng khÃ¡c nhau. Trong trÆ°á»ng há»£p nÃ y, tá»‘t nháº¥t lÃ  nÃªn giá»¯ Ä‘Ãºng thá»© tá»± thuá»™c tÃ­nh má»—i khi khá»Ÿi táº¡o dá»¯ liá»‡u Ä‘á»ƒ lá»›p áº©n cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng láº¡i: 1234567var p1 = new Point(1, 2);p1.a = 5;p1.b = 6;var p2 = new Point(3, 4);p2.a = 8;p2.b = 7; Pháº§n diá»…n giáº£i vá» hidden class nÃ y khÃ¡ lÃ  rá»‘i vÃ  khÃ³ hiá»ƒu, Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n thÃ¬ má»i báº¡n tham kháº£o thÃªm bÃ i viáº¿t chi tiáº¿t cá»§a tÃ¡c giáº£ thefullsnack Inline caching (Bá»™ Ä‘á»‡m ná»™i tuyáº¿n)V8 cÃ³ má»™t Ä‘iá»ƒm máº¡nh trong ká»¹ thuáº­t tá»‘i Æ°u hÃ³a dÃ nh cho cÃ¡c ngÃ´n ngá»¯ vá»›i kiá»ƒu dá»¯ liá»‡u Ä‘á»™ng, gá»i lÃ  Inline caching (bá»™ Ä‘á»‡m ná»™i tuyáº¿n). Inline caching dá»±a trÃªn sá»± quan sÃ¡t nhá»¯ng lá»i gá»i Ä‘Æ°á»£c láº·p láº¡i nhiá»u láº§n Ä‘áº¿n cÃ¹ng 1 phÆ°Æ¡ng thá»©c cÃ³ xu hÆ°á»›ng xáº£y ra trÃªn cÃ¹ng 1 loáº¡i object. Diá»…n giáº£i chi tiáº¿t hÆ¡n vá» inline caching cÃ³ thá»ƒ xem á»Ÿ Ä‘Ã¢y Giá» chÃºng ta sáº½ duyá»‡t sÆ¡ qua nhá»¯ng khÃ¡i niá»‡m chung chung cá»§a inline caching (náº¿u nhÆ° báº¡n khÃ´ng cÃ³ thá»i gian Ä‘á»c háº¿t bÃ i chi tiáº¿t á»Ÿ trÃªn) Váº­y thÃ¬ nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o? V8 duy trÃ¬ bá»™ nhá»› Ä‘á»‡m vá» kiá»ƒu cá»§a cÃ¡c object Ä‘Æ°á»£c truyá»n qua dÆ°á»›i dáº¡ng tham sá»‘ (parameter) trong nhá»¯ng láº§n gá»i method gáº§n Ä‘Ã¢y vÃ  sá»­ dá»¥ng thÃ´ng tin nÃ y Ä‘á»ƒ dá»± Ä‘oÃ¡n vá» kiá»ƒu object sáº½ Ä‘Æ°á»£c truyá»n trong tÆ°Æ¡ng lai. Náº¿u nhÆ° V8 cÃ³ thá»ƒ dá»± Ä‘oÃ¡n tÆ°Æ¡ng Ä‘á»‘i tá»‘t vá» kiá»ƒu object sáº½ Ä‘Æ°á»£c truyá»n vÃ o thÃ¬ nÃ³ cÃ³ thá»ƒ bá» qua bÆ°á»›c xá»­ lÃ½ tÃ¬m hiá»ƒu vá» cÃ¡c thuá»™c tÃ­nh cá»§a object Ä‘Ã³, nÃ³ sáº½ dÃ¹ng nhá»¯ng thÃ´ng tin cÃ³ sáºµn Ä‘Ã£ Ä‘Æ°á»£c lÆ°u tá»« láº§n trÆ°á»›c vÃ  Ã¡p dá»¥ng cho lá»›p áº©n cá»§a object nÃ y. Váº­y thÃ¬ lá»›p áº©n vÃ  inline caching liÃªn quan vá»›i nhau nhÆ° tháº¿ nÃ o? Khi má»™t phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c gá»i trÃªn má»™t object cá»¥ thá»ƒ, V8 sáº½ thá»±c hiá»‡n tÃ¬m kiáº¿m lá»›p áº©n cá»§a object Ä‘Ã³ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh offset nháº±m phá»¥c vá»¥ cho viá»‡c truy xuáº¥t thuá»™c tÃ­nh. Sau 2 láº§n gá»i thÃ nh cÃ´ng cÃ¹ng 1 phÆ°Æ¡ng thá»©c Ä‘áº¿n cÃ¹ng 1 lá»›p áº©n, V8 sáº½ bá» qua viá»‡c tÃ¬m kiáº¿m lá»›p áº©n Ä‘Ã³ vÃ  Ä‘Æ¡n giáº£n lÃ  thÃªm offset cá»§a thuá»™c tÃ­nh vÃ o trong báº£n thÃ¢n con trá» cá»§a object. Vá» sau, cá»© má»—i láº§n gá»i phÆ°Æ¡ng thá»©c, V8 sáº½ giáº£ Ä‘á»‹nh ráº±ng lá»›p áº©n khÃ´ng thay Ä‘á»•i vÃ  nháº£y trá»±c tiáº¿p vÃ o trong Ä‘á»‹a chá»‰ vÃ¹ng nhá»› cá»§a thuá»™c tÃ­nh vÃ  sá»­ dá»¥ng offset Ä‘Ã£ Ä‘Æ°á»£c lÆ°u tá»« láº§n tÃ¬m kiáº¿m trÆ°á»›c Ä‘Ã³. CÃ¡ch nÃ y cÃ³ thá»ƒ gia tÄƒng Ä‘Ã¡ng ká»ƒ tá»‘c Ä‘á»™ thá»±c thi. Inline caching cÅ©ng lÃ  lÃ½ do quan trá»ng cho viá»‡c cÃ¹ng kiá»ƒu object sáº½ dÃ¹ng chung lá»›p áº©n. Náº¿u báº¡n táº¡o ra 2 object cÃ³ cÃ¹ng 1 kiá»ƒu nhÆ°ng khÃ¡c hidden class (nhÆ° chÃºng ta Ä‘Ã£ lÃ m á»Ÿ trÃªn), V8 sáº½ khÃ´ng thá»ƒ sá»­ dá»¥ng inline caching bá»Ÿi vÃ¬ máº·c dÃ¹ 2 object cÃ³ cÃ¹ng kiá»ƒu nhÆ°ng lá»›p áº©n tÆ°Æ¡ng á»©ng cá»§a nÃ³ láº¡i gÃ¡n offset khÃ¡c nhau cho má»—i thuá»™c tÃ­nh. 2 object vá» cÆ¡ báº£n lÃ  giá»‘ng nhau nhÆ°ng thuá»™c tÃ­nh a vÃ  b láº¡i cÃ³ thá»© tá»± khÃ¡c nhau. BiÃªn dá»‹ch thÃ nh mÃ£ mÃ¡yMá»™t khi Ä‘á»“ thá»‹ Hydrogen Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a, Crankshaft chuyá»ƒn nÃ³ xuá»‘ng má»™t táº§ng tháº¥p hÆ¡n gá»i lÃ  Lithium. Háº§u nhÆ° toÃ n bá»™ cÃ¡c Lithium nÃ y lÃ  kiáº¿n trÃºc cá»¥ thá»ƒ (architecture-specific, mÃ¬nh cÅ©ng khÃ´ng hiá»ƒu ná»¯a, kiáº¿n thá»©c chuyÃªn sÃ¢u quÃ¡). ÄÄƒng kÃ½ cáº¥p phÃ¡t xáº£y ra á»Ÿ táº§ng nÃ y. á» bÆ°á»›c cuá»‘i cÃ¹ng, Lithium Ä‘Æ°á»£c biÃªn dá»‹ch thÃ nh mÃ£ mÃ¡y. Sau Ä‘Ã³, quÃ¡ trÃ¬nh thay Ä‘á»•i trÃªn ngÄƒn xáº¿p (on-stack replacement: OSR) sáº½ diá»…n ra. TrÆ°á»›c khi chÃºng ta báº¯t Ä‘áº§u biÃªn dá»‹ch vÃ  tá»‘i Æ°u hÃ³a má»™t phÆ°Æ¡ng thá»©c ngá»‘n nhiá»u thá»i gian, chÃºng ta thÆ°á»ng cháº¡y nÃ³ trÆ°á»›c. V8 sáº½ khÃ´ng vá»©t háº¿t nhá»¯ng Ä‘oáº¡n code cháº­m vÃ  cháº¡y láº¡i tá»« Ä‘áº§u Ä‘oáº¡n code Ä‘Ã£ tá»‘i Æ°u. Thay vÃ¬ tháº¿, V8 sáº½ chuyá»ƒn hÃ³a toÃ n bá»™ ngá»¯ cáº£nh hiá»‡n táº¡i (ngÄƒn xáº¿p, cÃ¡c thanh ghi), do Ä‘Ã³ ta cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i sang phiÃªn báº£n Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u ngay giá»¯a quÃ¡ trÃ¬nh thá»±c thi. ÄÃ¢y lÃ  má»™t thao tÃ¡c cá»±c ká»³ phá»©c táº¡p, hÃ£y nhá»› ráº±ng V8 Ä‘Ã£ inline toÃ n bá»™ code giá»¯a quÃ¡ trÃ¬nh tá»‘i Æ°u hÃ³a (Äoáº¡n nÃ y viáº¿t khÃ³ hiá»ƒu quÃ¡, nhÆ°ng mÃ  cÅ©ng khÃ´ng quan tá»ng láº¯m Ä‘Ã¢u). NgoÃ i ra thÃ¬ V8 khÃ´ng pháº£i lÃ  engine duy nháº¥t cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y. CÃ³ má»™t giáº£i phÃ¡p an toÃ n Ä‘Ã³ lÃ  Ä‘áº£o ngÆ°á»£c quÃ¡ trÃ¬nh tá»‘i Æ°u hÃ³a (deoptimization - phá»©c táº¡p hÃ³a ?) Ä‘á»ƒ chuyá»ƒn Ä‘á»•i toÃ n bá»™ code vá» vá»›i tráº¡ng thÃ¡i chÆ°a Ä‘Æ°á»£c tá»‘i Æ°u trong trÆ°á»ng há»£p engine gáº·p trá»¥c tráº·c. Bá»™ dá»n rÃ¡c (Garbage collection - GC)Äá»‘i vá»›i GC thÃ¬ V8 sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p tháº¿ há»‡ theo kiá»ƒu truyá»n thá»‘ng lÃ  Ä‘Ã¡nh-dáº¥u-vÃ -quÃ©t (mark-and-sweep) Ä‘á»ƒ dá»n dáº¹p nhá»¯ng thá»© cÅ©. Giáº£ sá»­ quÃ¡ tÃ¬nh Ä‘Ã¡nh dáº¥u cÃ³ thá»ƒ lÃ m ngÆ°ng sá»± thá»±c thi Javascript. Äá»ƒ cÃ³ thá»ƒ Ä‘iá»u hÃ nh GC hiá»‡u quáº£ vÃ  thá»±c hiá»‡n má»™t cÃ¡ch á»•n Ä‘á»‹nh, V8 sá»­ dá»¥ng Ä‘Ã¡nh dáº¥u gia tÄƒng (incremental marking), thay vÃ¬ duyá»‡t qua toÃ n bá»™ heap vÃ  cá»‘ Ä‘Ã¡nh dáº¥u nhiá»u object nháº¥t cÃ³ thá»ƒ, nÃ³ sáº½ Ä‘i qua tá»«ng heap, sau Ä‘Ã³ quay láº¡i vá»›i nhá»¯ng thá»±c thi bÃ¬nh thÆ°á»ng.Láº§n tiáº¿p theo GC cháº¡y sáº½ tiáº¿p tá»¥c tá»« vá»‹ trÃ­ heap mÃ  trÆ°á»›c Ä‘Ã³ nÃ³ Ä‘Ã£ dá»«ng láº¡i. CÃ¡ch nÃ y cho phÃ©p má»™t khoáº£ng thá»i gian dá»«ng ráº¥t ngáº¯n giá»¯a quÃ¡ trÃ¬nh thá»±c thi. VÃ  nhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÆ°á»›c, quÃ¡ tÃ¬nh quÃ©t dá»n Ä‘Æ°á»£c xá»­ lÃ½ báº±ng 1 tiáº¿n trÃ¬nh khÃ¡c. Ignition vÃ  TurboFanCÃ¹ng vá»›i sá»± ra máº¯t cá»§a V8 báº£n 5.9 Ä‘áº§u nÄƒm 2017, cÃ³ 2 pipeline thá»±c thi má»›i Ä‘Æ°á»£c giá»›i thiá»‡u, mang láº¡i kháº£ nÄƒng cáº£i thiá»‡n hiá»‡u nÄƒng tá»‘t hÆ¡n vÃ  tiáº¿t kiá»‡m bá»™ nhá»› Ä‘Ã¡ng ká»ƒ Ä‘á»‘i vá»›i nhá»¯ng á»©ng dá»¥ng Javascript. Bá»™ pipeline má»›i nÃ y Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn trÃ¬nh thÃ´ng dá»‹ch cá»§a V8 lÃ  Ignition vÃ  trÃ¬nh biÃªn dá»‹ch tá»‘i Æ°u hÃ³a má»›i nháº¥t lÃ  TurboFan. Báº¡n cÃ³ thá»ƒ xem thÃªm thÃ´ng tin trong bÃ i viáº¿t trÃªn blog cá»§a V8 táº¡i Ä‘Ã¢y Ká»ƒ tá»« phiÃªn báº£n 5.9 thÃ¬ full-codegen vÃ  Crankshaft (nhá»¯ng cÃ´ng nghá»‡ Ä‘Ã£ xuáº¥t hiá»‡n trong V8 tá»« nÄƒm 2010) Ä‘Ã£ khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng cho quÃ¡ trÃ¬nh thá»±c thi Javascript ná»¯a khi mÃ  nhÃ³m phÃ¡t triá»ƒn V8 Ä‘Ã£ pháº£i váº¥t váº£ Ä‘á»ƒ cÃ³ thá»ƒ theo ká»‹p vá»›i nhá»¯ng tÃ­nh nÄƒng má»›i vÃ  sá»± tá»‘i Æ°u hÃ³a cáº§n thiáº¿t cho nhá»¯ng tÃ­nh nÄƒng nÃ y. Äiá»u nÃ y nghÄ©a lÃ  xÃ©t má»™t cÃ¡ch tá»•ng quÃ¡t thÃ¬ V8 sáº½ Ä‘Æ¡n giáº£n hÆ¡n vÃ  cÃ³ kiáº¿n trÃºc dá»… báº£o trÃ¬ hÆ¡n. Nhá»¯ng cáº£i tiáº¿n nÃ y chá»‰ lÃ  bÆ°á»›c khá»Ÿi Ä‘áº§u. Ignition vÃ  TurboFan sáº½ lÃ³t Ä‘Æ°á»ng cho nhá»¯ng tá»‘i Æ°u hÃ³a vá» sau, Ä‘áº©y máº¡nh hiá»‡u nÄƒng Javascript vÃ  tinh giáº£n bá»›t V8 trong Chrome vÃ  Node.js trong nhá»¯ng nÄƒm tá»›i. Cuá»‘i cÃ¹ng, dÆ°á»›i Ä‘Ã¢y lÃ  1 sá»‘ máº¹o váº·t Ä‘á»ƒ báº¡n cÃ³ thá»ƒ viáº¿t Ä‘Æ°á»£c bá»™ code Javascript má»™t cÃ¡ch tá»‘i Æ°u. Báº¡n cÃ³ thá»ƒ dá»… dÃ ng rÃºt ra Ä‘Æ°á»£c bÃ i há»c tá»« nhá»¯ng gÃ¬ Ä‘Ã£ nÃªu á»Ÿ trÃªn, nhÆ°ng Ä‘á»ƒ dá»… hiá»ƒu hÆ¡n thÃ¬ má»i báº¡n xáº¹m tá»•ng káº¿t: LÃ m tháº¿ nÃ o Ä‘á»ƒ tá»‘i Æ°u hÃ³a Javascript Thá»© tá»± cÃ¡c thuá»™c tÃ­nh cá»§a object: luÃ´n luÃ´n khá»Ÿi táº¡o cÃ¡c thuá»™c tÃ­nh cá»§a object sao cho chÃºng cÃ³ cÃ¹ng thá»© tá»± Ä‘á»ƒ lá»›p áº©n vÃ  nhá»¯ng code tá»‘i Æ°u cÃ³ thá»ƒ chia sáº» dÃ¹ng chung. Thuá»™c tÃ­nh Ä‘á»™ng (Dynamic properties): thÃªm thuá»™c tÃ­nh vÃ o má»™t object sau khi khá»Ÿi táº¡o sáº½ Ã©p lá»›p áº©n pháº£i thay Ä‘á»•i vÃ  lÃ m cháº­m nhá»¯ng phÆ°Æ¡ng thá»©c Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u cho lá»›p áº©n trÆ°á»›c Ä‘Ã³. Thay vÃ¬ tháº¿, ta cÃ³ thá»ƒ gÃ¡n táº¥t cáº£ cÃ¡c thuá»™c tÃ­nh cá»§a object trong hÃ m khá»Ÿi táº¡o constructor. PhÆ°Æ¡ng thá»©c: code thá»±c thi cÃ¹ng 1 phÆ°Æ¡ng thá»©c nhÆ°ng nhiá»u láº§n sáº½ cháº¡y nhanh hÆ¡n code thá»±c thi nhiá»u phÆ°Æ¡ng thá»©c khÃ¡c nhau nhÆ°ng má»—i phÆ°Æ¡ng thá»©c cháº¡y má»™t láº§n (xem pháº§n inline caching) Máº£ng: TrÃ¡nh sá»­ dá»¥ng máº£ng thÆ°a (sparse arrays) mÃ  key khÃ´ng pháº£i lÃ  sá»‘ tÄƒng liÃªn tá»¥c. Máº£ng thÆ°a mÃ  khÃ´ng cÃ³ pháº§n tá»­ nÃ o thÃ¬ láº¡i lÃ  báº£ng bÄƒm (hash table). Má»—i pháº§n tá»­ trong máº£ng nhÆ° váº­y sáº½ gÃ¢y ra sá»± tá»‘n kÃ©m má»—i láº§n truy xuáº¥t. NgoÃ i ra cáº§n trÃ¡nh trÆ°á»ng há»£p cáº¥p phÃ¡t bá»™ nhá»› trÆ°á»›c cho nhá»¯ng máº£ng lá»›n. Cá»© Ä‘á»ƒ cho máº£ng â€œná»Ÿ raâ€ má»™t cÃ¡ch tá»± nhiÃªn. Cuá»‘i cÅ©ng thÃ¬ cÅ©ng Ä‘á»«ng xÃ³a cÃ¡c pháº§n tá»­ trong máº£ng (toÃ¡n tá»­ delete()) vÃ¬ nÃ³ chá»‰ xÃ³a pháº§n tá»« chá»© khÃ´ng Ä‘Ã¡nh index láº¡i máº£ng. Tagged values: Trong V8 thÃ¬ object vÃ  sá»‘ (number) lÃ  32bits. NÃ³ sá»­ dá»¥ng 1 bit Ä‘á»ƒ phÃ¢n biá»‡t object (flag = 1) vÃ  sá»‘ integer (flag = 0) gá»i lÃ  SMI (SMall Integer). VÃ¬ tháº¿ náº¿u 1 giÃ¡ trá»‹ sá»‘ lá»›n hÆ¡n 31 bit thÃ¬ V8 sáº½ Ä‘Ã³ng gÃ³i sá»‘ Ä‘Ã³, chuyá»ƒn nÃ³ thÃ nh kiá»ƒu double vÃ  táº¡o 1 object má»›i Ä‘á»ƒ lÆ°u sá»‘. Chá»‰ nÃªn sá»­ dá»¥ng sá»‘ nguyÃªn cÃ³ dáº¥u 31 bit Ä‘á»ƒ trÃ¡nh quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i khÃ´ng Ä‘Ã¡ng cÃ³ (láº¡i tá»‘n cÃ´ng xá»­ lÃ½) sá»‘ thÃ nh object.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch Javascript hoáº¡t Ä‘á»™ng P1: KhÃ¡i quÃ¡t vá» engine, runtime vÃ  callstack","slug":"Cach-Javascript-hoat-dong-P1-Khai-quat-ve-engine-runtime-va-callstack","date":"2018-11-13T15:50:00.000Z","updated":"2018-11-13T15:51:06.078Z","comments":true,"path":"2018/11/Cach-Javascript-hoat-dong-P1-Khai-quat-ve-engine-runtime-va-callstack.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Cach-Javascript-hoat-dong-P1-Khai-quat-ve-engine-runtime-va-callstack.html","excerpt":"Javascript cÃ ng ngÃ y cÃ ng phá»• biáº¿n, cÃ³ nhiá»u nhÃ³m cÃ¡c láº­p trÃ¬nh viÃªn Ä‘Ã£ vÃ  Ä‘ang nÃ¢ng cáº¥p cÅ©ng nhÆ° há»— trá»£ JS á»Ÿ nhiá»u má»©c Ä‘á»™ khÃ¡c nhau: tá»« frontend Ä‘áº¿n backend, hybrid app, thiáº¿t bá»‹ nhÃºng vÃ  cÃ²n nhiá»u ná»¯a. BÃ i viáº¿t nÃ y má»Ÿ Ä‘áº§u cho 1 series hÆ°á»›ng tá»›i má»¥c Ä‘Ã­ch Ä‘Ã o sÃ¢u (aka Äá»¥c KhoÃ©t) vÃ o trong Javascript vÃ  cÃ¡ch mÃ  nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o: Báº±ng cÃ¡ch hiá»ƒu rÃµ cÃ¡c thÃ nh pháº§n cá»§a JS vÃ  cÃ¡ch mÃ  chÃºng tÆ°Æ¡ng tÃ¡c vá»›i nhau thÃ¬ báº¡n cÃ³ thá»ƒ viáº¿t code tá»‘t hÆ¡n vÃ  ngon hÆ¡n. BÃªn cáº¡nh Ä‘Ã³ team SessionStack cÅ©ng chia sáº» má»™t vÃ i bÃ­ kÃ­p trong khi xÃ¢y dá»±ng SessionStack - 1 á»©ng dá»¥ng Javascript nháº¹ nhÆ°ng cÃ³ cháº¥t lÆ°á»£ng cao vÃ  máº¡nh máº½.","text":"Javascript cÃ ng ngÃ y cÃ ng phá»• biáº¿n, cÃ³ nhiá»u nhÃ³m cÃ¡c láº­p trÃ¬nh viÃªn Ä‘Ã£ vÃ  Ä‘ang nÃ¢ng cáº¥p cÅ©ng nhÆ° há»— trá»£ JS á»Ÿ nhiá»u má»©c Ä‘á»™ khÃ¡c nhau: tá»« frontend Ä‘áº¿n backend, hybrid app, thiáº¿t bá»‹ nhÃºng vÃ  cÃ²n nhiá»u ná»¯a. BÃ i viáº¿t nÃ y má»Ÿ Ä‘áº§u cho 1 series hÆ°á»›ng tá»›i má»¥c Ä‘Ã­ch Ä‘Ã o sÃ¢u (aka Äá»¥c KhoÃ©t) vÃ o trong Javascript vÃ  cÃ¡ch mÃ  nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o: Báº±ng cÃ¡ch hiá»ƒu rÃµ cÃ¡c thÃ nh pháº§n cá»§a JS vÃ  cÃ¡ch mÃ  chÃºng tÆ°Æ¡ng tÃ¡c vá»›i nhau thÃ¬ báº¡n cÃ³ thá»ƒ viáº¿t code tá»‘t hÆ¡n vÃ  ngon hÆ¡n. BÃªn cáº¡nh Ä‘Ã³ team SessionStack cÅ©ng chia sáº» má»™t vÃ i bÃ­ kÃ­p trong khi xÃ¢y dá»±ng SessionStack - 1 á»©ng dá»¥ng Javascript nháº¹ nhÆ°ng cÃ³ cháº¥t lÆ°á»£ng cao vÃ  máº¡nh máº½.NhÆ° ta tháº¥y trong GitHut stats, Javascript Ä‘ang lÃ  top Ä‘á»©ng Ä‘áº§u trong cÃ¡c repo Ä‘ang hoáº¡t Ä‘á»™ng (Active Repositories) vÃ  tá»•ng sá»‘ push (Total Pushes) á»Ÿ GitHub. VÃ  nÃ³ cÅ©ng khÃ´ng bá»‹ tá»¥t lÃ¹i quÃ¡ nhiá»u á»Ÿ nhá»¯ng háº¡ng má»¥c khÃ¡c. (Xem cáº­p nháº­t má»›i nháº¥t vá» GitHut stat). Náº¿u dá»± Ã¡n phá»¥ thuá»™c quÃ¡ lá»›n vÃ o Javascript thÃ¬ cÃ³ nghÄ©a ráº±ng cÃ¡c láº­p trÃ¬nh viÃªn pháº£i táº­n dá»¥ng tá»‘i Ä‘a kháº£ nÄƒng mÃ  ngÃ´n ngá»¯ nÃ y cÅ©ng nhÆ° há»‡ sinh thÃ¡i (ecosystem) cá»§a nÃ³ cung cáº¥p vÃ  tháº¥u hiá»ƒu má»™t cÃ¡ch triá»‡t Ä‘á»ƒ vá» báº£n cháº¥t cá»§a nÃ³ Ä‘á»ƒ cÃ³ thá»ƒ xÃ¢y dá»±ng Ä‘Æ°á»£c nhá»¯ng cÃ´ng trÃ¬nh vi diá»‡u. VÃ  má»™t cÃ¡ch hiá»ƒn nhiÃªn lÃ  cÃ³ ráº¥t nhiá»u láº­p trÃ¬nh viÃªn Ä‘ang sá»­ dá»¥ng Javascript háº±ng ngÃ y nhÆ°ng láº¡i khÃ´ng cÃ³ kiáº¿n thá»©c hoáº·c khÃ´ng biáº¿t gÃ¬ vá» nhá»¯ng thá»© Ä‘ang thá»±c sá»± diá»…n ra bÃªn trong JS. Tá»•ng quanHáº§u nhÆ° má»i ngÆ°á»i ai cÅ©ng tá»«ng nghe qua bá»™ engine V8 vÃ  Ä‘a sá»‘ má»i ngÆ°á»i biáº¿t ráº±ng JS lÃ  má»™t ngÃ´n ngá»¯ Ä‘Æ¡n luá»“ng (single-thread) hoáº·c lÃ  nÃ³ sá»­ dá»¥ng hÃ ng Ä‘á»£i cÃ¡c callback (callback queue - khÃ´ng biáº¿t dá»‹ch sao cho Ä‘Ãºng) Trong bÃ i nÃ y, chÃºng ta sáº½ Ä‘i láº§n lÆ°á»£t má»™t cÃ¡ch chi tiáº¿t qua cÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n vÃ  giáº£i thÃ­ch cá»¥ thá»ƒ Javascript cháº¡y nhÆ° tháº¿ nÃ o. Báº±ng cÃ¡ch Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ viáº¿t code Ä‘Æ°á»£c tá»‘t hÆ¡n, xÃ¢y dá»±ng app cÃ³ kháº£ nÄƒng xá»­ lÃ½ API má»™t cÃ¡ch mÆ°á»£t mÃ , khÃ´ng bá»‹ block láº«n nhau (non-blocking apps). Náº¿u báº¡n lÃ  ngÆ°á»i má»›i há»c Javascript thÃ¬ bÃ i viáº¿t nÃ y sáº½ giÃºp báº¡n hiá»ƒu táº¡i sao Javascript láº¡i â€œquÃ¡i dá»‹â€ khi so sÃ¡nh vá»›i cÃ¡c ngÃ´n ngá»¯ khÃ¡c. VÃ  náº¿u báº¡n lÃ  má»™t dev cÃ³ kinh nghiá»‡m vá»›i JS thÃ¬ hi vá»ng bÃ i viáº¿t nÃ y sáº½ giÃºp Ã­ch cho báº¡n hiá»ƒu thÃªm vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a JS Runtime - thá»© mÃ  báº¡n Ä‘ang sá»­ dá»¥ng má»—i ngÃ y. JavaScript EngineEngine: Cá»— mÃ¡y - mÃ¬nh sáº½ khÃ´ng dá»‹ch tá»« mÃ  Ä‘á»ƒ nguyÃªn gá»‘c tiáº¿ng Anh Má»™t vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh cá»§a JS Engine chÃ­nh lÃ  bá»™ Google V8. Bá»™ engine V8 nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng trong Google Chrome vÃ  Node.js. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n nháº¥t cá»§a nÃ³: Engine gá»“m 2 thÃ nh pháº§n chÃ­nh: VÃ¹ng nhá»› heap (memory heap): khu vá»±c cáº¥p phÃ¡t bá»™ nhá»› NgÄƒn xáº¿p (call stack): Ä‘Ã¢y lÃ  nÆ¡i chá»©a cÃ¡c khung stack khi báº¡n thá»±c thi code. Runtime (MÃ´i trÆ°á»ng thá»±c thi)CÃ³ nhá»¯ng API trong trÃ¬nh duyá»‡t Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi Ä‘a sá»‘ JS developer hiá»‡n nay (vÃ­ dá»¥: setTimeout). Nhá»¯ng API nÃ y láº¡i khÃ´ng Ä‘Æ°á»£c cung cáº¥p bá»Ÿi cÃ¡c Engine. Váº­y thÃ¬ chÃºng tá»« Ä‘Ã¢u tá»›i ? Sá»± tháº­t cÃ³ Ä‘Ã´i chÃºt phá»©c táº¡p má»™t tÃ­. ChÃºng ta cÃ³ JS Engine nhÆ°ng thá»±c ra cÃ²n nhiá»u thá»© hÆ¡n tháº¿. CÃ¡c browser thÆ°á»ng cung cáº¥p má»™t há»‡ thá»‘ng Web APIs bao gá»“m nhiá»u thÃ nh pháº§n nhÆ° DOM, AJAX, setTimeout, vÃ¢n vÃ¢n vÃ  mÃ¢y mÃ¢y. VÃ  rá»“i cáº£ nhá»¯ng thá»© ná»•i tiáº¿ng nhÆ° event loop vÃ  callback queue ná»¯a. NgÄƒn xáº¿p (Call Stack)Javascript lÃ  ngÃ´n ngá»¯ láº­p trÃ¬nh Ä‘Æ¡n luá»“ng (single-threaded), nghÄ©a lÃ  nÃ³ chá»‰ cÃ³ 1 cÃ¡i call stack. VÃ¬ tháº¿ nÃ³ chá»‰ cÃ³ thá»ƒ lÃ m 1 cÃ´ng viá»‡c táº¡i 1 thá»i Ä‘iá»ƒm nháº¥t Ä‘á»‹nh. Call Stack lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u mÃ  vá» cÆ¡ báº£n thÃ¬ nÃ³ ghi nhá»› vá»‹ trÃ­ cá»§a chÃºng ta trong chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y. Náº¿u nhÆ° chÃºng ta thá»±c thi má»™t hÃ m (function) thÃ¬ khi Ä‘Ã³ ta sáº½ Ä‘áº·t hÃ m Ä‘áº¥y vÃ o vá»‹ trÃ­ trÃªn cÃ¹ng cá»§a ngÄƒn xáº¿p (stack), sau khi xá»­ lÃ½ xong vÃ  return tá»« hÃ m Ä‘Ã³, vá»‹ trÃ­ trÃªn cÃ¹ng sáº½ bá»‹ Ä‘áº©y ra khá»i stack. ÄÃ³ lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Call Stack. Äá»ƒ dá»… hiá»ƒu hÆ¡n thÃ¬ má»i báº¡n xem vÃ­ dá»¥ bÃªn dÆ°á»›i: 12345678function multiply(x, y) &#123; return x * y;&#125;function printSquare(x) &#123; var s = multiply(x, x); console.log(s);&#125;printSquare(5); Khi engine báº¯t Ä‘áº§u thá»±c thi code, Call Stack cÃ²n Ä‘ang rá»—ng. Ngay sau Ä‘Ã³, tá»«ng bÆ°á»›c thá»±c hiá»‡n sáº½ giá»‘ng nhÆ° hÃ¬nh bÃªn dÆ°á»›i: Má»—i báº£n ghi trong Call Stack Ä‘Æ°á»£c gá»i lÃ  khung cá»§a ngÄƒn xáº¿p (Stack Frame). VÃ  Ä‘Ã¢y cÅ©ng lÃ  cÃ¡ch chÃ­nh xÃ¡c mÃ  stack traces Ä‘Æ°á»£c xÃ¢y dá»±ng vÃ  in ra má»—i khi cÃ³ xá»­ lÃ½ biá»‡t lá»‡ (exception handling). Vá» cÆ¡ báº£n thÃ¬ nÃ³ chÃ­nh lÃ  tráº¡ng thÃ¡i cá»§a Call Stack ngay táº¡i thá»i Ä‘iá»ƒm cÃ³ biá»‡t lá»‡ xáº£y ra. HÃ£y nhÃ¬n vÃ o Ä‘oáº¡n code bÃªn dÆ°á»›i: 12345678910function foo() &#123; throw new Error('SessionStack will help you resolve crashes :)');&#125;function bar() &#123; foo();&#125;function start() &#123; bar();&#125;start(); Náº¿u nhÆ° cháº¡y Ä‘oáº¡n code Ä‘Ã³ trÃªn Chrome console (giáº£ sá»­ toÃ n bá»™ code náº±m trong 1 file foo.js), thÃ¬ chÃºng ta sáº½ cÃ³ stack trace nhÆ° sau: Thá»•i tung ngÄƒn xáº¿p (Blowing the stack) - TrÆ°á»ng há»£p nÃ y xáº£y ra khi chÆ°Æ¡ng trÃ¬nh thá»±c thi Ä‘áº¡t tá»›i kÃ­ch thÆ°á»›c giá»›i háº¡n tá»‘i Ä‘a cá»§a Call Stack. VÃ  Ä‘á»ƒ cÃ³ thá»ƒ cÃ³ Ä‘Æ°á»£c tÃ¬nh huá»‘ng nÃ y má»™t cÃ¡ch dá»… dÃ ng nháº¥t, chá»‰ cáº§n vÃ´ tÃ¬nh gá»i Ä‘á»‡ quy má»™t cÃ¡ch khÃ´ng cáº©n tháº­n lÃ  Ä‘Æ°á»£c Ã : 1234function foo() &#123; foo();&#125;foo(); Khi engine báº¯t Ä‘áº§u thá»±c thi code, nÃ³ gá»i hÃ m foo Ä‘áº§u tiÃªn. HÃ m nÃ y láº¡i gá»i Ä‘á»‡ quy chÃ­nh báº£n thÃ¢n nÃ³ Ä‘á»ƒ rá»“i rÆ¡i vÃ o 1 vÃ²ng láº·p vÃ´ háº¡n khÃ´ng cÃ³ Ä‘iá»u kiá»‡n dá»«ng. Má»—i khi gá»i hÃ m thÃ¬ 1 báº£n ghi sáº½ Ä‘Æ°á»£c Ä‘áº©y vÃ o Call Stack, vÃ  cá»© tháº¿, cá»© thá»ƒ Ä‘áº©y vÃ o lÃ m cho trÃ n ngÄƒn xáº¿p (aka stackoverflow). Giá»‘ng nhÆ° hÃ¬nh bÃªn dÆ°á»›i: Táº¡i 1 thá»i Ä‘iá»ƒm cá»¥ thá»ƒ nÃ o Ä‘Ã³ khi sá»‘ láº§n gá»i hÃ m Ä‘áº¡t tá»›i ngÆ°á»¡ng giá»›i háº¡n cá»§a Call Stack (call stack size) thÃ¬ trÃ¬nh duyá»‡t sáº½ quyáº¿t Ä‘á»‹nh â€œgiáº£i cá»©uâ€ báº±ng cÃ¡ch báº¯n ra 1 lá»—i trÃ´ng nhÆ° tháº¿ nÃ y Ä‘Ã¢y: Cháº¡y code Ä‘Æ¡n tiáº¿n trÃ¬nh cÃ³ thá»ƒ khÃ¡ lÃ  dá»… dÃ ng bá»Ÿi vÃ¬ chÃºng ta khÃ´ng pháº£i máº¥t cÃ´ng Ä‘á»‘i phÃ³ vá»›i nhá»¯ng tÃ¬nh huá»‘ng phá»©c táº¡p thÆ°á»ng gáº·p trong mÃ´i trÆ°á»ng Ä‘a tiáº¿n trÃ¬nh (cháº³ng háº¡n nhÆ° deadlocks). Tuy nhiÃªn Ä‘Æ¡n tiáº¿n trÃ¬nh cÅ©ng cÃ³ nhá»¯ng giá»›i háº¡n cá»§a nÃ³. Bá»Ÿi vÃ¬ Javascript chá»‰ cÃ³ 1 Call Stack, Ä‘iá»u gÃ¬ sáº½ xáº£y ra khi cÃ³ vÃ i xá»­ lÃ½ cháº­m cháº¡p? Xá»­ lÃ½ Ä‘á»“ng thá»i (Concurrency) &amp; VÃ²ng láº·p sá»± kiá»‡n (Event Loop)Äiá»u gÃ¬ sáº½ xáº£y ra náº¿u nhÆ° báº¡n cÃ³ 1 hÃ m xá»­ lÃ½ Ä‘ang á»Ÿ trong Call Stack nhÆ°ng hÃ m Ä‘Ã³ láº¡i tá»‘n kha khÃ¡ thá»i gian Ä‘á»ƒ cháº¡y? VÃ­ dá»¥ nhÆ° báº¡n muá»‘n thá»±c hiá»‡n má»™t vÃ i thuáº­t toÃ¡n chuyá»ƒn Ä‘á»•i hÃ¬nh áº£nh phá»©c táº¡p báº±ng Javascript ngay trÃªn trÃ¬nh duyá»‡t. Tháº¿ thÃ¬ cÃ³ váº¥n Ä‘á» gÃ¬ nÃ o? Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  trong khi Call Stack Ä‘ang báº­n tá»‘i tÄƒm máº·t mÅ©i Ä‘á»ƒ xá»­ lÃ½ thÃ¬ trÃ¬nh duyá»‡t láº¡i ráº£nh khÃ´ng, ngá»“i chÆ¡i xÆ¡i nÆ°á»›c vÃ¬ khÃ´ng cÃ³ gÃ¬ Ä‘á»ƒ lÃ m, Ä‘Ãºng hÆ¡n lÃ  khÃ´ng thá»ƒ lÃ m gÃ¬ Ä‘Æ°á»£c - trÃ¬nh duyá»‡t Ä‘Ã£ bá»‹ block. CÃ³ nghÄ©a lÃ  trÃ¬nh duyá»‡t khÃ´ng thá»ƒ render, nÃ³ cÅ©ng khÃ´ng cháº¡y Ä‘Æ°á»£c cÃ¡c cÃ¢u lá»‡nh khÃ¡c, tÃ³m láº¡i lÃ  bá»‹ máº¯c káº¹t. Äiá»u nÃ y gÃ¢y áº£nh hÆ°á»Ÿng lá»›n Ä‘áº¿n sá»± mÆ°á»£t mÃ  cá»§a UI trÃªn app. ÄÃ³ cÅ©ng khÃ´ng pháº£i váº¥n Ä‘á» duy nháº¥t Ä‘Ã¢u. Má»™t khi trÃ¬nh duyá»‡t báº¯t Ä‘áº§u xá»­ lÃ½ quÃ¡ nhiá»u thá»© trong Call Stack, nÃ³ sáº½ bá»‹ â€œÄ‘Æ¡â€, khÃ´ng thá»ƒ tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c trong 1 khoáº£ng thá»i gian dÃ i. Äa sá»‘ trÃ¬nh duyá»‡t sáº½ báº¯n ra lá»—i, há»i báº¡n xem cÃ³ muá»‘n há»§y trang Ä‘ang cháº¡y khÃ´ng. Äáº¡i loáº¡i lÃ  giá»‘ng nhÆ° hÃ¬nh dÆ°á»›i: RÃµ rÃ ng Ä‘iá»u nÃ y khÃ´ng pháº£i lÃ  1 tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng (User experience) tá»‘i Æ°u pháº£i khÃ´ng nÃ o? Váº­y thÃ¬ lÃ m tháº¿ nÃ o Ä‘á»ƒ xá»­ lÃ½ code vá»«a nhiá»u vá»«a náº·ng mÃ  láº¡i khÃ´ng lÃ m UI bá»‹ káº¹t cÅ©ng nhÆ° trÃ¬nh duyá»‡t bá»‹ Ä‘Æ¡? Giáº£i phÃ¡p Ä‘Ã³ lÃ  sá»­ dá»¥ng callback báº¥t Ä‘á»“ng bá»™ (asynchronous callbacks). Äiá»u nÃ y sáº½ Ä‘Æ°á»£c giáº£i thÃ­ch ká»¹ hÆ¡n trong Pháº§n 2 cá»§a series: BÃªn trong engine V8 &amp; 5 máº¹o Ä‘á»ƒ tá»‘i Æ°u hÃ³a code. CÃ¡c báº¡n Ä‘Ã³n xem nhÃ©. PS: Trong cÃ¡c bÃ i sau mÃ¬nh sáº½ trÃ¬nh bÃ y chi tiáº¿t vÃ  ká»¹ hÆ¡n vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Event Loop.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Má»™t sá»‘ nguyÃªn táº¯c, Ä‘á»‹nh luáº­t trong láº­p trÃ¬nh","slug":"Mot-so-nguyen-tac-dinh-luat-trong-lap-trinh","date":"2018-11-06T00:29:00.000Z","updated":"2018-11-06T00:41:54.871Z","comments":true,"path":"2018/11/Mot-so-nguyen-tac-dinh-luat-trong-lap-trinh.html","link":"","permalink":"http://nthung2112.github.io/2018/11/Mot-so-nguyen-tac-dinh-luat-trong-lap-trinh.html","excerpt":"NguyÃªn táº¯c DemeterCÃ²n cÃ³ tÃªn gá»i khÃ¡c lÃ  nguyÃªn táº¯c â€œcÃ ng biáº¿t Ã­t cÃ ng tá»‘tâ€. Demeter lÃ  tÃªn gá»i cá»§a Ná»¯ tháº§n nÃ´ng nghiá»‡p, cÅ©ng lÃ  ná»¯ tháº§n phÃ¢n phÃ¡t trong tháº§n thoáº¡i Hi Láº¡p. TÃªn bÃ  Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u sá»± ra Ä‘á»i cá»§a nguyÃªn táº¯c nÃ y, Ä‘Ã¢y cÃ³ thá»ƒ xem lÃ  má»™t triáº¿t lÃ½ ná»n táº£ng cá»§a viá»‡c láº­p trÃ¬nh Ä‘Æ°á»£c sinh ra tá»« má»™t aspect-oriented programming (AOP) project cÃ¹ng tÃªn.","text":"NguyÃªn táº¯c DemeterCÃ²n cÃ³ tÃªn gá»i khÃ¡c lÃ  nguyÃªn táº¯c â€œcÃ ng biáº¿t Ã­t cÃ ng tá»‘tâ€. Demeter lÃ  tÃªn gá»i cá»§a Ná»¯ tháº§n nÃ´ng nghiá»‡p, cÅ©ng lÃ  ná»¯ tháº§n phÃ¢n phÃ¡t trong tháº§n thoáº¡i Hi Láº¡p. TÃªn bÃ  Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u sá»± ra Ä‘á»i cá»§a nguyÃªn táº¯c nÃ y, Ä‘Ã¢y cÃ³ thá»ƒ xem lÃ  má»™t triáº¿t lÃ½ ná»n táº£ng cá»§a viá»‡c láº­p trÃ¬nh Ä‘Æ°á»£c sinh ra tá»« má»™t aspect-oriented programming (AOP) project cÃ¹ng tÃªn.Quan Ä‘iá»ƒm cÆ¡ báº£n cá»§a nguyÃªn táº¯c nÃ y chÃ­nh lÃ  : tá»‘i giáº£n sá»± hiá»ƒu biáº¿t cá»§a 1 object vá» cáº¥u trÃºc, thuá»™c tÃ­nh cá»§a cÃ¡c object khÃ¡c ngoÃ i nÃ³ (bao gá»“m cÃ¡c thÃ nh pháº§n con). http://en.wikipedia.org/wiki/Law_of_Demeter NÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n lÃ  khÃ´ng Ä‘Æ°á»£c tiáº¿p xÃºc vá»›i thuá»™c tÃ­nh, method cá»§a cÃ¡c object khÃ¡c má»™t cÃ¡ch trá»±c tiáº¿p. 12345#Vi pháº¡m nguyÃªn táº¯c Demeterconsole.log(aStudent.class.grade)#KhÃ´ng vi pháº¡m nguyÃªn táº¯c Demeterconsole.log(aStudent.getGrade()) Äá»‹nh luáº­t Wirthâ€œSoftware gets slower faster than hardware gets fasterâ€ â€“ â€œTá»‘c Ä‘á»™ tiáº¿n hÃ³a cá»§a pháº§n cá»©ng khÃ´ng báº±ng tá»‘c Ä‘á»™ thoÃ¡i hÃ³a cá»§a pháº§n má»m.â€ http://en.wikipedia.org/wiki/Wirthâ€™s_law CÃ³ láº½ Ã½ chÃ­nh cá»§a nÃ³ lÃ  : láº­p trÃ¬nh ngÃ y cÃ ng dÃ¹ng nhiá»u tÃ i nguyÃªn phong phÃº nÃªn framework pháº£i luÃ´n tiáº¿n hÃ³a Ä‘á»ƒ phá»¥c vá»¥ cho viá»‡c Ä‘Ã³. Suy ra, tá»‘c Ä‘á»™ pháº§n cá»©ng dÃ¹ cÃ³ tang lÃªn Ä‘i ná»¯a thÃ¬ tá»‘c Ä‘á»™ pháº§n má»m cÅ©ng cháº³ng há» thay Ä‘á»•i gÃ¬. Äá»‹nh luáº­t BrookÄÃ¢y lÃ  má»™t Ä‘á»‹nh luáº­t dá»±a trÃªn kinh nghiá»‡m thá»±c táº¿ : â€œÄÆ°a thÃªm ngÆ°á»i vÃ o 1 project Ä‘ang cháº­m, sáº½ chá»‰ khiáº¿n nÃ³ cÃ ng cháº­m hÆ¡n.â€ Hay cÃ³ thá»ƒ nÃ³i theo má»™t cÃ¡ch khÃ¡c ná»¯a lÃ  â€œTáº­p há»£p 9 bÃ  báº§u láº¡i cÅ©ng khÃ´ng thá»ƒ khiáº¿n Ä‘á»©a tráº» ra Ä‘á»i sau 1 thÃ¡ng.â€ Luáº­n thuyáº¿t cÆ¡ báº£n cá»§a Ä‘á»‹nh luáº­t nÃ y lÃ  Cáº§n thá»i gian Ä‘á»ƒ quen vá»›i project CÃ´ng sá»©c dÃ nh cho viá»‡c communication sáº½ tÄƒng http://en.wikipedia.org/wiki/Brooksâ€™s_law Äá»‹nh luáº­t Conwayâ€œOrganizations which design systems â€¦ are constrained to produce designs which are copies of the communication structures of these organizations.â€ â€œMá»™t cÃ´ng ty thiáº¿t káº¿ há»‡ thá»‘ng tháº¿ nÃ o cÅ©ng sáº½ lÃ m ra nhá»¯ng thiáº¿t káº¿ giá»‘ng y há»‡t vá»›i thiáº¿t káº¿ há»‡ thá»‘ng cá»§a chÃ­nh cÃ´ng ty há».â€ http://en.wikipedia.org/wiki/Conwayâ€™s_law NghiÃªn cá»©u gáº§n Ä‘Ã¢y chá»‰ ra ráº±ng há»‡ thá»‘ng cá»§a cÃ´ng ty lÃ  nhÃ¢n tá»‘ áº£nh hÆ°á»Ÿng lá»›n nháº¥t Ä‘áº¿n váº¥n Ä‘á» phÃ¡t sinh ra bug cá»§a sáº£n pháº©m. http://research.microsoft.com/apps/pubs/default.aspx?id=70535 NguyÃªn táº¯c báº¥t ngá» nhá» nháº¥t (least astonishment)Trong trÆ°á»ng há»£p trÃªn cÃ¹ng 1 interface cÃ³ 2 yáº¿u tá»‘ hÃ nh xá»­ mÃ¢u thuáº«n vá»›i nhau, hoáº·c cÃ¡ch hÃ nh xá»­ khÃ´ng rÃµ rÃ ng thÃ¬ cáº§n pháº£i chá»n cÃ¡ch hÃ nh xá»­ nÃ o gÃ¢y báº¥t ngá» Ã­t nháº¥t cho ngÆ°á»i sá»­ dá»¥ng. http://en.wikipedia.org/wiki/Principle_of_least_astonishment ÄÃ¢y lÃ  1 nguyÃªn táº¯c vá» giao diá»‡n ngÆ°á»i dÃ¹ng. Má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n : TrÃªn 1 interface cÃ³ 2 chá»©c nÄƒng : áº¤n ctrl+Q Ä‘á»ƒ thoÃ¡t chÆ°Æ¡ng trÃ¬nh. Nháº­p macro (lÆ°u 1 tá»• há»£p phÃ­m mang 1 chá»©c nÄƒng nÃ o Ä‘Ã³ Ä‘á»ƒ tiá»‡n cho viá»‡c sá»­ dá»¥ng vá» sau). Sáº½ cÃ³ trÆ°á»ng há»£p user muá»‘n dÃ¹ng Ctrl+Q cho macro cá»§a mÃ¬nh, nÃªn hÃ nh xá»­ Ä‘Ãºng vá»›i nguyÃªn táº¯c báº¥t ngá» nhá» nháº¥t chÃ­nh lÃ  : trong khi nháº­p macro thÃ¬ ctrl+Q Ä‘Æ°á»£c coi nhÆ° lÃ  tá»• há»£p phÃ­m bÃ¬nh thÆ°á»ng, khÃ´ng pháº£i lÃ  lá»‡nh táº¯t chÆ°Æ¡ng trÃ¬nh. ÄÃ¢y chÃ­nh lÃ  Ä‘iá»u gÃ¢y báº¥t ngá» Ã­t nháº¥t cho ngÆ°á»i dÃ¹ng. NguyÃªn táº¯c Boy ScoutNguyÃªn táº¯c cá»§a cÃ¡c tá»• chá»©c Boy scout chÃ­nh lÃ  : lÃºc Ä‘i pháº£i sáº¡ch Ä‘áº¹p hÆ¡n lÃºc Ä‘áº¿n. Trong lÄ©nh vá»±c láº­p trÃ¬nh thÃ¬ nguyÃªn táº¯c Ä‘Ã³ sáº½ Ä‘Æ°á»£c hiá»ƒu lÃ  â€œKhi báº¡n checkin 1 module thÃ¬ lÃºc Ä‘Ã³ nÃ³ pháº£i Ä‘áº¹p hÆ¡n lÃºc báº¡n checkout.â€ NguyÃªn táº¯c YAGNIViáº¿t táº¯t cá»§a â€œYou ainâ€™t gonna need itâ€ â€“ CÃ¡i (chá»©c nÄƒng, pháº§n) áº¥y rá»“i sáº½ khÃ´ng cáº§n thiáº¿t. ÄÃ³ lÃ  má»™t cÃ¢u kháº©u ngá»¯ nháº¯c nhá»Ÿ ngÆ°á»i láº­p trÃ¬nh ráº±ng trong quy trÃ¬nh Extreme Programming (láº­p trÃ¬nh cá»±c háº¡n) thÃ¬ : â€œChÆ°a pháº£i lÃºc cáº§n thiáº¿t thÃ¬ chÆ°a Ä‘Æ°á»£c phÃ©p lÃ m.â€ NguyÃªn táº¯c DRYViáº¿t táº¯t cá»§a â€œDonâ€™t repeat yourselfâ€ â€“ vá»›i Ã½ nghÄ©a lÃ  â€œÄá»«ng láº·p láº¡i nhá»¯ng gÃ¬ giá»‘ng nhauâ€. http://en.wikipedia.org/wiki/Donâ€™t_repeat_yourself Khi nguyÃªn táº¯c nÃ y Ä‘Æ°á»£c Ã¡p dá»¥ng tá»‘t, dÃ¹ ta cÃ³ thay Ä‘á»•i 1 pháº§n thÃ¬ nhá»¯ng pháº§n khÃ´ng liÃªn quan cÅ©ng sáº½ khÃ´ng bá»‹ thay Ä‘á»•i theo. HÆ¡n ná»¯a, nhá»¯ng pháº§n cÃ³ liÃªn quan sáº½ Ä‘Æ°á»£c thay Ä‘á»•i cÃ¹ng 1 lÆ°á»£t, giÃºp Ã­ch ráº¥t nhiá»u cho cáº£ khÃ¢u estimate vÃ  khÃ¢u thá»±c hiá»‡n. NguyÃªn táº¯c KISSViáº¿t táº¯t cá»§a â€œKeep it simple, stupidâ€ â€“ â€œCá»© Ä‘Æ¡n giáº£n thÃ´i, Ä‘á»“ ngu!â€. ÄÃ¢y lÃ  1 triáº¿t lÃ­ cá»§a Háº£i quÃ¢n Má»¹. http://en.wikipedia.org/wiki/KISS_principle Nhá»¯ng triáº¿t lÃ½ tÆ°Æ¡ng tá»± cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n lÃ  : PhÆ°Æ¡ng chÃ¢m dao cáº¡o Okham (Okhamâ€™s razor) â€“ â€œKhÃ´ng Ä‘Æ°a ra nhiá»u giáº£ thiáº¿t náº¿u khÃ´ng cáº§n thiáº¿t. CÃ¡i gÃ¬ cáº§n Ã­t giáº£ thiáº¿t Ä‘á»ƒ chá»©ng minh sáº½ khÃ´ng thá»ƒ chá»©ng minh Ä‘Æ°á»£c báº±ng nhiá»u giáº£ thiáº¿t.â€ Albert Einstein â€“ â€œLÃ m cÃ¡i gÃ¬ cÅ©ng nÃªn Ä‘Æ¡n giáº£n nháº¥t cÃ³ thá»ƒ, nhÆ°ng Ä‘Æ¡n giáº£n quÃ¡ thÃ¬ khÃ´ng Ä‘Æ°á»£câ€. Leonardo da Vinci â€“ â€œÄÆ¡n giáº£n nháº¥t chÃ­nh lÃ  Ä‘iÃªu luyá»‡n nháº¥tâ€. Antoine de Saint- ExupÃ©ry â€“ â€œHoÃ n háº£o, khÃ´ng pháº£i lÃ  khÃ´ng thÃªm vÃ o Ä‘Æ°á»£c ná»¯a, mÃ  lÃ  khÃ´ng thá»ƒ bá»›t Ä‘i Ä‘Æ°á»£c ná»¯aâ€. NguyÃªn táº¯c SOLIDTáº­p há»£p nhá»¯ng nguyÃªn táº¯c trong láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng. CÃ¡c chá»¯ cÃ¡i Ä‘áº§u há»£p láº¡i thÃ nh SOLID. http://en.wikipedia.org/wiki/SOLID_(object-oriented_design)) SRP (Single Responsibility Principle) â€“ â€œMá»™t class chá»‰ Ä‘Æ°á»£c cÃ³ 1 nhiá»‡m vá»¥â€ hay nÃ³i cÃ¡ch khÃ¡c, â€œnáº¿u muá»‘n chá»‰nh sá»­a class thÃ¬ chá»‰ Ä‘Æ°á»£c phÃ©p cÃ³ 1 vÃ  chá»‰ 1 lÃ½ doâ€. OCP (Open/closed principle) â€“ â€œMá»Ÿ class khi cáº§n má»Ÿ rá»™ng nÃ³, Ä‘Ã³ng class khi cáº§n chá»‰nh sá»­a nÃ³â€. LSP (Liskov substitution principle) â€“ â€œSubtype pháº£i luÃ´n cÃ³ thá»ƒ Ä‘Æ°á»£c thay tháº¿ báº±ng supertypeâ€. ISP (Interface segregation principle) â€“ â€œViá»‡c dÃ¹ng nhiá»u interface cho cÃ¡c client khÃ¡c nhau, tá»‘t hÆ¡n lÃ  viá»‡c chá»‰ dÃ¹ng 1 interface cho cÃ¹ng lÃºc nhiá»u má»¥c Ä‘Ã­châ€ hay nÃ³i cÃ¡ch khÃ¡c â€œKhÃ´ng Ä‘Æ°á»£c phÃ©p háº¡n cháº¿ access vÃ o nhá»¯ng method mÃ  client khÃ´ng sá»­ dá»¥ngâ€. DIP (Dependency inversion principle) â€“ â€œModule táº§ng trÃªn khÃ´ng Ä‘Æ°á»£c phá»¥ thuá»™c vÃ o module táº§ng dÆ°á»›i. Báº¥t cá»© module nÃ o cÅ©ng pháº£i phá»¥ thuá»™c vÃ o cÃ¡i trá»«u tÆ°á»£ng, khÃ´ng pháº£i vÃ o cÃ¡i cá»¥ thá»ƒâ€.","categories":[],"tags":[]},{"title":"Khi nÃ o nÃªn sá»­ dá»¥ng PureComponent hoáº·c Component","slug":"Khi-nao-nen-su-dung-PureComponent-hoac-Component","date":"2018-10-17T00:57:00.000Z","updated":"2018-11-07T01:00:18.161Z","comments":true,"path":"2018/10/Khi-nao-nen-su-dung-PureComponent-hoac-Component.html","link":"","permalink":"http://nthung2112.github.io/2018/10/Khi-nao-nen-su-dung-PureComponent-hoac-Component.html","excerpt":"PureComponent tiá»n Ä‘á» cá»§a nÃ³ lÃ  má»™t phiÃªn báº£n cÃ³ hiá»‡u suáº¥t cao hÆ¡n cá»§a Component. Äiá»u nÃ y lÃ  Ä‘Ãºng, nhÆ°ng hiá»‡u suáº¥t Ä‘áº¡t Ä‘Æ°á»£c Ä‘i cÃ¹ng vá»›i má»™t vÃ i thá»© Ä‘i kÃ¨m. ChÃºng ta hÃ£y tÃ¬m hiá»ƒu vá» PureComponent vÃ  hiá»ƒu táº¡i sao chÃºng ta nÃªn sá»­ dá»¥ng nÃ³ nhÃ©.","text":"PureComponent tiá»n Ä‘á» cá»§a nÃ³ lÃ  má»™t phiÃªn báº£n cÃ³ hiá»‡u suáº¥t cao hÆ¡n cá»§a Component. Äiá»u nÃ y lÃ  Ä‘Ãºng, nhÆ°ng hiá»‡u suáº¥t Ä‘áº¡t Ä‘Æ°á»£c Ä‘i cÃ¹ng vá»›i má»™t vÃ i thá»© Ä‘i kÃ¨m. ChÃºng ta hÃ£y tÃ¬m hiá»ƒu vá» PureComponent vÃ  hiá»ƒu táº¡i sao chÃºng ta nÃªn sá»­ dá»¥ng nÃ³ nhÃ©. Component vÃ  PureComponent cÃ³ má»™t sá»± khÃ¡c biá»‡t1PureComponent chÃ­nh xÃ¡c giá»‘ng nhÆ° Component ngoáº¡i trá»« viá»‡c Ä‘Ã³ lÃ  nÃ³ xá»­ lÃ½ shouldComponentUpdate cho báº¡n. Khi props hoáº·c state thay Ä‘á»•i, PureComponent sáº½ lÃ m má»™t shallow comparison (so sÃ¡nh nÃ´ng) trÃªn cáº£m props vÃ  state. Component trÃªn máº·t khÃ¡c sáº½ khÃ´ng so sÃ¡nh props vÃ  state cá»§a hiá»‡n táº¡i vá»›i tÆ°Æ¡ng lai. NhÆ° váº­y, component sáº½ re-render bá»Ÿi máº·c Ä‘á»‹nh báº¥t cá»© khi nÃ o shouldComponentUpdate gá»i. Shallow Comparison 101Khi so sÃ¡nh props vÃ  state trÆ°á»›c vÃ  sau, má»™t shallow comparison sáº½ kiá»ƒm tra nhá»¯ng giÃ¡ trá»‹ nguyÃªn thuá»· Ä‘Ã³ cÃ³ cÃ¹ng giÃ¡ trá»‹(vÃ­ dá»¥ 1 báº±ng 1 hoáº·c true báº±ng vá»›i true) vÃ  ráº±ng cÃ¡c references value lÃ  giá»‘ng nhau giá»¯a cÃ¡c giÃ¡ trá»‹ javascript phá»©c táº¡p nhÆ° objects vÃ  arrays. Never MUTATEBáº¡n cÃ³ láº½ Ä‘Ã£ nghe khÃ´ng thay Ä‘á»•i objects vÃ  arrays trong props vÃ  state. Náº¿u báº¡n thay Ä‘á»•i object trong má»™t component cha, component â€œpureâ€ con cá»§a báº¡n sáº½ khÃ´ng update. Máº·c dÃ¹ giÃ¡ trá»‹ Ä‘Ã£ thay Ä‘á»•i á»Ÿ component cha, component con sáº½ so sÃ¡nh reference tá»›i props trÆ°á»›c Ä‘Ã³ vÃ  khÃ´ng phÃ¡t hiá»‡n ra sá»± khÃ¡c biá»‡t chÃºng vÃ¢n cÃ¹ng reference tá»›i cÃ¹ng má»™t object. Thay vÃ o Ä‘Ã³ tráº£ vá» má»™t objects má»›i khi báº¡n lÃ m má»™t sá»± thay Ä‘á»•i báº±ng cÃ¡ch táº­n dá»¥ng es6 cho object vÃ  array spreading hoáº·c sá»­ dá»¥ng má»™t thÆ° viá»‡n Ä‘á»ƒ thi hÃ nh immutability. CÃ³ váº¥n Ä‘á» vá»›i hiá»‡u nÄƒng khÃ´ng?So sÃ¡nh primitives vÃ  object references lÃ  má»™t hoáº·t Ä‘á»™ng vÃ´ cÃ¹ng ráº» tiá»n. Náº¿u báº¡n cÃ³ má»™t danh sÃ¡ch cá»§a object con vÃ  má»™t trong Ä‘Ã³ update, lÃ m má»™t kiá»ƒm tra trÃªn props vÃ  state cá»§a chÃºng lÃ  so sÃ¡nh nhanh nhÆ° Ã¡nh sÃ¡ng so vá»›i chi phÃ­ cá»§a viá»‡c re-render tá»«ng cÃ¡i má»™t. Nhá»¯ng cÃ¡ch khÃ¡c báº¡n cÃ³ thá»ƒ lÃ m Ä‘á»ƒ tÄƒng hiá»‡u nÄƒngÄá»«ng bind giÃ¡ trá»‹ vÃ o fuction trong renderBáº¡n cÃ³ má»™t danh sÃ¡ch cÃ¡c items, má»—i láº§n chuyá»n má»™t tham sá»‘ Ä‘á»™c nháº¥t tá»›i phÆ°Æ¡ng thá»©c cha. Theo thá»© tá»± bind parameter báº¡n cÃ³ láº½ sáº½ hoÃ n thÃ nh nhÆ° thÃª nÃ y: 1&lt;CommentItem likeComment=&#123;() =&gt; this.likeComment(user.id)&#125; /&gt; váº¥n Ä‘á» Ä‘Ã³ lÃ  má»—i láº§n component cha render method sáº½ gá»i, má»™t function má»›i (vá»›i má»™t reference má»›i) Ä‘Æ°á»£c táº¡o ra vÃ  chuyá»n xuá»‘ng LikeComnent. Äiá»u nÃ y cÃ³ side effect cá»§a thay Ä‘á»•i props trÃªn má»—i component con mÃ  láº§n lÆ°á»£t sáº½ lÃ  nguyÃªn nhÃ¢n tÃ¢t cáº£ chÃºng re-render, tháº­m chÃ­ táº¥t cáº£ dá»¯ liá»‡u lÃ  giá»‘ng nhau. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chá»‰ cáº§n chuyá»n function nguyÃªn máº«u tá»« component cha tá»›i con. prop cá»§a LikeComent sáº½ luÃ´n luÃ´n cÃ³ cÃ¹ng reference vÃ  khÃ´ng bao giá» gÃ¢y ra re-render khÃ´ng cáº§n thiáº¿t. 1&lt;CommentItem likeComment=&#123;this.likeComment&#125; userID=&#123;user.id&#125; /&gt; Sau Ä‘Ã³ trong component con táº¡o ra má»™t class method sáº½ reference props cá»§a nÃ³: 1234567class CommentItem extends PureComponent &#123; ... handleLike() &#123; this.props.likeComment(this.props.userID) &#125; ...&#125; Äá»«ng láº¥y dá»¯ liá»‡u trong renderXem xÃ©t má»™t danh sÃ¡ch cá»§a cÃ¡c bÃ i viáº¿t tá»« Ä‘Ã³ component há»“ sÆ¡ cá»§a báº¡n sáº½ hiá»ƒn thá»‹ 10 ngÆ°á»i dÃ¹ng báº¡n thÃ­ch nháº¥t. 123456render() &#123; const &#123; posts &#125; = this.props const topTen = [...posts].sort((a, b) =&gt; b.likes - a.likes).slice(0, 9) return //...&#125; TopTen sáº½ cÃ³ má»™t new reference má»—i láº§n component re-render, máº·c dÃ¹ posts khÃ´ng cÃ³ sá»± thay Ä‘á»•i vÃ  dá»¯ liá»‡u cÃ³ cÃ¹ng nguá»“n gá»‘c. Äiá»u nÃ y sau Ä‘Ã³ sáº½ re-render list má»™t cÃ¡ch khÃ´ng cáº§n thiáº¿t. Báº¡n cÃ³ thá»ƒ giáº£i quyáº¿t Ä‘iá»u nÃ y bá»Ÿi caching dá»¯ liá»‡u gá»‘c. Cho vÃ­ dá»¥, Ä‘áº·t dá»¯ liá»‡u gá»‘c trong state cá»§a component vÃ  update chá»‰ khi posts cÃ³ updated. 12345678910111213componentWillMount() &#123; this.setTopTenPosts(this.props.posts)&#125;componentWillReceiveProps(nextProps) &#123; if (this.props.posts !== nextProps.posts) &#123; this.setTopTenPosts(nextProps.posts) &#125;&#125;setTopTenPosts(posts) &#123; this.setState(&#123; topTen: [...posts].sort((a, b) =&gt; b.likes - a.likes).slice(0, 9) &#125;)&#125; Náº¿u báº¡n sá»­ dá»¥ng Redux, xem xÃ©t sá»­ dá»¥ng reselect Ä‘á»ƒ táº¡o â€œselectorsâ€ Ä‘á»ƒ soáº¡n vÃ  cache dá»¯ liá»‡u gá»‘c. Tá»•ng káº¿tAn toÃ n khi sá»­ dá»¥ng pureComponent thay tháº¿ Component miá»…n lÃ  báº¡n theo hai quy táº¯c Ä‘Æ¡n giáº£n sau: Thay Ä‘á»•i Ä‘á»™t ngá»™t reference value nhÃ¬n chung lÃ  khÃ´ng tá»‘t. NhÆ°ng váº¥n Ä‘á» lÃ  phá»©c táº¡p khi sá»­ dá»¥ng PureComponent. Náº¿u báº¡n táº¡o ra má»™t function, object, array má»›i trong render báº¡n (cÃ³ láº½) lÃ m nÃ³ sai.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"Redux hay MobX: LÃ½ giáº£i sá»± nháº§m láº«n","slug":"Redux-hay-MobX-Ly-giai-su-nham-lan","date":"2018-09-06T00:18:00.000Z","updated":"2018-11-06T00:20:35.856Z","comments":true,"path":"2018/09/Redux-hay-MobX-Ly-giai-su-nham-lan.html","link":"","permalink":"http://nthung2112.github.io/2018/09/Redux-hay-MobX-Ly-giai-su-nham-lan.html","excerpt":"ChÃºng ta cáº§n giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬?Táº¥t cáº£ chÃºng ta Ä‘á»u muá»‘n cÃ³ má»™t cÃ¡ch nÃ o Ä‘Ã³ Ä‘á»ƒ quáº£n lÃ½ state trong má»™t á»©ng dá»¥ng. NhÆ°ng báº¡n Ä‘Ã£ bao giá» tá»± há»i nÃ³ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» gÃ¬ cho chÃºng ta chÆ°a? Háº§u háº¿t cÃ¡c láº­p trÃ¬nh viÃªn Ä‘á»u sá»­ dá»¥ng má»™t thÆ° viá»‡n quáº£n lÃ½ state ngay cáº£ Ä‘á»‘i vá»›i nhá»¯ng á»©ng dá»¥ng nhá». Hiá»ƒn nhiÃªn thÃ´i mÃ , khi táº¥t cáº£ nhá»¯ng ngÆ°á»i khÃ¡c Ä‘á»u nÃ³i vá» chÃºng, táº¥t nhiÃªn chÃºng ta cÅ©ng pháº£i báº¯t ká»‹p xu tháº¿ chá»©? Redux nÃ y, MobX nÃ y. Tháº¿ nhÆ°ng háº§u háº¿t cÃ¡c á»©ng dá»¥ng láº¡i khÃ´ng cáº§n Ä‘áº¿n nhá»¯ng cÃ´ng cá»¥ quáº£n lÃ½ state phá»©c táº¡p Ä‘áº¿n váº­y. NÃ³ cÃ²n nguy hiá»ƒm hÆ¡n, vÃ¬ háº§u háº¿t má»i ngÆ°á»i sáº½ khÃ´ng bao giá» gáº·p nhá»¯ng váº¥n Ä‘á» mÃ  nhá»¯ng thÆ° viá»‡n nhÆ° Redux hay MobX cá»‘ gáº¯ng Ä‘á»ƒ giáº£i quyáº¿t.","text":"ChÃºng ta cáº§n giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬?Táº¥t cáº£ chÃºng ta Ä‘á»u muá»‘n cÃ³ má»™t cÃ¡ch nÃ o Ä‘Ã³ Ä‘á»ƒ quáº£n lÃ½ state trong má»™t á»©ng dá»¥ng. NhÆ°ng báº¡n Ä‘Ã£ bao giá» tá»± há»i nÃ³ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» gÃ¬ cho chÃºng ta chÆ°a? Háº§u háº¿t cÃ¡c láº­p trÃ¬nh viÃªn Ä‘á»u sá»­ dá»¥ng má»™t thÆ° viá»‡n quáº£n lÃ½ state ngay cáº£ Ä‘á»‘i vá»›i nhá»¯ng á»©ng dá»¥ng nhá». Hiá»ƒn nhiÃªn thÃ´i mÃ , khi táº¥t cáº£ nhá»¯ng ngÆ°á»i khÃ¡c Ä‘á»u nÃ³i vá» chÃºng, táº¥t nhiÃªn chÃºng ta cÅ©ng pháº£i báº¯t ká»‹p xu tháº¿ chá»©? Redux nÃ y, MobX nÃ y. Tháº¿ nhÆ°ng háº§u háº¿t cÃ¡c á»©ng dá»¥ng láº¡i khÃ´ng cáº§n Ä‘áº¿n nhá»¯ng cÃ´ng cá»¥ quáº£n lÃ½ state phá»©c táº¡p Ä‘áº¿n váº­y. NÃ³ cÃ²n nguy hiá»ƒm hÆ¡n, vÃ¬ háº§u háº¿t má»i ngÆ°á»i sáº½ khÃ´ng bao giá» gáº·p nhá»¯ng váº¥n Ä‘á» mÃ  nhá»¯ng thÆ° viá»‡n nhÆ° Redux hay MobX cá»‘ gáº¯ng Ä‘á»ƒ giáº£i quyáº¿t.NgÃ y nay, má»™t hiá»‡n tráº¡ng mÃ  chÃºng ta dá»… dÃ ng tháº¥y lÃ  viá»‡c má»i ngÆ°á»i Ä‘á»u viáº¿t ra nhá»¯ng frontend app vá»›i cÃ¡c component. Component thÃ¬ cÃ³ state ná»™i táº¡i. VÃ­ dá»¥ trong React thÃ¬ state ná»™i táº¡i Ä‘Ã³ Ä‘Æ°á»£c xá»­ lÃ½ báº±ng this.state vÃ  this.setState(). Vá»›i nhá»¯ng app lá»›n, váº¥n Ä‘á» guáº£n lÃ½ state cÃ³ thá»ƒ trá»Ÿ nÃªn khÃ³ khÄƒn vá»›i state ná»™i bá»™ bá»Ÿi vÃ¬: Má»™t component cáº§n pháº£i chia sáº» state vá»›i má»™t component khÃ¡c. Má»™t component cáº§n pháº£i thay Ä‘á»•i state cá»§a má»™t component khÃ¡c. Äáº¿n má»™t lÃºc nÃ o Ä‘Ã³, váº¥n Ä‘á» nÃ y cÃ ng ngÃ y cÃ ng trá»Ÿ nÃªn khÃ³ giáº£i quyáº¿t khi nÃ³ trá»Ÿ thÃ nh má»™t Ä‘á»‘ng há»—n loáº¡n cÃ¡c state object vÃ  cÃ¡c thay Ä‘á»•i diá»…n ra chá»“ng chÃ©o nhau kháº¯p cÃ¡c component vÃ  ráº¥t khÃ³ Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ quáº£n lÃ½ táº¥t cáº£ má»™t cÃ¡ch hiá»‡u quáº£. Suy ra Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng thÆ° viá»‡n nhÆ° MobX hay Redux. Nhá»¯ng thÆ° viá»‡n nÃ y cung cáº¥p cho chÃºng ta cÃ´ng cá»¥ Ä‘á»ƒ lÆ°u giá»¯ state, thay Ä‘á»•i state vÃ  nháº­n nhá»¯ng thay Ä‘á»•i cá»§a state. Báº¡n cÃ³ má»™t chá»— Ä‘á»ƒ tÃ¬m state, má»™t chá»— Ä‘á»ƒ thay Ä‘á»•i nÃ³ vÃ  cÅ©ng má»™t chá»— Ä‘á»ƒ nháº­n cÃ¡c thay Ä‘á»•i. ChÃºng tuÃ¢n theo nguyÃªn táº¯c single source of truth (chá»‰ má»™t nÆ¡i Ä‘á»ƒ lÆ°u trá»¯ toÃ n bá»™ state). NÃ³ lÃ m cho viá»‡c quáº£n lÃ½ state trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n vÃ¬ nÃ³ Ä‘Æ°á»£c tÃ¡ch rá»i khá»i cÃ¡c component cá»§a báº¡n. CÃ¡c thÆ° viá»‡n quáº£n lÃ½ state nhÆ° Redux hay MobX thÆ°á»ng cÃ³ cÃ¡c add-on Ä‘i kÃ¨m, nhÆ° vá»›i React thÃ¬ chÃºng ta cÃ³ react-redux vÃ  mobx-react, Ä‘á»ƒ cung cáº¥p cho cÃ¡c component cÃ¡ch Ä‘á»ƒ truy cáº­p cÃ¡c state. ThÆ°á»ng thÃ¬ cÃ¡c component Ä‘Ã³ Ä‘Æ°á»£c gá»i lÃ  container component, hay chÃ­nh xÃ¡c hÆ¡n lÃ , connected component. Báº¡n cÃ³ thá»ƒ truy cáº­p hoáº·c thay Ä‘á»•i state tá»« báº¥t cá»© Ä‘Ã¢u trong á»©ng dá»¥ng cá»§a báº¡n báº±ng cÃ¡ch biáº¿n cÃ¡c component thÃ nh cÃ¡c connected component. Redux vÃ  MobX cÃ³ gÃ¬ khÃ¡c nhau?TrÆ°á»›c khi chÃºng ta nÃ³i vá» nhá»¯ng khÃ¡c biá»‡t, tÃ´i muá»‘n nÃ³i vá» má»™t sá»‘ Ä‘iá»ƒm chung giá»¯a MobX vÃ  Redux. Cáº£ 2 thÆ° viá»‡n Ä‘á»u Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ state trong cÃ¡c á»©ng dá»¥ng Javascript. ChÃºng khÃ´ng nháº¥t thiáº¿t pháº£i Ä‘i kÃ¨m vá»›i má»™t thÆ° viá»‡n nhÆ° React. ChÃºng cÅ©ng Ä‘Æ°á»£c dÃ¹ng trong nhá»¯ng thÆ° viá»‡n khÃ¡c nhÆ° AngularJs hay VueJs ná»¯a. NhÆ°ng chÃºng káº¿t há»£p ráº¥t tá»‘t vá»›i triáº¿t lÃ½ cá»§a React. Náº¿u báº¡n chá»n dÃ¹ng má»™t thÆ° viá»‡n Ä‘á»ƒ quáº£n lÃ½ state, báº¡n sáº½ khÃ´ng bá»‹ rÃ ng buá»™c bá»Ÿi nÃ³. Báº¡n cÃ³ thá»ƒ chuyá»ƒn qua sá»­ dá»¥ng má»™t thÆ° viá»‡n khÃ¡c báº¥t ká»³ lÃºc nÃ o. Báº¡n hoÃ n toÃ n cÃ³ thá»ƒ chuyá»ƒn tá»« MobX sang Redux hoáº·c ngÆ°á»£c láº¡i. Redux bá»Ÿi Dan Abramov vÃ  Andrew Clark lÃ  má»™t biáº¿n thá»ƒ cá»§a kiáº¿n trÃºc flux. TrÃ¡i ngÆ°á»£c vá»›i flux, nÃ³ chá»‰ sá»­ dá»¥ng duy nháº¥t má»™t store Ä‘á»ƒ lÆ°u trá»¯ state. HÆ¡n ná»¯a, thay vÃ¬ sá»­ dá»¥ng má»™t dispatcher, nÃ³ dÃ¹ng cÃ¡c pure function Ä‘á»ƒ thay Ä‘á»•i state. Redux bá»‹ áº£nh hÆ°á»Ÿng ráº¥t nhiá»u bá»Ÿi cÃ¡c nguyÃªn táº¯c cá»§a functional programming (FP). ChÃºng ta cÃ³ thá»ƒ cÃ³ FP trong Javascript, nhÆ°ng ráº¥t nhiá»u ngÆ°á»i Ä‘Ã£ quen vá»›i OOP nhÆ° Java, vÃ  há» gáº·p ráº¥t nhiá»u khÃ³ khÄƒn trong viá»‡c á»©ng dá»¥ng cÃ¡c nguyÃªn táº¯c nÃ y. Äiá»u nÃ y cÅ©ng lÃ½ giáº£i táº¡i sao MobX cÃ³ thá»ƒ sáº½ dá»… há»c hÆ¡n Ä‘á»‘i vá»›i ngÆ°á»i má»›i. Bá»Ÿi vÃ¬ Redux Ã¡p dá»¥ng cÃ¡c nguyÃªn táº¯c cá»§a FP, nÃ³ sá»­ dá»¥ng hÃ m thuáº§n khiáº¿t. Má»™t hÃ m nháº­n input, tráº£ vá» output vÃ  khÃ´ng cÃ³ thÃªm báº¥t cá»© sá»± phá»¥ thuá»™c nÃ o khÃ¡c. Má»™t hÃ m thuáº§n khiáº¿t luÃ´n tráº£ vá» cÃ¹ng má»™t output Ä‘á»‘i vá»›i cÃ¹ng má»™t input vÃ  khÃ´ng há» cÃ³ side effect. 1(state, action) =&gt; newState Redux state lÃ  immutable. Thay vÃ¬ thay Ä‘á»•i state, báº¡n luÃ´n tráº£ vá» má»™t state má»›i. Báº¡n khÃ´ng bao giá» trá»±c tiáº¿p thay Ä‘á»•i object state hay phá»¥ thuá»™c vÃ o tham chiáº¿u Ä‘áº¿n object. 123456789// Äá»«ng lÃ m tháº¿ nÃ y trong Redux vÃ¬ nÃ³ trá»±c tiáº¿p thay Ä‘á»•i arrayfunction addAuthor(state, action) &#123; return state.authors.push(action.author);&#125;// LuÃ´n giá»¯ state immutable vÃ  tráº£ vá» object má»›ifunction addAuthor(state, action) &#123; return [ ...state.authors, action.author ];&#125; Äiá»u cuá»‘i cÃ¹ng nhÆ°ng ko kÃ©m pháº§n quan trá»ng, state cá»§a báº¡n Ä‘Æ°á»£c normalize nhÆ° trong má»™t database. CÃ¡c entity chá»‰ tham chiáº¿u Ä‘áº¿n nhau báº±ng id. ÄÃ³ lÃ  cÃ¡ch lÃ m tá»‘t nháº¥t. Máº·c dÃ¹ khÃ´ng pháº£i táº¥t cáº£ má»i ngÆ°á»i Ä‘á»u lÃ m váº­y, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng má»™t thÆ° viá»‡n nhÆ° normalizr Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c state Ä‘Ã£ chuáº©n hÃ³a. Normalized state giÃºp cho chÃºng ta cÃ³ má»™t state pháº³ng vÃ  lÆ°u giá»¯ cÃ¡c entity nhÆ° má»™t nguá»“n duy nháº¥t. 123456789101112&#123; post: &#123; id: 'a', authorId: 'b', ... &#125;, author: &#123; id: 'b', postIds: ['a', ...], ... &#125;&#125; Trong khi Ä‘Ã³, MobX bá»Ÿi Michel Weststrate láº¡i chá»‹u áº£nh hÆ°á»Ÿng cá»§a láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng, nhÆ°ng cÅ©ng má»™t pháº§n bá»Ÿi láº­p trÃ¬nh pháº£n á»©ng (Reactive programming). NÃ³ Ä‘á»‘ng gÃ³i state cá»§a báº¡n thÃ nh nhá»¯ng observable. VÃ¬ tháº¿ báº¡n cÃ³ má»i kháº£ nÄƒng cá»§a má»™t Observable trong state cá»§a báº¡n. Dá»¯ liá»‡u cÃ³ thá»ƒ chá»‰ cáº§n cÃ³ setter vÃ  getter thÃ´i, nhÆ°ng observable lÃ m cho chÃºng ta cÃ³ kháº£ nÄƒng nháº­n update khi dá»¯ liá»‡u thay Ä‘á»•i. Trong MobX, state lÃ  mutable. NghÄ©a lÃ  báº¡n thay Ä‘á»•i state trá»±c tiáº¿p: 123function addAuthor(author) &#123; this.authors.push(author);&#125; ThÃªm ná»¯a, cÃ¡c entity tá»“n táº¡i dÆ°á»›i má»™t cáº¥u trÃºc dá»¯ liá»‡u lá»“ng nhau. Báº¡n khÃ´ng cáº§n chuáº©n hÃ³a state. State Ä‘Æ°á»£c giá»¯ khÃ´ng chuáº©n hÃ³a vÃ  cÃ³ thá»ƒ lá»“ng nhiá»u táº§ng. 12345678910&#123; post: &#123; id: 'a', ... author: &#123; id: 'b', ... &#125; &#125;&#125; 1 Store vÃ  nhiá»u StoreTrong Redux báº¡n giá»¯ má»i state trong má»™t global store/global state. State object nÃ y lÃ  nguá»“n dá»¯ liá»‡u duy nháº¥t cá»§a báº¡n. Máº·t khÃ¡c, chÃºng ta sá»­ dá»¥ng nhiá»u reducer Ä‘á»ƒ thay Ä‘á»•i state nÃ y. TrÃ¡i láº¡i, MobX láº¡i dÃ¹ng nhiá»u store. TÆ°Æ¡ng tá»± nhÆ° reducer cá»§a Redux, báº¡n cÃ³ thá»ƒ Ã¡p dá»¥ng chia Ä‘á»ƒ trá»‹ báº±ng cÃ¡ch phÃ¢n bá»• chÃºng thÃ nh nhiá»u táº§ng dá»¯ liá»‡u. Báº¡n cÃ³ thá»ƒ muá»‘n cÃ³ cÃ¡c domain entity trong má»™t store riÃªng nhÆ°ng váº«n cÃ³ kháº£ nÄƒng kiá»ƒm soÃ¡t state cá»§a view trong má»™t trong cÃ¡c store cá»§a báº¡n. Sau cÃ¹ng thÃ¬ báº¡n lÃ  ngÆ°á»i quyáº¿t Ä‘á»‹nh vÃ  Ä‘á»‹nh hÆ°á»›ng láº¡i cáº¥u trÃºc state nÃ o cÃ³ lá»£i cho á»©ng dá»¥ng cá»§a báº¡n nháº¥t. TrÃªn lÃ½ thuyáº¿t báº¡n cÅ©ng cÃ³ thá»ƒ cÃ³ nhiá»u store trong Redux. KhÃ´ng cÃ³ ai báº¯t báº¡n pháº£i dÃ¹ng chá»‰ má»™t store cáº£. NhÆ°ng Ä‘Ã³ khÃ´ng pháº£i lÃ  cÃ¡ch ngÆ°á»i ta khuyÃªn dÃ¹ng Redux. NÃ³ sáº½ lÃ m trÃ¡i láº¡i nhá»¯ng best practice náº¿u báº¡n dÃ¹ng nhiá»u store. Trong Redux báº¡n chá»‰ cáº§n cÃ³ má»™t store thÃ´i vÃ  pháº£n á»©ng vá»›i nhá»¯ng thay Ä‘á»•i thÃ´ng qua reducer vÃ  cÃ¡c global event. Implementation nhÃ¬n nhÆ° tháº¿ nÃ o?Trong Redux, báº¡n sáº½ cáº§n Ä‘oáº¡n code nhÆ° dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ thÃªm má»™t user vÃ o global state. Báº¡n cÃ³ thá»ƒ tháº¥y chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng spread operator Ä‘á»ƒ tráº£ vá» má»™t state object má»›i. Báº¡n cÅ©ng cÃ³ thá»ƒ dÃ¹ng Object.assign() Ä‘á»ƒ táº¡o ra má»™t immutable object trong ES5. 1234567891011121314151617181920212223const initialState = &#123; users: [ &#123; name: 'Dan' &#125;, &#123; name: 'Michel' &#125; ]&#125;;// reducerfunction users(state = initialState, action) &#123; switch (action.type) &#123; case 'USER_ADD': return &#123; ...state, users: [ ...state.users, action.user ] &#125;; default: return state; &#125;&#125;// action&#123; type: 'USER_ADD', user: user &#125;; Báº¡n sáº½ cáº§n pháº£i gá»i dispatch({ type: â€˜USER_ADDâ€™, user: user }); Ä‘á»ƒ thÃªm má»™t user má»›i vÃ o global state. Trong MobX, má»™t store sáº½ chá»‰ quáº£n lÃ½ má»™t substate (nhÆ° má»™t reducer trong Redux quáº£n lÃ½ má»™t substate) nhÆ°ng báº¡n cÃ³ thá»ƒ thay Ä‘á»•i state má»™t cÃ¡ch trá»±c tiáº¿p. Annotation @observable giÃºp cho chÃºng ta cÃ³ kháº£ nÄƒng nháº­n update khi state thay Ä‘á»•i. 12345678910class UserStore &#123; @observable users = [ &#123; name: 'Dan' &#125;, &#123; name: 'Michel' &#125; ];&#125; Giá» thÃ¬ chÃºng ta cÃ³ thá»ƒ gá»i userStore.users.push(user); vÃ o má»™t instance cá»§a store. Tuy váº­y best practice Ä‘Ã³ lÃ  xá»­ lÃ½ viá»‡c thay Ä‘á»•i state rÃµ rÃ ng hÆ¡n vá»›i cÃ¡c action. 1234567891011121314class UserStore &#123; @observable users = [ &#123; name: 'Dan' &#125;, &#123; name: 'Michel' &#125; ]; @action addUser = (user) =&gt; &#123; this.users.push(user); &#125;&#125; Báº¡n cÃ³ thá»ƒ báº¯t buá»™c viá»‡c sá»­ dá»¥ng action báº±ng cÃ¡ch cáº¥u hÃ¬nh Mobx vá»›i configure({ enforceActions: true });. Giá» thÃ¬ báº¡n cÃ³ thá»ƒ thay Ä‘á»•i state báº±ng cÃ¡ch gá»i userStore.addUser(user); vá»›i má»™t instance cá»§a store. Báº¡n Ä‘Ã£ tháº¥y cÃ¡ch chÃºng ta cáº­p nháº­t state trong cáº£ Redux vÃ  MobX. ChÃºng ráº¥t khÃ¡c nhau. Trong Redux state cá»§a báº¡n lÃ  read-only. Báº¡n chá»‰ cÃ³ thá»ƒ thay Ä‘á»•i state báº±ng cÃ¡c action rÃµ rÃ ng. NgÆ°á»£c láº¡i, state trong MobX láº¡i cÃ³ thá»ƒ vá»«a read vÃ  vá»«a write. Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i state trá»±c tiáº¿p mÃ  khÃ´ng cáº§n dÃ¹ng action, nhÆ°ng báº¡n cÅ©ng cÃ³ thá»ƒ báº¯t buá»™c sá»­ dá»¥ng action vá»›i cáº¥u hÃ¬nh Ä‘Ã£ nÃ³i á»Ÿ trÃªn. Learning curve cá»§a quáº£n lÃ½ state trong ReactCáº£ Redux vÃ  MobX Ä‘á»u háº§u háº¿t Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c á»©ng dá»¥ng React. NhÆ°ng báº£n cháº¥t cá»§a chÃºng thÃ¬ lÃ  nhá»¯ng thÆ° viá»‡n quáº£n lÃ½ state Ä‘á»™c láº­p, vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng mÃ  khÃ´ng cáº§n Ä‘áº¿n React. ChÃºng cÃ²n cÃ³ nhá»¯ng thÆ° viá»‡n há»— trá»£ tÆ°Æ¡ng thÃ­ch Ä‘á»ƒ lÃ m cho viá»‡c káº¿t há»£p vá»›i React component trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n, Ä‘Ã³ lÃ  react-redux cho Redux + React vÃ  mobx-react cho MobX + React. Trong nhá»¯ng tháº£o luáº­n trÃªn cÃ¡c diá»…n Ä‘Ã n cÃ´ng nghá»‡ thÃ¬ má»™t váº¥n Ä‘á» mÃ  ngÆ°á»i ta hay nÃ³i Ä‘áº¿n Ä‘Ã³ lÃ  learning curve cá»§a Redux. ThÆ°á»ng thÃ¬ nÃ³ diá»…n ra trong bá»‘i cáº£nh má»i ngÆ°á»i báº¯t Ä‘áº§u há»c React nhÆ°ng Ä‘Ã£ muá»‘n tÃ¬m hiá»ƒu lÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ quáº£n lÃ½ state vá»›i Redux. Nhiá»u ngÆ°á»i sáº½ cho ráº±ng React vÃ  Redux náº±m riÃªng thÃ¬ cÃ³ má»™t learning curve khÃ¡ tá»‘t, nhÆ°ng káº¿t há»£p cáº£ 2 láº¡i thÃ¬ chÃºng láº¡i khÃ³ hiá»ƒu hÆ¡n nhiá»u. VÃ¬ tháº¿ MobX Ä‘Æ°á»£c coi lÃ  má»™t giáº£i phÃ¡p thay tháº¿ vÃ¬ nÃ³ phÃ¹ há»£p hÆ¡n vá»›i nhá»¯ng ngÆ°á»i má»›i há»c. Tuy váº­y, tÃ´i muá»‘n gá»£i Ã½ má»™t cÃ¡ch tiáº¿p cáº­n khÃ¡c cho cÃ¡c báº¡n má»›i há»c React vá» váº¥n Ä‘á» quáº£n lÃ½ state, Ä‘Ã³ lÃ  báº¯t Ä‘áº§u vá»›i chÃ­nh nhá»¯ng tÃ­nh nÄƒng quáº£n lÃ½ state ná»™i bá»™ cá»§a component. Trong má»™t á»©ng dá»¥ng React, Ä‘iá»u Ä‘áº§u tiÃªn mÃ  báº¡n sáº½ há»c Ä‘Ã³ lÃ  cÃ¡c hÃ m náº±m trong vÃ²ng Ä‘á»i cá»§a má»™t component vÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ quáº£n lÃ½ state báº±ng setState() vÃ  this.state. ÄÃ¢y lÃ  má»™t cÃ¡ch há»c mÃ  tÃ´i Ä‘Ã¡nh giÃ¡ ráº¥t cao. Náº¿u khÃ´ng theo cÃ¡ch nÃ y, báº¡n sáº½ ráº¥t dá»… bá»‹ choÃ¡ng ngá»£p bá»Ÿi há»‡ sinh thÃ¡i cá»§a React. Äáº¿n má»™t thá»i Ä‘iá»ƒm nÃ o Ä‘Ã³ vá»›i cÃ¡ch há»c nÃ y, báº¡n sáº½ nháº­n ra ráº±ng viá»‡c quáº£n lÃ½ cÃ¡c state ná»™i bá»™ cá»§a component cÃ ng ngÃ y cÃ ng trá»Ÿ nÃªn khÃ³ hÆ¡n. ÄÃ³ lÃ  lÃºc mÃ  chÃºng ta tráº£ lá»i cÃ¢u há»i: Váº¥n Ä‘á» mÃ  MobX vÃ  Redux giáº£i quyáº¿t cho chÃºng ta lÃ  gÃ¬? Cáº£ 2 Ä‘á»u cung cáº¥p má»™t cÃ¡ch Ä‘á»ƒ quáº£n lÃ½ state cá»§a á»©ng dá»¥ng Ä‘á»™c láº­p vá»›i cÃ¡c component. State Ä‘Æ°á»£c tÃ¡ch biá»‡t hoÃ n toÃ n khá»i component. Component cÃ³ thá»ƒ truy cáº­p state, thay Ä‘á»•i nÃ³ vÃ  nháº­n nhá»¯ng cáº­p nháº­t vá»›i state má»›i. State Ä‘Ã³ chÃ­nh lÃ  single source of truth. Redux hay MobX cho ngÆ°á»i má»›i?Má»™t khi báº¡n Ä‘Ã£ quen vá»›i viá»‡c sá»­ dá»¥ng component vÃ  quáº£n lÃ½ state ná»™i bá»™, báº¡n cÃ³ thá»ƒ chá»n má»™t thÆ° viá»‡n Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y. Sau khi Ä‘Ã£ dÃ¹ng cáº£ 2 thÆ° viá»‡n, tÃ´i cho ráº±ng MobX ráº¥t phÃ¹ há»£p Ä‘á»‘i vá»›i ngÆ°á»i má»›i. ChÃºng ta Ä‘á»u Ä‘Ã£ tháº¥y MobX cáº§n Ã­t code hÆ¡n, dÃ¹ cho nÃ³ sá»­ dá»¥ng vÃ i loáº¡i annotation mÃ  cÃ³ láº½ chÃºng ta chÆ°a cáº§n hiá»ƒu vá» chÃºng. Vá»›i MobX báº¡n khÃ´ng cáº§n pháº£i lÃ m quen vá»›i láº­p trÃ¬nh hÃ m hay pháº£i hiá»ƒu nhá»¯ng thuáº­t ngá»¯ nhÆ° immutability. Láº­p trÃ¬nh hÃ m lÃ  má»™t mÃ´ hÃ¬nh Ä‘ang phÃ¡t triá»ƒn ráº¥t nhanh, nhÆ°ng láº¡i xa láº¡ vá»›i háº§u háº¿t cÃ¡c láº­p trÃ¬nh viÃªn Javascript. DÃ¹ tháº¿ giá»›i láº­p trÃ¬nh Ä‘ang dáº§n Ä‘Æ°á»£c Ä‘áº©y theo xu hÆ°á»›ng nÃ y nhÆ°ng khÃ´ng pháº£i ai cÅ©ng cÃ³ kinh nghiá»‡m vá» nÃ³, nÃªn cÃ¡c nguyÃªn lÃ½ cá»§a MobX sáº½ dá»… dÃ ng Ä‘á»ƒ hiá»ƒu hÆ¡n Ä‘á»‘i vá»›i nhá»¯ng ngÆ°á»i Ä‘Ã£ biáº¿t vá» hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng. Má»™t á»©ng dá»¥ng Ä‘ang phÃ¡t triá»ƒnTrong MobX, báº¡n thay Ä‘á»•i object cÃ³ annotation vÃ  component cá»§a báº¡n sáº½ tá»± Ä‘á»™ng render láº¡i. MobX Ä‘em Ä‘áº¿n nhiá»u xá»­ lÃ½ ná»™i bá»™ hÆ¡n lÃ  Redux, nÃªn sáº½ lÃ m cho nÃ³ dá»… dÃ¹ng hÆ¡n lÃºc Ä‘áº§u vÃ¬ báº¡n pháº£i viáº¿t Ã­t code hÆ¡n. Náº¿u báº¡n Ä‘Ã£ biáº¿t Angular thÃ¬ sáº½ tháº¥y dÃ¹ng MobX giá»‘ng nhÆ° lÃ  two-way data binding váº­y. Báº¡n giá»¯ má»™t vÃ i state á»Ÿ Ä‘Ã¢u Ä‘Ã³, theo dÃµi state báº±ng annotation vÃ  Ä‘á»ƒ cho component tá»± update má»™t khi state thay Ä‘á»•i. 12// component&lt;button onClick=&#123;() =&gt; store.users.push(user)&#125; /&gt; CÃ¡ch tá»‘t hÆ¡n Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y Ä‘Ã³ lÃ  sá»­ dá»¥ng @action trong store. 1234567// component&lt;button onClick=&#123;() =&gt; store.addUser(user)&#125; /&gt;// store@action addUser = (user) =&gt; &#123; this.users.push(user);&#125; NÃ³ sáº½ lÃ m cho viá»‡c thay Ä‘á»•i state trá»Ÿ nÃªn minh báº¡ch hÆ¡n vá»›i cÃ¡c action. HÆ¡n ná»¯a chÃºng ta cÅ©ng cÃ³ thá»ƒ báº¯t buá»™c viá»‡c sá»­ dá»¥ng action Ä‘á»ƒ thay Ä‘á»•i state báº±ng cÃ¡ch mÃ  tÃ´i Ä‘Ã£ nÃ³i á»Ÿ trÃªn. 1234// root fileimport &#123; configure &#125; from 'mobx';configure(&#123; enforceActions: true &#125;); Viá»‡c thay Ä‘á»•i state trá»±c tiáº¿p trong store nhÆ° chÃºng ta Ä‘Ã£ lÃ m á»Ÿ vÃ­ dá»¥ thá»© nháº¥t sáº½ khÃ´ng cÃ²n hoáº¡t Ä‘á»™ng ná»¯a. Viá»‡c sá»­ dá»¥ng action lÃ  má»™t trong cÃ¡c best practice cá»§a MobX. HÆ¡n ná»¯a má»™t khi báº¡n chá»‰ dÃ¹ng action, báº¡n Ä‘Ã£ Ã¡p dá»¥ng cÃ¡c rÃ ng buá»™c cá»§a Redux. TÃ´i xin gá»£i Ã½ ráº±ng chÃºng ta nÃªn sá»­ dá»¥ng MobX Ä‘á»ƒ báº¯t Ä‘áº§u má»™t dá»± Ã¡n. Má»™t khi á»©ng dá»¥ng Ä‘Ã£ báº¯t Ä‘áº§u to lÃªn, Ä‘Ã³ cÅ©ng lÃ  Ä‘iá»u dá»… hiá»ƒu khi chÃºng ta báº¯t buá»™c viá»‡c sá»­ dá»¥ng cÃ¡c action. Äiá»u nÃ y cÅ©ng Ä‘i theo Ä‘Æ°á»ng lá»‘i cá»§a Redux Ä‘Ã³ lÃ  chÃºng ta khÃ´ng bao giá» thay Ä‘á»•i trá»±c tiáº¿p state mÃ  lÃºc nÃ o cÅ©ng pháº£i thÃ´ng qua cÃ¡c action. Chuyá»ƒn sang ReduxKhi mÃ  á»©ng dá»¥ng cá»§a báº¡n lá»›n dáº§n vÃ  cÃ³ thÃªm nhiá»u dev cÃ¹ng lÃ m viá»‡c, báº¡n nÃªn chuyá»ƒn qua dÃ¹ng Redux. Báº£n cháº¥t cá»§a nÃ³ lÃ  viá»‡c nÃ³ báº¯t buá»™c sá»­ dá»¥ng action Ä‘á»ƒ thay Ä‘á»•i state chá»© khÃ´ng thÃ´ng qua config nhÆ° MobX. Action bao gá»“m kiá»ƒu vÃ  má»™t payload vÃ  reducer cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ thay Ä‘á»•i state. 12// reducer(state, action) =&gt; newState Redux cung cáº¥p cho báº¡n cáº£ má»™t cáº¥u trÃºc Ä‘á»ƒ quáº£n lÃ½ state vá»›i nhá»¯ng rÃ ng buá»™c rÃµ rÃ ng. ÄÃ³ lÃ  lÃ½ do mÃ  Redux ráº¥t thÃ nh cÃ´ng. Má»™t Ä‘iá»ƒm máº¡nh khÃ¡c cá»§a Redux Ä‘Ã³ lÃ  viá»‡c sá»­ dá»¥ng nÃ³ á»Ÿ server side. Bá»Ÿi vÃ¬ chÃºng ta Ä‘ang lÃ m viá»‡c vá»›i Javascript object, báº¡n cÃ³ thá»ƒ gá»­i state qua máº¡ng Ä‘Æ°á»£c. Serialize vÃ  deserialize cÃ¡c state object hoáº¡t Ä‘á»™ng má»™t cÃ¡ch tá»± Ä‘á»™ng mÃ  báº¡n khÃ´ng cáº§n lÃ m thÃªm gÃ¬ cáº£. Báº¡n cÅ©ng cÃ³ thá»ƒ lÃ m nhÆ° tháº¿ vá»›i MobX ná»¯a. MobX thÃ¬ khÃ´ng cÃ³ nhiá»u rÃ ng buá»™c nhÆ°ng báº¡n cÅ©ng cÃ³ thá»ƒ tá»± táº¡o ra chÃºng báº±ng cÃ¡c config. ÄÃ³ lÃ  lÃ­ do táº¡i sao tÃ´i khÃ´ng nÃ³i lÃ  báº¡n khÃ´ng thá»ƒ dÃ¹ng MobX vá»›i nhá»¯ng á»©ng dá»¥ng lá»›n, nhÆ°ng Redux thÃ¬ giÃºp chÃºng ta cÃ³ má»™t cÃ¡ch lÃ m nháº¥t quÃ¡n hÆ¡n. Doc cá»§a MobX cÅ©ng cÃ³ nÃ³i lÃ : â€œMobX khÃ´ng hÆ°á»›ng dáº«n cho báº¡n cÃ¡ch báº¡n cáº¥u trÃºc code, lÆ°u state á»Ÿ Ä‘Ã¢u hay xá»­ lÃ½ cÃ¡c event nhÆ° tháº¿ nÃ o.â€ Team cá»§a báº¡n cáº§n pháº£i tá»± cáº¥u trÃºc viá»‡c quáº£n lÃ½ state náº¿u sá»­ dá»¥ng thÆ° viá»‡n nÃ y. Cuá»‘i cÃ¹ng thÃ¬ viá»‡c há»c quáº£n lÃ½ state khÃ´ng khÃ³ nhÆ° chÃºng ta nghÄ©. Äá»ƒ tÃ³m gá»n láº¡i váº¥n Ä‘á», má»™t ngÆ°á»i má»›i há»c React Ä‘áº§u tiÃªn sáº½ há»c cÃ¡ch sá»­ dá»¥ng setState() vÃ  this.state. Sau má»™t thá»i gian thÃ¬ há» sáº½ tháº¥y khÃ³ khÄƒn vá»›i viá»‡c chá»‰ dÃ¹ng setState() Ä‘á»ƒ quáº£n lÃ½ state cho cáº£ á»©ng dá»¥ng. Khi Ä‘i tÃ¬m giáº£i phÃ¡p, há» gáº·p Ä‘Æ°á»£c nhá»¯ng thÆ° viá»‡n nhÆ° MobX hay Redux. NhÆ°ng nÃªn chá»n cÃ¡i nÃ o bÃ¢y giá»? Bá»Ÿi vÃ¬ MobX cÃ³ Ã­t rÃ ng buá»™c hÆ¡n, cáº§n Ã­t code hÆ¡n vÃ  dÃ¹ng cÅ©ng tÆ°Æ¡ng tá»± nhÆ° setState(), tÃ´i nghÄ© nÃ³ ráº¥t thÃ­ch há»£p vá»›i cÃ¡c á»©ng dá»¥ng vá»«a vÃ  nhá». Má»™t khi á»©ng dá»¥ng Ä‘Ã£ to dáº§n lÃªn, báº¡n nÃªn xem xÃ©t viá»‡c táº¡o ra thÃªm rÃ ng buá»™c báº±ng config trong MobX hoáº·c chuyá»ƒn sang dÃ¹ng Redux. Lá»i káº¿tMá»—i khi tÃ´i Ä‘á»c comment vá» tranh luáº­n giá»¯a Redux vÃ  MobX, luÃ´n luÃ´n cÃ³ 1 comment kiá»ƒu nÃ y: â€œRedux cÃ³ quÃ¡ nhiá»u code thá»«a, báº¡n nÃªn dÃ¹ng MobX Ä‘i. TÃ´i Ä‘Ã£ bá» Ä‘Æ°á»£c XXX dÃ²ng code Ä‘áº¥y.â€ Comment nÃ y cÃ³ thá»ƒ Ä‘Ãºng, nhÆ°ng há» chÆ°a xem xÃ©t Ä‘áº¿n nhá»¯ng sá»± Ä‘Ã¡nh Ä‘á»•i. Redux cÃ³ nhiá»u code thá»«a hÆ¡n MobX, vÃ¬ nÃ³ Ä‘Æ°á»£c thÃªm vÃ o vÃ¬ nhá»¯ng rÃ ng buá»™c cá»¥ thá»ƒ trong thiáº¿t káº¿. NÃ³ cho phÃ©p báº¡n cÃ³ cÃ¡i nhÃ¬n tá»•ng quan hÆ¡n vá» state cá»§a á»©ng dá»¥ng dÃ¹ á»©ng dá»¥ng Ä‘Ã³ lá»›n tháº¿ nÃ o. KhÃ´ng pháº£i tá»± nhiÃªn mÃ  nÃ³ lÃ  má»™t trong nhá»¯ng thÆ° viá»‡n phá»• biáº¿n nháº¥t Ä‘Ã¢u. ThÆ° viá»‡n Redux cÃ³ kÃ­ch thÆ°á»›c khÃ¡ lÃ  nhá». Háº§u háº¿t thá»i gian báº¡n sáº½ dÃ nh Ä‘á»ƒ xá»­ lÃ½ Javascript object vÃ  array. NÃ³ giá»‘ng vá»›i Javascript thuáº§n hÆ¡n lÃ  MobX. Trong MobX, chÃºng ta gÃ³i object vÃ  array vÃ o trong observable object vÃ  Ä‘iá»u nÃ y giáº¥u Ä‘i háº§u háº¿t cÃ¡c boilerplate code. NÃ³ Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn tÃ­nh trá»«u tÆ°á»£ng áº©n. NÃ³ sáº½ thá»±c hiá»‡n má»™t phÃ©p thuáº­t nÃ o Ä‘Ã³ vÃ  code báº¡n tá»± nhiÃªn cháº¡y Ä‘Æ°á»£c, nhÆ°ng Ä‘á»“ng thá»i cÅ©ng lÃ m cho cÃ¡c cÆ¡ cháº¿ á»Ÿ táº§ng dÆ°á»›i trá»Ÿ nÃªn khÃ³ hiá»ƒu hÆ¡n nhiá»u. Vá»›i Redux thÃ¬ chÃºng ta test vÃ  debug á»©ng dá»¥ng dá»… hÆ¡n vÃ¬ nÃ³ chá»‰ sá»­ dá»¥ng Javascript thuáº§n. Trong khi vá»›i Redux, chÃºng ta cÃ³ má»™t cÃ¡ch nháº¥t Ä‘á»‹nh Ä‘á»ƒ lÃ m má»i thá»© thÃ¬ MobX láº¡i Ã­t rÃ ng buá»™c hÆ¡n. NhÆ°ng dÃ¹ váº­y chÃºng ta váº«n nÃªn tuÃ¢n theo cÃ¡c best practice trong MobX, vÃ¬ nhÆ° tháº¿ sáº½ dá»… dÃ ng hÆ¡n trong viá»‡c lÃ­ giáº£i thay Ä‘á»•i cá»§a state. Cáº£ 2 thÆ° viá»‡n Ä‘á»u ráº¥t tá»‘t. Trong khi Redux Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh trong tháº¿ giá»›i React, MobX Ä‘ang dáº§n trá»Ÿ thÃ nh má»™t giáº£i phÃ¡p thay tháº¿ Ä‘Ã¡ng chÃº Ã½.","categories":[],"tags":[{"name":"mobx","slug":"mobx","permalink":"http://nthung2112.github.io/tags/mobx/"},{"name":"redux","slug":"redux","permalink":"http://nthung2112.github.io/tags/redux/"}]},{"title":"CÃ¡ch tá»‘i Æ°u trang web cá»§a báº¡n vá»›i nÃ©n Gzip","slug":"Cach-toi-uu-trang-web-cua-ban-voi-nen-Gzip","date":"2018-08-07T13:45:00.000Z","updated":"2018-09-07T13:53:33.634Z","comments":true,"path":"2018/08/Cach-toi-uu-trang-web-cua-ban-voi-nen-Gzip.html","link":"","permalink":"http://nthung2112.github.io/2018/08/Cach-toi-uu-trang-web-cua-ban-voi-nen-Gzip.html","excerpt":"NÃ©n lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n, hiá»‡u quáº£ Ä‘á»ƒ tiáº¿t kiá»‡m bÄƒng thÃ´ng vÃ  tÄƒng tá»‘c trang web cá»§a báº¡n. TÃ´i Ä‘Ã£ ngáº§n ngáº¡i khi gá»£i Ã½ sá»­ dá»¥ng nÃ©n gzip khi tÄƒng tá»‘c táº£i file javascript cá»§a báº¡n vÃ¬ má»™t vÃ i váº¥n Ä‘á» á»Ÿ trÃ¬nh duyá»‡t cÅ©. NhÆ°ng giá» lÃ  tháº¿ ká»· 21. Háº§u háº¿t cÃ¡c truy cáº­p Ä‘áº¿n trang cá»§a tÃ´i Ä‘á»u tá»« cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i, vÃ  tháº³ng tháº¯n mÃ  nÃ³i, háº§u háº¿t ngÆ°á»i dÃ¹ng cá»§a tÃ´i Ä‘á»u am hiá»ƒu cÃ´ng nghá»‡. TÃ´i khÃ´ng muá»‘n lÃ m má»i ngÆ°á»i cháº­m láº¡i vÃ¬ má»™t vÃ i ngÆ°á»i Ä‘ang bÃ¡m láº¥y IE 4 trÃªn Windows 95. Google vÃ  Yahoo dÃ¹ng nÃ©n gzip. Má»™t trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i cáº§n Ä‘Æ°á»£c táº­n hÆ°á»Ÿng ná»™i dung vÃ  tá»‘c Ä‘á»™ cá»§a web hiá»‡n Ä‘áº¡i - váº­y thÃ¬ sá»­ dá»¥ng gzip mÃ£ hÃ³a nÃ³. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch cÃ i Ä‘áº·t.","text":"NÃ©n lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n, hiá»‡u quáº£ Ä‘á»ƒ tiáº¿t kiá»‡m bÄƒng thÃ´ng vÃ  tÄƒng tá»‘c trang web cá»§a báº¡n. TÃ´i Ä‘Ã£ ngáº§n ngáº¡i khi gá»£i Ã½ sá»­ dá»¥ng nÃ©n gzip khi tÄƒng tá»‘c táº£i file javascript cá»§a báº¡n vÃ¬ má»™t vÃ i váº¥n Ä‘á» á»Ÿ trÃ¬nh duyá»‡t cÅ©. NhÆ°ng giá» lÃ  tháº¿ ká»· 21. Háº§u háº¿t cÃ¡c truy cáº­p Ä‘áº¿n trang cá»§a tÃ´i Ä‘á»u tá»« cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i, vÃ  tháº³ng tháº¯n mÃ  nÃ³i, háº§u háº¿t ngÆ°á»i dÃ¹ng cá»§a tÃ´i Ä‘á»u am hiá»ƒu cÃ´ng nghá»‡. TÃ´i khÃ´ng muá»‘n lÃ m má»i ngÆ°á»i cháº­m láº¡i vÃ¬ má»™t vÃ i ngÆ°á»i Ä‘ang bÃ¡m láº¥y IE 4 trÃªn Windows 95. Google vÃ  Yahoo dÃ¹ng nÃ©n gzip. Má»™t trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i cáº§n Ä‘Æ°á»£c táº­n hÆ°á»Ÿng ná»™i dung vÃ  tá»‘c Ä‘á»™ cá»§a web hiá»‡n Ä‘áº¡i - váº­y thÃ¬ sá»­ dá»¥ng gzip mÃ£ hÃ³a nÃ³. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch cÃ i Ä‘áº·t. Khoan, khoan, khoan: táº¡i sao chÃºng ta láº¡i lÃ m Ä‘iá»u nÃ y?TrÆ°á»›c khi chÃºng ta báº¯t Ä‘áº§u, tÃ´i nÃªn giáº£i thÃ­ch ná»™i dung Ä‘Æ°á»£c mÃ£ hÃ³a lÃ  gÃ¬. Khi báº¡n yÃªu cáº§u má»™t file, vÃ­ dá»¥ nhÆ° http://www.yahoo.com/index.html, trÃ¬nh duyá»‡t cá»§a báº¡n nÃ³i chuyá»‡n vá»›i má»™t web server. Äoáº¡n há»™i thoáº¡i sáº½ diá»…n ra kiá»ƒu nhÆ° sau: TrÃ¬nh duyá»‡t: NÃ y, GET cho tÃ´i /index.html Server: Ok, Ä‘á»ƒ tÃ´i tÃ¬m xem index.html cÃ³ khÃ´ng Server: TÃ¬m tháº¥y rá»“i! MÃ£ pháº£n há»“i cá»§a anh Ä‘Ã¢y (200 OK) vÃ  tÃ´i Ä‘ang gá»­i file. TrÃ¬nh duyá»‡t: 100KB? Ã”iâ€¦ chá» tÃ­, chá» tÃ­â€¦ ok, táº£i Ä‘Æ°á»£c rá»“i nhÃ©. DÄ© nhiÃªn, header vÃ  giao thá»©c thá»±c táº¿ sáº½ hÃ¬nh thá»©c hÆ¡n nhiá»u (quan sÃ¡t chÃºng vá»›i Live HTTP Headers náº¿u báº¡n muá»‘n). NhÆ°ng nÃ³ hoáº¡t Ä‘á»™ng, vÃ  báº¡n nháº­n Ä‘Æ°á»£c file. Tháº¿ váº¥n Ä‘á» lÃ  gÃ¬?ChÃ , há»‡ thá»‘ng hoáº¡t Ä‘á»™ng, nhÆ°ng khÃ´ng hiá»‡u quáº£. 100KB lÃ  má»™t Ä‘á»‘ng text, vÃ  thÃ nh tháº­t thÃ¬, HTML khÃ¡ lÃ  trÃ¹ng láº·p. Má»—i tháº» , vÃ  Ä‘á»u cÃ³ má»™t tháº» Ä‘Ã³ng gáº§n nhÆ° tÆ°Æ¡ng tá»±. CÃ¡c tá»« láº·p Ä‘i láº·p láº¡i trong cáº£ document. Báº¡n chia nÃ³ ra nhÆ° tháº¿ nÃ o thÃ¬ HTML (vÃ  ngÆ°á»i anh em máº¡nh máº½ cá»§a nÃ³, XML) Ä‘á»u khÃ´ng tinh gá»n. VÃ  xá»­ lÃ½ tháº¿ nÃ o vá»›i má»™t file quÃ¡ lá»›n? NÃ©n nÃ³! Náº¿u chÃºng ta cÃ³ thá»ƒ gá»­i má»™t file .zip Ä‘áº¿n trÃ¬nh duyá»‡t (index.html.zip) thay vÃ¬ index.html thÃ´ng thÆ°á»ng, chÃºng ta sáº½ tiáº¿t kiá»‡m Ä‘Æ°á»£c bÄƒng thÃ´ng vÃ  thá»i gian táº£i. TrÃ¬nh duyá»‡t cÃ³ thá»ƒ táº£i file Ä‘Ã£ nÃ©n, giáº£i nÃ©n nÃ³, vÃ  sau Ä‘Ã³ hiá»ƒn thá»‹ cho ngÆ°á»i dÃ¹ng, ngÆ°á»i Ä‘ang cÃ³ tÃ¢m tráº¡ng tá»‘t vÃ¬ trang táº£i nhanh. Äoáº¡n há»™i thoáº¡i giá»¯a trÃ¬nh duyá»‡t vÃ  server sáº½ trÃ´ng nhÆ° sau: TrÃ¬nh duyá»‡t: NÃ y, tÃ´i cÃ³ thá»ƒ GET index.html khÃ´ng? TÃ´i sáº½ láº¥y phiÃªn báº£n nÃ©n cá»§a nÃ³ náº¿u anh cÃ³. Server: Äá»ƒ tÃ´i tÃ¬mâ€¦ á»«, cÃ³ Ä‘Ã¢y. VÃ  anh sáº½ láº¥y báº£n nÃ©n? Tuyá»‡t. Server: Ok, tÃ´i tÃ¬m tháº¥y index.html (200 OK), vÃ  tÃ´i Ä‘ang nÃ©n vÃ  gá»­i nÃ³ qua cho anh. TrÃ¬nh duyá»‡t: Tuyá»‡t! Chá»‰ cÃ³ má»—i 10KB. TÃ´i sáº½ giáº£i nÃ©n vÃ  hiá»ƒn thá»‹ cho ngÆ°á»i dÃ¹ng. CÃ´ng thá»©c ráº¥t Ä‘Æ¡n giáº£n: File nhá» hÆ¡n = táº£i nhanh hÆ¡n = ngÆ°á»i dÃ¹ng háº¡nh phÃºc. KhÃ´ng tin tÃ´i Ã ? Pháº§n HTML cá»§a trang chá»§ cá»§a Yahoo giáº£m tá»« 101KB xuá»‘ng cÃ²n 15KB sau khi nÃ©n: Chi tiáº¿t (khÃ´ng quÃ¡) láº±ng nháº±ngPháº§n khÃ³ trong quÃ¡ trÃ¬nh trao Ä‘á»•i nÃ y lÃ  trÃ¬nh duyá»‡t vÃ  server pháº£i biáº¿t ráº±ng viá»‡c gá»­i nháº­n file nÃ©n lÃ  Ä‘Æ°á»£c cháº¥p nháº­n. Viá»‡c Ä‘á»“ng Ã½ nÃ y bao gá»“m 2 pháº§n TrÃ¬nh duyá»‡t gá»­i má»™t header nÃ³i vá»›i server ráº±ng nÃ³ cháº¥p nháº­n ná»™i dung Ä‘Æ°á»£c nÃ©n (gzip vÃ  deflate lÃ  2 cÃ¡ch nÃ©n): Accept-Encoding: gzip, deflate Server gá»­i má»™t pháº£n há»“i náº¿u ná»™i dung thá»±c sá»± Ä‘Æ°á»£c nÃ©n: Content-Encoding: gzip Náº¿u server khÃ´ng gá»­i content-encoding trong header cá»§a pháº£n há»“i, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  file khÃ´ng Ä‘Æ°á»£c nÃ©n (Ä‘iá»u máº·c Ä‘á»‹nh á»Ÿ nhiá»u server). Header â€œAccept-Encodingâ€ chá»‰ lÃ  má»™t yÃªu cáº§u tá»« trÃ¬nh duyá»‡t, khÃ´ng pháº£i má»‡nh lá»‡nh. Náº¿u server khÃ´ng muá»‘n gá»­i vá» ná»™i dung Ä‘Æ°á»£c nÃ©n, trÃ¬nh duyá»‡t sáº½ pháº£i táº£i vá» phiÃªn báº£n náº·ng ná» thÃ´ng thÆ°á»ng. Thiáº¿t láº­p serverâ€œTin tá»‘tâ€ lÃ  chÃºng ta khÃ´ng thá»ƒ kiá»ƒm soÃ¡t Ä‘Æ°á»£c trÃ¬nh duyá»‡t. NÃ³ sáº½ gá»­i header Accept-Encoding: gzip, deflate hoáº·c lÃ  khÃ´ng. CÃ´ng viá»‡c cá»§a chÃºng ta lÃ  cáº¥u hÃ¬nh server Ä‘á»ƒ nÃ³ tráº£ vá» ná»™i dung Ä‘Æ°á»£c nÃ©n náº¿u trÃ¬nh duyá»‡t cÃ³ thá»ƒ xá»­ lÃ½, tiáº¿t kiá»‡m bÄƒng thÃ´ng cho má»i ngÆ°á»i (vÃ  Ä‘em láº¡i má»™t ngÆ°á»i dÃ¹ng háº¡nh phÃºc). Äá»‘i vá»›i IIS, báº­t cáº¥u hÃ¬nh nÃ©n.aspx) á»Ÿ trong cÃ i Ä‘áº·t. Trong Apache, báº­t cáº¥u hÃ¬nh nÃ©n ná»™i dung xuáº¥t khÃ¡ lÃ  Ä‘Æ¡n giáº£n. ThÃªm cÃ¡c dÃ²ng sau vÃ o file .htaccess: 123456789101112131415# compress text, html, javascript, css, xml:AddOutputFilterByType DEFLATE text/plainAddOutputFilterByType DEFLATE text/htmlAddOutputFilterByType DEFLATE text/xmlAddOutputFilterByType DEFLATE text/cssAddOutputFilterByType DEFLATE application/xmlAddOutputFilterByType DEFLATE application/xhtml+xmlAddOutputFilterByType DEFLATE application/rss+xmlAddOutputFilterByType DEFLATE application/javascriptAddOutputFilterByType DEFLATE application/x-javascript# Or, compress certain file types by extension:&lt;files *.html&gt;SetOutputFilter DEFLATE&lt;/files&gt; Apache cÃ³ 2 tÃ¹y chá»n nÃ©n: mod_deflate dá»… dÃ ng cÃ i Ä‘áº·t vÃ  lÃ  chuáº©n. mod_gzip cÃ³ váº» máº¡nh hÆ¡n: báº¡n cÃ³ thá»ƒ nÃ©n trÆ°á»›c ná»™i dung. Deflate nhanh vÃ  hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c, nÃªn tÃ´i sá»­ dá»¥ng nÃ³; dÃ¹ng mod_gzip náº¿u báº¡n tháº¥y thÃ­ch. Trong cáº£ 2 trÆ°á»ng há»£p, Apache Ä‘á»u kiá»ƒm tra xem trÃ¬nh duyá»‡t cÃ³ gá»­i header â€œAccept-Encodingâ€ khÃ´ng vÃ  gá»­i láº¡i phiÃªn báº£n nÃ©n hoáº·c phiÃªn báº£n thÆ°á»ng cá»§a file. tuy nhiÃªn, má»™t sá»‘ trÃ¬nh duyá»‡t cÅ© sáº½ phÃ¡t sinh váº¥n Ä‘á» (chi tiáº¿t bÃªn dÆ°á»›i) vÃ  cÃ³ má»™t sá»‘ chá»‰ lá»‡nh Ä‘áº·c biá»‡t mÃ  báº¡n cÃ³ thá»ƒ thÃªm vÃ o Ä‘á»ƒ sá»­a. Náº¿u báº¡n khÃ´ng thá»ƒ thay Ä‘á»•i file .htaccess, báº¡n cÃ³ thá»ƒ dÃ¹ng PHP Ä‘á»ƒ tráº£ vá» ná»™i dung nÃ©n. ThÃªm pháº§n má»Ÿ rá»™ng .php vÃ o file html cá»§a báº¡n vÃ  thÃªm Ä‘oáº¡n code nÃ y á»Ÿ Ä‘áº§u file: 12345&lt;?phpif (substr_count($_SERVER[â€˜HTTP_ACCEPT_ENCODINGâ€™], â€˜gzipâ€™)) ob_start(â€œob_gzhandlerâ€);else ob_start();?&gt; ChÃºng ta kiá»ƒm tra header â€œAccept-Encodingâ€ vÃ  tráº£ vá» phiÃªn báº£n nÃ©n gzip cá»§a file (ngÆ°á»£c láº¡i lÃ  phiÃªn báº£n thÆ°á»ng). Viá»‡c nÃ y gáº§n nhÆ° lÃ  tá»± xÃ¢y dá»±ng webserver cá»§a báº¡n (ráº¥t thÃº vá»‹!). NhÆ°ng thá»±c sá»± thÃ¬, hÃ£y thá»­ sá»­ dá»¥ng Apache Ä‘á»ƒ nÃ©n ná»™i dung tráº£ vá» náº¿n báº¡n cÃ³ thá»ƒ. Báº¡n khÃ´ng muá»‘n nghá»‹ch ngá»£m máº¥y file cá»§a mÃ¬nh Ä‘Ã¢u. XÃ¡c minh ná»™i dung nÃ©n cá»§a báº¡nKhi báº¡n Ä‘Ã£ cáº¥u hÃ¬nh xong server cá»§a mÃ¬nh, hÃ£y kiá»ƒm tra Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng báº¡n thá»±c sá»± tráº£ vá» ná»™i dung nÃ©n. Online: sá»­ dá»¥ng cÃ´ng cá»¥ kiá»ƒm tra gzip online Ä‘á»ƒ kiá»ƒm tra liá»‡u trang cá»§a báº¡n cÃ³ Ä‘Æ°á»£c nÃ©n khÃ´ng. TrÃªn trÃ¬nh duyá»‡t: trong Chrome, má»Ÿ Developer Tools &gt; Network (Firefox/IE sáº½ tÆ°Æ¡ng tá»±). Táº£i láº¡i trang, vÃ  nháº¥n vÃ o dÃ²ng network tÆ°Æ¡ng á»©ng vá»›i trang (vÃ­ dá»¥ www.google.com). Header Content-Encoding: gzip nghÄ©a lÃ  ná»™i dung tráº£ vá» Ä‘Ã£ Ä‘Æ°á»£c nÃ©n. Nháº¥n biá»ƒu tÆ°á»£ng â€œUse large rowsâ€ Ä‘á»ƒ hiá»ƒn thá»‹ thÃªm thÃ´ng tin, bao gá»“m cáº£ kÃ­ch cá»¡ file nÃ©n vÃ  kÃ­ch cÃµ thá»±c. HÃ£y chuáº©n bá»‹ cho Ä‘iá»u ká»³ diá»‡u á»Ÿ káº¿t quáº£. Trang chá»§ cá»§a instacalc thu láº¡i tá»« 36k xuá»‘ng cÃ²n 10k, giáº£m 75% kÃ­ch cá»¡. Thá»­ má»™t sá»‘ vÃ­ dá»¥TÃ´i Ä‘Ã£ lÃ m má»™t sá»‘ trang vÃ  má»™t vÃ­ dá»¥ cho phÃ©p táº£i vá»: index.html - khÃ´ng nÃ©n (trÃªn server nÃ y, tÃ´i máº·c Ä‘á»‹nh sá»­ dá»¥ng nÃ©n) index.htm - nÃ©n vá»›i Apache .htaccess sá»­ dá»¥ng luáº­t *.htm index.php - nÃ©n sá»­ dá»¥ng PHP header Cá»© thoáº£i mÃ¡i táº£i file, Ä‘á»ƒ chÃºng trong server cá»§a báº¡n vÃ  chá»‰nh sá»­a cÃ¡c cÃ i Ä‘áº·t. LÆ°u Ã½DÃ¹ khÃ¡ thÃº vá»‹ nhÆ°ng HTTP Compression cÅ©ng chá»©a má»™t sá»‘ váº¥n Ä‘á». DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng thá»© cáº§n pháº£i coi chá»«ng: TrÃ¬nh duyá»‡t cÅ©: Pháº£i, má»™t sá»‘ trÃ¬nh duyá»‡t váº«n cÃ²n cÃ³ ráº¯c rá»‘i vá»›i ná»™i dung nÃ©n (chÃºng nÃ³i ráº±ng cÃ³ thá»ƒ cháº¥p nháº­n ná»™i dung nÃ©n, nhÆ°ng thá»±c sá»± thÃ¬ khÃ´ng thá»ƒ). Náº¿u trang cá»§a báº¡n báº¯t buá»™c pháº£i hoáº¡t Ä‘á»™ng vá»›i Netscape 1.0 trÃªn Windows 95, báº¡n cÃ³ láº½ sáº½ khÃ´ng muá»‘n dÃ¹ng HTTP Compression. Apache mod_deflate cÃ³ má»™t sá»‘ luáº­t cho phÃ©p trÃ¡nh viá»‡c nÃ©n trÃªn má»™t sá»‘ trÃ¬nh duyá»‡t cÅ©. Ná»™i dung Ä‘Ã£ nÃ©n: Háº§u háº¿t áº£nh, nháº¡c vÃ  video Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c nÃ©n. Äá»«ng tá»‘n thá»i gian nÃ©n chÃºng láº§n ná»¯a. TrÃªn thá»±c táº¿, báº¡n sáº½ chá»‰ muá»‘n nÃ©n â€œbig 3â€ (HTML, CSS vÃ  Javascript). CPU-load: nÃ©n ná»™i dung khi nháº­n Ä‘Æ°á»£c yÃªu cáº§u sáº½ tiÃªu tá»‘n thá»i gian cá»§a CPU vÃ  tiáº¿t kiá»‡m bÄƒng thÃ´ng. ThÆ°á»ng thÃ¬ Ä‘Ã¢y lÃ  sá»± Ä‘Ã¡nh Ä‘á»•i tá»‘t náº¿u biáº¿t tá»‘c Ä‘á»™ nÃ©n. CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ nÃ©n trÆ°á»›c cÃ¡c ná»™i dung tÄ©nh vÃ  gá»­i cÃ¡c báº£n nÃ©n nÃ y. Viá»‡c nÃ y cáº§n Ä‘Æ°á»£c cáº¥u hÃ¬nh thÃªm; cho dÃ¹ khÃ´ng thá»ƒ thÃ¬ viá»‡c nÃ©n ná»™i dung tráº£ vá» váº«n lÃ  Ä‘iá»u tá»‘t. Sá»­ dá»¥ng CPU cho ngÆ°á»i dÃ¹ng cÃ³ tráº£i nghiá»‡m nhanh hÆ¡n cÅ©ng khÃ¡ lÃ  Ä‘Ã¡ng, khi sá»± chÃº Ã½ khÃ´ng Ä‘Ã¡ng ká»ƒ. NÃ©n lÃ  má»™t trong nhá»¯ng cÃ¡ch nhanh nháº¥t Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u nÄƒng cho trang web cá»§a báº¡n. HÃ£y Ä‘i, cÃ i Ä‘áº·t, vÃ  Ä‘á»ƒ cho ngÆ°á»i dÃ¹ng cá»§a báº¡n tháº­n hÆ°á»Ÿng lá»£i Ã­ch nÃ³ mang láº¡i.","categories":[],"tags":[]},{"title":"Functional trong Javascript vá»›i ES6 Recursive Patterns","slug":"Functional-trong-Javascript-voi-ES6-Recursive-Patterns","date":"2018-07-24T05:28:00.000Z","updated":"2018-09-07T13:27:14.693Z","comments":true,"path":"2018/07/Functional-trong-Javascript-voi-ES6-Recursive-Patterns.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Functional-trong-Javascript-voi-ES6-Recursive-Patterns.html","excerpt":"Whatâ€™s the deal here?Functional programming has been on the rise and is a topic that is very exciting to me. It allows me to write terse, declarative code that is easy to test and reason about. What is functional programming? Iâ€™ll defer that answer to someone with more knowledge on the subject, Eric Elliot: Functional programming (often abbreviated FP) is the process of building software by composing pure functions, avoiding shared state, mutable data,and side-effects. Functional programming is declarative rather than imperative, and application state flows through pure functions. Contrast with object oriented programming, where application state is usually shared and colocated with methods in objects.","text":"Whatâ€™s the deal here?Functional programming has been on the rise and is a topic that is very exciting to me. It allows me to write terse, declarative code that is easy to test and reason about. What is functional programming? Iâ€™ll defer that answer to someone with more knowledge on the subject, Eric Elliot: Functional programming (often abbreviated FP) is the process of building software by composing pure functions, avoiding shared state, mutable data,and side-effects. Functional programming is declarative rather than imperative, and application state flows through pure functions. Contrast with object oriented programming, where application state is usually shared and colocated with methods in objects. ES6 brings many features that allow us to easily write pure functions, rest/spread being one of the most powerful. Using rest params, weâ€™re able to â€œloop without loopsâ€ with recursion. In this article, weâ€™re going to rewrite many commonly used JavaScript methods/functions that allow for functional patterns. PrefaceThe following functions are for demonstration and learning purposes. Many functions below are tail-recursive and should be optimized further. Fixing tail-recursion is not the subject of this article. ES6 brings tail-call optimization, but must be used in conjunction with &#39;use strict&#39; . HeadReturn the first item in an array. Is useful when you need to separate the first item from the rest of the array items. To do this, we make use of destructuring assignment. 1const head = ([x]) =&gt; x Example usage: 12const array = [1,2,3,4,5]head(array) // 1 TailReturn all but the first item in an array. 1const tail = ([, ...xs]) =&gt; xs Which is essentially the same as writing: 1const tail = ([x, ...xs]) =&gt; xs Since we donâ€™t need to use x in the returned output, we can drop it, but keep the comma to get the rest of the items in the array. Example usage: 12const array = [1,2,3,4,5]tail(array) // [2,3,4,5] DefReturn if argument supplied is defined. 1const def = x =&gt; typeof x !== 'undefined' Example usage: 123const defined = 'this is defined'def(defined) // truedef(doesntExist) // false UndefReturn if argument supplied is undefined. 1const undef = x =&gt; !def(x) Example usage: 123const defined = 'this is defined'undef(defined) // falseundef(doesntExist) // true CopyReturns a copy of an array without using Array.slice(). Makes use of spread. 1const copy = array =&gt; [...array] Example usage: 123456let array = [1,2,3,4,5]let copied = copy(array)copied.push(6)array // [1,2,3,4,5]copied // [1,2,3,4,5,6] LengthReturn the length of an array. This is a very simple form of looping through an array with recursion, even though the values of the array donâ€™t matter in this case (increments up starting at 1 for every item in array). We include the len param to avoid tail recursion. 1const length = ([x, ...xs], len = 0) =&gt; def(x) ? length(xs, len + 1) : len If we donâ€™t care about tail recursion, we can write it as: 1const length = ([x, ...xs]) =&gt; def(x) ? 1 + length(xs) : 0 This would add a stack frame for each item in the array, whereas the version that avoids tail recursion, replaces a single stack frame. If the array passed in is large enough, it will throw â€œMaximum call stack size exceededâ€. Example usage: 12const array = [1,2,3,4,5]length(array) // 5 ReverseReturn a reversed array. 1const reverse = ([x, ...xs]) =&gt; def(x) ? [...reverse(xs), x] : [] Example usage: 12const array = [1,2,3,4,5]reverse(array) // [5,4,3,2,1] Array.reverse() is okay, but it modifies the value in place which is a side-effect. Consider the following: 12345678910const array = [1,2,3,4,5]const newArray = array.reverse() // [5,4,3,2,1]array // [5,4,3,2,1]// using the reverse method we just createdconst array2 = [1,2,3,4,5]const newArray2 = reverse(array2) // [5,4,3,2,1]array2 // [1,2,3,4,5] FirstReturns a new array that contains the first n items of the given array. 1const first = ([x, ...xs], n = 1) =&gt; def(x) &amp;&amp; n ? [x, ...first(xs, n - 1)] : [] Example usage: 12const array = [1,2,3,4,5]first(array, 3) // [1,2,3] LastReturns a new array that contains the last n items of the given array. 1const last = (xs, n = 1) =&gt; reverse(first(reverse(xs), n)) Example usage: 12const array = [1,2,3,4,5]last(array, 3) // [3,4,5] SliceReturns a new array with value inserted at given index. 12345const slice = ([x, ...xs], i, y, curr = 0) =&gt; def(x) ? curr === i ? [y, x, ...slice(xs, i, y, curr + 1)] : [x, ...slice(xs, i, y, curr + 1)] : [] Example usage: 12const array = [1,2,4,5]slice(array, 2, 3) // [1,2,3,4,5] isArrayReturns if the value supplied is an array. Allows us to write Array.isArray() in a more functional manner. 1const isArray = x =&gt; Array.isArray(x) Example usage: 12const array = [1,2,3,4,5]isArray(array) // true FlattenCombines nested arrays into a single array. 123const flatten = ([x, ...xs]) =&gt; def(x) ? isArray(x) ? [...flatten(x), ...flatten(xs)] : [x, ...flatten(xs)] : [] Example usage: 123const array1 = [1,2,3]const array2 = [4,[5,[6]]]flatten([array1, array2]) // [1,2,3,4,5,6] SwapReturn a new array with 2 items swapped based on their index. 1234567const swap = (a, i, j) =&gt; ( map(a, (x,y) =&gt; &#123; if(y === i) return a[j] if(y === j) return a[i] return x &#125;)) Example usage: 12const array = [1,2,3,4,5]swap(array, 0, 4) // [5,2,3,4,1] MapFrom MDN: â€œâ€¦creates a new array with the results of calling a provided function on every element in this array.â€ 1234const map = ([x, ...xs], fn) =&gt; &#123; if (undef(x)) return [] return [fn(x), ...map(xs, fn)]&#125; Which can be simplified as: 1const map = ([x, ...xs], fn) =&gt; def(x) ? [fn(x), ...map(xs, fn)] : [] Example usage: 12const double = x =&gt; x * 2map([1,2,3], double) // [2,4,6] FilterFrom MDN: â€œâ€¦creates a new array with all elements that pass the test implemented by the provided function.â€ 12345678const filter = ([x, ...xs], fn) =&gt; &#123; if (undef(x)) return [] if (fn(x)) &#123; return [x, ...filter(xs, fn)] &#125; else &#123; return [...filter(xs, fn)] &#125;&#125; Which can be simplified as: 1234const filter = ([x, ...xs], fn) =&gt; def(x) ? fn(x) ? [x, ...filter(xs, fn)] : [...filter(xs, fn)] : [] Example usage: 123456const even = x =&gt; x % 2 === 0const odd = x = !even(x)const array = [1,2,3,4,5]filter(array, even) // [2,4]filter(array, odd) // [1,3,5] RejectThe opposite of filter, returns an array that does not pass the filter function. 12345678const reject = ([x, ...xs], fn) =&gt; &#123; if (undef(x)) return [] if (!fn(x)) &#123; return [x, ...reject(xs, fn)] &#125; else &#123; return [...reject(xs, fn)] &#125;&#125; Example usage: 1234const even = x =&gt; x % 2 === 0const array = [1,2,3,4,5]reject(array, even) // [1,3,5] PartitionSplits an array into two arrays. One whose items pass a filter function and one whose items fail. 1const partition = (xs, fn) =&gt; [filter(xs, fn), reject(xs, fn)] Example usage: 1234const even = x =&gt; x % 2 === 0const array = [0,1,2,3,4,5]partition(array, even) // [[0,2,4], [1,3,5]] ReduceFrom MDN: â€œâ€¦applies a function against an accumulator and each element in the array (from left to right) to reduce it to a single value.â€ 1234const reduce = ([x, ...xs], fn, memo, i) =&gt; &#123; if (undef(x)) return memo return reduce(xs, fn, fn(memo, x, i), i + 1)&#125; Which can be simplified as: 12const reduce = ([x, ...xs], fn, memo, i = 0) =&gt; def(x) ? reduce(xs, fn, fn(memo, x, i), i + 1) : memo Example usage: 12345const sum = (memo, x) =&gt; memo + xreduce([1,2,3], sum, 0) // 6const flatten = (memo, x) =&gt; memo.concat(x)reduce([4,5,6], flatten, [1,2,3]) // [1,2,3,4,5,6] ReduceRightSimilar to reduce, but applies the function from right-to-left. 1const reduceRight = (xs, fn, memo) =&gt; reduce(reverse(xs), fn, memo) Example usage: 123const flatten = (memo, x) =&gt; memo.concat(x)reduceRight([[0,1], [2,3], [4,5]], flatten, []) // [4, 5, 2, 3, 0, 1] PartialPartially apply a function by filling in any number of its arguments. 1const partial = (fn, ...args) =&gt; (...newArgs) =&gt; fn(...args, ...newArgs) Example usage: 1234const add = (x,y) =&gt; x + yconst add5to = partial(add, 5)add5to(10) // 15 SpreadArgConvert function that takes an array to one that takes multiple arguments. This is useful when partially applying. 1const spreadArg = (fn) =&gt; (...args) =&gt; fn(args) Example usage: 12345const add = ([x, ...xs]) =&gt; def(x) ? parseInt(x + add(xs)) : []add([1,2,3,4,5]) // 15const spreadAdd = spreadArg(add)spreadAdd(1,2,3,4,5) // 15 If you only want to define a single function you can write it as: 12const add = spreadArg(([x, ...xs]) =&gt; def(x) ? parseInt(x + add(...xs)) : [])add(1,2,3,4,5) // 15 In the above, you need to remember to spread the array you are sending into the function recursively, since you are spreading the argument. ReverseArgsReverse function argument order. 1const reverseArgs = (fn) =&gt; (...args) =&gt; fn(...reverse(args)) Example usage: 12345const divide = (x,y) =&gt; x / ydivide(100,10) // 10const reverseDivide = reverseArgs(divide)reverseDivide(100,10) // 0.1 Reversing arguments can be useful when partially applying arguments. Sometimes you want to partially apply arguments at the end of the list, not those at the beginning. Reversing the arguments allows us to do that. 123const percentToDec = partial(reverseDivide, 100)percentToDec(25) // 0.25 PluckExtract property value from array. Useful when combined with the map function. 1const pluck = (key, object) =&gt; object[key] Example usage: 12345678910const product = &#123;price: 15&#125;pluck('price', product) // 15const getPrices = partial(pluck, 'price')const products = [ &#123;price: 10&#125;, &#123;price: 5&#125;, &#123;price: 1&#125;]map(products, getPrices) // [10,5,1] FlowEach function consumes the return value of the function that came before. 1const flow = (...args) =&gt; init =&gt; reduce(args, (memo, fn) =&gt; fn(memo), init) Example usage: 1234567891011121314151617const getPrice = partial(pluck, 'price')const discount = x =&gt; x * 0.9const tax = x =&gt; x + (x * 0.075)const getFinalPrice = flow(getPrice, discount, tax)// looks like: tax(discount(getPrice(x)))// -&gt; get price// -&gt; apply discount// -&gt; apply taxes to discounted priceconst products = [ &#123;price: 10&#125;, &#123;price: 5&#125;, &#123;price: 1&#125;]map(products, getFinalPrice) // [9.675, 4.8375, 0.9675] ComposeThe same as flow, but arguments are applied in the reverse order. Compose matches up more naturally with how functions are written. Using the same data as defined for the flow function: 1const compose = (...args) =&gt; flow(...reverse(args)) Example usage: 12345const getFinalPrice = compose(tax, discount, getPrice)// looks like: tax(discount(getPrice(x)))map(products, getFinalPrice) // [9.675, 4.8375, 0.9675] MinReturn the smallest number in an array. Returns Infinity if array supplied is empty. 12345const min = ([x, ...xs], result = Infinity) =&gt; def(x) ? x &lt; result ? min(xs, x) : result : result Example usage: 123const array = [0,1,2,3,4,5]min(array) // 0 MaxReturn the largest number in an array. Returns -Infinity if array supplied is empty. 12345const max = ([x, ...xs], result = -Infinity) =&gt; def(x) ? x &gt; result ? max(xs, x) : max(xs, result) : result Example usage: 123const array = [0,1,2,3,4,5]max(array) // 5 FactorialReturns the factorial of a number. Uses an accumulator to allow replacing of stack frames to allow larger factorials to be returned. 1const factorial = (x, acum = 1) =&gt; x ? factorial(x - 1, x * acum) : acum Example usage: 1factorial(5) // 120 FibonacciReturns the Fibonacci number at the given place. 1const fib = x =&gt; x &gt; 2 ? fib(x - 1) + fib(x - 2) : 1 Example usage: 1fib(15) // 610 QuicksortSort an array from smallest to largest. This is done by re-ordering the array so that it contains two sub-arrays, one with smaller values, the other with larger values. The above steps are recursively applied to each sub-array until there are no arrays left, which is flatten to return a sorted array. 1234567const quicksort = (xs) =&gt; length(xs) ? flatten([ quicksort(filter(tail(xs), x =&gt; x &lt;= head(xs))), head(xs), quicksort(filter(tail(xs), x =&gt; x &gt; head(xs))) ]) : [] This can also be implemented using partition, but requires variable assignment. 12345const quicksort = (array) =&gt; &#123; if (!length(array)) return [] const [less, more] = partition(tail(array), x =&gt; x &lt; head(array)) return flatten([quicksort(less), head(array), quicksort(more)])&#125; Example usage: 123const array = [8,2,6,4,1]quicksort(array) // [1,2,4,6,8] Everything as a ReductionMany of the functions above can be converted into reductions, which should increase performance in most, if not all cases. This also shows the flexibility of the reduce function. 12345678910111213141516171819202122232425262728293031const reduce = ([x, ...xs], f, memo, i = 0) =&gt; def(x) ? reduce(xs, f, f(memo, x, i), i + 1) : memoconst reverse = xs =&gt; reduce(xs, (memo, x) =&gt; [x, ...memo], [])const length = xs =&gt; reduce(xs, (memo, x) =&gt; memo + 1, 0)const map = (xs, fn) =&gt; reduce(xs, (memo, x) =&gt; [...memo, fn(x)], [])const filter = (xs, fn) =&gt; reduce(xs, (memo, x) =&gt; fn(x) ? [...memo, x] : [...memo], [])const reject = (xs, fn) =&gt; reduce(xs, (memo, x) =&gt; fn(x) ? [...memo] : [...memo, x], [])const first = (xs, n) =&gt; reduce(xs, (memo, x, i) =&gt; i &lt; n ? [...memo, x] : [...memo], [])const last = (xs, n) =&gt; reduce(xs, (memo, x, i) =&gt; i &gt;= (length(xs) - n) ? [...memo, x] : [...memo], [])const merge = spreadArg(xs =&gt; reduce(xs, (memo, x) =&gt; [...memo, ...x], []))const flatten = xs =&gt; reduce(xs, (memo, x) =&gt; x ? isArray(x) ? [...memo, ...flatten(x)] : [...memo, x] : [], [])const add = spreadArg(([x, ...xs]) =&gt; reduce(xs, (memo, y) =&gt; memo + y, x))const divide = spreadArg(([x, ...xs]) =&gt; reduce(xs, (memo, y) =&gt; memo / y, x))const multiply = spreadArg(([x, ...xs]) =&gt; reduce(xs, (memo, y) =&gt; memo * y, x)) Example usage: 123456789101112reverse([1,2,3]) // [3,2,1]length([1,2,3]) // 3map([1,2,3], double) // [2,3,4]filter([1,2,3,4], even) // [2,4]reject([1,2,3,4], even) // [1,3]first([1,2,3,4], 3) // [1,2,3]last([1,2,3,4], 2) // [3,4]merge([1,2,3],[4,5,6]) // [1,2,3,4,5,6]flatten([1,[2,3,[4,[5,[[6]]]]]]) // [1,2,3,4,5,6]add(1,2,3,4,5) // 15multiply(2,5,10) // 100divide(100,2,5) // 10 Wrapping UpI hope this article helps shed insight on some of the patterns made available with JavaScript and ES6. Many problems that can be solved with iteration/loops, can also be solved functionally through recursion. I hope this article was also able to show you the flexibility of the reduce function.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"es6","slug":"es6","permalink":"http://nthung2112.github.io/tags/es6/"}]},{"title":"Object, Function, Method, Constructor in JavaScript","slug":"Object-Function-Method-Constructor-in-JavaScript","date":"2018-07-24T05:02:00.000Z","updated":"2018-09-07T13:27:14.724Z","comments":true,"path":"2018/07/Object-Function-Method-Constructor-in-JavaScript.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Object-Function-Method-Constructor-in-JavaScript.html","excerpt":"TL;DR LÆ°u Ã½ má»™t chÃºt vá» cÃ¡ch trÃ¬nh bÃ y:.propname tá»©c lÃ  public property cÃ³ tÃªn lÃ  â€œpropnameâ€ cá»§a má»™t Ä‘á»‘i tÆ°á»£ng Báº¯t Ä‘áº§u vá»›i Object, Function vÃ  Method","text":"TL;DR LÆ°u Ã½ má»™t chÃºt vá» cÃ¡ch trÃ¬nh bÃ y:.propname tá»©c lÃ  public property cÃ³ tÃªn lÃ  â€œpropnameâ€ cá»§a má»™t Ä‘á»‘i tÆ°á»£ng Báº¯t Ä‘áº§u vá»›i Object, Function vÃ  Method JavaScriptâ€™s object giá»‘ng nhÆ° má»™t cÃ¡i tÃºi (hay má»™t vÃ¹ng nhá»›) chá»©a cÃ¡c property (thuá»™c tÃ­nh) á»Ÿ bÃªn trong nÃ³. Nhá»¯ng property trong JavaScript Ä‘á»u public vÃ  Ä‘Æ°á»£c lÆ°u trá»¯ theo cáº¥u trÃºc Mapping (tá»©c key-value pair). Function trong JavaScript Ä‘Æ°á»£c xem lÃ  first-class object (cÅ©ng tÆ°Æ¡ng tá»± nhÆ° object vÃ  ta sáº½ gá»i nÃ³ lÃ  functionObject). ChÃ­nh vÃ¬ JavaScriptâ€™s function Ä‘Æ°á»£c xem nhÆ° object nÃªn ta cÃ³ thá»ƒ return (tráº£ vá»), pass to parameter (truyá»n vÃ o function khÃ¡c thÃ´ng qua Ä‘á»‘i sá»‘), store in variable (lÆ°u trá»¯ trong biáº¿n) or store in Objectâ€™s property (lÆ°u trá»¯ trong property cá»§a Object =&gt; lÃºc Ä‘Ã³ function Ä‘Æ°á»£c gá»i lÃ  method),â€¦ Prototypes Prototype cá»§a object lÃ  má»™t internal property (cÃ³ thá»ƒ hiá»ƒu lÃ  má»™t property ná»™i táº¡i áº©n bÃªn trong), ta sáº½ gá»i nÃ³ lÃ  {Prototype}. JavaScript standard khÃ´ng cung cáº¥p cÃ¡ch thá»©c Ä‘á»ƒ truy xuáº¥t {Prototype} property tá»« má»™t object. LÆ°u Ã½ {Prototype} báº£n thÃ¢n nÃ³ cÅ©ng lÃ  má»™t object. Giá»‘ng nhÆ° bao ngÃ´n ngá»¯ láº­p trÃ¬nh OOP khÃ¡c, JavaScript cÃ³ thá»ƒ táº¡o object tá»« má»™t function Ä‘Æ°á»£c gá»i lÃ  constructor. VÃ¬ constructor lÃ  function vÃ  lÃ  functionObject nÃªn nÃ³ cÅ©ng cÃ³ {Prototype} property. JavaScript standard cung cáº¥p má»™t public property cho functionObject lÃ  .prototype Ä‘á»ƒ truy xuáº¥t prototype cá»§a function.LÆ°u Ã½ Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c truy xuáº¥t thÃ´ng qua public property .prototype khÃ´ng pháº£i lÃ  {Prototype} property cá»§a functionObject. Properties lookup JavaScriptâ€™s object cÃ³ thá»ƒ á»§y thÃ¡c má»™t sá»‘ property cá»§a nÃ³ cho {Prototype}. VÃ  báº£n thÃ¢n {Prototype} cÅ©ng lÃ m tÆ°Æ¡ng tá»±; Táº¥t cáº£ Ä‘á»u hÆ°á»›ng Ä‘áº¿n Build-in Object.prototype. LÆ°u Ã½ Build-in Object.prototype báº±ng null 12345678object --chá»©a--&gt; &#123;Prototype&#125;vÃ  báº£n thÃ¢n &#123;Prototype&#125; cÅ©ng lÃ  object&#123;Prototype&#125; --chá»©a--&gt; &#123;Prototype&#125;&apos;s &#123;Prototype&#125;vÃ  báº£n thÃ¢n &#123;Prototype&#125;&apos;s &#123;Prototype&#125; cÅ©ng lÃ  object&#123;Prototype&#125;&apos;s &#123;Prototype&#125; --chá»©a--&gt; &#123;Prototype&#125;&apos;s &#123;Prototype&#125;&apos;s &#123;Prototype&#125;.......... --chá»©a--&gt; Build-in Object.prototype(end) Hiá»‡n tÆ°á»£ng trÃªn ngÆ°á»i ta gá»i lÃ  Inheritance (káº¿ thá»«a) trong JavaScript thÃ´ng qua prototype. Do Ä‘Ã³ JavaScript lÃ  má»™t prototype-base OOP language á» vÃ­ dá»¥ trÃªn, ta tháº¥y xáº£y ra Ä‘á»‡ quy, ngÆ°á»i ta gá»i lÃ  {Prototype} chain. tá»©c duyá»‡t xuyÃªn suá»‘t cÃ¡c {Prototype} Khi gá»i má»™t property ra tá»« object thÃ¬ Ä‘áº§u tiÃªn há»‡ thá»‘ng sáº½ kiá»ƒm tra xem property Ä‘Ã³ cÃ³ náº±m trong object Ä‘Ã³ khÃ´ng. Náº¿u khÃ´ng, chÃºng sáº½ chuyá»ƒn hÆ°á»›ng qua tÃ¬m property Ä‘Ã³ trong objectâ€™s {Prototype}. QuÃ¡ trÃ¬nh Ä‘á»‡ quy cá»© tháº¿ Ä‘Æ°á»£c thá»±c hiá»‡n cho Ä‘áº¿n khi tÃ¬m Ä‘áº¿n Build-in Object.prototype thÃ¬ dá»«ng láº¡i. Setting properties Khi má»™t property Ä‘Æ°á»£c set giÃ¡ trá»‹, property Ä‘Ã³ khÃ´ng cÃ³ trong object thÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c táº¡o má»›i, há»‡ thá»‘ng tá»± Ä‘á»™ng bá» qua viá»‡c tÃ¬m kiáº¿m nÃ³ trong {Prototype}. Property má»›i Ä‘Æ°á»£c thÃªm vÃ o object sáº½ lÃ m má» nháº¡t property trÃ¹ng tÃªn (náº¿u cÃ³) trong {Prototype} chain {Prototype} cá»§a object bá»‹ áº£nh hÆ°á»Ÿng khÃ¡ máº¡nh bá»Ÿi public property .prototype cá»§a constructor. Ta cÃ³ thá»ƒ quyáº¿t Ä‘á»‹nh {Prototype} cá»§a má»™t object thÃ´ng qua viá»‡c Ä‘iá»u chá»‰nh .prototype property cá»§a constructor. Khi constructor Ä‘Æ°á»£c gá»i thá»±c thi (hay nÃ³i cÃ¡ch khÃ¡c function Ä‘Æ°á»£c gá»i theo Constructor Format) (xem pháº§n footnotes) thÃ¬ má»™t object má»›i Ä‘Æ°á»£c sinh ra. {Prototype} cá»§a object má»›i vÃ  public property .prototype cá»§a constructor sáº½ tham chiáº¿u cÃ¹ng má»™t Ä‘á»‘i tÆ°á»£ng. Tiáº¿p theo sáº½ lÃ  gÃ¬? Ta cÃ¹ng hÃ¬nh dungTrÆ°á»›c tiÃªn sáº½ lÃ  má»‘i liÃªn quan giá»¯a public property .prototype vÃ  {Prototype}. hÃ¬nh ellipse biá»ƒu diá»…n object, mÅ©i tÃªn biá»ƒu diá»…n property cá»§a object Ä‘Ã³ tham chiáº¿u Ä‘áº¿n má»™t object khÃ¡c. {Prototype} chain sáº½ Ä‘Æ°á»£c tÃ´ mÅ©i tÃªn mÃ y xanh lÃ¡. 1: Define constructor:1function MyConstructor() &#123; &#125; Ta dá»… dÃ ng tháº¥y MyConstructor Ä‘Æ°á»£c biá»ƒu diá»…n trong hÃ¬nh Ellipse, tá»©c nÃ³ lÃ  function vÃ  lÃ  functionObject vÃ  sáº½ Ä‘Æ°á»£c dÃ¹ng nhÆ° constructor. Ghi nhá»› ráº±ng: chá»‰ nhá»¯ng public property .prototype cá»§a functionObject, lÃ  nhá»¯ng object máº·c Ä‘á»‹nh sá»Ÿ há»¯u public property .constructorTá»©c lÃ  theo vÃ­ dá»¥ trÃªn: MyConstructor.prototype lÃ  giÃ¡ trá»‹ máº·c Ä‘á»‹nh cho property .prototype cá»§a MyConstructor. VÃ  nÃ³ máº·c Ä‘á»‹nh sá»Ÿ há»¯u property .constructor trá» ngÆ°á»£c vá» MyConstructor Pháº§n cÃ²n láº¡i trong bá»©c áº£nh minh há»a rÃµ rÃ ng nhá»¯ng khÃ¡i niá»‡m Ä‘Ã£ Ä‘á» cáº­p á»Ÿ pháº§n Ä‘áº§u bÃ i viáº¿t BÆ°á»›c káº¿ tiáº¿p ta sáº½ bá» qua pháº§n {Prototype} chain cá»§a MyConstructor cho gá»n, vÃ¬ chÃºng khÃ´ng thay Ä‘á»•i vÃ  cÅ©ng khÃ´ng liÃªn quan Ä‘áº¿n nhá»¯ng gÃ¬ Ä‘Æ°á»£c trÃ¬nh káº¿ tiáº¿p sau Ä‘Ã¢y. 2: Assign new prototype property:1MyConstructor.prototype = &#123; &#125; Ta thay .prototype máº·c Ä‘á»‹nh cá»§a MyConstructor báº±ng má»™t Ä‘á»‘i tÆ°á»£ng má»›i. Äáº·c biá»‡t Ä‘á»‘i tÆ°á»£ng nÃ y khÃ´ng cÃ³ property .constructor 3: Call constructor to create new object:1var myobject = new MyConstructor(); NhÆ° Ä‘Ã£ trÃ¬nh bÃ y á»Ÿ má»¥c setting propertites cá»§a bÃ i viáº¿t, ta dá»… dÃ ng tháº¥y Ä‘Æ°á»£c {Prototype} cá»§a myobject vÃ  property .prototype cá»§a MyConstructor tham chiáº¿u Ä‘áº¿n cÃ¹ng má»™t Ä‘á»‘i tÆ°á»£ng. Váº­y bÃ¢y giá» dá»±a theo má»¥c properties lookup, ta thá»­ truy xuáº¥t má»™t property báº¥t kÃ¬ tá»« myobject. Ta chá»n property cÃ³ tÃªn lÃ  constructor, chuyá»‡n gÃ¬ sáº½ xáº£y ra 1myobject.constructor = ? ÄÆ¡n giáº£n, Ã¡p dá»¥ng {Property} chain, ta sáº½ cÃ³ ngay Ä‘Ã¡p Ã¡n. BÃ¢y giá» cÃ¹ng thu gá»n táº¥t cáº£ nhá»¯ng Ä‘oáº¡n code ta viáº¿t láº¡i: 123456function MyConstructor() &#123;&#125;MyConstructor.prototype = &#123;&#125;;var myobject = new MyConstructor();myobject.constructor == Object // truemyobject.constructor.prototype == Object.prototype // true Ghi chÃº: Náº¿u nhÃ¬n láº¡i ta sáº½ hiá»ƒu vÃ¬ sao ngay tá»« bÆ°á»›c #2 ta lÆ°á»£c bá» Ä‘i pháº§n {Prototype} cá»§a MyConstructor lÃ  Ä‘Ãºng Ä‘áº¯n Tháº¿ náº¿u dÃ¹ng instanceof káº¿t quáº£ nhÆ° tháº¿ nÃ o?Viáº¿t láº¡i nguyÃªn vÄƒn: â€œJavascript provides the instanceof operator thatâ€™s intended to check the prototype chain of the object youâ€™re dealing with.â€ Tá»« nhá»¯ng bÆ°á»›c á»Ÿ trÃªn, ta cÃ³ thá»ƒ nghÄ© ráº±ng Ä‘oáº¡n code sau sáº½ tráº£ vá» false 12345function MyConstructor() &#123;&#125;MyConstructor.prototype = &#123;&#125;;var myobject = new MyConstructor();myobject instanceof MyConstructor // true nhÆ°ng thá»±c cháº¥t, nÃ³ cháº¡y á»•n vÃ  cÃ²n hÆ¡n tháº¿ ná»¯a: 12345function MyConstructor() &#123;&#125;MyConstructor.prototype = &#123;&#125;;var myobject = new MyConstructor();myobject instanceof Object // true Khi instanceof Ä‘Æ°á»£c gá»i, nÃ³ hoáº¡t Ä‘á»™ng dá»±a trÃªn {Prototype} chain. VÃ  nÃ³ cháº³ng Ä‘Ã¡ Ä‘á»™ng hay lá»‡ thuá»™c vÃ o property .constructor cÃ¹ng nhÃ¬n láº¡i hÃ¬nh á»Ÿ bÆ°á»›c #3 Cá»© tá»›i má»™t â€œtráº¡mâ€ tá»©c Ä‘á»‘i tÆ°á»£ng tham chiáº¿u bá»Ÿi {Prototype}, nÃ³ check xem Ä‘á»‘i tÆ°á»£ng nÃ y Ä‘Æ°á»£c tham chiáº¿u thÃ´ng qua .prototype property cá»§a ai.Äáº§u tiÃªn dá»«ng táº¡i Ä‘á»‘i tÆ°á»£ng {}, nÃ³ check vÃ  phÃ¡t hiá»‡n ra {} Ä‘Æ°á»£c tham chiáº¿u thÃ´ng qua .prototype property cá»§a MyConstructor, suy ra: 1myobject instanceof MyConstructor // true Tiáº¿p theo dá»«ng táº¡i Ä‘á»‘i tÆ°á»£ng Object.prototype nÃ³ phÃ¡t hiá»‡n ra Object.protoype tham chiáº¿u thÃ´ng qua .prototype property cá»§a build-in Object, suy ra: 1myobject instanceof Object // true CÃ³ á»•n rá»“i, nhÆ°ng ta váº«n cÃ³ thá»ƒ tÃ¬m ra nhá»¯ng Ä‘iá»u báº¥t thÆ°á»ng náº¿u chá»‹u khÃ³ mÃ² máº«m: 1234567function MyConstructor() &#123;&#125;var myobject = new MyConstructor();MyConstructor.prototype = &#123;&#125;;[ myobject instanceof MyConstructor, // false ! myobject.constructor == MyConstructor, // true ! myobject instanceof Object ] // true á»Ÿ Ä‘oáº¡n code trÃªn ta Ä‘á»•i thá»© tá»± cá»§a hai dÃ²ng code, myobject Ä‘Æ°á»£c táº¡o ra trÆ°á»›c sau Ä‘Ã³ MyConstructor má»›i Ä‘á»•i giÃ¡ trá»‹ cá»§a .prototype property.Do Ä‘Ã³ {Prototype} chain sáº½ trÃ´ng nhÆ° váº§y: ÄÃºng nhÆ° dá»± Ä‘oÃ¡n {Prototype} cá»§a object sáº½ tham chiáº¿u Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng cÅ© mÃ  .prototype property cá»§a MyConstructor tá»«ng tham chiáº¿u. Äiá»u nÃ y lÃ m thay Ä‘á»•i {Prototype} chain vÃ  cÃ³ thÃªm sá»± xuáº¥t hiá»‡n cá»§a .constructor property cá»§a old MyConstructor.prototype dáº«n Ä‘áº¿n {Prototype} cá»§a object vÃ  .prototype property cá»§a MyConstructor khÃ´ng tham chiáº¿u Ä‘áº¿n cÃ¹ng má»™t Ä‘á»‘i tÆ°á»£ng.Dá»«ng táº¡i {Prototype} Ä‘áº§u tiÃªn lÃ  Ä‘á»‘i tÆ°á»£ng old MyConstructor.prototype, nÃ³ khÃ´ng phÃ¡t hiá»‡n ra Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ Ä‘Æ°á»£c tham chiáº¿u thÃ´ng qua .prototype property cá»§a ai cáº£. Tiáº¿p tá»¥c {Prototype} thá»© hai, lÃ  Object.prototype thÃ¬ quÃ¡ rÃµ rÃ ng, suy ra: 12myobject instanceof MyConstructor, // false !myobject instanceof Object // true NgoÃ i ra, thÃ´ng qua {Prototype} chain (xem láº¡i má»¥c properties lookup), thÃ¬ ta tháº¥y .constructor property Ä‘áº§u tiÃªn Ä‘Æ°á»£c báº¯t gáº·p trong old MyConstructor.prototype nÃªn 1myobject.constructor == MyConstructor, // true ! lÃ  Ä‘iá»u dá»… hiá»ƒu. Má»™t sá»‘ nháº­n Ä‘á»‹nhConstructors khÃ´ng pháº£i classesNhÃ¬n láº¡i cÃ¡c class-based OOP language (nhÆ° Java, C#,â€¦), cÃ¡c classes káº¿ thá»«a tá»« nhá»¯ng classes khÃ¡c, vÃ  object lÃ  instance cá»§a nhá»¯ng classes Ä‘Ã³. CÃ¡c properties vÃ  methods Ä‘Æ°á»£c chia sáº» giá»¯a cÃ¡c instances. VÃ  viá»‡c chia sáº» Ä‘Ã³ bá»‹ chi phá»‘i bá»Ÿi access modifier (public, private, internal, protected,â€¦â€¦) Javascript cÅ©ng cÃ³ khÃ¡i niá»‡m káº¿ thá»«a, chia sáº» properties vÃ  methods thÃ´ng qua prototype. NhÆ°ng thá»±c táº¿ {Prototype} cá»§a constructor vÃ  {Prototype} chain cá»§a object Ä‘Æ°á»£c táº¡o ra tá»« constructor Ä‘Ã³, láº¡i hoÃ n toÃ n khÃ¡c biá»‡t, khÃ´ng liÃªn quan Ä‘áº¿n nhau. Constructors khÃ´ng hoáº¡t Ä‘á»™ng nhÆ° class-based initializerÄá»ƒ cÃ³ Ä‘Æ°á»£c khÃ¡i niá»‡m káº¿ thá»«a thÃ´ng qua prototype, Khi constructor Ä‘Æ°á»£c gá»i nÃ³ tiáº¿n hÃ nh liÃªn káº¿t {Prototype} property cá»§a object vá»›i .prototype property cá»§a chÃ­nh nÃ³. Nhá»¯ng gÃ¬ cÃ²n láº¡i lÃ  viá»‡c constructor thÃªm vÃ o má»™t sá»‘ properties, methods khÃ¡c cho object Constructors chá»‰ lÃ  functionsXem láº¡i bÆ°á»›c #1, ta tháº¥y MyConstructor cháº³ng khÃ¡c gÃ¬ má»™t function bÃ¬nh thÆ°á»ng. VÃ¬ váº­y báº¥t kÃ¬ user-defined function nÃ o trong Javascript cÅ©ng tá»± Ä‘á»™ng cÃ³ .prototype property tham chiáº¿u Ä‘áº¿n má»™t Ä‘á»‘i tÆ°á»£ng sá»Ÿ há»¯u .constructor property tham chiáº¿u ngÆ°á»£c vá» function Ä‘Ã³ Báº¥t cá»© user-defined function nÃ o cÅ©ng Ä‘Æ°á»£c gá»i thá»±c thi nhÆ° má»™t constructor báº±ng cÃ¡ch thÃªm vÃ o tá»« khÃ³a new. CÃ¡ch lÃ m Ä‘Ã³ sáº½ truyá»n object má»›i Ä‘Æ°á»£c táº¡o bá»Ÿi tá»« khÃ³a new vÃ o trong constructor function, vÃ  pháº§n viá»‡c cÃ²n láº¡i cá»§a constructor thÃ¬ nhÆ° Ä‘Ã£ nÃ³i á»Ÿ bÃªn trÃªn References(tham kháº£o tá»« bÃ i viáº¿t cá»§a zeekat/articles vá»›i má»™t sá»‘ chá»‰nh sá»­a theo hiá»ƒu biáº¿t cá»§a báº£n thÃ¢n vÃ  Ä‘á»ƒ phÃ¹ há»£p vá»›i Tiáº¿ng Viá»‡t)(xem thÃªm constructor in Javascript object)(xem thÃªm Javascript inheritance and the constructor property)(xem thÃªm ECMA-262 lastest version) Footnotes[1]John G Harris tá»«ng viáº¿t trong comp.lang.javascript ráº±ng nhá»¯ng gÃ¬ trÃ¬nh bÃ y á»Ÿ bÃªn trÃªn cÅ©ng tÆ°Æ¡ng Ä‘á»‘i chÆ°a Ä‘Ãºng hoÃ n toÃ n. Vá» máº·t lÃ½ thuyáº¿t, host system cÃ³ thá»ƒ sáº½ Ä‘á»•i Object.prototype property báº±ng má»™t thá»© gÃ¬ Ä‘Ã³ khÃ¡c. Má»™t sá»‘ tháº£o luáº­n cháº¥p thuáº­n ráº±ng Object.prototype chá»‰ Ä‘Æ°á»£c read-only. NhÆ°ng á»Ÿ má»™t sá»‘ browser (firefox) thÃ¬ ta cÃ³ thá»ƒ gÃ¡n giÃ¡ trá»‹ má»›i cho Object.prototype mÃ  khÃ´ng cÃ³ lá»—i nÃ o xáº£y ra. [2]cÃ³ 4 cÃ¡ch Ä‘á»ƒ gá»i thá»±c thi (invocation) má»™t function trong JavaScript(giá»¯ nguyÃªn vÄƒn cho dá»… hiá»ƒu) Function form: 1functionObject(arguments) When a function is called in the function form, this is set to the global object. that is not very useful (fixed in ES5/Strict) an inner function does not get access to the outer this Method form: 12thisObject.methodName(agurments);thisObject[\"methodName\"](arguments); When a function is called in the method form, this is set to thisObject, the object containning the function.this allows method to have a reference to the object of interest Constructor form: 1new functionObject(arguments); When a function is called with the new operator, a new object is created and assigned to this. If there is not an explicit return value, then this will be returned. Used in the Pseudoclassical style Apply form: 12functionObject.apply(thisObject, [arguments]);functionObject.call(thisObject, arguments....); A functionâ€™s apply or call method allows for calling the function,explicitly specifying thisObject. It can also take an array of parameters or a sequence of paramenters. 12345// the definition of call methodFuntion.prototype.call = function(thisObject)&#123; return this.apply(thisObject, Array.prototype.slice.apply(arguments, [1]));&#125;","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Memory Leaks trong Javascript","slug":"Memory-Leaks-trong-Javascript","date":"2018-07-24T04:41:00.000Z","updated":"2018-09-07T13:27:14.713Z","comments":true,"path":"2018/07/Memory-Leaks-trong-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Memory-Leaks-trong-Javascript.html","excerpt":"Giá»›i thiá»‡uMemory leaks lÃ  váº¥n Ä‘á» mÃ  má»i deveploper Ä‘á»u sáº½ gáº·p pháº£i khi code. Memory leaks sáº½ dáº¥n Ä‘áº¿n viá»‡c á»©ng dá»¥ng sáº½ cháº¡y cháº­m hÆ¡n, crashes, hay cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c á»©ng dá»¥ng khÃ¡c. Váº­y memory leaks lÃ  gÃ¬?","text":"Giá»›i thiá»‡uMemory leaks lÃ  váº¥n Ä‘á» mÃ  má»i deveploper Ä‘á»u sáº½ gáº·p pháº£i khi code. Memory leaks sáº½ dáº¥n Ä‘áº¿n viá»‡c á»©ng dá»¥ng sáº½ cháº¡y cháº­m hÆ¡n, crashes, hay cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c á»©ng dá»¥ng khÃ¡c. Váº­y memory leaks lÃ  gÃ¬?Memory leaks cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  má»™t bá»™ nhá»› (memory) khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng trong á»©ng dá»¥ng ná»¯a nhÆ°ng vÃ¬ má»™t lÃ½ do nÃ o Ä‘Ã³ mÃ  nÃ³ chÆ°a Ä‘Æ°á»£c giáº£i phÃ³ng vÃ  tráº£ vá» há»‡ Ä‘iá»u hÃ nh hoáº·c má»™t cÃ¡i pool chá»©a cÃ¡c bá»™ nhá»› (memory) chÆ°a sá»­ dá»¥ng. CÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡c nhau sáº½ cÃ³ cÃ¡c cÃ¡ch khÃ¡c nhau Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»›. Nhá»¯ng cÃ¡ch quáº£n lÃ½ bá»™ nhá»› nÃ y sáº½ giÃºp giáº£m thiá»ƒu kháº£ nÄƒng bá»‹ memory leaks cá»§a chÆ°Æ¡ng trÃ¬nh. Tuy nhiÃªn, viá»‡c xÃ¡c Ä‘á»‹nh má»™t vÃ¹ng bá»™ nhá»› cÃ³ cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng hay khÃ´ng láº¡i lÃ  má»™t váº¥n Ä‘á» khÃ³ cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh. Chá»‰ cÃ³ developer má»›i cÃ³ kháº£ nÄƒng quyáº¿t Ä‘á»‹nh xem lÃ  vÃ¹ng nhá»› nÃ y nÃªn Ä‘Æ°á»£c giáº£i phÃ³ng hay khÃ´ng. Má»™t sá»‘ ngÃ´n ngá»¯ (nhÆ° javascript) cung cáº¥p tÃ­nh nÄƒng tá»± Ä‘á»™ng giáº£i phÃ³ng bá»™ nhá»› cho developer, má»™t sá»‘ khÃ¡c thÃ¬ developer cáº§n pháº£i tá»± mÃ¬nh giáº£i phÃ³ng bá»™ nhá»› khi khÃ´ng sá»­ dá»¥ng Ä‘áº¿n nÃ³ ná»¯a. Quáº£n lÃ½ bá»™ nhá»› trong JSJavascript lÃ  má»™t trong nhá»¯ng ngÃ´n ngá»¯ cÃ³ garbage collection. Nhá»¯ng ngÃ´n ngá»¯ láº­p trÃ¬nh nhÆ° Javascript tháº¿ nÃ y sáº½ thay developer quáº£n lÃ½ bá»™ nhá»› báº±ng cÃ¡ch kiá»ƒm tra Ä‘á»‹nh ká»³ cÃ¡c vÃ¹ng nhá»› Ä‘Æ°á»£c cáº¥p phÃ¡t trÆ°á»›c Ä‘Ã³ cÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c â€œvá»›i tá»›iâ€ bá»Ÿi cÃ¡c pháº§n khÃ¡c trong á»©ng dá»¥ng. CÃ³ thá»ƒ nÃ³i cÃ¡ch khÃ¡c lÃ  nhá»¯ng ngÃ´n ngá»¯ nhÆ° Javascript sáº½ giÃºp biáº¿n váº¥n Ä‘á» tá»« â€œnhá»¯ng vÃ¹ng nhá»› nÃ o váº«n cÃ²n cáº§n trong á»©ng dá»¥ngâ€ thÃ nh â€œnhá»¯ng vÃ¹ng nhá»› nÃ o cÃ³ thá»ƒ Ä‘Æ°á»£c á»©ng dá»¥ng access Ä‘áº¿nâ€. Sá»± khÃ¡c biá»‡t cá»§a 2 váº¥n Ä‘á» lÃ  khÃ´ng nhiá»u nhÆ°ng láº¡i ráº¥t quan trá»ng: chá»‰ developer má»›i cÃ³ thá»ƒ biáº¿t Ä‘Æ°á»£c lÃ  vÃ¹ng nhá»› nÃ o cÃ²n cáº§n Ä‘á»ƒ cháº¡y tuy nhiÃªn, viá»‡c xÃ¡c Ä‘á»‹nh xem má»™t vÃ¹ng nhá»› cÃ³ thá»ƒ vÆ°Æ¡n tá»›i khÃ´ng trong á»©ng dá»¥ng thÃ¬ cÃ³ thá»ƒ lÃ m tá»± Ä‘á»™ng bá»Ÿi thuáº­t toÃ¡n. Memory leaks trong JSLÃ½ do chÃ­nh cá»§a memory leaks trong cÃ¡c ngÃ´n ngá»¯ cÃ³ garbage collection lÃ  cÃ¡c reference khÃ´ng mong muá»‘n vÃ o bá»™ nhá»› (unwanted references), tá»©c lÃ  má»™t vÃ¹ng nhá»› Ä‘Æ°á»£c trá» Ä‘áº¿n mÃ  láº¡i khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng trong á»©ng dá»¥ng. Äá»ƒ cÃ³ thá»ƒ hiá»ƒu rÃµ hÆ¡n vá» nÃ³, trÆ°á»›c háº¿t ta cáº§n tÃ¬m hiá»ƒu cÃ¡c hoáº¡t Ä‘á»™ng cá»§a garbage collector, cÃ¡ch nÃ³ xÃ¡c Ä‘á»‹nh má»™t vÃ¹ng nhá»› cÃ³ thá»ƒ Ä‘Æ°á»£c â€œvá»›i tá»›iâ€ (reach) bá»Ÿi á»©ng dá»¥ng. Mark and sweepHáº§u háº¿t cÃ¡c garbage collector Ä‘á»u sá»­ dá»¥ng thuáº­t toÃ¡n mark-and-sweep Ä‘á»ƒ thá»±c hiá»‡n viá»‡c giáº£i phÃ³ng bá»™ nhá»›. Thuáº­t toÃ¡n nÃ y bao gá»“m cÃ¡c bÆ°á»›c sau: Äáº§u tiÃªn, garbage collector sáº½ xÃ¢y dá»±ng má»™t danh sÃ¡ch cÃ¡c roots. Roots thá»±c cháº¥t lÃ  cÃ¡c biáº¿n toÃ n cá»¥c mÃ  cÃ³ reference Ä‘Æ°á»£c lÆ°u trong code. Trong Javascript, window chÃ­nh lÃ  má»™t biáº¿n toÃ n cá»¥c nhÆ° váº­y. Window sáº½ luÃ´n hiá»‡n há»¯u trong chÆ°Æ¡ng trÃ¬nh nÃªn garbage collector cÃ³ thá»ƒ coi nÃ³ vÃ  táº¥t cáº£ cÃ¡c con cá»§a nÃ³ luÃ´n hiá»‡n há»¯u. Táº¥t cáº£ roots vÃ  con cá»§a chÃºng sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº«u lÃ  Ä‘ang hoáº¡t Ä‘á»™ng. Táº¥t cáº£ nhá»¯ng vÃ¹ng nhá»› mÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c vÆ°Æ¡n tá»›i tá»« roots thÃ¬ Ä‘á»u Ä‘Æ°á»£c coi lÃ  Ä‘ang hoáº¡t Ä‘á»™ng vÃ  khÃ´ng Ä‘Ã¡nh dáº¥u lÃ  rÃ¡c (garbage). Táº¥t cáº£ cÃ¡c vÃ¹ng nhá»› mÃ  khÃ´ng Ä‘Æ°á»£c Ä‘Ã¡nh dáº«u lÃ  rÃ¡c (garbage) thÃ¬ bÃ¢y giá»› Ä‘á»u sáº½ Ä‘Æ°á»£c coi lÃ  rÃ¡c. BÃ¢y giá» thÃ¬ cÃ¡c collector cÃ³ thá»ƒ giáº£i phÃ³ng cÃ¡c vÃ¹ng nhá»› nÃ y. Máº·c dÃ¹ thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c tá»‘i Æ°u bá»Ÿi cÃ¡c GC (garbage collector) hiá»‡n Ä‘áº¡i tuy nhiÃªn cÆ¡ cháº¿ cá»§a nÃ³ váº«n khÃ´ng Ä‘á»•i: nhá»¯ng vÃ¹ng nhá»› vÆ°Æ¡n tÃ³i Ä‘Æ°á»£c thÃ¬ Ä‘Æ°á»£c coi lÃ  Ä‘ang hoáº¡t Ä‘á»™ng, nhá»¯ng vÃ¹ng nhá»› khÃ¡c sáº½ Ä‘Æ°á»£c coi lÃ  rÃ¡c. Nhá»¯ng tham chiáº¿u khÃ´ng mong muá»‘n (Unwanted references) lÃ  nhá»¯ng tham chiáº¿u Ä‘áº¿n cÃ¡c vÃ¹ng bá»™ nhá»› mÃ  developer biáº¿t lÃ  nÃ³ khÃ´ng Ä‘Æ°á»£c cáº§n Ä‘áº¿n ná»¯a nhÆ°ng vÃ¬ lÃ½ do nÃ o Ä‘Ã³ mÃ  nÃ³ váº«n Ä‘Æ°á»£c giá»¯ láº¡i trong há»‡ thá»‘ng. Trong JS, nhá»¯ng tham chiáº¿u khÃ´ng mong muá»‘n nÃ y lÃ  cÃ¡c biáº¿n (variables) Ä‘Æ°á»£c giá»¯ Ä‘Ã¢u Ä‘Ã³ trong code mÃ  nÃ³ sáº½ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘áº¿n ná»¯a nhÆ°ng láº¡i trá» Ä‘áº¿n má»™t vÃ¹ng nhá»› mÃ  cáº§n Ä‘Æ°á»£c giáº£i phÃ³ng. Äá»ƒ hiá»ƒu Ä‘Æ°á»£c memory leaks trong JS, ta cáº§n biáº¿t Ä‘Æ°á»£c lÃ  khi nÃ o thÃ¬ má»™t tham chiáº¿u bá»‹ lÃ£ng quÃªn. 3 loáº¡i memory leaks trong JS1: Biáº¿n toÃ n cá»¥cJavascript cÃ³ má»™t cÆ¡ cháº¿ lÃ  Ä‘áº·t biáº¿n mÃ  khÃ´ng cáº§n khai bÃ¡o. VÃ­ dá»¥: 12a = \"value\";console.log(a); //\"a\" Khi má»™t biáº¿n Ä‘Æ°á»£c khai bÃ¡o nhÆ° trÃªn thÃ¬ JS sáº½ tá»± Ä‘á»™ng gÃ¡n nÃ³ vÃ o global object (window trÃªn browser). Náº¿u nhÆ° biáº¿n nÃ y chá»‰ hoáº¡t Ä‘á»™ng trÃªn pháº¡m vi toÃ n cá»¥c (global scope) thÃ¬ cÅ©ng khÃ´ng cÃ³ sá»± khÃ¡c biá»‡t cho láº¯m. Tuy nhiÃªn, náº¿u nÃ³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong má»™t hÃ m thÃ¬ Ä‘Ã³ láº¡i lÃ  chuyá»‡n khÃ¡c. VÃ­ dá»¥: 123function foo()&#123; bar = \"Ä‘Ã¢y lÃ  biáº¿n toÃ n cá»¥c áº©n\"&#125; Äoáº¡n code trÃªn sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i Ä‘oáº¡n code sau trÃªn browser: 123function foo()&#123; window.bar = \"Ä‘Ã¢y lÃ  biáº¿n toÃ n cá»¥c\"&#125; Náº¿u khai bÃ¡o bar trong pháº¡m vi cá»§a hÃ m foo mÃ  láº¡i khÃ´ng sá»­ dá»¥ng var Ä‘á»ƒ khai bÃ¡o thÃ¬ biáº¿n bar sáº½ Ä‘Æ°á»£c táº¡o vá»›i pháº¡m vi toÃ n cá»¥c, vÃ  Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh vá» memory leaks. Má»™t cÃ¡ch khÃ¡c mÃ  cÃ³ thá»ƒ vÃ´ tÃ¬nh táº¡o ra biáº¿n toÃ n cá»¥c Ä‘Ã³ lÃ  thÃ´ng qua this: 12345function foo() &#123; this.variable = \"cÃ³ thá»ƒ lÃ  biáº¿n toÃ n cá»¥c\";&#125;foo(); VÃ¬ this trong hÃ m sáº½ trá» Ä‘áº¿n biáº¿n root toÃ n cá»¥c (window) náº¿u hÃ m Ä‘Ã³ Ä‘Æ°á»£c gá»i trá»±c tiáº¿p khÃ´ng thÃ´ng qua object nÃ o khÃ¡c nÃªn á»Ÿ vÃ­ dá»¥ trÃªn, biáº¿n variable sáº½ Ä‘Æ°á»£c gáº¯n vÃ o pháº¡m vi toÃ n cá»¥c. Má»™t cÃ¡ch Ä‘á»ƒ giáº£m thiá»ƒu nhá»¯ng lá»—i trÃªn Ä‘Ã³ lÃ  thÃªm &quot;use strict;&quot; vÃ o dÃ²ng Ä‘áº§u tiÃªn cá»§a file JS. NÃ³ sáº½ giÃºp ngÄƒn cháº·n viá»‡c khai bÃ¡o biáº¿n toÃ n cá»¥c nhÆ° trÃªn. ChÃº Ã½ khi lÃ m viá»‡c vá»›i biáº¿n toÃ n cá»¥c Biáº¿n toÃ n cá»¥c khÃ´ng bao giá» Ä‘Æ°á»£c giáº£i phÃ³ng bá»™ nhá»› tá»± Ä‘á»™ng theo thuáº­t toÃ¡n mark-and-sweep á»Ÿ trÃªn. VÃ¬ tháº¿, biáº¿n toÃ n cá»¥c chá»‰ nÃªn Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u táº¡m dá»¯ liá»‡u Ä‘á»ƒ xá»­ lÃ½. Náº¿u cáº§n lÆ°u má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u vÃ o biáº¿n toÃ n cá»¥c thÃ¬ cáº§n Ä‘áº£m báº¡o lÃ  nÃ³ sáº½ bá»‹ gÃ¡n vá» null hoáº·c gÃ¡n láº¡i dá»¯ liá»‡u khi mÃ  báº¡n Ä‘Ã£ sá»­ dá»¥ng xong nÃ³. 2: Callback vÃ  timer bá»‹ lÃ£ng quÃªnSau Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ dáº«n Ä‘áº¿n memory leak khi sá»­ dá»¥ng setInterval: 1234567var data = getData();setInterval(function()&#123; var node = document.getElementById(\"Node\"); if(node)&#123; node.innerHTML = JSON.stringify(someResource)); &#125;&#125;, 1000); ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» má»™t timer bá»‹ treo. Timáº» bá»‹ treo tá»©c lÃ  khi timer tham chiáº¿u Ä‘áº¿n cÃ¡c node hoáº·c dá»¯ liá»‡u mÃ  khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a. á» vÃ­ dá»¥ trÃªn, náº¿u nhÆ° node bá»‹ xÃ³a á»Ÿ má»™t lÃºc nÃ o Ä‘áº¥y thÃ¬ toÃ n bá»™ Ä‘oáº¡n code xá»­ lÃ½ trong hÃ m callback cá»§a interval sáº½ khÃ´ng cáº§n Ä‘áº¿n ná»¯a. Tuy nhiÃªn, vÃ¬ interval váº«n cÃ²n hoáº¡t Ä‘á»™ng nÃªn cÃ¡c vÃ¹ng nhá»› Ä‘Æ°á»£c sá»­ dá»¥ng trong hÃ m callback cá»§a interval cÅ©ng khÃ´ng Ä‘Æ°á»£c giáº£i phÃ³ng (muá»‘n giáº£i phÃ³ng cáº§n dá»«ng interval láº¡i). Tiáº¿p Ä‘Ã³, cÃ¡c object tá»« bÃªn ngoÃ i mÃ  Ä‘Æ°á»£c hÃ m callback cá»§a interval tham chiáº¿u Ä‘áº¿n cÅ©ng khÃ´ng thá»ƒ Ä‘Æ°á»£c giáº£i phÃ³ng vÃ¬ váº«n cÃ³ thá»ƒ vÆ°Æ¡n tá»›i Ä‘Æ°á»£c thÃ´ng qua hÃ m callback kia. Theo vÃ­ dá»¥ trÃªn thÃ¬ Ä‘Ã³ lÃ  data. Má»™t trÆ°á»ng há»£p cÃ³ thá»ƒ dáº«n Ä‘áº¿n leaks Ä‘Ã³ lÃ  do cÃ¡c observers object (DOM vÃ  event listener cá»§a chÃºng). Äiá»u nÃ y chá»‰ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c trÃ¬nh duyá»‡t cÅ© (vd: IE6) vÃ¬ cÃ¡c trÃ¬nh duyá»‡t má»›i sáº½ tá»± Ä‘á»™ng lÃ m Ä‘iá»u nÃ y cho chÃºng ta. ÄÃ¢y lÃ  má»™t bug cá»§a GC cá»§a IE6 vÃ  dáº«n Ä‘áº¿n viá»‡c tham chiáº¿u quay vÃ²ng. 3: Tham chiáº¿u tá»›i cÃ¡c DOM Ä‘Ã£ bá»‹ xÃ³aCÃ³ nhá»¯ng lÃºc báº¡n muá»‘n lÆ°u cÃ¡c DOM vÃ o má»™t sá»‘ cáº¥u trÃºc dá»¯ liá»‡u nhÆ° máº£ng hoáº·c object trong JS code Ä‘á»ƒ lÃ m má»™t loáº¡t cÃ¡c tÃ¡c vá»¥ nÃ o Ä‘áº¥y. VÃ­ dá»¥ báº¡n muá»‘n update dá»¯ liá»‡u cá»§a má»™t vÃ i element nÃ o Ä‘áº¥y thÃ¬ viá»‡c lÆ°u cÃ¡c element nÃ y vÃ o má»™t máº£ng lÃ  hoÃ n toÃ n há»£p lÃ½. Khi Ä‘iá»u nÃ y xáº£y ra thÃ¬ sáº½ cÃ³ 2 tham chiáº¿u Ä‘Ãªn DOM element nÃ y: má»™t lÃ  tá»« DOM tree, hai lÃ  tá»« Ä‘á»‘i tÆ°á»£ng máº£ng cá»§a JS. Náº¿u báº¡n muá»‘n xÃ³a cÃ¡c element nÃ y thÃ¬ báº¡n cáº§n pháº£i xÃ³a toÃ n bá»™ cÃ¡c tham chiáº¿u tá»›i chÃºng Ä‘á»ƒ cÃ³ thá»ƒ giáº£i phÃ³ng bá»™ nhá»›. VÃ­ dá»¥: 12345678910111213141516171819var elements = &#123; button: document.getElementById('button'), image: document.getElementById('image'), text: document.getElementById('text')&#125;function doStuff() &#123; image.src = 'http://some.url/image'; button.click(); console.log(text.innerHTML);&#125;function removeButton() &#123; // button lÃ  con cá»§a body. document.body.removeChild(document.getElementById('button')); // á» Ä‘Ã¢y thÃ¬ button váº«n Ä‘Æ°á»£c tham chiá»ƒu Ä‘áº¿n bá»Ÿi elements. NÃ³i cÃ¡ch khÃ¡c lÃ  // nÃ³ váº«n náº±m trong bá»™ nhá»› vÃ  khÃ´ng thá»ƒ Ä‘Æ°á»£c giáº£i phÃ³ng.&#125; CÃ²n má»™t váº¥n Ä‘á» quan trá»ng ná»¯a lÃ  khi tham chiáº¿u Ä‘áº¿n má»™t node lÃ¡ hoáº·c má»™t inner node cá»§a DOM tree, vÃ­ dá»¥ nhÆ° má»™t Ã´ trong báº£ng (&lt;td&gt; cá»§a &lt;table&gt;). Náº¿u báº¡n tham chiáº¿u Ä‘áº¿n &lt;td&gt; nÃ y trong JS code thÃ¬ khi báº¡n xÃ³a &lt;table&gt; chá»©a node nÃ y thÃ¬ GC sáº½ khÃ´ng giáº£i phÃ³ng Ä‘Æ°á»£c cáº£ table chá»© khÃ´ng pháº£i lÃ  chá»‰ má»—i &lt;td&gt; node khÃ´ng Ä‘Æ°á»£c giáº£i phÃ³ng. VÃ¬ node con cÃ²n tham chiáº¿u Ä‘áº¿n node cha nÃªn nÃ³ sáº½ Ä‘Æ°á»£c GC coi lÃ  váº«n Ä‘Æ°á»£c tham chiáº¿u vÃ  bá» qua nÃ³. VÃ¬ tháº¿ nÃªn cáº©n tháº­n khi tham chiáº¿u Ä‘áº¿n cÃ¡c DOM. 4: ClosuresClosures cÃ³ nghÄ©a Ä‘Æ¡n giáº£n lÃ  hÃ m náº±m trong pháº¡m vi cá»§a má»™t hÃ m khÃ¡c cÃ³ thá»ƒ tham chiáº¿u tá»›i cÃ¡c biáº¿n cá»§a hÃ m bao nÃ³. VÃ¬ sao Closures cÃ³ thá»ƒ gÃ¢y ra leak, hÃ£y xem vÃ­ dá»¥ sau: 123456789101112131415var theThing = null;var replaceThing = function () &#123; var originalThing = theThing; var unused = function () &#123; if (originalThing) console.log(\"hi\"); &#125;; theThing = &#123; longStr: new Array(1000000).join('*'), someMethod: function () &#123; console.log(someMessage); &#125; &#125;;&#125;;setInterval(replaceThing, 1000); VÃ­ dá»¥ nÃ y cho ta tháº¥y má»—i khi replaceThing Ä‘Æ°á»£c gá»i, theThing sáº½ táº¡o ra má»™t object má»›i chá»©a má»™t máº£ng vÃ  má»™t closures (someMethod). CÃ¹ng lÃºc Ä‘Ã³, biáº¿n unused cÅ©ng lÆ°u má»™t closures tham chiáº¿u Ä‘Ãªn originalThing (lÃ  object theThing Ä‘Æ°á»£c táº¡o ra tá»« viá»‡c gá»i replaceThing á»Ÿ bÆ°á»›c trÆ°á»›c Ä‘Ã³). Má»™t Ä‘iá»u quan trá»ng ná»¯a lÃ  khi má»™t scope Ä‘Æ°á»£c táº¡o ra cho cÃ¡c closures mÃ  cÃ³ cÃ¹ng scope cha, chÃºng sáº½ cÃ¹ng chia sáº» scope Ä‘Ã³. Trong vÃ­ dá»¥ nÃ y thÃ¬ someMethod vÃ  unused Ä‘á»u chia sáº» cÃ¹ng má»™t scope. Máº·c dÃ¹ unused khÃ´ng Ä‘Æ°á»£c gá»i Ä‘áº¿n nhÆ°ng vÃ¬ nÃ³ cÃ³ tham chiáº¿u Ä‘áº¿n originalThing nÃªn nÃ³ sáº½ Ä‘Æ°á»£c GC coi lÃ  váº«n Ä‘ang hoáº¡t Ä‘á»™ng. Khi Ä‘oáº¡n code nÃ y cháº¡y thÃ¬ bá»™ nhá»› cá»§a chÆ°Æ¡ng trÃ¬nh sáº½ tÄƒng Ä‘á»u Ä‘áº·n vÃ  cÃ³ thá»ƒ nhÃ¬n tháº¥y ngay Ä‘Æ°á»£c. Vá» báº£n cháº¥t, má»™t linked-list cá»§a closures Ä‘Æ°á»£c táº¡o (vá»›i root lÃ  theThing) khi Ä‘oáº¡n code trÃªn Ä‘Æ°á»£c cháº¡y vÃ  Ä‘Ã³ lÃ  lÃ½ do bá»™ nhá»› bá»‹ tÄƒng dáº§n theo thá»i gian. Garbage Collectors (bá»™ dá»n rÃ¡c)Máº·c dÃ¹ GCs giÃºp chÃºng ta khÃ´ng pháº£i quáº£n lÃ½ bá»™ nhá»› báº±ng tay ná»¯a, tuy nhiÃªn ta cÅ©ng sáº½ pháº£i Ä‘Ã¡nh Ä‘á»•i láº¡i má»™t vÃ i thá»©. Má»™t trong sá»‘ Ä‘Ã³ lÃ  viá»‡c cÃ¡c GCs hoáº¡t Ä‘á»™ng theo má»™t cÃ¡ch khÃ³ Ä‘oÃ¡n biáº¿t. ThÃ´ng thÆ°á»ng ráº¥t khÃ³ cÃ³ thá»ƒ cháº¯c cháº¯n ráº±ng má»™t hoáº¡t Ä‘á»™ng thu tháº­p cÃ¡c vÃ¹ng nhá»› khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘Æ°á»£c thá»±c thi hay khÃ´ng. Äiá»u nÃ y cÅ©ng cÃ³ nghÄ©a lÃ  trong má»™t sá»‘ trÆ°á»ng há»£p, sá»‘ lÆ°á»£ng vÃ¹ng nhá»› cá»§a má»™t chÆ°Æ¡ng trÃ¬nh nhiá»u hÆ¡n sá»‘ bá»™ nhá»› mÃ  chÆ°Æ¡ng trÃ¬nh Ä‘Ã³ cáº§n. Trong má»™t sá»‘ trÆ°á»ng há»£p khÃ¡c, á»©ng dá»¥ng sáº½ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi má»™t khoáº£ng thá»i gian nhá» chÆ°Æ¡ng trÃ¬nh bá»‹ delay Ä‘á»ƒ thá»±c hiá»‡n cÃ´ng viá»‡c thu tháº­p bá»™ nhá»›. Hiá»‡n nay, háº§u háº¿t GC Ä‘á»u hoáº¡t Ä‘á»™ng theo cÃ¡ch lÃ  chá»‰ thá»±c hiá»‡n viá»‡c thu tháº­p bá»™ nhá»› khi cáº¥p phÃ¡t bá»™ nhá»› cho chÆ°Æ¡ng trÃ¬nh. Náº¿u khÃ´ng cáº§n cáº¥p phÃ¡t bá»™ nhá»›, GCs sáº½ khÃ´ng hoáº¡t Ä‘á»™ng. ChÃºng ta sáº½ xem xÃ©t cÃ¡c tÃ¬nh huá»‘ng sau: ChÆ°Æ¡ng trÃ¬nh Ä‘Ã£ cáº¥p phÃ¡t má»™t sá»‘ lÆ°á»£ng nhá» bá»™ nhá»›. Sau Ä‘Ã³, háº§u háº¿t (hoáº·c toÃ n bá»™) cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  khÃ´ng thá»ƒ vÆ°Æ¡n tá»›i ná»¯a. ChÆ°Æ¡ng trÃ¬nh khÃ´ng thá»±c hiá»‡n viá»‡c cáº¥p phÃ¡t bá»™ nhá»› ná»¯a. Trong tÃ¬nh huá»‘ng nÃ y, háº§u nhÆ° táº¥t cáº£ cÃ¡c GC sáº½ khÃ´ng thá»±c hiá»‡n viá»‡c thu tháº­p bá»™ nhá»› ná»¯a. NÃ³i cÃ¡ch khÃ¡c, máº·c dÃ¹ cÃ³ nhá»¯ng pháº§n tá»­ khÃ´ng thá»ƒ vÆ°Æ¡n tá»›i Ä‘Æ°á»£c ná»¯a trong chÆ°Æ¡ng trÃ¬nh, chÃºng sáº½ khÃ´ng Ä‘Æ°á»£c thu há»“i láº¡i bá»™ nhá»›. ÄÃ¢y khÃ´ng háº³n lÃ  leaks, tuy nhiÃªn nÃ³ váº«n dáº«n Ä‘áº¿n viá»‡c chÆ°Æ¡ng trÃ¬nh ngá»‘n bá»™ nhá»›. Chrome Memory Profiling ToolsChrome cung cáº¥p má»™t táº­p cÃ¡c cÃ´ng cá»¥ Ä‘á»ƒ kiá»ƒm tra tÃ¬nh tráº¡ng sá»­ dá»¥ng bá»™ nhá»› cá»§a code JS. CÃ³ 2 view quan trá»ng liÃªn quan Ä‘áº¿n bá»™ nhá»› Ä‘Ã³ lÃ : timeline vÃ  profiles. Timeline ViewTimeline View cÃ³ thá»ƒ giÃºp ta biáº¿t Ä‘Æ°á»£c mÃ´ hÃ¬nh sá»­ dá»¥ng bá»™ nhá»› cá»§a chÆ°Æ¡ng trÃ¬nh. Tá»« Ä‘Ã¢y ta cÃ³ thá»ƒ nhÃ¬n Ä‘Æ°á»£c viá»‡c rÃ² rá»‰ bá»™ nhá»›, viá»‡c bá»™ nhá»› sá»­ dá»¥ng tÄƒng liÃªn tá»¥c theo thá»i gian mÃ  khÃ´ng giáº£m xuá»‘ng sau má»—i láº§n GC Ä‘Æ°á»£c cháº¡y. VÃ­ dá»¥: Ta cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c viá»‡c bá»™ nhá»› rÃ² rá»‰ Ä‘Æ°á»£c thá»ƒ hiá»‡n thÃ´ng qua viá»‡c JS heap tÄƒng dáº§n theo thá»i gian. Máº·c dÃ¹ sau khi Ä‘Æ°á»£c thu tháº­p vá»›i má»™t sá»‘ lÆ°á»£ng lá»›n táº¡i Ä‘oáº¡n cuá»‘i thÃ¬ chÆ°Æ¡ng trÃ¬nh váº«n sá»­ dá»¥ng sá»‘ lÆ°á»£ng bá»™ nhá»› nhiá»u hÆ¡n so vá»›i lÃºc báº¯t Ä‘áº§u. Sá»‘ lÆ°á»£ng Node cÅ©ng cao hÆ¡n. ÄÃ¢y lÃ  dáº¥u hiá»‡u cá»§a viá»‡c cÃ¡c node DOM bá»‹ rÃ² rá»‰ Ä‘Ã¢u Ä‘Ã³ trong code.o Profiles view ÄÃ¢y lÃ  cÃ´ng cá»¥ sáº½ luÃ´n gáº¯n bÃ³ vá»›i báº¡n khi pháº£i Ä‘iá»u tra vá» rÃ² rá»‰ bá»™ nhá»›. Profiles view cho phÃ©p báº¡n láº¥y áº£nh chá»¥p (snapshot) vá» viá»‡c sá»­ dá»¥ng bá»™ nhá»› cá»§a má»™t chÆ°Æ¡ng trÃ¬nh Javascript. NÃ³ cÅ©ng cho phÃ©p báº¡n ghi láº¡i nhá»¯ng láº§n cáº¥p phÃ¡t bá»™ nhá»› theo thá»i gian. Má»—i má»™t loáº¡i káº¿t quáº£ sáº½ cÃ³ cÃ¡c danh sÃ¡ch liá»‡t kÃª khÃ¡c nhau Ä‘Æ°á»£c Ä‘Æ°a ra, tuy nhiÃªn nhá»¯ng thá»© mÃ  báº¡n cáº§n quan tÃ¢m Ä‘Ã³ lÃ  danh sÃ¡ch tá»•ng há»£p (summary list) vÃ  danh sÃ¡ch so sÃ¡nh (comparision list). Summary View sáº½ cho ta tháº¥y Ä‘Æ°á»£c tá»•ng quan vá» cÃ¡c loáº¡i objects Ä‘Æ°á»£c khá»Ÿi táº¡o vÃ  cáº¥p phÃ¡t cÃ¹ng vá»›i cÃ¡c kÃ­ch thÆ°á»›c tá»•ng há»£p (aggregated size): kich thÆ°á»›c nÃ´ng (Shallow size) lÃ  tá»•ng kÃ­ch thÆ°á»›c cá»§a táº¥t cáº£ cÃ¡c object cá»§a má»™t loáº¡i cá»¥ thá»ƒ nÃ o Ä‘Ã³ vÃ  kÃ­ch thÆ°á»›c giá»¯ láº¡i (retained size) bao gá»“m shallow size vÃ  kÃ­ch thÆ°á»›c cá»§a cÃ¡c object Ä‘Æ°á»£c lÆ°u láº¡i bá»Ÿi object nÃ y. NÃ³ cÅ©ng cho ta má»™t thÃ´ng tin vá» khoáº£ng cÃ¡ch giá»¯a má»™t object vá»›i root. Comparision View cÅ©ng cung cáº¥p cÃ¹ng má»™t thÃ´ng tin nhÆ° summary view nhÆ°ng nÃ³ cho phÃ©p ta so sÃ¡nh giá»¯a cÃ¡c snapshot khÃ¡c nhau. VÃ­ dá»¥: TÃ¬m kiáº¿m rÃ² rá»‰ dá»¯ liá»‡u trong ChromeCÃ³ 2 kiá»ƒu rÃ² rá»‰ dá»¯ liá»‡u chá»§ yáº¿u lÃ : rá» rá»‰ dáº«n Ä‘áº¿n viá»‡c bá»™ nhá»› bá»‹ tÄƒng má»™t cÃ¡ch Ä‘á»u Ä‘áº·n theo thá»i gian vÃ  rÃ² rá»‰ chá»‰ xáº£y ra má»™t láº§n duy nháº¥t vÃ  khÃ´ng gÃ¢y ra viá»‡c bá»™ nhá»› bá»‹ tÄƒng trong tÆ°Æ¡ng lai ná»¯a. Viá»‡c tÃ¬m rÃ² rá»‰ dá»¯ liá»‡u mÃ  bá»™ nhá»› bá»‹ tÄƒng dáº§n theo thá»i gian khÃ¡ lÃ  Ä‘Æ¡n giáº£n vÃ  rÃµ rÃ ng (sá»­ dá»¥ng timeline view). Tuy nhiÃªn thÃ¬ Ä‘Ã¢y láº¡i lÃ  rÃ² rá»‰ gÃ¢y ra nhiá»u ráº¯c rá»‘i nháº¥t: náº¿u bá»™ nhá»› cá»© tÄƒng dáº§n theo thá»i gian, nÃ³ sáº½ khiáº¿n trÃ¬nh duyá»‡t cháº¡y cháº­m dáº­n vÃ  cuá»‘i cÃ¹ng sáº½ dáº«n Ä‘áº¿n viá»‡c script bá»‹ ngá»«ng cháº¡y. RÃ² rá»‰ mÃ  khÃ´ng dáº«n Ä‘áº¿n viá»‡c bá»™ nhá»› bá»‹ tÄƒng theo thá»i gian cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c tÃ¬m ra khi bá»™ nhá»› lá»›n Ä‘áº¿n má»™t má»©c Ä‘á»™ nÃ o Ä‘Ã³. ThÃ´ng thÆ°á»ng nhá»¯ng rÃ² rá»‰ kiá»ƒu nÃ y khÃ´ng Ä‘Æ°á»£c chÃº Ã½ quáº£ nhiá»u. NÃ³i theo má»™t cÃ¡ch khÃ¡c, nhá»¯ng rÃ² rá»‰ nhá» mÃ  chá»‰ xáº£y ra má»™t láº§n thÆ°á»ng Ä‘Æ°á»£c coi lÃ  má»™t váº¥n Ä‘á» Ä‘á»ƒ tá»‘i Æ°u code. Tuy nhiÃªn, nhá»¯ng rÃ² rá»‰ mÃ  lÃ m bá»™ nhá»› tÄƒng dáº§n theo thá»i gian thÃ¬ Ä‘Æ°á»£c coi lÃ  bug vÃ  nÃ³ cáº§n Ä‘Æ°á»£c fix. á» Ä‘Ã¢y ta sáº½ sá»­ dá»¥ng má»™t vÃ­ dá»¥ tá»« Chrome. ToÃ n bá»™ Ä‘oáº¡n code nhÆ° sau: 123456789101112131415161718var x = []; function createSomeNodes() &#123; var div, i = 100, frag = document.createDocumentFragment(); for (;i &gt; 0; i--) &#123; div = document.createElement(\"div\"); div.appendChild(document.createTextNode(i + \" - \"+ new Date().toTimeString())); frag.appendChild(div); &#125; document.getElementById(\"nodes\").appendChild(frag);&#125;function grow() &#123; x.push(new Array(1000000).join('x')); createSomeNodes(); setTimeout(grow,1000);&#125; Khi grow Ä‘Æ°á»£c gá»i, nÃ³ sáº½ báº¯t Ä‘áº§u táº¡o má»™t div vÃ  gÃ¡n nÃ³ vÃ o DOM. NÃ³ cÅ©ng sáº½ khá»Ÿi táº¡o má»™t máº£ng lá»›n (1 triá»‡u pháº§n tá»­) vÃ  gÃ¡n nÃ³ vÃ o má»™t máº£ng Ä‘Æ°á»£c tham chiáº¿u bá»i má»™t biáº¿n toÃ n cá»¥c (x). Viá»‡c nÃ y sáº½ dáº«n Ä‘áº¿n viá»‡c bá»™ nhá»› bá»‹ tÄƒng Ä‘á»u Ä‘áº·n vÃ  cÃ³ thá»ƒ nháº­n biáº¿t Ä‘Æ°á»£c vá»›i Timeline view. PhÃ¡t hiá»‡n viá»‡c bá»™ nhá»› bá»‹ tÄƒng Ä‘á»u Ä‘áº·n trong ChromeTa sáº½ báº¯t Ä‘áº§u vá»›i vÃ­ dá»¥ sau cá»§a chrome. Sau khi click vÃ o vÃ­ dá»¥ cá»§a Chrome, má»Ÿ Dev Tools, click vÃ o tab timeline, tÃ­ch chá»n memory vÃ  click vÃ o nÃºt record. Tiáº¿p Ä‘Ã³ quay láº¡i trang vÃ­ dá»¥ vÃ  click vÃ o The Button Ä‘á»ƒ báº¯t Ä‘áº§u viá»‡c rÃ² rá»‰ bá»™ nhá»›. Sau má»™t khoáº£ng thá»i gian thÃ¬ dá»«ng láº¡i viá»‡c record vÃ  xem káº¿t quáº£: Note: VÃ­ dá»¥ nÃ y sáº½ khiáº¿n bá»™ nhá»› bá»‹ tÄƒng má»—i giÃ¢y. Sau khi dá»«ng viá»‡c record thÃ¬ cÃ¡c báº¡n cÃ³ thá»ƒ Ä‘áº·t breakpoint vÃ o grow Ä‘á»ƒ dá»«ng viá»‡c thá»±c thi script. CÃ³ 2 dáº¥u hiá»‡u lá»›n trong bá»©c áº£nh trÃªn cho tháº¥y viá»‡c rÃ² rá»‰ bá»™ nhá»›: biá»ƒu Ä‘á»“ cho nodes (Ä‘Æ°á»ng káº» mÃ u xanh lÃ¡) vÃ  biá»ƒu Ä‘á»“ cho JS heap (Ä‘Æ°á»ng káº» mÃ u xanh Ä‘áº­m). Sá»‘ lÆ°á»£ng node luÃ´n luÃ´n tÄƒng vÃ  khÃ´ng bao giá» giáº£m. ÄÃ¢y lÃ  dáº¥u hiá»‡u cáº£nh bÃ¡o lá»›n. JS heap cÅ©ng tÄƒng dáº§n theo thá»i gian tuy nhiÃªn Ä‘iá»u nÃ y khÃ³ nhÃ¬n ra hÆ¡n do hiá»‡u á»©ng tá»« GC. CÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y lÃ  bá»™ nhá»› tÄƒng sau láº¡i giáº£m má»™t cÃ¡ch liÃªn tá»¥c. Äiá»ƒm quan trá»ng cáº§n chÃº Ã½ á» Ä‘Ã¢y lÃ  sau má»—i láº§n bá»™ nhá»› Ä‘Æ°á»£c giáº£m thÃ¬ kÃ­ch thÆ°á»›c cá»§a JS heap váº«n lá»›n hÆ¡n so vá»›i láº§n giáº£m trÆ°á»›c Ä‘áº¥y. NÃ³i cÃ¡ch khÃ¡c, máº·c dÃ¹ GC Ä‘Ã£ thÃ nh cÃ´ng thu tháº­p Ä‘Æ°á»£c ráº¥t nhiá»u bá»™ nhá»›, má»™t vÃ i trong sá»‘ Ä‘Ã³ bá»‹ rÃ² rá»‰. BÃ¢y giá» ta Ä‘Ã£ cháº¯c cháº¯n chÆ°Æ¡ng trÃ¬nh cá»§a mÃ¬nh bá»‹ rÃ² rá»‰ bá»™ nhá»›, ta cáº§n pháº£i tÃ¬m ra nguyÃªn nhÃ¢n cá»§a nÃ³. Táº¡o 2 snapshotÄá»ƒ tÃ¬m ra nguyÃªn nhÃ¢n rÃ² rá»‰, ta sáº½ sá»­ dá»¥ng Ä‘áº¿n cÃ´ng cá»¥ profiles cá»§a Chrome. Cá»¥ thá»ƒ hÆ¡n, ta sáº½ sá»­ dá»¥ng tÃ­nh nÄƒng Take Heap Snapshot. Äáº§u tiÃªn, reload láº¡i trang vÃ  táº¡o má»™t snapshot ngay sau khi load xong trang. Ta sáº½ sá»­ dá»¥ng snapshot nÃ y lÃ m cÆ¡ sá»Ÿ. Sau Ä‘Ã³, click vÃ o The Button má»™t láº§n nÅ©a, chá» khoáº£ng má»™t vÃ i giÃ¢y, táº¡o má»™t snapshot khÃ¡c. Sau Ä‘Ã³ táº¡o breakpoint Ä‘á»ƒ dá»«ng viá»‡c rÃ² rá»‰ bá»™ nhá»› láº¡i. CÃ³ 2 cÃ¡ch mÃ  ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra sá»± khÃ¡c nhau giá»¯a 2 snapshot. Thá»© nháº¥t lÃ  sá»­ dá»¥ng chá»©c nÄƒng Summary rá»“i báº¯t Ä‘áº§u tá»« phÃ­a bÃªn pháº£i chá»n Objects allocated between Snapshot 1 and Snapshot 2. Hoáº·c chá»n Comparision thay cho Summary. Trong cáº£ 2 trÆ°á»ng há»£p, ta sáº½ tháº¥y má»™t danh sÃ¡ch cÃ¡c object Ä‘Æ°á»£c khá»Ÿi táº¡o giá»¯a 2 snapshot. Trong trÆ°á»ng há»£p nÃ y thÃ¬ viá»‡c tÃ¬m ra leaks ráº¥t Ä‘Æ¡n giáº£n. HÃ£y xem Size Delta cá»§a (string). 8MB vá»›i 58 object má»›i. Äiá»u nÃ y ráº¥t Ä‘Ã¡ng nghi ngá»: object má»›i Ä‘Æ°á»£c táº¡o nhÆ°ng khÃ´ng Ä‘Æ°á»£c giáº£i phÃ³ng vÃ  8MB bá»‹ chiáº¿m máº¥t. Náº¿u ta má»Ÿ danh sÃ¡ch khá»Ÿi táº¡o cá»§a (string) ta sáº½ tháº¥y cÃ³ má»™t vÃ i object lá»›n Ä‘Æ°á»£c khá»Ÿi táº¡o bÃªn cáº¡nh cÃ¡c object nhá». Náº¿u ta chá»n má»™t trong sá»‘ cÃ¡c object lá»›n nÃ y thÃ¬ ta sáº½ tháº¥y má»™t vÃ i Ä‘iá»ƒm thÃº vá»‹ trong má»¥c retainers: Ta tháº¥y ráº±ng object Ä‘Æ°á»£c chá»n lÃ  má»™t pháº§n tá»­ cá»§a máº£ng. Tiáº¿p Ä‘Ã³ ta biáº¿t Ä‘Æ°á»£c máº£ng nÃ y Ä‘Æ°á»£c tham chiáº¿u bá»Ÿi biáº¿n x náº±m á»Ÿ trong window. Äiá»u nÃ y cho ta tháº¥y Ä‘Æ°á»£c toÃ n bá»™ con Ä‘Æ°á»ng tá»« object lá»›n cá»§a chÃºng ta liÃªn káº¿t tháº¿ nÃ o vá»›i root (window). Ta Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c má»™t nguyÃªn nhÃ¢n dáº«n Ä‘áº¿n rÃ² rá»‰ vÃ  nÆ¡i nÃ³ Ä‘Æ°á»£c tham chiáº¿u. Vi dá»¥ nÃ y khÃ¡ Ä‘Æ¡n giáº£n: object lá»›n Ä‘Æ°á»£c khá»i táº¡o tháº¿ nÃ y khÃ´ng thÆ°á»ng xuyÃªn xuáº¥t hiá»‡n trong chÆ°Æ¡ng trinh. Tuy nhiÃªn trong chÆ°Æ¡ng trÃ¬nh nÃ y cÅ©ng cÃ³ xuáº¥t hiá»‡n viá»‡c rÃ² rá»‰ DOM cÃ³ kÃ­ch cá»¡ nhá» hÆ¡n. Nhá»¯ng node nÃ y cÃ³ thá»ƒ tÃ¬m tháº¥y Ä‘Æ°Æ¡c thÃ´ng qua snapshot tuy nhiÃªn Ä‘á»‘i vá»›i nhá»¯ng site lá»›n, má»i chuyá»‡n sáº½ trá»Ÿ nÃªn ráº¯c rá»‘i hÆ¡n nhiá»u. CÃ¡c phiÃªn báº£n Chrome hiÃªn táº¡i cÃ³ cung cáº¥p má»™t tÃ­nh nÄƒng Ä‘Ã³ lÃ : Record Heap Allocations Record Heap AllocationsTa se báº¯t Ä‘áº§u vá»›i viÃªc Ä‘á»ƒ cho Ä‘oáº¡n script tiáº¿p tá»¥c Ä‘Æ°á»£c cháº¡y vÃ  quay láº¡i tab Profiles cá»§a Chrome Dev Tools. áº¤n nÃºt Record Heap Allocations. Khi mÃ  tool Ä‘ang cháº¡y, cÃ¡c báº¡n sáº½ tháº¥y má»™t vÃ i váº¡ch xanh trÃªn biá»ƒu Ä‘á»“ á»Ÿ phÃ­a trÃªn Ä‘áº§u. NÃ³ thá»ƒ hiá»‡n viá»‡c khá»Ÿi táº¡o object khi cháº¡y chÆ°Æ¡ng trÃ¬nh. Ta cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c tÃ­nh nÄƒng cá»§a cÃ´ng cá»¥ nÃ y: chá»n má»™t khoáº£ng thá»i gian Ä‘á»ƒ xem object nÃ o Ä‘Æ°á»£c khá»Ÿi táº¡o trong khoáº£ng thá»i gian nÃ y. Ta Ä‘áº·t khoáº£ng thá»i gian nÃ y gáº§n cÃ¡c váº¡ch xanh Ä‘áº­m nháº¥t cÃ³ thá»ƒ. Chá»‰ cÃ³ 3 hÃ m khá»Ÿi táº¡o Ä‘Æ°á»£c show trong danh sÃ¡ch: má»™t trong sá»‘ Ä‘Ã³ liÃªn quan Ä‘áº¿n rÃ² rá»‰ do (string) á»Ÿ phÃ­a trÃªn, tiáº¿p theo lÃ  liÃªn quan Ä‘áº¿n viá»‡c khá»Ÿi táº¡o DOM vÃ  cÃ¡i cuá»‘i cÃ¹ng lÃ  khá»Ÿi táº¡o Text. Chon má»™t trong nhá»¯ng hÃ m khá»Ÿi táº¡o cá»§a HTMLDivElement trong danh sÃ¡ch vÃ  chá»n Allocation stack. Tá»« áº£nh trÃªn ta tháº¥y Ä‘Æ°á»£c lÃ  pháº§n tá»­ Ä‘Æ°á»£c khá»Ÿi táº¡o bá»Ÿi grow -> createSomeNodes. Náº¿u ta Ä‘á»ƒ Ã½ ká»¹ má»—i váº¡ch trÃªn biá»ƒu Ä‘á»“, ta sáº½ tháº¥y lÃ  hÃ m khá»Ÿi táº¡o HTMLDivElement Ä‘Æ°á»£c gá»i nhiá»u láº§n. Náº¿u ta quay trá»Ÿ láº¡i vá»›i snapshot comparision view, ta sáº½ tháº¥y lÃ  nÃ³ chá»‰ khá»Ÿi táº¡o object mÃ  khÃ´ng xÃ³a chÃºng Ä‘i. NÃ³i cÃ¡ch khÃ¡c lÃ  nÃ³ luÃ´n khá»Ÿi táº¡o object mÃ  khÃ´ng cho phÃ©p GC thu tháº­p má»™t vÃ i trong sá»‘ chÃºng. Giá» khi ta Ä‘Ã£ biáº¿t objects bá»‹ rÃ² rá»‰ á»Ÿ Ä‘Ã¢u (createSomeNodes), ta cÃ³ thá»ƒ quay trá»Ÿ láº¡i code Ä‘á»ƒ sá»­a láº¡i nÃ³. CÃ¡c tÃ­nh nÄƒng há»¯u Ã­ch khÃ¡cThay vÃ¬ sá»­ dá»¥ng Summary view, ta cÃ³ thá»ƒ sá»­ dá»¥ng Allocation view: Giao diá»‡n nÃ y cho ta tháº¥y má»™t danh sÃ¡ch cÃ¡c hÃ m vÃ  bá»™ nhá»› khá»Ÿi táº¡o liÃªn quan Ä‘áº¿n chÃºng. Ta cÃ³ thá»ƒ tháº¥y ngay lÃ  grow vÃ  createSomeNodes lÃ  ná»•i báº­t hÆ¡n cáº£. Khi chá»n grow ta sáº½ tháº¥y Ä‘á»‘i tÆ°á»£ng khá»Ÿi táº¡o liÃªn quan Ä‘Æ°á»£c gá»i Ä‘áº¿n. Ta cÃ³ thá»ƒ Ä‘á»ƒ Ã½ tháº¥y (string) HTMLDivElement vÃ  Text lÃ  nhá»¯ng hÃ m khá»Ÿi táº¡o cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng bá»‹ rÃ² rá»‰. Note: Ä‘á»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c tÃ­nh nÄƒng nÃ y, vÃ o Dev Tools -> Settings vÃ  enable record heap allocation stack traces trÆ°á»›c khi record.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"LÃ m tháº¿ nÃ o Ä‘á»ƒ thÃ nh tháº¡o CSS Grid trong nhÃ¡y máº¯t","slug":"Lam-the-nao-de-thanh-thao-CSS-Grid-trong-nhay-mat","date":"2018-07-10T01:10:00.000Z","updated":"2018-07-10T02:08:58.475Z","comments":true,"path":"2018/07/Lam-the-nao-de-thanh-thao-CSS-Grid-trong-nhay-mat.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Lam-the-nao-de-thanh-thao-CSS-Grid-trong-nhay-mat.html","excerpt":"Giá»›i thiá»‡uÄÃ¢y KHÃ”NG pháº£i lÃ  má»™t bÃ i viáº¿t Ä‘á»ƒ há»c â€œmá»i thá»©â€ vá» css grid.BÃ i viáº¿t nÃ y hÆ°á»›ng Ä‘áº¿n nhá»¯ng ngÆ°á»i muá»‘n cÃ³ káº¿t quáº£ nhanh chÃ³ng vÃ  hiá»‡u quáº£.Trong bá»‘n pháº§n cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ chá»‰ cho báº¡n 20% cáº§n thiáº¿t Ä‘á»ƒ lÃ m Ä‘Æ°á»£c 80% nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ lÃ m vá»›i CSS Grid layout. HÃ£y cÃ¹ng tÃ¬m hiá»ƒu!","text":"Giá»›i thiá»‡uÄÃ¢y KHÃ”NG pháº£i lÃ  má»™t bÃ i viáº¿t Ä‘á»ƒ há»c â€œmá»i thá»©â€ vá» css grid.BÃ i viáº¿t nÃ y hÆ°á»›ng Ä‘áº¿n nhá»¯ng ngÆ°á»i muá»‘n cÃ³ káº¿t quáº£ nhanh chÃ³ng vÃ  hiá»‡u quáº£.Trong bá»‘n pháº§n cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ chá»‰ cho báº¡n 20% cáº§n thiáº¿t Ä‘á»ƒ lÃ m Ä‘Æ°á»£c 80% nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ lÃ m vá»›i CSS Grid layout. HÃ£y cÃ¹ng tÃ¬m hiá»ƒu! Táº¡i sao chá»‰ 20%? Báº¥t cá»© khi nÃ o, má»™t láº­p trÃ¬nh viÃªn tÃ¬m kiáº¿m sá»± hiá»‡u quáº£ - sá»± lÆ°á»i biáº¿ng sáº½ giÃºp anh ta. CSS Grid layout ráº¥t phá»©c táº¡p. Theo Ã½ kiáº¿n cá»§a tÃ´i, nÃ³ phá»©c táº¡p hÆ¡n Flexbox. (tÃ´i Ä‘Ã£ máº¥t vÃ i tuáº§n Ä‘á»ƒ tÃ¬m hiá»ƒu flexbox) KhÃ´ng háº³n bá»Ÿi vÃ¬ nÃ³ â€œkhÃ³â€ mÃ  do CSS Grid cÃ³ tá»›i 18 thuá»™c tÃ­nh má»›i cá»™ng vá»›i nhá»¯ng khÃ¡i niá»‡m mÃ  báº¡n chÆ°a bao giá» nghe tá»›i trÆ°á»›c Ä‘Ã³. Váº­y, báº¡n cáº§n biáº¿t táº¥t cáº£ nhá»¯ng thuá»™c tÃ­nh má»›i nÃ y ngay bÃ¢y giá»? Ngay láº­p tá»©c? KhÃ´ng, báº¡n khÃ´ng cáº§n! Báº¡n chá»‰ cáº§n há»c má»™t vÃ i thuá»™c tÃ­nh cáº§n thiáº¿t ngay lÃºc nÃ y Ä‘á»ƒ táº¡o ra káº¿t quáº£ mong muá»‘n. Nhá»¯ng thuá»™c tÃ­nh khÃ¡c cÃ³ thá»ƒ há»c sau. ÄÃ³ lÃ  Ä‘á»‹nh nghÄ©a vá» â€œhiá»‡u quáº£â€ cá»§a tÃ´i. 1. CSS Grid layout lÃ  gÃ¬ ?Náº¿u báº¡n má»›i há»c bá»‘ cá»¥c trong CSS, CSS Grid cÃ³ thá»ƒ khÃ¡ xa láº¡ vá»›i báº¡n. Báº¡n Ä‘Ã£ nghe nÃ³i tá»›i Flexbox chÆ°a? TÃ´i thÃ­ch coi CSS Grid nhÆ° lÃ  má»™t ngÆ°á»i anh (hoáº·c cha) cá»§a Flexbox. Xá»­ lÃ½ cÃ¡c bá»‘ cá»¥c trong CSS Ä‘Æ°á»£c coi lÃ  má»™t cÃ´ng viá»‡c khÃ³ khÄƒn vÃ  khÃ´ng háº¥p dáº«n. Flexbox Ä‘Ã£ lÃ m cho má»i thá»© dá»… dÃ ng hÆ¡n - nhÆ°ng CSS Grid tháº­m chÃ­ cÃ²n tá»‘t hÆ¡n. CÃ¡i chÃºng ta sáº½ xÃ¢y dá»±ng.ChÃºng ta sáº½ há»c cÃ¡ch Ã¡p dá»¥ng 20% kiáº¿n thá»©c há»c Ä‘Æ°á»£c Ä‘á»ƒ xÃ¢y dá»±ng bá»‘ cá»¥c responsive cá»§a má»™t á»©ng dá»¥ng Ã¢m nháº¡c Pháº§n 1: 10% báº¡n cáº§n biáº¿t - CÃ¡c thuáº­t ngá»¯ cÆ¡ báº£nChÃºng ta hÃ£y nhÃ¬n vÃ o nhá»¯ng Ä‘iá»u Ä‘áº§u tiÃªn báº¡n báº¯t buá»™c pháº£i biáº¿t. Grid Container lÃ  gÃ¬?Má»—i bá»‘ cá»¥c cÃ¡c trang web hoáº·c á»©ng dá»¥ng báº¡n táº¡o ra (hoáº·c tháº¥y) vá» báº£n cháº¥t lÃ  nhá»¯ng chiáº¿c há»™p Ä‘Æ°á»£c Ä‘áº·t trong nhá»¯ng Ä‘Æ°á»ng ranh giá»›i xÃ¡c Ä‘á»‹nh. Hiá»ƒu Ä‘Æ¡n giáº£n, grid chá»‰ lÃ  â€œnhá»¯ng Ä‘Æ°á»ng káº»â€. Nhá»¯ng Ä‘Æ°á»ng káº» ngang vÃ  dá»c xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c thiáº¿t káº¿ khÃ¡c nhau. Báº¡n sáº½ quen vá»›i grid náº¿u báº¡n Ä‘Ã£ sá»­ dá»¥ng cÃ¡c pháº§n má»m thiáº¿t káº¿ nhÆ° photoshop hoáº·c sketch. Trong bá»‘i cáº£nh cá»§a CSS Grid layout, má»™t Grid container lÃ  pháº§n tá»­ cha chá»©a táº¥t cáº£ cÃ¡c pháº§n tá»­ náº±m trong grid. Grid container xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ ban Ä‘áº§u cá»§a cÃ¡c Ä‘Æ°á»ng káº» trong grid, cáº£ dá»c vÃ  ngang. Grid Line lÃ  gÃ¬?Giáº£ sá»­ báº¡n cÃ³ má»™t bá»‘ cá»¥c nhÆ° tháº¿ nÃ y: Bá»‘ cá»¥c bao gá»“m má»™t grid container vá»›i cÃ¡c pháº§n tá»­ á»Ÿ bÃªn trong Grid lines chÃ­nh lÃ  nhá»¯ng Ä‘Æ°á»ng káº» ngang vÃ  dá»c phÃ¢n chia grid thÃ nh cÃ¡c Ã´. Grid Cell lÃ  gÃ¬?Grid cell lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t trong grid layout. Báº¥t ká»³ khoáº£ng trá»‘ng nÃ o Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi 4 Ä‘Æ°á»ng grid line. Grid AreaMá»™t grid area cÃ³ thá»ƒ giá»‘ng nhÆ° má»™t grid cell (giá»‘ng nhÆ° á»Ÿ pháº§n trÆ°á»›c). Hoáº·c cÅ©ng cÃ³ thá»ƒ tráº£i rá»™ng trÃªn nhiá»ƒu hoáº·c táº¥t cáº£ grid cell trong grid. Trong hÃ¬nh váº½ dÆ°á»›i Ä‘Ã¢y, grid area tráº£i rá»™ng trÃªn 4 Ã´. Grid Track lÃ  gÃ¬?Má»™t grid track cÃ³ thá»ƒ xem nhÆ° má»™t tÃªn gá»i khÃ¡c cho cÃ¡c cá»™t vÃ  cÃ¡c dÃ²ng. NÃ³ lÃ  khoáº£ng trá»‘ng giá»¯a 2 grid line báº¥t ká»³. HÃ¬nh dÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ vá» grid tracks VÃ¬ váº­y, chÃºng tÃ´i Ä‘Ã£ phÃ¢n loáº¡i Ä‘Æ°á»£c táº¥t cáº£ trong pháº§n Ä‘áº§u tiÃªn. Pháº§n 2: 10% cÃ²n láº¡i mÃ  báº¡n cáº§n biáº¿t vá» CSS grid.BÃ¢y giá» báº¡n Ä‘Ã£ hiá»ƒu cÃ¡c thuáº­t ngá»¯ cÆ¡ báº£n, giá»‘ng nhÆ° má»™t Ä‘á»©a tráº» máº¡o hiá»ƒm, hÃ£y báº¯t Ä‘áº§u! LÃ m tháº¿ nÃ o Ä‘á»ƒ Ä‘á»‹nh nghÄ©a má»™t Grid?Giá»‘ng nhÆ° Flexbox, má»i thá»© báº¯t Ä‘áº§u vá»›i display: grid hoáº·c display: inline-grid cho phiÃªn báº£n inline. VÃ­ dá»¥, Ä‘á»ƒ biáº¿n má»™t div thÃ nh má»™t grid container: 123div &#123; display: grid;&#125; LÃ m tháº¿ nÃ o Ä‘á»ƒ táº¡o cÃ¡c cá»™t vÃ  dÃ²ng?Äá»ƒ táº¡o cÃ¡c cá»™t vÃ  cÃ¡c dÃ²ng trong má»™t grid container, chÃºng ta sáº½ sá»­ dá»¥ng 2 thuá»™c tÃ­nh má»›i: grid-template-columns vÃ  grid-template-rows. Váº­y sá»­ dá»¥ng chÃºng nhÆ° tháº¿ nÃ o? KhÃ¡ Ä‘Æ¡n giáº£n. grid-template-columns Ä‘á»‹nh nghÄ©a vá»‹ trÃ­ cá»§a cÃ¡c cá»™t. grid-template-rows Ä‘á»‹nh nghÄ©a vá»‹ trÃ­ cá»§a cÃ¡c dÃ²ng. Báº¡n truyá»n giÃ¡ trá»‹ vÃ o cÃ¡c thuá»™c tÃ­nh nÃ y, vÃ  chÃºng táº¡o ra cÃ¡c dÃ²ng vÃ  cÃ¡c cá»™t. Xem vÃ­ dá»¥: 1grid-template-columns: 100px 200px 300px Äoáº¡n code nÃ y sáº½ táº¡o thÃ nh 3 cá»™t má»›i trong grid container. Cá»™t Ä‘áº§u tiÃªn cÃ³ Ä‘á»™ rá»™ng 100px, cá»™t tiáº¿p theo 200px vÃ  cá»™t cuá»‘i 300px. 1grid-template-rows: 100px 200px 300px Äoáº¡n code nÃ y sáº½ táº¡o 3 dÃ²ng má»›i trong grid container nhÆ° hÃ¬nh dÆ°á»›i Ä‘Ã¢y: BÃ¢y giá» Ä‘áº·t chÃºng cÃ¹ng nhau, báº¡n sáº½ cÃ³ má»™t grid hoÃ n chá»‰nh vá»›i cÃ¡c dÃ²ng vÃ  cá»™t Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a. 12grid-template-columns: 100px 200px 300pxgrid-template-rows: 100px 200px 300px Pháº§n 3: Báº¯t tay vÃ o Code - CSS GridBÃ¢y giá» chÃºng ta hÃ£y thá»±c hiá»‡n cÃ¡c bÆ°á»›c Ä‘á»ƒ xÃ¢y dá»±ng báº£n sao cá»§a á»©ng dá»¥ng Ã¢m nháº¡c ná»•i tiáº¿ng, nháº¡c catty Äá»ƒ phÃ¡t triá»ƒn nhanh chÃ³ng, tÃ´i sáº½ sá»­ dá»¥ng Codepen. Táº¡o má»™t dá»± Ã¡n má»›i vÃ  hÃ£y báº¯t Ä‘áº§u. LÃ m tháº¿ nÃ o Ä‘á»ƒ táº¡o ra bá»™ khung cho á»©ng dá»¥ng Catty MusicSau khi Ä‘Ã£ táº¡o má»™t project trÃªn codepen. ChÃºng ta sáº½ táº¡o má»™t tÃ i liá»‡u html cÆ¡ báº£n: 12345&lt;body&gt; &lt;aside&gt;&lt;/aside&gt; &lt;main&gt;&lt;/main&gt; &lt;footer&gt;&lt;/footer&gt;&lt;/body&gt; CÃ³ má»¥c Ä‘Ã­ch khi chá»n cáº¥u trÃºc nÃ y. Báº¡n sáº½ sá»›m nháº­n ra Ä‘iá»u Ä‘Ã³. BÃ¢y giá» style tÃ i liá»‡u. 1234body &#123; display: grid; min-height: 100%&#125; Äoáº¡n code nÃ y sáº½ biáº¿n body thÃ nh má»™t grid-container. BÃ¢y giá» chÃºng ta cáº§n táº¡o cáº¥u trÃºc cÃ¡c dÃ²ng vÃ  cá»™t trong grid. LÃ m tháº¿ nÃ o Ä‘á»ƒ táº¡o ra cÃ¡c dÃ²ng vÃ  cÃ¡c cá»™t cho á»©ng dá»¥ng Catty MusicTáº¡o cÃ¡c dÃ²ng vÃ  cá»™t lÃ  khÃ¡ dá»… dÃ ng. Káº¿t quáº£ cuá»‘i cÃ¹ng chÃºng cáº§n Ä‘áº¡t Ä‘Æ°á»£c lÃ : Tuy nhiÃªn, ban Ä‘áº§u khi thiáº¿t láº­p grid chÃºng ta cáº§n 2 dÃ²ng vÃ  2 cá»™t. ÄÃ¢y lÃ  má»™t vÃ i thá»© cáº§n chÃº Ã½ vá» thiáº¿t láº­p GridColumns: Cá»™t Ä‘áº§u tiÃªn pháº£i cÃ³ Ä‘á»™ rá»™ng cá»‘ Ä‘á»‹nh lÃ  50px. Cá»™t thá»© 2 pháº£i chiáº¿m toÃ n bá»™ Ä‘á»™ rá»™ng cÃ²n láº¡i cá»§a dÃ²ng. Rows: DÃ²ng thá»© 2 pháº£i cÃ³ chiá»u cao cá»‘ Ä‘á»‹nh lÃ  100px. DÃ²ng Ä‘áº§u tiÃªn pháº£i chiáº¿m toÃ n bá»™ chiá»u cÃ²n láº¡i cá»§a grid. Giáº£i phÃ¡p cá»§a má»™t ngÆ°á»i Ã­t kinh nghiá»‡m.Náº¿u báº¡n KHÃ”NG cÃ³ kinh nghiá»‡m vá»›i CSS, báº¡n cÃ³ thá»ƒ viáº¿t nhÆ° tháº¿ nÃ y: 12345body &#123; ... grid-template-rows: 100% 100px; grid-template-columns: 50px 100%;&#125; Váº¥n Ä‘á» vá»›i giáº£i phÃ¡p nÃ y lÃ  báº¡n Ä‘Ã£ vÃ´ tÃ¬nh táº¡o ra má»™t grid vá»›i chiá»u rá»™ng lÃ  100% + 50px vÃ  chiá»u cao lÃ  100% + 100px. CÃ¡i chÃºng ta muá»‘n lÃ  chiá»u rá»™ng vÃ  chiá»u cao lÃ  100%. VÃ¬ tháº¿ hÆ°á»›ng tiáº¿p cáº§n nÃ y lÃ  sai. Giáº£i phÃ¡p cá»§a ngÆ°á»i Ä‘Ã£ cÃ³ kinh nghiá»‡mNáº¿u Ä‘Ã£ cÃ³ má»™t vÃ i kinh nghiá»‡m vá»›i CSS, báº¡n cÃ³ thá»ƒ lÃ m má»™t vÃ i thá»© thÃ´ng minh hÆ¡n nhÆ° tháº¿ nÃ y: 12345body &#123; ... grid-template-rows: calc(100% - 100px) 100px; grid-template-columns: 50px calc(100%-50px)&#125; CÃ¡ch nÃ y khÃ¡ thÃ´ng minh. NhÆ°ng cÃ³ má»™t váº¥n Ä‘á» - nÃ³ ráº¥t khÃ³ Ä‘á»ƒ báº£o dÆ°á»¡ng. VÃ­ dá»¥, náº¿u vÃ¬ má»™t lÃ½ do nÃ o Ä‘Ã³ báº¡n pháº£i thay Ä‘á»•i Ä‘á»™ rá»™ng cá»‘ Ä‘á»‹nh, báº¡n cÅ©ng pháº£i thay Ä‘á»•i Ä‘á»‹nh nghÄ©a calc. Giáº£i phÃ¡p hiá»‡u quáº£ nháº¥tMay máº¯n lÃ  CSS Grid cÃ³ má»™t Ä‘Æ¡n vá»‹ má»›i giÃºp chÃºng ta giáº£i quyáº¿t váº¥n Ä‘á» á»Ÿ trÃªn má»™t cÃ¡ch dá»… dÃ ng Ä‘Ã³ lÃ  Ä‘Æ¡n vá»‹. factional(fr) ÄÆ¡n vá»‹ fractional giáº£i quyáº¿t váº¥n Ä‘á» tá»± Ä‘á»™ng phÃ¢n bá»‘ khoáº£ng trá»‘ng. Náº¿u báº¡n cÃ³ grid vá»›i 3 cá»™t nhÆ° á»Ÿ dÆ°á»›i, Ä‘Æ¡n vá»‹ fractional sáº½ tá»± Ä‘á»™ng phÃ¢n bá»• cÃ¡c khoáº£ng trá»‘ng báº±ng nhau. INáº¿u vÃ¬ má»™t vÃ i lÃ½ do báº¡n thÃªm nhiá»u pháº§n tá»­ hÆ¡n - Ä‘á»«ng lo láº¯ng. ÄÆ¡n vá»‹ fr sáº½ phÃ¢n bá»• láº¡i cÃ¡c khoáº£ng trá»‘ng báº±ng nhau. Cuá»‘i cÃ¹ng, náº¿u báº¡n Ä‘Ã£ cÃ³ má»™t pháº§n tá»­ vá»›i Ä‘á»™ rá»™ng cá»‘ Ä‘á»‹nh, báº¡n cÃ³ thá»ƒ láº¥y toÃ n bá»™ khoáº£ng trá»‘ng cÃ²n láº¡i vá»›i Ä‘Æ¡n vá»‹ fr. NhÆ° tháº¿ nÃ y: 12345body &#123; ... grid-template-rows: 1fr 100px; grid-template-columns: 50px 1fr;&#125; And that is it â€” done! Äáº·t tÃªn vÃ  xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ bá»Ÿi Grid AreasChÃºng ta Ä‘Ã£ táº¡o ra há»‡ thá»‘ng grid. BÃ¢y giá» lÃ  lÃºc Ä‘á»ƒ sá»­ dá»¥ng nÃ³. Má»¥c Ä‘Ã­ch cá»§a pháº§n nÃ y há»c cÃ¡ch xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cÃ¡c pháº§n tá»­ trong grid sá»­ dá»¥ng grid areas. Nháº¯c láº¡i má»™t chÃºt, má»™t grid area lÃ  báº¥t ká»³ khoáº£ng trá»‘ng Ä‘Æ°á»£c bao bá»Ÿi 4 grid line. LÃ m tháº¿ nÃ o Ä‘á»ƒ sá»­ dá»¥ng grid areas?NÆ¡i há»£p lÃ½ Ä‘á»ƒ báº¯t Ä‘áº§u lÃ  Ä‘áº·t tÃªn grid areasHÃ£y Ä‘á»ƒ tÃ´i giáº£i thÃ­ch.Xem xÃ©t khá»‘i lá»‡nh dÆ°á»›i Ä‘Ã¢y: 123&lt;div class=\"aside\"&gt;&lt;/div&gt;&lt;div class=\"main\"&gt;&lt;/div&gt;&lt;div class=\"footer\"&gt;&lt;/div&gt; 3 divs - Ä‘Æ¡n giáº£n. Báº±ng cÃ¡ch nÃ y, NÃ³ lÃ  ngá»¯ nghÄ©a tá»‘t hÆ¡n Ä‘á»ƒ sá»­ dá»¥ng tags aside main vÃ  footer. TÃ´i sáº½ giá»¯ má»i thá»© Ä‘Æ¡n giáº£n. BÃ¢y giá» hÃ£y xem Ä‘oáº¡n code nÃ y: 123456789.main &#123; grid-area: content;&#125;.footer &#123; grid-area: footer;&#125;.aside &#123; grid-area: sidebar;&#125; Chuyá»‡n gÃ¬ Ä‘ang xáº£y ra á»Ÿ Ä‘Ã¢yNáº¿u biáº¿t má»™t chÃºt vá» Javascript, hay báº¥t ká»³ ngÃ´n ngá»¯ láº­p trÃ¬nh nÃ o khÃ¡c, thÃ¬ khÃ¡i niá»‡m vá» biáº¿n sáº½ khÃ´ng pháº£i lÃ  má»›i vá»›i báº¡n. Trong Javascript, chÃºng ta cÃ³ thá»ƒ nÃ³i: 1var gridArea = \"content\" CÃ¡i chÃºng ta lÃ m á»Ÿ phÃ­a trÃªn lÃ , lÆ°u chuá»—i content vÃ o biáº¿n gridArea Khai bÃ¡o CSS á»Ÿ pháº§n trÆ°á»›c tÆ°Æ¡ng tá»± nhÆ° váº­y. Má»i pháº§n tá»­ trong grid cÃ³ thá»ƒ Ä‘Æ°á»£c gÃ¡n tá»›i má»™t vÃ¹ng trong grid container. Tuy nhiÃªn, trÆ°á»›c khi lÃ m Ä‘iá»u Ä‘Ã³, chÃºng ta báº¯t buá»™c pháº£i gÃ¡n má»—i pháº§n tá»­ trong grid vá»›i má»™t tÃªn gá»i. Giá»‘ng nhÆ° cÃ¡c biáº¿n trong Javascript. 123456789.main &#123; grid-area: content;&#125;.footer &#123; grid-area: footer;&#125;.aside &#123; grid-area: sidebar;&#125; Äoáº¡n code á»Ÿ trÃªn nÃ³i ráº±ng, class .main cÃ³ tÃªn lÃ  content. Class .footer cÃ³ tÃªn lÃ  footer. Cuá»‘i cÃ¹ng, class .aside cÃ³ tÃªn lÃ  sidebar BÃ¢y giá» cÃ¡c grid items Ä‘Æ°á»£c gÃ¡n tÃªn cho má»—i vÃ¹ng. Trong láº­p trÃ¬nh, cÃ¡c biáº¿n Ä‘Æ°á»£c thiáº¿t láº­p Ä‘á»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ nÆ¡i khÃ¡c. BÃ¢y giá», hÃ£y sá»­ dá»¥ng tÃªn grid area. Vá»‹ trÃ­ Grid areaMá»™t ngÆ°á»i Ä‘Ã n Ã´ng tráº» cÃ³ má»™t cÃ¡i bÃ¡nh nÆ°á»›ng. Anh ta cÃ³ 3 Ä‘á»©a con vÃ  pháº£i chia cho má»—i Ä‘á»©a má»™t pháº§n. Ai lÃ  ngÆ°á»i chia bÃ¡nh thÃ¬ há»£p lÃ½ nháº¥t? ChÃ­nh ngÆ°á»i Ä‘Ã n Ã´ng Ä‘Ã³! NgÆ°á»i Ä‘Ã n Ã´ng tráº» cáº¯t bÃ¡nh vÃ  chia cho má»—i Ä‘á»©a tráº» má»™t pháº§n. ÄÃ¢y lÃ  lÃ½ do tÃ´i ká»ƒ cÃ¢u chuyá»‡n nÃ y. Giá»‘ng nhÆ° chiáº¿c bÃ¡nh, toÃ n bá»™ khoáº£ng trá»‘ng trong grid lÃ  cá»§a ai? ChÃ­nh lÃ  grid container! Giá»‘ng nhÆ° ngÆ°á»i Ä‘Ã n Ã´ng tráº», grid container cÃ³ 3 Ä‘á»©a con .aside .main vÃ  .footer. BÃ¢y giá» grid container pháº£i chá»n cÃ¡ch chia toÃ n bá»™ khoáº£ng trá»‘ng trong grid cho 3 Ä‘á»©a con nÃ y. VÃ  má»™t Ä‘iá»u ná»¯a. VÃ¬ táº¥t cáº£ nhá»¯ng Ä‘á»©a tráº» Ä‘á»u cÃ³ tÃªn, ngÆ°á»i Ä‘Ã n Ã´ng tráº» cÃ³ thá»ƒ nÃ³i: â€œhey Brian Ä‘Ã¢y lÃ  pháº§n cá»§a con hoáº·c hey Emma cá»§a con lÃ  pháº§n nÃ y.â€ Dá»… dÃ ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh ai sá»Ÿ há»¯u pháº§n nÃ o cá»§a chiáº¿c bÃ¡nh, báº±ng cÃ¡ch gÃ¡n má»—i pháº§n vá»›i tÃªn cá»§a má»—i ngÆ°á»i. Má»—i pháº§n tá»­ trong grid Ä‘á»u Ä‘Ã£ cÃ³ tÃªn báº±ng cÃ¡ch sá»­ dá»¥ng thuá»™c tÃ­nh grid-area. BÃ¢y giá», hÃ£y chia bÃ¡nh! Thuá»™c tÃ­nh grid-template-areasBÃ¢y giá» grid container pháº£i chia â€œbÃ¡nhâ€. GÃ¡n má»—i vÃ¹ng tá»›i má»—i pháº§n tá»­ tÆ°Æ¡ng á»©ng. CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³, nhÆ°ng thuá»™c tÃ­nh grid-template-areas lÃ  cÃ¡ch dá»… dÃ ng nháº¥t Ä‘á»ƒ lÃ m Ä‘Ã³. nÃ³ chÃ­nh lÃ  cÃ¡i báº¡n cáº§n biáº¿t Ä‘á»ƒ lÃ m viá»‡c hiá»‡u quáº£. Thuá»™c tÃ­nh grid-template-areas lÃ m viá»‡c nhÆ° tháº¿ nÃ o?HÃ£y xem Ä‘oáº¡n code dÆ°á»›i Ä‘Ã¢y: 1234body &#123; grid-template-areas: \"sidebar content\" \"footer footer\"; &#125; CÃ¡i quÃ¡i gÃ¬ váº­y? KhÃ´ng cáº§n pháº£i bá»‹ choÃ¡ng ngá»£p. Trong pháº§n nÃ y, tÃ´i sáº½ giáº£i thÃ­ch nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o - theo thuáº­t ngá»¯ rÃµ rÃ ng. Thuá»™c tÃ­nh grid-template-areas cung cáº¥p má»™t cáº¥u trÃºc ráº¥t trá»±c quan cá»§a grid. HÃ£y xem láº¡i Ä‘oáº¡n code trÃªn má»™t láº§n ná»¯a: 1234body &#123; grid-template-areas: \"sidebar content\" \"footer footer\"; &#125; Báº¡n cÃ³ thá»ƒ tháº¥y toÃ n bá»™ giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh lÃ  tÃªn cá»§a cÃ¡c pháº§n tá»­ trong grid! sidebar content vÃ  footer lÃ  tÃªn cá»§a cÃ¡c pháº§n tá»­ trong grid. Khai bÃ¡o á»Ÿ trÃªn gÃ¡n má»—i vÃ¹ng trong grid vá»›i má»™t pháº§n tá»­ tÆ°Æ¡ng á»©ng. HÃ¬nh áº£nh trÃªn sáº½ giÃºp báº¡n hiá»ƒu grid Ä‘Æ°á»£c chia nhÆ° tháº¿ nÃ o. footer sáº½ chiáº¿m toÃ n bá»™ dÃ²ng bÃªn dÆ°á»›i. sidebar vÃ  content sáº½ chiáº¿m cá»™t Ä‘áº§u tiÃªn vÃ  thá»© 2 cá»§a dÃ²ng bÃªn bÃªn. Äáº¿n Ä‘Ã¢y chÃºng ta cÃ³: 1234567body &#123; display: grid; grid-template-columns: 40px 1fr; grid-template-rows: 1fr 90px; grid-template-areas: \"sidebar content\" \"footer footer\"; &#125; Káº¿t quáº£ sáº½ nhÆ° dÆ°á»›i Ä‘Ã¢y: TÃ´i Ä‘Ã£ thÃªm mÃ u sáº¯c Ä‘á»ƒ há»— trá»£ hÃ¬nh áº£nh. Pháº§n mÃ u Ä‘á» Ä‘áº¡i diá»‡n cho .footer, hai pháº§n cÃ²n láº¡i, pháº§n .main vÃ  .sidebar. LÃ m cho bá»‘ cá»¥c responsive - Äá»‹nh nghÄ©a láº¡i Grid areas vá»›i Media Queries CÃ¡c Grid area mÃ  báº¡n Ä‘Ã£ táº¡o trong grid container cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y theo kÃ­ch thÆ°á»›c mÃ n hÃ¬nh cá»§a ngÆ°á»i sá»­ dá»¥ng. DÆ°á»›i Ä‘Ã¢y lÃ  hÃ¬nh áº£nh á»©ng dá»¥ng trÃªn mÃ n hÃ¬nh Ä‘iá»‡n thoáº¡i. ChÃºng ta sáº½ refactor láº¡i code theo hÆ°á»›ng tiáº¿p cáº­n mobile first. Mobile first Ä‘Æ¡n giáº£n lÃ  lÃ m cho style máº·c Ä‘á»‹nh cá»§a báº¡n lÃ  dÃ nh cho cÃ¡c thiáº¿t di Ä‘á»™ng. Sau Ä‘Ã³ báº¡n sáº½ táº¡o ra cÃ¡c thay Ä‘á»•i cho cÃ¡c mÃ n hÃ¬nh lá»›n hÆ¡n thÃ´ng qua cÃ¡c media query. Äáº·t má»™t pháº§n code hiá»‡n nay trong má»™t Ä‘á»‹nh nghÄ©a media query. NhÆ° dÆ°á»›i Ä‘Ã¢y: 1234567@media only screen and (min-width: 600px) &#123; body &#123; grid-template-columns: 50px 1fr; grid-template-areas: \"sidebar content\" \"footer footer\"; &#125;&#125; Báº¡n sáº½ Ä‘á»ƒ Ä‘oáº¡n code máº·c Ä‘á»‹nh bÃªn ngoÃ i media query 1234body &#123; display: grid; grid-template-rows: 1fr 100px;&#125; Táº¡i sao chÃºng ta Ä‘áº·t grid-template-rows: 1fr 100px; bÃªn ngoÃ i media query? Bá»Ÿi vÃ¬ cáº£ mÃ n hÃ¬nh di Ä‘á»™ng vÃ  desktop chÃºng ta Ä‘á»u cÃ³ 2 dÃ²ng. Tuy nhiÃªn, trÃªn mÃ n hÃ¬nh desktop. Sidebar lÃ  50px trong Ä‘á»‹nh nghÄ©a grid-template-columns. CÃ²n trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng sidebar khÃ´ng tá»“n táº¡i. VÃ¬ tháº¿, chÃºng ta sáº½ Ä‘á»‹nh nghÄ©a láº¡i khai bÃ¡o grid-template-columns cho di Ä‘á»™ng. BÃ¢y giá» vá»›i cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng chÃºng ta sáº½ sá»­ dá»¥ng style nÃ y lÃ  máº·c Ä‘á»‹nh: 123body &#123; grid-template-areas: \"content\" \"footer\" KhÃ¡ Ä‘Æ¡n giáº£n pháº£i khÃ´ng? HÃ£y Ä‘á»ƒ tÃ´i giáº£i thÃ­ch. DÃ²ng cháº£y (hÆ°á»›ng) cá»§a GridÄoáº¡n code cho di Ä‘á»™ng nhÆ° tháº¿ nÃ y: 123body &#123; grid-template-areas: \"content\" \"footer\" Bá»Ÿi máº·c Ä‘á»‹nh, má»™t grid sáº½ sáº¯p xáº¿p cÃ¡c pháº§n tá»­ trÃªn cÃ¡c dÃ²ng. VÃ¬ tháº¿ khai bÃ¡o á»Ÿ phÃ­a trÃªn sáº½ sáº¯p xáº¿p content trÃªn má»™t dÃ²ng vÃ  footer trÃªn má»™t dÃ²ng khÃ¡c. DÆ°á»›i Ä‘Ã¢y lÃ  káº¿t quáº£ - sidebar sáº½ áº©n trÃªn mÃ n hÃ¬nh di Ä‘á»™ng: Vá»›i rÃ o cáº£n ban Ä‘áº§u cá»§a sá»± hiá»ƒu biáº¿t cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a grids vÃ  thiáº¿t láº­p responsive grid, chÃºng ta Ä‘Ã£ xong bá»‘ cá»¥c á»©ng dá»¥ng! ThÃªm ná»™i dung vÃ o trong GridKhi káº¿t thÃºc pháº§n nÃ y chÃºng ta sáº½ cÃ³ má»™t bá»‘ cá»¥c á»©ng dá»¥ng Ã¢m nháº¡c hoÃ n chá»‰nh. BÃ¢y giá» hÃ£y táº­p trung vÃ  viá»‡c sáº¯p xáº¿p ná»™i dung trong grid. 1. The SidebarÄiá»u nÃ y cÃ³ váº» dá»… nháº¥t Ä‘á»ƒ báº¯t Ä‘áº§u. HÃ£y Ä‘i tÃ¬m nÃ³. Sidebar bao gá»“m 8 icon cÃ¡ch Ä‘á»u nhau dá»c theo toÃ n bá»™ chiá»u dÃ i cá»§a sidebar. HÃ£y chÃ¨n cÃ¡c icon vÃ o sidebar: 12345678910&lt;div class=\"aside\"&gt; &lt;i class=\"fa fa-bars\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-home\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-search\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-volume-up\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-user\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-spotify\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-cog\"&gt;&lt;/i&gt; &lt;i class=\"fa fa-soundcloud\"&gt;&lt;/i&gt;&lt;/div&gt; Káº¿t quáº£ sáº½ nhÆ° tháº¿ nÃ y: CÃ¡c icon cÅ©ng sáº½ áº©n trÃªn mÃ n hÃ¬nh di Ä‘á»™ng. VÃ  chá»‰ hiá»ƒn thá»‹ trÃªn cÃ¡c mÃ n hÃ¬nh lá»›n hÆ¡n. ÄÃ¢y lÃ  hÆ°á»›ng tiáº¿p cáº­n mobile first. 1234567.aside i &#123; display: none;&#125;@media only screen and (min-width:600px) &#123; .aside i &#123; display: block; &#125; CÃ¡c biá»ƒu tÆ°á»£ng Ä‘Æ°á»£c hiá»ƒn thá»‹, nhÆ°ng Ä‘Æ°á»£c cÄƒn chá»‰nh chÆ°a Ä‘á»u. Sáº¯p xáº¿p cÃ¡c iconCÃ¡c tháº» i lÃ  cÃ¡c pháº§n tá»­ inline â€“ Ä‘iá»u Ä‘Ã³ giáº£i thÃ­ch táº¡i sao 2 icon láº¡i hiá»ƒn thá»‹ cáº¡nh nhau trÃªn má»™t dÃ²ng. HÃ£y sáº¯p xáº¿p chÃºng. CÃ¡c pháº§n tá»­ con cá»§a grid container cÅ©ng cÃ³ thá»ƒ trá»Ÿ thÃ nh cÃ¡c grid container. Táº¡i sao khÃ´ng? BÆ°á»›c 1: Biáº¿n Sidebar thÃ nh má»™t Grid ContainerÄiá»u nÃ y sáº½ cung cÃ¡c tÃ­nh nÄƒng cÄƒn chá»‰nh cá»§a grid. Khi sidebar chá»‰ hiá»ƒn thá»‹ trÃªn cÃ¡c mÃ n hÃ¬nh lá»›n hÆ¡n, Ä‘á»«ng quÃªn Ä‘áº·t nÃ³ trong media query. 123456789@media only screen and (min-width:600px) &#123; .aside &#123; display: grid; &#125; .aside i &#123; border: 1px solid red; &#125;&#125; TÃ´i thÃªm border cho má»—i icon - Ä‘á»ƒ chÃºng ta dá»… phÃ¢n biá»‡t. Chuyá»‡n gÃ¬ Ä‘ang xáº£y ra á»Ÿ Ä‘Ã¢y? ChÃºng ta KHÃ”NG thiáº¿t láº­p báº¥t ká»³ dÃ²ng hay cá»™t trong sidebar. NhÆ°ng chÃºng ta tháº¥y cÃ¡c icon Ä‘Æ°á»£c sáº¯p xáº¿p khÃ¡ tá»‘t. Grid tá»± Ä‘á»™ng thiáº¿t láº­p Ä‘iá»u Ä‘Ã³. ÄÃ¢y lÃ  vá»‹ trÃ­ máº·c Ä‘á»‹nh cá»§a cÃ¡c item trong má»™t grid â€“ trÃªn cÃ¹ng má»™t dÃ²ng. Má»™t grid cÅ©ng cÃ³ thá»ƒ sáº¯p xáº¿p cÃ¡c pháº§n tá»­ sá»­ dá»¥ng justify-items hay align-items. justify-items sáº½ sáº¯p xáº¿p cÃ¡c pháº§n tá»­ theo chiá»u ngang. align-items sáº½ sáº¯p xáº¿p cÃ¡c pháº§n tá»­ theo chiá»u dá»c. Ãp dá»¥ng Ä‘iá»u nÃ y cho sidebar, vÃ  chÃºng ta cÃ³ má»™t bá»• cá»¥c cÃ¡c icon hoÃ n háº£o: 12345.aside &#123; ... justify-items: center; align-items: center; &#125; Báº¡n váº«n cáº£m tháº¥y khÃ³ hiá»ƒu, hÃ£y xem video dÆ°á»›i Ä‘Ã¢y: BÃ¢y giá» chÃºng ta Ä‘Ã£ má»™t bá»‘ cá»¥c hoÃ n háº£o dÃ nh cho cÃ¡c icon trong sidebar. justify-items hay align-items cÃ³ thá»ƒ cÃ³ cÃ¡c giÃ¡ trá»‹: stretch start end center Náº¿u Ä‘Ã£ tá»«ng lÃ m viá»‡c vá»›i Flexbox, báº¡n sáº½ quen vá»›i chÃºng. ChÃºng ta sáº½ thÃªm nhiá»u ná»™i dung hÆ¡n vÃ o thiáº¿t káº¿ hiá»‡n táº¡i. ThÃªm 2 tháº» div vÃ o main section: 1234&lt;div class=\"main\"&gt; &lt;div class=\"main__header\"&gt;&lt;/div&gt; &lt;div class=\"main__body\"&gt;&lt;/div&gt;&lt;/div&gt; NB: main__header sáº½ chá»©a music art vÃ  playbacks: main__bodysáº½ chá»©a chi tiáº¿t: Trong pháº§n nÃ y chÃºng ta sáº½ táº­p trung vÃ o main__header Äáº§u tiÃªn, thÃªm Ä‘oáº¡n code html nÃ y: 1234567891011121314151617&lt;div class=\"main__header\"&gt; &lt;div class=\"img\"&gt; &lt;img src=\"http://bit.ly/2sc2NJd\"/&gt; &lt;/div&gt; &lt;section class=\"details\"&gt; &lt;div&gt; &lt;p&gt;CattyBoard Top 100 Single Charts (11.06.36)&lt;/p&gt; &lt;p class=\"sm--hide\"&gt;Unknown Artist&lt;/p&gt; &lt;p class=\"sm--hide\"&gt;2016 . Charts . 100 songs&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &lt;i class=\"fa fa-play\"&gt; &amp;nbsp;Play all&lt;/i&gt; &lt;i class=\"fa fa-plus\"&gt; &amp;nbsp;Add to&lt;/i&gt; &lt;i class=\"fa fa-ellipsis-h\"&gt;&amp;nbsp;&amp;nbsp;More&lt;/i&gt; &lt;/div&gt; &lt;/section&gt;&lt;/div&gt; ChÃº Ã½ cáº¥u trÃºc cá»§a tÃ i liá»‡u main__header cÃ³ hai con trá»±c tiáº¿p. Má»™t div chá»©a má»™t hÃ¬nh áº£nh vÃ  section chá»©a thÃ´ng tin chi tiáº¿t cá»§a album. Káº¿t quáº£ cá»§a Ä‘oáº¡n code trÃªn khÃ¡ xáº¥u xÃ­: HÃ£y lÃ m cho nÃ³ Ä‘áº¹p hÆ¡n. CÃ¡i chÃºng ta cáº§n lÃ  má»™t grid vá»›i cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c sáº¯p xáº¿p phÃ¹ há»£p. HÃ£y sá»­ dá»¥ng nhá»¯ng kiáº¿n thá»©c vá» grid areas Äáº§u tiÃªn, Ä‘á»‹nh nghÄ©a grid area: 123456.main__header &gt; .img &#123; grid-area: img;&#125;.main__header &gt; .details &#123; grid-area: dtls;&#125; div chá»©a hÃ¬nh áº£nh Ä‘Æ°á»£c Ä‘áº·t tÃªn lÃ  img. Pháº§n chá»©a thÃ´ng tin chi tiáº¿t cá»§a album Ä‘Æ°á»£c Ä‘áº·t tÃªn lÃ  dtls. BÃ¢y giá», Ä‘á»‹nh nghÄ©a grid: 12345.main__header &#123; display: grid; grid-template-areas: \"img\" \"dtls\"; &#125; .main__header trá»Ÿ thÃ nh má»™t grid container, cÃ³ 2 pháº§n tá»­ xáº¿p chá»“ng lÃªn nhau Ä‘áº§u tiÃªn lÃ  img tiáº¿p theo lÃ  dtls. Bá»Ÿi vÃ¬ chÃºng ta Ä‘ang theo hÆ°á»›ng tiáº¿p cáº­n mobile first. Táº¡i thá»i Ä‘iá»ƒm nÃ y, khÃ´ng cÃ³ nhiá»u thay Ä‘á»•i. ÄÃ¢y khÃ´ng pháº£i lÃ  cÃ¡i chÃºng ta muá»‘n trÃªn di Ä‘á»™ng. Vá»›i mÃ n hÃ¬nh di Ä‘á»™ng, cÃ¡c pháº§n tá»­ nÃªn Ä‘Æ°á»£c cÄƒn giá»¯a. 12345@media screen and (max-width: 600px) &#123; .main__header &#123; justify-items: center; &#125; &#125; Káº¿t quáº£ sáº½ nhÆ° dÆ°á»›i Ä‘Ã¢y: Tiáº¿p theo hÃ£y lÃ m cho text trong .details cÄƒn giá»¯a: 12345@media screen and (max-width: 600px) &#123; .main__header &gt; .details &#123; text-align: center; &#125; &#125; ÄÃ£ khÃ¡ gáº§n vá»›i má»¥c tiÃªu chá»‰ cáº§n thÃªm má»™t vÃ i Ä‘iá»u chá»‰nh. Äoáº¡n text Unknown Artist vÃ  2016 . Charts . 100 songs nÃªn áº©n trÃªn di Ä‘á»™ng. áº¢nh cÅ©ng nÃªn nhá» hÆ¡n. 12345678@media screen and (max-width: 600px) &#123; .sm--hide &#123; display: none; &#125; .img &gt; img &#123; width: 150px &#125;&#125; Class .sm--hide sáº½ áº©n trÃªn di Ä‘á»™ng. Chá»‰ cáº§n thÃªm class tá»›i pháº§n tá»­ mong muá»‘n. NhÆ° tháº¿ nÃ y: 12&lt;p class=\"sm--hide\"&gt;Unknown Artist&lt;/p&gt;&lt;p class=\"sm--hide\"&gt;2016 . Charts . 100 songs&lt;/p&gt; VÃ  chÃºng ta cÃ³: MÃ n hÃ¬nh di Ä‘á»™ng Ä‘Ã£ xong. Giá» hÃ£y thÃªm style cho nhá»¯ng mÃ n hÃ¬nh lá»›n hÆ¡n. Vá»›i mÃ n hÃ¬nh lá»›n hÆ¡n, chÃºng ta cáº§n má»™t grid 2 cá»™t. Style sáº½ nhÆ° tháº¿ nÃ y: 123456@media only screen and (min-width:600px) &#123; .main__header &#123; grid-template-columns: 250px 1fr; grid-template-areas: \"img dtls\" &#125; &#125; Grid Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a láº¡i vá»›i 2 cá»™t. Má»™t cÃ³ Ä‘á»™ rá»™ng cá»‘ Ä‘á»‹nh lÃ  250px vÃ  cá»™t kia chiáº¿m toÃ n bá»™ khoáº£ng trá»‘ng cÃ²n láº¡i. Tiáº¿n trÃ¬nh hiá»‡n táº¡i cá»§a chÃºng ta here. Pháº§n 4: Káº¿t há»£p CSS Grid vá»›i FlexboxTrong pháº§n nÃ y báº¡n sáº½ há»c cÃ¡ch sá»­ dá»¥ng Flexbox vÃ  Grid cÃ¹ng nhau. Hai module nÃ y Ä‘Ã£ thay Ä‘á»•i cÃ¡ch xá»­ lÃ½ bá»‘ cá»¥c trong CSS. VÃ  cÃ¡ch hiá»‡u quáº£ nháº¥t lÃ  sá»­ dá»¥ng cáº£ 2 module cÃ¹ng nhau. HÃ£y Ä‘i vÃ o chi tiáº¿t. Vá»›i pháº§n hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t cá»§a album chÃºng ta sáº½ sá»­ dá»¥ng flexbox. LÃ m sao Ä‘á»ƒ biáº¿t chá»— nÃ o sáº½ sá»­ dá»¥ng Flexbox?Quy táº¯c chung lÃ  sá»­ dá»¥ng Grid cho bá»‘ cá»¥c toÃ n bá»™ trang, cÃ²n Flexbox dÃ nh cho UI bÃªn trong cÃ¡c pháº§n tá»­ con. Má»™t pháº§n tá»­ con cÃ³ thá»ƒ lÃ  má»™t flex container. Má»™t pháº§n tá»­ con cá»§a flex container cÅ©ng cÃ³ thá»ƒ lÃ  má»™t grid container. TÃ´i giáº£ sá»­ ráº±ng báº¡n Ä‘Ã£ biáº¿t vá» flexbox. NhÆ° thÆ°á»ng lá»‡, hÃ£y báº¯t Ä‘áº§u báº±ng html DÆ°á»›i Ä‘Ã¢y lÃ  má»™t div, vá»›i má»™t danh sÃ¡ch cÃ¡c bÃ i hÃ¡t. Danh sÃ¡ch cÃ¡c bÃ i hÃ¡t cÃ³ cÃ¡c Ä‘oáº¡n cÃ³ chá»©a tÃªn bÃ i hÃ¡t, nghá»‡ sÄ©, thá»i lÆ°á»£ng cá»§a bÃ i hÃ¡t vÃ  â€œcatty cloud syncâ€. 1234567891011121314151617181920212223242526&lt;div class=\"main__body\"&gt; &lt;div&gt; &lt;p&gt;1. One Dance&lt;/p&gt; &lt;p&gt;Crake feat CatKid &amp;amp; Cyla&lt;/p&gt; &lt;p&gt;2:54&lt;/p&gt; &lt;p&gt;&lt;span&gt;CATTY CLOUD SYNC&lt;/span&gt;&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &lt;p&gt;2. Panda&lt;/p&gt; &lt;p&gt;Cattee&lt;/p&gt; &lt;p&gt;4:06&lt;/p&gt; &lt;p&gt;&lt;span&gt;CATTY CLOUD SYNC&lt;/span&gt;&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &lt;p&gt;3. Can't Stop the Feeling!&lt;/p&gt; &lt;p&gt;Catin Cimberlake&lt;/p&gt; &lt;p&gt;3:56&lt;/p&gt; &lt;p&gt;&lt;span&gt;CATTY CLOUD SYNC&lt;/span&gt;&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &lt;p&gt;4. Work From Home&lt;/p&gt; &lt;p&gt;Cat Harmony feat Colla&lt;/p&gt; &lt;p&gt;3:34&lt;/p&gt; &lt;p&gt;&lt;span&gt;CATTY CLOUD SYNC&lt;/span&gt;&lt;/p&gt; &lt;/div&gt;&lt;/div&gt; ÄÃ¢y lÃ  cÃ¡i chÃºng ta cÃ³: main__body lÃ  má»™t pháº§n tá»­ cá»§a grid. ChÃºng ta cÃ³ thá»ƒ biáº¿n nÃ³ thÃ nh flex container náº¿u Ä‘iá»u Ä‘Ã³ há»¯u Ã­ch. Trong trÆ°á»ng há»£p cá»§a chÃºng ta, má»—i tháº» div lÃ  con trá»±c tiáº¿p cá»§a main__body cáº§n trá»Ÿ thÃ nh má»™t flex container. ChÃºng chá»©a tÃªn bÃ i hÃ¡t, nghá»‡ sÄ©, thá»i gian vÃ  â€œcatty cloud syncâ€. 123.main__body &gt; div &#123; display:flex;&#125; BÃ¢y giá» chia chiá»u rá»™ng cho cÃ¡c pháº§n tá»­ con: 123.main__body &gt; div p &#123; flex: 0 0 25%;&#125; Báº¡n sáº½ Ä‘á»“ng Ã½ vá»›i tÃ´i ráº±ng táº¡i thá»i Ä‘iá»ƒm nÃ y, cÃ¡c yáº¿u tá»‘ cáº§n thiáº¿t cho bá»‘ cá»¥c Ä‘Ã£ hoÃ n thÃ nh. Tuy nhiÃªn, tÃ´i Ä‘Ã£ thá»±c hiá»‡n má»™t vÃ i thay Ä‘á»•i. Báº¡n cÃ³ thá»ƒ xem káº¿t quáº£ cuá»‘i cÃ¹ng here Báº¡n sáº½ nháº­n tháº¥y ráº±ng tÃ´i váº«n Ä‘á»ƒ trá»‘ng footer. ÄÃ³ lÃ  bÃ i táº­p cho báº¡n. Lá»i khuyÃªn cá»§a tÃ´i lÃ  sá»­ dá»¥ng flexbox. NÃ³ sáº½ giÃºp báº¡n hiá»ƒu cÃ¡ch cáº£ hai module nÃ y lÃ m viá»‡c cÃ¹ng nhau. Vá»›i má»™t vÃ i thuá»™c tÃ­nh cá»§a grid, báº¡n Ä‘Ã£ xÃ¢y dá»±ng má»™t bá»‘ cá»¥c thá»±c sá»±. KhÃ¡ áº¥n tÆ°á»£ng. Báº¡n cÅ©ng há»c Ä‘Æ°á»£c ká»¹ nÄƒng vÃ´ giÃ¡ khi káº¿t há»£p CSS Grid vá»›i Flexbox.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"grid","slug":"grid","permalink":"http://nthung2112.github.io/tags/grid/"}]},{"title":"TÃ¬m hiá»ƒu vá» Proxy trong ES6","slug":"Tim-hieu-ve-Proxy-trong-ES6","date":"2018-07-08T08:57:00.000Z","updated":"2018-07-08T08:59:57.977Z","comments":true,"path":"2018/07/Tim-hieu-ve-Proxy-trong-ES6.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Tim-hieu-ve-Proxy-trong-ES6.html","excerpt":"NÃ³i vá» ES6 cÃ³ láº½ chÃºng ta Ä‘Ã£ quÃ¡ quen thuá»™c vá»›i cÃ¡c khÃ¡i niá»‡m nhÆ° const vÃ  let, hÃ m mÅ©i tÃªn, class hay nhá»¯ng tÃ­nh nÄƒng hay ho háº¥p dáº«n khÃ¡c. NgoÃ i ra, ES6 cÅ©ng kÃ¨m theo nhá»¯ng tÃ­nh nÄƒng Ã­t ngÆ°á»i biáº¿t hÆ¡n nhÆ°ng cÅ©ng ráº¥t thÃº vá»‹, vÃ  má»™t trong sá»‘ Ä‘Ã³ lÃ  Proxy.","text":"NÃ³i vá» ES6 cÃ³ láº½ chÃºng ta Ä‘Ã£ quÃ¡ quen thuá»™c vá»›i cÃ¡c khÃ¡i niá»‡m nhÆ° const vÃ  let, hÃ m mÅ©i tÃªn, class hay nhá»¯ng tÃ­nh nÄƒng hay ho háº¥p dáº«n khÃ¡c. NgoÃ i ra, ES6 cÅ©ng kÃ¨m theo nhá»¯ng tÃ­nh nÄƒng Ã­t ngÆ°á»i biáº¿t hÆ¡n nhÆ°ng cÅ©ng ráº¥t thÃº vá»‹, vÃ  má»™t trong sá»‘ Ä‘Ã³ lÃ  Proxy. Proxy lÃ  gÃ¬?Proxy lÃ  má»™t class Ä‘Æ°á»£c giá»›i thiá»‡u tá»« ES6, cho phÃ©p báº¡n can thiá»‡p vÃ  thay Ä‘á»•i hÃ nh vi cá»§a má»™t Ä‘á»‘i tÆ°á»£ng (object). CÃ¡c hÃ nh vi nÃ y bao gá»“m: truy xuáº¥t/thiáº¿t láº­p thuá»™c tÃ­nh cá»§a má»™t Ä‘á»‘i tÆ°á»£ng, thay Ä‘á»•i prototype, gá»i hÃ m, khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng báº±ng tá»« khÃ³a newâ€¦ Äá»ƒ hiá»ƒu rÃµ hÆ¡n vá» khÃ¡i niá»‡m, báº¡n cÃ³ thá»ƒ xem qua vÃ­ dá»¥ sau: 123456789101112131415161718const u = &#123; name: 'CÃ´ng Táº±ng TÃ´n Ná»¯ Táº¡ Thá»‹ TÃ²n Ten' &#125;// Thiáº¿t láº­p proxy cho Ä‘á»‘i tÆ°á»£ng `u`const p = new Proxy(u, &#123; // `get` lÃ  má»™t trap, sáº½ Ä‘Æ°á»£c gá»i khi truy xuáº¥t Ä‘áº¿n thuá»™c tÃ­nh // cá»§a Ä‘á»‘i tÆ°á»£ng get(target, prop, receiver) &#123; // Thay Ä‘á»•i hÃ nh vi khi truy xuáº¥t Ä‘áº¿n má»™t thuá»™c tÃ­nh: Náº¿u lÃ  // chuá»—i, chuyá»ƒn sang chá»¯ hoa if (typeof target[prop] === 'string') return target[prop].toUpperCase() return target[prop] &#125;&#125;)console.log(p.name) // CÃ”NG Táº°NG TÃ”N Ná»® Táº  THá»Š TÃ’N TENp.email = 'ta.thi@ton.ten'console.log(p.email) // TA.THI@TON.TEN ChÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng Proxy cho báº¥t cá»© object nÃ o trong JavaScript, ká»ƒ cáº£ máº£ng, hÃ m hay má»™t proxy khÃ¡c. CÃ³ thá»ƒ báº¡n thá»«a biáº¿tMá»™t hÃ m trong JavaScript lÃ  má»™t thá»ƒ hiá»‡n cá»§a lá»›p Function. Hiá»‡n táº¡i Proxy Ä‘Ã£ Ä‘Æ°á»£c há»— trá»£ bá»Ÿi cÃ¡c trÃ¬nh duyá»‡t xá»‹n (nghÄ©a lÃ  khÃ´ng cÃ³ IE Ä‘Ã³) vÃ  node.js v6 trá»Ÿ Ä‘i. Tin váº¯nPhiÃªn báº£n 5.0 cá»§a MobX Ä‘Ã£ hoÃ n toÃ n sá»­ dá»¥ng ES6 Proxy. Sá»­ dá»¥ng nhÆ° tháº¿ nÃ o?TrÆ°á»›c háº¿t, hÃ£y xem qua nhá»¯ng thuáº­t ngá»¯ thÃ´ng dá»¥ng khi lÃ m viá»‡c vá»›i Proxy: target: lÃ  Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng proxy vÃ o traps: lÃ  nhá»¯ng phÆ°Æ¡ng thá»©c giÃºp báº¡n thay Ä‘á»•i hÃ nh vi cá»§a Ä‘á»‘i tÆ°á»£ng handler: lÃ  má»™t object chá»©a cÃ¡c traps, Ä‘Æ°á»£c Ä‘Æ°a vÃ o hÃ m dá»±ng cá»§a lá»›p Proxy Äá»ƒ khá»Ÿi táº¡o proxy, báº¡n dÃ¹ng new Proxy(target, handler) nhÆ° bÃªn dÆ°á»›i: 1const p = new Proxy(target, handler) ChÃºng ta sáº½ cÃ¹ng Ä‘i qua nhá»¯ng traps thÃ´ng dá»¥ng. handler.get() vÃ  handler.set()NhÆ° tÃªn gá»i, handler.get() vÃ  handler.set() cho phÃ©p báº¡n can thiá»‡p khi truy xuáº¥t vÃ  thiáº¿t láº­p giÃ¡ trá»‹ má»™t thuá»™c tÃ­nh cá»§a Ä‘á»‘i tÆ°á»£ng. 12345678// property: tÃªn cá»§a thuá»™c tÃ­nh Ä‘Æ°á»£c truy xuáº¥t// receiver: Ä‘á»‘i tÆ°á»£ng sau khi Ä‘Ã£ Ä‘Æ°á»£c gáº¯n proxyhandler.get(target, property, receiver)// value: giÃ¡ trá»‹ sáº½ Ä‘Æ°á»£c thiáº¿t láº­p cho thuá»™c tÃ­nh// handler.set() pháº£i tráº£ vá» má»™t giÃ¡ trá»‹ boolean. Náº¿u lÃ  true thÃ¬ xem nhÆ° thiáº¿t láº­p// thÃ nh cÃ´ng, ngÆ°á»£c láº¡i náº¿u lÃ  false thÃ¬ xáº£y ra lá»—i TypeError.handler.set(target, property, value, receiver) ChÃºng ta cÃ³ thá»ƒ dÃ¹ng handler.set() Ä‘á»ƒ kiá»ƒm tra tÃ­nh Ä‘Ãºng Ä‘áº¯n dá»¯ liá»‡u (data validation) trÃªn thuá»™c tÃ­nh cá»§a Ä‘á»‘i tÆ°á»£ng. Cháº³ng háº¡n nhÆ°: 123456789101112const u = &#123; age: null &#125;const p = new Proxy(u, &#123; set(target, prop, val) &#123; if (prop === 'age' &amp;&amp; typeof val !== 'number') throw new TypeError('Age must be a number') target[prop] = val return true &#125;&#125;)p.age = '10' // Error: Age must be a numberp.age = 10 // OK! handler.defineProperty() vÃ  handler.deleteProperty()handle.defineProperty(target, property, descriptor) lÃ  trap Ä‘Æ°á»£c kÃ­ch hoáº¡t khi sá»­ dá»¥ng Object.defineProperty(). PhÆ°Æ¡ng thá»©c nÃ y Ä‘Ã²i há»i pháº£i tráº£ vá» má»™t giÃ¡ trá»‹ boolean. VÃ­ dá»¥: 123456789101112const p = new Proxy(&#123; foo: 1, bar: true &#125;, &#123; defineProperty(target, property, descriptor) &#123; if (property.startsWith('_')) throw new Error('Properties starting with _ are not allowed') return Object.defineProperty(...arguments) &#125;&#125;)p._hello = 1 // ErrorObject.defineProperty(p, '_hello', &#123; value: 1 &#125;) // Errorp.hello = 1Object.defineProperty(p, 'hello', &#123; value: 1 &#125;) descriptor lÃ  má»™t object quy Ä‘á»‹nh hÃ nh vi cá»§a thuá»™c tÃ­nh Ä‘Æ°á»£c khai bÃ¡o. Chi tiáº¿t vá» descriptor báº¡n cÃ³ thá»ƒ xem á»Ÿ trang MDN hoáº·c hÃ³ng bÃ i viáº¿t tiáº¿p theo cá»§a Ehkoo. handle.deleteProperty(target, property) sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t khi thá»±c hiá»‡n delete má»™t thuá»™c tÃ­nh. PhÆ°Æ¡ng thá»©c nÃ y pháº£i tráº£ vá» true náº¿u quÃ¡ trÃ¬nh xÃ³a Ä‘Æ°á»£c cháº¥p nháº­n. VÃ­ dá»¥: 12345678910const p = new Proxy(&#123; foo: 1, bar: true &#125;, &#123; deleteProperty(target, property) &#123; delete target[property] console.log(`$&#123;property&#125; was removed`) return true &#125;&#125;)delete p.foo // foo was removeddelete p.bar // bar was removed handler.has()handler.has() sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t khi sá»­ dá»¥ng in. PhÆ°Æ¡ng thá»©c nÃ y cÅ©ng Ä‘Ã²i há»i pháº£i tráº£ vá» má»™t giÃ¡ trá»‹ boolean. VÃ­ dá»¥: 123456789const p = new Proxy(&#123; _foo: 1, bar: true &#125;, &#123; has(target, property) &#123; if (property.startsWith('_')) return false return property in target &#125;&#125;)console.log('bar' in p) // trueconsole.log('_foo' in p) // true handler.apply()handler.apply(target, thisArg, args) lÃ  trap dÃ nh cho cÃ¡c hÃ m, sáº½ Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng khi hÃ m Ä‘Æ°á»£c gá»i. VÃ­ dá»¥: 123456789const sum = (a, b) =&gt; a + bconst f = new Proxy(sum, &#123; apply(target, thisArg, args) &#123; const [a, b] = args return target.call(thisArg, a * 2, b * 2) &#125;&#125;)f(1, 2) // 6 handler.construct()handler.construct(target, args) lÃ  trap sáº½ Ä‘Æ°á»£c gá»i khi khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng báº±ng new. VÃ­ dá»¥: 123456789101112131415class User &#123; constructor(username) &#123; this.username = username &#125;&#125;const PUser = new Proxy(User, &#123; construct(target, args) &#123; const [username] = args return new target(username.toUpperCase()) &#125;&#125;)const u = new PUser('pikalong')console.log(u.username) // PIKALONG handler.getPrototypeOf() vÃ  handler.setPrototypeOf()NhÆ° tÃªn gá»i, hai traps nÃ y sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t khi sá»­ dá»¥ng Object.getPrototypeOf() vÃ  Object.setPrototypeOf() trÃªn Ä‘á»‘i tÆ°á»£ng. Ghi chÃºBÃªn cáº¡nh nhá»¯ng traps Ä‘Æ°á»£c giá»›i thiá»‡u á»Ÿ Ä‘Ã¢y, cÃ²n cÃ³ má»™t sá»‘ traps khÃ¡c mÃ  báº¡n cÃ³ thá»ƒ tham kháº£o á»Ÿ trang MDN. Viáº¿t thá»­ nÃ oBáº¡n cÃ³ dÃ¹ng thá»­ chai chÆ°a? ThÆ° viá»‡n nÃ y há»— trá»£ viáº¿t kiá»ƒm chá»©ng (assertion) theo phong cÃ¡ch BDD/TDD, giá»‘ng nhÆ° tháº¿ nÃ y: 123456789// chai.expectexpect(foo).to.be.a('string')expect(foo).to.equal('bar')expect(foo).to.have.lengthOf(3)// hoáº·c chai.shouldfoo.should.be.a('string')foo.should.equal('bar')foo.should.have.lengthOf(3) CÃ¡ch thiáº¿t káº¿ nÃ y rÃµ rÃ ng giÃºp cho chÆ°Æ¡ng trÃ¬nh trá»Ÿ nÃªn máº¡ch láº¡c vÃ  dá»… theo dÃµi vÃ¬ cÃ¢u kiá»ƒm chá»©ng Ä‘Æ°á»£c viáº¿t nhÆ° má»™t cÃ¢u tiáº¿ng Anh váº­y. ChÃºng ta cÃ³ thá»ƒ báº¯t chÆ°á»›c chai vÃ  thá»­ viáº¿t má»™t lá»›p Thing cÃ³ nhá»¯ng kháº£ nÄƒng sau: 123456789101112131415// Khá»Ÿi táº¡o má»™t Ä‘á»‘i tÆ°á»£ng cá»§a lá»›p Thing vá»›i tÃªn lÃ  \"PhÆ°Æ¡ng\"const t = new Thing('PhÆ°Æ¡ng')t.name // 'PhÆ°Æ¡ng'// Khai bÃ¡o cÃ¡c thuá»™c tÃ­nh booleant.is_a.singert.is_not_a.man// Kiá»ƒm tra thuá»™c tÃ­nht.is_a_singer // truet.is_a_man // false// Khai bÃ¡o phÆ°Æ¡ng thá»©ct.can.sing('YÃªu hay khÃ´ng yÃªu khÃ´ng yÃªu hay yÃªu nÃ³i má»™t lá»i')t.sing() // PhÆ°Æ¡ng sings: YÃªu hay khÃ´ng yÃªu khÃ´ng yÃªu hay yÃªu nÃ³i má»™t lá»i ÄÃ¢y lÃ  má»™t pháº§n trong bÃ i The builder of things Ä‘Æ°á»£c láº¥y tá»« Codewars. Sau khi Ä‘á»c háº¿t bÃ i viáº¿t nÃ y thÃ¬ báº¡n hÃ£y thá»­ giáº£i thá»­ thÃ¡ch trÃªn xem sao, báº£o Ä‘áº£m káº¿t quáº£ khÃ´ng lÃ m báº¡n tháº¥t vá»ng Ä‘Ã¢u.NgoÃ i ra náº¿u báº¡n cÃ³ tham gia Codewars thÃ¬ Ä‘á»«ng quÃªn gia nháº­p clan Ehkoo nhÃ© ;) Äáº§u tiÃªn, Ä‘á»ƒ truy xuáº¥t thuá»™c tÃ­nh name, chÃºng ta cÃ³ thá»ƒ nghÄ© Ä‘áº¿n giáº£i phÃ¡p â€œvÃ´ cÃ¹ng rÃµ rÃ ng vÃ  ngÃ¢y thÆ¡â€ sau: 12345class Thing &#123; constructor(name) &#123; this.name = name &#125;&#125; Äoáº¡n code trÃªn hoÃ n toÃ n há»£p lÃ½, nhÆ°ng sáº½ khÃ´ng giÃºp chÃºng ta giáº£i quyáº¿t nhá»¯ng yÃªu cáº§u tiáº¿p theo cá»§a bÃ i toÃ¡n. PhÃ¢n tÃ­ch ká»¹ má»™t chÃºt ta cÃ³ thá»ƒ tháº¥y viá»‡c dÃ¹ng Proxy lÃ  khÃ´ng thá»ƒ trÃ¡nh khá»i. Do Ä‘Ã³ Ä‘á»ƒ cÃ i Ä‘áº·t t.name báº±ng Proxy, ta cÃ³ thá»ƒ viáº¿t láº¡i thÃ nh: 123456789101112131415161718192021222324class Thing &#123; constructor(name) &#123; this.state = &#123; name &#125; return proxify(this, this.state) &#125;&#125;// HÃ m proxify() nháº­n vÃ o má»™t target vÃ  má»™t object chá»©a state.// State nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t nhá»¯ng yÃªu cáº§u tiáº¿p theo.function proxify(target, state) &#123; return new Proxy(target, &#123; get(target, prop, receiver) &#123; // Náº¿u truy xuáº¥t Ä‘áº¿n thuá»™c tÃ­nh `name`, láº¥y ra dá»¯ liá»‡u trong state if (prop === 'name') return state[prop] // CÃ²n láº¡i thÃ¬ sá»­ dá»¥ng hÃ nh vi máº·c Ä‘á»‹nh return target[prop] &#125; &#125;)&#125;const t = new Thing('PhÆ°Æ¡ng')console.log(t.name) // PhÆ°Æ¡ngconsole.log(t.age) // undefined Váº­y lÃ  táº¡m á»•n pháº§n láº¥y name. ChÃºng ta xem tiáº¿p Ä‘áº¿n hÃ nh vi tiáº¿p theo cá»§a lá»›p Thing. 12345t.is_a.singert.is_not_a.mant.is_a_singer // truet.is_a_man // false HÃ nh vi nÃ y cho phÃ©p khai bÃ¡o thuá»™c tÃ­nh boolean trÃªn Ä‘á»‘i tÆ°á»£ng báº±ng cÃ¡ch sá»­ dá»¥ng is_a cho giÃ¡ trá»‹ true vÃ  is_not_a cho giÃ¡ trá»‹ false. Sau Ä‘Ã³ ta cÃ³ thá»ƒ kiá»ƒm tra thuá»™c tÃ­nh báº±ng cÃ¡ch truy xuáº¥t Ä‘áº¿n is_a_${prop}. Äá»ƒ cÃ i Ä‘áº·t hÃ nh vi nÃ y, chÃºng ta cÃ³ thá»ƒ lÃ m nhÆ° sau: Khai bÃ¡o thÃªm má»™t khÃ³a booleans: {} cho state. KhÃ³a nÃ y Ä‘Ã³ng vai trÃ² nhÆ° má»™t báº£ng tham chiáº¿u giá»¯a tÃªn thuá»™c tÃ­nh boolean vÃ  giÃ¡ trá»‹ cá»§a nÃ³, cháº³ng háº¡n nhÆ° { singer: true, man: false }. NgoÃ i ra chÃºng ta cÅ©ng cáº§n thÃªm vÃ o state má»™t cá» inBooleanMode: false. Náº¿u prop lÃ  is_a hoáº·c is_not_a, báº­t cá» inBooleanMode: true Náº¿u cá» inBooleanMode Ä‘ang báº­t, thuá»™c tÃ­nh tiáº¿p theo sáº½ lÃ  thuá»™c tÃ­nh boolean. Do Ä‘Ã³ ta cáº­p nháº­t booleans cá»§a state thÃ nh { â€¦booleans, [prop]: state.booleanValue } 12345678910111213141516171819202122232425262728function enterBooleanMode(receiver, state, booleanValue) &#123; // Báº­t cá» state.inBooleanMode = true // LÆ°u láº¡i giÃ¡ trá»‹ boolean tÃ¹y thuá»™c vÃ o lÃ  `is_a` hay `is_not_a` state.booleanValue = booleanValue return receiver&#125;function setBoolean(receiver, state, prop) &#123; state.booleans = &#123;...state.booleans, [prop]: state.booleanValue &#125; // Reset láº¡i cÃ¡c giÃ¡ trá»‹ state.inBooleanMode = false state.booleanValue = null return receiver&#125;get(target, prop, receiver) &#123; // Äáº·t á»Ÿ Ä‘Ã¢y Ä‘á»ƒ trÃ¡nh trÆ°á»ng há»£p gá»i t.is_a.is_a if (state.inBooleanMode) return setBoolean(this, state, prop) if (prop === 'name') return state[prop] if (prop === 'is_a') return enterBooleanMode(receiver, state, true) if (prop === 'is_not_a') return enterBooleanMode(receiver, state, false) if (prop.startsWith('is_a_')) return state.booleans[prop.replace('is_a_', '')] return target[prop]&#125; Kiá»ƒm tra thá»­. 123456const t = new Thing('PhÆ°Æ¡ng')t.is_a.singert.is_not_a.manconsole.log(t.is_a_singer) // trueconsole.log(t.is_a_man) // false Äá»ƒ cÃ i Ä‘áº·t hÃ nh vi tiáº¿p theo, chÃºng ta cÅ©ng cÃ³ thá»ƒ lÃ m tÆ°Æ¡ng tá»± nhÆ° khai bÃ¡o thuá»™c tÃ­nh boolean báº±ng cÃ¡ch Ä‘áº·t thÃªm má»™t cá» inDefineMethodMode vÃ  báº­t/táº¯t cá» nÃ y tÆ°Æ¡ng á»©ng. BÃªn cáº¡nh Ä‘Ã³ chÃºng ta cÅ©ng Ä‘áº·t thÃªm má»™t khÃ³a methods trong state Ä‘á»ƒ chá»©a cÃ¡c phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c khai bÃ¡o thÃ´ng qua can. 123456789get(target, prop, receiver) &#123; // ... if (state.inDefineMethodMode) return setMethod(receiver, state, prop) if (prop === 'can') return enterDefineMethodMode(receiver, state) // Láº¥y ra phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c khai bÃ¡o bá»Ÿi `t.can` if (state.methods[prop]) return state.methods[prop] // ...&#125; á» Ä‘Ã¢y cÃ³ má»™t chÃºt khÃ³ khÄƒn. CÃ³ thá»ƒ tháº¥y trong t.can.sing(phrase), sing pháº£i lÃ  má»™t hÃ m. Do Ä‘Ã³ giÃ¡ trá»‹ tráº£ vá» cá»§a setMethod() cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t nhÆ° sau: 1234567891011121314function setMethod(receiver, state, prop) &#123; // Äá»«ng quÃªn táº¯t cá» sau khi cÃ i Ä‘áº·t method state.inDefineMethodMode = false return phrase =&gt; &#123; // Táº¡o ra hÃ m má»›i const f = () =&gt; `$&#123;state.name&#125; $&#123;prop&#125;: $&#123;phrase&#125;` // LÆ°u vÃ o danh sÃ¡ch cÃ¡c phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c khai bÃ¡o bá»Ÿi `t.can` state.methods = &#123; ...state.methods, [prop]: f &#125; &#125;&#125;t.can.sing('YÃªu hay khÃ´ng yÃªu khÃ´ng yÃªu hay yÃªu nÃ³i má»™t lá»i')console.log(t.sing()) // PhÆ°Æ¡ng sing: YÃªu hay khÃ´ng yÃªu khÃ´ng yÃªu hay yÃªu nÃ³i má»™t lá»i Váº­y lÃ  Ä‘Æ°á»£c rá»“i. ChÃºng ta chá»‰ cÃ²n má»™t bÆ°á»›c ná»¯a lÃ  chia â€œsingâ€ sang ngÃ´i thá»© ba sá»‘ Ã­t â€œsingsâ€, nhÆ°ng thÃ´i cÃ¡i nÃ y Ä‘á»ƒ báº¡n tá»± lÃ m nhÃ©. Báº¡n cÃ³ thá»ƒ xem Ä‘áº§y Ä‘á»§ mÃ£ nguá»“n á»Ÿ Ä‘Ã¢y. Káº¿tProxy lÃ  má»™t cÃ´ng cá»¥ máº¡nh máº½, giÃºp cho viá»‡c láº­p trÃ¬nh meta trong JavaScript trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n. Hi vá»ng bÃ i viáº¿t nÃ y Ä‘Ã£ giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n vá» Proxy vÃ  cÃ³ thá»ƒ á»©ng dá»¥ng nÃ³ trong cÃ´ng viá»‡c. Tham kháº£oProxy - MDN - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy ES6 Proxies in Depth - https://ponyfoo.com/articles/es6-proxies-in-depth","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"TÃ¬m hiá»ƒu Map vÃ  Set trong Javascript","slug":"Tim-Hieu-Map-Va-Set-Trong-Javascript","date":"2018-07-08T08:12:00.000Z","updated":"2018-07-08T08:57:25.234Z","comments":true,"path":"2018/07/Tim-Hieu-Map-Va-Set-Trong-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Tim-Hieu-Map-Va-Set-Trong-Javascript.html","excerpt":"ÄÆ°á»£c giá»›i thiá»‡u tá»« ES6, Map, Set, WeakMap, vÃ  WeakSet lÃ  nhá»¯ng cáº¥u trÃºc dá»¯ liá»‡u giÃºp thao tÃ¡c trÃªn táº­p há»£p. BÃ i viáº¿t nÃ y sáº½ giá»›i thiá»‡u cÃ¡ch hoáº¡t Ä‘á»™ng cÅ©ng nhÆ° cÃ¡c á»©ng dá»¥ng cá»§a chÃºng.","text":"ÄÆ°á»£c giá»›i thiá»‡u tá»« ES6, Map, Set, WeakMap, vÃ  WeakSet lÃ  nhá»¯ng cáº¥u trÃºc dá»¯ liá»‡u giÃºp thao tÃ¡c trÃªn táº­p há»£p. BÃ i viáº¿t nÃ y sáº½ giá»›i thiá»‡u cÃ¡ch hoáº¡t Ä‘á»™ng cÅ©ng nhÆ° cÃ¡c á»©ng dá»¥ng cá»§a chÃºng. MapMap, máº£ng káº¿t há»£p (associate arrays) hay tá»« Ä‘iá»ƒn (dictionary/dict) lÃ  nhá»¯ng thuáº­t ngá»¯ dÃ¹ng Ä‘á»ƒ chá»‰ má»™t cáº¥u trÃºc dá»¯ liá»‡u, cho phÃ©p báº¡n Ã¡nh xáº¡ tá»« má»™t khÃ³a (key) tÆ°Æ¡ng á»©ng vá»›i má»™t giÃ¡ trá»‹ (value). Trong JavaScript, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng object Ä‘á»ƒ thá»ƒ hiá»‡n cáº¥u trÃºc nÃ y. 123456const dict = &#123; hello: 'Xin chÃ o', bye: 'Táº¡m biá»‡t',&#125;console.log(dict['hello']) // Xin chÃ o Tuy nhiÃªn, náº¿u dÃ¹ng object thÃ¬ báº¡n chá»‰ cÃ³ thá»ƒ dÃ¹ng chuá»—i lÃ m khÃ³a. NgoÃ i ra, cÃ¡ch nÃ y cÅ©ng cÃ³ má»™t sá»‘ háº¡n cháº¿ khÃ¡c. Lá»›p Map do ES6 giá»›i thiá»‡u sáº½ giÃºp giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃ y. Vá»›i Map, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng báº¥t cá»© dáº¡ng dá»¯ liá»‡u nÃ o Ä‘á»ƒ lÃ m khÃ³a. 1234567891011const obj = &#123; bar: 2 &#125;const dict = new Map()dict .set('foo', 123) .set(obj, 'hello world')dict.get('foo') // 123dict.get(obj) // 'hello world'// Láº¥y giÃ¡ trá»‹ cá»§a má»™t khÃ³a khÃ´ng tá»“n táº¡idict.get('wat') // undefined Báº¡n cÅ©ng cÃ³ thá»ƒ truyá»n vÃ o hÃ m dá»±ng cá»§a Map má»™t máº£ng cÃ¡c cáº·p giÃ¡ trá»‹ dáº¡ng [key, value], vÃ­ dá»¥ nhÆ° sau: 1234const dict = new Map([ ['foo', 123], [obj, 'hello world']]) NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, báº¡n cÃ³ thá»ƒ dÃ¹ng báº¥t cá»© dáº¡ng dá»¯ liá»‡u gÃ¬ Ä‘á»ƒ lÃ m khÃ³a cho Map, ká»ƒ cáº£ máº£ng, object, hÃ m, hay NaN. 123456const arr = [1]const f = () =&gt; &#123;&#125;dict .set(arr, 'an array') .set(f, 'a function') .set(NaN, 'not a number') Báº£n thÃ¢n Map sá»­ dá»¥ng phÆ°Æ¡ng thá»©c so sÃ¡nh SameValueZero Ä‘á»ƒ tÃ¬m khÃ³a vÃ  giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng. SameValueZero hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»± nhÆ° ===, nhÆ°ng xem cÃ¡c giÃ¡ trá»‹ NaN báº±ng nhau, cÅ©ng nhÆ° +0 báº±ng -0. Äá»‘-háº»m-vui: Äá»‘ báº¡n káº¿t quáº£ cá»§a cÃ¡c biá»ƒu thá»©c sau lÃ  gÃ¬? NaN == NaNNaN === NaNObject.is(NaN, NaN) Do SameValueZero nÃªn hai object khÃ¡c nhau sáº½ lÃ  hai khÃ³a riÃªng biá»‡t. 123456const o1 = &#123;&#125;const o2 = &#123;&#125;dict.set(o1, 'Ã” Má»™t').set(o2, 'Ã” Hai')dict.get(o2) // Ã” Haidict.get(&#123;&#125;) // undefined Náº¿u trong map Ä‘Ã£ cÃ³ sáºµn khÃ³a, dá»¯ liá»‡u má»›i sáº½ bá»‹ ghi Ä‘Ã¨ lÃªn. 12345const m = new Map()m.set('foo', 1)m.set('foo', 2)m.get('foo') // 2 Äá»ƒ duyá»‡t qua cÃ¡c khÃ³a vÃ  giÃ¡ trá»‹ trong Map, báº¡n cÃ³ thá»ƒ dÃ¹ng: 123456789101112131415const dict = new Map([ ['foo', 1], ['bar', 2]])dict.keys() // ['foo', 'bar']dict.values() // [1, 2]dict.entries() // [ ['foo', 1], ['bar', 2] ]dict.forEach(function(value, key, map) &#123; console.log(`$&#123;key&#125; has $&#123;value&#125;`)&#125;, /* thisArgs báº¡n cÃ³ thá»ƒ truyá»n vÃ o tham chiáº¿u cho `this` á»Ÿ Ä‘Ã¢y */)// Sá»­ dá»¥ng for..of cÃ¹ng vá»›i destructuringfor (let [key, value] of dict) &#123; console.log(`$&#123;key&#125; has $&#123;value&#125;`)&#125; Báº¡n cÅ©ng cÃ³ thá»ƒ dÃ¹ng toÃ¡n tá»­ spread â€¦ vá»›i Map 12345678const dict = new Map([ ['foo', 1], ['bar', 2]])console.log([ ['wut', 3], ...dict])// [ [ 'wut', 3 ], [ 'foo', 1 ], [ 'bar', 2 ] ] Má»™t sá»‘ thao tÃ¡c khÃ¡c vá»›i Map. 1234567891011121314151617const dict = new Map([ ['foo', 1], ['bar', 2]])// Äáº¿m sá»‘ cáº·p giÃ¡ trá»‹ trong mapdict.size // 2// Kiá»ƒm tra trong map cÃ³ khÃ³a \"foo\" hay khÃ´ngdict.has('foo') // truedict.has('wut') // false// XÃ³a má»™t khÃ³a, tráº£ vá» boolean náº¿u thÃ nh cÃ´ng, false náº¿u tháº¥t báº¡idict.delete('wut') // falsedict.delete('foo') // true// XÃ³a háº¿t cÃ¡c cáº·p giÃ¡ trá»‹ cá»§a mapdict.clear() Táº¡i sao láº¡i lÃ  size mÃ  khÃ´ng pháº£i length?Má»™t sá»‘ Ä‘á»™c giáº£ tinh Ã½ sáº½ nháº­n ra chÃºng ta dÃ¹ng size thay vÃ¬ length Ä‘á»ƒ Ä‘áº¿m sá»‘ cáº·p giÃ¡ trá»‹ trong map. LÃ½ do lÃ  vÃ¬: length dÃ¹ng cho nhá»¯ng chuá»—i cÃ³ thá»ƒ index (Ä‘Ã¡nh sá»‘) Ä‘Æ°á»£c, vÃ­ dá»¥ vá»›i máº£ng ta cÃ³ thá»ƒ arr[3]. NgÆ°á»£c láº¡i, size dÃ nh cho nhá»¯ng cáº¥u trÃºc khÃ´ng cÃ³ thá»© tá»± nhÆ° Map vÃ  Set. SetSet lÃ  táº­p há»£p cÃ¡c giÃ¡ trá»‹ khÃ´ng bá»‹ trÃ¹ng láº·p, nghÄ©a lÃ  trong má»™t set khÃ´ng thá»ƒ cÃ³ hai giÃ¡ trá»‹ báº±ng nhau. 12345678const s = new Set()set .add('red') .add('blue') .add('sweet') .add('you')s.size // 4 Báº¡n cÅ©ng cÃ³ thá»ƒ truyá»n má»™t máº£ng vÃ o hÃ m dá»±ng cá»§a Set. 12const s = new Set(['red', 'blue', 'sweet', 'red', 'you'])console.log(s) // Set (4) &#123;'red', 'blue', 'sweet', 'you'&#125; Báº¡n cÅ©ng cÃ³ thá»ƒ tháº¥y giÃ¡ trá»‹ â€˜redâ€™ bá»‹ trÃ¹ng láº·p Ä‘Ã£ Ä‘Æ°á»£c loáº¡i bá». ChÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng Set Ä‘á»ƒ táº¡o ra má»™t máº£ng chá»©a nhá»¯ng pháº§n tá»­ duy nháº¥t. 123const a = ['red', 'blue', 'sweet', 'red', 'you']const b = [...new Set(a)]console.log(b) // [ 'red', 'blue', 'sweet', 'you' ] CÅ©ng tÆ°Æ¡ng tá»± nhÆ° Map, Set sá»­ dá»¥ng SameZeroValue Ä‘á»ƒ so sÃ¡nh cÃ¡c pháº§n tá»­ vá»›i nhau. 12345const obj = &#123;&#125;const s = new Set([NaN, &#123;&#125;, obj])s.has(NaN) // trues.has(obj) // trues.has(&#123;&#125;) // false Äá»ƒ duyá»‡t qua cÃ¡c pháº§n tá»­ cá»§a Set, báº¡n cÃ³ thá»ƒ dÃ¹ng cÃ¡c phÆ°Æ¡ng thá»©c nhÆ° vá»›i Map. 12345678910111213const s = new Set([1, 2, 3, 4, 5])// VÃ¬ Set khÃ´ng cÃ³ khÃ¡i niá»‡m keys nÃªn káº¿t quáº£ cá»§a `s.keys()` vÃ  `s.values()` lÃ  nhÆ° nhau.s.keys()s.values()s.entries()s.forEach(function(value, key, setReference) &#123;&#125;, thisArg)for (let el of s) &#123; console.log(el)&#125; Má»™t sá»‘ thao tÃ¡c khÃ¡c trÃªn Set. 1234567const s = new Set([1, 2, 3, 4, 5])// XÃ³a má»™t pháº§n tá»­ trong sets.delete(3) // Set (4) &#123;1, 2, 4, 5&#125;// XÃ³a háº¿t pháº§n tá»­ trong sets.clear() WeakMap vÃ  WeakSetES6 cÅ©ng giá»›i thiá»‡u hai lá»›p WeakMap vÃ  WeakSet. So vá»›i Map, cÃ¡c khÃ³a cá»§a WeakMap báº¯t buá»™c pháº£i lÃ  object, vÃ  chÃºng sáº½ bá»‹ giáº£i phÃ³ng khá»i bá»™ nhá»› (garbage-collecting â€“ â€œhá»‘t rÃ¡câ€) Ä‘áº§u tiÃªn náº¿u khÃ´ng cÃ³ tham chiáº¿u nÃ o. WeakMap cÃ³ cÃ¡c phÆ°Æ¡ng thá»©c tÆ°Æ¡ng tá»± nhÆ° Map, ngoáº¡i trá»« viá»‡c báº¡n khÃ´ng thá»ƒ duyá»‡t qua WeakMap báº±ng .keys(), .values(), .entries() hay for..of. Báº¡n cÅ©ng khÃ´ng thá»ƒ .clear(), vÃ¬ lÃ½ do an toÃ n dá»¯ liá»‡u. Má»™t á»©ng dá»¥ng cá»§a WeakMap lÃ  dÃ¹ng Ä‘á»ƒ chá»©a dá»¯ liá»‡u private mÃ  khÃ´ng gÃ¢y ra rÃ² rá»‰ bá»™ nhá»›. 12345678910111213141516const privates = new WeakMap()class User &#123; constructor() &#123; const data = &#123; phoneNumber: 123 &#125; privates.set(this, data) &#125; getPhoneNumber() &#123; const data = privates.get(this) return data.phoneNumber &#125;&#125;const u = new User()console.log(u) // &#123;&#125;console.log(u.getPhoneNumber()) // 123 TÆ°Æ¡ng tá»± nhÆ° WeakMap, WeakSet cÅ©ng chá»‰ cÃ³ thá»ƒ chá»©a object, vÃ  náº¿u má»™t pháº§n tá»­ trong WeakSet khÃ´ng cÃ³ tham chiáº¿u tá»›i, nÃ³ sáº½ bá»‹ giáº£i phÃ³ng khá»i bá»™ nhá»›. Káº¿t luáº­nVá»›i nhá»¯ng cáº£i tiáº¿n so vá»›i object thÃ´ng thÆ°á»ng, Map sáº½ lÃ  cÃ´ng cá»¥ há»¯u hiá»‡u Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u dáº¡ng (khÃ³a, giÃ¡ trá»‹). Trong khi Ä‘Ã³, Set giÃºp báº¡n lÆ°u trá»¯ chuá»—i dá»¯ liá»‡u mÃ  khÃ´ng lo láº¯ng vá» viá»‡c trÃ¹ng láº¯p giÃ¡ trá»‹. Tham kháº£o[1] Axel Rauschmayer. ECMAScript 6: maps and sets. http://2ality.com/2015/01/es6-maps-sets.html [2] Keyed Collections - JavaScript | MDN. https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Keyed_collections [3] Steve Brownlee. WeakMap for JavaScript Private Data. https://www.stevebrownlee.com/weakmap-javascript-private-data/","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Tá»•ng há»£p nhá»¯ng tÃ­nh nÄƒng ES6 ná»•i báº­t","slug":"Tong-hop-nhung-tinh-nang-ES6-noi-bat","date":"2018-07-08T01:08:00.000Z","updated":"2018-07-08T09:09:59.591Z","comments":true,"path":"2018/07/Tong-hop-nhung-tinh-nang-ES6-noi-bat.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Tong-hop-nhung-tinh-nang-ES6-noi-bat.html","excerpt":"Viá»‡c háº§u háº¿t nhá»¯ng tÃ­nh nÄƒng hay ho háº¥p dáº«n cá»§a ES6 Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c cÃ¡c trÃ¬nh duyá»‡t há»— trá»£ quáº£ lÃ  tin vui cho giá»›i láº­p trÃ¬nh web. Nhá» nÃ³ mÃ  nhÃ  phÃ¡t triá»ƒn cÃ³ thá»ƒ xÃ¢y dá»±ng á»©ng dá»¥ng trá»±c tiáº¿p báº±ng ES6, khÃ´ng cáº§n pháº£i thÃ´ng qua cÃ¡c cÃ´ng cá»¥ chuyá»ƒn Ä‘á»•i nhÆ° Babel hay BublÃ© ná»¯a, giÃºp á»©ng dá»¥ng trá»Ÿ nÃªn gá»n nháº¹ hÆ¡n, giáº£m thiá»ƒu kÃ­ch thÆ°á»›c táº­p tin khi chuyá»ƒn Ä‘áº¿n ngÆ°á»i sá»­ dá»¥ng.","text":"Viá»‡c háº§u háº¿t nhá»¯ng tÃ­nh nÄƒng hay ho háº¥p dáº«n cá»§a ES6 Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c cÃ¡c trÃ¬nh duyá»‡t há»— trá»£ quáº£ lÃ  tin vui cho giá»›i láº­p trÃ¬nh web. Nhá» nÃ³ mÃ  nhÃ  phÃ¡t triá»ƒn cÃ³ thá»ƒ xÃ¢y dá»±ng á»©ng dá»¥ng trá»±c tiáº¿p báº±ng ES6, khÃ´ng cáº§n pháº£i thÃ´ng qua cÃ¡c cÃ´ng cá»¥ chuyá»ƒn Ä‘á»•i nhÆ° Babel hay BublÃ© ná»¯a, giÃºp á»©ng dá»¥ng trá»Ÿ nÃªn gá»n nháº¹ hÆ¡n, giáº£m thiá»ƒu kÃ­ch thÆ°á»›c táº­p tin khi chuyá»ƒn Ä‘áº¿n ngÆ°á»i sá»­ dá»¥ng. Ná»™i dung let vÃ  const HÃ m mÅ©i tÃªn (arrow functions) Chuá»—i báº£n máº«u (template strings) Object chÃ¢n phÆ°Æ¡ng (object literals) PhÃ¢n rÃ£ biáº¿n (destructuring) Rest vÃ  Spread GiÃ¡ trá»‹ máº·c Ä‘á»‹nh cho tham sá»‘ Lá»›p (class) Promise 1. let vÃ  constNgÃ y xa xÆ°a áº¥y, báº¡n khai bÃ¡o biáº¿n trong JavaScript báº±ng var, giá»‘ng nhÆ° vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y. 123456789var foo = 1function printFoo(shouldDo) &#123; if (shouldDo) &#123; var foo = 2 &#125; return foo&#125;console.log(printFoo(false)) // undefinedconsole.log(printFoo(true)) // 2 Biáº¿n Ä‘Æ°á»£c khai bÃ¡o vá»›i var sáº½ cÃ³ táº§m vá»±c bÃªn trong hÃ m gáº§n nháº¥t (function scope), vÃ  sáº½ Ä‘Æ°á»£c Ä‘áº©y lÃªn Ä‘áº§u cá»§a táº§m vá»±c (hoisting). ÄÃ³ lÃ  lÃ½ do táº¡i sao foo láº¡i cÃ³ giÃ¡ trá»‹ undefined trong dÃ²ng console.log Ä‘áº§u tiÃªn. ES6 giá»›i thiá»‡u let vÃ  const nhÆ° hai cÃ¡ch khai bÃ¡o biáº¿n má»›i, há»— trá»£ táº§m vá»±c theo khá»‘i (block scope) vÃ  khÃ´ng thá»±c hiá»‡n hoisting. 1234567891011let foo = 1function printFoo(shouldDo) &#123; if (shouldDo) &#123; let foo = 2 console.log('Value of foo in scope', foo) // 2 &#125; console.log('foo is out of block scope', foo) // 1 return foo&#125;console.log(printFoo(false)) // 1console.log(printFoo(true)) // 1 Äiá»ƒm khÃ¡c biá»‡t giá»¯a let vÃ  const lÃ  vá»›i const, báº¡n khÃ´ng thá»ƒ gÃ¡n giÃ¡ trá»‹ má»›i cho biáº¿n sau khi khai bÃ¡o, trong khi Ä‘iá»u nÃ y láº¡i cÃ³ thá»ƒ vá»›i let. 123456let foo = 2foo = 3console.log(foo) // 3const baz = 2baz = 3 // Error: Assignment to constant variable. const mang Ã½ nghÄ©a â€œconstantâ€ chá»© khÃ´ng pháº£i â€œimmutabilityâ€. NghÄ©a lÃ  vá»›i cÃ¡c biáº¿n lÃ  object hay array, báº¡n váº«n cÃ³ thá»ƒ thay Ä‘á»•i giÃ¡ trá»‹ bÃªn trong cá»§a chÃºng. 123456789101112const obj = &#123; foo: 2 &#125;obj.foo = 5obj.bar = 3console.log(obj) // &#123; foo: 5, bar: 3 &#125;const arr = [1]arr.push(2)console.log(arr) // [1, 2]// Tuy váº­y báº¡n khÃ´ng thá»ƒ gÃ¡n má»™t Ä‘á»‘i tÆ°á»£ng khÃ¡c cho obj/arrobj = &#123; baz: 4 &#125; // Error: Assignment to constant variable.arr = [] // Error: Assignment to constant variable. TÃ­nh tÆ°Æ¡ng thÃ­ch: ÄÆ°á»£c há»— trá»£ trÃªn táº¥t cáº£ trÃ¬nh duyá»‡t, ká»ƒ cáº£ IE11.Lá»i khuyÃªn: DÃ¹ng const cho táº¥t cáº£ khai bÃ¡o biáº¿n vÃ¬ nÃ³ sáº½ giÃºp báº¡n háº¡n cháº¿ trÆ°á»ng há»£p â€œvÃ´ tÃ¬nhâ€ thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n. Chá»‰ dÃ¹ng let trong trÆ°á»ng há»£p báº¥t kháº£ khÃ¡ng, vÃ  trÃ¡nh xa var. 2. HÃ m mÅ©i tÃªnHÃ m mÅ©i tÃªn â€“ (fat) arrow functions â€“ lÃ  má»™t kiá»ƒu cÃº phÃ¡p rÃºt gá»n cho khai bÃ¡o hÃ m trong JavaScript. TrÆ°á»›c ES6, báº¡n khai bÃ¡o má»™t hÃ m trong JavaScript vá»›i tá»« khÃ³a function. 12345678function add(x, y) &#123; return x + y&#125;// HÃ m add() á»Ÿ trÃªn lÃ  syntactic sugar cho...var add = function(x, y) &#123; return x + y&#125; â€œSyntactic sugarâ€ lÃ  cÃº phÃ¡p lÃ m cho ngÃ´n ngá»¯ trá»Ÿ nÃªn dá»… Ä‘á»c vÃ  dá»… hiá»ƒu hÆ¡n, theo kiá»ƒu nÃ³ lÃ m cho ngÃ´n ngá»¯ â€œngá»t ngÃ o hÆ¡nâ€ (sweeter) vá»›i láº­p trÃ¬nh viÃªn. Vá»›i hÃ m mÅ©i tÃªn trong ES6, báº¡n cÃ³ thá»ƒ viáº¿t láº¡i thÃ nh: 1234567const add = (x, y) =&gt; &#123; return x + y&#125;// Báº¡n cÅ©ng cÃ³ thá»ƒ viáº¿t dÆ°á»›i dáº¡ng biá»ƒu thá»©c (expression), hÃ m mÅ©i// tÃªn sáº½ tá»± Ä‘á»™ng tráº£ giÃ¡ trá»‹ vá» (auto-return).const add = (x, y) =&gt; x + y HÃ m mÅ©i tÃªn cÅ©ng há»¯u dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» muÃ´n thuá»Ÿ trong JavaScript: â€œwhich this is this?â€ â€“ khÃ¡i niá»‡m con trá» this. Vá»›i ES5, báº¡n hay gáº·p trÆ°á»ng há»£p giá»‘ng nhÆ° tháº¿ nÃ y: 123456789'use strict'function App() &#123; this.count = 0 setInterval(function() &#123; console.log(this.count++) &#125;, 1000)&#125;var a = new App() TrÆ°á»›c ES6, má»—i khai bÃ¡o hÃ m Ä‘á»u cÃ³ má»™t giÃ¡ trá»‹ this tÃ¡ch biá»‡t. Äiá»u nÃ y lÃ m cho Ä‘oáº¡n code á»Ÿ trÃªn khÃ´ng hoáº¡t Ä‘á»™ng, vÃ¬ this.count bÃªn trong hÃ m cá»§a setInterval mang giÃ¡ trá»‹ undefined. CÃ¡ch giáº£i quyáº¿t thÃ´ng thÆ°á»ng lÃ  Ä‘áº·t má»™t biáº¿n self, that hay _this Ä‘á»ƒ giá»¯ reference, hoáº·c sá»­ dá»¥ng Function.prototype.bind. 123456789101112131415161718function App() &#123; this.count = 0 var self = this setInterval(function() &#123; console.log(self.count++) &#125;, 1000)&#125;// hoáº·cfunction App() &#123; this.count = 0 function counter() &#123; console.log(this.count++) &#125; setInterval(counter.bind(this), 1000)&#125; Vá»›i hÃ m mÅ©i tÃªn trong ES6, giÃ¡ trá»‹ cá»§a this chÃ­nh lÃ  this trong táº§m vá»±c gáº§n nháº¥t vá»›i nÃ³ (lexical this). Do Ä‘Ã³ chÃºng ta khÃ´ng cáº§n pháº£i khai bÃ¡o biáº¿n táº¡m hay dÃ¹ng .bind ná»¯a. 12345function App() &#123; this.count = 0 setInterval(() =&gt; console.log(this.count++), 1000)&#125; HÃ m mÅ©i tÃªn cÅ©ng ráº¥t há»¯u Ã­ch khi thao tÃ¡c trÃªn máº£ng vÃ  tiáº¿n hÃ nh chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u, giÃºp mÃ£ nguá»“n dá»… Ä‘á»c vÃ  rÃµ rÃ ng hÆ¡n. 1const subtotal = products.filter(product =&gt; product.price &gt; 500).reduce((acc, product) =&gt; acc + product.price, 0) TÃ­nh tÆ°Æ¡ng thÃ­ch: Trá»« IE11, táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t cÃ²n láº¡i Ä‘á»u há»— trá»£.Lá»i khuyÃªn: Náº¿u cÃ³ dÃ¹ng Ä‘áº¿n this thÃ¬ hÃ m mÅ©i tÃªn ráº¥t há»¯u dá»¥ng. TrÆ°á»ng há»£p khÃ´ng dÃ¹ng thÃ¬â€¦cÅ©ng há»¯u dá»¥ng luÃ´n vÃ¬ mÃ£ nguá»“n gá»n gÃ ng dá»… Ä‘á»c hÆ¡n. Vá»›i nhá»¯ng trÆ°á»ng há»£p báº¡n muá»‘n bao Ä‘Ã³ng giÃ¡ trá»‹ cá»§a this chá»‰ gÃ³i gá»n trong hÃ m cá»§a nÃ³, dÃ¹ng function. 3. Chuá»—i báº£n máº«uChuá»—i báº£n máº«u (template strings) lÃ  chuá»—i chÃ¢n phÆ°Æ¡ng (string literals) nhÆ°ng cho phÃ©p Ä‘Ã­nh kÃ¨m biá»ƒu thá»©c. NÃ³ cÅ©ng cho phÃ©p khai bÃ¡o chuá»—i trÃªn nhiá»u dÃ²ng. Äá»ƒ sá»­ dá»¥ng, báº¡n dÃ¹ng kÃ½ tá»± backtick ` (dáº¥u huyá»n). VÃ­ dá»¥ nhÆ° lÃ : 1234const name = 'John'const greetings = `Hello $&#123;name&#125;,The result of 1 + 1 is $&#123;1 + 1&#125;, and the time is now $&#123;Date.now()&#125;.` VÃ¬ chuá»—i báº£n máº«u cÅ©ng chá»‰ lÃ  chuá»—i nÃªn báº¡n cÃ³ thá»ƒ gá»i Ä‘áº¿n nhá»¯ng phÆ°Æ¡ng thá»©c cá»§a String.prototype. 1;`Hello World`.substr(0, 5).toUpperCase() TÃ­nh tÆ°Æ¡ng thÃ­ch: Trá»« IE11, táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t cÃ²n láº¡i Ä‘á»u há»— trá»£.Lá»i khuyÃªn: DÃ¹ng chuá»—i báº£n máº«u khi báº¡n cáº§n gáº¯n biá»ƒu thá»©c hay chuá»—i cÃ³ ná»™i dung á»Ÿ nhiá»u dÃ²ng. CÃ²n láº¡i thÃ¬ váº«n dÃ¹ng chuá»—i bÃ¬nh thÆ°á»ng vá»›i â€˜ hay â€œ. 4. Object chÃ¢n phÆ°Æ¡ng (object literals)Object chÃ¢n phÆ°Æ¡ng (object literals) chá»‰ Ä‘Æ¡n giáº£n lÃ  khai bÃ¡o má»™t object trong JavaScript nhÆ° báº¡n Ä‘Ã£ lÃ m bao nÄƒm nay. 12345678var birthYear = 2000var obj = &#123; name: 'John', birthYear: birthYear, getAge: function(currentYear) &#123; return currentYear - obj.birthYear &#125;&#125; ES6 nÃ¢ng cáº¥p object chÃ¢n phÆ°Æ¡ng, cho phÃ©p báº¡n khai bÃ¡o táº¯t thuá»™c tÃ­nh cá»§a object vá»›i biáº¿n cÃ¹ng tÃªn, vÃ  khai bÃ¡o phÆ°Æ¡ng thá»©c cho object. 123456789const birthYear = 2000const obj = &#123; name: 'John', birthYear, // khai bÃ¡o táº¯t birthYear: birthYear getAge(currentYear) &#123; // `this` Ä‘Æ°á»£c gÃ¡n trá»±c tiáº¿p vÃ o báº£n thÃ¢n object return currentYear - this.birthYear &#125;&#125; Má»™t lÆ°u Ã½ vá»›i this lÃ  khi báº¡n dÃ¹ng hÃ m mÅ©i tÃªn, this sáº½ Ä‘Æ°á»£c láº¥y tá»« this trong táº§m vá»±c gáº§n vá»›i nÃ³ nháº¥t, chá»© khÃ´ng trá» Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng hiá»‡n táº¡i. Do Ä‘Ã³â€¦ 123&#123; getAge: currentYear =&gt; currentYear - this.birthYear&#125; â€¦sáº½ khÃ´ng cháº¡y nhÆ° mong muá»‘n, vÃ¬ cÃ³ thá»ƒ this.birthYear mang giÃ¡ trá»‹ undefined. Äá»ƒ sá»­ dá»¥ng hÃ m mÅ©i tÃªn báº¡n pháº£i viáº¿t láº¡i nhÆ° trÆ°á»›c ES6. 123&#123; getAge: currentYear =&gt; currentYear - obj.birthYear&#125; NgoÃ i ra tá»« ES6 báº¡n cÅ©ng cÃ³ thá»ƒ khai bÃ¡o thuá»™c tÃ­nh cho object má»™t cÃ¡ch linh Ä‘á»™ng báº±ng cÃ¡ch sá»­ dá»¥ng cÃº phÃ¡p []. 1234const attr = 'foo'const year = 2017const obj = &#123; [attr]: 1, ['now' + year]: 'wow' &#125;console.log(obj) // &#123; foo: 1, now2017: 'wow' &#125; TÃ­nh tÆ°Æ¡ng thÃ­ch: ÄÆ°á»£c há»— trá»£ bá»Ÿi táº¥t cáº£ trÃ¬nh duyá»‡tLá»i khuyÃªn: TÃ­nh nÄƒng khai bÃ¡o táº¯t thuá»™c tÃ­nh cá»§a object cá»±c kÃ½ há»¯u dá»¥ng =&gt; nÃªn dÃ¹ng. Náº¿u khÃ´ng báº­n tÃ¢m Ä‘áº¿n this thÃ¬ báº¡n cÃ³ thá»ƒ dÃ¹ng hÃ m mÅ©i tÃªn khi khai bÃ¡o phÆ°Æ¡ng thá»©c cho object Ä‘á»ƒ mÃ£ nguá»“n gá»n gÃ ng sáº¡ch Ä‘áº¹p hÆ¡n. 5. PhÃ¢n rÃ£ biáº¿nPhÃ¢n rÃ£ biáº¿n â€“ destructuring â€“ theo mÃ¬nh lÃ  tÃ­nh nÄƒng tiá»‡n dá»¥ng nháº¥t cá»§a ES6. TÃ­nh nÄƒng nÃ y giÃºp báº¡n tÃ¡ch biáº¿n tá»« thuá»™c tÃ­nh cá»§a Ä‘á»‘i tÆ°á»£ng hay pháº§n tá»­ trong cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ duyá»‡t vá»›i for, nhÆ° máº£ng hoáº·c chuá»—i. Cháº³ng háº¡n nhÆ°: 1234567891011const user = &#123; name: 'John', age: 21 &#125;const &#123; name &#125; = userconsole.log(name) // 'John'const arr = [1, 2, 3]const [first, second] = arrconsole.log(first, second) // 1, 2const str = 'Hello'const [first, second] = strconsole.log(first, second) // 'H', 'e' Báº¡n cÅ©ng cÃ³ thá»ƒ phÃ¢n rÃ£ cÃ¡c thuá»™c tÃ­nh lá»“ng nhau. 12345678910const userList = [ &#123; name: 'John', age: 21, products: [&#123; name: 'Creamy Crustacean Omelette', price: 1200 &#125;, &#123; name: 'Galdin Gratin', price: 2300 &#125;] &#125;]const [&#123; products: [&#123; price &#125;] &#125;] = userListconsole.log(price) // 1200 Vá»›i máº£ng hay chuá»—i, báº¡n cÃ³ thá»ƒ bá» qua pháº§n tá»­ khÃ´ng mong muá»‘n khi phÃ¢n rÃ£. 1234567const arr = [1, 2, 3]const [first, , third] = arrconsole.log(first, third) // 1, 3const str = 'Hello'const [fst, , , , lst] = strconsole.log(fst, lst) // 'H', 'o' PhÃ¢n rÃ£ biáº¿n cÅ©ng ráº¥t thÆ°á»ng gáº·p khi báº¡n sá»­ dá»¥ng ES6 module. 12import &#123; Component &#125; from 'react'import &#123; render &#125; from 'react-dom' TÃ­nh tÆ°Æ¡ng thÃ­ch: Trá»« IE11, táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t cÃ²n láº¡i Ä‘á»u há»— trá»£. 6. Rest vÃ  spreadRest â€“ pháº§n cÃ²n láº¡i â€“ lÃ  má»™t bá»• sung cá»§a phÃ¢n rÃ£ biáº¿n máº£ng á»Ÿ trÃªn. Báº¡n dÃ¹ng ba dáº¥u cháº¥m â€¦ Ä‘á»ƒ biá»ƒu thá»‹ rest. 123456const [first, second, ...others] = [1, 2, 3, 4, 5]console.log(first, second, others)// 1// 2// [3, 4, 5] Rest cÅ©ng Ä‘Æ°á»£c dÃ¹ng khi khai bÃ¡o hÃ m cÃ³ thá»ƒ nháº­n nhiá»u tham sá»‘ 1234const foo = (...args) =&gt; console.log('You passed', args)console.log(foo(1, 2, 3)) // You passed[ 1, 2, 3 ]const bar = (x, y, ...rest) =&gt; console.log(rest, x, y) Báº¡n lÆ°u Ã½ biáº¿n args á»Ÿ trÃªn khÃ¡c vá»›i biáº¿n Ä‘áº·c biá»‡t arguments vá»‘n cÃ³ sáºµn bÃªn trong hÃ m. arguments lÃ  má»™t Ä‘á»‘i tÆ°á»£ng giá»‘ng Array, vá»›i nhá»¯ng thuá»™c tÃ­nh Ä‘áº·c biá»‡t nhÆ° callee, trong khi args chá»‰ lÃ  má»™t máº£ng bÃ¬nh thÆ°á»ng. Spread â€“ ráº£i â€“ lÃ  thao tÃ¡c ngÆ°á»£c láº¡i vá»›i rest, giÃºp báº¡n káº¿t há»£p má»™t máº£ng Ä‘Ã£ cÃ³ sáºµn thÃ nh máº£ng má»›i. 123const arr = [3, 4, 5]const newArr = [1, 2, ...arr, 6]console.log(newArr) // [1, 2, 3, 4, 5, 6] Spread ráº¥t há»¯u Ã­ch Ä‘á»ƒ thay tháº¿ cÃ¡c thao tÃ¡c thÃªn máº£ng, nhÆ° .concat(). 123const head = [1, 2]const tail = [3, 4, 5]console.log([...head, ...tail]) // [1, 2, 3, 4, 5] Spread cÅ©ng ráº¥t ngon khi thay tháº¿ cho Function.prototype.apply. 123456const mul = (x, y, z) =&gt; x * y * zconst params = [1, 2, 3]// Thay tháº¿ cho// mul.prototype.apply(null, params)mul(...params) Rest/spread cÅ©ng cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng trÃªn object, tÆ°Æ¡ng tá»± nhÆ° Object.assign(), nhÆ°ng báº¡n lÆ°u Ã½ tÃ­nh nÄƒng váº«n Ä‘ang Ä‘Æ°á»£c Ä‘á» xuáº¥t (proposal). Vá» phÃ­a trÃ¬nh duyá»‡t, cÃ³ Firefox vÃ  Chrome lÃ  há»— trá»£, trong khi Edge vÃ  Safari hoÃ n toÃ n khÃ´ng hoáº¡t Ä‘á»™ng. 123456789101112const user = &#123; name: 'John' &#125;// ES5const userWithAgeEs5 = Object.assign(&#123;&#125;, user, &#123; age: 21 &#125;)// Thá»i Ä‘áº¡i má»›i vá»›i spreadconst userWithAge = &#123; ...user, age: 21 &#125;console.log(userWithAge) // &#123; name: 'John', age: 21 &#125;// VÃ  restconst &#123; name, ...others &#125; = userWithAgeconsole.log(others) // &#123; age: 21 &#125; TÃ­nh tÆ°Æ¡ng thÃ­ch: Trá»« IE11, táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t cÃ²n láº¡i Ä‘á»u há»— trá»£ rest vÃ  spread vá»›i máº£ng hay chuá»—i. Vá»›i spread object, Edge vÃ  Safari chÆ°a há»— trá»£. 7. GiÃ¡ trá»‹ máº·c Ä‘á»‹nh cho tham sá»‘Khi khai bÃ¡o hÃ m, tÃ­nh nÄƒng nÃ y cho phÃ©p báº¡n thiáº¿t láº­p giÃ¡ trá»‹ máº·c Ä‘á»‹nh cá»§a tham sá»‘ khi nÃ³ khÃ´ng Ä‘Æ°á»£c truyá»n giÃ¡ trá»‹ hoáº·c cÃ³ giÃ¡ trá»‹ undefined. 123function getDiscountedPrice(price, discountRate = 0.1) &#123; return price * (1 + discountRate)&#125; DÄ© nhiÃªn báº¡n cÃ³ thá»ƒ dÃ¹ng báº¥t cá»© giÃ¡ trá»‹ nÃ o lÃ m giÃ¡ trá»‹ máº·c Ä‘á»‹nh. 1234567function processItems(items = []) &#123; return items.map(transformItemData)&#125;// hoáº·c dÃ¹ng biáº¿nconst DISCOUNT_RATE = 0.1const getDiscountedPrice = (price, discountRate = DISCOUNT_RATE) =&gt; price * (1 + discountRate) 8. Lá»›p (class)Vá»›i ES5, chÃºng ta sá»­ dá»¥ng function Ä‘á»ƒ táº¡o lá»›p vÃ  thÃªm cÃ¡c phÆ°Æ¡ng thá»©c vÃ o lá»›p báº±ng cÃ¡ch má»Ÿ rá»™ng prototype. 12345678910function Foo(x) &#123; this.x = x&#125;Foo.prototype.add = function(y) &#123; return this.x + y&#125;var f = new Foo(3)console.log(f.add(2)) // 5 ES6 mang Ä‘áº¿n cÃº phÃ¡p má»›i giÃºp táº¡o lá»›p trá»±c tiáº¿p vÃ  dá»… dÃ ng hÆ¡n. 123456789101112131415161718class Foo &#123; constructor(x) &#123; this.x = x &#125; add(y) &#123; return this.x + y &#125; // Khai bÃ¡o phÆ°Æ¡ng thá»©c tÄ©nh (static method) static whoAmI() &#123; return 'I am a Foo class' &#125;&#125;const f = new Foo(3)console.log(f.add(2)) // 5console.log(Foo.whoAmI()) // I am a Foo class Báº¡n cÅ©ng cÃ³ thá»ƒ káº¿ thá»«a tá»« lá»›p khÃ¡c báº±ng tá»« khÃ³a extends. 1234567891011121314class Bar extends Foo &#123; constructor(x, y) &#123; // Gá»i Ä‘áº¿n hÃ m dá»±ng cá»§a lá»›p cha super(x) this.y = y &#125; calculate() &#123; return this.add(4) + this.y &#125;&#125;const f = new Bar(3, 4)console.log(f.calculate()) // 11 NgoÃ i ra vá»›i báº¡n cÅ©ng cÃ³ thá»ƒ dÃ¹ng hÃ m mÅ©i tÃªn khi khai bÃ¡o phÆ°Æ¡ng thá»©c trong lá»›p. Äiá»u nÃ y giÃºp Ä‘áº£m báº£o this luÃ´n trá» Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng hiá»‡n táº¡i. CÃº phÃ¡p nÃ y Ä‘áº·c biá»‡t thÃ´ng dá»¥ng trong cÃ¡c á»©ng dá»¥ng React, tuy nhiÃªn váº«n chÆ°a Ä‘Æ°á»£c há»— trá»£ máº·c Ä‘á»‹nh bá»Ÿi cÃ¡c trÃ¬nh duyá»‡t, nÃªn báº¡n pháº£i dÃ¹ng Babel Ä‘á»ƒ chuyá»ƒn Ä‘á»•i mÃ£ nguá»“n. 12345678910111213class Button extends React.Component &#123; state = &#123; name: 'Fabulous button' &#125; doClick = e =&gt; &#123; e.preventDefault() // 'You clicked Fabulous button' console.log(`You clicked $&#123;this.state.name&#125;`) &#125; render = () =&gt; &#123; return &lt;button onClick=&#123;this.doClick&#125; /&gt; &#125;&#125; TÃ­nh tÆ°Æ¡ng thÃ­ch: Trá»« IE11, táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t cÃ²n láº¡i Ä‘á»u há»— trá»£ lá»›p cÄƒn báº£n. 9. PromiseNáº¿u báº¡n chÆ°a biáº¿t Promise lÃ  gÃ¬ thÃ¬ click vÃ o Ä‘Ã¢y. VÃ¬ Promise Ä‘Ã£ Ä‘Æ°á»£c cÃ´ng nháº­n nhÆ° má»™t pháº§n cá»§a Ä‘áº·c táº£ ECMAScript 6 nÃªn cÃ¡c trÃ¬nh duyá»‡t cÃ³ nghÄ©a vá»¥ pháº£i há»— trá»£ máº·c Ä‘á»‹nh. So vá»›i nhá»¯ng thÆ° viá»‡n chuyÃªn biá»‡t nhÆ° bluebird hay q thÃ¬ phiÃªn báº£n máº·c Ä‘á»‹nh cÃ³ Ã­t tÃ­nh nÄƒng hÆ¡n, nhÆ°ng cÅ©ng vá»«a Ä‘á»§ Ä‘á»ƒ dÃ¹ng. Quan trá»ng lÃ  khÃ´ng cáº§n thÆ° viá»‡n thá»© ba. 1234567891011121314const showUser = user =&gt; console.log(`Your name is $&#123;user.name&#125;`)const getUserData = userId =&gt; new Promise((resolve, reject) =&gt; &#123; return RemoteApi.get(`/users/$&#123;userId&#125;`, (err, response) =&gt; &#123; if (err) return reject(err) resolve(response) &#125;) &#125;)getUserData(123) .then(response =&gt; response.data) .then(showUser) .catch(err =&gt; console.error('Oh no', err)) Promise cÃ²n cÃ³ cÃ¡c hÃ m tÄ©nh khÃ¡c: Promise.all(iterator)Nháº­n vÃ o má»™t máº£ng cÃ¡c promises vÃ  chá»‰ resolve khi táº¥t cáº£ promises trong máº£ng Ä‘Æ°á»£c resolve. Promise.race(iterator)Nháº­n vÃ o má»™t máº£ng cÃ¡c promises vÃ  resolve/reject ngay khi má»™t trong cÃ¡c promises trong máº£ng resolve/reject. Promise.resolve()Tráº£ vá» má»™t promise Ä‘Æ°á»£c tá»± Ä‘á»™ng resolve. Promise.reject()Tráº£ vá» má»™t promise Ä‘Æ°á»£c tá»± Ä‘á»™ng reject. TÃ­nh tÆ°Æ¡ng thÃ­ch: Trá»« IE11, táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t cÃ²n láº¡i Ä‘á»u há»— trá»£. Káº¿tES6 mang Ä‘áº¿n nhá»¯ng tÃ­nh nÄƒng tuyá»‡t vá»i cho láº­p trÃ¬nh viÃªn, giÃºp cho lÃ m viá»‡c vá»›i JavaScript trá»Ÿ nÃªn dá»… thá»Ÿ hÆ¡n, Ä‘á»“ng thá»i nÃ¢ng cao hiá»‡u suáº¥t, cáº£i thiá»‡n mÃ£ nguá»“n vÃ  giáº£m dung lÆ°á»£ng táº­p tin khi truyá»n táº£i trÃªn máº¡ng. Náº¿u á»©ng dá»¥ng cá»§a báº¡n hÆ°á»›ng Ä‘áº¿n cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i, Ä‘á»«ng cháº§n chá» gÃ¬, hÃ£y dÃ¹ng ES6 ngay hÃ´m nay.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Chi phÃ­ cá»§a Javascript","slug":"Chi-phi-cua-Javascript","date":"2018-07-07T08:01:00.000Z","updated":"2018-07-08T09:31:29.960Z","comments":true,"path":"2018/07/Chi-phi-cua-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2018/07/Chi-phi-cua-Javascript.html","excerpt":"Khi cÃ¡c website chÃºng ta xÃ¢y dá»±ng ngÃ y cÃ ng phá»¥ thuá»™c vÃ o JavaScript, thá»‰nh thoáº£ng chÃºng ta cÅ©ng pháº£i tráº£ giÃ¡ cho nhá»¯ng gÃ¬ Ä‘Æ°á»£c gá»­i vá» phÃ­a ngÆ°á»i dÃ¹ng, theo nhá»¯ng cÃ¡ch khÃ´ng dá»… nhÃ¬n tháº¥y . Trong bÃ i viáº¿t nÃ y, tÃ´i sáº½ nÃ³i vá» lÃ½ do táº¡i sao má»™t chÃºt ká»· luáº­t cÃ³ thá»ƒ giÃºp náº¿u báº¡n muá»‘n website cá»§a mÃ¬nh cÃ³ thá»ƒ táº£i vÃ  pháº£n á»©ng má»™t cÃ¡ch nhanh chÃ³ng trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng.","text":"Khi cÃ¡c website chÃºng ta xÃ¢y dá»±ng ngÃ y cÃ ng phá»¥ thuá»™c vÃ o JavaScript, thá»‰nh thoáº£ng chÃºng ta cÅ©ng pháº£i tráº£ giÃ¡ cho nhá»¯ng gÃ¬ Ä‘Æ°á»£c gá»­i vá» phÃ­a ngÆ°á»i dÃ¹ng, theo nhá»¯ng cÃ¡ch khÃ´ng dá»… nhÃ¬n tháº¥y . Trong bÃ i viáº¿t nÃ y, tÃ´i sáº½ nÃ³i vá» lÃ½ do táº¡i sao má»™t chÃºt ká»· luáº­t cÃ³ thá»ƒ giÃºp náº¿u báº¡n muá»‘n website cá»§a mÃ¬nh cÃ³ thá»ƒ táº£i vÃ  pháº£n á»©ng má»™t cÃ¡ch nhanh chÃ³ng trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng. tl;dr: less code = less parse/compile + less transfer + less to decompress DÃ i quÃ¡ ngáº¡i Ä‘á»c: Ã­t mÃ£ lá»‡nh = Ã­t thá»i gian phÃ¢n tÃ¡ch/biÃªn dá»‹ch + Ã­t dung lÆ°á»£ng trao Ä‘á»•i + Ã­t pháº£i giáº£i nÃ©n 1. Káº¿t ná»‘i máº¡ngKhi nghÄ© vá» chi phÃ­ cho JavaScript, háº§u háº¿t cÃ¡c láº­p trÃ¬nh viÃªn nghÄ© vá» máº·t chi phÃ­ táº£i vÃ  thá»±c thi mÃ£ lá»‡nh. Káº¿t ná»‘i Internet cá»§a ngÆ°á»i dÃ¹ng cÃ ng cháº­m thÃ¬ gá»­i nhiá»u bytes JavaScript vá» phÃ­a há» cÃ ng lÃ¢u. Äiá»u nÃ y cÅ©ng cÃ³ thá»ƒ lÃ  má»™t váº¥n Ä‘á» vá»›i cáº£ nhá»¯ng nÆ°á»›c Ä‘Ã£ phÃ¡t triá»ƒn, vÃ¬ káº¿t ná»‘i máº¡ng Ä‘ang sá»­ dá»¥ng cá»§a má»™t ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ khÃ´ng tháº­t sá»± lÃ  3G, 4G hay WiFi. Báº¡n cÃ³ thá»ƒ Ä‘ang vÃ o máº¡ng WiFi cá»§a má»™t quÃ¡n cÃ  phÃª, nhÆ°ng Ä‘ang káº¿t ná»‘i vá»›i má»™t hotspot di Ä‘á»™ng vá»›i tá»‘c Ä‘á»™ 2G. Báº¡n cÃ³ thá»ƒ giáº£m chi phÃ­ truyá»n táº£i JavaScript báº±ng cÃ¡ch: Chá»‰ chuyá»ƒn Ä‘áº¿n ngÆ°á»i dÃ¹ng pháº§n mÃ£ lá»‡nh cáº§n thiáº¿t. Ká»¹ thuáº­t chia mÃ£ (code-splitting) cÃ³ thá»ƒ há»¯u Ã­ch á»Ÿ Ä‘Ã¢y. Tá»‘i giáº£n hÃ³a mÃ£ lá»‡nh (sá»­ dá»¥ng Uglify cho ES5, babel-minify hay uglify-es cho ES2015) NÃ©n mÃ£ lá»‡nh tá»›i má»©c tá»‘i Ä‘a, báº±ng cÃ¡ch dÃ¹ng Brotli ~ q11, Zopfli hay gzip. Brotli hoÃ n toÃ n qua máº·t gzip khi xÃ©t vá» tá»‰ lá»‡ nÃ©n. Giáº£i thuáº­t nÃ y Ä‘Ã£ giÃºp cho CertSimple giáº£m 17% dung lÆ°á»£ng nÃ©n táº­p tin JS, vÃ  LinkedIn tiáº¿t kiá»‡m 4% thá»i gian táº£i. XÃ³a mÃ£ lá»‡nh khÃ´ng dÃ¹ng tá»›i. Vá»›i DevTools code coverage, báº¡n cÃ³ thá»ƒ nháº­n dáº¡ng pháº§n mÃ£ nÃ o khÃ´ng Ä‘Æ°á»£c thá»±c thi. Äá»ƒ loáº¡i bá» mÃ£ nguá»“n khÃ´ng cáº§n thiáº¿t, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t â€œrung cÃ¢yâ€ (tree-shaking) cá»§a Webpack, cÃ¡c ká»¹ thuáº­t tá»‘i Æ°u hÃ³a nÃ¢ng cao cá»§a Closure Compiler, vÃ  cÃ¡c plugin há»— trá»£ tá»‰a tÃ³t mÃ£ lá»‡nh nhÆ° lodash-babel-plugin hay ContextReplacementPlugin cá»§a Webpack dÃ nh cho cÃ¡c thÆ° viá»‡n nhÆ° moment.js. Sá»­ dá»¥ng babel-preset-env vÃ  browserlist Ä‘á»ƒ trÃ¡nh tÃ¬nh tráº¡ng chuyá»ƒn Ä‘á»•i nhá»¯ng tÃ­nh nÄƒng ES2015 Ä‘Ã£ Ä‘Æ°á»£c há»— trá»£ máº·c Ä‘á»‹nh trong cÃ¡c trÃ¬nh duyá»‡t. Nhá»¯ng láº­p trÃ¬nh viÃªn nhiá»u kinh nghiá»‡m cÃ³ thá»ƒ phÃ¢n tÃ­ch cÃ¡c báº£n Ä‘Ã³ng gÃ³i (bundles) cá»§a Webpack vÃ  tÃ¬m cÃ¡ch bá» Ä‘i nhá»¯ng thÆ° viá»‡n phá»¥ thuá»™c khÃ´ng cáº§n thiáº¿t. LÆ°u bá»™ Ä‘á»‡m Ä‘á»ƒ giáº£m táº£i cÃ¡c yÃªu cáº§u máº¡ng. XÃ¡c Ä‘á»‹nh thá»i gian sá»‘ng tá»‘i Æ°u cho cÃ¡c táº­p tin JS (max-age) vÃ  cung cáº¥p cÃ¡c token tháº©m Ä‘á»‹nh (ETag) Ä‘á»ƒ trÃ¡nh pháº£i truyá»n táº£i nhá»¯ng bytes khÃ´ng cáº§n thiáº¿t. LÆ°u bá»™ Ä‘á»‡m báº±ng Service Worker cÃ³ thá»ƒ giÃºp á»©ng dá»¥ng cá»§a báº¡n trá»Ÿ nÃªn chá»§ Ä‘á»™ng hÆ¡n trong trÆ°á»ng há»£p máº¥t káº¿t ná»‘i, Ä‘á»“ng thá»i cho phÃ©p báº¡n truy xuáº¥t Ä‘áº¿n nhá»¯ng tÃ­nh nÄƒng Ä‘áº·c biá»‡t, cháº³ng háº¡n nhÆ° bá»™ Ä‘á»‡m lÆ°u trá»¯ mÃ£ trong V8. HÃ£y tÃ¬m hiá»ƒu vá» lÆ°u Ä‘á»‡m dÃ i háº¡n vá»›i ká»¹ thuáº­t bÄƒm tÃªn táº­p tin (filename hashing). 2. PhÃ¢n tÃ¡ch/BiÃªn dá»‹chSau khi Ä‘Ã£ táº£i, má»™t trong nhá»¯ng chi phÃ­ JavaScript náº·ng ná» nháº¥t lÃ  thá»i gian Ä‘á»ƒ má»™t trÃ¬nh xá»­ lÃ½ JS tiáº¿n hÃ nh phÃ¢n tÃ¡ch/biÃªn dá»‹ch mÃ£ nguá»“n. Trong Chrome DevTools, phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch lÃ  nhá»¯ng pháº§n trong thá»i gian â€œScriptingâ€ mÃ u vÃ ng, cÃ³ thá»ƒ tháº¥y trong báº£ng Performance. Pháº§n Bottom-Up/Call Tree cho phÃ©p xem chÃ­nh xÃ¡c thá»i gian phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch mÃ£: Trong báº£n Performance cá»§a Chrome DevTools, tÃ¬m Ä‘áº¿n pháº§n Bottom-Up. Khi Runtime Call Stats trong V8 Ä‘Æ°á»£c kÃ­ch hoáº¡t, chÃºng ta cÃ³ thá»ƒ tháº¥y thá»i gian cáº§n thiáº¿t cá»§a nhá»¯ng tiáº¿n trÃ¬nh nhÆ° PhÃ¢n TÃ¡ch vÃ  BiÃªn Dá»‹ch NhÆ°ng mÃ , táº¡i sao Ä‘iá»u nÃ y láº¡i quan trá»ng? Máº¥t nhiá»u thá»i gian Ä‘á»ƒ phÃ¢n tÃ¡ch/biÃªn dá»‹ch mÃ£ nguá»“n cÃ³ thá»ƒ lÃ m cháº­m Ä‘i Ä‘Ã¡ng ká»ƒ thá»i gian ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i website. Báº¡n cÃ ng gá»­i xuá»‘ng nhiá»u táº­p tin JavaScript, trÃ¬nh duyá»‡t cÃ ng tá»‘n thá»i gian Ä‘á»ƒ phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch trÆ°á»›c khi website cá»§a báº¡n cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c. Ä‚n byte nÃ o tráº£ byte Ä‘Ã³, JavaScript ngÃ y cÃ ng trá»Ÿ nÃªn Ä‘áº¯t Ä‘á» cho trÃ¬nh duyá»‡t Ä‘á»ƒ xá»­ lÃ½ hÆ¡n lÃ  má»™t bá»©c hÃ¬nh hay web font cÃ³ cÃ¹ng dung lÆ°á»£ng tÆ°Æ¡ng á»©ng â€“ Tom Dale - tÃ¡c giáº£ cá»§a Ember.js So vá»›i JavaScript, cÅ©ng cÃ³ nhiá»u chi phÃ­ tham gia vÃ o quÃ¡ trÃ¬nh xá»­ lÃ½ má»™t bá»©c áº£nh cÃ³ dung lÆ°á»£ng tÆ°Æ¡ng tá»± (chÃºng váº«n cáº§n pháº£i Ä‘Æ°á»£c giáº£i mÃ£!) nhÆ°ng Ä‘á»‘i vá»›i pháº§n cá»©ng cá»§a thiáº¿t bá»‹ di Ä‘á»™ng trung bÃ¬nh, cÃ³ váº» nhÆ° tÃ¡c Ä‘á»™ng cá»§a JS cÃ³ pháº§n tiÃªu cá»±c hÆ¡n Ä‘áº¿n kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c cá»§a website. CÃ¡c byte cá»§a JavaScript vÃ  hÃ¬nh áº£nh cáº§n Ä‘áº¿n nhá»¯ng chi phÃ­ ráº¥t khÃ¡c nhau. HÃ¬nh áº£nh thÆ°á»ng khÃ´ng cháº·n luá»“ng chÃ­nh (main thread) hay ngÄƒn cáº£n tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c giao diá»‡n trong quÃ¡ trÃ¬nh giáº£i mÃ£ vÃ  hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh (rasterization). NgÆ°á»£c láº¡i JS cÃ³ thá»ƒ lÃ m cháº­m quÃ¡ trÃ¬nh tÆ°Æ¡ng tÃ¡c vÃ¬ cÃ¡c chi phÃ­ phÃ¢n tÃ¡ch, biÃªn dá»‹ch vÃ  thá»±c thi. Khi chÃºng ta nÃ³i vá» phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch bá»‹ cháº­m, ngá»¯ cáº£nh ráº¥t quan trá»ng â€“ vÃ¬ á»Ÿ Ä‘Ã¢y chÃºng ta Ä‘ang nÃ³i vá» nhá»¯ng chiáº¿c Ä‘iá»‡n thoáº¡i á»Ÿ phÃ¢n khÃºc trung bÃ¬nh. NgÆ°á»i dÃ¹ng bÃ¬nh dÃ¢n cÃ³ thá»ƒ dÃ¹ng nhá»¯ng thiáº¿t bá»‹ vá»›i CPUs vÃ  GPUs cháº­m cháº¡p, hoÃ n toÃ n khÃ´ng cÃ³ bá»™ Ä‘á»‡m L2/L3 vÃ  tháº­m chÃ­ cÃ²n bá»‹ giá»›i háº¡n bá»™ nhá»›. NÄƒng lá»±c máº¡ng vÃ  nÄƒng lá»±c cá»§a thiáº¿t bá»‹ thÆ°á»ng khÃ´ng Ä‘i chung vá»›i nhau. Má»™t ngÆ°á»i dÃ¹ng sá»­ dá»¥ng káº¿t ná»‘i Fiber siÃªu tá»‘c khÃ´ng nháº¥t thiáº¿t pháº£i cÃ³ CPU tá»‘t nháº¥t Ä‘á»ƒ phÃ¢n tÃ¡ch vÃ  thá»±c thi JavaScript Ä‘Æ°á»£c gá»­i Ä‘áº¿n. Äiá»u ngÆ°á»£c láº¡i cÅ©ng chÃ­nh xÃ¡câ€¦káº¿t ná»‘i cÃ¹i mÃ­a, nhÆ°ng CPU láº¡i nhanh nhÆ° Ä‘iá»‡n. â€“ Kristofer Baxter, LinkedIn. Trong bÃ i JavaScript Start-up Performance, tÃ´i cÃ³ lÆ°u Ã½ vá» chi phÃ­ phÃ¢n tÃ¡ch má»™t táº­p tin JavaScript (Ä‘Æ¡n giáº£n) Ä‘Ã£ Ä‘Æ°á»£c giáº£i nÃ©n cÃ³ dung lÆ°á»£ng khoáº£ng 1MB trÃªn pháº§n cá»©ng bÃ¬nh dÃ¢n vÃ  cao cáº¥p. Thá»i gian phÃ¢n tÃ¡ch/biÃªn tá»‹ch mÃ£ lá»‡nh giá»¯a chiáº¿c Ä‘iá»‡n thoáº¡i nhanh nháº¥t vá»›i chiáº¿c Ä‘iá»‡n thoáº¡i trung bÃ¬nh khÃ¡c nhau tá»« 2 Ä‘áº¿n 5 láº§n. Thá»i gian phÃ¢n tÃ¡ch má»™t báº£n Ä‘Ã³ng gÃ³i JavaScript cÃ³ dung lÆ°á»£ng 1MB (~250KB gzipped) giá»¯a cÃ¡c thiáº¿t bá»‹ mÃ¡y tÃ­nh cÃ¡ nhÃ¢n vÃ  di Ä‘á»™ng thuá»™c nhiá»u dÃ²ng khÃ¡c nhau. Khi nhÃ¬n vÃ o chi phÃ­ cho viá»‡c phÃ¢n tÃ¡ch, chÃºng ta pháº£i xem xÃ©t khi táº­p tin Ä‘Ã£ Ä‘Æ°á»£c giáº£i nÃ©n, cháº³ng háº¡n nhÆ° ~250KB gzipped khi giáº£i nÃ©n thÃ¬ khoáº£ng 1MB. Äá»‘i vá»›i nhá»¯ng trang trong thá»±c táº¿, nhÆ° CNN.com thÃ¬ sao? TrÃªn má»™t chiáº¿c iPhone 8 cao cáº¥p thÃ¬ máº¥t khoáº£ng 4 giÃ¢y Ä‘á»ƒ phÃ¢n tÃ¡ch/biÃªn dá»‹ch JS trÃªn CNN.com, so vá»›i khoáº£ng 13 giÃ¢y cho má»™t chiáº¿c Ä‘iá»‡n thoáº¡i bÃ¬nh dÃ¢n (Moto G4). Äiá»u nÃ y cÃ³ thá»ƒ tÃ¡c Ä‘á»™ng rÃµ rÃ ng Ä‘áº¿n kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng vá»›i website. So sÃ¡nh thá»i gian phÃ¢n tÃ¡ch mÃ£ nguá»“n trÃªn chip A11 Bionic cá»§a Apple vá»›i Snapdragon 617 trÃªn cÃ¡c thiáº¿t bá»‹ Android bÃ¬nh dÃ¢n Äiá»u nÃ y nÃªu báº­t táº§m quan trá»ng cá»§a viá»‡c kiá»ƒm thá»­ á»©ng dá»¥ng trÃªn cÃ¡c pháº§n cá»©ng trung bÃ¬nh (nhÆ° chiáº¿c Moto G4) thay vÃ¬ chiáº¿c Ä‘iá»‡n thoáº¡i trong tÃºi cá»§a báº¡n. NÃ³i gÃ¬ thÃ¬ nÃ³i, ngá»¯ cáº£nh cÅ©ng quan trá»ng: tá»‘i Æ°u hÃ³a cho thiáº¿t bá»‹ vÃ  Ä‘iá»u kiá»‡n káº¿t ná»‘i mÃ  ngÆ°á»i dÃ¹ng cá»§a báº¡n cÃ³. CÃ¡c á»©ng dá»¥ng phÃ¢n tÃ­ch thá»‘ng kÃª (analytics) cÃ³ thá»ƒ Ä‘Æ°a ra má»™t cÃ¡i nhÃ¬n vá» dÃ²ng thiáº¿t bá»‹ di Ä‘á»™ng mÃ  ngÆ°á»i dÃ¹ng thá»±c táº¿ cá»§a báº¡n Ä‘ang sá»­ dá»¥ng. ThÃ´ng tin nÃ y Ä‘em Ä‘áº¿n cÆ¡ há»™i Ä‘á»ƒ hiá»ƒu hÆ¡n vá» cÃ¡c Ä‘iá»u kiá»‡n giá»›i háº¡n cá»§a CPU/GPU trÃªn cÃ¡c thiáº¿t bá»‹ Ä‘Ã³. MÃ  cÃ³ tháº­t lÃ  chÃºng ta Ä‘ang gá»­i xuá»‘ng ngÆ°á»i dÃ¹ng quÃ¡ nhiá»u JavaScript khÃ´ng? HÃªn xui :) Báº±ng cÃ¡ch sá»­ dá»¥ng HTTP Archive (vá»›i khoáº£ng 500K websites) Ä‘á»ƒ phÃ¢n tÃ­ch hiá»‡n tráº¡ng JavaScript trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng 50% website cáº§n Ä‘áº¿n hÆ¡n 14 giÃ¢y Ä‘á»ƒ cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c. Nhá»¯ng trang nÃ y bá» ra Ä‘áº¿n hÆ¡n 4 giÃ¢y chá»‰ Ä‘á»ƒ phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch JS. Thá»i gian Ä‘á»ƒ táº£i vÃ  xá»­ lÃ½ JS vÃ  cÃ¡c tÃ i nguyÃªn khÃ¡c Ä‘Ã³ng má»™t vai trÃ² á»Ÿ Ä‘Ã¢y, vÃ  cÃ³ láº½ khÃ´ng quÃ¡ ngáº¡c nhiÃªn khi ngÆ°á»i dÃ¹ng pháº£i chá» má»™t lÃºc trÆ°á»›c khi cáº£m giÃ¡c website Ä‘Ã£ cÃ³ thá»ƒ sá»­ dá»¥ng. RÃµ rÃ ng chÃºng ta cÃ³ thá»ƒ lÃ m tá»‘t hÆ¡n. Loáº¡i bá» nhá»¯ng pháº§n JavaScript khÃ´ng quan trá»ng trong trang cÃ³ thá»ƒ giáº£m thiá»ƒu thá»i gian truyá»n táº£i, quÃ¡ trÃ¬nh phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch vá»‘n ngá»‘n CPU, vÃ  cáº£ viá»‡c ngá»‘n bá»™ nhá»›. NÃ³ cÅ©ng lÃ m cho website trá»Ÿ nÃªn cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c nhanh hÆ¡n. 3. Thá»i gian thá»±c thiChi phÃ­ khÃ´ng chá»‰ náº±m á»Ÿ quÃ¡ trÃ¬nh phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch. QuÃ¡ trÃ¬nh thá»±c thi JavaScript (cháº¡y mÃ£ lá»‡nh sau khi Ä‘Ã£ phÃ¢n tÃ¡ch/biÃªn dá»‹ch) lÃ  má»™t trong nhá»¯ng thao tÃ¡c pháº£i xáº£y ra trong luá»“ng chÃ­nh. Thá»i gian thá»±c thi quÃ¡ lÃ¢u cÃ³ thá»ƒ lÃ m trÃ¬ hoÃ£n thá»i gian ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i website. If script executes for more than 50ms, time-to-interactive is delayed by the entire amount of time it takes to download, compile, and execute the JS â€” Alex Russell Náº¿u má»™t Ä‘oáº¡n mÃ£ pháº£i thá»±c thi trong hÆ¡n 50ms, thá»i gian Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c bá»‹ trÃ¬ hoÃ£n báº±ng nguyÃªn cáº£ thá»i gian cáº§n thiáº¿t Ä‘á»ƒ táº£i, biÃªn dá»‹ch vÃ  thá»±c thi JS â€“ Alex Russell Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, JavaScript táº­n dá»¥ng kháº£ nÄƒng chia nhá» thÃ nh tá»«ng pháº§n (small chunks) Ä‘á»ƒ trÃ¡nh khÃ´ng khÃ³a hoÃ n toÃ n luá»“ng chÃ­nh. Báº¡n hÃ£y tÃ¬m hiá»ƒu Ä‘á»ƒ xem cÃ³ thá»ƒ giáº£m thiá»ƒu cÃ´ng viá»‡c trong quÃ¡ trÃ¬nh thá»±c thi hay khÃ´ng. 4. Má»™t sá»‘ khuÃ´n máº«u Ä‘á»ƒ giáº£m thiá»ƒu chi phÃ­ truyá»n táº£i JavaScriptKhi báº¡n Ä‘ang tÃ¬m cÃ¡ch Ä‘á»ƒ giáº£m thiá»ƒu thá»i gian truyá»n táº£i, phÃ¢n tÃ¡ch vÃ  biÃªn dá»‹ch JavaScript, cÃ³ vÃ i khuÃ´n máº«u cÃ³ thá»ƒ há»¯u Ã­ch, nhÆ° ká»¹ thuáº­t chia nhá» theo Ä‘á»‹nh tuyáº¿n (route-based chunking) hay cÃ²n gá»i lÃ  PRPL. PRPL lÃ  má»™t ká»¹ thuáº­t Ä‘á»ƒ tá»‘i Æ°u hÃ³a kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c trÃªn website báº±ng cÃ¡ch chia nhá» mÃ£ nguá»“n vÃ  lÆ°u bá»™ Ä‘á»‡m má»™t cÃ¡ch quyáº¿t liá»‡t. HÃ£y xem nhá»¯ng tÃ¡c Ä‘á»™ng nÃ³ cÃ³ thá»ƒ mang láº¡i. ChÃºng ta phÃ¢n tÃ­nh thá»i gian táº£i cá»§a nhá»¯ng trang web di Ä‘á»™ng thÃ´ng dá»¥ng vÃ  cÃ¡c á»©ng dá»¥ng web tÄƒng tiáº¿n (Progressive Web Apps â€“ PWAs) báº±ng cÃ¡ch sá»­ dá»¥ng Runtime Call Stats trong V8. NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, thá»i gian phÃ¢n tÃ¡ch (pháº§n mÃ u cam) chiáº¿m má»™t pháº§n lá»›n trong tá»•ng thá»i gian cá»§a cÃ¡c website nÃ y. Wego, má»™t trang sá»­ dá»¥ng PRPL, xoay xá»Ÿ Ä‘á»ƒ giá»¯ cho thá»i gian phÃ¢n tÃ¡ch á»Ÿ má»©c tháº¥p, giÃºp cho website cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c nhanh hÆ¡n. Nhá»¯ng trang cÃ²n láº¡i cÅ©ng Ä‘Ã£ thá»±c hiá»‡n ká»¹ thuáº­t chia mÃ£ vÃ  dá»± toÃ¡n hiá»‡u suáº¥t (performance budgeting) Ä‘á»ƒ giáº£m chi phÃ­ JS. 5. Nhá»¯ng chi phÃ­ khÃ¡cJavaScript cÅ©ng cÃ³ thá»ƒ tÃ¡c Ä‘á»™ng Ä‘áº¿n hiá»‡u suáº¥t cá»§a website theo nhá»¯ng hÆ°á»›ng khÃ¡c: Bá»™ nhá»›. Website cÃ³ thá»ƒ cáº£m tháº¥y bá»‹ giá»±t (jank) hay táº¡m dá»«ng thÆ°á»ng xuyÃªn do bá»™ gom rÃ¡c (garbage collector - GC) hoáº¡t Ä‘á»™ng. Khi trÃ¬nh duyá»‡t tiáº¿n hÃ nh thu há»“i bá»™ nhá»›, quÃ¡ trÃ¬nh thá»±c thi JS bá»‹ táº¡m dá»«ng. Do Ä‘Ã³ khi trÃ¬nh duyá»‡t thu há»“i bá»™ nhá»› quÃ¡ thÆ°á»ng xuyÃªn, tiáº¿n trÃ¬nh JS cÅ©ng bá»‹ dá»«ng liÃªn tá»¥c hÆ¡n chÃºng ta mong muá»‘n. Láº­p trÃ¬nh viÃªn cáº§n trÃ¡nh bá»‹ rÃ² rá»‰ bá»™ nhá»› vÃ  tiáº¿n trÃ¬nh dá»«ng cá»§a GC Ä‘á»ƒ website cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh hÆ¡n. Trong quÃ¡ trÃ¬nh cháº¡y, mÃ£ JavaScript cháº¡y quÃ¡ lÃ¢u cÃ³ thá»ƒ khÃ³a luá»“ng chÃ­nh, lÃ m cho website trá»Ÿ nÃªn khÃ´ng tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c. Báº±ng cÃ¡ch chia nhá» cÃ´ng viá»‡c ra thÃ nh tá»«ng pháº§n (sá»­ dá»¥ng requestAnimationFrame() hay requestIdleCallback() Ä‘á»ƒ phÃ¢n lá»‹ch) cÃ³ thá»ƒ giÃºp giáº£m thiá»ƒu cÃ¡c váº¥n Ä‘á» vá» tÆ°Æ¡ng tÃ¡c. 6. Ká»¹ thuáº­t Khá»Ÿi Ä‘á»™ng TÄƒng tiáº¿n (progressive bootstrapping)Nhiá»u website xem tÃ­nh áº©n hiá»‡n cá»§a ná»™i dung trÃªn trang lÃ  má»™t chi phÃ­ Ä‘áº¯t Ä‘á» khi tá»‘i Æ°u hÃ³a tÃ­nh tÆ°Æ¡ng tÃ¡c. Äá»ƒ cÃ³ thá»ƒ thá»±c hiá»‡n tiáº¿n trÃ¬nh váº½ Ä‘áº§u tiÃªn (first paint) má»™t cÃ¡ch nhanh chÃ³ng, láº­p trÃ¬nh viÃªn thÆ°á»ng sá»­ dá»¥ng ká»¹ thuáº­t táº¡o ná»™i dung trÆ°á»›c á»Ÿ phÃ­a server (server-side rendering - SSR), sau Ä‘Ã³ â€œnÃ¢ng cáº¥pâ€ báº±ng cÃ¡ch gáº¯n cÃ¡c hÃ m xá»­ lÃ½ sá»± kiá»‡n sau khi JavaScript Ä‘Ã£ Ä‘Æ°á»£c táº£i vá». NhÆ°ng hÃ£y cáº©n tháº­n â€“ ká»¹ thuáº­t nÃ y cÅ©ng cÃ³ chi phÃ­ riÃªng cá»§a nÃ³. Báº¡n 1) nhÃ¬n chung sáº½ gá»­i xuá»‘ng má»™t táº­p tin HTML náº·ng kÃ½ hÆ¡n vÃ  cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n tÃ­nh tÆ°Æ¡ng tÃ¡c cá»§a site, hoáº·c 2) cÃ³ thá»ƒ Ä‘Æ°a ngÆ°á»i dÃ¹ng vÃ o má»™t vÃ¹ng thung lÅ©ng huyá»n bÃ­ (uncanny valley) nÆ¡i má»™t ná»­a tráº£i nghiá»‡m khÃ´ng tháº­t sá»± cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c, cho Ä‘áº¿n khi JavaScript hoÃ n táº¥t quÃ¡ trÃ¬nh xá»­ lÃ½. Ká»¹ thuáº­t Khá»Ÿi Ä‘á»™ng TÄƒng tiáº¿n cÃ³ thá»ƒ lÃ  má»™t hÆ°á»›ng tiáº¿p cáº­n tá»‘t hÆ¡n. Báº¡n chá»‰ cáº§n gá»­i xuá»‘ng má»™t trang vá»«a Ä‘á»§ cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng, bao gá»“m chá»‰ HTML/JS/CSS cáº§n thiáº¿t cho Ä‘á»‹nh tuyáº¿n hiá»‡n táº¡i. Khi cÃ¡c tÃ i nguyÃªn khÃ¡c Ä‘Ã£ Ä‘Æ°á»£c táº£i xong, á»©ng dá»¥ng cÃ³ thá»ƒ lazy-load vÃ o vÃ  má»Ÿ ra cÃ¡c chá»©c nÄƒng khÃ¡c. Ká»¹ thuáº­t táº£i mÃ£ lá»‡nh tÆ°Æ¡ng á»©ng vá»›i nhá»¯ng gÃ¬ Ä‘ang Ä‘Æ°á»£c hiá»ƒn thá»‹ chÃ­nh lÃ  cá»©u cÃ¡nh. PRPL vÃ  Khá»Ÿi Ä‘á»™ng TÄƒng tiáº¿n lÃ  hai khuÃ´n máº«u giÃºp Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu nÃ y. Káº¿t luáº­nKÃ­ch thÆ°á»›c táº­p tin khi truyá»n táº£i ráº¥t quan trá»ng Ä‘á»‘i vá»›i nhá»¯ng káº¿t ná»‘i máº¡ng cáº¥p tháº¥p. Thá»i gian phÃ¢n tÃ¡ch mÃ£ nguá»“n láº¡i quan trá»ng Ä‘á»‘i vá»›i nhá»¯ng thiáº¿t bá»‹ cÃ³ giá»›i háº¡n vá» CPU. ChÃºng ta cáº§n pháº£i giá»¯ cho cÃ¡c chá»‰ sá»‘ nÃ y á»Ÿ má»©c tháº¥p. Nhiá»u nhÃ³m phÃ¡t triá»ƒn Ä‘Ã£ thÃ nh cÃ´ng trong viá»‡c lÃ m theo cÃ¡c dá»± toÃ¡n hiá»‡u suáº¥t nghiÃªm ngáº·t, Ä‘á»ƒ giáº£m thiá»ƒu thá»i gian truyá»n táº£i vÃ  phÃ¢n tÃ¡ch/biÃªn dá»‹ch. Báº¡n cÃ³ thá»ƒ xem hÆ°á»›ng dáº«n â€œCan You Afford It?: Real-world Web Performance Budgetsâ€ cá»§a Alex Russell vá» dá»± toÃ¡n hiá»‡u suáº¥t cho cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng. Náº¿u báº¡n Ä‘ang phÃ¡t triá»ƒn má»™t website hÆ°á»›ng Ä‘áº¿n cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng, hÃ£y cá»‘ gáº¯ng háº¿t sá»©c Ä‘á»ƒ xÃ¢y dá»±ng nÃ³ trÃªn pháº§n cá»©ng tiÃªu biá»ƒu, giá»¯ cho thá»i gian phÃ¢n tÃ¡ch/biÃªn dá»‹ch JavaScript á»Ÿ má»©c tháº¥p, vÃ  thu nháº­n má»™t dá»± toÃ¡n hiá»‡u suáº¥t Ä‘á»ƒ cháº¯c cháº¯n ráº±ng nhÃ³m cá»§a báº¡n luÃ´n theo sÃ¡t chi phÃ­ JavaScript. TÃ¬m hiá»ƒu thÃªm BÃ i nÃ³i chuyá»‡n cá»§a tÃ´i á»Ÿ Chrome Dev Summit 2017 vá» chi phÃ­ cho JavaScript. Pháº§n sau cá»§a bÃ i nÃ³i cÃ³ nháº¯c Ä‘áº¿n nhá»¯ng vÃ­ dá»¥ thá»±c táº¿ tá»« cÃ¡c trang nhÆ° Pinterest hay Tinder. JavaScript Start-up Performance Solving the web performance crisis â€” Nolan Lawson Can you afford it? Real-world performance budgets â€” Alex Russell Evaluating web frameworks and libraries â€” Kristofer Baxter Káº¿t quáº£ thá»­ nghiá»‡m cá»§a Cloudflare cho giáº£i thuáº­t nÃ©n Brotli (lÆ°u Ã½ lÃ  nÃ©n Brotli Ä‘á»™ng á»Ÿ cháº¥t lÆ°á»£ng cao cÃ³ thá»ƒ lÃ m cháº­m quÃ¡ trÃ¬nh hiá»ƒn thá»‹ trang láº§n Ä‘áº§u tiÃªn nÃªn báº¡n cáº§n Ä‘Ã¡nh giÃ¡ má»™t cÃ¡ch tháº­n trá»ng. CÃ³ khi báº¡n sáº½ muá»‘n nÃ©n theo phÆ°Æ¡ng phÃ¡p tÄ©nh hÆ¡n.) Performance Futures â€” Sam Saccone ChÃ¢n thÃ nh cÃ¡m Æ¡n Nolan Lawson, Kristofer Baxter vÃ  Jeremy Wagner vÃ¬ nhá»¯ng pháº£n há»“i cá»§a má»i ngÆ°á»i.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"10 máº¹o CSS há»¯u Ã­ch báº¡n nÃªn biáº¿t","slug":"10-meo-CSS-huu-ich-ban-nen-biet","date":"2018-06-27T01:01:00.000Z","updated":"2018-06-27T01:11:20.866Z","comments":true,"path":"2018/06/10-meo-CSS-huu-ich-ban-nen-biet.html","link":"","permalink":"http://nthung2112.github.io/2018/06/10-meo-CSS-huu-ich-ban-nen-biet.html","excerpt":"Pagespeed Optimization (tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™ trang) lÃ  má»™t cÃ´ng viá»‡c mÃ  háº§u nhÆ° má»i Web developer Ä‘á»u quan tÃ¢m vÃ  nÃªn biáº¿t, má»¥c Ä‘Ã­ch cá»§a nÃ³ lÃ  Ä‘Æ°a ná»™i dung website Ä‘áº¿n vá»›i ngÆ°á»i xem nhanh nháº¥t cÃ³ thá»ƒ. Front-end developer thÆ°á»ng lÃ m viá»‡c vá»›i HTML, CSS, Javascript vÃ  cÃ¡c hÃ¬nh áº£nh. Do Ä‘Ã³, Ä‘Ã¢y cÅ©ng lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng chÃ­nh Ä‘á»ƒ chÃºng ta tá»‘i Æ°u tá»‘c Ä‘á»™ táº£i trang cho website. Tá»‘c Ä‘á»™ táº£i trang cá»§a website ngoÃ i cÃ¡c yáº¿u tá»‘ liÃªn quan do server thÃ¬ cÃ²n phá»¥ thuá»™c vÃ o kÃ­ch thÆ°á»›c vÃ  sá»‘ lÆ°á»£ng file pháº£i táº£i vá», do Ä‘Ã³ cÃ ng giáº£m Ä‘Æ°á»£c kÃ­ch thÆ°á»›c file láº«n sá»‘ lÆ°á»£ng file cáº§n pháº£i táº£i vá» thÃ¬ cÅ©ng Ä‘á»“ng thá»i tÄƒng tá»‘c Ä‘á»™ táº£i file vÃ  giáº£m sá»‘ lÆ°á»£ng request lÃªn server.","text":"Pagespeed Optimization (tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™ trang) lÃ  má»™t cÃ´ng viá»‡c mÃ  háº§u nhÆ° má»i Web developer Ä‘á»u quan tÃ¢m vÃ  nÃªn biáº¿t, má»¥c Ä‘Ã­ch cá»§a nÃ³ lÃ  Ä‘Æ°a ná»™i dung website Ä‘áº¿n vá»›i ngÆ°á»i xem nhanh nháº¥t cÃ³ thá»ƒ. Front-end developer thÆ°á»ng lÃ m viá»‡c vá»›i HTML, CSS, Javascript vÃ  cÃ¡c hÃ¬nh áº£nh. Do Ä‘Ã³, Ä‘Ã¢y cÅ©ng lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng chÃ­nh Ä‘á»ƒ chÃºng ta tá»‘i Æ°u tá»‘c Ä‘á»™ táº£i trang cho website. Tá»‘c Ä‘á»™ táº£i trang cá»§a website ngoÃ i cÃ¡c yáº¿u tá»‘ liÃªn quan do server thÃ¬ cÃ²n phá»¥ thuá»™c vÃ o kÃ­ch thÆ°á»›c vÃ  sá»‘ lÆ°á»£ng file pháº£i táº£i vá», do Ä‘Ã³ cÃ ng giáº£m Ä‘Æ°á»£c kÃ­ch thÆ°á»›c file láº«n sá»‘ lÆ°á»£ng file cáº§n pháº£i táº£i vá» thÃ¬ cÅ©ng Ä‘á»“ng thá»i tÄƒng tá»‘c Ä‘á»™ táº£i file vÃ  giáº£m sá»‘ lÆ°á»£ng request lÃªn server.á» bÃ i nÃ y mÃ¬nh sáº½ giá»›i thiá»‡u vá»›i cÃ¡c báº¡n 10 máº¹o CSS há»¯u Ã­ch giÃºp giáº£m kÃ­ch thÆ°á»›c, sá»‘ lÆ°á»£ng file CSS, tá»‘i Æ°u file CSS vÃ  phÃ¡t triá»ƒn CSS dá»… dÃ ng hÆ¡n, ná»™i dung bÃ i gá»“m nhá»¯ng pháº§n sau: Háº¡n cháº¿ sá»­ dá»¥ng @import Sá»­ dá»¥ng cÃ¡ch viáº¿t ngáº¯n gá»n (shorthand properties) Khai bÃ¡o class bá»• trá»£ (Helper classes) Háº¡n cháº¿ sá»­ dá»¥ng CSS trong element cá»§a HTML (inline CSS attributes in HTML elements) Giáº£m sá»‘ lÆ°á»£ng file CSS (Combine external CSS) Giáº£m kÃ­ch thÆ°á»›c file CSS Ãp dá»¥ng OOCSS (Object Oriented CSS) Äáº·t tÃªn class vÃ  id má»™t cÃ¡ch khoa há»c NgÃ´n ngá»¯ tiá»n xá»­ lÃ½ CSS (CSS Preprocessor) Sá»­ dá»¥ng Koala-app khi lÃ m viá»‡c vá»›i CSS 1. Háº¡n cháº¿ sá»­ dá»¥ng @importHáº¡n cháº¿ sá»­ dá»¥ng @import hoáº·c tá»‘t nháº¥t lÃ  khÃ´ng nÃªn sá»­ dá»¥ng @import trong file CSS, vÃ¬ nÃ³ sáº½ lÃ m cháº­m quÃ¡ trÃ¬nh táº£i vÃ  khÃ´ng sá»­ dá»¥ng Ä‘Æ°á»£c kháº£ nÄƒng táº£i file Ä‘á»“ng thá»i cá»§a browser. Äá»ƒ dá»… hiá»ƒu báº¡n hÃ£y xem vÃ­ dá»¥ sau: MÃ¬nh cÃ³ 2 file CSS lÃ  a.css vÃ  b.css Ä‘Æ°á»£c nhÃºng vÃ o trang web nhÆ° sau: 12&lt;link rel='stylesheet' type='text/css' href='a.css'&gt;&lt;link rel='stylesheet' type='text/css' href='b.css'&gt; Trong file b.css, báº¡n import file c.css: 1@import url(c.css); Káº¿t quáº£ khi browser táº£i trang sáº½ nhÆ° tháº¿ nÃ y: HTML downloada.cssb.cssc.css ChÃº thÃ­ch: Request 1: browser gá»­i request Ä‘á»ƒ láº¥y HTML vá» Request 2: browser gá»­i request Ä‘á»ƒ láº¥y a.css Request 3: browser gá»­i request Ä‘á»ƒ láº¥y b.css Request 4: browser gá»­i request Ä‘á»ƒ láº¥y c.css NhÆ° cÃ¡c báº¡n tháº¥y á»Ÿ hÃ¬nh trÃªn, Ä‘á»ƒ táº£i Ä‘Æ°á»£c c.css thÃ¬ browser pháº£i chá» Ä‘á»ƒ táº£i xong a.css. LÃ½ do: VÃ¬ browser khi Ä‘Ã£ táº£i xong b.css vÃ  báº¯t Ä‘áº§u Ä‘á»c ná»™i dung bÃªn trong thÃ¬ tháº¥y @import yÃªu cáº§u pháº£i táº£i thÃªm c.css, lÃºc nÃ y browser pháº£i Ä‘á»©ng chá» cho nhÃ³m proccess trÆ°á»›c Ä‘Ã³ cháº¡y xong (trong trÆ°á»ng há»£p nÃ y lÃ  chá» a.css) thÃ¬ má»›i báº¯t Ä‘áº§u táº£i tiáº¿p c.css vÃ  tiáº¿p tá»¥c render sau khi Ä‘Ã£ táº£i xong. Trong khi Ä‘Ã³ náº¿u báº¡n loáº¡i bá» @import url(c.css) trong b.css Ä‘i vÃ  nhÃºng trá»±c tiáº¿p c.css vÃ o trang HTML 123&lt;link rel='stylesheet' type='text/css' href='a.css'&gt;&lt;link rel='stylesheet' type='text/css' href='b.css'&gt;&lt;link rel='stylesheet' type='text/css' href='c.css'&gt; thÃ¬ báº¡n sáº½ cÃ³ káº¿t quáº£ nhÆ° sau: HTML downloada.cssb.cssc.css LÃºc nÃ y browser sáº½ báº¯t Ä‘áº§u táº£i file Ä‘á»“ng thá»i khÃ´ng cáº§n pháº£i chá» cho a.css táº£i xong, sáº½ rÃºt ngáº¯n Ä‘Æ°á»£c thá»i gian táº£i file xuá»‘ng. NhÆ° tiÃªu Ä‘á» mÃ¬nh nÃ³i ráº±ng nÃªn Háº¡n cháº¿ sá»­ dá»¥ng @import, váº­y má»™t cÃ¢u há»i nhá» Ä‘áº·t ra lÃ  khi nÃ o thÃ¬ nÃªn dÃ¹ng @import?. Theo mÃ¬nh thÃ¬ khi nhá»¯ng Ä‘á»‹nh nghÄ©a CSS cáº§n lá»‡ thuá»™c vÃ o má»™t Ä‘á»‹nh nghÄ©a á»Ÿ file CSS khÃ¡c trÆ°á»›c â€“ thÃ¬ khi Ä‘Ã³ nÃªn dÃ¹ng @import, vÃ­ dá»¥ báº¡n sá»­ dá»¥ng cÃ¡c bá»™ thÆ° viá»‡n reset CSS nhÆ° Normalize.css, báº¡n cáº§n reset táº¥t cáº£ cÃ¡c Ä‘á»‹nh nghÄ©a CSS vá» má»™t chuáº©n chung trÆ°á»›c khi viáº¿t Ä‘á»‹nh nghÄ©a CSS tiáº¿p theo â€“ lÃºc nÃ y báº¡n sáº½ dÃ¹ng @import Ä‘á»ƒ import file Normalize.css vÃ o trong file Ä‘á»‹nh nghÄ©a CSS cá»§a báº¡n, lÃ½ do sá»­ dá»¥ng @import á»Ÿ Ä‘Ã¢y lÃ  Ä‘á»ƒ trÃ¡nh cÆ¡ cháº¿ táº£i file Ä‘á»“ng thá»i cá»§a browser vÃ  báº¯t buá»™c browser pháº£i táº£i vÃ  Ã¡p Ä‘á»‹nh nghÄ©a CSS cá»§a Normalize.css trÆ°á»›c rá»“i má»›i Ä‘áº¿n cÃ¡c Ä‘á»‹nh nghÄ© CSS á»Ÿ bÃªn dÆ°á»›i @import. Má»™t cÃ¢u há»i tiáº¿p theo Náº¿u nháº¥t thiáº¿t pháº£i dÃ¹ng @import nhÆ° vÃ­ dá»¥ trÃªn, thÃ¬ cÃ¡c nÃ o khÃ¡c Ä‘á»ƒ giáº£i quyáº¿t thay vÃ¬ dÃ¹ng @import hay khÃ´ng?. Táº¥t nhiÃªn lÃ  cÃ³ cÃ¡ch, Ä‘Ã³ lÃ  báº¡n copy toÃ n bá»™ ná»™i dung cá»§a file Normalize.css vÃ o trong file CSS cá»§a báº¡n, hay cÃ²n gá»i lÃ  Combine external CSS mÃ¬nh sáº½ giá»›i thiá»‡u phÃ­a bÃªn dÆ°á»›i. 2. Sá»­ dá»¥ng cÃ¡ch viáº¿t ngáº¯n gá»nSá»­ dá»¥ng cÃ¡ch viáº¿t ngáº¯n gá»n (shorthand properties) Ä‘á»ƒ dá»… dÃ ng thiáº¿t láº­p má»™t sá»‘ thuá»™c tÃ­nh chá»‰ trÃªn má»™t dÃ²ng, Ä‘Ã¢y cÅ©ng lÃ  má»™t cÃ¡ch Ä‘á»ƒ báº¡n dá»… dÃ ng kiá»ƒm soÃ¡t â€“ theo dÃµi code cá»§a mÃ¬nh, Ä‘á»“ng thá»i cÅ©ng há»— trá»£ giáº£m sá»‘ lÆ°á»£ng kÃ½ tá»± trong file css vÃ  giáº£m kÃ­ch thÆ°á»›c file. Láº¥y vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» cÃ¡ch thiáº¿t láº­p thuá»™c tÃ­nh hÃ¬nh áº£nh cho background 12345background-color:#000;background-image:url(bg-image.jpg);background-repeat:no-repeat;background-attachment:fixed;background-position:center center; Báº¡n cÃ³ thá»ƒ viáº¿t thÃ nh 1background:#000 url(bg-image.jpg) no-repeat fixed center center; Cáº¥u trÃºc shorthand cá»§a thuá»™c tÃ­nh background nhÆ° sau 1background: &lt;color&gt; &lt;image&gt; &lt;repeat&gt; &lt;attachment&gt; &lt;position&gt;; NgoÃ i background thÃ¬ cÃ²n cÃ³ má»™t sá»‘ thuá»™c tÃ­nh khÃ¡c cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng shorthand nhÆ° margin, padding, border, outline, â€¦ báº¡n cÃ³ thá»ƒ tham kháº£o thÃªm trÃªn Mozilla Developer Network (MDN). á» cuá»‘i trang nÃ y cÃ³ danh sÃ¡ch cÃ¡c thuá»™c tÃ­nh cÃ³ thá»ƒ Ã¡p dá»¥ng shorthand. BÃªn cáº¡nh Ä‘Ã³, náº¿u báº¡n thÃ­ch khai bÃ¡o mÃ£ mÃ u HEX thÃ¬ Ä‘á»‘i vá»›i má»™t sá»‘ mÃ£ mÃ u thÃ´ng dá»¥ng báº¡n cÅ©ng cÃ³ thá»ƒ viáº¿t ngáº¯n gá»n láº¡i vÃ­ dá»¥ nhÆ° #FFF thay cho #FFFFFF hay #000 thay cho #000000. Báº¡n cÃ³ thá»ƒ tham kháº£o cÃ¡ch chuyá»ƒn Ä‘á»•i táº¡i CSS Color Converter. 3. Khai bÃ¡o class bá»• trá»£Class bá»• trá»£ (Helper classes) lÃ  nhá»¯ng class Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a sáºµn má»™t sá»‘ thuá»™c tÃ­nh Ä‘Æ¡n giáº£n vÃ  thÆ°á»ng hay sá»­ dá»¥ng. VÃ­ dá»¥ nhÆ° text-align, font-weight, colorâ€¦ Class bá»• trá»£ trong quÃ¡ trÃ¬nh viáº¿t HTML cÃ¡c báº¡n chá»‰ cáº§n thÃªm class Ä‘Ã³ vÃ o mÃ  khÃ´ng cáº§n pháº£i Ä‘á»‹nh nghÄ©a láº¡i thuá»™c tÃ­nh. CÃ¡ch lÃ m nÃ y khÃ¡ há»¯u dá»¥ng khi báº¡n sá»­ dá»¥ng má»™t CSS framework vÃ  cáº§n custom â€œráº¥t Ã­tâ€ thuá»™c tÃ­nh, hoáº·c báº¡n khÃ´ng chá»n Ä‘Æ°á»£c tÃªn class phÃ¹ há»£p cho element Ä‘Ã³, hay element Ä‘Ã³ khÃ´ng cáº§n xÃ¡c Ä‘á»‹nh class Ä‘á»ƒ lÃ m gÃ¬ Ä‘Ã³ vá»›i javascript. Äiá»ƒm lá»£i cá»§a viá»‡c nÃ y ngoÃ i viá»‡c báº¡n khÃ´ng cáº§n Ä‘á»‹nh nghÄ©a láº¡i má»™t sá»‘ thuá»™c tÃ­nh khÃ´ng cáº§n thiáº¿t, thÃ¬ náº¿u CSS cÃ ng nhiá»u thÃ¬ báº¡n sáº½ tiáº¿t kiá»‡m Ä‘Æ°á»£c khÃ¡ nhiá»u thuá»™c tÃ­nh cáº§n khai bÃ¡o láº¡i vÃ  sáº½ giáº£m Ä‘Æ°á»£c kÃ­ch thÆ°á»›c file CSS. VÃ­ dá»¥: MÃ¬nh cÃ³ cÃ¡c element sau cáº§n viáº¿t CSS vÃ  mÃ¬nh Ä‘ang dÃ¹ng framework bootstrap: 12345&lt;p class=\"text-center\"&gt; &lt;button type=\"button\" class=\"btn btn-success btn-md text-uppercase\"&gt; Show More &lt;/button&gt;&lt;/p&gt; Thay vÃ¬ mÃ¬nh cáº§n pháº£i viáº¿t CSS nhÆ° sau Ä‘á»ƒ custom láº¡i theo Ã½ mÃ¬nh 12p &#123; text-align: center; padding-top: 20px; &#125;p &gt; button &#123; background-color: #fff; padding-right: 30px; padding-left: 30px &#125; ThÃ¬ mÃ¬nh sáº½ khai bÃ¡o class bá»• trá»£ Ä‘á»ƒ cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng cho nhiá»u trÆ°á»ng há»£p khÃ¡c vá» sau ( Nhá»¯ng class cÃ³ sáºµn cá»§a bootstrap mÃ¬nh sáº½ khÃ´ng liá»‡t kÃª vÃ o, vÃ¬ hiá»‡n giá» mÃ¬nh cáº§n custom cÃ¡c element nÃ y ) 1234.padding-top-20 &#123; padding-top: 20px; &#125;.padding-right-30 &#123; padding-right: 30px; &#125;.padding-left-30 &#123; padding-left: 30px; &#125;.btn.btn-bg-white &#123; background-color: #fff; &#125; NhÆ° váº­y trong HTML mÃ¬nh sáº½ khai bÃ¡o nhÆ° sau 123&lt;p class=\"text-center padding-top-20\"&gt; &lt;button type=\"button\" class=\"btn btn-success btn-md btn-bg-white text-uppercase padding-right-30 padding-left-30\"&gt;Show More&lt;/button&gt;&lt;/p&gt; NhÆ° váº­y thÃ¬ vá» sau nhá»¯ng class nÃ y mÃ¬nh cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng ráº¥t nhiá»u láº§n á»Ÿ ráº¥t nhiá»u element, vÃ  mÃ¬nh cÃ³ thá»ƒ bá» Ä‘i khÃ¡ nhiá»u cÃ´ng Ä‘oáº¡n pháº£i gÃµ láº¡i code CSS khi cÃ³ phÃ¡t sinh thÃªm element má»›i. Äiá»u nÃ y mÃ¬nh há»c há»i tá»« bootstrap vÃ  cáº£m tháº¥y nÃ³ khÃ¡ lÃ  hay. Báº¡n cÃ³ thá»ƒ tham kháº£o thÃªm cÃ¡c helper class hoáº·c typography cá»§a bootstrap Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n. 4. Háº¡n cháº¿ sá»­ dá»¥ng Inline CSS trong cÃ¡c elementsá» Ä‘Ã¢y, mÃ¬nh chá»‰ khuyÃªn cÃ¡c báº¡n nÃªn háº¡n cháº¿ sá»­ dá»¥ng, vÃ¬ Ä‘iá»u nÃ y sáº½ lÃ m cÃ¡c báº¡n khÃ³ kiá»ƒm soÃ¡t code CSS cá»§a mÃ¬nh. â€œVáº¡n báº¥t Ä‘áº¯c dÄ©â€ cáº§n giáº£i quyáº¿t nhanh (hotfix) thÃ¬ hÃ£y dÃ¹ng hoáº·c náº¿u chá»‰ dÃ¹ng má»™t láº§n hoáº·c lÃ  CSS Ä‘á»™ng tá»« javascript thÃ¬ cÃ³ thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c. Theo nhÆ° Google Pagespeed Insights thÃ¬ viá»‡c nÃ y sáº½ lÃ m code bá»‹ láº·p láº¡i khÃ´ng cáº§n thiáº¿t vÃ  vi pháº¡m ChÃ­nh sÃ¡ch Báº£o máº­t Ná»™i dung cá»§a W3, trong má»™t sá»‘ trÆ°á»ng há»£p thÃ¬ cÃ¡c attribute nÃ y sáº½ bá»‹ cháº·n. 5. Giáº£m sá»‘ lÆ°á»£ng file CSSGom cÃ¡c file CSS láº¡i vá»›i nhau (Combine external CSS) lÃ  viá»‡c dá»… lÃ m nháº¥t, thay vÃ¬ pháº£i viáº¿t thÃ nh nhiá»u file nhÆ° header.css, navigation.css, footer.cssâ€¦ vÃ o trong vÄƒn báº£n HTML thÃ¬ báº¡n hÃ£y gom cÃ¡c file nÃ y thÃ nh má»™t file duy nháº¥t. Ná»™i dung file nÃ y sáº½ chá»©a toÃ n bá»™ ná»™i dung cá»§a cÃ¡c file trÃªn, nhÆ° váº­y báº¡n sáº½ giáº£m Ä‘Æ°á»£c nhiá»u request Ä‘áº¿n server vÃ  giáº£m táº£i cho server khÃ¡ nhiá»u. Thay vÃ¬ sá»­ dá»¥ng nhÆ° váº§y 123&lt;link rel=\"stylesheet\" href=\"/css/header.css\"&gt;&lt;link rel=\"stylesheet\" href=\"/css/navigation.css\"&gt;&lt;link rel=\"stylesheet\" href=\"/css/footer.css\"&gt; NÃªn gom chÃºng láº¡i thÃ nh 1&lt;link rel=\"stylesheet\" href=\"/css/style.css\"&gt; 6. Giáº£m kÃ­ch thÆ°á»›c file CSSGiáº£m kÃ­ch thÆ°á»›c file CSS Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch loáº¡i bá» cÃ¡c khoáº£ng tráº¯ng khÃ´ng cáº§n thiáº¿t, dáº¥u xuá»‘ng hÃ ng, dáº¥u cháº¥m pháº©y cuá»‘i cÃ¹ng trong class hoáº·c idâ€¦ CÃ´ng Ä‘oáº¡n nÃ y cÃ²n Ä‘Æ°á»£c gá»i lÃ  minify. Äá»ƒ tiá»‡n phÃ¢n biá»‡t giá»¯a file chÆ°a minify vÃ  file Ä‘Ã£ minify thÃ¬ báº¡n nÃªn thÃªm .min vÃ o tÃªn file Ä‘Ã£ minify. VÃ­ dá»¥ style.css sau khi minify sáº½ thÃ nh style.min.css. Báº¡n cÃ³ thá»ƒ truy cáº­p vÃ o Clean CSS Ä‘á»ƒ thá»±c hiá»‡n minify css hoáº·c sá»­ dá»¥ng tool Koala-app mÃ¬nh sáº½ giá»›i thiá»‡u bÃªn dÆ°á»›i Ä‘á»ƒ tá»± Ä‘á»™ng xuáº¥t file minify trong quÃ¡ trÃ¬nh viáº¿t code. 7. Ãp dá»¥ng ká»¹ thuáº­t OOCSSOOCSS (Object Oriented CSS) â€“ CSS hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng, tháº­t ra hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng á»Ÿ Ä‘Ã¢y cÃ³ nghÄ©a lÃ  báº¡n gom cÃ¡c thuá»™c tÃ­nh giá»‘ng nhau cá»§a 2 class cÃ¹ng Ã¡p dá»¥ng cho má»™t element thÃ nh má»™t class Ä‘á»ƒ giáº£m thiá»ƒu sá»± láº·p láº¡i. VÃ­ dá»¥: Thay vÃ¬ khai bÃ¡o 2 class cho button nhÆ° sau 123456789101112131415161718192021222324252627282930313233.btn-primary &#123; display: inline-block; padding: 6px 12px; margin-bottom: 0; font-size: 14px; font-weight: 400; line-height: 1.42857143; text-align: center; white-space: nowrap; vertical-align: middle; border: 1px solid transparent; border-radius: 4px; color: #fff; background-color: #337ab7; border-color: #2e6da4;&#125; .btn-success &#123; display: inline-block; padding: 6px 12px; margin-bottom: 0; font-size: 14px; font-weight: 400; line-height: 1.42857143; text-align: center; white-space: nowrap; vertical-align: middle; border: 1px solid transparent; border-radius: 4px; color: #fff; background-color: #5cb85c; border-color: #5cb85c;&#125; MÃ¬nh sáº½ gom má»™t sá»‘ thuá»™c tÃ­nh cá»§a 2 class nÃ y thÃ nh má»™t class khÃ¡c cÃ³ tÃªn lÃ  btn: 12345678910111213141516171819202122232425.btn &#123; display: inline-block; padding: 6px 12px; margin-bottom: 0; font-size: 14px; font-weight: 400; line-height: 1.42857143; text-align: center; white-space: nowrap; vertical-align: middle; border: 1px solid transparent; border-radius: 4px;&#125; .btn.btn-primary &#123; color: #fff; background-color: #337ab7; border-color: #2e6da4;&#125; .btn.btn-success &#123; color: #fff; background-color: #5cb85c; border-color: #5cb85c;&#125; NhÆ° váº­y náº¿u sau nÃ y cÃ³ thay Ä‘á»•i gÃ¬ vá» má»™t sá»‘ thuá»™c tÃ­nh chung cá»§a 2 class thÃ¬ mÃ¬nh chá»‰ cáº§n thay Ä‘á»•i class btn thÃ¬ sáº½ dá»… dÃ ng vÃ  nhanh hÆ¡n. 8. Tá»• chá»©c class vÃ  id má»™t cÃ¡ch khoa há»cViá»‡c nÃ y Ä‘á»ƒ há»— trá»£ báº¡n sau nÃ y khi xem láº¡i code cá»§a mÃ¬nh dá»… dÃ ng hÆ¡n vÃ  khÃ´ng bá»‹ rá»‘i vá»›i cÃ¡ch Ä‘áº·t tÃªn cá»§a mÃ¬nh, Ä‘á»“ng thá»i cÅ©ng dá»… dÃ ng náº¿u cÃ³ Ã¡p dá»¥ng má»™t sá»‘ CSS preprocessor hay BEM. Thay vÃ¬ Ä‘áº·t tÃªn 12345.titlepost &#123;&#125; .headerpost &#123;&#125; .contentpost &#123;&#125; thÃ¬ nÃªn Ä‘áº·t thÃ nh 1234567.post &#123;&#125; .post-title &#123;&#125; .post-header &#123;&#125; .post-content &#123;&#125; hoáº·c tá»• chá»©c thÃ nh 1234567.post &#123;&#125; .post &gt; .title &#123;&#125; .post &gt; .header &#123;&#125; .post &gt; .content &#123;&#125; 9. NgÃ´n ngá»¯ tiá»n xá»­ lÃ½ CSSTiá»n xá»­ lÃ½ CSS (CSS Preprocessor) â€“ lÃ  má»™t cÃ¡ch má»Ÿ rá»™ng cá»§a CSS hoáº·c cÅ©ng cÃ³ thá»ƒ coi nÃ³ lÃ  má»™t ngÃ´n ngá»¯ riÃªng. Má»¥c Ä‘Ã­ch cá»§a CSS preprocessor lÃ  Ä‘á»ƒ báº¡n dá»… dÃ ng cáº¥u trÃºc cÃ¡c Ä‘oáº¡n code CSS, giáº£m thá»i gian pháº£i viáº¿t Ä‘i viáº¿t láº¡i má»™t Ä‘oáº¡n code, dá»… dÃ ng Ã¡p dá»¥ng OOCSSâ€¦ NÃ³i cÃ¡ch khÃ¡c báº¡n cÃ³ thá»ƒ hiá»ƒu CSS preprocessor gáº§n nhÆ° lÃ  má»™t ngÃ´n ngá»¯ láº­p trÃ¬nh vÃ¬ nÃ³ cÅ©ng cÃ³ biáº¿n, káº¿ thá»«a class, vÃ  dá»… dÃ ng táº¡o ra má»™t thÆ° viá»‡n riÃªng cho báº¡n quáº£n lÃ½, káº¿ thá»«a vÃ  tÃ¡i sá»­ dá»¥ng á»Ÿ nhá»¯ng dá»± Ã¡n khÃ¡c. CSS preprocessor hiá»‡n nay cÃ³ ráº¥t nhiá»u nhÆ°ng phá»• biáº¿n nháº¥t hiá»‡n nay lÃ  Less vÃ  Sass. á» Ä‘Ã¢y mÃ¬nh giá»›i thiá»‡u cÃ¡c báº¡n vá» Sass vÃ¬ mÃ¬nh Ä‘ang sá»­ dá»¥ng nÃ³ thay cho Less, vÃ  CSS framework phá»• biáº¿n â€“ Bootstrap, ká»ƒ tá»« phiÃªn báº£n 4 Ä‘Ã£ chuyá»ƒn tá»« Less qua Sass. Vá» Sass cÃ¡c báº¡n xem hÆ°á»›ng dáº«n cÃ i Ä‘áº·t trÃªn trang chá»§. Khi báº¯t Ä‘áº§u vá»›i má»™t dá»± Ã¡n cÃ³ Ã¡p dá»¥ng Sass, viá»‡c Ä‘áº§u tiÃªn mÃ¬nh thÆ°á»ng lÃ m lÃ  cáº¥u trÃºc CSS thÃ nh nhiá»u file nhá» Ä‘á»ƒ trÃ¡nh nhá»“i nhÃ©t CSS vÃ o má»™t file vÃ  dá»… dÃ ng cho viá»‡c quáº£n lÃ½, tÃ¬m kiáº¿m khi cáº§n thiáº¿t. MÃ¬nh thÆ°á»ng cáº¥u trÃºc cÃ¡c file Sass nhÆ° sau: 1234567891011scss|-- style.scss|-- _variable.scss|-- _helper.scss|-- _mixins.scss|-- components|-- -- _header.scss|-- -- _footer.scss|-- mixins|-- -- button.scss|-- -- label.scss Trong file style.scss ná»™i dung nhÆ° sau: 1234567@import \"variable\";@impprt \"helper\";@import \"mixins\"; // Components@import \"components/header\";@import \"components/footer\"; ChÃº thÃ­ch: _variable.scss: variable chá»©a cÃ¡c thÃ´ng tin vá» cÃ¡c biáº¿n dÃ¹ng chung _helper.scss: helper sáº½ chá»©a/import cÃ¡c class helper _mixins.scss: mixins sáº½ chá»©a/import cÃ¡c class custom hoáº·c class Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng nhiá»u láº§n Ná»™i dung file _helper.scss nhÆ° mÃ¬nh Ä‘Ã£ nÃ³i sáº½ táº¡o ra cÃ¡c class helper, nhÆ°ng á»Ÿ Ä‘Ã¢y mÃ¬nh Ã¡p dá»¥ng tÃ­nh cháº¥t cá»§a Scss Ä‘á»ƒ táº¡o ra cÃ¡c class vá»›i Ã­t dÃ²ng code nháº¥t: 12345678910111213141516171819202122232425$numbersPX: \"10\" 10px, \"15\" 15px, \"20\" 20px, \"25\" 25px, \"30\" 30px; // padding@each $i in $numbersPX&#123; .padding-#&#123;nth($i, 1)&#125; &#123; padding: nth($i, 2) !important; &#125; .padding-top-#&#123;nth($i, 1)&#125; &#123; padding-top: nth($i, 2) !important; &#125; .padding-bottom-#&#123;nth($i, 1)&#125; &#123; padding-bottom: nth($i, 2) !important; &#125; .padding-right-#&#123;nth($i, 1)&#125; &#123; padding-right: nth($i, 2) !important; &#125; .padding-left-#&#123;nth($i, 1)&#125; &#123; padding-left: nth($i, 2) !important; &#125;&#125; khi Sass complier ra file CSS thÃ¬ mÃ¬nh sáº½ thu Ä‘Æ°á»£c káº¿t quáº£ nhÆ° sau 12345678910111213141516171819202122232425.padding-10 &#123; padding: 10px !important; &#125;.padding-top-10 &#123; padding-top: 10px !important; &#125;.padding-bottom-10 &#123; padding-bottom: 10px !important; &#125;.padding-right-10 &#123; padding-right: 10px !important; &#125;.padding-left-10 &#123; padding-left: 10px !important; &#125;.padding-15 &#123; padding: 15px !important; &#125;.padding-top-15 &#123; padding-top: 15px !important; &#125;.padding-bottom-15 &#123; padding-bottom: 15px !important; &#125;.padding-right-15 &#123; padding-right: 15px !important; &#125;.padding-left-15 &#123; padding-left: 15px !important; &#125;.padding-20 &#123; padding: 20px !important; &#125;.padding-top-20 &#123; padding-top: 20px !important; &#125;.padding-bottom-20 &#123; padding-bottom: 20px !important; &#125;.padding-right-20 &#123; padding-right: 20px !important; &#125;.padding-left-20 &#123; padding-left: 20px !important; &#125;.padding-25 &#123; padding: 25px !important; &#125;.padding-top-25 &#123; padding-top: 25px !important; &#125;.padding-bottom-25 &#123; padding-bottom: 25px !important; &#125;.padding-right-25 &#123; padding-right: 25px !important; &#125;.padding-left-25 &#123; padding-left: 25px !important; &#125;.padding-30 &#123; padding: 30px !important; &#125;.padding-top-30 &#123; padding-top: 30px !important; &#125;.padding-bottom-30 &#123; padding-bottom: 30px !important; &#125;.padding-right-30 &#123; padding-right: 30px !important; &#125;.padding-left-30 &#123; padding-left: 30px !important; &#125; 10. Giá»›i thiá»‡u sÆ¡ lÆ°á»£c Koala AppKoala app lÃ  má»™t á»©ng dá»¥ng GUI há»— trá»£ biÃªn dá»‹ch Less, Sass, Compass vÃ  CoffeeScript sang CSS vÃ  JS. Koala App cháº¡y Ä‘Æ°á»£c trÃªn cáº£ 3 mÃ´i trÆ°á»ng Mac OS, Linux vÃ  Windows nÃªn ráº¥t tiá»‡n náº¿u báº¡n cáº§n thay Ä‘á»•i qua láº¡i giá»¯a cÃ¡c há»‡ Ä‘iá»u hÃ nh. NgoÃ i ra, Koala App cÃ²n há»— trá»£ minify cho cáº£ CSS vÃ  JS. Sá»­ dá»¥ng Koala App ráº¥t Ä‘Æ¡n giáº£n, báº¡n chá»‰ cáº§n má»Ÿ lÃªn vÃ  áº¥n dáº¥u + trÃªn Ä‘áº§u chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ chá»n thÆ° má»¥c chá»©a cÃ¡c file cáº§n xá»­ lÃ½, vÃ  Koala App sáº½ tá»± Ä‘á»™ng scan toÃ n bá»™ cÃ¡c folder bÃªn trong vÃ  theo dÃµi khi cÃ³ thay Ä‘á»•i. Náº¿u báº¡n â€œsiÃªngâ€ thÃ¬ cÃ³ thá»ƒ tham kháº£o cÃ¡ch Ä‘á»ƒ tá»± cáº¥u hÃ¬nh project Ä‘á»ƒ Koala-app hoáº¡t Ä‘á»™ng theo Ã½ mÃ¬nh táº¡i Ä‘Ã¢y. TrÃªn Ä‘Ã¢y lÃ  nhá»¯ng máº¹o CSS rÃºt ra tá»« kinh nghiá»‡m lÃ m viá»‡c cá»§a mÃ¬nh. Náº¿u báº¡n cÃ²n nhá»¯ng máº¹o hay khÃ¡c thÃ¬ Ä‘á»«ng ngáº¡i chia sáº» bÃªn dÆ°á»›i nhÃ©.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"}]},{"title":"Tá»‘i Æ°u hiá»‡u suáº¥t render Ä‘á»ƒ website mÆ°á»£t hÆ¡n","slug":"Toi-uu-hieu-suat-render-de-website-muot-hon","date":"2018-06-26T00:50:00.000Z","updated":"2018-06-27T01:12:25.692Z","comments":true,"path":"2018/06/Toi-uu-hieu-suat-render-de-website-muot-hon.html","link":"","permalink":"http://nthung2112.github.io/2018/06/Toi-uu-hieu-suat-render-de-website-muot-hon.html","excerpt":"Optimizing Performance (tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t) cho website lÃ  má»™t cÃ´ng viá»‡c mÃ  báº¥t ká»³ front-end developer nÃ o cÅ©ng nÃªn biáº¿t, má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ trang web Ä‘Ã¡p á»©ng Ä‘Æ°á»£c 3 tiÃªu chÃ­: NHáº¸: Giáº£m kÃ­ch thÆ°á»›c trang web vÃ  cÃ¡c thÃ nh pháº§n Ä‘i kÃ¨m nhÆ° javascript, css, hÃ¬nh áº£nhâ€¦ nháº±m Ä‘áº£m báº£o thá»i gian táº£i xuá»‘ng ngáº¯n hÆ¡n. ChÃºng ta cÃ³ thá»ƒ dÃ¹ng cÃ¡c bá»™ minify cho javascript, cssâ€¦, nÃ©n cÃ¡c táº­p tin hÃ¬nh áº£nh, font chá»¯, svgâ€¦ ngoÃ i ra cÃ²n cÃ³ cÃ¡c kÄ© thuáº­t nhÆ° code splitting, browser caching, HTTP cachingâ€¦ NHANH Hiá»ƒn thá»‹ ná»™i dung trang web cÃ ng sá»›m cÃ ng tá»‘t báº±ng cÃ¡ch: chia cáº¥u trÃºc DOM há»£p lÃ½, háº¡n cháº¿ blocking CSS/JS, háº¡n cháº¿ chá»‰nh sá»­a DOM tree, chia cÃ¡c file ra thÃ nh nhiá»u module, táº£i resource báº¥t Ä‘á»“ng bá»™, tá»‘i Æ°u hÃ³a cÃ¡c selector cá»§a CSS vÃ  JSâ€¦ MÆ¯á»¢T: Sau khi ná»™i dung trang web Ä‘Ã£ Ä‘Æ°á»£c táº£i vá» vÃ  hiá»ƒn thá»‹ thÃ¬ viá»‡c tiáº¿p theo lÃ  báº£o Ä‘áº£m cÃ¡c hiá»‡u á»©ng animation, transition, scrollingâ€¦ pháº£i mÆ°á»£t, khÃ´ng bá»‹ lag vÃ  giáº­t (jank).","text":"Optimizing Performance (tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t) cho website lÃ  má»™t cÃ´ng viá»‡c mÃ  báº¥t ká»³ front-end developer nÃ o cÅ©ng nÃªn biáº¿t, má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ trang web Ä‘Ã¡p á»©ng Ä‘Æ°á»£c 3 tiÃªu chÃ­: NHáº¸: Giáº£m kÃ­ch thÆ°á»›c trang web vÃ  cÃ¡c thÃ nh pháº§n Ä‘i kÃ¨m nhÆ° javascript, css, hÃ¬nh áº£nhâ€¦ nháº±m Ä‘áº£m báº£o thá»i gian táº£i xuá»‘ng ngáº¯n hÆ¡n. ChÃºng ta cÃ³ thá»ƒ dÃ¹ng cÃ¡c bá»™ minify cho javascript, cssâ€¦, nÃ©n cÃ¡c táº­p tin hÃ¬nh áº£nh, font chá»¯, svgâ€¦ ngoÃ i ra cÃ²n cÃ³ cÃ¡c kÄ© thuáº­t nhÆ° code splitting, browser caching, HTTP cachingâ€¦ NHANH Hiá»ƒn thá»‹ ná»™i dung trang web cÃ ng sá»›m cÃ ng tá»‘t báº±ng cÃ¡ch: chia cáº¥u trÃºc DOM há»£p lÃ½, háº¡n cháº¿ blocking CSS/JS, háº¡n cháº¿ chá»‰nh sá»­a DOM tree, chia cÃ¡c file ra thÃ nh nhiá»u module, táº£i resource báº¥t Ä‘á»“ng bá»™, tá»‘i Æ°u hÃ³a cÃ¡c selector cá»§a CSS vÃ  JSâ€¦ MÆ¯á»¢T: Sau khi ná»™i dung trang web Ä‘Ã£ Ä‘Æ°á»£c táº£i vá» vÃ  hiá»ƒn thá»‹ thÃ¬ viá»‡c tiáº¿p theo lÃ  báº£o Ä‘áº£m cÃ¡c hiá»‡u á»©ng animation, transition, scrollingâ€¦ pháº£i mÆ°á»£t, khÃ´ng bá»‹ lag vÃ  giáº­t (jank). Trong 3 tiÃªu chÃ­ nÃ y, cÃ³ 2 tiÃªu chÃ­ mÃ  front-end developer chÃºng ta háº±ng ngÃ y Ä‘á»u thá»±c hiá»‡n lÃ  nháº¹ vÃ  nhanh. Báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c framework (angularjs, reactjsâ€¦) vÃ  cÃ¡c bá»™ build tool (grunt, gulp, webpackâ€¦), cÃ¡c resource trong project á»Ÿ mÃ´i trÆ°á»ng production lÃºc nÃ o cÅ©ng Ä‘Æ°á»£c minify vÃ  Ä‘Ã³ng gÃ³i Ä‘áº§y Ä‘á»§, gá»n gÃ ng. Do Ä‘Ã³, trong bÃ i nÃ y tÃ´i sáº½ hÆ°á»›ng dáº«n cho báº¡n cÃ¡ch Ä‘Ã¡p á»©ng Ä‘Æ°á»£c tiÃªu chÃ­ thá»© 3, Ä‘Ã³ lÃ  MÆ¯á»¢T, thá»© mÃ  Ã­t cÃ³ framework hay cÃ´ng cá»¥ nÃ o cÃ³ thá»ƒ há»— trá»£ báº¡n Ä‘Æ°á»£c. TrÃªn thá»±c táº¿, cÃ¡c web page yÃªu cáº§u Ä‘á»™ mÆ°á»£t cao thÆ°á»ng lÃ  cÃ¡c webpage cÃ³ nhiá»u hiá»‡u á»©ng, chuyá»ƒn Ä‘á»™ng, vÃ­ dá»¥ nhÆ° cÃ¡c trang landing page, giá»›i thiá»‡u sáº£n pháº©m, HTML5 game, hoáº·c cÃ¡c á»©ng dá»¥ng cÃ³ animation cháº¡y trÃªn cÃ¡c thiáº¿t bá»‹ cÃ³ cáº¥u hÃ¬nh tháº¥p. Báº¡n cÃ³ thá»ƒ xem qua má»™t sá»‘ trang sau: http://world.mathigon.org/ http://matthew.wagerfield.com/parallax/ LÃ m tháº¿ nÃ o Ä‘á»ƒ web page â€œmÆ°á»£tâ€?MÆ°á»£t á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  â€œRendering Performanceâ€, Ä‘á»ƒ tá»‘i Æ°u hiá»‡u suáº¥t render chÃºng ta pháº£i hiá»ƒu Ä‘Æ°á»£c quÃ¡ trÃ¬nh render cá»§a browser. 60â€¦ lÃ  sá»‘ khung hÃ¬nh trÃªn má»™t giÃ¢y mÃ  cÃ¡c thiáº¿t bá»‹ phá»• biáº¿n hiá»‡n nay há»— trá»£ (60fps). Äá»ƒ cho trang web mÆ°á»£t thÃ¬ tá»‘c Ä‘á»™ render pháº£i Ä‘Ã¡p á»©ng Ä‘Æ°á»£c con sá»‘ nÃ y. Tá»©c lÃ  trong 1 giÃ¢y chÃºng ta pháº£i cho ra 60 khung hÃ¬nh. Vá»›i má»—i khung hÃ¬nh, chÃºng ta cÃ³ 1 / 60 = 16,66 mili giÃ¢y. TrÃªn thá»±c táº¿, browser cÃ²n cÃ³ má»™t sá»‘ tÃ¡c vá»¥ khÃ¡c pháº£i lÃ m bÃªn cáº¡nh viá»‡c render, vÃ¬ tháº¿ chÃºng ta trá»« hao cÃ²n láº¡i khoáº£ng 16ms. Báº¥t cá»© animation hay transition nÃ o, muá»‘n Ä‘áº£m báº£o Ä‘Æ°á»£c tá»‘c Ä‘á»™ 60fps thÃ¬ pháº£i cÅ©ng pháº£i Ä‘áº£m báº£o trong vÃ²ng 16ms pháº£i render Ä‘Æ°á»£c má»™t khung hÃ¬nh, náº¿u khÃ´ng thÃ¬ sáº½ bá»‹ hiá»‡n tÆ°á»£ng â€œframe skipâ€, hiá»‡u á»©ng sáº½ bá»‹ giáº­t, lag. Cáº§n pháº£i lÃ m nhá»¯ng gÃ¬ trong 16ms Ä‘Ã³?Äá»ƒ cho ra Ä‘Æ°á»£c 1 khung hÃ¬nh, Ä‘Ã¢y lÃ  cÃ¡c viá»‡c mÃ  browser pháº£i thá»±c hiá»‡n (the pixel pipeline): Giáº£i thÃ­ch ngáº¯n gá»n: 1. JavaScript: lÃ  hoáº¡t Ä‘á»™ng execute code cá»§a javascript. 1document.getElementById('my-element').style.width = '300px'; 2. Style calculation: tÃ­nh toÃ¡n cÃ¡c thuá»™c tÃ­nh theo cÃ¡c quy táº¯c tá»« file CSS (hoáº·c tháº» &lt;style&gt;, thuá»™c tÃ­nh style). 1&lt;div id='my-element' style='width: 300px'&gt;Hello&lt;/div&gt; 3. Layout: browser thá»±c hiá»‡n â€œchia vÃ¹ngâ€ cho cÃ¡c element khi hiá»ƒn thá»‹ trÃªn mÃ n hÃ¬nh, dá»±a trÃªn cÃ¡c thuá»™c tÃ­nh Ä‘Ã£ tÃ­nh toÃ¡n Ä‘Æ°á»£c tá»« bÆ°á»›c Style. 4. Paint: tÃ´ mÃ u cho tá»«ng pixel, bao gá»“m viá»‡c: váº½ chá»¯ (render font), hÃ¬nh áº£nh, mÃ u, váº½ cÃ¡c hiá»‡u á»©ng CSS nhÆ° border, box-shadowâ€¦ Viá»‡c tÃ´ mÃ u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn nhiá»u â€œlayerâ€ cÃ¹ng má»™t lÃºc (pháº§n sau sáº½ giáº£i thÃ­ch rÃµ hÆ¡n vá» layer). ÄÃ¢y lÃ  bÆ°á»›c chiáº¿m nhiá»u thá»i gian nháº¥t. 5. Composite: gá»™p cÃ¡c layer Ä‘Ã£ Ä‘Æ°á»£c váº½ (á»Ÿ bÆ°á»›c Paint) vÃ  hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh theo Ä‘Ãºng thá»© tá»± cá»§a cÃ¡c layer Ä‘Ã³. NhÆ° váº­y, chá»‰ vá»›i 16ms browser pháº£i thá»±c hiá»‡n 5 bÆ°á»›c nhÆ° trÃªn Ä‘á»ƒ cÃ³ thá»ƒ render ra Ä‘Æ°á»£c 1 khung hÃ¬nh. Váº­y Ä‘á»ƒ Ä‘áº£m báº£o má»i thá»© Ä‘á»u hoÃ n thÃ nh dÆ°á»›i 16ms, viá»‡c chÃºng ta cáº§n lÃ m lÃ  tá»‘i Æ°u tá»«ng bÆ°á»›c. Cá»¥ thá»ƒ lÃ : JavaScript: DÃ¹ng requestAnimationFrame. DÃ¹ng Web workers, Micro-task cho cÃ¡c tÃ¡c vá»¥ náº·ng. Profiling with Chrome DevTools. Style: Giáº£m Ä‘á»™ phá»©c táº¡p cá»§a selector Giáº£m sá»‘ lÆ°á»£ng element bá»‹ áº£nh hÆ°á»Ÿng Layout: Háº¡n cháº¿ kÃ­ch hoáº¡t layout Sá»­ dá»¥ng Flexbox Háº¡n cháº¿ forced synchronous layout. Paint: Paint lÃ  tÃ¡c vá»¥ xá»­ lÃ½ lÃ¢u nháº¥t Box-shadow, large image khÃ´ng tá»‘t cho paint Táº¡o vÃ  quáº£n lÃ½ layer há»£p lÃ½ Composite: Sá»­ dá»¥ng transform vÃ  opacity Quáº£n lÃ½ cÃ¡c layer báº±ng Chrome DevTools Tá»«ng bÆ°á»›c tá»‘i Æ°u hiá»‡u suáº¥t renderBÆ°á»›c 1: Javascript1.1. Sá»­ dá»¥ng requestAnimationFrame Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i trÃªn UI.Khi thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i trÃªn UI báº±ng JavaScript, báº¡n sáº½ muá»‘n thá»±c hiá»‡n nÃ³ ngay vÃ o lÃºc báº¯t Ä‘áº§u cá»§a frame, lÃºc Ä‘Ã³ browser sáº½ cÃ³ Ä‘Æ°á»£c toÃ n bá»™ 16ms Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i (JavaScript â‡’ Style â‡’ Layout â‡’ Paint â‡’ Composite). Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y báº¡n cáº§n dÃ¹ng hÃ m requestAnimationFrame. HÃ m nÃ y cÃ³ chá»©c nÄƒng â€œháº¹n giá»â€ cháº¡y vÃ o Ä‘Ãºng thá»i Ä‘iá»ƒm cá»§a frame tiáº¿p theo. 12345678/** * If run as a requestAnimationFrame callback, this * will be run at the start of the frame. */function updateScreen(time) &#123; // Make visual updates here.&#125;requestAnimationFrame(updateScreen); Má»™t sá»‘ Ä‘oáº¡n code trÃªn máº¡ng hoáº·c trong cÃ¡c framework thÆ°á»ng sá»­ dá»¥ng hÃ m setTimeout, tuy nhiÃªn hÃ m Ä‘Æ°á»£c gá»i bá»Ÿi setTimeout sáº½ khÃ´ng khá»Ÿi cháº¡y lÃºc báº¯t Ä‘áº§u frame, dáº«n Ä‘áº¿n viá»‡c khÃ´ng táº­n dá»¥ng háº¿t Ä‘Æ°á»£c khoáº£ng thá»i gian 16ms, do Ä‘Ã³ gÃ¢y ra hiá»‡n tÆ°á»£ng frame skip, gÃ¢y giáº­t, lag. 1.2. Chuyá»ƒn cÃ¡c tÃ¡c vá»¥ náº·ng sang Web workersÄá»‘i vá»›i cÃ¡c tÃ¡c vá»¥ náº·ng nhÆ° encode/decode, xá»­ lÃ½ dá»¯ liá»‡u lá»›nâ€¦ chÃºng ta nÃªn chuyá»ƒn tÃ¡c vá»¥ Ä‘Ã³ sang Web Workers. Web Workers hoáº¡t Ä‘á»™ng trÃªn má»™t thread riÃªng biá»‡t, sáº½ giÃºp giáº£m táº£i cho UI Thread vÃ  giÃºp tiáº¿t kiá»‡m Ä‘Æ°á»£c thá»i gian xá»­ lÃ½. 123456789var dataSortWorker = new Worker(\"sort-worker.js\");dataSortWorker.postMesssage(dataToSort); // The main thread is now free to continue working on other things... dataSortWorker.addEventListener('message', function(evt) &#123; var sortedData = evt.data; // Update data on screen...&#125;); Tuy nhiÃªn, Web Workers khÃ´ng thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i DOM tree, do Ä‘Ã³ má»™t sá»‘ tÃ¡c vá»¥ khÃ´ng thá»ƒ chuyá»ƒn qua Web Workers Ä‘Æ°á»£c. Trong trÆ°á»ng há»£p nÃ y ta cÃ³ thá»ƒ Ã¡p dá»¥ng phÆ°Æ¡ng phÃ¡p â€œmicro-taskâ€: chia nhá» task ra, sau Ä‘Ã³ sá»­ dá»¥ng requestAnimationFrame Ä‘á»ƒ cáº­p nháº­t UI. LÃºc nÃ y, náº¿u má»—i task nhá» cÃ³ thá»i gian thá»±c thi bÃ© hÆ¡n 16ms thÃ¬ sáº½ trÃ¡nh Ä‘Æ°á»£c hiá»‡n tÆ°á»£ng giáº­t, lag nhÆ° khi cháº¡y cáº£ task lá»›n. 123456789101112131415161718192021var taskList = breakBigTaskIntoMicroTasks(monsterTaskList);requestAnimationFrame(processTaskList); function processTaskList(taskStartTime) &#123; var taskFinishTime; do &#123; // Assume the next task is pushed onto a stack. var nextTask = taskList.pop(); // Process nextTask. processTask(nextTask); // Go again if thereâ€™s enough time to do the next task. taskFinishTime = window.performance.now(); &#125; while (taskFinishTime - taskStartTime &lt; 3); if (taskList.length &gt; 0) requestAnimationFrame(processTaskList); &#125; 1.3. Sá»­ dá»¥ng Chrome DevTools Ä‘á»ƒ â€œÄ‘iá»u traâ€ JavaScript executionChrome DevTools lÃ  cÃ´ng cá»¥ cá»±c ká»³ há»¯u Ã­ch. á» tab â€œTimelineâ€ cá»§a Chrome DevTools, báº¡n cÃ³ thá»ƒ kiá»ƒm tra Ä‘Æ°á»£c Ä‘á»™ mÆ°á»£t cá»§a web page báº±ng cÃ¡ch: Nháº¥n nÃºt Record (hoáº·c Ctrl + R trÃªn Windows, Command + R trÃªn Mac) Thá»±c hiá»‡n animation / transition trÃªn trang web chÃ­nh Nháº¥n nÃºt Stop Record. Chrome DevTools sáº½ hiá»ƒn thá»‹ toÃ n bá»™ cÃ¡c thÃ´ng tin liÃªn quan Ä‘áº¿n cÃ¡c tÃ¡c vá»¥ JavaScript â‡’ Style â‡’ Layout â‡’ Paint â‡’ Composite. Báº¡n cÃ³ thá»ƒ kiáº¿m tra Ä‘á»ƒ xem tÃ¡c vá»¥ nÃ o chiáº¿m nhiá»u thá»i gian nháº¥t vÃ  gÃ¢y ra frame skip. BÆ°á»›c 2: Style calculationCá»‘ gáº¯ng giá»¯ cho selector cá»§a báº¡n cÃ ng Ä‘Æ¡n giáº£n cÃ ng tá»‘t, vÃ  giáº£m sá»‘ lÆ°á»£ng element bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi selector, vÃ­ dá»¥: NÃªn: 1.title &#123; /* styles */ &#125; KhÃ´ng nÃªn: 1.box:nth-last-child(-n+1) .title &#123; /* styles */ &#125; KhÃ´ng nÃªn: 1*, *:before, *:after &#123; /* styles */ &#125; NÃªn: 1body &#123; /* styles */ &#125; Viá»‡c sá»­ dá»¥ng cÃ¡c selector nÃ y cáº§n pháº£i cÃ¢n báº±ng giá»¯a viá»‡c code gá»n gÃ ng Ä‘áº¹p Ä‘áº½ vÃ  hiá»‡u suáº¥t. Khi sá»­ dá»¥ng cÃ¡c selector phá»©c táº¡p thÃ¬ browser cáº§n pháº£i thá»±c hiá»‡n nhiá»u tÃ­nh toÃ¡n, nhÆ°ng náº¿u chá»‰ sá»­ dá»¥ng cÃ¡c selector Ä‘Æ¡n giáº£n thÃ¬ láº¡i khiáº¿n code cá»§a chÃºng ta khÃ³ quáº£n lÃ½. Giáº£i phÃ¡p á»Ÿ Ä‘Ã¢y lÃ  chÃºng ta nÃªn sá»­ dá»¥ng má»™t sá»‘ ká»¹ thuáº­t quáº£n lÃ½ style nhÆ°: BEM (Block, Element, Modifier), PostCSS. CÃ¡c cÃ´ng cá»¥ nÃ y sáº½ giÃºp chÃºng ta vá»«a dá»… quáº£n lÃ½ code CSS á»Ÿ mÃ´i trÆ°á»ng dev, vÃ  cÅ©ng vá»«a Ä‘áº£m báº£o hiá»‡u suáº¥t á»Ÿ mÃ´i trÆ°á»ng production sau khi build. BÆ°á»›c 3: Layout3.1. Háº¡n cháº¿ kÃ­ch hoáº¡t tÃ­nh toÃ¡n layoutViá»‡c thay Ä‘á»•i má»™t sá»‘ thuá»™c tÃ­nh CSS cá»§a element cÃ³ thá»ƒ kÃ­ch hoáº¡t browser tÃ­nh toÃ¡n láº¡i layout cá»§a element Ä‘Ã³. 12345678910111213.box &#123; width: 20px; height: 20px;&#125; /** * Changing width and height * triggers layout. */.box--expanded &#123; width: 200px; height: 350px;&#125; Khi má»™t element bá»‹ thay Ä‘á»•i layout thÃ¬ thÆ°á»ng lÃ  cÃ¡c element khÃ¡c cÅ©ng sáº½ bá»‹ thay Ä‘á»•i theo (kÃ­ch thÆ°á»›c, vá»‹ trÃ­â€¦). Do Ä‘Ã³ náº¿u trang cá»§a báº¡n cÃ³ nhiá»u element vÃ  viá»‡c kÃ­ch hoáº¡t layout diá»…n ra quÃ¡ thÆ°á»ng xuyÃªn thÃ¬ hoÃ n toÃ n khÃ´ng tá»‘t cho performance. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Chrome DevTools Ä‘á»ƒ kiá»ƒm tra xem web page cá»§a báº¡n cÃ³ bá»‹ kÃ­ch hoáº¡t layout quÃ¡ nhiá»u hay khÃ´ng. VÃ­ dá»¥ trong hÃ¬nh nÃ y, báº¡n cÃ³ thá»ƒ tháº¥y sá»± kiá»‡n Layout chiáº¿m tá»›i 20.636ms, vÆ°á»£t qua con sá»‘ 16ms vÃ  táº¥t nhiÃªn lÃ  sáº½ dáº«n Ä‘áº¿n frame skip, sá»‘ lÆ°á»£ng element cáº§n tÃ­nh toÃ¡n láº¡i layout lÃ  1618 (ráº¥t nhiá»u). Äá»ƒ biáº¿t Ä‘Æ°á»£c nhá»¯ng thuá»™c tÃ­nh nÃ o sáº½ kÃ­ch hoáº¡t Layout (vÃ  lÃ½ do vÃ¬ sao), báº¡n cÃ³ thá»ƒ tra cá»©u á»Ÿ trang http://csstriggers.com/ â€“ cÃ´ng cá»¥ do má»™t Googler viáº¿t cho má»¥c Ä‘Ã­ch tra cá»©u. 3.2. Sá»­ dá»¥ng cÃ¡c thuá»™c tÃ­nh má»›i cá»§a CSS3CSS3 cÃ³ cung cáº¥p má»™t sá»‘ thuá»™c tÃ­nh má»›i khÃ´ng nhá»¯ng giÃºp chÃºng ta canh chá»‰nh layout dá»… hÆ¡n mÃ  cÃ²n giÃºp tÄƒng hiá»‡u suáº¥t ráº¥t nhiá»u. Äiá»ƒn hÃ¬nh lÃ  Flexbox, viá»‡c sá»­ dá»¥ng flexbox Ä‘á»ƒ canh chá»‰nh layout sáº½ dá»… hÆ¡n so vá»›i cÃ¡ch dÃ¹ng float truyá»n thá»‘ng. Xem bÃ i hÆ°á»›ng dáº«n tuyá»‡t vá»i vá» Flexbox: http://css-tricks.com/snippets/css/a-guide-to-flexbox/ Vá» hiá»‡u suáº¥t, dÆ°á»›i Ä‘Ã¢y lÃ  2 hÃ¬nh áº£nh Ä‘o hiá»‡u suáº¥t cá»§a viá»‡c kÃ­ch hoáº¡t layout trÃªn 1300 elements. Sá»­ dá»¥ng Float: Sá»­ dá»¥ng Flexbox: CÃ³ thá»ƒ tháº¥y con sá»‘ â€œSelf Timeâ€ giáº£m tá»« ~14ms chá»‰ cÃ²n ~3.5ms, Ä‘Ã³ lÃ  má»™t sá»± thay Ä‘á»•i ráº¥t Ä‘Ã¡ng ká»ƒ. 3.3. Háº¡n cháº¿ kÃ­ch hoáº¡t layout sá»›mHÃ£y xem xÃ©t Ä‘oáº¡n code sau: thay Ä‘á»•i kÃ­ch thÆ°á»›c cá»§a 3 elements 1234567891011121314151617// Readvar h1 = element1.clientHeight; // Write (invalidates layout)element1.style.height = (h1 * 2) + 'px'; // Read (triggers layout)var h2 = element2.clientHeight; // Write (invalidates layout)element2.style.height = (h2 * 2) + 'px'; // Read (triggers layout)var h3 = element3.clientHeight; // Write (invalidates layout)element3.style.height = (h3 * 2) + 'px'; Khi má»™t element (DOM) Ä‘Æ°á»£c ghi giÃ¡ trá»‹ má»›i thÃ¬ layout sáº½ bá»‹ Ä‘Ã¡nh dáº¥u giÃ¡ trá»‹ háº¿t hiá»‡u lá»±c (invalidates) vÃ  sáº½ Ä‘Æ°á»£c tÃ­nh toÃ¡n láº¡i táº¡i má»™t thá»i Ä‘iá»ƒm nÃ o Ä‘Ã³. Äá»ƒ Ä‘áº£m báº£o performance, browser sáº½ thá»±c hiá»‡n tÃ­nh toÃ¡n láº¡i layout vÃ o thá»i Ä‘iá»ƒm báº¯t Ä‘áº§u cá»§a frame tiáº¿p theo. Tuy nhiÃªn náº¿u trong thá»i gian frame hiá»‡n táº¡i chÆ°a káº¿t thÃºc, ta muá»‘n láº¥y giÃ¡ trá»‹ kÃ­ch thÆ°á»›c cá»§a element thÃ¬ lÃºc nÃ y browser buá»™c pháº£i thá»±c hiá»‡n tÃ­nh toÃ¡n layout láº¡i sá»›m hÆ¡n so vá»›i thÃ´ng thÆ°á»ng Ä‘á»ƒ cÃ³ thá»ƒ tráº£ vá» káº¿t quáº£. Hiá»‡n tÆ°á»£ng nÃ y gá»i lÃ  â€œforced synchronous layoutâ€ â€“ táº¡m dá»‹ch â€œkÃ­ch hoáº¡t layout sá»›mâ€, vÃ  nÃ³ gÃ¢y ra váº¥n Ä‘á» vá» performance khi ta pháº£i thá»±c hiá»‡n nhiá»u tÃ¡c vá»¥ hÆ¡n trong 1 frame. Äá»ƒ giáº£i quyáº¿t, cÃ¡ch nhanh nháº¥t lÃ  chÃºng ta sáº½ â€œÄ‘á»c trÆ°á»›c, ghi sauâ€. 1234567891011// Readvar h1 = element1.clientHeight;var h2 = element2.clientHeight;var h3 = element3.clientHeight; // Write (invalidates layout)element1.style.height = (h1 * 2) + 'px';element2.style.height = (h2 * 2) + 'px';element3.style.height = (h3 * 2) + 'px'; // Document reflows at end of frame Hoáº·c sá»­ dá»¥ng requestAnimationFrame Ä‘á»ƒ â€œháº¹n giá»â€ cho cáº£ 3 thao tÃ¡c ghi vÃ o frame tiáº¿p theo: 123456789101112131415// Readvar h1 = element1.clientHeight; // WriterequestAnimationFrame(function() &#123; element1.style.height = (h1 * 2) + 'px';&#125;); // Readvar h2 = element2.clientHeight; // WriterequestAnimationFrame(function() &#123; element2.style.height = (h2 * 2) + 'px';&#125;); Báº±ng cÃ¡ch nÃ y, cáº£ 3 thao tÃ¡c ghi Ä‘á»u sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n má»™t láº§n trong frame tiáº¿p theo, tá»‘t hÆ¡n cho hiá»‡u suáº¥t. Báº¡n sáº½ tháº¥y rÃµ tÃ¡c dá»¥ng cá»§a viá»‡c háº¡n cháº¿ layout sá»›m trong má»™t sá»‘ trÆ°á»ng há»£p thá»±c táº¿ nhÆ° sau â€œLayout thrashingâ€: 1234// Puts the browser into a read-write-read-write cycle.for (var i = 0; i &lt; paragraphs.length; i++) &#123; paragraphs[i].style.width = box.offsetWidth + 'px';&#125; NhÆ° Ä‘oáº¡n code trÃªn, layout sáº½ liÃªn tá»¥c bá»‹ trigger vÃ  kÃ­ch hoáº¡t sá»›m á»Ÿ trong vÃ²ng láº·p (read: box.offsetWidth, vÃ  write: paragraphs[i].style.width) Ä‘iá»u nÃ y lÃ  tháº£m há»a cho browser (hÃ¬nh: dáº¥u cháº¥m than vÃ ng lÃ  bÃ¡o hiá»‡u forced synchronous layout). Náº¿u Ä‘Ã£ biáº¿t vá» váº¥n Ä‘á» forced synchronous layout, Ä‘oáº¡n code trÃªn nÃªn Ä‘Æ°á»£c viáº¿t láº¡i nhÆ° sau: 123456789// Read.var width = box.offsetWidth; function resizeAllParagraphsToMatchBlockWidth() &#123; for (var i = 0; i &lt; paragraphs.length; i++) &#123; // Now write. paragraphs[i].style.width = width + 'px'; &#125;&#125; Náº¿u cáº£m tháº¥y viá»‡c quáº£n lÃ½ layout quÃ¡ phá»©c táº¡p, báº¡n cÃ³ thá»ƒ tham kháº£o sá»­ dá»¥ng thÆ° viá»‡n FastDOM, thÆ° viá»‡n nÃ y giÃºp báº¡n quáº£n lÃ½ cÃ¡c tÃ¡c vá»¥ read/write Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng gÃ¢y ra forced synchronous layout. BÆ°á»›c 4: Paint4.1. DÃ¹ng Chrome Developer Tools Ä‘á»ƒ phÃ¡t hiá»‡n váº¥n Ä‘á» performance khi paintBáº¥t ká»³ sá»± thay Ä‘á»•i nÃ o trÃªn mÃ n hÃ¬nh browser Ä‘á»u yÃªu cáº§u quÃ¡ trÃ¬nh paint, animation, transition, lÃºc bÃ´i Ä‘en Ä‘oáº¡n text hay cáº£ con trá» nháº¥p nhÃ¡y á»Ÿ textbox. Äá»ƒ biáº¿t Ä‘Æ°á»£c browser pháº£i váº½ láº¡i nhá»¯ng pháº§n nÃ o trÃªn mÃ n hÃ¬nh, báº¡n cÃ³ thá»ƒ báº­t chá»©c nÄƒng â€œShow paint rectanglesâ€ á»Ÿ tab â€œRenderingâ€ trong Chrome Developer Tools. Nhá»¯ng vÃ¹ng bá»‹ váº½ láº¡i sáº½ Ä‘Æ°á»£c tÃ´ vÃ  hiá»ƒn thá»‹ mÃ u xanh lÃ¡ cÃ¢y trÃªn mÃ n hÃ¬nh. Báº¡n cÃ³ thá»ƒ xem chi tiáº¿t hoáº¡t Ä‘á»™ng váº½ cá»§a browser báº±ng cÃ¡ch kÃ­ch hoáº¡t cháº¿ Ä‘á»™ â€œPaint profilerâ€ á»Ÿ tab â€œTimelineâ€ khi record. á» cháº¿ Ä‘á»™ nÃ y, báº¡n cÃ³ thá»ƒ kiá»ƒm tra quÃ¡ trÃ¬nh váº½ cá»§a táº¥t cáº£ cÃ¡c element trong web page. Dá»±a vÃ o cÃ¡c thÃ´ng tin nÃ y báº¡n cÃ³ thá»ƒ phÃ¢n tÃ­ch vÃ  Ä‘Æ°a ra hÆ°á»›ng giáº£i quyáº¿t phÃ¹ há»£p náº¿u quÃ¡ trÃ¬nh paint máº¥t quÃ¡ nhiá»u thá»i gian. Má»™t sá»‘ yáº¿u tá»‘ khiáº¿n quÃ¡ trÃ¬nh paint diá»…n ra cháº­m: CÃ¡c hiá»‡u á»©ng CSS phá»©c táº¡p: box-shadow, gradient, curves CÃ¡c element chá»“ng Ä‘Ã¨ lÃªn nhau. CÃ¡c hÃ¬nh áº£nh cÃ³ kÃ­ch thÆ°á»›c quÃ¡ lá»›n â€¦ 4.2. Sá»­ dá»¥ng há»£p lÃ½ cÃ¡c layerTrÃªn thá»±c táº¿, quÃ¡ trÃ¬nh váº½ diá»…n ra song song trÃªn nhiá»u cÃ¡c layer khÃ¡c nhau, viá»‡c phÃ¢n chia cÃ¡c layer há»£p lÃ½ sáº½ giÃºp tiáº¿t kiá»‡m Ä‘Æ°á»£c thá»i gian váº½ ráº¥t nhiá»u. VÃ­ dá»¥ trong trÆ°á»ng há»£p nÃ y, khi báº¡n cuá»™n trang thÃ¬ browser pháº£i váº½ láº¡i layer trÃªn cÃ¹ng (text), cÃ²n layer hÃ¬nh bÃªn dÆ°á»›i cÃ³ vá»‹ trÃ­ cá»‘ Ä‘á»‹nh, khÃ´ng cÃ³ gÃ¬ thay Ä‘á»•i nÃªn khÃ´ng cáº§n pháº£i váº½ láº¡i ná»¯a. CÃ¡c layer nÃ y sáº½ Ä‘Æ°á»£c gá»™p láº¡i (á»Ÿ bÆ°á»›c cuá»‘i cÃ¹ng â€“ composite) vÃ  hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh. LÃ m sao Ä‘á»ƒ táº¡o layer? Váº½ â€“ Paint â€“ lÃ  tÃ¡c vá»¥ náº·ng nháº¥t, chiáº¿m nhiá»u thá»i gian nháº¥t trong cÃ¡c bÆ°á»›c, do Ä‘Ã³ báº¡n cÃ³ thá»ƒ tháº¥y rÃµ Ä‘Æ°á»£c lá»£i Ã­ch cá»§a viá»‡c phÃ¢n chia cÃ¡c layer lÃ m sao cho browser Ã­t pháº£i váº½ láº¡i nháº¥t. Má»™t layer (compositor layer) sáº½ Ä‘Æ°á»£c táº¡o khi báº¡n sá»­ dá»¥ng thuá»™c tÃ­nh will-change (trÃªn Chrome, Opera, Firefox) thuá»™c tÃ­nh nÃ y bÃ¡o hiá»‡u cho browser biáº¿t element sáº½ cÃ³ sá»± thay Ä‘á»•i, do Ä‘Ã³ sáº½ Ä‘Æ°a element nÃ y vÃ o má»™t layer má»›i. 1.moving-element &#123; will-change: transform; &#125; Äá»‘i vá»›i cÃ¡c browser khÃ´ng há»— trá»£ will-change báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng thuá»™c tÃ­nh 3D transform Ä‘á»ƒ â€œÃ©p buá»™câ€ táº¡o layer má»›i: 1.moving-element &#123; transform: translateZ(0); &#125; Cáº§n lÆ°u Ã½, viá»‡c táº¡o layer má»›i sáº½ yÃªu cáº§u thÃªm bá»™ nhá»› vÃ  tÃ¡c vá»¥ Ä‘á»ƒ quáº£n lÃ½ cÃ¡c layer, do Ä‘Ã³ báº¡n khÃ´ng nÃªn táº¡o quÃ¡ nhiá»u layer, vÃ  chiáº¿n lÆ°á»£c tao layer á»Ÿ Ä‘Ã¢y khÃ´ng cá»‘ Ä‘á»‹nh mÃ  cÃ²n tÃ¹y thuá»™c vÃ o tÃ­nh cháº¥t cá»§a cÃ¡c animation, transition cÃ³ trÃªn website cá»§a báº¡n. KhÃ´ng nÃªn: (layer explosions â€“ táº¡o ra quÃ¡ nhiá»u layer khÃ´ng cáº§n thiáº¿t) 1234* &#123; will-change: transform; transform: translateZ(0);&#125; BÆ°á»›c 5: CompositeTáº¡i bÆ°á»›c nÃ y, browser sáº½ tiáº¿n hÃ nh gá»™p cÃ¡c compositor layer Ä‘Ã£ Ä‘Æ°á»£c váº½ (á»Ÿ bÆ°á»›c 4) vÃ  hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh. TrÆ°á»ng há»£p lÃ½ tÆ°á»Ÿng nháº¥t cho performance lÃ  bá» qua 2 bÆ°á»›c Layout vÃ  Paint, cÃ´ng viá»‡c cá»§a browser chá»‰ lÃ  thay Ä‘á»•i cÃ¡c compositor layer Ä‘á»ƒ táº¡o ra má»™t frame. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³, báº¡n chá»‰ Ä‘Æ°á»£c thay Ä‘á»•i cÃ¡c thuá»™c tÃ­nh mÃ  Compositor cÃ³ thá»ƒ xá»­ lÃ½ Ä‘á»™c láº­p (mÃ  khÃ´ng cáº§n pháº£i kÃ­ch hoáº¡t Layout vÃ  Paint). CÃ¡c thuá»™c tÃ­nh Ä‘Ã³ lÃ  transform vÃ  opacity. Tuy nhiÃªn trÃªn thá»±c táº¿ chÃºng ta cáº§n pháº£i thay Ä‘á»•i nhiá»u thuá»™c tÃ­nh hÆ¡n ná»¯a Ä‘á»ƒ Ä‘Ã¡p á»©ng Ä‘Æ°á»£c yÃªu cáº§u khi animate cÃ¡c hiá»‡u á»©ng. Do Ä‘Ã³, giáº£i phÃ¡p chÃ­nh lÃ  pháº£i táº¡o vÃ  quáº£n lÃ½ Ä‘Æ°á»£c cÃ¡c layer má»™t cÃ¡ch há»£p lÃ½. Äá»ƒ quáº£n lÃ½ Ä‘Æ°á»£c cÃ¡c layer, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ´ng cá»¥ Chrome Developer Tools. Trong tab â€œTimelineâ€ Ä‘Ã¡nh dáº¥u vÃ o má»¥c Paint Tiáº¿n hÃ nh record vÃ  chá»n pháº§n Paint trÃªn káº¿t quáº£ hiá»ƒn thá»‹ á» Ä‘Ã¢y báº¡n sáº½ tháº¥y tháº» â€œLayerâ€ trong pháº§n thÃ´ng tin cá»§a frame Tá»« Ä‘Ã¢y báº¡n cÃ³ thá»ƒ tra cá»©u toÃ n bá»™ cÃ¡c frame mÃ  web page Ä‘ang cÃ³. Danh sÃ¡ch cÃ¡c layer Ä‘Æ°á»£c liá»‡t kÃª dÆ°á»›i dáº¡ng cÃ¢y (layer tree), preview dáº¡ng 3D, cÃ³ thÃ´ng tin vá» kÃ­ch thÆ°á»›c, bá»™ nhá»›, lÃ½ do layer Ä‘Æ°á»£c táº¡oâ€¦ Tá»•ng káº¿tNhÆ° váº­y lÃ  ta Ä‘Ã£ Ä‘i tá»«ng bÆ°á»›c Ä‘á»ƒ cÃ³ thá»ƒ tá»‘i Æ°u hiá»‡u suáº¥t render cho web page: JavaScript â€“ DÃ¹ng requestAnimationFrame â€“ DÃ¹ng Web workers, Micro-task cho tÃ¡c vá»¥ náº·ng â€“ Profiling with Chrome DevTools Style â€“ Giáº£m Ä‘á»™ phá»©c táº¡p cá»§a selector â€“ Giáº£m sá»‘ lÆ°á»£ng element bá»‹ áº£nh hÆ°á»Ÿng Layout â€“ Háº¡n cháº¿ kÃ­ch hoáº¡t layout â€“ Sá»­ dá»¥ng Flexbox â€“ Háº¡n cháº¿ forced synchronous layout. Paint â€“ Paint lÃ  tÃ¡c vá»¥ xá»­ lÃ½ lÃ¢u nháº¥t â€“ Box-shadow, large image khÃ´ng tá»‘t cho paint â€“ Táº¡o vÃ  quáº£n lÃ½ layer há»£p lÃ½ Composite â€“ Sá»­ dá»¥ng transform vÃ  opacity â€“ Quáº£n lÃ½ cÃ¡c layer báº±ng Chrome DevTools Sau khi Ä‘Ã£ thá»±c hiá»‡n nhá»¯ng bÆ°á»›c trÃªn, web page cá»§a báº¡n sáº½ hoáº¡t Ä‘á»™ng mÆ°á»£t mÃ , trÆ¡n tru vá»›i 60fps. ChÃºc báº¡n thÃ nh cÃ´ng! 60FPS FOR THE WIN! Chuyá»‡n ngoÃ i lá»á» Silicon Straits Saigon, chÃºng tÃ´i cÃ³ má»™t bÃ i test dÃ nh cho Front-end Developer, Ä‘Ã³ lÃ  implement hiá»‡u á»©ng scrolling sau (áº£nh Ä‘á»™ng, load hÆ¡i lÃ¢u): http://bit.ly/1CCYx9y CÃ¡c báº¡n cÃ³ thá»ƒ váº­n dá»¥ng nhá»¯ng kiáº¿n thá»©c cÃ³ Ä‘Æ°á»£c trong bÃ i viáº¿t nÃ y Ä‘á»ƒ â€œthá»­ sá»©câ€ vá»›i hiá»‡u á»©ng trÃªn. ÄÃ¢y lÃ  bÃ i lÃ m cá»§a tÃ´i, máº·c dÃ¹ khÃ´ng Ä‘Æ°á»£c hoÃ n háº£o nhÆ°ng cÃ³ thá»ƒ dÃ¹ng Ä‘Æ°á»£c cho má»¥c Ä‘Ã­ch tham kháº£o. Link: http://trungdq88.github.io/css-stuffs/delay-scroll/ Timeline Record: Layers (má»™t pháº§n): CÃ¡c nguá»“n tham kháº£o trong bÃ i viáº¿t:Má»™t sá»‘ hÃ¬nh áº£nh vÃ  code máº«u: Google Developer: https://developers.google.com/web/fundamentals/performance/ Preventing Layout Thrashing:http://wilsonpage.co.uk/preventing-layout-thrashing/ CÃ¡c trang web cÃ³ hiá»‡u á»©ng Ä‘áº¹p: http://world.mathigon.org/ http://matthew.wagerfield.com/parallax/ KhÃ³a há»c: Udacity Course: Browser Rendering Optimization â€“ Building 60 FPS Web Apps: https://www.udacity.com/course/browser-rendering-optimizationâ€“ud860 CÃ¡c nguá»“n khÃ¡c: Web Workers: https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/basic_usage BEM: https://bem.info/ PostCSS: https://github.com/postcss/postcss CSS Trigger: http://csstriggers.com/ Guide to Flexbox: http://css-tricks.com/snippets/css/a-guide-to-flexbox/ FastDOM: https://github.com/wilsonpage/fastdom","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"10 cÃ¢u há»i phá»ng váº¥n mÃ  Javascript Developer nÃªn biáº¿t","slug":"10-cau-hoi-phong-van-ma-Javascript-Developer-nen-biet","date":"2018-06-23T15:11:00.000Z","updated":"2018-06-23T15:28:47.131Z","comments":true,"path":"2018/06/10-cau-hoi-phong-van-ma-Javascript-Developer-nen-biet.html","link":"","permalink":"http://nthung2112.github.io/2018/06/10-cau-hoi-phong-van-ma-Javascript-Developer-nen-biet.html","excerpt":"Táº¡i háº§u háº¿t cÃ¡c cÃ´ng ty, ngÆ°á»i quáº£n lÃ½ pháº£i tin tÆ°á»Ÿng cÃ¡c developers, cho há» tham gia cÃ¡c cuá»™c phá»ng váº¥n ká»¹ thuáº­t Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ cÃ¡c ká»¹ nÄƒng á»©ng cá»­ viÃªn. Náº¿u báº¡n lÃ m tá»‘t nhÆ° má»™t á»©ng cá»­ viÃªn, báº¡n sáº½ cáº§n pháº£i phá»ng váº¥n. ÄÃ¢y lÃ  cÃ¡ch lÃ m.","text":"Táº¡i háº§u háº¿t cÃ¡c cÃ´ng ty, ngÆ°á»i quáº£n lÃ½ pháº£i tin tÆ°á»Ÿng cÃ¡c developers, cho há» tham gia cÃ¡c cuá»™c phá»ng váº¥n ká»¹ thuáº­t Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ cÃ¡c ká»¹ nÄƒng á»©ng cá»­ viÃªn. Náº¿u báº¡n lÃ m tá»‘t nhÆ° má»™t á»©ng cá»­ viÃªn, báº¡n sáº½ cáº§n pháº£i phá»ng váº¥n. ÄÃ¢y lÃ  cÃ¡ch lÃ m. It Starts With PeopleIn â€œHow to Build a High Velocity Development Teamâ€, TÃ´i Ä‘Ã£ nÃªu má»™t vÃ i Ä‘iá»ƒm Ä‘Ã¡ng Ä‘á»ƒ láº·p láº¡i: â€œNothing predicts business outcomes better than an exceptional team. If youâ€™re going to beat the odds, you need to invest here, first.â€ NhÆ° Marcus Lemonis Ä‘Ã£ nÃ³i, cáº§n táº­p trung vÃ o 3 Pâ€™s: â€œPeople, Process, Productâ€ Your early hires should be very strong, senior-level candidates. People who can hire and mentor other developers, and help the mid-level and junior developers youâ€™ll eventually want to hire down the road. Read â€œWhy Hiring is So Hard in Techâ€ for a good breakdown of the general doâ€™s and donâ€™ts of candidate evaluation. The best way to evaluate a candidate is a pair programming exercise. Pair program with the candidate. Let the candidate drive. Watch and listen more than you talk. A good project might be to pull tweets from the Twitter API and display them on a timeline. That said, no single exercise will tell you everything you need to know. An interview can be a very useful tool as well, but donâ€™t waste time asking about syntax or language quirks. You need to see the big picture. Ask about architecture and paradigms â€” the big decisions that can have a major impact on the whole project. Syntax and features are easy to Google. Itâ€™s much harder to Google for software engineering wisdom or the common paradigms and idioms JavaScript developers pick up with experience. JavaScript is special, and it plays a critical role in almost every large application. What is it about JavaScript that makes it meaningfully different from other languages? Here are some questions that will help you explore the stuff that really matters: 1. Can you name two programming paradigms important for JavaScript app developers?JavaScript is a multi-paradigm language, supporting imperative/procedural programming along with OOP (Object-Oriented Programming) and functional programming. JavaScript supports OOP with prototypal inheritance. Good to hear: Prototypal inheritance (also: prototypes, OLOO). Functional programming (also: closures, first class functions, lambdas). Red flags: No clue what a paradigm is, no mention of prototypal oo or functional programming. 2. What is functional programming?Functional programming produces programs by composing mathematical functions and avoids shared state &amp; mutable data. Lisp (specified in 1958) was among the first languages to support functional programming, and was heavily inspired by lambda calculus. Lisp and many Lisp family languages are still in common use today. Functional programming is an essential concept in JavaScript (one of the two pillars of JavaScript). Several common functional utilities were added to JavaScript in ES5. Good to hear: Pure functions / function purity. Avoid side-effects. Simple function composition. Examples of functional languages: Lisp, ML, Haskell, Erlang, Clojure, Elm, F Sharp, OCaml, etcâ€¦ Mention of features that support FP: first-class functions, higher order functions, functions as arguments/values. Red flags: No mention of pure functions / avoiding side-effects. Unable to provide examples of functional programming languages. Unable to identify the features of JavaScript that enable FP. 3. What is the difference between classical inheritance and prototypal inheritance?Class Inheritance: instances inherit from classes (like a blueprint â€” a description of the class), and create sub-class relationships: hierarchical class taxonomies. Instances are typically instantiated via constructor functions with the new keyword. Class inheritance may or may not use the class keyword from ES6. Prototypal Inheritance: instances inherit directly from other objects. Instances are typically instantiated via factory functions or Object.create(). Instances may be composed from many different objects, allowing for easy selective inheritance. In JavaScript, prototypal inheritance is simpler &amp;more flexible than class inheritance. Good to hear: Classes: create tight coupling or hierarchies/taxonomies. Prototypes: mentions of concatenative inheritance, prototype delegation, functional inheritance, object composition. Red Flags: No preference for prototypal inheritance &amp; composition over class inheritance. 4. What are the pros and cons of functional programming vs object-oriented programming?OOP Pros: Itâ€™s easy to understand the basic concept of objects and easy to interpret the meaning of method calls. OOP tends to use an imperative style rather than a declarative style, which reads like a straight-forward set of instructions for the computer to follow. OOP Cons: OOP Typically depends on shared state. Objects and behaviors are typically tacked together on the same entity, which may be accessed at random by any number of functions with non-deterministic order, which may lead to undesirable behavior such as race conditions. FP Pros: Using the functional paradigm, programmers avoid any shared state or side-effects, which eliminates bugs caused by multiple functions competing for the same resources. With features such as the availability of point-free style (aka tacit programming), functions tend to be radically simplified and easily recomposed for more generally reusable code compared to OOP. FP also tends to favor declarative and denotational styles, which do not spell out step-by-step instructions for operations, but instead concentrate on what to do, letting the underlying functions take care of the how. This leaves tremendous latitude for refactoring and performance optimization, even allowing you to replace entire algorithms with more efficient ones with very little code change. (e.g., memoize, or use lazy evaluation in place of eager evaluation.) Computation that makes use of pure functions is also easy to scale across multiple processors, or across distributed computing clusters without fear of threading resource conflicts, race conditions, etcâ€¦ FP Cons: Over exploitation of FP features such as point-free style and large compositions can potentially reduce readability because the resulting code is often more abstractly specified, more terse, and less concrete. More people are familiar with _OO_ and imperative programming than functional programming, so even common idioms in functional programming can be confusing to new team members. FP has a much steeper learning curve than OOP because the broad popularity of OOP has allowed the language and learning materials of OOP to become more conversational, whereas the language of FP tends to be much more academic and formal. FP concepts are frequently written about using idioms and notations from lambda calculus, algebras, and category theory, all of which requires a prior knowledge foundation in those domains to be understood. Good to hear: Mentions of trouble with shared state, different things competing for the same resources, etcâ€¦ Awareness of FPâ€™s capability to radically simplify many applications. Awareness of the differences in learning curves. Articulation of side-effects and how they impact program maintainability. Awareness that a highly functional codebase can have a steep learning curve. Awareness that a highly OOP codebase can be extremely resistant to change and very brittle compared to an equivalent FP codebase. Awareness that immutability gives rise to an extremely accessible and malleable program state history, allowing for the easy addition of features like infinite undo/redo, rewind/replay, time-travel debugging, and so on. Immutability can be achieved in either paradigm, but a proliferation of shared stateful objects complicates the implementation in OOP. Red flags: Unable to list disadvantages of one style or another â€” Anybody experienced with either style should have bumped up against some of the limitations. Learn More: The Two Pillars of JavaScript Part 1 â€” Prototypal OO. The Two Pillars of JavaScript Part 2 â€” Functional Programming. 5. When is classical inheritance an appropriate choice?The answer is never, or almost never. Certainly never more than one level. Multi-level class hierarchies are an anti-pattern. Iâ€™ve been issuing this challenge for years, and the only answers Iâ€™ve ever heard fall into one of several common misconceptions. More frequently, the challenge is met with silence. â€œIf a feature is sometimes usefuland sometimes dangerousand if there is a better optionthen always use the better option.â€~ Douglas Crockford Good to hear: Rarely, almost never, or never. A single level is sometimes OK, from a framework base-class such as React.Component. â€œFavor object composition over class inheritance.â€ 6. When is prototypal inheritance an appropriate choice?There is more than one type of prototypal inheritance: Delegation (i.e., the prototype chain). Concatenative (i.e. mixins, Object.assign()). Functional (Not to be confused with functional programming. A function used to create a closure for private state/encapsulation). Each type of prototypal inheritance has its own set of use-cases, but all of them are equally useful in their ability to enable composition, which creates has-a or uses-a or can-do relationships as opposed to the is-a relationship created with class inheritance. Good to hear: In situations where modules or functional programming donâ€™t provide an obvious solution. When you need to compose objects from multiple sources. Any time you need inheritance. Red flags: No knowledge of when to use prototypes. No awareness of mixins or Object.assign(). 7. What does â€œfavor object composition over class inheritanceâ€ mean?This is a quote from â€œDesign Patterns: Elements of Reusable Object-Oriented Softwareâ€. It means that code reuse should be achieved by assembling smaller units of functionality into new objects instead of inheriting from classes and creating object taxonomies. In other words, use can-do, has-a, or uses-a relationships instead of is-a relationships. Good to hear: Avoid class hierarchies. Avoid brittle base class problem. Avoid tight coupling. Avoid rigid taxonomy (forced is-a relationships that are eventually wrong for new use cases). Avoid the gorilla banana problem (â€œwhat you wanted was a banana, what you got was a gorilla holding the banana, and the entire jungleâ€). Make code more flexible. Red Flags: Fail to mention any of the problems above. Fail to articulate the difference between composition and class inheritance, or the advantages of composition. 8. What are two-way data binding and one-way data flow, and how are they different?Two way data binding means that UI fields are bound to model data dynamically such that when a UI field changes, the model data changes with it and vice-versa. One way data flow means that the model is the single source of truth. Changes in the UI trigger messages that signal user intent to the model (or â€œstoreâ€ in React). Only the model has the access to change the appâ€™s state. The effect is that data always flows in a single direction, which makes it easier to understand. One way data flows are deterministic, whereas two-way binding can cause side-effects which are harder to follow and understand. Good to hear: React is the new canonical example of one-way data flow, so mentions of React are a good signal. Cycle.js is another popular implementation of uni-directional data flow. Angular is a popular framework which uses two-way binding. Red flags: No understanding of what either one means. Unable to articulate the difference. 9. What are the pros and cons of monolithic vs microservice architectures?A monolithic architecture means that your app is written as one cohesive unit of code whose components are designed to work together, sharing the same memory space and resources. A microservice architecture means that your app is made up of lots of smaller, independent applications capable of running in their own memory space and scaling independently from each other across potentially many separate machines. Monolithic Pros: The major advantage of the monolithic architecture is that most apps typically have a large number of cross-cutting concerns, such as logging, rate limiting, and security features such audit trails and DOS protection. When everything is running through the same app, itâ€™s easy to hook up components to those cross-cutting concerns. There can also be performance advantages, since shared-memory access is faster than inter-process communication (IPC). Monolithic cons: Monolithic app services tend to get tightly coupled and entangled as the application evolves, making it difficult to isolate services for purposes such as independent scaling or code maintainability. Monolithic architectures are also much harder to understand, because there may be dependencies, side-effects, and magic which are not obvious when youâ€™re looking at a particular service or controller. Microservice pros: Microservice architectures are typically better organized, since each microservice has a very specific job, and is not concerned with the jobs of other components. Decoupled services are also easier to recompose and reconfigure to serve the purposes of different apps (for example, serving both the web clients and public API). They can also have performance advantages depending on how theyâ€™re organized because itâ€™s possible to isolate hot services and scale them independent of the rest of the app. Microservice cons: As youâ€™re building a new microservice architecture, youâ€™re likely to discover lots of cross-cutting concerns that you did not anticipate at design time. A monolithic app could establish shared magic helpers or middleware to handle such cross-cutting concerns without much effort. In a microservice architecture, youâ€™ll either need to incur the overhead of separate modules for each cross-cutting concern, or encapsulate cross-cutting concerns in another service layer that all traffic gets routed through. Eventually, even monolthic architectures tend to route traffic through an outer service layer for cross-cutting concerns, but with a monolithic architecture, itâ€™s possible to delay the cost of that work until the project is much more mature. Microservices are frequently deployed on their own virtual machines or containers, causing a proliferation of VM wrangling work. These tasks are frequently automated with container fleet management tools. Good to hear: Positive attitudes toward microservices, despite the higher initial cost vs monolthic apps. Aware that microservices tend to perform and scale better in the long run. Practical about microservices vs monolithic apps. Structure the app so that services are independent from each other at the code level, but easy to bundle together as a monolithic app in the beginning. Microservice overhead costs can be delayed until it becomes more practical to pay the price. Red flags: Unaware of the differences between monolithic and microservice architectures. Unaware or impractical about the additional overhead of microservices. Unaware of the additional performance overhead caused by IPC and network communication for microservices. Too negative about the drawbacks of microservices. Unable to articulate ways in which to decouple monolithic apps such that theyâ€™re easy to split into microservices when the time comes. Underestimates the advantage of independently scalable microservices. 10. What is asynchronous programming, and why is it important in JavaScript?Synchronous programming means that, barring conditionals and function calls, code is executed sequentially from top-to-bottom, blocking on long-running tasks such as network requests and disk I/O. Asynchronous programming means that the engine runs in an event loop. When a blocking operation is needed, the request is started, and the code keeps running without blocking for the result. When the response is ready, an interrupt is fired, which causes an event handler to be run, where the control flow continues. In this way, a single program thread can handle many concurrent operations. User interfaces are asynchronous by nature, and spend most of their time waiting for user input to interrupt the event loop and trigger event handlers. Node is asynchronous by default, meaning that the server works in much the same way, waiting in a loop for a network request, and accepting more incoming requests while the first one is being handled. This is important in JavaScript, because it is a very natural fit for user interface code, and very beneficial to performance on the server. Good to hear: An understanding of what blocking means, and the performance implications. An understanding of event handling, and why its important for UI code. Red flags: Unfamiliar with the terms asynchronous or synchronous. Unable to articulate performance implications or the relationship between asynchronous code and UI code. ConclusionStick to high-level topics. If they can answer these questions, that typically means that they have enough programming experience to pick up language quirks &amp; syntax in a few weeks, even if they donâ€™t have a lot of JavaScript experience. Donâ€™t disqualify candidates based on stuff thatâ€™s easy to learn (including classic CS-101 algorithms, or any type of puzzle problem). What you really need to know is, â€œdoes this candidate understand how to put an application together?â€ Thatâ€™s it for the spoken interview. In real interviews, I place a much stronger emphasis on coding challenges and watching candidates code. Those topics are covered in depth in my â€œMaster the JavaScript Interviewâ€ series.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Local Storage, Session Storage vÃ  Cookie","slug":"Local-Storage-Session-Storage-va-Cookie","date":"2018-06-23T11:40:00.000Z","updated":"2018-06-23T11:45:41.597Z","comments":true,"path":"2018/06/Local-Storage-Session-Storage-va-Cookie.html","link":"","permalink":"http://nthung2112.github.io/2018/06/Local-Storage-Session-Storage-va-Cookie.html","excerpt":"Sá»± khÃ¡c nhau vÃ  cÃ¡ch sá»­ dá»¥ng Local Storage, Session Storage vÃ  CookieBáº¡n bá»‹ láº«n lá»™n giá»¯a session storage, local storage vÃ  cookies? BÃ i viáº¿t dÆ°á»›i Ä‘Ã¢y sáº½ giÃºp báº¡n hiá»ƒu rÃµ Ä‘Æ°á»£c sá»± khÃ¡c nhau giá»¯a 3 cÃ¡ch lÆ°u trá»¯ nÃ y. CÃ¡c kiá»ƒu khÃ´ng gian lÆ°u trá»¯ khÃ¡c nhau cÃ³ sáºµn cho cÃ¡c dá»¯ liá»‡u cÃ³ thá»ƒ trÃªn mÃ¡y chá»§ hoáº·c mÃ¡y khÃ¡ch, cho phÃ©p chÃºng ta chá»n lá»±a theo nhu cáº§u.","text":"Sá»± khÃ¡c nhau vÃ  cÃ¡ch sá»­ dá»¥ng Local Storage, Session Storage vÃ  CookieBáº¡n bá»‹ láº«n lá»™n giá»¯a session storage, local storage vÃ  cookies? BÃ i viáº¿t dÆ°á»›i Ä‘Ã¢y sáº½ giÃºp báº¡n hiá»ƒu rÃµ Ä‘Æ°á»£c sá»± khÃ¡c nhau giá»¯a 3 cÃ¡ch lÆ°u trá»¯ nÃ y. CÃ¡c kiá»ƒu khÃ´ng gian lÆ°u trá»¯ khÃ¡c nhau cÃ³ sáºµn cho cÃ¡c dá»¯ liá»‡u cÃ³ thá»ƒ trÃªn mÃ¡y chá»§ hoáº·c mÃ¡y khÃ¡ch, cho phÃ©p chÃºng ta chá»n lá»±a theo nhu cáº§u. 1. Local storageGiá»›i thiá»‡u: Kháº£ nÄƒng lÆ°u trá»¯ vÃ´ thá»i háº¡n: CÃ³ nghÄ©a lÃ  chá»‰ bá»‹ xÃ³a báº±ng JavaScript, hoáº·c xÃ³a bá»™ nhá»› trÃ¬nh duyá»‡t, hoáº·c xÃ³a báº±ng localStorage API. LÆ°u trá»¯ Ä‘Æ°á»£c 5MB: Local Storage cho phÃ©p báº¡n lÆ°u trá»¯ thÃ´ng tin tÆ°Æ¡ng Ä‘á»‘i lá»›n lÃªn Ä‘áº¿n 5MB, lÆ°u Ä‘Æ°á»£c lÆ°á»£ng thÃ´ng tin lá»›n nháº¥t trong 3 loáº¡i. KhÃ´ng gá»­i thÃ´ng tin lÃªn server nhÆ° Cookie nÃªn báº£o máº­t tá»‘t hÆ¡n. TrÃ¬nh duyá»‡t há»— trá»£: TrÃ¬nh duyá»‡t PhiÃªn báº£n Chrome &gt;= 4.0 Internet Explorer / Edge &gt;= 8.0 Firefox &gt;= 3.5 Safari &gt;= 4.0 Chrome &gt;= 11.5 Äá»ƒ kiá»ƒm tra xem trÃ¬nh duyá»‡t cÃ³ há»— trá»£ localStorage hay khÃ´ng thÃ¬ chÃºng ta dÃ¹ng typeof nhÆ° sau: 12345678if (typeof(Storage) !== 'undefined') &#123; //Náº¿u cÃ³ há»— trá»£ //Thá»±c hiá»‡n thao tÃ¡c vá»›i Storage alert('TrÃ¬nh duyá»‡t cá»§a báº¡n há»— trá»£ Storage');&#125; else &#123; //Náº¿u khÃ´ng há»— trá»£ alert('TrÃ¬nh duyá»‡t cá»§a báº¡n khÃ´ng há»— trá»£ Storage');&#125; Xem localStorage báº±ng trÃ¬nh duyá»‡tÄá»ƒ xem localstorage báº±ng trÃ¬nh duyá»‡t cÃ¡c báº¡n vÃ o trang web cáº§n xem (á»Ÿ Ä‘Ã¢y mÃ¬nh vÃ­ dá»¥ vá»›i trang web http://book.framgia.vn/) vÃ  sau Ä‘Ã³ cÃ¡c báº¡n áº¥n F12 (hoáº·c Ctrl + shift + i) sau Ä‘Ã³ lÃ m theo nhÆ° hÃ¬nh sau: Chá»n tab Application, di chuyá»ƒn Ä‘áº¿n Storage Ä‘á»ƒ tháº¥y cÃ¡c Storage cá»§a trÃ¬nh duyá»‡t. Äá»ƒ xem cÃ¡c local Storage Ä‘ang Ä‘Æ°á»£c lÆ°u trá»¯, má»Ÿ rá»™ng pháº§n Local Storage nhÆ° hÃ¬nh. á» Ä‘Ã¢y ta cÃ³ thá»ƒ tháº¥y cÃ³ 2 biáº¿n Local Storage Ä‘ang Ä‘Æ°á»£c lÆ°u lÃ  pusherTransportEncrypted vÃ  lang vá»›i giÃ¡ trá»‹ cá»§a 2 biáº¿n Ä‘Æ°á»£c hiá»ƒn thá»‹ bÃªn cáº¡nh (cá»™t Value). NhÆ° váº­y, cá»™t Key chÃ­nh lÃ  danh sÃ¡ch cÃ¡c biáº¿n local Storage Ä‘ang Ä‘Æ°á»£c lÆ°u vÃ  cá»™t Value lÃ  cÃ¡c giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng. Äá»ƒ xÃ³a háº¿t cÃ¡c giÃ¡ trá»‹ local Storage nÃ y Ä‘i, báº¡n cÃ³ thá»ƒ chá»n biá»ƒu tÆ°á»£ng cáº¥m (Clear All) hoáº·c chá»n bÃªn cáº¡nh lÃ  biá»ƒu tÆ°á»£ng dáº¥u X (Delete Selected). Sá»­ dá»¥ng Khá»Ÿi táº¡o localStorage 12345localStorage.setItem('key', 'value');// hoáº·clocalStorage.key = 'value';// hoáº·clocalStorage['key'] = 'value'; Trong Ä‘Ã³: key lÃ  tÃªn biáº¿n, value lÃ  giÃ¡ trá»‹ cá»§a biáº¿n muá»‘n gÃ¡n vÃ o. Äá»ƒ láº¥y giÃ¡ trá»‹ localStorage vÃ  sá»­ dá»¥ng, ta dÃ¹ng getItem 123localStorage.getItem('key');// hoáº·clocalStorage.key; VÃ­ dá»¥ cá»¥ thá»ƒ nhÆ° sau: Äá»ƒ láº¥y sá»‘ lÆ°á»£ng localStorage Ä‘Ã£ cÃ³ trong trÃ¬nh duyá»‡t, sá»­ dá»¥ng length nhÆ° sau: 1localStorage.length; VÃ­ dá»¥ 12345678if (typeof(Storage) !== \"undefined\") &#123; //Náº¿u há»— trá»£ var data = localStorage.length; console.log(data);&#125; else &#123; // Náº¿u khÃ´ng há»— trá»£ alert('TrÃ¬nh duyá»‡t cá»§a báº¡n khÃ´ng há»— trá»£');&#125; Äá»ƒ xÃ³a 1 biáº¿n trong localStorage, sá»­ dá»¥ng removeItem(tÃªn_key) 1localStorage.removeItem(key); Hoáº·c xÃ³a táº¥t cáº£ cÃ¡c biáº¿n trong localStorage, sá»­ dá»¥ng clear 1localStorage.clear(); 2. Session StorageGiá»›i thiá»‡u: LÆ°u trÃªn Client: CÅ©ng giá»‘ng nhÆ° localStorage thÃ¬ sessionStorage cÅ©ng dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u trÃªn trÃ¬nh duyá»‡t cá»§a khÃ¡ch truy cáº­p (client). Máº¥t dá»¯ liá»‡u khi Ä‘Ã³ng tab: Dá»¯ liá»‡u cá»§a sessionStorage sáº½ máº¥t khi báº¡n Ä‘Ã³ng trÃ¬nh duyá»‡t. Dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c gá»­i lÃªn Server ThÃ´ng tin lÆ°u trá»¯ nhiá»u hÆ¡n cookie (Ã­t nháº¥t 5MB) TrÃ¬nh duyá»‡t há»— trá»£ TrÃ¬nh duyá»‡t PhiÃªn báº£n Chrome &gt;= 5.0 Internet Explorer / Edge &gt;= 8.0 Firefox &gt;= 2 Safari &gt;= 4.0 Opera &gt;= 10.5 VÃ¬ sessionStorage cÅ©ng náº±m trong gÃ³i Storage nÃªn cÃ¡c báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng láº¡i Ä‘oáº¡n code kiá»ƒm tra trÃ¬nh duyá»‡t cÃ³ há»— trá»£ Storage hay khÃ´ng á»Ÿ phÃ­a trÃªn. Xem Session Storage báº±ng trÃ¬nh duyá»‡tTÆ°Æ¡ng tá»± nhÆ° localStorage, cÃ³ thá»ƒ chá»n má»Ÿ rá»™ng má»¥c Session Storage Ä‘á»ƒ xem cÃ¡c giÃ¡ trá»‹ Ä‘Æ°á»£c lÆ°u trá»¯. Sá»­ dá»¥ngsessionStorage cÅ©ng cÃ³ cÃº phÃ¡p vÃ  cÃ¡ch sá»­ dá»¥n cÃ¡c thuá»™c tÃ­nh, phÆ°Æ¡ng thá»©c nhÆ° localStorage: 1234567891011121314if ( typeof(Storage) !== 'undefined') &#123; // Khá»Ÿi táº¡o sesionStorage sessionStorage.setItem('name', 'Ted Mosby'); // get sessionStorage sessionStorage.getItem('name'); // láº¥y ra sá»‘ lÆ°á»£ng session Ä‘Ã£ lÆ°u trá»¯ sessionStorage.length; // xÃ³a 1 item localStorage sessionStorage.removeItem('name'); // xÃ³a táº¥t cáº£ item trong sessionStorage sessionStorage.clear();&#125; else &#123; alert('TrÃ¬nh duyá»‡t cá»§a báº¡n khÃ´ng há»— trá»£!');&#125; 3. CookieGiá»›i thiá»‡u: ThÃ´ng tin Ä‘Æ°á»£c gá»­i lÃªn server: Cookie sáº½ Ä‘Æ°á»£c truyá»n tá»« server tá»›i browser vÃ  Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn mÃ¡y tÃ­nh cá»§a báº¡n khi báº¡n truy cáº­p vÃ o á»©ng dá»¥ng, má»—i khi ngÆ°á»i dÃ¹ng táº£i á»©ng dá»¥ng, trÃ¬nh duyá»‡t sáº½ gá»­i cookie Ä‘á»ƒ thÃ´ng bÃ¡o cho á»©ng dá»¥ng vá» hoáº¡t Ä‘á»™ng trÆ°á»›c Ä‘Ã³ cá»§a báº¡n. VÃ¬ váº­y Ä‘á»«ng bao giá» lÆ°u trá»¯ nhá»¯ng thÃ´ng tin quan trá»ng, yÃªu cáº§u tÃ­nh báº£o máº­t cao vÃ o cookie vÃ¬ nÃ³ hoÃ n toÃ n cÃ³ thá»ƒ bá»‹ sá»­a Ä‘á»•i vÃ  Ä‘Ã¡nh cáº¯p, tháº¥p chÃ­ cÃ³ thá»ƒ lá»£i dá»¥ng Ä‘iá»u nÃ y Ä‘á»ƒ táº¥n cÃ´ng website cá»§a báº¡n. Cookie chá»§ yáº¿u lÃ  Ä‘á»ƒ Ä‘á»c phÃ­a mÃ¡y chá»§ (cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»c á»Ÿ phÃ­a mÃ¡y khÃ¡ch), localStorage vÃ  sessionStorage chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»c á»Ÿ phÃ­a mÃ¡y khÃ¡ch. CÃ³ thá»i gian sá»‘ng: Má»—i cookie thÆ°á»ng cÃ³ khoáº£ng thá»i gian timeout nháº¥t Ä‘á»‹nh do láº­p trÃ¬nh viÃªn xÃ¡c Ä‘á»‹nh trÆ°á»›c. LÆ°u trá»¯: cho phÃ©p lÆ°u trá»¯ tá»‘i Ä‘a 4KB vÃ  vÃ i chá»¥c cookie cho má»™t domain. Xem cookie báº±ng trÃ¬nh duyá»‡tTÆ°Æ¡ng tá»± nhÆ° localStorage, cÃ³ thá»ƒ chá»n má»Ÿ rá»™ng má»¥c Cookies Ä‘á»ƒ xem cÃ¡c giÃ¡ trá»‹ cookie Ä‘Æ°á»£c lÆ°u trá»¯ Sá»­ dá»¥ngCookie cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o báº±ng nhiá»u cÃ¡ch, bÃ i viáº¿t nÃ y sáº½ trÃ¬nh bÃ y vá» sá»­ dá»¥ng cookie trong javascript. JavaScript cÃ³ thá»ƒ táº¡o, Ä‘á»c, vÃ  xÃ³a cookies vá»›i document.cookie. Táº¡o cookie: Javascript cÃ³ thá»ƒ táº¡o cookie nhÆ° sau: 1document.cookie = 'username=Ted Mosby'; ChÃºng ta cÅ©ng cÃ³ thá»ƒ thÃªm vÃ o ngÃ y háº¿t háº¡n cho cookie 1document.cookie = 'username=Ted Mosby; expires=Thu, 18 Dec 2018 8:00:00 UTC'; Hoáº·c Ä‘áº·t háº¹n giá» sau bao lÃ¢u cookie sáº½ háº¿t háº¡n vá»›i max-age (tÃ­nh báº±ng giÃ¢y) 1document.cookie = 'username=Ted Mosby; max-age=9000'; Äá»c cookie: 1var x = document.cookie; document.cookie sáº½ tráº£ láº¡i táº¥t cáº£ cookie trong má»™t chuá»—i tring kiá»ƒu nhÆ°: cookie1 = giÃ¡ trá»‹; cookie2 = giÃ¡ trá»‹; cookie3 = giÃ¡ trá»‹; Hoáº·c Ä‘á»ƒ láº¥y giÃ¡ trá»‹ cá»§a 1 cookie, cÃ³ thá»ƒ viáº¿t má»™t hÃ m nhÆ° sau: 123456789101112131415function getCookie(cname) &#123; var name = cname + '='; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i &lt;ca.length; i++) &#123; var c = ca[i]; while (c.charAt(0) == ' ') &#123; c = c.substring(1); &#125; if (c.indexOf(name) == 0) &#123; return c.substring(name.length, c.length); &#125; &#125; return '';&#125; Tham sá»‘ truyá»n vÃ o lÃ  cname - tÃªn cookie muá»‘n láº¥y giÃ¡ trá»‹. Táº¡o má»™t biáº¿n name vÃ  thÃªm vÃ o â€œ=â€ Ä‘á»ƒ tÃ¬m kiáº¿m trong chuá»—i document.cookie Chia document.cookie dá»±a trÃªn dáº¥u ; thÃ nh má»™t máº£ng nhiá»u pháº§n tá»­ vÃ  gÃ¡n máº£ng Ä‘áº¥y cho biáº¿n ca VÃ²ng láº·p (i=0; i&lt;ca.length; i++) Ä‘á»ƒ Ä‘á»c má»—i giÃ¡ trá»‹ c = ca[i] Náº¿u cookie Ä‘Æ°á»£c tÃ¬m tháº¥y (c.indexOf(name)==0), tráº£ vá» giÃ¡ trá»‹ cá»§a cookie (c.substring(name.length,c.length). Náº¿u cookie khÃ´ng Ä‘Æ°á»£c tÃ¬m tháº¥y, tráº£ vá» â€˜â€™ VÃ­ dá»¥ muá»‘n láº¥y giÃ¡ trá»‹ cá»§a cookie tÃªn lÃ  language thÃ¬ ta cÃ³ thá»ƒ gá»i getcookie(â€˜languageâ€™) vÃ  kÃªt quáº£ tráº£ vá» lÃ  giÃ¡ trá»‹ cá»§a cookie cÃ³ tÃªn Ä‘Ã³. 12var lang = getCookie('language');console.log(lang); Káº¿t quáº£: Thay Ä‘á»•i giÃ¡ trá»‹ cookie: Trong javascript, báº¡n cÃ³ thá»ƒ thay Ä‘á»•i má»™t cookie giá»‘ng nhÆ° cÃ¡ch mÃ  báº¡n táº¡o ra cookie, tá»©c lÃ  ghi Ä‘Ã¨ giÃ¡ trá»‹ má»›i lÃªn cookie Ä‘Ã£ cÃ³: 1document.cookie = \"username=Barney Stinson; expires=Wed, 26 Dec 2018 8:00:00 UTC\"; Kiá»ƒm tra cookie: Äá»ƒ kiá»ƒm tra coookie, cÃ³ thá»ƒ xÃ¢y dá»±ng hÃ m nhÆ° sau: 1234567891011function checkCookie() &#123; var username = getCookie('username'); if (username != '') &#123; alert('Welcome again ' + username); &#125; else &#123; username = prompt('Please enter your name: ', ''); if (username != '' &amp;&amp; username != null) &#123; setCookie('username', username, 365); &#125; &#125;&#125; Náº¿u cookie Ä‘Æ°á»£c thiáº¿t láº­p, nÃ³ sáº½ hiá»ƒn thá»‹ má»™t lá»i chÃ o Náº¿u cookie khÃ´ng Ä‘Æ°á»£c thiáº¿t láº­p, nÃ³ sáº½ hiá»ƒn thá»‹ má»™t prompt box, há»i tÃªn cá»§a ngÆ°á»i dÃ¹ng, lÆ°u trá»¯ tÃªn cá»§a ngÆ°á»i dÃ¹ng á»Ÿ cookie trong 365 ngÃ y, báº±ng viá»‡c gá»i function setCookie Ä‘Ã£ Ä‘Æ°á»£c viáº¿t á»Ÿ trÃªn XÃ³a cookie: Äá»ƒ xÃ³a má»™t cookie chá»‰ cáº§n xÃ©t láº¡i giÃ¡ trá»‹ ngÃ y háº¿t háº¡n expires vá» má»™t thá»i Ä‘iá»ƒm Ä‘Ã£ qua 1document.cookie = 'username=; expires=Thu, 01 Jan 1970 00:00:00 UTC'; Tham kháº£o táº¡i https://www.w3schools.com/js/js_cookies.asp 4. ThÃ´ng tin thÃªm VÃ¬ localStorage vÃ  sessionStorage Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng, nÃªn cÃ¡c báº¡n cáº§n pháº£i xem xÃ©t ná»™i dung lÆ°u trá»¯ cÃ³ liÃªn quan Ä‘áº¿n váº¥n Ä‘á» báº£o máº­t hay khÃ´ng. VÃ  cÅ©ng chÃ­nh vÃ¬ localStorage vÃ  sessionStorage Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn trÃ¬nh duyá»‡t nÃªn viá»‡c sá»­ dá»¥ng nÃ³ sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u xuáº¥t cá»§a trang web nhÆ°ng nÃ³ sáº½ lÃ m náº·ng trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng (khÃ´ng Ä‘Ã¡ng ká»ƒ). Vá» pháº¡m vi: sessionStorage: giá»›i háº¡n trong má»™t cá»­a sá»• hoÄƒc tháº» cá»§a trÃ¬nh duyá»‡t. Má»™t trang web Ä‘Æ°á»£c má»Ÿ trong hai tháº» cá»§a cÃ¹ng má»™t trÃ¬nh duyá»‡t cÅ©ng khÃ´ng thá»ƒ truy xuáº¥t dá»¯ liá»‡u láº«n nhau. NhÆ° váº­y, khi báº¡n Ä‘Ã³ng trang web thÃ¬ dá»¯ liá»‡u lÆ°u trong sessionStorage hiá»‡n táº¡i cÅ©ng bá»‹ xÃ³a. CÃ²n localStorage: cÃ³ thá»ƒ truy xuáº¥t láº«n nhau giá»¯a cÃ¡c cá»­a sá»• trÃ¬nh duyá»‡t. Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ khÃ´ng giá»›i háº¡n thá»i gian.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"html5","slug":"html5","permalink":"http://nthung2112.github.io/tags/html5/"}]},{"title":"Load Javascript vá»›i async vÃ  defer","slug":"Load-Javascript-voi-async-va-defer","date":"2018-06-23T11:29:00.000Z","updated":"2018-06-23T11:37:52.865Z","comments":true,"path":"2018/06/Load-Javascript-voi-async-va-defer.html","link":"","permalink":"http://nthung2112.github.io/2018/06/Load-Javascript-voi-async-va-defer.html","excerpt":"Váº¥n Ä‘á»Javascript lÃ  1 trong nhá»¯ng tÃ i nguyÃªn cháº·n trang, cÃ³ nghÄ©a lÃ  viá»‡c hiá»ƒn thá»‹ HTML cÃ³ thá»ƒ bá»‹ cháº·n hay lÃ m cháº­m bá»Ÿi Javascript. Khi parser Ä‘á»c Ä‘áº¿n &lt;script&gt; tag, báº¥t ká»ƒ lÃ  inline hay lÃ  external file, quÃ¡ trÃ¬nh parse sáº½ táº¡m dá»«ng Ä‘á»ƒ fetch script Ä‘Ã³ vá» vÃ  execute. Viá»‡c nÃ y cÃ³ thá»ƒ lÃ  váº¥n Ä‘á» náº¿u chÃºng ta load nhiá»u file Javascript trÃªn trang, lÃ m tÄƒng thá»i gian load trang máº·c dÃ¹ cÃ³ thá»ƒ viá»‡c hiá»ƒn thá»‹ html á»Ÿ trang khÃ´ng thá»±c sá»± phá»¥ thuá»™c vÃ o nhá»¯ng file javascript Ä‘Ã³. VÃ  may máº¯n thay, tháº» &lt;script&gt; cÃ³ 2 thuá»™c tÃ­nh, Ä‘Ã³ lÃ  async vÃ  defer, cho phÃ©p chÃºng ta kiá»ƒm soÃ¡t vÃ  load nhá»¯ng file nÃ y theo Ã½ muá»‘n, trÃ¡nh cháº·n quÃ¡ trÃ¬nh load trang.","text":"Váº¥n Ä‘á»Javascript lÃ  1 trong nhá»¯ng tÃ i nguyÃªn cháº·n trang, cÃ³ nghÄ©a lÃ  viá»‡c hiá»ƒn thá»‹ HTML cÃ³ thá»ƒ bá»‹ cháº·n hay lÃ m cháº­m bá»Ÿi Javascript. Khi parser Ä‘á»c Ä‘áº¿n &lt;script&gt; tag, báº¥t ká»ƒ lÃ  inline hay lÃ  external file, quÃ¡ trÃ¬nh parse sáº½ táº¡m dá»«ng Ä‘á»ƒ fetch script Ä‘Ã³ vá» vÃ  execute. Viá»‡c nÃ y cÃ³ thá»ƒ lÃ  váº¥n Ä‘á» náº¿u chÃºng ta load nhiá»u file Javascript trÃªn trang, lÃ m tÄƒng thá»i gian load trang máº·c dÃ¹ cÃ³ thá»ƒ viá»‡c hiá»ƒn thá»‹ html á»Ÿ trang khÃ´ng thá»±c sá»± phá»¥ thuá»™c vÃ o nhá»¯ng file javascript Ä‘Ã³. VÃ  may máº¯n thay, tháº» &lt;script&gt; cÃ³ 2 thuá»™c tÃ­nh, Ä‘Ã³ lÃ  async vÃ  defer, cho phÃ©p chÃºng ta kiá»ƒm soÃ¡t vÃ  load nhá»¯ng file nÃ y theo Ã½ muá»‘n, trÃ¡nh cháº·n quÃ¡ trÃ¬nh load trang. MÃ´ táº£ cÃ¡ch thá»±c thi &lt;script&gt;12345678&lt;html&gt; &lt;head&gt; ... &lt;/head&gt;&lt;body&gt; ... &lt;script src=\"script.js\" /&gt; ....&lt;/body&gt;&lt;/html&gt; Vá»›i tháº» script khÃ´ng cÃ³ thuá»™c tÃ­nh gÃ¬ khÃ¡c thÃ¬ HTML file sáº½ Ä‘Æ°á»£c parse cho Ä‘áº¿n khi gáº·p pháº£i tháº» script, Ä‘áº¿n lÃºc nÃ y thÃ¬ quÃ¡ trÃ¬nh parse sáº½ táº¡m dÃ¹ng vÃ  Ä‘á»ƒ fetch script file vá» (náº¿u lÃ  external file), sau Ä‘Ã³ execute nhá»¯ng code script nÃ y, sau Ä‘Ã³ má»›i tiáº¿p tá»¥c láº¡i quÃ¡ trÃ¬nh parse html &lt;script async&gt;1&lt;script async src=\"script.js\" /&gt; Vá»›i tháº» script cÃ³ thuá»™c tÃ­nh async, khi quÃ¡ trÃ¬nh parse html gáº·p pháº£i script nÃ y, nÃ³ sáº½ váº«n tiáº¿p tá»¥c parse html cho Ä‘áº¿n khi script nÃ y Ä‘Æ°á»£c download xong, thÃ¬ quÃ¡ trÃ¬nh parse html má»›i táº¡m dá»«ng Ä‘á»ƒ execute nhá»¯ng code script nÃ y, sau Ä‘Ã³ láº¡i tiáº¿p tiáº¿p quÃ¡ trÃ¬nh parse html &lt;script defer&gt;1&lt;script defer src=\"script.js\" /&gt; Vá»›i tháº» script cÃ³ thuá»™c tÃ­nh defer, quÃ¡ trÃ¬nh parse html sáº½ khÃ´ng bá»‹ dá»«ng láº¡i mÃ  parse cho Ä‘áº¿n khi hoÃ n thÃ nh, quÃ¡ trÃ¬nh download cÃ¡c script file Ä‘Æ°á»£c tiáº¿n hÃ nh song song, vÃ  cuá»‘i cÃ¹ng thÃ¬ sáº½ execute nhá»¯ng script code nÃ y khi html Ä‘Ã£ parse xong. Váº­y nÃªn dÃ¹ng khi nÃ o?NÃ³ phá»¥ thuá»™c vÃ o tá»«ng tÃ¬nh huá»‘ng cá»¥ thá»ƒ. Quy táº¯c nhÆ° sau: Náº¿u script lÃ  1 module tÃ¡ch biá»‡t, khÃ´ng phá»¥ thuá»™c vÃ o script nÃ o khÃ¡c thÃ¬ nÃªn sá»­ dá»¥ng async cho load vÃ  execute vá»›i trang luÃ´n Náº¿u script phá»¥ thuá»™c vÃ o script khÃ¡c, hoáº·c bá»‹ script khÃ¡c phá»¥ thuá»™c, thÃ¬ nÃªn dÃ¹ng defer, Ä‘á»ƒ load vÃ  execute theo thá»© tá»± Náº¿u script nhá» vÃ  cÃ¡c script khÃ¡c phá»¥ thuá»™c vÃ o nÃ³, thÃ¬ cho load inline vÃ  khÃ´ng cáº§n async hay defer NgoÃ i ra nÃªn cÃ¢n nháº¯c 1 sá»‘ cÃ¢u há»i trÆ°á»›c khi thÃªm cÃ¡c thuá»™c tÃ­nh nÃ y1. Tháº» script Ä‘ang náº±m á»Ÿ Ä‘Ã¢u trong trangAsync vÃ  defer cÃ³ thá»ƒ ráº¥t cáº§n thiáº¿t náº¿u tháº» script khÃ´ng náº±m á»Ÿ cuá»‘i trang. HMTL document Ä‘Æ°á»£c parse theo thá»© tá»±, tá»« tháº» má»Ÿ cho Ä‘áº¿n tháº» Ä‘Ã³ng . Náº¿u script nÄƒm ngay gáº§n cuá»‘i tháº» Ä‘Ã³ng thÃ¬ viá»‡c sá»­ dá»¥ng async hay defer thÃ¬ cÅ©ng khÃ´ng cÃ³ Ã½ nghÄ©a láº¯m bá»Ÿi vÃ¬ viá»‡c parse html Ä‘Ã£ gáº§n xong xuÃ´i, vÃ  javascript khÃ´ng cÃ²n block gÃ¬ html ná»¯a. 2. Script Ä‘Ã³ cÃ³ Ä‘á»™c láº­p khÃ´ng?Vá»›i nhá»¯ng file script khÃ´ng phá»¥ thuá»™c vÃ o nhá»¯ng file khÃ¡c, thÃ¬ thuá»™c tÃ­nh async dÃ¹ng cho script Ä‘Ã³ lÃ  viá»‡c nÃªn lÃ m, vÃ¬ nÃ³ load vÃ  execute script song song, giáº£m thá»i gian táº£i trang, káº¿t quáº£ cuá»‘i cÃ¹ng nhanh hÆ¡n. 3. Script cÃ³ yÃªu cáº§u viá»‡c load DOM xong má»›i thá»±c hiá»‡n?Trong nhiá»u trÆ°á»ng há»£p, cÃ¡c script chá»©a Ä‘á»±ng code tÆ°Æ¡ng tÃ¡c vá»›i DOM, hoáº·c phá»¥ thuá»™c vÃ o cÃ¡c thÃ nh pháº§n trÃªn trang, yÃªu cáº§u trang pháº£i parse xong thÃ¬ má»›i execute script. ThÃ´ng thÆ°á»ng thÃ¬ nhá»¯ng file nhÆ° tháº¿ sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ cuá»‘i trang Ä‘á»ƒ cháº¯c cháº¯n má»i thá»­ Ä‘Ã£ Ä‘Æ°á»£c parse. Tuy nhiÃªn chÃºng ta cÃ³ thá»ƒ dÃ¹ng thuá»™c tÃ­nh defer thay tháº¿, Ä‘áº£m báº£o script sáº½ Ä‘Æ°á»£c execute khi trang Ä‘Ã£ táº£i xong. 4.Script nhá» vÃ  cÃ¡c file khÃ¡c phá»¥ thuá»™c vÃ o nÃ³?Náº¿u script dung lÆ°á»£ng nhá», vÃ  cÃ¡c file khÃ¡c phá»¥ thuá»™c vÃ o nÃ³, thÃ¬ nÃªn Ä‘á»ƒ script Ä‘Ã³ inline. Máº·c dÃ¹ nÃ³ block quÃ¡ trÃ¬nh parse HTML, nhÆ°ng nÃ³ khÃ´ng Ä‘Ã¡ng ká»ƒ vÃ¬ dung lÆ°á»£ng nhá». Lá»£i Ã­chVá»›i viá»‡c biáº¿t cÃ¡ch sá»­ dá»¥ng cÃ¡c thuá»™c tÃ­nh async, defer há»£p lÃ­ thÃ¬ tá»‘c Ä‘á»™ load trang sáº½ Ä‘Æ°á»£c cáº£i thiá»‡n hÆ¡n, mang láº¡i cáº£m giÃ¡c thÃ­ch thÃº cho ngÆ°á»i dÃ¹ng. VÃ¬ váº­y nÃ³ giÃºp tá»‘i Æ°u SEO, giÃºp tÄƒng Ä‘iá»ƒm Google Page Speed (https://developers.google.com/speed/pagespeed/insights)","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Functional Programming - Pháº§n 3 - BuÃ´ng bá»","slug":"Functional-Programming-Phan-3-Buong-bo","date":"2018-06-20T08:46:00.000Z","updated":"2018-06-23T08:54:01.269Z","comments":true,"path":"2018/06/Functional-Programming-Phan-3-Buong-bo.html","link":"","permalink":"http://nthung2112.github.io/2018/06/Functional-Programming-Phan-3-Buong-bo.html","excerpt":"Functional Programming lÃ  má»™t con Ä‘Æ°á»ng khÃ¡c, má»™t phÆ°Æ¡ng phÃ¡p tÆ° duy khÃ¡c trong coding. á» táº§m nhÃ¬n trá»«u tÆ°á»£ng hÆ¡n, ngÆ°á»i ta xáº¿p Functional Programming vÃ o nhÃ³m â€œDeclarativeâ€, cÃ²n OOP thuá»™c nhÃ³m â€œImperativeâ€. Tá»« cÃ¡c bÃ i há»c ngá»¯ phÃ¡p chÃºng ta Ä‘Ã£ biáº¿t 2 kiá»ƒu cÃ¢u: cÃ¢u tráº§n thuáº­t (Declarative Sentence), vÃ  cÃ¢u má»‡nh lá»‡nh (Imperative Sentence). Láº­p trÃ¬nh theo lá»‘i â€œImperative Programmingâ€ lÃ  sáº¯p xáº¿p má»™t loáº¡t cÃ¡c má»‡nh lá»‡nh liÃªn tiáº¿p, Ä‘á»ƒ mÃ¡y tÃ­nh thá»±c thi tuáº§n tá»± tá»«ng bÆ°á»›c. á» Ä‘Ã¢y ngÆ°á»i ta táº­p trung vÃ o â€œhowâ€. NÃ o, hÃ£y lÃ m tháº¿ nÃ y, rá»“i lÃ m tháº¿ kiaâ€¦ Má»™t hÃ¬nh thá»©c â€œcáº§m tay chá»‰ viá»‡câ€.","text":"Functional Programming lÃ  má»™t con Ä‘Æ°á»ng khÃ¡c, má»™t phÆ°Æ¡ng phÃ¡p tÆ° duy khÃ¡c trong coding. á» táº§m nhÃ¬n trá»«u tÆ°á»£ng hÆ¡n, ngÆ°á»i ta xáº¿p Functional Programming vÃ o nhÃ³m â€œDeclarativeâ€, cÃ²n OOP thuá»™c nhÃ³m â€œImperativeâ€. Tá»« cÃ¡c bÃ i há»c ngá»¯ phÃ¡p chÃºng ta Ä‘Ã£ biáº¿t 2 kiá»ƒu cÃ¢u: cÃ¢u tráº§n thuáº­t (Declarative Sentence), vÃ  cÃ¢u má»‡nh lá»‡nh (Imperative Sentence). Láº­p trÃ¬nh theo lá»‘i â€œImperative Programmingâ€ lÃ  sáº¯p xáº¿p má»™t loáº¡t cÃ¡c má»‡nh lá»‡nh liÃªn tiáº¿p, Ä‘á»ƒ mÃ¡y tÃ­nh thá»±c thi tuáº§n tá»± tá»«ng bÆ°á»›c. á» Ä‘Ã¢y ngÆ°á»i ta táº­p trung vÃ o â€œhowâ€. NÃ o, hÃ£y lÃ m tháº¿ nÃ y, rá»“i lÃ m tháº¿ kiaâ€¦ Má»™t hÃ¬nh thá»©c â€œcáº§m tay chá»‰ viá»‡câ€.VÃ­ dá»¥ trÃªn trang web cÃ³ 4 boxes mÃ u Ä‘á» tháº¿ nÃ y: 12345678910111213141516&lt;style&gt;.box &#123; width: 100px; height: 100px; float: left; margin: 10px; background-color: red;&#125;.hide &#123; display: none;&#125;&lt;/style&gt;&lt;div class=\"box hide\"&gt;&lt;/div&gt;&lt;div class=\"box hide\"&gt;&lt;/div&gt;&lt;div class=\"box hide\"&gt;&lt;/div&gt;&lt;div class=\"box hide\"&gt;&lt;/div&gt; Máº¥y boxes nÃ y Ä‘ang áº©n, ta cáº§n lÃ m chÃºng hiá»‡n ra báº±ng cÃ¡ch loáº¡i bá» class â€œhideâ€ Ä‘i. CÃ¡c giÃ¡o viÃªn tin há»c Ä‘Ã¡ng kÃ­nh á»Ÿ trÆ°á»ng xÆ°a thÆ°á»ng dáº¡y viáº¿t kiá»ƒu nhÆ° tháº¿ nÃ y: 1234567891011// tÃ¬m háº¿t cÃ¡c tags cÃ³ class \"box':const els = document.querySelectorAll('.box');// quÃ©t táº¥t cáº£ cÃ¡c tags tÃ¬m tháº¥yfor (let i = 0; i &lt; els.length; i++) &#123; // vá»›i tag thá»© i let el = els[i]; // xÃ³a bá» class \"hide\" Ä‘á»ƒ cho tag hiá»‡n lÃªn el.classList.remove('hide'); // náº¿u cÃ²n pháº§n tá»­ phÃ­a sau thÃ¬ tÄƒng i lÃªn 1 Ä‘Æ¡n vá»‹ // quay láº¡i vá»›i xá»­ lÃ½ tag thá»© i + 1&#125; Há» dÃ¹ng code hÆ°á»›ng dáº«n cho mÃ¡y tÃ­nh lÃ m tá»«ng nhiá»‡m vá»¥. NgÆ°á»i tu luyá»‡n Functional Programming khÃ´ng tÆ° duy theo cÃ¡ch Ä‘Ã³. No for/whileâ€œDeclarative Programmingâ€ lÃ  táº­p trung vÃ o â€œwhatâ€. ChÃºng ta chá»‰ cáº§n Ä‘á»‹nh nghÄ©a nhá»¯ng quy táº¯c Ä‘áº§u vÃ o, Ä‘áº§u ra. Cháº³ng háº¡n â€œnáº¿u input lÃ  1 thÃ¬ output lÃ  2â€. Pháº§n cÃ²n láº¡i Ä‘á»ƒ mÃ¡y tÃ­nh xá»­ lÃ½. NgÆ°á»i tu luyá»‡n Functional Programming khÃ´ng cáº§n for loop. Code nhÆ° tháº¿ nÃ y nhÃ¬n má»›i máº» hÆ¡n nhiá»u: 12345678910111213141516const getElements = (selector) =&gt; &#123; return Array.from(document.querySelectorAll(selector));&#125;;const getRemover = (el) =&gt; &#123; return (className) =&gt; &#123; el.classList.remove(className); return el; &#125;;&#125;;const els = getElements('.box') .map(getRemover) .map(removeClass =&gt; removeClass('hide'));console.log(els); TrÆ°á»›c tiÃªn chÃºng ta táº¡o ra 1 pure function getElements dÃ¹ng Ä‘á»ƒ láº¥y cÃ¡c elements trÃªn trang thÃ´ng qua CSS Selector. Táº­p há»£p nÃ y vá»‘n lÃ  ArrayLike, ta dÃ¹ng Array.from chuyá»ƒn thÃ nh Array thá»±c sá»± Ä‘á»ƒ cÃ³ thá»ƒ táº­n dá»¥ng cÃ¡c phÆ°Æ¡ng thá»©c trong Array prototype. á» Ä‘Ã¢y ta Ä‘á»‹nh nghÄ©a input lÃ  CSS Selector, output lÃ  1 máº£ng DOM Elements. CÃ²n getRemover láº¡i lÃ  1 higher-order function. CÃ³ thá»ƒ gá»i nÃ³ báº±ng cÃ¡ch chaining getRemover(DOMElement)(classToRemove). ChÃºng ta lá»£i dá»¥ng Ä‘áº·c tÃ­nh cá»§a higher-order function, sau 2 láº§n map thÃ¬ cháº¡m tá»›i function do getRemover nÃ©m láº¡i. á» Ä‘Ã¢y ta Ä‘á»‹nh nghÄ©a input lÃ  DOM Element, output lÃ  function() {nháº­n input lÃ  className vÃ  output lÃ  DOM Element Ä‘Ã£ máº¥t Ä‘i class Ä‘Ã³}. Code nhÆ° váº­y ta cÃ³ thá»ƒ Ä‘em logic dÃ¹ng láº¡i á»Ÿ nhiá»u chá»— khÃ¡c nhau, chá»‰ cáº§n thay Ä‘á»•i input. VÃ­ dá»¥ loáº¡i bá» class float-left khá»i táº¥t cáº£ cÃ¡c tháº» div. 123const els = getElements('div') .map(getRemover) .map(removeClass =&gt; removeClass('float-left')); No if/elseNgÆ°á»i tu luyá»‡n Functional Programming cÅ©ng khÃ´ng cáº§n if/else. Tháº­m chÃ­ há» cÃ²n táº¡o ra cáº£ má»™t chiáº¿n dá»‹ch Anti-IF! CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ loáº¡i bá» hoÃ n toÃ n if/else ra khá»i chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n. ÄÆ¡n giáº£n nháº¥t lÃ  dÃ¹ng ternary. TernaryTrong JavaScript, ternary - tam phÃ¢n - cÃ³ tÃªn gá»i chÃ­nh thá»©c lÃ  ToÃ¡n tá»­ Äiá»u kiá»‡n - Conditional Operator. NÃ³ lÃ  cÃ¡ch viáº¿t ngáº¯n gá»n cá»§a if/else. HÃ£y xem Ä‘oáº¡n code dÃ i dÃ²ng, ráº½ nhÃ¡nh phá»©c táº¡p nhÆ° sau: 12345678let title = 'Mr.';if (person.gender === 'female') &#123; if (!person.gotMarried) &#123; title = 'Ms.'; &#125; else &#123; title = 'Mrs.'; &#125;&#125; CÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t gá»n láº¡i thÃ nh: 1const title = person.gender === 'female' ? (!person.gotMarried ? 'Ms.' : 'Mrs.') : 'Mr.'; KhÃ´ng cÃ²n if/else ná»¯a. Ta cÅ©ng vÃ´ hÃ¬nh trung loáº¡i bá» Ä‘Æ°á»£c var, let vÃ¬ khÃ´ng cáº§n gÃ¡n láº¡i giÃ¡ trá»‹ cho title. Logical operatorsCÃ¡ch thá»© 2 lÃ  khai thÃ¡c sá»©c máº¡nh ngáº§m cá»§a cÃ¡c logical operators &amp;&amp;, ||. ÄÃ¢y lÃ  nhá»¯ng toÃ¡n tá»­ logic. HÃ´m trÆ°á»›c cÃ³ báº¡n viáº¿t 1 cÃ¡i TIL ngáº¯n khÃ¡ hay. Sau Ä‘Ã¢y ta quan sÃ¡t chÃºng ká»¹ hÆ¡n qua lÄƒng kÃ­nh Functional Programming. Giáº£ sá»­ cÃ³ Ä‘oáº¡n code nhÆ° sau: 1234567891011121314151617181920const sayHello = () =&gt; &#123; console.log('Hello, bonjour, nihao'); return true;&#125;;const doNothing = () =&gt; &#123; console.log('Do nothing'); return false;&#125;;const greet = (hasClient) =&gt; &#123; if (hasClient) &#123; sayHello(); &#125; else &#123; doNothing(); &#125;&#125;greet(true); // =&gt; 'Hello, bonjour, nihao'greet(false); //=&gt; 'Do nothing' Vá» máº·t logic, hÃ m greet() kiá»ƒm tra Ä‘iá»u kiá»‡n náº¿u cÃ³ khÃ¡ch thÃ¬ chÃ o, náº¿u khÃ´ng thÃ¬ khÃ´ng lÃ m gÃ¬ cáº£. Theo Ä‘á»‹nh nghÄ©a cá»§a &amp;&amp; vÃ  ||, chÃºng ta biáº¿t: expr1 &amp;&amp; expr2 tráº£ vá» expr1 náº¿u expr1 lÃ  falsy, ngoÃ i ra nÃ³ tráº£ vá» expr2. Má»™t Ä‘iá»u thÃº vá»‹ á»Ÿ Ä‘Ã¢y lÃ  JavaScript engine luÃ´n Æ°á»›c lÆ°á»£ng giÃ¡ trá»‹ biá»ƒu thá»©c logic dáº¡ng nÃ y tá»« trÃ¡i sang pháº£i vÃ  theo nguyÃªn táº¯c â€œÄ‘oáº£n máº¡châ€ - short-circuit evaluationâ€œ. TiÃªn há»¯u nÃ o giá»i Váº­t lÃ½ cháº¯c cÃ²n nhá»› hiá»‡n tÆ°á»£ng â€œÄ‘oáº£n máº¡châ€, Ä‘Ã³ lÃ  khi doÌ€ng Ä‘iÃªÌ£n khÃ´ng chaÌ£y qua taÌ‰i hoÄƒÌ£c chiÌ‰ chaÌ£y qua mÃ´Ì£t phÃ¢Ì€n. VÃ¬ AND chá»‰ tráº£ vá» true náº¿u cáº£ 2 má»‡nh Ä‘á» cÃ¹ng Ä‘Ãºng, nÃªn ngay khi báº¯t gáº·p expr1 sai, nÃ³ láº­p tá»©c káº¿t luáº­n má»‡nh Ä‘á» ghÃ©p lÃ  Sai vÃ  cháº¥m dá»©t táº¡i Ä‘Ã³ luÃ´n, khÃ´ng cháº¡y qua ná»­a bÃªn pháº£i expr2 ná»¯a. expr1 || expr2 tráº£ vá» expr1 náº¿u expr1 lÃ  truthy, ngoÃ i ra nÃ³ tráº£ vá» expr2. VÃ¬ OR tráº£ vá» true náº¿u Ã­t nháº¥t 1 má»‡nh Ä‘á» Ä‘Ãºng, nÃªn ngay khi báº¯t gáº·p expr1 Ä‘Ãºng, nÃ³ láº­p tá»©c káº¿t luáº­n má»‡nh Ä‘á» ghÃ©p lÃ  ÄÃºng vÃ  bá» qua expr2. Short-circuit tháº§n thÃ¡nh! CÃ¡c láº­p trÃ¬nh viÃªn kinh nghiá»‡m thÆ°á»ng lá»£i dá»¥ng Ä‘áº·c Ä‘iá»ƒm nÃ y Ä‘á»ƒ tá»‘i Æ°u hiá»‡u suáº¥t chÆ°Æ¡ng trÃ¬nh. Há» Ä‘á»ƒ cÃ¡c biá»ƒu thá»©c tÃ­nh toÃ¡n phá»©c táº¡p á»Ÿ ná»­a sau cá»§a biá»ƒu thá»©c logic. NhÆ° váº­y, khi chÆ°a rÆ¡i vÃ o hoÃ n cáº£nh thÃ­ch há»£p, chÃºng sáº½ bá»‹ bá» qua, khÃ´ng cáº§n tá»‘n resource xá»­ lÃ½. Tá»›i Ä‘Ã¢y, ta Ä‘Ã£ cÃ³ thá»ƒ viáº¿t láº¡i hÃ m greet() má»™t cÃ¡ch bÃ­ hiá»ƒm nhÆ° sau: 123const greet = (hasClient) =&gt; &#123; return (hasClient || doNothing()) &amp;&amp; sayHello();&#125; Báº¯t Ä‘áº§u pháº§n náº±m trong ngoáº·c Ä‘Æ¡n bÃªn trÃ¡i &amp;&amp;. Náº¿u hasClient lÃ  true thÃ¬ giÃ¡ trá»‹ pháº§n nÃ y cÅ©ng lÃ  true, doNothing() bá»‹ bá» qua. VÃ¬ pháº§n bÃªn trÃ¡i cá»§a &amp;&amp; lÃ  true nÃªn cuá»‘i cÃ¹ng, giÃ¡ trá»‹ biá»ƒu thá»©c quy vá» pháº§n bÃªn pháº£i &amp;&amp;, tá»©c lÃ  sayHello(). Láº­p luáº­n tÆ°Æ¡ng tá»± cho trÆ°á»ng há»£p hasClient lÃ  false, dÃ²ng cháº£y chÆ°Æ¡ng trÃ¬nh láº­p tá»©c ráº½ sang doNothing(). LÃºc nÃ y giÃ¡ trá»‹ ná»­a bÃªn trÃ¡i &amp;&amp; lÃ  false, do Ä‘Ã³ khÃ´ng cáº§n quan tÃ¢m Ä‘áº¿n sayHello() ná»¯a. Viáº¿t nhÆ° trÃªn vá»«a Ä‘á»™c vá»«a láº¡, vá»«a khá»­ Ä‘Æ°á»£c if/else, mÃ  váº«n hoÃ n toÃ n Äƒn khá»›p vá»›i Ä‘iá»u kiá»‡n quy Æ°á»›c. Tuy nhiÃªn, logical operators náº¿u nhÃ¬n khÃ´ng quen thÃ¬ cÃ³ váº» hÆ¡i khÃ³ hÃ¬nh dung máº¡ch suy diá»…n cá»§a chÆ°Æ¡ng trÃ¬nh. TÃ´i chá»‰ Ä‘Æ°a ra Ä‘Ã¢y Ä‘á»ƒ cÃ¡c tin há»¯u tham kháº£o. Trong dá»± Ã¡n thá»±c táº¿, váº«n nÃªn dÃ¹ng ternary cho Ä‘á»¡ háº¡i nÃ£o Ä‘á»“ng Ä‘á»™i: 123const greet = (hasClient) =&gt; &#123; return hasClient ? sayHello() : doNothing();&#125; Logical functionsMá»™t cÃ¡ch tiáº¿p cáº­n khÃ¡c thá»ƒ hiá»‡n tinh tháº§n Functional Programming quyáº¿t liá»‡t hÆ¡n, Ä‘Ã³ lÃ  táº¡o ra cÃ¡c hÃ m Ä‘áº·c trÃ¡ch nhiá»‡m vá»¥ xá»­ lÃ½ logic. VÃ­ dá»¥ trong Ramda.js vÃ  Sanctuary Ä‘á»u cÃ³ ifElse , unless , when, vÃ  hÃ ng chá»¥c hÃ m logic khÃ¡c. HÃ m greet náº¿u viáº¿t láº¡i vá»›i Ramda sáº½ trá»Ÿ nÃªn xinh xáº¯n nhÆ° tháº¿ nÃ y: 123const R = require('ramda');const greet = R.ifElse(R.identity, sayHello, doNothing); ÄÃ³ lÃ  váº» Ä‘áº¹p Ä‘áº§y tÃ­nh nghá»‡ thuáº­t cá»§a Function Composition. Báº¡n cá»© ngáº¯m nhÃ¬n nÃ³ vÃ  Ä‘á»«ng nÃ³i gÃ¬ cáº£! Composition cÅ©ng cÃ³ nghÄ©a lÃ  tÃ¡c pháº©m, nhÆ° thÆ¡ cá»§a Paul Verlaine hay nháº¡c cá»§a Beethoven. No new/thisCÃ³ 2 thá»© luÃ´n khiáº¿n Brendan Eich cáº£m tháº¥y hÃ i lÃ²ng khi ká»ƒ vá» lá»‹ch sá»­ JavaScript, Ä‘Ã³ lÃ  first-class function vÃ  prototype mechanism. NgÃ y nay, háº§u háº¿t developer Ä‘á»u biáº¿t ráº±ng thá»«a káº¿ trong JavaScript lÃ  prototype-based inheritance. NhÆ°ng á»Ÿ thá»i ká»³ web cÃ²n hoang sÆ¡, ngÆ°á»i ta hay dÃ¹ng new vÃ  cÃ¡c hÃ m constructors Ä‘á»ƒ láº­p trÃ¬nh OOP trong JavaScript theo kiá»ƒu class-based, giá»‘ng nhÆ° bÃªn Java váº«n lÃ m. Classical inheritanceCá»• thÆ° ghi láº¡i ráº¥t nhiá»u vÃ­ dá»¥ kiá»ƒu nÃ y: 123456789101112function Dog(name) &#123; this.name = name; this.say = function() &#123; console.log('woof-woof, my name is ' + this.name); &#125;&#125;var rocky = new Dog('Rocky');rocky.say();var molly = new Dog('Molly');molly.say(); HÃ m Dog gá»i lÃ  Function Constructor, cÃ¡c tiá»n bá»‘i chÃ¢n giá»›i Äáº¡i Viá»‡t thá»§a trÆ°á»›c chuyá»ƒn ngá»¯ thÃ nh â€œhÃ m dá»±ngâ€. CÃ²n chÃºng ta thá»i nay cÃ³ láº½ cá»© nÃªn giá»¯ nguyÃªn vÄƒn. Prototypal inheritanceSang Ä‘áº§u ká»· thá»© 3, á»Ÿ tÃ´ng mÃ´n Yahoo! cÃ³ má»™t vá»‹ trÆ°á»Ÿng lÃ£o tu vi ráº¥t cao thÃ¢m tÃªn lÃ  Douglas Crockford tung ra bá»™ ká»³ thÆ° â€œJavaScript: The Good Partsâ€, trong Ä‘Ã³ cÃ³ Ä‘oáº¡n nháº¥n máº¡nh báº£n cháº¥t prototype trong JavaScript, sá»± khÃ¡c biá»‡t giá»¯a classical inheritance vÃ  prototypal inheritance. Ã”ng cho ráº±ng tá»« khÃ³a new mang theo nhiá»u Ä‘iá»ƒm báº¥t cáº­p, nÃªn khuyáº¿n khÃ­ch dÃ¹ng Object.create Ä‘á»ƒ sao chÃ©p nguyÃªn máº«u sang Ä‘á»‘i tÆ°á»£ng káº¿ thá»«a. TÆ° tÆ°á»Ÿng cá»§a Douglas Crockford quáº£ thá»±c má»›i máº». VÃ o lÃºc Ä‘Ã³, nhiá»u JavaScript engine cÃ²n chÆ°a ká»‹p há»— trá»£ Object.create. Cuá»‘n nÃ y vá»«a ra máº¯t Ä‘Ã£ gÃ¢y nÃ¡o loáº¡n cáº£ tin giá»›i, trá»Ÿ thÃ nh sÃ¡ch gá»‘i Ä‘áº§u giÆ°á»ng cá»§a ráº¥t nhiá»u tu sÄ©. Object.create cho phÃ©p sao chÃ©p cÃ¡c properties hoáº·c protoype cá»§a Ä‘á»‘i tÆ°á»£ng. HÃ m Dog cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t láº¡i theo hÆ°á»›ng prototypal inheritance nhÆ° tháº¿ nÃ y: 1234567891011121314function Dog() &#123;&#125;Dog.prototype.say = function() &#123; console.log('woof-woof, my name is ' + this.name);&#125;var rocky = Object.create(Dog.prototype);rocky.name = 'Rocky';var molly = Object.create(Dog.prototype);molly.name = 'Molly';rocky.say();molly.say(); KhÃ´ng cáº§n new ná»¯a! CÃ¡c cÆ°á»ng giáº£ sau Ä‘Ã³ nhanh chÃ³ng phÃ¡t triá»ƒn thÃªm nhiá»u cÃ¡ch tiáº¿p cáº­n prototypal inheritance khÃ¡c, ná»•i báº­t nháº¥t pháº£i ká»ƒ Ä‘áº¿n Concatenative inheritance, Prototype delegation vÃ  Functional inheritance. ES6 Class ngÃ y nay chá»‰ vay mÆ°á»£n syntax cá»§a classical OOP Ä‘á»ƒ lÃ m interface, cÃ²n bÃªn trong nÃ³ chÃ­nh lÃ  cÆ¡ cháº¿ prototypal inheritance. Object CompositionNhÆ°ng dÃ¹ sao prototypal inheritance váº«n thuá»™c vá» OOP. NgÆ°á»i tu luyá»‡n Functional Programming khÃ´ng cáº§n new. Gáº§n 10 nÄƒm sau bom táº¥n â€œThe Good Partsâ€, Douglas Crockford láº¡i má»™t láº§n ná»¯a khiáº¿n tin giá»›i cháº¥n Ä‘á»™ng báº±ng â€œJavaScript: The Better Partsâ€. Thá»i Ä‘iá»ƒm nÃ y, Ã´ng Ä‘Ã£ khÃ´ng cÃ²n dÃ¹ng Object.create() ná»¯a, cÅ©ng tá»« bá» luÃ´n this, for loops, for in, whileâ€¦ Tu vi cá»§a Ã´ng Ä‘Ã£ tiáº¿n thÃªm má»™t bÆ°á»›c lá»›n. Trong clip, Ã´ng nÃ³i vá» nhá»¯ng tÃ­nh nÄƒng má»›i cá»§a ES6 lÃºc áº¥y váº«n cÃ²n chÆ°a chÃ­nh thá»©c xuáº¥t xÆ°á»Ÿng. Máº¥y lÃ£o quÃ¡i kiá»‡t nÃ y luÃ´n Ä‘i trÆ°á»›c thiÃªn háº¡ vÃ i nÄƒm. ÄÃ³ cÅ©ng lÃ  khi trÃ o lÆ°u Functional Programming Ä‘ang dáº§n nÃ³ng trá»Ÿ láº¡i, ngÆ°á»i ta báº¯t Ä‘áº§u nháº¯c Ä‘áº¿n khÃ¡i niá»‡m Object Composition. Äi cáº·p vá»›i new lÃ  this. Tá»« khÃ³a this cháº³ng qua chá»‰ lÃ  ká»¹ xáº£o nháº±m táº¡o ra má»™t ngá»¯ cáº£nh khu biá»‡t (context) Ä‘á»ƒ thá»±c thi cÃ¡c hÃ m. Trong JavaScript, má»—i hÃ m nhÆ° 1 káº¿t giá»›i Ä‘á»™c láº­p. Function khi Ä‘Æ°á»£c gáº¯n lÃªn object thÃ¬ gá»i lÃ  method. Ngá»¯ cáº£nh method Ä‘Ã³ cháº¡y thÆ°á»ng chÃ­nh lÃ  Ä‘á»‘i tÆ°á»£ng sá»Ÿ há»¯u nÃ³. Sau nÃ y má»›i sinh ra cÃ¡c thá»§ thuáº­t bind, apply, call Ä‘á»ƒ Ä‘Ã¡nh trÃ¡o context. Vá»›i nhá»¯ng ngÆ°á»i má»›i há»c JavaScript, this Ä‘Ã´i khi trá»Ÿ thÃ nh ná»—i khiáº¿p sá»£. Ráº¥t khÃ³ debug cÃ¡c váº¥n Ä‘á» phÃ¡t sinh trong hÃ m náº¿u khÃ´ng biáº¿t chÃ­nh xÃ¡c ngá»¯ cáº£nh cháº¡y nÃ³. MÃ  ngá»¯ cáº£nh láº¡i thÆ°á»ng khÃ´ng á»•n Ä‘á»‹nh. ÄÃºng hÆ¡n, pháº£i nÃ³i ráº±ng chÃºng luÃ´n luÃ´n mutable. NgÆ°á»i tu luyá»‡n Functional Programming khÃ´ng cáº§n this. Äoáº¡n code vá»›i classical OOP trÃªn kia cÃ³ thá»ƒ viáº¿t láº¡i thÃ nh: 12345678910111213141516171819202122const sayName = (state) =&gt; &#123; return Object.assign( state, &#123; say: () =&gt; &#123; console.log(`woof-woof, my name is $&#123;state.name&#125;`); &#125;, &#125; );&#125;;const createDog = (name) =&gt; &#123; let state = &#123; name, &#125;; return Object.assign(state, sayName(state));&#125;;const rocky = createDog('Rocky');rocky.say();const molly = createDog('Molly');molly.say(); NhÃ¬n Ä‘Ã¢u cÅ©ng tháº¥y functions. KhÃ´ng cÃ²n for/while, if/else, new/this. Liá»‡u báº¡n Ä‘Ã£ sáºµn sÃ ng rá»i khá»i nhá»¯ng phÃ m váº­t áº¥y? Hay nÃ³i nhÆ° cÃ¡c nhÃ  sÆ°, liá»‡u báº¡n cÃ³ thá»ƒ buÃ´ng bá»? Khi lá»‘i tÆ° duy truyá»n thá»‘ng Ä‘Ã£ Äƒn sÃ¢u vÃ o tÃ¢m trÃ­, há»… gáº·p váº¥n Ä‘á» phÃ¢n cáº¥p Ä‘á»‘i tÆ°á»£ng thÃ¬ chÃºng ta sáº½ nghÄ© ngay Ä‘áº¿n OOP, class, prototype, inheritanceâ€¦ tháº­m chÃ­ coi chÃºng nhÆ° giáº£i phÃ¡p táº¥t yáº¿u, duy nháº¥t. Há»… xá»­ lÃ½ táº­p há»£p lÃ  pháº£i looping, há»… tháº¥y cÃ³ Ä‘iá»u kiá»‡n thÃ¬ chá»‰ biáº¿t dá»±a vÃ o ifâ€¦ ÄÃ¢y lÃ  trá»Ÿ ngáº¡i ráº¥t lá»›n cho káº» má»›i nháº­p Ä‘áº¡o. Pháº£i tÃ¬m cÃ¡ch rÅ© bá» nhá»¯ng thá»© khÃ´ng cáº§n thiáº¿t, thÃ¬ má»›i Ä‘i xa Ä‘Æ°á»£c. Rá»i khá»i chÃºng, chá»‰ giá»¯ láº¡i má»™t Ã½ niá»‡m duy nháº¥t: FUNCTION! Nháº¥t niá»‡m â€œphÃ¢n sáº§nâ€! Ban Ä‘áº§u táº¥t nhiÃªn lÃ  sáº½ khÃ³ khÄƒn, lÃºng tÃºng. Giá»‘ng nhÆ° hÃ ng ngÃ y báº¡n váº«n Ä‘i trÃªn con Ä‘Æ°á»ng quen thuá»™c tá»« nhÃ  Ä‘áº¿n cÃ´ng sá»Ÿ rá»“i láº¡i trá»Ÿ vá» nhÃ . Cho Ä‘áº¿n má»™t hÃ´m con Ä‘Æ°á»ng Ä‘Ã³ bá»‹ cáº£nh sÃ¡t cháº·n láº¡i, báº¡n Ä‘Ã nh pháº£i ráº½ sang lá»‘i khÃ¡c. TrÃªn con Ä‘Æ°á»ng xa láº¡ áº¥y, báº¡n khÃ´ng cÃ²n trÃ´ng tháº¥y nhá»¯ng Ä‘iá»ƒm má»‘c hÃ ng ngÃ y váº«n tháº¥y: 1 shop lÆ°u niá»‡m, 1 cÃ¢y xÄƒng, 1 tiá»‡m cáº§m Ä‘á»“, sau ngÃ£ tÆ° lÃ  Ä‘áº¿n ven sÃ´ng, cÃ¢y cáº§u sÆ¡n mÃ u Ä‘á», má»™t tiá»‡m táº¡p hÃ³a thÆ°á»ng cÃ³ cÃ´ em ráº¥t xinh ngá»“i trÆ°á»›c cá»­aâ€¦ Báº¡n khÃ´ng cÃ²n báº¯t gáº·p nhá»¯ng dáº¥u hiá»‡u Ä‘Ã£ quen máº¯t. Báº¡n cháº³ng biáº¿t mÃ¬nh Ä‘Ã£ Ä‘i Ä‘áº¿n Ä‘Ã¢u, cÃ²n cÃ¡ch nhÃ  bao nhiÃªu km ná»¯a. NhÆ°ng con Ä‘Æ°á»ng nÃ o Ä‘i láº¡i vÃ i láº§n thÃ¬ cÅ©ng thÃ nh quen. Cháº³ng cÃ³ gÃ¬ Ä‘Ã¡ng ngáº¡i. Váº¥n Ä‘á» lÃ , ngay khi báº¡n nháº­n tháº¥y Functional Programming lÃ  thá»© gÃ¬ Ä‘Ã³ ráº¥t thÃº vá»‹, Ä‘Ã¡ng Ä‘á»ƒ há»c há»i, váº­n dá»¥ng nÃ³, báº¡n nÃªn thá»±c hiá»‡n ngay láº­p tá»©c, Ä‘á»«ng chá» Ä‘á»£i dá»‹p nÃ o thuáº­n tiá»‡n, Ä‘á»«ng chá» tÃ¬m Ä‘Æ°á»£c minh sÆ° dáº«n dáº¯t. Náº¿u váº­y, báº¡n sáº½ khÃ³ mÃ  rá»i khá»i lá»‘i mÃ²n xÆ°a cÅ©. Krishnamurti tá»«ng diá»…n giáº£i má»™t Ä‘iá»u gáº§n tÆ°Æ¡ng tá»±, Ä‘áº¡i Ã½ tháº¿ nÃ y: Náº¿u báº¡n Ä‘i vá» hÆ°á»›ng Báº¯c suá»‘t nhá»¯ng ngÃ y thÃ¡ng cá»§a cuá»™c Ä‘á»i báº¡n, giá»‘ng nhÆ° con ngÆ°á»i Ä‘Ã£ Ä‘i theo má»™t hÆ°á»›ng Ä‘áº·c biá»‡t, rá»“i cÃ³ ngÆ°á»i nÃ o Ä‘Ã³ xuáº¥t hiá»‡n vÃ  nÃ³i, â€œHÆ°á»›ng Ä‘Ã³ khÃ´ng Ä‘Ãºngâ€. Sau Ä‘Ã³ Ã´ng ta báº£o báº¡n, â€œÄi vá» hÆ°á»›ng Nam, hÆ°á»›ng ÄÃ´ng, báº¥t ká»³ hÆ°á»›ng nÃ o, ngoáº¡i trá»« hÆ°á»›ng Ä‘Ã³.â€ VÃ  khi báº¡n thá»±c sá»± chuyá»ƒn Ä‘á»™ng khá»i hÆ°á»›ng Ä‘Ã³, cÃ³ má»™t sá»± thay Ä‘á»•i ngay táº¡i chÃ­nh nhá»¯ng táº¿ bÃ o nÃ£o bá»Ÿi vÃ¬ báº¡n Ä‘Ã£ phÃ¡ vá»¡ cÃ¡i khuÃ´n máº«u. VÃ  cÃ¡i khuÃ´n máº«u Ä‘Ã³ pháº£i Ä‘Æ°á»£c phÃ¡ vá»¡ ngay lÃºc nÃ y, khÃ´ng pháº£i bá»‘n mÆ°Æ¡i nÄƒm hay má»™t trÄƒm nÄƒm sau.","categories":[],"tags":[{"name":"functional programming","slug":"functional-programming","permalink":"http://nthung2112.github.io/tags/functional-programming/"}]},{"title":"Functional Programming - Pháº§n 2 - Nháº­p Ä‘áº¡o","slug":"Functional-Programming-Phan-2-Nhap-dao","date":"2018-06-16T08:43:00.000Z","updated":"2018-06-23T08:53:54.125Z","comments":true,"path":"2018/06/Functional-Programming-Phan-2-Nhap-dao.html","link":"","permalink":"http://nthung2112.github.io/2018/06/Functional-Programming-Phan-2-Nhap-dao.html","excerpt":"NhÆ° váº­y, Functional Programming lÃ  nghá»‡ thuáº­t láº­p trÃ¬nh trong Ä‘Ã³ ta: sá»­ dá»¥ng functions Ä‘á»ƒ Ä‘iá»u khiá»ƒn workflow tuÃ¢n thá»§ 2 nguyÃªn táº¯c immutability vÃ  purity NÃ³i cÃ¡ch khÃ¡c, chÆ° vá»‹ tin há»¯u muá»‘n tu luyá»‡n Functional Programming thÃ¬ pháº£i giá»¯ Ä‘áº¡o tÃ¢m trong sÃ¡ng, Ã½ chÃ­ kiÃªn Ä‘á»‹nh, hÃ ng ngÃ y chiÃªm nghiá»‡m, suy diá»…n, cáº£m ngá»™ function, tu vi theo Ä‘Ã³ sáº½ khÃ´ng ngá»«ng thÄƒng tiáº¿n. NhÆ°ng lÃ m tháº¿ nÃ o Ä‘á»ƒ cáº£m ngá»™ â€œphÃ¢n sáº§n Ã½ cáº£nhâ€? Ta pháº£i náº¯m báº¯t, quan sÃ¡t, tÆ° duy, suy tÆ°á»Ÿng vá» function ra sao? Sau Ä‘Ã¢y lÃ  nhá»¯ng phÃ¡p quyáº¿t nháº­p mÃ´n.","text":"NhÆ° váº­y, Functional Programming lÃ  nghá»‡ thuáº­t láº­p trÃ¬nh trong Ä‘Ã³ ta: sá»­ dá»¥ng functions Ä‘á»ƒ Ä‘iá»u khiá»ƒn workflow tuÃ¢n thá»§ 2 nguyÃªn táº¯c immutability vÃ  purity NÃ³i cÃ¡ch khÃ¡c, chÆ° vá»‹ tin há»¯u muá»‘n tu luyá»‡n Functional Programming thÃ¬ pháº£i giá»¯ Ä‘áº¡o tÃ¢m trong sÃ¡ng, Ã½ chÃ­ kiÃªn Ä‘á»‹nh, hÃ ng ngÃ y chiÃªm nghiá»‡m, suy diá»…n, cáº£m ngá»™ function, tu vi theo Ä‘Ã³ sáº½ khÃ´ng ngá»«ng thÄƒng tiáº¿n. NhÆ°ng lÃ m tháº¿ nÃ o Ä‘á»ƒ cáº£m ngá»™ â€œphÃ¢n sáº§n Ã½ cáº£nhâ€? Ta pháº£i náº¯m báº¯t, quan sÃ¡t, tÆ° duy, suy tÆ°á»Ÿng vá» function ra sao? Sau Ä‘Ã¢y lÃ  nhá»¯ng phÃ¡p quyáº¿t nháº­p mÃ´n. Higher-order functionHigher-order function lÃ  má»™t khÃ¡i niá»‡m Ä‘áº¿n tá»« ToÃ¡n há»c. Báº¥t cá»© hÃ m nÃ o tiáº¿p nháº­n 1 function nhÆ° tham sá»‘, hoáº·c tráº£ vá» 1 function nhÆ° káº¿t quáº£, thÃ¬ Ä‘á»u Ä‘Æ°á»£c coi lÃ  higher-order function. DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ­ dá»¥, hÃ m getItem nháº­n vÃ o hÃ m by mÃ´ táº£ Ä‘iá»u kiá»‡n, láº¡i tráº£ vá» 1 hÃ m khÃ¡c. NÃ³ thá»«a tiÃªu chuáº©n Ä‘á»ƒ gá»i lÃ  higher-order function. 12345678const getItem = by =&gt; arr =&gt; by;// hoáº·c phiÃªn báº£n chi tiáº¿tconst getItem = (by) =&gt; &#123; return (arr) =&gt; &#123; return by(arr); &#125;;&#125;; Láº­p trÃ¬nh phong cÃ¡ch Functional Programming lÃ  khiÃªu vÅ© vá»›i cÃ¡c functions. Trong Functional Programming, háº§u nhÆ° má»i functions Ä‘á»u lÃ  higher-order function, vÃ¬ chÃºng Ä‘á»u cÃ³ thá»ƒ nháº­n vÃ o vÃ  nÃ©m ra cÃ¡c functions. NhÆ°ng nhÆ° váº­y thÃ¬ cÃ³ lá»£i Ã­ch gÃ¬? NÃ³ Ä‘Æ¡n giáº£n cung cáº¥p cho ta má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ láº­p luáº­n vÃ  suy diá»…n. Cháº³ng háº¡n nhÆ° vá»›i hÃ m getItem trÃªn kia cho phÃ©p báº¡n biáº¿n hÃ³a ráº¥t nhiá»u dáº¡ng, tÃ¹y vÃ o cÃ¡ch báº¡n thao tÃºng by. Khi báº¡n viáº¿t getItem, báº¡n khÃ´ng cáº§n biáº¿t sau nÃ y sáº½ pháº£i kiá»ƒm tra Ä‘iá»u kiá»‡n ra sao, cÅ©ng khÃ´ng quan tÃ¢m sáº½ nháº­n Ä‘Æ°á»£c Ä‘áº§u vÃ o nhÆ° tháº¿ nÃ o. Báº¡n cÃ³ thá»ƒ táº¡o ra hÃ m tÃ¬m sá»‘ lá»›n nháº¥t trong 1 máº£ng toÃ n sá»‘ nhÆ° sau: 1234567891011// táº¡o hÃ m engine láº¥y max number tá»« máº£ngconst maxNumber = (arr) =&gt; &#123; return Math.max(...arr);&#125;;// rá»“i truyá»n vÃ o getItem Ä‘á»ƒ Ä‘Æ°á»£c hÃ m cáº§n thiáº¿tconst getMaxNumber = getItem(maxNumber);// thá»­ xem saogetMaxNumber([4, 6, 2, 3, 1, 8, 7, 5]);// =&gt; 8 Tháº¿ sao khÃ´ng truyá»n tháº³ng cÃ¡i máº£ng sá»‘ kia vÃ o maxNumber cho khá»e? VÃ¬ trong thiáº¿t káº¿ nÃ y ta Ä‘ang cÆ° xá»­ vá»›i maxNumber nhÆ° plugin. CÃ²n nhiá»u plugins khÃ¡c ná»¯a. Ta khÃ´ng gá»i trá»±c tiáº¿p plugin mÃ  gá»i qua 1 giao diá»‡n tá»•ng quÃ¡t hÆ¡n. Giá» ta láº¡i cÃ³ dá»¯ liá»‡u 1 nhÃ³m ngÆ°á»i nhÆ° sau: 12345678910111213141516171819202122const members = [ &#123; name: 'Alice', height: 165, &#125;, &#123; name: 'Bob', height: 152, &#125;, &#123; name: 'Celina', height: 178, &#125;, &#123; name: 'Dan', height: 194, &#125;, &#123; name: 'Eric', height: 187, &#125;,]; Ta muá»‘n tÃ¬m ngÆ°á»i cao nháº¥t trong nhÃ³m thÃ¬ sao? HÃ£y thÃªm 1 plugin khÃ¡c. 12345678910111213// báº¡n táº¡o 1 hÃ m engine láº¥y max height tá»« máº£ngconst maxHeight = (people) =&gt; &#123; return people.reduce((prev, current) =&gt; &#123; return prev.height &gt; current.height ? prev : current; &#125;);&#125;;// rá»“i truyá»n vÃ o getItem Ä‘á»ƒ Ä‘Æ°á»£c hÃ m cáº§n thiáº¿tconst getTallestPerson = getItem(maxHeight);// thá»­ xem saogetTallestPerson(members);// =&gt; &#123; name: 'Dan', height: 194 &#125; VÃ­ dá»¥ trÃªn tuy táº§m thÆ°á»ng, nhÆ°ng cÃ³ thá»ƒ lÃ  gá»£i Ã½ tá»‘t Ä‘á»ƒ báº¡n dÃ¹ng higher-order function thiáº¿t káº¿ nhá»¯ng chÆ°Æ¡ng trÃ¬nh linh hoáº¡t, dá»… má»Ÿ rá»™ng. Function CompositionÄÃ¢y lÃ  khÃ¡i niá»‡m ToÃ¡n há»c mÃ  tiáº¿ng Viá»‡t ta gá»i lÃ  â€œhÃ m há»£pâ€, hay â€œhÃ m phá»©c há»£pâ€. Má»i thá»© trong Functional Programming Ä‘á»u cÃ³ nguá»“n gá»‘c ToÃ¡n há»c. Function Composition lÃ  sá»± phá»‘i há»£p, liÃªn káº¿t nhiá»u hÃ m láº¡i vá»›i nhau, thÃ nh má»™t hÃ m lá»›n, nhiá»u chá»©c nÄƒng hÆ¡n. CÃ³ 2 ká»¹ thuáº­t cÄƒn báº£n trong Function Composition lÃ  compose vÃ  pipe. ComposeHÃ£y nhá»› láº¡i, trong khÃ´ng gian Functional Programming tá»“n táº¡i vÃ´ sá»‘ pure functions nhá» gá»n, Ä‘Æ¡n giáº£n. ÄÃºng triáº¿t lÃ½ â€œdo one thing and do it wellâ€ cá»§a UNIX. VÃ¬ má»—i hÃ m chá»‰ lÃ m 1 viá»‡c, khi muá»‘n thá»±c hiá»‡n nhiá»u hÃ nh Ä‘á»™ng lÃªn cÃ¹ng má»™t input, ta chá»‰ viá»‡c káº¿t há»£p cÃ¡c hÃ m cáº§n thiáº¿t láº¡i vá»›i nhau. BÃ¢y giá» chÃºng ta hÃ£y táº¡m ngá»«ng tu luyá»‡n, táº¡m quÃªn tu vi Ä‘á»ƒ nháº­p phÃ m, quan sÃ¡t vÃ  cáº£m ngá»™ nhÃ¢n sinh. Láº§n nÃ y, báº¡n hÃ³a thÃ nh con trai thá»© 4 trong gia Ä‘Ã¬nh má»™t thÃ´n dÃ¢n sinh sá»‘ng dÆ°á»›i chÃ¢n nÃºi Táº£n ViÃªn báº±ng nghá» bÃ¡n thá»‹tâ€¦ Má»™t hÃ´m báº¡n xin Ä‘Æ°á»£c khÃºc cÃ¢y lá»›n á»Ÿ chá»— Ã´ng chÃº lÃ m kiá»ƒm lÃ¢m kiÃªm lÃ¢m táº·c. Tá»« khÃºc gá»— nÃ y, báº¡n muá»‘n lÃ m ra cÃ¡i thá»›t cho nhÃ  dÃ¹ng. LÃ  tu sÄ© má»›i nháº­p mÃ´n tu luyá»‡n Functional Programming, tuy khÃ´ng cÃ³ tu vi, nhÆ°ng báº¡n váº«n hÃ¬nh dung Ä‘Æ°á»£c sáº½ cáº§n Ä‘áº¿n cÃ¡c pure functions sau: cÆ°a(): nháº­n vÃ o khÃºc gá»—, tráº£ vá» tá»«ng khoanh trÃ²n sáº¥y(): nháº­n khoanh gá»— tÆ°Æ¡i, tráº£ vá» khoanh gá»— khÃ´ bÃ o(): nháº­n vÃ o khoanh gá»—, tráº£ vá» khoanh gá»— báº±ng pháº³ng khoan(): nháº­n vÃ o khoanh gá»—, tráº£ vá» khoanh gá»— cÃ³ 2 lá»— (Ä‘á»ƒ gáº¯n quai treo/mÃ³c lÃªn cho gá»n) chÃ (): nháº­n vÃ o khoanh gá»—, tráº£ vá» khoanh gá»— trÆ¡n lÃ¡ng (dÃ¹ng giáº¥y nhÃ¡m, miá»n ngoÃ i gá»i giáº¥y giÃ¡p, Ä‘á»ƒ Ä‘Ã¡nh cho nháºµn bá» máº·t) mÃ³c(): nháº­n thá»›t khÃ´ng quai, tráº£ vá» thá»›t cÃ³ quai Má»—i hÃ m chá»‰ lÃ m Ä‘Ãºng 1 viá»‡c. KhÃ´ng hÆ¡n. KhÃ´ng kÃ©m. Khi Ä‘i qua chá»«ng Ä‘Ã³ cÃ´ng Ä‘oáº¡n, ta sáº½ Ä‘Æ°á»£c sáº£n pháº©m mong muá»‘n. DÄ© nhiÃªn chÃºng ta Ä‘ang muá»‘n khÃºc gá»— Ä‘Æ°á»£c sá»­a Ä‘á»•i nÃªn táº¡m bá» qua váº¥n Ä‘á» immutability. ÄÃ¢y lÃ  phiÃªn báº£n mÃ´ phá»ng: 1234567891011121314151617181920212223const cÆ°a = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ cÆ°a`;&#125;;const sáº¥y = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ sáº¥y`;&#125;;const bÃ o = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ bÃ o`;&#125;;const khoan = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ khoan`;&#125;;const chÃ  = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ chÃ `;&#125;;const mÃ³c = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ gáº¯n mÃ³c`;&#125;; Äá»ƒ táº¡o ra 1 cÃ¡i thá»›t, á»Ÿ thá»i viá»…n cá»• xa xÆ°a, cÃ¡c man sÄ© thÆ°á»ng code tháº¿ nÃ y: 123456789var thá»›t = cÆ°a('khÃºc gá»—');thá»›t = sáº¥y(thá»›t);thá»›t = bÃ o(thá»›t);thá»›t = khoan(thá»›t);thá»›t = chÃ (thá»›t);thá»›t = mÃ³c(thá»›t);console.log(thá»›t);// =&gt; khÃºc gá»— Ä‘Ã£ cÆ°a Ä‘Ã£ sáº¥y Ä‘Ã£ bÃ o Ä‘Ã£ khoan Ä‘Ã£ chÃ  Ä‘Ã£ gáº¯n mÃ³c 5 váº¡n nÄƒm sau, khi Ä‘Ã£ xuáº¥t hiá»‡n ToÃ¡n há»c, cÃ¡c tá»™c nhÃ¢n bá»™ láº¡c Giao Chá»‰ thá»i Ä‘áº¡i Há»“ng BÃ ng láº¡i thÃ­ch code nhÆ° tháº¿ nÃ y: 123var thá»›t = mÃ³c(chÃ (khoan(bÃ o(sáº¥y(cÆ°a('khÃºc gá»—'))))));console.log(thá»›t);// =&gt; khÃºc gá»— Ä‘Ã£ cÆ°a Ä‘Ã£ sáº¥y Ä‘Ã£ bÃ o Ä‘Ã£ khoan Ä‘Ã£ chÃ  Ä‘Ã£ gáº¯n mÃ³c ÄÃ¢y chÃ­nh lÃ  ToÃ¡n há»c cÆ¡ báº£n. Vá»›i y = f(g(x)), ta tÃ­nh g(x) trÆ°á»›c, Ä‘Æ°á»£c bao nhiÃªu truyá»n vÃ o f() lÃ  ra káº¿t quáº£. Viá»‡c tÃ­nh toÃ¡n Ä‘i tá»« ngoáº·c trong cÃ¹ng ra ngoÃ i, máº¯t thÆ°á»ng nhÃ¬n tháº¥y lÃ  tá»« pháº£i sang trÃ¡i, tá»« g Ä‘áº¿n f. Láº¡i thÃªm 5 ngÃ n nÄƒm ná»¯a trÃ´i qua. LÃºc nÃ y Ä‘Ã£ cÃ³ ES6. Má»™t sá»‘ cÆ°á»ng giáº£ Functional Programming sÃ¡ng táº¡o ra phÆ°Æ¡ng thá»©c compose, nhÆ° tháº¿ nÃ y: 123const compose = (...fns) =&gt; &#123; return fns.reduce((f, g) =&gt; (x) =&gt; f(g(x)));&#125;; Báº¡n cÃ³ thá»ƒ dÃ¹ng Babel dá»‹ch sang ES2015 cho dá»… hiá»ƒu. Ã tÆ°á»Ÿng cá»§a compose lÃ  xáº¿p cuá»‘n chiáº¿u cÃ¡c hÃ m láº¡i vá»›i nhau, theo thá»© tá»± tá»« trÃ¡i sang pháº£i Ä‘á»ƒ táº¡o ra má»™t hÃ m má»›i, mÃ  khi Ä‘Æ°á»£c thá»±c thi, nÃ³ sáº½ láº§n lÆ°á»£t gá»i cÃ¡c hÃ m Ä‘Ã£ truyá»n vÃ o trÆ°á»›c Ä‘Ã³ theo thá»© tá»± ngÆ°á»£c láº¡i, tá»« pháº£i sang trÃ¡i. Tá»©c lÃ  náº¿u y = compose(f, g), thÃ¬ y(x) = f(g(x));NÃ³ sáº½ tÃ­nh g(x) trÆ°á»›c rá»“i truyá»n káº¿t quáº£ cho f;Giáº£ sá»­ g(x) = z thÃ¬ y(x) = f(z); Náº¿u báº¡n váº«n tháº¥y mÆ¡ há»“ thÃ¬ cá»© xem cÃ¡i nÃ y lÃ  Äáº¡o. Chá»‰ cÃ³ thá»ƒ cáº£m ngá»™, khÃ´ng thá»ƒ giáº£ng Ä‘Æ°á»£c báº±ng lá»i! Trá»Ÿ láº¡i vá»›i cÃ¡i thá»›t. HÃ m compose táº¥t nhiÃªn lÃ  higher-order function. Ta sáº½ thá»­ xem nÃ³ lÃ m viá»‡c ra sao: 123const quÄƒng_cho_tao_cÃ¡i_thá»›t = compose(mÃ³c, chÃ , khoan, bÃ o, sáº¥y, cÆ°a);console.log(quÄƒng_cho_tao_cÃ¡i_thá»›t.toString());// =&gt; báº¡n Ä‘oÃ¡n xem log ra thá»© gÃ¬? BÃ¢y giá» ta cÃ³ 1 hÃ m, gá»i lÃ  quÄƒng_cho_tao_cÃ¡i_thá»›t(), káº¿t quáº£ cá»§a sá»± láº¯p ghÃ©p báº±ng compose táº¥t cáº£ cÃ¡c pure functions á»Ÿ trÃªn. Ta biáº¿t compose sáº½ gá»i tá»« pháº£i sang trÃ¡i, nÃªn cÃ´ng Ä‘oáº¡n nÃ o lÃ m trÆ°á»›c thÃ¬ Ä‘á»ƒ bÃªn pháº£i. Cháº¡y thá»­ 1 phÃ¡t: 123const thá»›t = quÄƒng_cho_tao_cÃ¡i_thá»›t('khÃºc gá»—');console.log(thá»›t); // =&gt; khÃºc gá»— Ä‘Ã£ cÆ°a Ä‘Ã£ sáº¥y Ä‘Ã£ bÃ o Ä‘Ã£ khoan Ä‘Ã£ chÃ  Ä‘Ã£ gáº¯n mÃ³c Váº­y lÃ  Ä‘á»§ cÃ´ng Ä‘oáº¡n, khÃºc gá»— Ä‘Ã£ trá»Ÿ thÃ nh má»™t cÃ¡i thá»›t tá»‘t. NhÆ°ng chÆ°a háº¿t. Khi báº¡n treo cÃ¡i thá»›t Ä‘Ã³ á»Ÿ nhÃ , nhiá»u ngÆ°á»i quen Ä‘áº¿n chÆ¡i tháº¥y Ä‘áº¹p há»i mua. Nhiá»u Ä‘áº¿n má»©c báº¡n quyáº¿t Ä‘á»‹nh kinh doanh thá»›t. LÃ m thá»›t kinh doanh thÃ¬ pháº£i gÃ¡n nhÃ£n, váº­y lÃ  báº¡n táº¡o ra má»™t pure function má»›i vÃ  dÃ¹ng compose Ä‘á»ƒ lÃ m khuÃ´n sáº£n suáº¥t loáº¡i thá»›t commercial nÃ y. Dá»… á»£t, khÃ´ng áº£nh hÆ°á»Ÿng gÃ¬ Ä‘áº¿n loáº¡i thá»›t cho nhÃ  dÃ¹ng. 12345const nhÃ£n = (x) =&gt; &#123; return `$&#123;x&#125; Ä‘Ã£ dÃ¡n nhÃ£n`;&#125;;const lÃ m_thá»›t_Ä‘á»ƒ_bÃ¡n = compose(nhÃ£n, mÃ³c, chÃ , khoan, bÃ o, sáº¥y, cÆ°a); Hoáº·c táº­n dá»¥ng láº¡i khuÃ´n máº«u cÅ©: 1const lÃ m_thá»›t_Ä‘á»ƒ_bÃ¡n = compose(nhÃ£n, quÄƒng_cho_tao_cÃ¡i_thá»›t); Thá»­ xem sao: 123const thá»›t_bÃ¡n = lÃ m_thá»›t_Ä‘á»ƒ_bÃ¡n('khÃºc gá»—');console.log(thá»›t_bÃ¡n);// =&gt; khÃºc gá»— Ä‘Ã£ cÆ°a Ä‘Ã£ sáº¥y Ä‘Ã£ bÃ o Ä‘Ã£ khoan Ä‘Ã£ chÃ  Ä‘Ã£ mÃ³c Ä‘Ã£ dÃ¡n nhÃ£n Äá»ƒ má»Ÿ rá»™ng thá»‹ pháº§n, hÆ°á»›ng Ä‘áº¿n phÃ¢n khÃºc giÃ¡ ráº», báº¡n táº¡o ra dÃ²ng sáº£n pháº©m thá»›t táº§m trung, dÃ¹ng chip MediaTek, bá» qua bÆ°á»›c sáº¥y khÃ´ vÃ  Ä‘Ã¡nh bÃ³ng Ä‘á»ƒ giáº£m giÃ¡ thÃ nh. Ráº¥t Ä‘Æ¡n giáº£n: 1const lÃ m_thá»›t_loáº¡i_hai = compose(nhÃ£n, mÃ³c, khoan, bÃ o, cÆ°a); Thá»­ xem sao: 123const thá»›t_loáº¡i_hai = lÃ m_thá»›t_loáº¡i_hai('khÃºc gá»—');console.log(thá»›t_loáº¡i_hai);// =&gt; khÃºc gá»— Ä‘Ã£ cÆ°a Ä‘Ã£ bÃ o Ä‘Ã£ khoan Ä‘Ã£ mÃ³c Ä‘Ã£ dÃ¡n nhÃ£n Láº­p trÃ¬nh nhÆ° váº­y pháº£i nÃ³i lÃ  vÃ´ cÃ¹ng tao nhÃ£, lá»‹ch thiá»‡p! ÄÃ´i khi tÃ´i cáº£m tháº¥y phong cÃ¡ch láº­p trÃ¬nh Functional Programming cÃ³ sá»± thanh tá»‹nh Ä‘áº§y cháº¥t quÃ½ tá»™c, vá»«a bÃ¬nh dÃ¢n láº¡i vá»«a hÃ n lÃ¢m, Ä‘áº¹p Ä‘áº¿n má»©c khÃ³ hiá»ƒu! Náº¿u dÃ¹ng OOP, cÃ³ thá»ƒ chÃºng ta cÃ²n Ä‘ang loay hoay giá»¯a má»™t Ä‘á»‘ng class MÃ¡y CÆ°a, MÃ¡y BÃ o, MÃ¡y Khoanâ€¦ Hoáº·c 1 class MÃ¡y LÃ m Thá»›t khá»•ng lá»“ cÃ³ Ä‘á»§ methods cÆ°a, bÃ o, khoanâ€¦ Rá»“i cÃ²n má»™t má»› properties mÃ  ta pháº£i cÃ¢n nháº¯c xem cÃ¡i nÃ o public, cÃ¡i nÃ o private. Rá»“i pháº£i táº¡o instance, thá»«a káº¿ qua láº¡i máº¥y vÃ²ng may ra má»›i lÃ m Ä‘Æ°á»£c cÃ¡i thá»›t. Muá»‘n thÃªm dÃ²ng sáº£n pháº©m láº¡i cÃ ng khÃ³ khÄƒn. Pháº£i táº¡o class Thá»›t_nhÃ dÃ¹ng, extend ra Thá»›tÄ‘á»ƒbÃ¡n, Thá»›tÄ‘á»ƒ_bÃ¡n_loáº¡i_2, phiá»n phá»©c khÃ´ng sao ká»ƒ xiáº¿t! Functional Programming thÃ¬ chá»‰ cáº§n máº¥y hÃ m Ä‘Æ¡n giáº£n, rá»i ráº¡c, dÃ¹ng compose láº¯p rÃ¡p láº¡i nhÆ° láº¯p rÃ¡p dÃ¢y chuyá»n cÃ´ng nghá»‡ lÃ  cháº¿ Ä‘Æ°á»£c cÃ¡c kiá»ƒu thá»›t. Function Composition tá»±a nhÆ° má»™t nhÃ  mÃ¡y hiá»‡n Ä‘áº¡i, má»—i chi tiáº¿t linh kiá»‡n Ä‘Æ°á»£c xá»­ lÃ½ báº±ng má»™t robot chuyÃªn trÃ¡ch, káº¿t há»£p láº¡i vá»›i nhau má»™t cÃ¡ch khoa há»c Ä‘á»ƒ táº¡o ra sáº£n pháº©m hoÃ n thiá»‡n. PipeMá»™t biáº¿n thá»ƒ cá»§a compose lÃ  pipe, váº­n hÃ nh theo chiá»u ngÆ°á»£c láº¡i. Ta cÃ³ thá»ƒ implement báº±ng cÃ¡ch Ä‘áº£o vá»‹ trÃ­ f vÃ  g tháº¿ nÃ y: 123const pipe = (...fns) =&gt; &#123; return fns.reduce((f, g) =&gt; (x) =&gt; g(f(x)));&#125;; Hoáº·c giá»¯ nguyÃªn code cá»§a compose nhÆ°ng thay reduce báº±ng reduceRight: 123const pipe = (...fns) =&gt; &#123; return fns.reduceRight((f, g) =&gt; (x) =&gt; f(g(x)));&#125;; VÃ¬ pipe tá»• há»£p cÃ¡c hÃ m theo chiá»u ngÆ°á»£c láº¡i so vá»›i compose nÃªn ta viáº¿t: 1const lÃ m_thá»›t_dá»m = pipe(cÆ°a, bÃ o, nhÃ£n); Thá»­ xem sao: 123const thá»›t_dá»m = lÃ m_thá»›t_dá»m('khÃºc gá»—');console.log(thá»›t_dá»m);// =&gt; khÃºc gá»— Ä‘Ã£ cÆ°a Ä‘Ã£ bÃ o Ä‘Ã£ dÃ¡n nhÃ£n DÃ¹ng pipe cÃ³ váº» thuáº­n máº¯t hÆ¡n. Thá»© tá»± cÃ¡c bÆ°á»›c cÆ°a, bÃ oâ€¦ trÃ´ng khÃ¡ tá»± nhiÃªn. Náº¿u báº¡n quen vá»›i cÃ¡ch suy luáº­n ToÃ¡n há»c thÃ¬ báº¡n sáº½ thÃ­ch compose. CÃ²n náº¿u báº¡n muá»‘n trá»±c quan dá»… hiá»ƒu thÃ¬ cá»© dÃ¹ng pipe. compose vÃ  pipe lÃ  nhá»¯ng thuáº­t phÃ¡p nháº­p mÃ´n dá»… há»c, dá»… dÃ¹ng, nhÆ°ng khÃ´ng kÃ©m uy lá»±c, thÆ° viá»‡n Functional Programming nÃ o cÅ©ng cÃ³. Trong Ramda.js, ngoÃ i compose vÃ  pipe, cÃ¡c tÃ¡c giáº£ cÃ²n bá»• sung thÃªm pipeK, pipeP, composeK, composeP. Khi Ä‘Ã£ thÃ´ng tháº¡o, báº¡n hoÃ n toÃ n cÃ³ thá»ƒ táº¡o ra compose theo cÃ¡ch cá»§a báº¡n. VÃ­ dá»¥ composeBinary liÃªn káº¿t cÃ¡c hÃ m tá»« giá»¯a sang 2 bÃªn thay vÃ¬ tá»« Ä‘áº§u nÃ y Ä‘áº¿n Ä‘áº§u kia, composeRandom liÃªn káº¿t cÃ¡c hÃ m khÃ´ng theo tráº­t tá»± cá»‘ Ä‘á»‹nhâ€¦ ÄÃ³ lÃ  khÃ´ng gian sÃ¡ng táº¡o thuá»™c vá» riÃªng báº¡n. Currying functionThuáº­t ngá»¯ currying vÃ  cÃ¡c dáº¡ng curry, curried cá»§a nÃ³ trong khoa há»c mÃ¡y tÃ­nh Ä‘Æ°á»£c Christopher Strachey Ä‘áº·t ra tá»« nÄƒm 1967 Ä‘á»ƒ ghi nhá»› cÃ´ng lao cá»§a Haskell Brooks Curry, má»™t nhÃ  ToÃ¡n há»c vÃ  Luáº­n lÃ½ há»c ngÆ°á»i Má»¹. Currying function lÃ  lÃ m cho 1 function trá»Ÿ thÃ nh â€œcurried functionâ€. CÃ¡i function ban Ä‘áº§u Ä‘Ã³ hÆ¡i ngá»‘c ngháº¿ch, nÃ³ cáº§n báº¡n truyá»n vÃ o N tham sá»‘ Ä‘á»ƒ tÃ­nh toÃ¡n, mÃ  náº¿u thiáº¿u 1 tham sá»‘, nÃ³ sáº½ khÃ´ng cháº¡y. VÃ­ dá»¥ hÃ m sum tháº¿ nÃ y: 123const sum = (a, b, c) =&gt; &#123; return a + b + c;&#125;; sum cáº§n 3 tham sá»‘ Ä‘á»ƒ cá»™ng dá»“n láº¡i, náº¿u thiáº¿u, sáº½ khÃ´ng tÃ­nh toÃ¡n ra Ä‘Æ°á»£c. 12345678// cÃ³ thá»ƒ ra sÃ¢nsum(5, 3, 2); // =&gt; 10sum(4, 4, 2); // =&gt; 10sum(4, 3, 3); // =&gt; 10sum(3, 5, 2); // =&gt; 10// nhÆ°ngsum(4, 5); // =&gt; NaN ÄÃ¢y lÃ  thiáº¿u tiá»n Ä‘áº¡o cáº£ Ä‘á»™i khÃ´ng chá»‹u ra sÃ¢n táº­p! NhÆ°ng cuá»™c sá»‘ng Ä‘Ã¢u pháº£i lÃºc nÃ o cÅ©ng thuáº­n lá»£i, Ä‘áº§y Ä‘á»§ cho chÃºng ta? DÃ¹ cáº£ máº¥y tiá»n Ä‘áº¡o Ä‘á»u bá»‹ cháº¥n thÆ°Æ¡ng, treo giÃ², trá»‘n táº­p thÃ¬ cÃ¡c anh cÃ²n láº¡i váº«n pháº£i cÃ³ trÃ¡ch nhiá»‡m ra sÃ¢n chá»©! Currying chÃ­nh lÃ  ká»¹ thuáº­t biáº¿n hÃ m sum ngá»‘c Ä‘Ã³ trá»Ÿ thÃ nh má»™t function vi diá»‡u hÆ¡n, náº¿u báº¡n gá»i nÃ³ vá»›i 1 tham sá»‘, nÃ³ sáº½ tráº£ vá» 1 hÃ m táº¡m thá»i, giá»¯ láº¡i tham sá»‘ Ä‘Ã³, chá» khi nÃ o Ä‘á»§ 3 tham sá»‘ thÃ¬ má»›i thá»±c hiá»‡n tÃ­nh toÃ¡n. HÃ¬nh dung báº¡n tá»• chá»©c má»™t buá»•i party, má»i 3 ngÆ°á»i báº¡n tham gia. LÃºc nÃ y Ä‘Ã£ cÃ³ máº·t 2 ngÆ°á»i, cÃ²n 1 ngÆ°á»i Ä‘áº¿n muá»™n. Báº¡n quyáº¿t Ä‘á»‹nh khÃ´ng cáº§n chá» ná»¯a. Bá»¯a tiá»‡c cá»© báº¯t Ä‘áº§u Ä‘Ã£, chá»«ng nÃ o ngÆ°á»i kia Ä‘áº¿n thÃ¬ tÃ­nh tiáº¿p. ÄÃ¢y lÃ  1 cÃ¡ch implement cho hÃ m curry: 123456789101112131415161718const curry = (fn) =&gt; &#123; let totalArguments = fn.length; let next = (argumentLength, rest) =&gt; &#123; if (argumentLength &gt; 0) &#123; return (...args) =&gt; &#123; return next( argumentLength - args.length, [ ...rest, ...args, ] ); &#125;; &#125; return fn(...rest); &#125;; return next(totalArguments, []);&#125;; VÃ  curry táº¥t nhiÃªn cÅ©ng lÃ  higher-order function. Thá»­ dÃ¹ng vá»›i sum xem sao: 1const curriedSum = curry(sum); curriedSum bÃ¢y giá» lÃ  phiÃªn báº£n curried cá»§a hÃ m sum trÆ°á»›c Ä‘Ã³. 123456curriedSum(4, 4, 2); // =&gt; 10curriedSum(4, 3, 3); // =&gt; 10curriedSum(3, 5, 2); // =&gt; 10// vÃ curriedSum(5, 3); // =&gt; [Function] curriedSum(5, 3) lÃ  1 function. NÃ³ Ä‘ang chá» Ä‘á»£i tham sá»‘ cuá»‘i cÃ¹ng xuáº¥t hiá»‡n. Náº¿u bÃ¢y giá» ta gá»i nÃ³ vá»›i 1 tham sá»‘ thÃ¬ káº¿t quáº£ sáº½ Ä‘Æ°á»£c tÃ­nh toÃ¡n ra: 1curriedSum(5, 3)(2); // =&gt; 10 Náº¿u ta truyá»n nhiá»u hÆ¡n sá»‘ lÆ°á»£ng tham sá»‘ cÃ²n thiáº¿u thÃ¬ sao? á» Ä‘Ã¢y lÃ  1 tham sá»‘ cuá»‘i cÃ¹ng. Theo cÃ¡ch implement trÃªn thÃ¬ nÃ³ sáº½ bá» qua cÃ¡c tham sá»‘ dÆ° thá»«a. CÃ¡c phiÃªn báº£n curry cá»§a Ramda.js vÃ  Lodash FP cÅ©ng hÃ nh xá»­ nhÆ° váº­y. 1curriedSum(5, 3)(2, 4, 8); // =&gt; 10 Má»™t Ä‘iá»ƒm quan trá»ng ná»¯a lÃ  ta cÃ³ thá»ƒ phÃ¢n tÃ¡ch hÃ m gá»‘c ra tá»« 1 Ä‘áº¿n N pháº§n, vá»›i N lÃ  sá»‘ lÆ°á»£ng tham sá»‘ cá»§a hÃ m gá»‘c Ä‘Ã³. Cháº³ng háº¡n, náº¿u hÃ m gá»‘c cÃ³ 3 tham sá»‘, ta cÃ³ thá»ƒ chia nÃ³ ra 1, 2 hoáº·c 3 pháº§n. Nhá»¯ng cÃ¡ch viáº¿t sau lÃ  tÆ°Æ¡ng Ä‘Æ°Æ¡ng: 1234curriedSum(3, 5, 2);curriedSum(3, 5)(2);curriedSum(3)(5, 2);curriedSum(3)(5)(2); curry, cÅ©ng nhÆ° compose vÃ  pipe lÃ  nhá»¯ng ká»¹ thuáº­t cÄƒn báº£n, ai cÅ©ng pháº£i há»c, pháº£i biáº¿t. Má»i ngÃ´n ngá»¯ Ä‘Æ°á»£c thiáº¿t káº¿ vá»›i tÆ° tÆ°á»Ÿng Functional Programming nhÆ° Haskell, Scalla, Elmâ€¦ Ä‘á»u cÃ³ sáºµn cÃ¡c hÃ m nÃ y. ChÃºng ráº¥t tinh táº¿ vÃ  Ä‘Æ°á»£c dÃ¹ng á»Ÿ kháº¯p nÆ¡i. Chá»‰ cáº§n thÃ nh tháº¡o 3 phÃ¡p quyáº¿t nÃ y thÃ¬ báº¡n Ä‘Ã£ Ä‘Æ°á»£c xem nhÆ° Ä‘á»‡ tá»­ Functional Programming chÃ¢n chÃ­nh.","categories":[],"tags":[{"name":"functional programming","slug":"functional-programming","permalink":"http://nthung2112.github.io/tags/functional-programming/"}]},{"title":"Functional Programming - Pháº§n 1 - Con Ä‘Æ°á»ng sÃ¡ng","slug":"Functional-Programming-Phan-1-Con-duong-sang","date":"2018-06-12T08:35:00.000Z","updated":"2018-06-23T08:53:43.941Z","comments":true,"path":"2018/06/Functional-Programming-Phan-1-Con-duong-sang.html","link":"","permalink":"http://nthung2112.github.io/2018/06/Functional-Programming-Phan-1-Con-duong-sang.html","excerpt":"LÃºc báº¥y giá», Tin giá»›i TÃ¢y phÆ°Æ¡ng xuáº¥t hiá»‡n 2 lÃ£o quÃ¡i NguyÃªn Anh háº­u ká»³ Ä‘á»‰nh phong, chá»‰ thiáº¿u ná»­a bÆ°á»›c cáº£m ngá»™ Ã½ cáº£nh lÃ  Ä‘á»™t phÃ¡ tá»›i cáº£nh giá»›i HÃ³a Tháº§n. Má»™t ngÆ°á»i lÃ  Äá»“ Linh tÃ´n giáº£ - tá»©c Alan Turing, ná»•i danh vá»›i phÃ¡p mÃ´n Turing Machine. NgÆ°á»i kia lÃ  KhÃ¢u Ká»³ thÆ°á»£ng tiÃªn, Alonzo Church, tung hoÃ nh tam giá»›i báº±ng Ä‘áº¡o thuáº­t Lambda Calculus (1). Turing Machine cá»§a Alan Turing vÃ  Lambda Calculus cá»§a Alonzo Church thá»±c ra lÃ  hai cÃ¡ch tiáº¿p cáº­n nguyÃªn lÃ½ xá»­ lÃ½ tÃ­nh toÃ¡n trong computer, thÆ°á»ng Ä‘Æ°á»£c giá»›i chuyÃªn mÃ´n gá»i chung lÃ  Luáº­n Ä‘á» Church - Turing (The Church-Turing Thesis).","text":"LÃºc báº¥y giá», Tin giá»›i TÃ¢y phÆ°Æ¡ng xuáº¥t hiá»‡n 2 lÃ£o quÃ¡i NguyÃªn Anh háº­u ká»³ Ä‘á»‰nh phong, chá»‰ thiáº¿u ná»­a bÆ°á»›c cáº£m ngá»™ Ã½ cáº£nh lÃ  Ä‘á»™t phÃ¡ tá»›i cáº£nh giá»›i HÃ³a Tháº§n. Má»™t ngÆ°á»i lÃ  Äá»“ Linh tÃ´n giáº£ - tá»©c Alan Turing, ná»•i danh vá»›i phÃ¡p mÃ´n Turing Machine. NgÆ°á»i kia lÃ  KhÃ¢u Ká»³ thÆ°á»£ng tiÃªn, Alonzo Church, tung hoÃ nh tam giá»›i báº±ng Ä‘áº¡o thuáº­t Lambda Calculus (1). Turing Machine cá»§a Alan Turing vÃ  Lambda Calculus cá»§a Alonzo Church thá»±c ra lÃ  hai cÃ¡ch tiáº¿p cáº­n nguyÃªn lÃ½ xá»­ lÃ½ tÃ­nh toÃ¡n trong computer, thÆ°á»ng Ä‘Æ°á»£c giá»›i chuyÃªn mÃ´n gá»i chung lÃ  Luáº­n Ä‘á» Church - Turing (The Church-Turing Thesis). Turing Machine Ä‘áº·t cÆ¡ sá»Ÿ trÃªn viá»‡c náº¯m giá»¯ state machine vÃ  tráº¡ng thÃ¡i tiáº¿n trÃ¬nh, cÃ²n Ã½ tÆ°á»Ÿng Lambda Calculus Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn cÃ¡c tÃ­nh cháº¥t cá»§a hÃ m toÃ¡n há»c. Láº¥y tu vi cá»§a bá»•n tiÃªn hiá»‡n giá» thÃ¬ chÆ°a lÄ©nh há»™i Ä‘Æ°á»£c máº¥y thá»© cao siÃªu nhÆ° váº­y, nÃªn khÃ´ng dÃ¡m láº¡m bÃ n á»Ÿ Ä‘Ã¢y. Chá»‰ biáº¿t ráº±ng, 2 thuáº­t phÃ¡p ká»ƒ trÃªn lÃ  khá»Ÿi nguá»“n cá»§a 2 trÆ°á»ng phÃ¡i tu luyá»‡n máº¡nh nháº¥t trong tin giá»›i hiá»‡n nay: Object Oriented Programming vÃ  Functional Programming. CÃ³ khÃ¡ nhiá»u cÆ¡ cháº¿ láº­p trÃ¬nh - Programming Paradigm. OOP vÃ  Functional Programming chá»‰ lÃ  2 trong sá»‘ Ä‘Ã³. Trong cuá»‘n â€œProgramming Paradigms for Dummies: What Every Programmer Should Knowâ€œ, tÃ¡c giáº£ Peter Van Roy Ä‘Æ°a ra mÃ´ hÃ¬nh tá»•ng há»£p quan há»‡ giá»¯a cÃ¡c cÆ¡ cháº¿ láº­p trÃ¬nh nhÆ° tháº¿ nÃ y: Trong lá»‹ch sá»­ cÃ´ng nghá»‡, cÃ³ váº» OOP chiáº¿m Æ°u tháº¿ hÆ¡n so vá»›i Functional Programming. Báº¡n cá»© thá»­ nhÃ¬n xung quanh mÃ¬nh lÃ  biáº¿t, tá»« thá»i táº­p tÃ nh code Ä‘Ã£ tháº¥y thiÃªn Ä‘á»‹a trÃ n ngáº­p quy táº¯c OOP rá»“i. CÃ¡c job description, cÃ¡c buá»•i interview Ä‘á»u nháº¯c Ä‘áº¿n OOP nhÆ° phÃ¡p thuáº­t cÄƒn báº£n. Tháº£o luáº­n ká»¹ thuáº­t háº§u háº¿t xoay quanh máº¥y khÃ¡i niá»‡m Class, Object, Inheritance, rá»“i cao hÆ¡n thÃ¬ SOLID, Polymorphism, Encapsulationâ€¦ NhÆ°ng, trÃªn tháº¿ giá»›i, tá»« thá»i Lisp Ä‘áº¿n FP, rá»“i Haskell, Elixir, chÆ°a bao giá» thiáº¿u váº¯ng nhá»¯ng tu tin giáº£ Ä‘i theo con Ä‘Æ°á»ng Functional Programming. Nháº¥t lÃ  khoáº£ng sau 2010, khÃ´ng rÃµ vÃ¬ sao ngÆ°á»i ta báº¯t Ä‘áº§u phÃ n nÃ n nhiá»u hÆ¡n vá» OOP, trÃ­ch dáº«n nhiá»u hÆ¡n luáº­n Ä‘iá»ƒm banana/gorilla cá»§a Joe Armstrong (2), theo Ä‘Ã³, chá»§ Ä‘á» â€œFunctional Programmingâ€ báº¯t Ä‘áº§u nÃ³ng dáº§n trá»Ÿ láº¡i. TÃ´i biáº¿t Ä‘áº¿n Functional Programming vÃ o khoáº£ng 2015 qua má»™t talk show trÃªn YouTube cá»§a â€œchÃº Bobâ€œ, nhÆ°ng khÃ´ng hiá»ƒu láº¯m nÃªn cÅ©ng khÃ´ng chÃº Ã½. Pháº£i sang 2016, tÃ´i má»›i chÃ­nh thá»©c tÃ¬m hiá»ƒu sÃ¢u vá» Functional Programming sau khi Ä‘á»c 2 loáº¡t bÃ i viáº¿t â€œComposing Softwareâ€œ cá»§a Eric Elliott vÃ  â€œSo You Want to be a Functional Programmerâ€œ cá»§a Charles Scalfani trÃªn Medium. Eric Elliott láº§n lÆ°á»£t giáº£i thÃ­ch tá»«ng concepts cá»§a Functional Programming má»™t cÃ¡ch tÆ°á»ng táº­n, dá»… hiá»ƒu. CÃ²n Charles Scalfani Ä‘Ãºng lÃ  fan cuá»“ng Functional Programming. Anh trÃ¬nh bÃ y nÃ³ dÆ°á»›i dáº¡ng má»™t há»‡ thá»‘ng triáº¿t lÃ½, tháº¿ giá»›i quan Ä‘áº·c sáº¯c. Tháº­m chÃ­, Scalfani cÃ²n Ä‘á» cao Functional Programming nhÆ° náº¥c thang tiáº¿n hÃ³a trong lá»‹ch sá»­ láº­p trÃ¬nh. Lá»‘i viáº¿t cá»§a anh gÃ¢y áº¥n tÆ°á»£ng cá»±c máº¡nh. TrÆ°á»›c Ä‘Ã³, Scalfani cÃ²n cÃ³ bÃ i â€œGoodbye, Object Oriented Programmingâ€œ gÃ¢y tranh luáº­n sÃ´i ná»•i. NhÆ°ng báº¡n Ä‘á»c nÃªn lÆ°u Ã½, Functional Programming khÃ´ng bÃ i xÃ­ch OOP. ChÃºng chá»‰ lÃ  nhá»¯ng con Ä‘Æ°á»ng tu luyá»‡n khÃ¡c nhau, cÃ¹ng hÆ°á»›ng vá» Äáº¡i Äáº¡o. Trong khi viáº¿t code, ta hoÃ n toÃ n cÃ³ thá»ƒ phá»‘i há»£p nhiá»u cÆ¡ cháº¿ láº­p trÃ¬nh khÃ¡c nhau, miá»…n sao Ä‘áº¡t Ä‘áº¿n káº¿t quáº£ ÄÃºng - Nhanh - á»”n - Äáº¹p. ReactJS lÃ  má»™t vÃ­ dá»¥ tiÃªu biá»ƒu, cÃ³ thá»ƒ coi nÃ³ nhÆ° 7 pháº§n Functional Programming + 3 pháº§n OOP. Vá» Ä‘iá»ƒm nÃ y, Anjana Vakil cÃ³ má»™t bÃ i thuyáº¿t trÃ¬nh ráº¥t hay á»Ÿ GOTO 2017. DÃ¹ sao, tá»« Ä‘Ã³ Ä‘áº¿n nay, khuynh hÆ°á»›ng tÆ° duy Functional Programming váº«n tá»«ng bÆ°á»›c lan rá»™ng, áº£nh hÆ°á»Ÿng Ä‘áº¿n thiáº¿t káº¿ cá»§a ráº¥t nhiá»u chÆ°Æ¡ng trÃ¬nh hiá»‡n Ä‘áº¡i. Chá»‰ cáº§n Ä‘á»ƒ Ã½ má»™t chÃºt, chÃºng ta cÃ³ thá»ƒ nháº­n ra cÃ¡c Ä‘áº·c tÃ­nh ná»•i báº­t cá»§a Functional Programming xuáº¥t hiá»‡n trong háº§u háº¿t frameworks vÃ  cÃ¡c báº£n cáº­p nháº­t ngÃ´n ngá»¯ má»›i. Tháº­m chÃ­, náº¿u xÃ©t ká»¹, nhá»¯ng khÃ¡i niá»‡m thoáº¡t nhÃ¬n cÃ³ váº» khÃ´ng liÃªn quan nhÆ° WebComponent, Serverless, Microserviceâ€¦ cÅ©ng áº©n hiá»‡n tÆ° tÆ°á»Ÿng Functional Programming. VÃ  tÃ´i gáº§n nhÆ° khÃ´ng cÃ²n Ä‘á»¥ng tá»›i class, new, this ná»¯a. Whatâ€™s Functional Programming?Váº­y rá»‘t cuá»™c Functional Programming lÃ  cÃ¡i gÃ¬? Náº¿u google báº¡n sáº½ tÃ¬m tháº¥y hÃ ng tÃ¡ cÃ¡ch giáº£i thÃ­ch khÃ¡c nhau. CÃ²n tÃ´i chá»§ chÆ°Æ¡ng nÃªn Ä‘á»‹nh nghÄ©a ngáº¯n gá»n tháº¿ nÃ y: Functional Programming lÃ  phÆ°Æ¡ng phÃ¡p láº­p trÃ¬nh láº¥y function lÃ m Ä‘Æ¡n vá»‹ thao tÃ¡c cÆ¡ báº£n. ÄÃºng váº­y. Functional Programming xÃ©t vá» lÃ½ tÆ°á»Ÿng thÃ¬ chá»‰ cÃ³ function, function vÃ  function. KhÃ´ng lá»‡nh gÃ¡n (assignment statements), khÃ´ng cáº§n tá»›i cÃ¡c biáº¿n (variables), khÃ´ng lÆ°u giá»¯ tráº¡ng thÃ¡i toÃ n cá»¥c (global state). Trong Functional Programming, chÃºng ta Ä‘iá»u khiá»ƒn dÃ²ng cháº£y chÆ°Æ¡ng trÃ¬nh báº±ng cÃ¡ch phá»‘i há»£p cÃ¡c functions láº¡i vá»›i nhau. ChÃºng ta tung há»©ng cÃ¡c functions qua láº¡i, nháº­n vÃ o function, nháº£ ra function, lá»“ng ghÃ©p, xÃ¢u chuá»—i, biáº¿n hÃ³a chÃºng theo má»i cÃ¡ch cÃ³ thá»ƒ nghÄ© ra. ÄÃ³ gá»i lÃ  khÃ´ng gian â€œfirst-class functionsâ€œ, nÆ¡i láº­p trÃ¬nh viÃªn Ä‘á»‘i xá»­ vá»›i functions nhÆ° â€œfirst-class citizensâ€. á» Ä‘Ã¢u functions Ä‘Æ°á»£c coi trá»ng nhÆ° váº­y, á»Ÿ Ä‘Ã³ ta cÃ³ thá»ƒ láº­p trÃ¬nh theo cÆ¡ cháº¿ Functional Programming. JavaScript, Python, Golang, ngay cáº£ PHP chÃ­nh lÃ  nhÆ° váº­y. Java tÃ­nh tá»« v8.0 ra máº¯t nÄƒm 2017 cÅ©ng lÃ  nhÆ° váº­y. DÃ¹ khÃ´ng hoÃ n háº£o nhÆ° Haskell, F#, etc - nhá»¯ng tu chÃ¢n giá»›i vá»‘n Ä‘Æ°á»£c sinh ra cho Functional Programming - nhÆ°ng ta váº«n cÃ³ thá»ƒ tu luyá»‡n Functional Programming Ä‘Æ°á»£câ€¦ Chá»‰ cÃ³ Ä‘iá»u pháº£i váº­n dá»¥ng khÃ¡c má»™t chÃºt, linh hoáº¡t hÆ¡n má»™t chÃºt. ÄÃ³ lÃ  lÃ½ do táº¡i sao trong cÃ¡c chÆ°Æ¡ng trÃ¬nh JavaScript, Python, dÃ¹ viáº¿t theo phong cÃ¡ch Functional Programming nhÆ°ng váº«n pháº£i dÃ¹ng Ä‘áº¿n cÃ¡c biáº¿n, lá»‡nh gÃ¡n Ä‘á»ƒ thao tÃ¡c. CÃ¡c tu tin giáº£ táº§ng tháº¥p muá»‘n báº¯t Ä‘áº§u con Ä‘Æ°á»ng Functional Programming cáº§n pháº£i náº¯m báº¯t nhá»¯ng khÃ¡i niá»‡m cÆ¡ báº£n nhÆ° Immutability, Purity, Higher-order functions, Currying function, Function Compositionâ€¦ Sau khi thÄƒng cáº¥p cáº£nh giá»›i cao hÆ¡n thÃ¬ cÃ³ thá»ƒ tÃ¬m hiá»ƒu Monad, Functor, Setoid, Idempotent, Lensâ€¦ vÃ  nhiá»u ná»¯a. NÃ o, bÃ¢y giá» hÃ£y báº¯t Ä‘áº§u hÃ nh trÃ¬nhâ€¦ ImmutabilityImmutability nghÄ©a lÃ  tÃ­nh báº¥t biáº¿n. NguyÃªn táº¯c thá»© nháº¥t trong Functional Programming lÃ : cÃ¡i nÃ o Ä‘Ã£ khai bÃ¡o má»™t láº§n thÃ¬ mÃ£i mÃ£i nhÆ° váº­y, khÃ´ng bao giá» thay Ä‘á»•i ná»¯a. CÃ¡c biáº¿n hoáº·c Ä‘á»‘i tÆ°á»£ng trong ká»‹ch báº£n Functional Programming náº¿u cÃ³ thÃ¬ pháº£i immutable. Code tháº¿ nÃ y khÃ´ng pháº£i lÃ  Functional Programming vÃ¬ x vÃ  y bá»‹ thay Ä‘á»•i. 123456var x = 5;var y = 2;while (x &lt; 10) &#123; y += x; x++;&#125; Mutable lÃ  Ä‘iá»u tá»‘i ká»µ trong Functional Programming. Cáº§n pháº£i háº¡n cháº¿ Ä‘áº¿n má»©c tháº¥p nháº¥t. CÃ¡c máº«u coding convention vÃ  best practices thÃ´ng dá»¥ng hiá»‡n nay Ä‘á»u khuyáº¿n khÃ­ch sá»­ dá»¥ng const Ä‘á»ƒ khai bÃ¡o, bá» háº³n var , vÃ  dÃ¹ng let Ä‘Ãºng liá»u lÆ°á»£ng. Äá»‘i vá»›i Object, ta nÃªn dÃ¹ng Object.freeze Ä‘á»ƒ lock toÃ n bá»™ thuá»™c tÃ­nh. CÅ©ng cÃ³ thá»ƒ dÃ¹ng Object.defineProperty, Object.defineProperties Ä‘á»ƒ lock má»™t sá»‘ thuá»™c tÃ­nh quan trá»ng. CÃ¡c giáº£i phÃ¡p nÃ y Ä‘á»u chá»‰ há»— trá»£ 1 cáº¥p thuá»™c tÃ­nh. Pháº£i chá»§ Ä‘á»™ng code thÃªm náº¿u muá»‘n Ã¡p dá»¥ng lÃªn cÃ¡c thuá»™c tÃ­nh con. Náº¿u dá»± Ã¡n Ä‘á»§ phá»©c táº¡p, hÃ£y cÃ¢n nháº¯c sá»­ dá»¥ng cÃ¡c thÆ° viá»‡n chuyÃªn dá»¥ng nhÆ° Immutable.js, Baobapâ€¦ PurityPurity lÃ  tÃ­nh thuáº§n khiáº¿t, thuáº§n tÃºy, sá»± trong sáº¡ch, khÃ´ng bá»‹ pha táº¡p. ÄÃ¢y lÃ  nguyÃªn táº¯c thá»© hai trong Functional Programming: táº¥t cáº£ cÃ¡c hÃ m Ä‘á»u pháº£i lÃ  pure function, khÃ´ng cÃ³ hiá»‡u á»©ng phá»¥ (side effect), khÃ´ng Ä‘Æ°á»£c tÃ¡c Ä‘á»™ng lÃªn báº¥t cá»© giÃ¡ trá»‹ nÃ o bÃªn ngoÃ i nÃ³, cÅ©ng nÃ³i khÃ´ng vá»›i chá»‰nh sá»­a tham sá»‘ input. HÃ m dÆ°á»›i Ä‘Ã¢y khÃ´ng pháº£i pure function vÃ¬ nÃ³ chá»‰nh sá»­a DOM element bÃªn ngoÃ i vÃ  thay Ä‘á»•i giÃ¡ trá»‹ chá»©a trong localStorage. 123456const updateView = (html) =&gt; &#123; let $view = document.getElementById('panel'); $view.innerHTML = html; localStorage.setItem('panelCache', html); return $view;&#125; Äáº·c Ä‘iá»ƒm quan trá»ng ná»¯a cá»§a pure function lÃ  vá»›i má»—i táº­p giÃ¡ trá»‹ Ä‘áº§u vÃ o nháº¥t Ä‘á»‹nh, luÃ´n cÃ³ 1 vÃ  chá»‰ 1 káº¿t quáº£ tráº£ vá» tÆ°Æ¡ng á»©ng. ÄÃ¢y lÃ  tÃ­nh cháº¥t cá»§a hÃ m sá»‘ toÃ¡n há»c. HÃ m dÆ°á»›i Ä‘Ã¢y khÃ´ng pháº£i pure function vÃ¬ tráº£ vá» káº¿t quáº£ khÃ¡c nhau cho cÃ¹ng Ä‘áº§u vÃ o: 123const getDuration = (timestamp) =&gt; &#123; return Date.now() - timestamp;&#125;; Pure function trong Functional Programming thÆ°á»ng ngáº¯n gá»n, Ä‘Æ¡n giáº£n vÃ  chá»‰ xá»­ lÃ½ duy nháº¥t 1 váº¥n Ä‘á» logic. ÄÃ¢y lÃ  1 pure function kinh Ä‘iá»ƒn: 123const add = (a, b) =&gt; &#123; return a + b;&#125;; DÃ¹ báº¡n cÃ³ gá»i hÃ ng triá»‡u láº§n thÃ¬ add(3, 2) váº«n luÃ´n tráº£ vá» 5. Viáº¿t unit test cho pure function lÃ  nhiá»‡m vá»¥ dá»… chá»‹u nhÆ° dáº¡o chÆ¡i cÃ¹ng má»™t thiáº¿u ná»¯ ngÃ¢y thÆ¡ trong tráº¯ng váº­y! Immutability vÃ  Purity lÃ  2 Ä‘áº·c trÆ°ng cÆ¡ báº£n nháº¥t cá»§a Functional Programming, cho phÃ©p phÃ¢n biá»‡t vá»›i cÃ¡c cÆ¡ cháº¿ láº­p trÃ¬nh khÃ¡c. Tu tin giáº£ tu luyá»‡n theo con Ä‘Æ°á»ng nÃ y nháº¥t Ä‘á»‹nh pháº£i giá»¯ tÃ¢m niá»‡m â€œimmutableâ€ vÃ  â€œpureâ€ trong tá»«ng sÃ¡t na. ChÃº thÃ­ch1, Chá»¯ TÃ u ghi Alan Turing lÃ  è‰¾ä¼¦å›¾çµ - Ngáº£i LuÃ¢n Äá»“ Linh, Alonzo Church lÃ  é˜¿éš†ä½é‚±å¥‡ - A Long TÃ¡ KhÃ¢u Ká»³. 2, â€œYou wanted a banana but you got a gorilla holding the bananaâ€.","categories":[],"tags":[{"name":"functional programming","slug":"functional-programming","permalink":"http://nthung2112.github.io/tags/functional-programming/"}]},{"title":"Cáº¥u trÃºc projects vÃ  Ä‘áº·t tÃªn components trong React","slug":"Cau-truc-projects-va-dat-ten-components-trong-React","date":"2018-05-26T16:02:00.000Z","updated":"2018-05-26T13:12:57.001Z","comments":true,"path":"2018/05/Cau-truc-projects-va-dat-ten-components-trong-React.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Cau-truc-projects-va-dat-ten-components-trong-React.html","excerpt":"NhÆ° báº¡n Ä‘Ã£ biáº¿t, React chá»‰ lÃ  má»™t thÆ° viá»‡n nÃªn nÃ³ khÃ´ng chá»‰ rÃµ cho ngÆ°á»i dÃ¹ng cÃ¡ch tá»• chá»©c, phÃ¢n chia cáº¥u trÃºc thÆ° má»¥c cho dá»± Ã¡n cá»§a mÃ¬nh. XÃ©t trÃªn má»™t khÃ­a cáº¡nh, cÃ³ thá»ƒ Ä‘iá»u nÃ y lÃ  tá»‘t vÃ¬ dev cÃ³ thá»ƒ thoáº£i mÃ¡i thá»­ ráº¥t nhiá»u cÃ¡ch khÃ¡c nhau Ä‘á»ƒ chá»n ra phÆ°Æ¡ng phÃ¡p phÃ¹ há»£p vá»›i dá»± Ã¡n cá»§a mÃ¬nh. Tuy nhiÃªn, nÃ³ láº¡i khiáº¿n cho nhá»¯ng dev má»›i báº¯t Ä‘áº§u sá»­ dá»¥ng React cáº£m tháº¥y khÃ³ hiá»ƒu. BÃ i viáº¿t nÃ y sáº½ Ä‘Æ°a ra má»™t vÃ i phÆ°Æ¡ng phÃ¡p phÃ¢n chia folders, files giÃºp cho á»©ng dá»¥ng React cá»§a báº¡n cÃ³ thá»ƒ má»Ÿ rá»™ng má»™t cÃ¡ch thuáº­n tiá»‡n, nháº¥t lÃ  Ä‘á»‘i vá»›i nhá»¯ng ngÆ°á»i má»›i bÆ°á»›c chÃ¢n vÃ o React vÃ  khÃ´ng biáº¿t pháº£i lÃ m nhÆ° tháº¿ nÃ o cho há»£p lÃ½.","text":"NhÆ° báº¡n Ä‘Ã£ biáº¿t, React chá»‰ lÃ  má»™t thÆ° viá»‡n nÃªn nÃ³ khÃ´ng chá»‰ rÃµ cho ngÆ°á»i dÃ¹ng cÃ¡ch tá»• chá»©c, phÃ¢n chia cáº¥u trÃºc thÆ° má»¥c cho dá»± Ã¡n cá»§a mÃ¬nh. XÃ©t trÃªn má»™t khÃ­a cáº¡nh, cÃ³ thá»ƒ Ä‘iá»u nÃ y lÃ  tá»‘t vÃ¬ dev cÃ³ thá»ƒ thoáº£i mÃ¡i thá»­ ráº¥t nhiá»u cÃ¡ch khÃ¡c nhau Ä‘á»ƒ chá»n ra phÆ°Æ¡ng phÃ¡p phÃ¹ há»£p vá»›i dá»± Ã¡n cá»§a mÃ¬nh. Tuy nhiÃªn, nÃ³ láº¡i khiáº¿n cho nhá»¯ng dev má»›i báº¯t Ä‘áº§u sá»­ dá»¥ng React cáº£m tháº¥y khÃ³ hiá»ƒu. BÃ i viáº¿t nÃ y sáº½ Ä‘Æ°a ra má»™t vÃ i phÆ°Æ¡ng phÃ¡p phÃ¢n chia folders, files giÃºp cho á»©ng dá»¥ng React cá»§a báº¡n cÃ³ thá»ƒ má»Ÿ rá»™ng má»™t cÃ¡ch thuáº­n tiá»‡n, nháº¥t lÃ  Ä‘á»‘i vá»›i nhá»¯ng ngÆ°á»i má»›i bÆ°á»›c chÃ¢n vÃ o React vÃ  khÃ´ng biáº¿t pháº£i lÃ m nhÆ° tháº¿ nÃ o cho há»£p lÃ½. Cáº¥u trÃºc files vÃ  foldersMá»™t trong nhá»¯ng cÃ¢u há»i dev thÆ°á»ng gáº·p pháº£i khi báº¯t Ä‘áº§u code lÃ  â€œLÃ m tháº¿ nÃ o dá»ƒ phÃ¢n chia files vÃ  foldersâ€. Äá»ƒ thuáº­n tiá»‡n thÃ¬ chÃºng ta sáº½ báº¯t Ä‘áº§u tá»« cáº¥u trÃºc Ä‘Æ¡n giáº£n nháº¥t mÃ  package create-react-app Ä‘Ã£ táº¡o ra. Cá»¥ thá»ƒ lÃ  folder src. ÄÃ¢y lÃ  folder chÃ­nh chá»©a source code, vÃ¬ váº­y chÃºng ta sáº½ táº­p trung vÃ o pháº§n nÃ y. ToÃ n bá»™ nhá»¯ng files, folder khÃ¡c náº±m ngoÃ i váº«n sáº½ Ä‘Æ°á»£c giá»¯ nguyÃªn: TÃ¡ch riÃªng thÃ nh folder Containers vÃ  ComponentsCÃ³ thá»ƒ báº¡n Ä‘Ã£ tháº¥y trong má»™t vÃ i dá»± Ã¡n, dev thÆ°á»ng sá»­ dá»¥ng hai folders cÃ³ tÃªn Components vÃ  Containers 123srcâ”œâ”€ components â””â”€ containers Thoáº¡t nhÃ¬n thÃ¬ cÃ³ váº» á»•n, nhÆ°ng cÃ¡ch phÃ¢n chia nhÆ° trÃªn cÃ²n tá»“n táº¡i nhá»¯ng nhÆ°á»£c Ä‘iá»ƒm nhÆ° sau: Äá»‹nh nghÄ©a chá»©c nÄƒng má»™t cÃ¡ch khÃ´ng rÃµ rÃ ng - Sá»­ dá»¥ng cáº¥u trÃºc nhÆ° trÃªn cÃ³ thá»ƒ gÃ¢y nháº§m láº«n, hiá»ƒu láº§n vá» chá»©c nÄƒng cá»§a má»—i folder Container vÃ  Component , cÃ³ nhiá»u ngÆ°á»i sáº½ hiá»ƒu chá»©c nÄƒng cá»§a má»—i folder theo Ã½ khÃ¡c nhau. CÃ³ ngÆ°á»i thÃ¬ hiá»ƒu Containers lÃ  cÃ¡c components thá»±c hiá»‡n viá»‡c xá»­ lÃ½ logic (nhÆ° handle click, button) vÃ  láº¥y dá»¯ liá»‡u tá»« server, cÃ²n components cÃ³ nghÄ©a Presentational Component, thá»±c hiá»‡n nhiá»‡m vá»¥ hiá»ƒn thá»‹ view cho ngÆ°á»i dÃ¹ng. CÃ³ ngÆ°á»i láº¡i sá»­ dá»¥ng Containers Ä‘á»ƒ chá»©a nhá»¯ng route components (má»—i component lÃ  má»™t link route, náº¿u nhÆ° báº¡n sá»­ dá»¥ng react-router), cÃ²n Components thÃ¬ chá»©a nhá»¯ng base component Ä‘á»ƒ táº¡o nÃªn cÃ¡c route components kia. VÃ¬ tháº¿ khi lÃ m viá»‡c trong team sáº½ gÃ¢y ra khÃ´ng Ä‘á»“ng nháº¥t vÃ  cÃ¡c member khÃ³ thá»‘ng nháº¥t trong viá»‡c sá»­ dá»¥ng hai folder nÃ y. Components khÃ´ng cÃ²n linh Ä‘á»™ng, reusable - Ngay cáº£ khi báº¡n Ä‘Ã£ code ra má»™t components vá»›i chá»©c nÄƒng Ä‘áº·c thÃ¹, sau nÃ y báº¡n váº«n pháº£i sá»­a láº¡i components Ä‘Ã³ do nhá»¯ng lÃ­ do nhÆ° Ä‘á»•i requirements, thÃªm chá»©c nÄƒng,â€¦ khiáº¿n cho file chuyá»ƒn qua chuyá»ƒn láº¡i giá»¯a 2 folders components vÃ  containers. Components trÃ¹ng tÃªn - Khi sá»­ dá»¥ng react, tÃªn cá»§a má»™t component nÃªn cÃ³ Ã½ nghÄ©a nhÆ° chá»©c nÄƒng cá»§a nÃ³, vÃ  quan trá»ng lÃ  khÃ´ng nÃªn cÃ³ nhiá»u components trÃ¹ng tÃªn nhau trong project Ä‘á»ƒ trÃ¡nh gÃ¢y nháº§m láº«n. CÃ¡ch tá»• chá»©c folders nhÆ° trÃªn sáº½ táº¡o ra 2 components cÃ³ tÃªn giá»‘ng nhau, má»™t sá»­ dá»¥ng cho container, má»™t sá»­ dá»¥ng cho components (presentational - hiá»ƒn thá»‹) Giáº£m hiá»‡u suáº¥t code - Báº¡n sáº½ pháº£i thÆ°á»ng xuyÃªn navigate giá»¯a 2 folder trÃªn khi viáº¿t cho má»™t tÃ­nh nÄƒng, do má»™t tÃ­nh nÄƒng thÆ°á»ng sáº½ gá»“m cáº£ 2 loáº¡i components Má»™t cÃ¡ch phÃ¢n chia khÃ¡c cÅ©ng cÃ³ cáº¥u trÃºc 2 folder nhÆ° trÃªn, nhÆ°ng phÃ¢n biá»‡t dá»±a trÃªn module . Giáº£ sá»­ á»©ng dá»¥ng cá»§a báº¡n cÃ³ má»™t module User. Trong Ä‘Ã³ sáº½ tÃ¡ch ra thÃ nh 2 folder components vÃ  containers: 1234srcâ””â”€ User â”œâ”€ components â””â”€ containers Theo hÆ°á»›ng tiáº¿p cáº­n trÃªn, dev sáº½ khÃ´ng pháº£i gáº·p khÃ³ khÄƒn trong viá»‡c navigate giá»¯a cÃ¡c folder khi code. Báº¡n sáº½ khÃ´ng pháº£i kÃ©o lÃªn, kÃ©o xuá»‘ng Ä‘á»ƒ tÃ¬m xem components cá»§a User á»Ÿ Ä‘Ã¢u, khi Ä‘ang hoÃ n thiá»‡n file trong containers Ä‘á»ƒ Ä‘á»‘i chiáº¿u. Tuy nhiÃªn, cÃ¡ch nÃ y sáº½ sinh ra má»™t Ä‘á»‘ng folder containers vÃ  components náº¿u nhÆ° há»‡ thá»‘ng cá»§a báº¡n lá»›n vÃ  cÃ³t ráº¥t nhiá»u modules. NhÆ° váº­y, viá»‡c tÃ¡ch biá»‡t 2 folder components vÃ  containers khÃ´ng háº³n lÃ  há»£p lÃ½. Thay vÃ¬ tÃ¡ch riÃªng ra nhÆ° váº­y, cÃ¡c components sáº½ Ä‘Æ°á»£c Ä‘áº·t háº¿t trong folder components ngoáº¡i trá»« nhá»¯ng components sá»­ dá»¥ng lÃ m screens TÃ¡i cáº¥u trÃºc folders dá»±a trÃªn moduleTrong folder components, chÃºng ta sáº½ nhÃ³m cÃ¡c files láº¡i theo module hoáº·c feature/tÃ­nh nÄƒng. Vá»›i tÃ­nh nÄƒng CRUD user, chÃºng ta chá»‰ cáº§n module User, nÃªn folder tree sáº½ cÃ³ dáº¡ng nhÆ° sau: 12345srcâ””â”€ components â””â”€ User â”œâ”€ Form.jsx â””â”€ List.jsx Khi component Ä‘Æ°á»£c cáº¥u thÃ nh bá»i nhiá»u hÆ¡n má»™t file (cháº³ng háº¡n nhÆ° pháº£i import nhiá»u components khÃ¡c, hay file chá»‰nh sá»­a css cho component Ä‘Ã³), chÃºng ta sáº½ Ä‘Æ°a component nÃ y cÃ¹ng cÃ¡c files liÃªn quan vÃ o má»™t folder cÃ³ cÃ¹ng tÃªn. VÃ­ dá»¥ nhÆ° Form.jsx cáº§n thÃªm Form.css Ä‘á»ƒ chá»‰nh style, báº¡n sáº½ cÃ³ má»™t folder nhÆ° sau: 1234567srcâ””â”€ components â””â”€ User â”œâ”€ Form â”‚ â”œâ”€ Form.jsx â”‚ â””â”€ Form.css â””â”€ List.jsx UI componentsNgoÃ i cÃ¡c folder dÃ nh cho module hay tÃ­nh nÄƒng trong á»©ng dá»¥ng cá»§a báº¡n, cÃ³ thá»ƒ thÃªm má»™t folder _UI_ (hoáº·c base/atomic) dÃ¹ng cho cÃ¡c component dáº¡ng UI - lÃ  nhá»¯ng pháº§n tá»­ nhá» sá»­ dá»¥ng cho UI trong á»©ng dá»¥ng cá»§a báº¡n. ÄÃ¢y lÃ  nhá»¯ng component giá»‘ng cÃ¡c thÆ° viá»‡n open source, thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘i dÃ¹ng láº¡i nhiá»u láº§n trong á»©ng dá»¥ng cá»§a báº¡n, khÃ´ng nháº¥t thiáº¿t pháº£i lÃ  má»™t module lá»›n vÃ  khÃ´ng thá»±c hiá»‡n cÃ¡c business logic. Nhá»¯ng vÃ­ dá»¥ vá» components dáº¡ng nÃ y nhÆ° Button, Checkbox, SelectBox, Modal, DatePicker, BreadCrumb,â€¦ Äáº·t tÃªn cho componentsá» pháº§n trÃªn chÃºng ta Ä‘Ã£ tháº¥y Ä‘Æ°á»£c cÃ¡ch há»‡ thá»‘ng files vÃ  folder trong á»©ng dá»¥ng, cÃ²n bÃ¢y giá» sáº½ tÃ¬m hiá»ƒu xem Ä‘áº·t tÃªn components ra sao cho phÃ¹ há»£p. NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn, tÃªn cá»§a components nÃªn rÃµ rÃ ng vÃ  khÃ´ng bá»‹ trÃ¹ng láº·p Ä‘á»ƒ cÃ³ thá»ƒ dá»… tÃ¬m láº¡i vÃ  trÃ¡nh nháº§m láº«n cho nhá»¯ng thÃ nh viÃªn khÃ¡c trong team. NgoÃ i ra, tÃªn components rÃµ rÃ ng cÅ©ng giÃºp cho viá»‡c debug báº±ng nhá»¯ng extension tools trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n trÃªn trÃ¬nh duyá»‡t (cháº³ng háº¡n nhÆ° React Dev Tools) - vÃ¬ khi app cá»§a báº¡n gáº·p lá»—i khi Ä‘ang cháº¡y thÃ¬ lá»—i sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ãºng components xáº£y ra lá»—i. Äá»ƒ Ä‘áº·t tÃªn components, chÃºng ta sáº½ Ä‘áº·t theo hÆ°á»›ng path-based-component-naming, nghÄ©a lÃ  cáº¥u thÃ nh bá»Ÿi Ä‘Æ°á»ng dáº«n tá»« folder src/components Ä‘áº¿n file chÃºng ta táº¡o component Ä‘Ã³. Cháº³ng háº¡n, báº¡n cÃ³ má»™t file vá»›i Ä‘Æ°á»ng dáº«n src/components/User/List.jsx thÃ¬ tÃªn component Ä‘Æ°á»£c sá»­ dá»¥ng trong List.jsx sáº½ Ä‘Æ°á»£c Ä‘áº·t lÃ  UserList: 1class UserList extends React.Component Náº¿u má»™t file trong folder trÃ¹ng tÃªn vá»›i tÃªn folder, chÃºng ta sáº½ khÃ´ng cáº§n pháº£i láº·p láº¡i cáº£ tÃªn folder láº«n tÃªn file. Cháº³ng háº¡n, cÃ³ má»™t file src/components/User/Form/Form.jsx thÃ¬ thay vÃ¬ sá»­ dá»¥ng UserFormForm, chÃºng ta sáº½ Ä‘áº·t lÃ  UserForm. Viá»‡c Ä‘áº·t tÃªn components theo Ä‘Æ°á»ng dáº«n nhÆ° trÃªn cÃ³ nhá»¯ng Ã­ch lá»£i nhÆ° sau: Viá»‡c search file trong text editor/IDE trá»Ÿ nÃªn thuáº­n tiá»‡n hÆ¡n - Chá»‰ cáº§n gÃµ vÃ o Ã´ search cá»§a IDE hay text editor mÃ  báº¡n sá»­ dá»¥ng lÃ  cÃ³ thá»ƒ tÃ¬m Ä‘áº¿n file má»™t cÃ¡ch nhanh chÃ³ng. Hoáº·c navigate Ä‘áº¿n file cÅ©ng ráº¥t thuáº­n tiá»‡n: TrÃ¡nh láº·p Ä‘i láº·p láº¡i tÃªn khi import Theo cÃ¡ch Ä‘áº·t tÃªn nhÆ° váº­y, báº¡n sáº½ luÃ´n Ä‘áº·t tÃªn file giá»‘ng vá»›i chá»©c nÄƒng, nhiá»‡m vá»¥ cá»§a nÃ³. Äá»‘i vá»›i component form á»Ÿ trÃªn, chÃ­nh xÃ¡c thÃ¬ pháº£i lÃ  user form, nhÆ°ng do file Ä‘Ã£ náº±m trong folder User nÃªn chÃºng ta khÃ´ng cáº§n láº·p láº¡i tá»« Ä‘Ã³ trong tÃªn file cá»§a component, mÃ  chá»‰ cáº§n sá»­ dung Form.jsx CÃ³ nhiá»u trÆ°á»ng há»£p, dev viáº¿t app React vÃ  Ä‘áº·t tÃªn file/folder cÅ©ng nhÆ° tÃªn component má»™t cÃ¡ch Ä‘áº§y Ä‘á»§, bao gá»“m cáº£ tÃªn module lá»›n vÃ  nhá», vÃ  dáº§n dáº§n sau nÃ y khi app scale lÃªn thÃ¬ viá»‡c Ä‘áº·t tÃªn nÃ y sáº½ trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n ráº¥t nhiá»u. Thá»­ so sÃ¡nh hai trÆ°á»ng há»£p sau Ä‘Ã¢y: 123import ScreensUserForm from './screens/User/UserForm';// vsimport ScreensUserForm from './screens/User/Form'; Äá»‘i vá»›i module nhá» vá»›i Ã­t thÃ nh pháº§n nhÆ° trÃªn thÃ¬ cÃ¡ch Ä‘áº·t tÃªn thá»© hai cÃ³ váº» nhÆ° khÃ´ng táº¡o nhiá»u khÃ¡c biá»‡t láº¯m, ta cÃ³ thá»ƒ tháº¥y cÃ¡ch viáº¿t thá»© nháº¥t váº«n á»•n. Tuy nhiÃªn, náº¿u nhÆ° app cá»§a báº¡n scale lÃªn vá»›i nhiá»u thÃ nh pháº§n, module, chá»©c nÄƒng phá»©c táº¡p thÃ¬ viá»‡c Ä‘áº·t tÃªn nhÆ° váº­y sáº½ trá»Ÿ nenen vÃ´ cÃ¹ng kinh khá»§ng: 123import MediaPlanViewChannel from '/MediaPlan/MediaPlanView/MediaPlanViewChannel.jsx';// vsimport MediaPlanViewChannel from './MediaPlan/View/Channel'; ChÆ°a ká»ƒ nhá»¯ng dÃ²ng nhÆ° tháº¿ nÃ y cÃ²n láº·p láº¡i nhiá»u láº§n vÃ¬ pháº£i import nhiá»u thÃ nh pháº§n cÃ¹ng lÃºcâ€¦. VÃ­ lÃ­ do Ä‘Ã³, chÃºng ta nÃªn Ä‘áº·t tÃªn file vÃ  folder Ä‘Ãºng vá»›i chá»©c nÄƒng/nhiá»‡m vá»¥ trá»±c tiáº¿p cá»§a nÃ³, thay vÃ¬ thÃªm vÃ o tÃªn cá»§a nhá»¯ng module cha. CÃ²n tÃªn component thÃ¬ nÃªn Ä‘áº·t theo Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i so vá»›i folder src/components. Screens components - DÃ¹ng cho má»™t view pageá» trÃªn, bÃ i viáº¿t cÃ³ nháº¯c Ä‘áº¿n nhá»¯ng compoents khÃ´ng Ä‘Æ°á»£c Ä‘áº·t trong folder components, Ä‘Æ°á»£c gá»i lÃ  screens. Giá»‘ng nhÆ° tÃªn gá»i cá»§a nÃ³, Ä‘Ã¢y lÃ  nhá»¯ng components tÆ°á»£ng trÆ°ng cho má»™t mÃ n hÃ¬nh hiá»ƒn thá»‹ trong á»©ng dá»¥ng cá»§a báº¡n Láº¥y vÃ­ dá»¥ Ä‘á»‘i vá»›i tÃ­nh nÄƒng CRUD users, chÃºng ta sáº½ cÃ³ nhá»¯ng mÃ n hÃ¬nh cÆ¡ báº£n nháº¥t bao gá»“m: List users (/users Create user (/user) Edit user (/users/:id) NhÆ° váº­y, chÃºng ta cÃ³ 3 screens khÃ¡c nhau. Má»—i screen lÃ  má»™t component cáº¥u thÃ nh lÃªn má»™t page trong á»©ng dá»¥ng react cá»§a báº¡n. Screen component nÃªn lÃ  má»™t presentational component vÃ  khÃ´ng nÃªn thá»±c hiá»‡n xá»­ lÃ½ business logic. CÃ¡c screens sáº½ náº±m trong má»™t folder screens song song vá»›i components trong Ä‘Æ°á»ng dáº«n src, vÃ¬ má»—i component á»Ÿ trong sáº½ Ä‘áº¡i diá»‡n cho route cá»§a á»©ng dá»¥ng, thay vÃ¬ má»™t module nÃ o Ä‘Ã³: 123456src â”œâ”€ components â””â”€ screens â””â”€ User â”œâ”€ Form.jsx â””â”€ List.jsx Náº¿u á»©ng dá»¥ng cá»§a báº¡n sá»­ dá»¥ng react-router, chÃºng ta sáº½ giá»¯ má»™t file Root.jsx trong folder screens vÃ  Ä‘Æ°a toÃ n bá»™ cÃ¡c view route vÃ o trong file nÃ y: 123456789101112131415161718import React, &#123; Component &#125; from 'react';import &#123; Router &#125; from 'react-router';import &#123; Redirect, Route, Switch &#125; from 'react-router-dom';import ScreensUserForm from './User/Form';import ScreensUserList from './User/List';const ScreensRoot = () =&gt; ( &lt;Router&gt; &lt;Switch&gt; &lt;Route path=\"/user/list\" component=&#123;ScreensUserList&#125; /&gt; &lt;Route path=\"/user/create\" component=&#123;ScreensUserForm&#125; /&gt; &lt;Route path=\"/user/:id\" component=&#123;ScreensUserForm&#125; /&gt; &lt;/Switch&gt; &lt;/Router&gt;);export default ScreensRoot; Vá»›i cÃ¡ch nÃ y chÃºng ta Ä‘Ã£ Ä‘Æ°a toÃ n bá»™ screens vÃ o trong má»™t folder cÃ³ cÃ¹ng tÃªn vá»›i Ä‘á»‹nh nghÄ©a route: user/ -&gt; User/. Folder User chá»©a mÃ n hÃ¬nh List vÃ  mÃ n hinh Form bÃªn trong. Tá»« Ä‘Ã³ báº¡n cÃ³ thá»ƒ dá»… dÃ ng tÃ¬m tháº¥y mÃ n hÃ¬nh nÃ o render route nÃ o báº±ng cÃ¡ch nhÃ¬n vÃ o url. Má»™t mÃ n hÃ¬nh cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ render nhiá»u route, nhÆ° chÃºng ta tháº¥y mÃ n hÃ¬nh Form sáº½ render 2 route dÃ nh cho viá»‡c Create vÃ  Edit. ChÃº Ã½ ráº±ng, chÃºng ta nÃªn thÃªm prefix Screen khi Ä‘áº·t tÃªn cho cÃ¡c screen, Ä‘á»ƒ trÃ¡nh nháº§m láº«n vá»›i cÃ¡c component trong folder components. NhÆ° váº­y tÃªn cá»§a screen component Ä‘áº·t trong folder src/screens/User/List.jsx nÃªn Ä‘Æ°á»£c Ä‘áº·t lÃ  ScreenUserList: 12345678910111213import React from 'react';import UserForm from '../../components/User/Form/Form';const ScreensUserForm = (&#123; match: &#123; params &#125; &#125;) =&gt; ( &lt;div&gt; &lt;h1&gt; &#123;`$&#123;!params.id ? 'Create' : 'Update'&#125;`&#125; User &lt;/h1&gt; &lt;UserForm id=&#123;params.id&#125; /&gt; &lt;/div&gt;);export default ScreensUserForm; NhÆ° trong Ä‘oáº¡n code trÃªn thÃ¬ screen component sáº½ khÃ´ng xá»­ lÃ½ gÃ¬ liÃªn quan Ä‘áº¿n state (data) mÃ  chá»‰ thá»±c hiá»‡n render ra component UserForm. Cuá»‘i cÃ¹ng thÃ¬ chÃºng ta sáº½ cÃ³ Ä‘Æ°á»£c má»™t cáº¥u trÃºc folder nhÆ° sau: 1234567891011121314srcâ”œâ”€ components â”‚ â”œâ”€ Userâ”‚ â”‚ â”œâ”€ Formâ”‚ â”‚ â”‚ â”œâ”€ Form.jsxâ”‚ â”‚ â”‚ â””â”€ Form.cssâ”‚ â”‚ â””â”€ List.jsxâ”‚ â””â”€ UI â”‚â””â”€ screens â”œâ”€ User â”‚ â”œâ”€ Form.jsx â”‚ â””â”€ List.jsx â””â”€ Root.jsx Tá»•ng káº¿tTÃ³m táº¯t láº¡i, chÃºng ta cáº§n nhá»› nhá»¯ng Ä‘iá»ƒm sau Ä‘Ã¢y: Presentational vÃ  Container components Ä‘Æ°á»£c Ä‘áº·t trong folder src/components NhÃ³m cÃ¡c components láº¡i dá»±a trÃªn module/feature ÄÆ°a nhá»¯ng component chung Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u láº§n (UI components) vÃ o trong src/components/UI Viáº¿t component screens (mÃ n hÃ¬nh) tháº­t Ä‘Æ¡n giáº£n, Ã­t code NhÃ³m cÃ¡c mÃ n hÃ¬nh láº¡i theo route cá»§a á»©ng dá»¥ng. Vá»›i route /user/list thÃ¬ screen sáº½ náº±m trong src/screens/User/List.jsx. Components Ä‘Æ°á»£c dáº·t tÃªn theo Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i cá»§a so vá»›i src/components hoáº·c src - TÃªn component trong file src/components/User/List.jx sáº½ cÃ³ tÃªn lÃ  UserList, tÃªn component trong file src/screens/User/List.jsx sáº½ cÃ³ tÃªn lÃ  ScreensUserList. Component trong file cÃ³ cÃ¹ng tÃªn vá»›i folder chá»©a nÃ³ sáº½ khÃ´ng láº·p láº¡i tÃªn cá»§a folder. VÃ­ dá»¥ file src/components/User/List/List.jsx sáº½ cÃ³ component Ä‘Æ°á»£c Ä‘áº·t tÃªn lÃ  UserList, chá»© KHÃ”NG PHáº¢I lÃ  UserListList Káº¿t luáº­nBÃ i viáº¿t Ä‘Ã£ Ä‘Æ°a ra má»™t trong nhá»¯ng cÃ¡ch Ä‘á»ƒ tá»• chá»©c, phÃ¢n chia cÅ©ng nhÆ° Ä‘áº·t tÃªn cho file, folder vÃ  component khi thiáº¿t káº¿ á»©ng dá»¥ng báº±ng React. ÄÆ°Æ¡ng nhiÃªn, Ä‘Ã¢y chá»‰ lÃ  Ã½ kiáº¿n chá»§ quan, báº¡n hoÃ n toÃ n cÃ³ thá»ƒ tá»± mÃ¬nh thiáº¿t láº­p vÃ  Ä‘Æ°a ra nhá»¯ng pattern mÃ  báº¡n cáº£m tháº¥y há»£p lÃ½, thuáº­n tiá»‡n khi lÃ m viá»‡c vá»›i React, miá»…n sao cho tráº£i nghiá»‡m cá»§a báº£n thÃ¢n lÃ  tá»‘t nháº¥t. Xin cáº£m Æ¡n!","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"Gooact: React trong 160 dÃ²ng code JavaScript","slug":"Gooact-React-trong-160-dong-code-JavaScript","date":"2018-05-26T08:13:00.000Z","updated":"2018-05-26T13:12:23.679Z","comments":true,"path":"2018/05/Gooact-React-trong-160-dong-code-JavaScript.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Gooact-React-trong-160-dong-code-JavaScript.html","excerpt":"","text":"LÃ m tháº¿ nÃ o Ä‘á»ƒ xÃ¢y dá»±ng React cho riÃªng mÃ¬nh chá»‰ trong vÃ i phÃºt.Giá»›i thiá»‡uReact lÃ  má»™t thÆ° viá»‡n tuyá»‡t vá»i - nhiá»u nhÃ  phÃ¡t triá»ƒn ngay láº­p tá»©c Ä‘Ã£ yÃªu thÃ­ch nÃ³ vÃ¬ tÃ­nh Ä‘Æ¡n giáº£n, hiá»‡u suáº¥t vÃ  cÃ¡ch khai bÃ¡o lÃ m viá»‡c. NhÆ°ng cÃ¡ nhÃ¢n tÃ´i cÃ³ má»™t lÃ½ do cá»¥ thá»ƒ khiáº¿n nÃ³ trá»Ÿ nÃªn Ä‘áº·c biá»‡t Ä‘á»‘i vá»›i tÃ´i - vÃ  Ä‘Ã³ lÃ  cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng bÃªn dÆ°á»›i. TÃ´i tÃ¬m tháº¥y nhá»¯ng Ã½ tÆ°á»Ÿng Ä‘á»©ng Ä‘áº±ng sau React Ä‘Æ¡n giáº£n nhÆ°ng ká»³ láº¡ thÃº vá»‹ - vÃ  tÃ´i tin ráº±ng sá»± hiá»ƒu biáº¿t nguyÃªn táº¯c cá»‘t lÃµi cá»§a nÃ³ sáº½ giÃºp báº¡n viáº¿t mÃ£ nhanh hÆ¡n vÃ  an toÃ n hÆ¡n. Trong bÃ i viáº¿t nÃ y, tÃ´i sáº½ chá»‰ cho cho báº¡n cÃ¡ch viáº¿t má»™t báº£n sao cá»§a React Ä‘áº§y Ä‘á»§ chá»©c nÄƒng, bao gá»“m Component API vÃ  tá»± triá»ƒn khai Virtual DOM. NÃ³ Ä‘Æ°á»£c chia thÃ nh bá»‘n pháº§n - má»—i pháº§n lÃ  má»™t chá»§ Ä‘á» chÃ­nh: Elements: Trong pháº§n nÃ y chÃºng ta sáº½ tÃ¬m hiá»ƒu cÃ¡ch cÃ¡c khá»‘i JSX Ä‘Æ°á»£c xá»­ lÃ½ thÃ nh phiÃªn báº£n nháº¹ cá»§a DOM Ä‘Æ°á»£c gá»i lÃ  VDOM nhÆ° tháº¿ nÃ o. Rendering: Trong pháº§n nÃ y tÃ´i sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch chuyá»ƒn Ä‘á»•i VDOM thÃ nh DOM thÃ´ng thÆ°á»ng. Patching: Trong pháº§n nÃ y tÃ´i sáº½ trÃ¬nh bÃ y lÃ½ do táº¡i sao thuá»™c tÃ­nh â€œkeyâ€ quan trá»ng nhÆ° tháº¿ vÃ  cÃ¡ch sá»­ dá»¥ng VDOM Ä‘á»ƒ ná»‘i láº¡i vá»›i DOM hiá»‡n táº¡i má»™t cÃ¡ch hiá»‡u quáº£. Components: Pháº§n cuá»‘i cÃ¹ng sáº½ cho báº¡n biáº¿t vá» cÃ¡c thÃ nh pháº§n React vÃ  quy trÃ¬nh táº¡o, vÃ²ng Ä‘á»i vÃ  dá»±ng hÃ¬nh cá»§a chÃºng. Má»—i pháº§n sáº½ káº¿t thÃºc báº±ng má»™t vÃ­ dá»¥ cÃ³ link CodePen trá»±c tiáº¿p, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ ngay láº­p tá»©c kiá»ƒm tra táº¥t cáº£ cÃ¡c tiáº¿n trÃ¬nh chÃºng ta Ä‘Ã£ thá»±c hiá»‡n. Báº¯t Ä‘áº§u nÃ o. Elements Element lÃ  má»™t Ä‘á»‘i tÆ°á»£ng trá»ng lÆ°á»£ng nháº¹ cá»§a má»™t DOM thá»±c táº¿. NÃ³ chá»©a táº¥t cáº£ thÃ´ng tin quan trá»ng - nhÆ° node type, attributes vÃ  danh sÃ¡ch children â€” vÃ¬ váº­y nÃ³ cÃ³ thá»ƒ dá»… dÃ ng rendered trong tÆ°Æ¡ng lai. ThÃ nh pháº§n giá»‘ng nhÆ° cÃ¢y cá»§a cÃ¡c elements Ä‘Æ°á»£c gá»i lÃ  VDOM - má»™t vÃ­ dá»¥ Ä‘Æ°á»£c hiá»ƒn thá»‹ bÃªn dÆ°á»›i: 1234567891011121314151617181920212223242526&#123; \"type\": \"ul\", \"props\": &#123; \"className\": \"some-list\" &#125;, \"children\": [ &#123; \"type\": \"li\", \"props\": &#123; \"className\": \"some-list__item\" &#125;, \"children\": [ \"One\" ] &#125;, &#123; \"type\": \"li\", \"props\": &#123; \"className\": \"some-list__item\" &#125;, \"children\": [ \"Two\" ] &#125; ]&#125; Thay vÃ¬ viáº¿t object quÃ¡i dá»‹ Ä‘Ã³ má»i lÃºc, háº§u háº¿t cÃ¡c nhÃ  phÃ¡t triá»ƒn React Ä‘á»u sá»­ dá»¥ng cÃº phÃ¡p JSX, trÃ´ng giá»‘ng nhÆ° má»™t sá»± káº¿t há»£p gá»n gÃ ng giá»¯a mÃ£ JavaScript vÃ  cÃ¡c tháº» HTML: 12345/** @jsx createElement */const list = &lt;ul className=\"some-list\"&gt; &lt;li className=\"some-list__item\"&gt;One&lt;/li&gt; &lt;li className=\"some-list__item\"&gt;Two&lt;/li&gt;&lt;/ul&gt;; In order to get executed it needs to be transpiled into regular function calls â€” notice that pragma comment which defines what function must be used:Äá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n, nÃ³ cáº§n pháº£i Ä‘Æ°á»£c chuyá»ƒn thÃ nh cÃ¡c gá»i hÃ m thÃ´ng thÆ°á»ng - chÃº Ã½ comment pragma lÃ  pháº£i luÃ´n sá»­ dá»¥ng: 1234const list = createElement('ul', &#123;className: 'some-list'&#125;, createElement('li', &#123;className: 'some-list__item'&#125;, 'One'), createElement('li', &#123;className: 'some-list__item'&#125;, 'Two'),); Cuá»‘i cÃ¹ng, function mong muá»‘n Ä‘Æ°á»£c gá»i - vÃ  nÃ³ Ä‘Æ°á»£c cho lÃ  tráº£ vá» cáº¥u trÃºc VDOM Ä‘Æ°á»£c mÃ´ táº£ á»Ÿ trÃªn. Viá»‡c triá»ƒn khai cá»§a chÃºng tÃ´i sáº½ ngáº¯n gá»n - nhÆ°ng máº·c dÃ¹ cÃ³ váº» nguyÃªn thá»§y, nÃ³ phá»¥c vá»¥ má»¥c Ä‘Ã­ch cáº§n má»™t cÃ¡ch hoÃ n háº£o: 1234const createElement = (type, props, ...children) =&gt; &#123; props = props != null ? props : &#123;&#125;; return &#123;type, props, children&#125;;&#125;; CodePen Ä‘áº§u tiÃªn cÃ³ sáºµn á»Ÿ Ä‘Ã¢yâ€” nÃ³ chá»©a phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c mÃ´ táº£ á»Ÿ trÃªn vá»›i má»™t vÃ i cÃ¢y VDOM do nÃ³ táº¡o ra. Rendering Rendering lÃ  má»™t quÃ¡ trÃ¬nh biáº¿n VDOM thÃ nh DOM hiá»ƒn thá»‹. NÃ³i chung, nÃ³ lÃ  má»™t thuáº­t toÃ¡n khÃ¡ Ä‘Æ¡n giáº£n mÃ  Ä‘i qua cÃ¢y VDOM vÃ  táº¡o ra pháº§n tá»­ DOM tÆ°Æ¡ng á»©ng cho má»—i node: 123456789101112131415161718192021222324252627282930313233343536const render = (vdom, parent=null) =&gt; &#123; if (parent) parent.textContent = ''; const mount = parent ? (el =&gt; parent.appendChild(el)) : (el =&gt; el); if (typeof vdom == 'string' || typeof vdom == 'number') &#123; return mount(document.createTextNode(vdom)); &#125; else if (typeof vdom == 'boolean' || vdom === null) &#123; return mount(document.createTextNode('')); &#125; else if (typeof vdom == 'object' &amp;&amp; typeof vdom.type == 'function') &#123; return mount(Component.render(vdom)); &#125; else if (typeof vdom == 'object' &amp;&amp; typeof vdom.type == 'string') &#123; const dom = document.createElement(vdom.type); for (const child of [].concat(...vdom.children)) // flatten dom.appendChild(render(child)); for (const prop in vdom.props) setAttribute(dom, prop, vdom.props[prop]); return mount(dom); &#125; else &#123; throw new Error(`Invalid VDOM: $&#123;vdom&#125;.`); &#125;&#125;;const setAttribute = (dom, key, value) =&gt; &#123; if (typeof value == 'function' &amp;&amp; key.startsWith('on')) &#123; const eventType = key.slice(2).toLowerCase(); dom.__gooactHandlers = dom.__gooactHandlers || &#123;&#125;; dom.removeEventListener(eventType, dom.__gooactHandlers[eventType]); dom.__gooactHandlers[eventType] = value; dom.addEventListener(eventType, dom.__gooactHandlers[eventType]); &#125; else if (key == 'checked' || key == 'value' || key == 'id') &#123; dom[key] = value; &#125; else if (key == 'key') &#123; dom.__gooactKey = value; &#125; else if (typeof value != 'object' &amp;&amp; typeof value != 'function') &#123; dom.setAttribute(key, value); &#125;&#125;; Code á»Ÿ trÃªn cÃ³ váº» trÃ´ng Ä‘Ã¡ng sá»£, nhÆ°ng hÃ£y lÃ m cho má»i thá»© trá»Ÿ nÃªn Ã­t phá»©c táº¡p hÆ¡n báº±ng cÃ¡ch tÃ¡ch nÃ³ thÃ nh cÃ¡c pháº§n nhá» hÆ¡n: Custom Attribute Setter: CÃ¡c thuá»™c tÃ­nh Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n VDOM khÃ´ng pháº£i lÃºc nÃ o cÅ©ng há»£p lá»‡ vá» DOM - nhá»¯ng thá»© nhÆ° trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n, key Ä‘á»‹nh danh vÃ  cÃ¡c giÃ¡ trá»‹ pháº£i Ä‘Æ°á»£c xá»­ lÃ½ riÃªng láº». Primitive VDOM rendering: Primitives â€” nhÆ° strings, numbers, booleans vÃ  nulls â€” Ä‘Æ°á»£c chuyá»ƒn thÃ nh cÃ¡c node vÄƒn báº£n thuáº§n tÃºy. Complex VDOM rendering: Nodes vá»›i tag string Ä‘Æ°á»£c biáº¿n thÃ nh cÃ¡c pháº§n tá»­ DOM vá»›i hiá»ƒn thá»‹ children theo Ä‘á»‡ quy. Component VDOM rendering: Nodes vá»›i tag function tag Ä‘Æ°á»£c xá»­ lÃ½ riÃªng â€” khÃ´ng chÃº Ã½ nhiá»u Ä‘áº¿n pháº§n Ä‘Ã³, chÃºng ta sáº½ thá»±c hiá»‡n nÃ³ sau. CodePen thá»© hai cÃ³ sáºµn á»Ÿ Ä‘Ã¢yâ€” nÃ³ thá»ƒ hiá»‡n thuáº­t toÃ¡n render trong hÃ nh Ä‘á»™ng. Patching Patching lÃ  má»™t quÃ¡ trÃ¬nh hÃ²a há»£p DOM hiá»‡n cÃ³ vá»›i cÃ¢y VDOM má»›i Ä‘Æ°á»£c xÃ¢y dá»±ng. HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n cÃ³ má»™t sá»‘ VDOM lá»“ng nhau sÃ¢u vÃ  cáº­p nháº­t thÆ°á»ng xuyÃªn. Khi má»™t cÃ¡i gÃ¬ Ä‘Ã³ thay Ä‘á»•i, ngay cáº£ pháº§n nhá» nháº¥t - mÃ  pháº£i Ä‘Æ°á»£c hiá»ƒn thá»‹. Triá»ƒn khai native sáº½ yÃªu cáº§u render toÃ n bá»™ má»—i láº§n cáº­p nháº­t nhÆ° váº­y. XÃ³a cÃ¡c nÃºt DOM hiá»‡n cÃ³. Re-render má»i thá»©. ÄÃ³ lÃ  lÃ½ do thá»±c táº¿ â€” xÃ¢y dá»±ng DOM vÃ  váº½ láº¡i nÃ³ lÃ  má»™t hoáº¡t Ä‘á»™ng khÃ¡ tá»‘n kÃ©m. NhÆ°ng chÃºng ta cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a Ä‘iá»u nÃ y báº±ng cÃ¡ch viáº¿t thuáº­t toÃ¡n vÃ  sáº½ yÃªu cáº§u Ã­t sá»­a Ä‘á»•i DOM: XÃ¢y dá»±ng má»™t VDOM má»›i. Äá»‡ quy so sÃ¡nh nÃ³ vá»›i DOM hiá»‡n cÃ³. TÃ¬m cÃ¡c nÃºt Ä‘Ã£ Ä‘Æ°á»£c thÃªm, xÃ³a hoáº·c thay Ä‘á»•i theo báº¥t ká»³ cÃ¡ch nÃ o. Patch(VÃ¡) chÃºng láº¡i. NhÆ°ng sau Ä‘Ã³ má»™t váº¥n Ä‘á» khÃ¡c ná»•i lÃªn â€” Ä‘á»™ phá»©c táº¡p tÃ­nh toÃ¡n. So sÃ¡nh hai cÃ¢y cÃ³ Ä‘á»™ phá»©c táº¡p O(nÂ³) â€” vÃ­ dá»¥: náº¿u báº¡n Ä‘á»‹nh patch má»™t ngÃ¬n elements â€” nÃ³ sáº½ yÃªu cáº§u má»™t tá»· so sÃ¡nh. Äiá»u Ä‘Ã³ lÃ  quÃ¡ nhÃ¬u. Thay vÃ o Ä‘Ã³, chÃºng ta sáº½ triá»ƒn khai má»™t thuáº­t toÃ¡n Ä‘á»™ phá»©c táº¡p O(n) vá»›i hai giáº£ Ä‘á»‹nh sau: Hai elements cá»§a cÃ¡c loáº¡i khÃ¡c nhau sáº½ táº¡o ra nhá»¯ng cÃ¢y khÃ¡c nhau. NhÃ  phÃ¡t triá»ƒn cÃ³ thá»ƒ gá»£i Ã½ cÃ¡c pháº§n tá»­ con nÃ o cÃ³ thá»ƒ khÃ´ng Ä‘á»•i qua cÃ¡c láº§n render khÃ¡c nhau vá»›i prop â€œkeyâ€. Trong thá»±c táº¿, cÃ¡c giáº£ Ä‘á»‹nh nÃ y cÃ³ giÃ¡ trá»‹ Ä‘á»‘i vá»›i háº§u háº¿t cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng thá»±c táº¿. BÃ¢y giá» chÃºng tÃ´i Ä‘Ã£ sáºµn sÃ ng cho má»™t pháº§n code khÃ¡c: 123456789101112131415161718192021222324252627282930313233343536const patch = (dom, vdom, parent=dom.parentNode) =&gt; &#123; const replace = parent ? el =&gt; (parent.replaceChild(el, dom) &amp;&amp; el) : (el =&gt; el); if (typeof vdom == 'object' &amp;&amp; typeof vdom.type == 'function') &#123; return Component.patch(dom, vdom, parent); &#125; else if (typeof vdom != 'object' &amp;&amp; dom instanceof Text) &#123; return dom.textContent != vdom ? replace(render(vdom)) : dom; &#125; else if (typeof vdom == 'object' &amp;&amp; dom instanceof Text) &#123; return replace(render(vdom)); &#125; else if (typeof vdom == 'object' &amp;&amp; dom.nodeName != vdom.type.toUpperCase()) &#123; return replace(render(vdom)); &#125; else if (typeof vdom == 'object' &amp;&amp; dom.nodeName == vdom.type.toUpperCase()) &#123; const pool = &#123;&#125;; const active = document.activeElement; for (const index in Array.from(dom.childNodes)) &#123; const child = dom.childNodes[index]; const key = child.__gooactKey || index; pool[key] = child; &#125; const vchildren = [].concat(...vdom.children); // flatten for (const index in vchildren) &#123; const child = vchildren[index]; const key = child.props &amp;&amp; child.props.key || index; dom.appendChild(pool[key] ? patch(pool[key], child) : render(child)); delete pool[key]; &#125; for (const key in pool) &#123; if (pool[key].__gooactInstance) pool[key].__gooactInstance.componentWillUnmount(); pool[key].remove(); &#125; for (const attr of dom.attributes) dom.removeAttribute(attr.name); for (const prop in vdom.props) setAttribute(dom, prop, vdom.props[prop]); active.focus(); return dom; &#125;&#125;; HÃ£y Ä‘iá»u tra táº¥t cáº£ cÃ¡c káº¿t há»£p cÃ³ thá»ƒ: Primitive VDOM + Text DOM: So sÃ¡nh giÃ¡ trá»‹ VDOM vá»›i ná»™i dung DOM vÃ  thá»±c hiá»‡n full render náº¿u chÃºng khÃ¡c nhau. Primitive VDOM + Element DOM : Full render. Complex VDOM + Text DOM : Full render. Complex VDOM + Element DOM of different type : Full render. Complex VDOM + Element DOM of same type : Sá»± káº¿t há»£p thÃº vá»‹ nháº¥t, nÆ¡i diá»…n ra sá»± hÃ²a há»£p cá»§a children, xem chi tiáº¿t bÃªn dÆ°á»›i. Component VDOM + any kind of DOM: CÅ©ng giá»‘ng nhÆ° trong pháº§n trÆ°á»›c, Ä‘Æ°á»£c xá»­ lÃ½ riÃªng vÃ  sáº½ Ä‘Æ°á»£c triá»ƒn khai sau. NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, cÃ¡c nÃºt text vÃ  phá»©c táº¡p nÃ³i chung khÃ´ng tÆ°Æ¡ng thÃ­ch vÃ  yÃªu cáº§u full render â€” may máº¯n thay Ä‘Ã³ lÃ  má»™t sá»± thay Ä‘á»•i hiáº¿m hoi. NhÆ°ng nhá»¯ng gÃ¬ vá» sá»± hÃ²a há»£p cá»§a children Ä‘á»‡ quy - nÃ³ thá»±c hiá»‡n nhÆ° sau: Current active element is memoized â€” reconciliation may break focus sometimes. DOM children are moved into temporary pool under their respective keys â€” index is used as a key by default. VDOM children are paired to the pool DOM nodes by key and recursively patched â€” or rendered from scratch if pair is not found. DOM nodes that left unpaired are removed from document. New attributes are applied to final parent DOM. Focus is returned back to previously active element. CodePen thá»© ba cÃ³ sáºµn á»Ÿ Ä‘Ã¢y â€” bao gá»“m vÃ­ dá»¥ nhá» vá» list patching. Components Component vá» máº·t khÃ¡i niá»‡m tÆ°Æ¡ng tá»± nhÆ° hÃ m JavaScript â€” nÃ³ cÃ³ Ä‘áº§u vÃ o tÃ¹y Ã½ Ä‘Æ°á»£c gá»i lÃ  â€œpropsâ€ vÃ  tráº£ vá» táº­p cÃ¡c elements mÃ´ táº£ nhá»¯ng gÃ¬ sáº½ xuáº¥t hiá»‡n trÃªn mÃ n hÃ¬nh. NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  má»™t stateless function hoáº·c derived class vá»›i tráº¡ng thÃ¡i bÃªn trong cá»§a riÃªng vÃ  táº­p cÃ¡c phÆ°Æ¡ng thá»©c vÃ  cÃ¡c lifecycle hooks. TÃ´i sáº½ ngáº¯n gá»n vá» lÃ½ thuyáº¿t - tá»‘t hÆ¡n hÃ£y xem code: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475class Component &#123; constructor(props) &#123; this.props = props || &#123;&#125;; this.state = null; &#125; static render(vdom, parent=null) &#123; const props = Object.assign(&#123;&#125;, vdom.props, &#123;children: vdom.children&#125;); if (Component.isPrototypeOf(vdom.type)) &#123; const instance = new (vdom.type)(props); instance.componentWillMount(); instance.base = render(instance.render(), parent); instance.base.__gooactInstance = instance; instance.base.__gooactKey = vdom.props.key; instance.componentDidMount(); return instance.base; &#125; else &#123; return render(vdom.type(props), parent); &#125; &#125; static patch(dom, vdom, parent=dom.parentNode) &#123; const props = Object.assign(&#123;&#125;, vdom.props, &#123;children: vdom.children&#125;); if (dom.__gooactInstance &amp;&amp; dom.__gooactInstance.constructor == vdom.type) &#123; dom.__gooactInstance.componentWillReceiveProps(props); dom.__gooactInstance.props = props; return patch(dom, dom.__gooactInstance.render()); &#125; else if (Component.isPrototypeOf(vdom.type)) &#123; const ndom = Component.render(vdom); return parent ? (parent.replaceChild(ndom, dom) &amp;&amp; ndom) : (ndom); &#125; else if (!Component.isPrototypeOf(vdom.type)) &#123; return patch(dom, vdom.type(props)); &#125; &#125; setState(nextState) &#123; if (this.base &amp;&amp; this.shouldComponentUpdate(this.props, nextState)) &#123; const prevState = this.state; this.componentWillUpdate(this.props, nextState); this.state = nextState; patch(this.base, this.render()); this.componentDidUpdate(this.props, prevState); &#125; else &#123; this.state = nextState; &#125; &#125; shouldComponentUpdate(nextProps, nextState) &#123; return nextProps != this.props || nextState != this.state; &#125; componentWillReceiveProps(nextProps) &#123; return undefined; &#125; componentWillUpdate(nextProps, nextState) &#123; return undefined; &#125; componentDidUpdate(prevProps, prevState) &#123; return undefined; &#125; componentWillMount() &#123; return undefined; &#125; componentDidMount() &#123; return undefined; &#125; componentWillUnmount() &#123; return undefined; &#125;&#125; CÃ¡c static methods Ä‘Æ°á»£c gá»i internally: Render: Performs initial rendering. Stateless components are called as a regular function â€” result is displayed immediately. Class components are instantiated and attached to the DOM â€” and only then are rendered. Patching: Performs further update. Sometimes DOM node already has a component instance attached to it â€” pass new properties to it and patch differences. Perform full render otherwise. CÃ¡c Instance methods cÃ³ nghÄ©a lÃ  cÃ³ thá»ƒ bá»‹ ghi Ä‘Ã¨ hoáº·c Ä‘Æ°á»£c gá»i trong cÃ¡c derived classes do ngÆ°á»i dÃ¹ng Ä‘á»‹nh nghÄ©a: Constructor: Handles properties and defines initial state, storing them within itself. State modifier: Handles new state, fires all required lifecycle hooks and initiates patch cycle. Lifecycle hooks: Set of methods that are fired throughout component life â€” on mount, during updates and just before it gets removed. LÆ°u Ã½ ráº±ng phÆ°Æ¡ng thá»©c render bá»‹ thiáº¿u â€” nÃ³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong cÃ¡c child classes. CodePen cuá»‘i cÃ¹ng cÃ³ á»Ÿ Ä‘Ã¢y â€” vá»›i táº¥t cáº£ cÃ¡c code chÃºng tÃ´i Ä‘Ã£ thá»±c hiá»‡n cho Ä‘áº¿n Ä‘Ã¢y cÃ¹ng vá»›i má»™t vÃ­ dá»¥ to-do Ä‘Æ¡n giáº£n. Káº¿t luáº­nÄÃ³ lÃ  táº¥t cáº£ cá»§a tÃ´i â€” chÃºng ta cÃ³ má»™t báº£n sao React Ä‘áº§y Ä‘á»§ chá»©c nÄƒng ngay bÃ¢y giá». TÃ´i sáº½ gá»i nÃ³ lÃ  Gooact â€” Ä‘Ã³ sáº½ lÃ  má»™t mÃ³n quÃ  nhá» cho ngÆ°á»i báº¡n tá»‘t cá»§a tÃ´i. ChÃºng ta hÃ£y xem xÃ©t ká»¹ hÆ¡n cÃ¡c káº¿t quáº£: Gooact cÃ³ thá»ƒ xÃ¢y dá»±ng vÃ  patch hiá»‡u quáº£ cÃ¡c cÃ¢y DOM phá»©c táº¡p báº±ng cÃ¡ch sá»­ dá»¥ng VDOM lÃ m tham chiáº¿u. Gooact há»— trá»£ cáº£ hai functional vÃ  class components â€” cÃ¹ng vá»›i viá»‡c xá»­ lÃ½ chÃ­nh xÃ¡c internal state vÃ  hooks lifecycle hoÃ n chá»‰nh. Gooact dÃ¹ng transpiled code cung cáº¥p bá»Ÿi Babel. Gooact vá»«a Ä‘á»§ trong 160 dÃ²ng code JavaScript chÆ°a nÃ©n. Má»¥c Ä‘Ã­ch chÃ­nh cá»§a bÃ i viáº¿t nÃ y lÃ  Ä‘á»ƒ chá»©ng minh cÃ¡c nguyÃªn táº¯c cá»‘t lÃµi cá»§a cáº¥u trÃºc bÃªn trong React mÃ  khÃ´ng cáº§n pháº£i Ä‘i sÃ¢u vÃ o cÃ¡c API phá»¥ trá»£ - Ä‘Ã³ lÃ  lÃ½ do táº¡i sao chÃºng bá»‹ thiáº¿u má»™t sá»‘ thá»© sau trong Gooact: Gooact khÃ´ng há»— trá»£ nhá»¯ng thá»© nhÆ° fragments, portals, contexts, references vÃ  má»™t sá»‘ thá»© khÃ¡c Ä‘Ã£ Ä‘Æ°á»£c giá»›i thiá»‡u trong cÃ¡c phiÃªn báº£n má»›i hÆ¡n. Gooact khÃ´ng triá»ƒn khai React Fiber do sá»± phá»©c táº¡p cá»§a nÃ³ â€” nhÆ°ng tÃ´i cÃ³ thá»ƒ viáº¿t má»™t bÃ i vá» nÃ³ trong tÆ°Æ¡ng lai. Gooact khÃ´ng theo dÃµi cÃ¡c key trÃ¹ng láº·p vÃ  Ä‘Ã´i khi cÃ³ thá»ƒ gÃ¢y ra lá»—i. Gooact thiáº¿u há»— trá»£ callbacks thÃªm cho má»™t sá»‘ methods. NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, Ä‘Ã³ lÃ  má»™t lÄ©nh vá»±c tuyá»‡t vá»i cho cÃ¡c tÃ­nh nÄƒng vÃ  cáº£i tiáº¿n má»›i - repository cÃ³ sáºµn á»Ÿ Ä‘Ã¢y, do Ä‘Ã³, vÃ¬ váº­y Ä‘á»«ng ngáº§n ngáº¡i fork vÃ  thá»­ nghiá»‡m. Báº¡n tháº­m chÃ­ cÃ³ thá»ƒ cÃ i Ä‘áº·t nÃ³ báº±ng cÃ¡ch sá»­ dá»¥ng NPM! TÃ´i muá»‘n cáº£m Æ¡n toÃ n bá»™ React Team Ä‘Ã£ táº¡o má»™t thÆ° viá»‡n tuyá»‡t vá»i, lÃ m cho cuá»™c sá»‘ng cá»§a hÃ ng nghÃ¬n nhÃ  phÃ¡t triá»ƒn trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n. Äáº·c biá»‡t cáº£m Æ¡n Ä‘áº¿n Preact tÃ¡c giáº£ chÃ­nh lÃ  Jason Miller â€” bÃ i viáº¿t nÃ y Ä‘Ã£ Ä‘Æ°á»£c láº¥y cáº£m há»©ng tá»« cÃ¡ch tá»‘i giáº£n nÃ³ Ä‘Æ°á»£c thá»±c hiá»‡n.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"CÆ¡ cháº¿ sá»­ dá»¥ng Virtual DOM trong React","slug":"Co-che-su-dung-Virtual-DOM-trong-React","date":"2018-05-25T15:22:00.000Z","updated":"2018-05-25T15:35:20.184Z","comments":true,"path":"2018/05/Co-che-su-dung-Virtual-DOM-trong-React.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Co-che-su-dung-Virtual-DOM-trong-React.html","excerpt":"Khi tÃ¬m hiá»ƒu vá» ReactJS, cháº¯c háº³n báº¡n Ä‘Ã£ nghe tá»›i khÃ¡i niá»‡m DOM áº£o (Virtual DOM). NÃ³ giÃºp cho hiá»‡u suáº¥t lÃ m viá»‡c cá»§a React cao hÆ¡n háº³n so vá»›i cÃ¡c thÆ° viá»‡n vÃ  framework Javascript khÃ¡c. NhÆ°ng báº¡n Ä‘Ã£ bao giá» tÃ¬m hiá»ƒu DOM áº£o lÃ  gÃ¬ vÃ  nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o trong React? HÃ´m nay, chÃºng ta cÃ¹ng tÃ¬m hiá»ƒu vá» chá»§ Ä‘á» nÃ y nhÃ©.","text":"Khi tÃ¬m hiá»ƒu vá» ReactJS, cháº¯c háº³n báº¡n Ä‘Ã£ nghe tá»›i khÃ¡i niá»‡m DOM áº£o (Virtual DOM). NÃ³ giÃºp cho hiá»‡u suáº¥t lÃ m viá»‡c cá»§a React cao hÆ¡n háº³n so vá»›i cÃ¡c thÆ° viá»‡n vÃ  framework Javascript khÃ¡c. NhÆ°ng báº¡n Ä‘Ã£ bao giá» tÃ¬m hiá»ƒu DOM áº£o lÃ  gÃ¬ vÃ  nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o trong React? HÃ´m nay, chÃºng ta cÃ¹ng tÃ¬m hiá»ƒu vá» chá»§ Ä‘á» nÃ y nhÃ©. Virtual DOM lÃ  gÃ¬?Äiá»u Ä‘áº§u tiÃªn tÃ´i muá»‘n nÃ³i á»Ÿ Ä‘Ã¢y lÃ : Virtual DOM khÃ´ng Ä‘Æ°á»£c phÃ¡t minh ra bá»Ÿi React, mÃ  React sá»­ dá»¥ng nÃ³. DOM áº£o lÃ  má»™t báº£n sao chÃ©p trá»«u tÆ°á»£ng cá»§a DOM tháº­t (HTML DOM). Báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng nÃ³ giá»‘ng nhÆ° má»™t báº£n thiáº¿t káº¿, chá»©a cÃ¡c chi tiáº¿t cáº§n thiáº¿t Ä‘á»ƒ cáº¥u hÃ¬nh lÃªn má»™t DOM. VÃ­ dá»¥, thay vÃ¬ táº¡o má»™t tháº» &lt;div&gt; tháº­t chá»©a cÃ¡c tháº» &lt;ul&gt; bÃªn trong, nÃ³ sáº½ táº¡o má»™t div object chá»©a ul object bÃªn trong. Cá»¥ thá»ƒ á»Ÿ trong React sáº½ lÃ  cÃ¡c React.div vÃ  React.ul. Khi tÆ°Æ¡ng tÃ¡c, ta cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c object Ä‘Ã³ ráº¥t nhanh mÃ  khÃ´ng pháº£i Ä‘á»™ng tá»›i DOM tháº­t hoáº·c thÃ´ng qua DOM API. Tiáº¿p theo chÃºng ta sáº½ tÃ¬m hiá»ƒu cá»¥ thá»ƒ React tÆ°Æ¡ng tÃ¡c vá»›i DOM áº£o nhÆ° tháº¿ nÃ o nhÃ© Virtual DOM trong ReactTrÆ°á»›c tiÃªn, Ä‘Ã£ bao giá» báº¡n tá»± há»i táº¡i sao láº¡i pháº£i tÆ°Æ¡ng tÃ¡c thÃ´ng qua DOM áº£o, sao khÃ´ng render trá»±c tiáº¿p á»Ÿ DOM tháº­t? Váº­y báº¡n Ä‘Ã£ thá»±c sá»± hiá»ƒu rÃµ DOM Ä‘Æ°á»£c táº¡o vÃ  re-render nhÆ° tháº¿ nÃ o má»—i khi cÃ¡c thÃ nh pháº§n trong DOM thay Ä‘á»•i? Má»—i khi cÃ³ sá»± thay Ä‘á»•i, vÃ¬ cáº¥u trÃºc cá»§a DOM lÃ  tree structure , khi muá»‘n thay Ä‘á»•i cÃ¡c element vÃ  cÃ¡c tháº» con cá»§a nÃ³, nÃ³ pháº£i thÃ´ng qua cÃ¡c Reflow/Layout, sau Ä‘Ã³ cÃ¡c thay Ä‘á»•i Ä‘Ã³ sáº½ Ä‘Æ°á»£c Re-painted, ráº¥t máº¥t thá»i gian. VÃ¬ tháº¿, cÃ ng nhiá»u cÃ¡c item pháº£i reflow/repaint, web cá»§a báº¡n sáº½ cÃ ng load cháº­m. Váº­y React Ä‘Ã£ sá»­ dá»¥ng DOM áº£o nhÆ° tháº¿ nÃ o? Äá»ƒ má»™t trang lá»›n nhÆ° Facebook mÃ  chÃºng ta dÃ¹ng hÃ ng ngÃ y cÃ³ hiá»‡u suáº¥t lÃ m viá»‡c cao nhÆ° váº­y? Äá»ƒ dá»… hÃ¬nh dung, chÃºng ta sáº½ tÃ¬m hiá»ƒu thÃ´ng qua má»™t vÃ­ dá»¥ nho nhá» dÆ°á»›i Ä‘Ã¢y nhÃ©. ÄÃ³ lÃ  giao diá»‡n cá»§a má»™t app cá»™ng hoáº·c trá»« 2 sá»‘. NgÆ°á»i dÃ¹ng sáº½ nháº­p vÃ o 2 sá»‘ vÃ o 2 Ã´ input, sau Ä‘Ã³ chá»n phÃ©p toÃ¡n vÃ  in ra káº¿t quáº£ á»Ÿ pháº§n Output. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import React, &#123; Component &#125; from 'react';export default class Calculator extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; output: '' &#125;; &#125; render() &#123; let IntegerA, IntegerB, IntegerC; return ( &lt;div className=\"container\"&gt; &lt;h2&gt;using React&lt;/h2&gt; &lt;div&gt; Input 1: &lt;input type=\"text\" placeholder=\"Input 1\" ref=\"input1\" /&gt; &lt;/div&gt; &lt;div&gt; Input 2 : &lt;input type=\"text\" placeholder=\"Input 2\" ref=\"input2\" /&gt; &lt;/div&gt; &lt;div&gt; &lt;button id=\"add\" onClick=&#123;() =&gt; &#123; IntegerA = parseInt(this.refs.input1.value); IntegerB = parseInt(this.refs.input2.value); IntegerC = IntegerA + IntegerB; this.setState(&#123; output: IntegerC &#125;); &#125;&#125; &gt; Add &lt;/button&gt; &lt;button id=\"subtract\" onClick=&#123;() =&gt; &#123; IntegerA = parseInt(this.refs.input1.value); IntegerB = parseInt(this.refs.input2.value); IntegerC = IntegerA - IntegerB; this.setState(&#123; output: IntegerC &#125;); &#125;&#125; &gt; Subtract &lt;/button&gt; &lt;/div&gt; &lt;div&gt; &lt;hr /&gt; &lt;h2&gt;Output: &#123;this.state.output&#125;&lt;/h2&gt; &lt;/div&gt; &lt;/div&gt; ); &#125;&#125; import React, &#123; Component &#125; from 'react';import Calculator from './Calculator';export default class Layout extends Component &#123; render() &#123; return ( &lt;div&gt; &lt;h1&gt;Basic Calculator&lt;/h1&gt; &lt;Calculator /&gt; &lt;/div&gt; ); &#125;&#125; VÃ  Ä‘Ã¢y lÃ  DOM tháº­t sau láº§n load Ä‘áº§u tiÃªn CÃ²n Ä‘Ã¢y lÃ  DOM áº£o mÃ  React táº¡o ra tÆ°Æ¡ng á»©ng vá»›i DOM tháº­t bÃªn trÃªn. Trong React, nÃ³ cÅ©ng Ä‘Æ°á»£c gá»i lÃ  má»™t Component vá»›i tree structure gá»“m cÃ¡c Component con bÃªn trong Sau Ä‘Ã¢y, chÃºng ta sáº½ cÃ¹ng thá»­ nháº­p vÃ o 2 sá»‘ vÃ  click vÃ o button Add vÃ  xem React xá»­ lÃ­ nhÆ° tháº¿ nÃ o nhÃ©. 1234Input 1: 100Input 2: 50Output mong Ä‘á»£i sáº½ lÃ  150. Äiá»u gÃ¬ xáº£y ra khi ta click vÃ o button Add? á» vÃ­ dá»¥ nÃ y, chÃºng ta set output lÃ  má»™t state, vÃ¬ tháº¿ khi má»™t output má»›i Ä‘Æ°á»£c hiá»‡n ra nghÄ©a lÃ  ta Ä‘Ã£ set cho State Ä‘Ã³ má»™t giÃ¡ trá»‹ má»›i Ä‘Ã³ lÃ  150. ÄÃ¡nh dáº¥u Component dirty Trong React, khi má»™t Component cÃ³ má»™t state má»›i Ä‘Æ°á»£c set, React Ä‘Ã¡nh dáº¥u nÃ³ nhÆ° lÃ  má»™t dirty Component, nghÄ©a lÃ  má»—i khi chÃºng ta gá»i tá»›i function setState() thÃ¬ Component Ä‘Ã³ sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  dirty. Cá»¥ thá»ƒ á»Ÿ Ä‘Ã¢y, khi ta click Add, React sáº½ Ä‘Ã¡nh dáº¥u Component Calculator nhÆ° tháº¿ nÃ o: Táº¥t cáº£ cÃ¡c event khi ta thao tÃ¡c vá»›i DOM, nÃ³ Ä‘Æ°á»£c gÃ³i trá»n trong React event listener. VÃ¬ tháº¿ khi nÃºt Add Ä‘Æ°á»£c click, event Ä‘Ã³ Ä‘Æ°á»£c gá»­i tá»›i React event listener vÃ  sau Ä‘Ã³ nÃ³ sáº½ cháº¡y má»™t anonymous function() Trong anonymous function(), chÃºng ta gá»i tá»›i function this.setState vá»›i má»™t state value má»›i. Function this.setState() Ä‘Æ°á»£c cháº¡y, Component Calculator Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  dirty. 12//ReactUpdates.js - enqueueUpdate(component) functiondirtyComponents.push(component); VÃ  hiá»‡n táº¡i, Calculator cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  dirty. CÃ¹ng xem nhá»¯ng gÃ¬ sáº½ diá»…n ra tiáº¿p theo Cháº¡y qua Component lifecycleComponent lifecycle trong React lÃ  má»™t loáº¡t cÃ¡c hÃ m máº·c Ä‘á»‹nh sáº½ Ä‘Æ°á»£c cháº¡y ngay trÆ°á»›c, trong vÃ  ngay sau quÃ¡ trÃ¬nh update má»™t Component. á» vÃ­ dá»¥ nÃ y, chÃºng ta khÃ´ng overwrite cÃ¡c hÃ m Ä‘Ã³ thÃ¬ nÃ³ sáº½ cháº¡y á»Ÿ cÃ¡c giÃ¡ trá»‹ máº·c Ä‘á»‹nh. QuÃ¡ trÃ¬nh update Component Ä‘Æ°á»£c diá»…n ra nhÆ° sau: React sáº½ kiá»ƒm tra Component Ä‘Ã³ cÃ³ Ä‘Æ°á»£c mark dirty hay khÃ´ng, sau Ä‘Ã³ báº¯t Ä‘áº§u quÃ¡ trÃ¬nh update. 123456//ReactUpdates.jsvar flushBatchedUpdates = function () &#123; while (dirtyComponents.length || asapEnqueued) &#123; if (dirtyComponents.length) &#123; var transaction = ReactUpdatesFlushTransaction.getPooled(); transaction.perform(runBatchedUpdates, null, transaction); Sau Ä‘Ã³, React sáº½ kiá»ƒm tra xem cÃ³ pending state nÃ o pháº£i Ä‘Æ°á»£c update hay khÃ´ng hoáº·c cÃ³ forceUpdate nÃ o khÃ´ng 123if (this._pendingStateQueue !== null || this._pendingForceUpdate) &#123; this.updateComponent(transaction, this._currentElement, this._currentElement, this._context, this._context); Trong vÃ­ dá»¥ nÃ y cá»§a chÃºng ta, trong Calculator wrapper, this.pendingStateQueue, chá»©a State object vá»›i giÃ¡ trá»‹ Output má»›i 3. React cháº¡y cÃ¡c lifecycle methods. Äáº§u tiÃªn lÃ  componentWillReceiveProps(), tiáº¿p Ä‘Ã³ lÃ  shouldComponentUpdate() (cÃ¡c phÆ°Æ¡ng thá»©c nÃ y cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh tháº¿ nÃ o náº¿u chÃºng ta khÃ´ng overwrite nÃ³ thÃ¬ cÃ¡c báº¡n tá»± tÃ¬m hiá»ƒu nhÃ©). Trong trÆ°á»ng há»£p nÃ y, method shouldComponentUpdate() sáº½ tráº£ vá» true, sau Ä‘Ã³ sáº½ cháº¡y componentWillUpdate(), render() vÃ  componentDidUpdate(). Thá»© quan trá»ng nháº¥t trong quÃ¡ trÃ¬nh update á»Ÿ Ä‘áº¥y chÃ­nh lÃ  render(), Ä‘Ã³ chÃ­nh lÃ  chá»— mÃ  DOM áº£o Ä‘Æ°á»£c táº¡o láº¡i vÃ  update DOM áº£o Ä‘á»ƒ tÃ¬m ra sá»± khÃ¡c biá»‡t Ä‘á»ƒ sau Ä‘Ã³ cáº­p nháº­t á»Ÿ DOM tháº­t, hay nÃ³i cÃ¡c khÃ¡c lÃ  tÃ¬m ra cá»¥ thá»ƒ nhá»¯ng element thay Ä‘á»•i Ä‘á»ƒ update chá»‰ nhá»¯ng element Ä‘Ã³ trong DOM tháº­t. XÃ¢y dá»±ng láº¡i Component, Update DOM áº£o, tÃ¬m sá»± thay Ä‘á»•i, update DOM tháº­t React sáº½ kiá»ƒm tra cÃ¡c element trÆ°á»›c vÃ  sau khi Ä‘Æ°á»£c render láº¡i á»Ÿ láº§n vá»«a rá»“i cÃ³ giá»‘ng nhau hay khÃ´ng, sau Ä‘Ã³ báº¯t Ä‘áº§u quÃ¡ trÃ¬nh Ä‘á»“ng bá»™. 12var prevRenderedElement = this._renderedComponent._currentElement; var nextRenderedElement = this._instance.render(); //Calculator.render() method is called and the element is build. QuÃ¡ trÃ¬nh Ä‘á»“ng bá»™ vÃ  update DOM tháº­t nhÆ° sau: Nhá»¯ng Ä‘iá»ƒm mÃ u Ä‘á» nghÄ©a lÃ  quÃ¡ trÃ¬nh Ä‘á»“ng bá»™ sáº½ Ä‘Æ°á»£c láº·p láº¡i Ä‘á»‘i vá»›i nhá»¯ng thÃ nh pháº§n con cá»§a nÃ³. VÃ  Ä‘Ã¢y lÃ  DOM mÃ  chÃºng ta nháº­n Ä‘Æ°á»£c sau quÃ¡ trÃ¬nh Ä‘Ã³ : Trong vÃ­ dá»¥ nÃ y, chá»‰ cÃ³ pháº§n Output bá»‹ thay Ä‘á»•i, báº¡n cÃ³ thá»ƒ nhÃ¬n tháº¥y pháº§n Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u flash á»Ÿ hÃ¬nh dÆ°á»›i, chá»‰ cÃ³ pháº§n Ä‘Ã³ Ä‘Æ°á»£c DOM tháº­t re-painted VÃ  cÃ¢y component Ä‘Æ°á»£c cáº­p nháº­t táº¡i DOM thá»±c táº¿. Káº¿t luáº­nQua vÃ­ dá»¥ trÃªn mong lÃ  báº¡n cÃ³ thá»ƒ hÃ¬nh dung pháº§n nÃ o Ä‘Ã³ cÃ¡ch thá»±c hoáº¡t Ä‘á»™ng cá»§a DOM áº£o trong React vÃ  tÃ­nh há»¯u dá»¥ng cá»§a nÃ³. Nhá» cÃ³ DOM áº£o, React cÃ³ thá»ƒ tÃ¬m ra cÃ¡c node bá»‹ thay Ä‘á»•i vÃ  update á»Ÿ DOM tháº­t chá»‰ á»Ÿ nhá»¯ng cÃ¡i node Ä‘Ã³, tháº­t thuáº­n tiá»‡n vÃ  nhanh gá»n pháº£i khÃ´ng nÃ o.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"TÃ¬m Hiá»ƒu Regular Expression Javascript","slug":"Tim-Hieu-Regular-Expression-Javascript","date":"2018-05-25T14:38:00.000Z","updated":"2018-05-25T14:47:51.414Z","comments":true,"path":"2018/05/Tim-Hieu-Regular-Expression-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Tim-Hieu-Regular-Expression-Javascript.html","excerpt":"Regular expression hay cÃ²n Ä‘Æ°á»£c gá»i táº¯t lÃ  Regex hay RegExp, lÃ  má»™t cÃ¡ch Ä‘á»ƒ biá»ƒu diá»…n khuÃ´n máº«u cá»§a string. ÄÃ¢y lÃ  má»™t pháº§n cá»§a ngÃ´n ngá»¯ láº­p trÃ¬nh JavaScript, cÅ©ng nhÆ° nhiá»u ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡c. Náº¿u báº¡n lÃ  má»™t láº­p trÃ¬nh viÃªn vÃ  Ä‘Ã£ tá»«ng sá»­ dá»¥ng Regular Expression thÃ¬ báº¡n cháº¯c háº³n sáº½ tháº¥y ráº±ng nÃ³ cÃ³ cÃº phÃ¡p ráº¥t kinh khá»§ng vÃ  cÃ³ pháº§n â€œbÃ­ áº©nâ€. Tuy nhiÃªn, cÃ´ng cá»¥ nÃ y láº¡i cá»±c kÃ¬ máº¡nh máº½ vÃ  hiá»‡u quáº£ khi dÃ¹ng Ä‘á»ƒ xá»­ lÃ½ string. Sau Ä‘Ã¢y, chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu vá» Regular Expression trong JavaScript.","text":"Regular expression hay cÃ²n Ä‘Æ°á»£c gá»i táº¯t lÃ  Regex hay RegExp, lÃ  má»™t cÃ¡ch Ä‘á»ƒ biá»ƒu diá»…n khuÃ´n máº«u cá»§a string. ÄÃ¢y lÃ  má»™t pháº§n cá»§a ngÃ´n ngá»¯ láº­p trÃ¬nh JavaScript, cÅ©ng nhÆ° nhiá»u ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡c. Náº¿u báº¡n lÃ  má»™t láº­p trÃ¬nh viÃªn vÃ  Ä‘Ã£ tá»«ng sá»­ dá»¥ng Regular Expression thÃ¬ báº¡n cháº¯c háº³n sáº½ tháº¥y ráº±ng nÃ³ cÃ³ cÃº phÃ¡p ráº¥t kinh khá»§ng vÃ  cÃ³ pháº§n â€œbÃ­ áº©nâ€. Tuy nhiÃªn, cÃ´ng cá»¥ nÃ y láº¡i cá»±c kÃ¬ máº¡nh máº½ vÃ  hiá»‡u quáº£ khi dÃ¹ng Ä‘á»ƒ xá»­ lÃ½ string. Sau Ä‘Ã¢y, chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu vá» Regular Expression trong JavaScript. Khá»Ÿi táº¡o Regular ExpressionCÃ³ hai cÃ¡ch Ä‘á»ƒ táº¡o ra má»™t Regular Expression lÃ : Sá»­ dá»¥ng hÃ m khá»Ÿi táº¡o cá»§a Ä‘á»‘i tÆ°á»£ng RegExp Viáº¿t trá»±c tiáº¿p sá»­ dá»¥ng cáº·p dáº¥u â€œ/ /â€œ 12var re1 = new RegExp(\"abc\");var re2 = /abc/; Cáº£ hai cÃ¡ch trÃªn ta Ä‘á»u thu Ä‘Æ°á»£c má»™t Regular Expression biá»ƒu diá»…n má»™t string cÃ³ dáº¡ng: abc. Má»™t sá»‘ phÆ°Æ¡ng thá»©c cá»§a Regular ExpressionPhÆ°Æ¡ng thá»©c TestÄÃ¢y lÃ  phÆ°Æ¡ng thá»©c Ä‘Æ¡n giáº£n nháº¥t dÃ¹ng Ä‘á»ƒ kiá»ƒm tra xem má»™t string cÃ³ chá»©a khuÃ´n máº«u Ä‘Ã£ Ä‘á»‹nh nghÄ©a hay khÃ´ng. Náº¿u cÃ³ thÃ¬ káº¿t quáº£ tráº£ vá» lÃ  TRUE vÃ  ngÆ°á»£c láº¡i thÃ¬ lÃ  FALSE. 123456console.log(/abc/.test(\"abcde\"));// =&gt; trueconsole.log(/abc/.test(\"12abcde\"));// =&gt; trueconsole.log(/abc/.test(\"abxcde\"));// =&gt; false Trong vÃ­ dá»¥ trÃªn, 2 string â€œabcdeâ€ vÃ  â€œ12abcdeâ€ Ä‘á»u chá»©a â€œabcâ€ nÃªn káº¿t quáº£ tráº£ vá» lÃ  true. String cÃ²n láº¡i â€œabxcdeâ€ khÃ´ng chá»©a â€œabcâ€ nÃªn káº¿t quáº£ lÃ  false. Kiá»ƒm tra trÃ¹ng khá»›p vá»›i táº­p há»£p cÃ¡c kÃ­ tá»±Náº¿u chá»‰ kiá»ƒm tra nhÆ° vÃ­ dá»¥ trÃªn thÃ¬ báº¡n hoÃ n toÃ n cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c indexOf cá»§a string thay vÃ¬ sá»­ dá»¥ng Regular Expression. Tuy nhiÃªn, vá»›i Regular Expression thÃ¬ báº¡n cÃ³ thá»ƒ kiá»ƒm tra nhá»¯ng máº«u string phá»©c táº¡p hÆ¡n. VÃ­ dá»¥: 12345678console.log(/[0123456789]/.test(\"in 1992\"));// =&gt; trueconsole.log(/[0-9]/.test(\"in 1992\"));// =&gt; trueconsole.log(/[0-9]/.test(\"Hello \"));// =&gt; falseconsole.log(/[0-5]/.test(\"Gold 9999\"));// =&gt; false VÃ­ dá»¥ 1, 2, 3 kiá»ƒm tra xem string cÃ³ chá»©a báº¥t kÃ¬ chá»¯ sá»‘ nÃ o tá»« 0 Ä‘áº¿n 9. VÃ­ dá»¥ cuá»‘i cÃ¹ng kiá»ƒm tra xem string cÃ³ chá»©a báº¥t kÃ¬ chá»¯ sá»‘ nÃ o tá»« 0 Ä‘áº¿n 5. JavaScript sá»­ dá»¥ng cáº·p dáº¥u ngoáº·c vuÃ´ng [] Ä‘á»ƒ biá»ƒu thá»‹ viá»‡c kiá»ƒm tra string cÃ³ chá»©a báº¥t kÃ¬ kÃ­ tá»± nÃ o cÃ³ trong cáº·p dáº¥u [] hay khÃ´ng. Trong Ä‘Ã³, dáº¥u â€œ-â€œ giá»¯a hai kÃ­ tá»± dÃ¹ng Ä‘á»ƒ chá»‰ 1 khoáº£ng giá»¯a hai kÃ­ tá»± Ä‘Ã³. [0-9] lÃ  cÃ¡c chá»¯ sá»‘ tá»« 0 Ä‘áº¿n 9 [a-z] lÃ  cÃ¡c chá»¯ cÃ¡i tá»« a Ä‘áº¿n z NgoÃ i ra, JavaScript cung cáº¥p sáºµn má»™t sá»‘ cÃ¡ch biá»ƒu diá»…n má»™t táº­p há»£p cÃ¡c kÃ­ tá»±: \\d : báº¥t kÃ¬ chá»¯ sá»‘ nÃ o tá»« 0 Ä‘áº¿n 9 \\w : má»™t chá»¯ cÃ¡i \\s : kÃ­ tá»± tráº¯ng (dáº¥u cÃ¡ch, tab, dÃ²ng má»›i,â€¦) \\D : kÃ­ tá»± khÃ´ng pháº£i sá»‘ \\W : kÃ­ tá»± khÃ´ng pháº£i chá»¯ cÃ¡i \\S : kÃ­ tá»± khÃ´ng pháº£i kÃ­ tá»± tráº¯ng . : báº¥t kÃ¬ kÃ­ tá»± nÃ o trá»« dÃ²ng má»›i. VÃ­ dá»¥ kiá»ƒm tra ngÃ y giá» cÃ³ Ä‘á»‹nh dáº¡ng: dd-mm-yyyy hh:mm 12345var dateTime = /\\d\\d-\\d\\d-\\d\\d\\d\\d \\d\\d:\\d\\d/;console.log(dateTime.test(\"30-01-2003 15:20\"));// =&gt; trueconsole.log(dateTime.test(\"30-jan-2003 15:20\"));// =&gt; false Äáº£o ngÆ°á»£c táº­p há»£p cÃ¡c kÃ­ tá»±TrÆ°á»ng há»£p báº¡n muá»‘n kiá»ƒm tra má»™t string chá»©a báº¥t kÃ¬ kÃ­ tá»± nÃ o khÃ´ng cÃ³ trong táº­p há»£p Ä‘Ã£ cho thÃ¬ báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng kÃ­ tá»± â€œ^â€. VÃ­ dá»¥: 12345var notBinary = /[^01]/;console.log(notBinary.test(\"1100100010100110\"));// =&gt; falseconsole.log(notBinary.test(\"1100100010200110\"));// =&gt; true Láº·p láº¡i khuÃ´n máº«uTrong vÃ­ dá»¥ vá» kiá»ƒm tra ngÃ y giá» bÃªn trÃªn, â€œ\\dâ€ xuáº¥t hiá»‡n láº·p láº¡i ráº¥t nhiá»u láº§n. Äiá»u nÃ y gÃ¢y nÃªn sá»± khÃ³ theo dÃµi. Do Ä‘Ã³, JavaScript cung cáº¥p cÃ¡ch thá»©c Ä‘á»ƒ biá»ƒu diá»…n sá»± láº·p láº¡i khuÃ´n máº«u: â€œ+â€: biá»ƒu thá»‹ pháº§n tá»­ xuáº¥t hiá»‡n &gt;= 1 láº§n 1234console.log(/'\\d+'/.test(\"'123'\"));// =&gt; trueconsole.log(/'\\d+'/.test(\"''\"));// =&gt; false â€œ*â€: biá»ƒu thá»‹ pháº§n tá»­ xuáº¥t hiá»‡n &gt;= 0 láº§n (cÃ³ thá»ƒ khÃ´ng xuáº¥t hiá»‡n) 1234console.log(/'\\d*'/.test(\"'123'\"));// =&gt; trueconsole.log(/'\\d*'/.test(\"''\"));// =&gt; true â€œ?â€: biá»ƒu thá»‹ pháº§n tá»­ xuáº¥t hiá»‡n 0 hoáº·c 1 láº§n 1234567var neighbor = /neighbou?r/;console.log(neighbor.test(\"neighbour\"));// =&gt; trueconsole.log(neighbor.test(\"neighbor\"));// =&gt; trueconsole.log(neighbor.test(\"neighbouur\"));// =&gt; false {n}: biá»ƒu thá»‹ pháº§n tá»­ xuáº¥t hiá»‡n Ä‘Ãºng n láº§n 123456console.log(/\\d&#123;4&#125;/.test(\"1234\"));// =&gt; trueconsole.log(/\\d&#123;4&#125;/.test(\"12345\"));// =&gt; trueconsole.log(/\\d&#123;4&#125;/.test(\"123\"));// =&gt; false {x,y}: biá»ƒu thá»‹ pháº§n tá»­ xuáº¥t hiá»‡n tá»« x Ä‘áº¿n y láº§n 12345678910console.log(/\\d&#123;2,4&#125;/.test(\"12345\"));// =&gt; trueconsole.log(/\\d&#123;2,4&#125;/.test(\"1234\"));// =&gt; trueconsole.log(/\\d&#123;2,4&#125;/.test(\"123\"));// =&gt; trueconsole.log(/\\d&#123;2,4&#125;/.test(\"12\"));// =&gt; trueconsole.log(/\\d&#123;2,4&#125;/.test(\"1\"));// =&gt; false {x, }: biá»ƒu thá»‹ pháº§n tá»­ xuáº¥t hiá»‡n &gt;= x láº§n 123456console.log(/\\d&#123;2,&#125;/.test(\"12\"));// =&gt; trueconsole.log(/\\d&#123;2,&#125;/.test(\"1234\"));// =&gt; trueconsole.log(/\\d&#123;2,&#125;/.test(\"1\"));// =&gt; false NhÃ³m cÃ¡c pháº§n tá»­Trong nhiá»u trÆ°á»ng há»£p báº¡n muá»‘n láº·p láº¡i cáº£ má»™t nhÃ³m cÃ¡c pháº§n tá»­. Khi Ä‘Ã³, báº¡n pháº£i nhÃ³m cÃ¡c pháº§n tá»­ Ä‘Ã³ láº¡i sá»­ dá»¥ng cáº·p dáº¥u ngoáº·c Ä‘Æ¡n â€œ( )â€. 123var cartoonCrying = /boo+(hoo+)+/i;console.log(cartoonCrying.test(\"Boohoooohoohooo\"));// =&gt; true Lá»±a chá»n khuÃ´n máº«uTrÆ°á»ng há»£p báº¡n cÃ³ nhiá»u khuÃ´n máº«u vÃ  báº¡n cáº§n kiá»ƒm tra xem string Ä‘Æ°a ra chá»©a má»™t trong cÃ¡c khuÃ´n máº«u Ä‘Ã³ thÃ¬ báº¡n cÃ³ thá»ƒ viáº¿t cÃ¡c Regular Expression tÆ°Æ¡ng á»©ng Ä‘á»ƒ kiá»ƒm tra. Hoáº·c sá»­ dá»¥ng kÃ­ tá»± (|) Ä‘á»ƒ biá»ƒu diá»…n â€œhoáº·câ€: 12345var animalCount = /\\d+ (pig|cow|chicken)s?/;console.log(animalCount.test(\"15 pigs\"));// =&gt; trueconsole.log(animalCount.test(\"15 pigchickens\"));// =&gt; false PhÆ°Æ¡ng thá»©c ExecNáº¿u nhÆ° phÆ°Æ¡ng thá»©c test chá»‰ kiá»ƒm tra xem cÃ³ tá»“n táº¡i khuÃ´n máº«u hay khÃ´ng thÃ¬ phÆ°Æ¡ng thá»©c exec sáº½ tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng chá»©a thÃ´ng tin thÃ nh pháº§n trÃ¹ng khá»›p vá»›i khuÃ´n máº«u, ngÆ°á»£c láº¡i thÃ¬ tráº£ vá» null. 12345var match = /\\d+/.exec(\"one two 100 200\");console.log(match);// =&gt; [\"100\", index: 8, input: \"one two 100 200\"]console.log(match.index);// =&gt; 8 VÃ­ dá»¥ trÃªn tráº£ vá» thÃ nh pháº§n thoáº£ mÃ£n khuÃ´n máº«u Ä‘áº§u tiÃªn lÃ : â€œ100â€. Index lÃ  vá»‹ trÃ­ Ä‘áº§u tiÃªn cá»§a string thoáº£ mÃ£n khuÃ´n máº«u. Khi Regular Expression chá»©a group vá»›i cáº·p dáº¥u ngoáº·c Ä‘Æ¡n thÃ¬ pháº§n tá»­ Ä‘áº§u tiÃªn trong káº¿t quáº£ sáº½ lÃ  toÃ n bá»™ thÃ nh pháº§n trÃ¹ng khá»›p, thÃ nh pháº§n tiáº¿p theo lÃ  pháº§n trÃ¹ng khá»›p vá»›i group Ä‘áº§u tiÃªn, thÃ nh pháº§n tiáº¿p theo lÃ  pháº§n trÃ¹ng khá»›p vá»›i group thá»© 2,â€¦ 123456789var quotedText = /'([^']*)'/;console.log(quotedText.exec(\"she said 'hello'\"));// =&gt; [\"'hello'\", \"hello\", index: 9, input: \"she said 'hello'\"]console.log(/bad(ly)?/.exec(\"bad\"));// =&gt; [\"bad\", undefined, index: 0, input: \"bad\"]console.log(/(\\d)+/.exec(\"123\"));// =&gt; [\"123\", \"3\", index: 0, input: \"123\"] TrÃ­ch xuáº¥t dá»¯ liá»‡u tá»« stringPhÆ°Æ¡ng thá»©c nÃ y Ä‘áº·c biá»‡t há»¯u Ã­ch khi báº¡n muá»‘n láº¥y thÃ´ng tin ra tá»« string. VÃ­ dá»¥ sau Ä‘Æ°a ra má»™t string biá»ƒu diá»…n ngÃ y, thÃ¡ng, nÄƒm. Sau Ä‘Ã³ chÃºng ta sáº½ trÃ­ch xuáº¥t ra thÃ´ng tin vá» ngÃ y, thÃ¡ng vÃ  nÄƒm á»Ÿ trong Ä‘Ã³: 123456789101112function findDate(string) &#123; var dateTime = /(\\d&#123;1,2&#125;)-(\\d&#123;1,2&#125;)-(\\d&#123;4&#125;)/; var match = dateTime.exec(string); return &#123; day : match[1], month : match[2], year: match[3] &#125;&#125;var obj = findDate(\"30-1-2003\");console.log(obj);// =&gt; Object &#123;day: \"30\", month: \"1\", year: \"2003\"&#125; Ranh giá»›i cá»§a stringTrong vÃ­ dá»¥ trÃªn, hÃ m findDate váº«n tÃ¬m ra káº¿t quáº£ náº¿u nhÆ° string lÃ  â€œ30-1-200300â€ hay â€œ1130-1-2003â€,â€¦ ÄÃ¢y lÃ  trÆ°á»ng há»£p khÃ´ng mong muá»‘n. Regular Expression JavaScript cung cáº¥p 2 cÃ¡ch Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y: Sá»­ dá»¥ng kÃ­ tá»± biá»ƒu diá»…n báº¯t Ä‘áº§u (^) vÃ  káº¿t thÃºc ($$ string 123456789101112131415161718192021function findDate(string) &#123; var dateTime = /^(\\d&#123;1,2&#125;)-(\\d&#123;1,2&#125;)-(\\d&#123;4&#125;)$/; var match = dateTime.exec(string); if(!match) return null; return &#123; day : match[1], month : match[2], year: match[3] &#125;&#125;var obj1 = findDate(\"30-1-2003\");console.log(obj1);// =&gt; Object &#123;day: \"30\", month: \"1\", year: \"2003\"&#125;var obj2 = findDate(\"0030-1-200300\");console.log(obj2);// =&gt; nullvar obj3 = findDate(\"Hello 30-1-2003 Haha\");console.log(obj3);// =&gt; null Sá»­ dá»¥ng kÃ­ tá»± biÃªn (\\b) 123456789101112131415161718192021function findDate(string) &#123; var dateTime = /\\b(\\d&#123;1,2&#125;)-(\\d&#123;1,2&#125;)-(\\d&#123;4&#125;)\\b/; var match = dateTime.exec(string); if(!match) return null; return &#123; day : match[1], month : match[2], year: match[3] &#125;&#125;var obj1 = findDate(\"30-1-2003\");console.log(obj1);// =&gt; Object &#123;day: \"30\", month: \"1\", year: \"2003\"&#125; var obj2 = findDate(\"0030-1-200300\");console.log(obj2);// =&gt; nullvar obj3 = findDate(\"Hello 30-1-2003 Haha\");console.log(obj3);// =&gt; Object &#123;day: \"30\", month: \"1\", year: \"2003\"&#125; Táº¡o Ä‘á»‘i tÆ°á»£ng RegExp má»™t cÃ¡ch linh Ä‘á»™ngTrong nhiá»u trÆ°á»ng há»£p, báº¡n muá»‘n táº¡o ra má»™t Regular Expression vá»›i ná»™i dung chÆ°a Ä‘Æ°á»£c biáº¿t trÆ°á»›c. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m khá»Ÿi táº¡o cá»§a RegExp theo cÃ¡ch sau: 12345var name = \"lampv\";var text = \"LamPV is a suspicious character.\";var regexp = new RegExp(\"\\\\b(\" + name + \")\\\\b\", \"gi\");console.log(text.replace(regexp, \"_$1_\"));// =&gt; _LamPV_ is a suspicious character. Trong Ä‘Ã³: tham sá»‘ g: chá»‰ ra ráº±ng khuÃ´n máº«u Ã¡p dá»¥ng Global, nghÄ©a lÃ  nÃ³ Ã¡p dá»¥ng cho táº¥t cáº£ thÃ nh pháº§n trÃ¹ng khá»›p. tham sá»‘ i: chá»‰ ra ráº±ng khuÃ´n máº«u khÃ´ng phÃ¢n biá»‡t chá»¯ hoa vÃ  chá»¯ thÆ°á»ng. NgoÃ i ra, á»Ÿ Ä‘Ã¢y tÃ´i cÃ³ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c replace cá»§a string - dÃ¹ng Ä‘á»ƒ thay tháº¿ táº¥t cáº£ nhá»¯ng thÃ nh pháº§n trÃ¹ng khá»›p vá»›i khuÃ´n máº«u vá»›i â€œ_$1_â€. á» Ä‘Ã¢y $$ chÃ­nh lÃ  ná»™i dung cá»§a group thá»© nháº¥t. Káº¿t luáº­nTrÃªn Ä‘Ã¢y lÃ  má»™t sá»‘ kiáº¿n thá»©c cÆ¡ báº£n vá» Regular Expression. Hy vá»ng qua bÃ i viáº¿t nÃ y báº¡n pháº§n nÃ o hiá»ƒu vÃ  biáº¿t cÃ¡ch sá»­ dá»¥ng cÃ´ng cá»¥ hiá»‡u quáº£ nÃ y trong cÃ´ng viá»‡c láº­p trÃ¬nh cá»§a mÃ¬nh, Ä‘áº·c biá»‡t lÃ  láº­p trÃ¬nh JavaScript. TÃ³m táº¯t má»™t sá»‘ khuÃ´n máº«u cÆ¡ báº£n cá»§a Regular Expression: /abc/ : chuá»—i cÃ¡c kÃ­ tá»± abc /[abc]: báº¥t ká»³ kÃ­ tá»± nÃ o thuá»™c táº­p há»£p a, b, c /[^abc]: báº¥t ká»³ kÃ­ tá»± nÃ o khÃ´ng thuá»™c táº­p a, b, c /[0-9]/: báº¥t ká»³ kÃ­ tá»± nÃ o thuá»™c Ä‘oáº¡n tá»« 0 Ä‘áº¿n 9 /x+/: thÃ nh pháº§n x xuáº¥t hiá»‡n &gt;= 1 láº§n /x*/: thÃ nh pháº§n x xuáº¥t hiá»‡n &gt;= 0 láº§n (cÃ³ thá»ƒ khÃ´ng xuáº¥t hiá»‡n) /x?/: thÃ nh pháº§n x xuáº¥t hiá»‡n 0 hoáº·c 1 láº§n /x{2, 4}/: thÃ nh pháº§n x xuáº¥t hiá»‡n tá»« 2 Ä‘áº¿n 4 láº§n /(abc)/: cá»¥m abc /a|b|c/: báº¥t kÃ¬ pattern nÃ o trong 3 loáº¡i a, b, c /\\d/: chá»¯ sá»‘ tá»« 0 Ä‘áº¿n 9 /\\w/: chá»¯ cÃ¡i /\\s/: kÃ­ tá»± tráº¯ng (dáº¥u cÃ¡ch, tab, dÃ²ng má»›i,â€¦) /./ : báº¥t ká»³ kÃ­ tá»± nÃ o trá»« dÃ²ng má»›i /\\b/: ranh giá»›i tá»« /^/: báº¯t Ä‘áº§u string /$$: káº¿t thÃºc string Tham kháº£o http://eloquentjavascript.net/09_regexp.html BÃ i thá»±c hÃ nh cá»§a tÃ´i: Regexp Golf, Quoting style, Numbers again. XÃ¡c thá»±c mÃ£ mÃ u RGB vÃ  mÃ£ mÃ u HEX sá»­ dá»¥ng Regex trong Javascript","categories":[],"tags":[{"name":"regex","slug":"regex","permalink":"http://nthung2112.github.io/tags/regex/"}]},{"title":"Giá»›i thiá»‡u vá» Composing Software","slug":"Gioi-thieu-ve-Composing-Software","date":"2018-05-22T01:09:00.000Z","updated":"2018-05-25T15:58:41.743Z","comments":true,"path":"2018/05/Gioi-thieu-ve-Composing-Software.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Gioi-thieu-ve-Composing-Software.html","excerpt":"Ghi chÃº: ÄÃ¢y lÃ  pháº§n giá»›i thiá»‡u vá» loáº¡t bÃ i â€œComposing Softwareâ€ vá» viá»‡c há»c cÃ¡c ká»¹ nÄƒng functional programming vÃ  compositional software trong JavaScript ES6+ tá»« Ä‘áº§u. HÃ£y theo dÃµi cÃ²n ráº¥t nhiá»u thá»© khÃ¡c ná»¯a!BÃ i viáº¿t Káº¿ tiáº¿p &gt;","text":"Ghi chÃº: ÄÃ¢y lÃ  pháº§n giá»›i thiá»‡u vá» loáº¡t bÃ i â€œComposing Softwareâ€ vá» viá»‡c há»c cÃ¡c ká»¹ nÄƒng functional programming vÃ  compositional software trong JavaScript ES6+ tá»« Ä‘áº§u. HÃ£y theo dÃµi cÃ²n ráº¥t nhiá»u thá»© khÃ¡c ná»¯a!BÃ i viáº¿t Káº¿ tiáº¿p &gt;Composition: â€œHÃ nh Ä‘á»™ng káº¿t há»£p cÃ¡c parts hoáº·c elements Ä‘á»ƒ táº¡o thÃ nh má»™t tá»•ng thá»ƒ.â€ Trong lá»›p há»c láº­p trÃ¬nh Ä‘áº§u tiÃªn cá»§a tÃ´i, tÃ´i Ä‘Ã£ nÃ³i ráº±ng phÃ¡t triá»ƒn pháº§n má»m lÃ  â€œhÃ nh Ä‘á»™ng phÃ¡ vá»¡ má»™t váº¥n Ä‘á» phá»©c táº¡p thÃ nh cÃ¡c váº¥n Ä‘á» nhá» hÆ¡n, vÃ  soáº¡n cÃ¡c giáº£i phÃ¡p Ä‘Æ¡n giáº£n Ä‘á»ƒ táº¡o thÃ nh má»™t giáº£i phÃ¡p hoÃ n chá»‰nh cho váº¥n Ä‘á» phá»©c táº¡p.â€ Má»™t trong nhá»¯ng há»‘i tiáº¿c lá»›n nháº¥t cá»§a tÃ´i trong cuá»™c sá»‘ng lÃ  tÃ´i Ä‘Ã£ khÃ´ng hiá»ƒu Ã½ nghÄ©a cá»§a bÃ i há»c Ä‘Ã³ tá»« sá»›m. TÃ´i Ä‘Ã£ há»c Ä‘Æ°á»£c báº£n cháº¥t cá»§a thiáº¿t káº¿ pháº§n má»m quÃ¡ muá»™n trong cuá»™c sá»‘ng. TÃ´i Ä‘Ã£ phá»ng váº¥n hÃ ng trÄƒm developers. Nhá»¯ng gÃ¬ tÃ´i Ä‘Ã£ há»c Ä‘Æ°á»£c tá»« nhá»¯ng buá»•i Ä‘Ã³ lÃ  TÃ´i khÃ´ng Ä‘Æ¡n Ä‘á»™c. Ráº¥t Ã­t developers pháº§n má»m lÃ m viá»‡c mÃ  cÃ³ náº¯m báº¯t tá»‘t vá» báº£n cháº¥t cá»§a phÃ¡t triá»ƒn pháº§n má»m. Há» khÃ´ng nháº­n thá»©c Ä‘Æ°á»£c cÃ¡c cÃ´ng cá»¥ quan trá»ng nháº¥t chÃºng ta cÃ³ thá»ƒ cÃ³ Ä‘á»ƒ xá»­ lÃ½ hoáº·c lÃ m tháº¿ nÃ o Ä‘á»ƒ Ä‘Æ°a chÃºng vÃ o sá»­ dá»¥ng cho tá»‘t. 100% Ä‘Ã£ Ä‘áº¥u tranh Ä‘á»ƒ tráº£ lá»i má»™t hoáº·c cáº£ hai cÃ¢u há»i quan trá»ng nháº¥t trong lÄ©nh vá»±c phÃ¡t triá»ƒn pháº§n má»m: What is function composition? What is object composition? Váº¥n Ä‘á» lÃ  báº¡n khÃ´ng thá»ƒ trÃ¡nh Ä‘Æ°á»£c â€˜compositionâ€™ chá»‰ vÃ¬ báº¡n khÃ´ng biáº¿t vá» nÃ³. Báº¡n váº«n lÃ m Ä‘iá»u Ä‘Ã³ - nhÆ°ng báº¡n lÃ m Ä‘iá»u Ä‘Ã³ ráº¥t tá»‡. Báº¡n viáº¿t mÃ£ vá»›i nhiá»u lá»—i hÆ¡n vÃ  lÃ m cho cÃ¡c developers khÃ¡c khÃ³ hiá»ƒu hÆ¡n. ÄÃ¢y lÃ  má»™t váº¥n Ä‘á» lá»›n. CÃ¡c áº£nh hÆ°á»Ÿng áº¥y tá»‘n nháº¥t nhiá»u chi phÃ­. ChÃºng tÃ´i dÃ nh nhiá»u thá»i gian hÆ¡n Ä‘á»ƒ duy trÃ¬ pháº§n má»m hÆ¡n lÃ  chÃºng tÃ´i táº¡o ra nÃ³ tá»« Ä‘áº§u vÃ  cÃ¡c lá»—i cá»§a chÃºng tÃ´i tÃ¡c Ä‘á»™ng Ä‘áº¿n hÃ ng tá»· ngÆ°á»i trÃªn kháº¯p tháº¿ giá»›i. Cáº£ tháº¿ giá»›i cháº¡y trÃªn pháº§n má»m ngÃ y nay. Má»—i chiáº¿c xe má»›i lÃ  má»™t siÃªu mÃ¡y tÃ­nh mini trÃªn bÃ¡nh xe, vÃ  cÃ¡c váº¥n Ä‘á» vá»›i thiáº¿t káº¿ pháº§n má»m gÃ¢y ra tai náº¡n thá»±c sá»± vÃ  chi phÃ­ cuá»™c sá»‘ng thá»±c cá»§a con ngÆ°á»i. VÃ o nÄƒm 2013, Ban giÃ¡m kháº£o Ä‘Ã£ tÃ¬m tháº¥y nhÃ³m phÃ¡t triá»ƒn pháº§n má»m cá»§a Toyota cÃ³ tá»™i â€œLiá»u lÄ©nh khÃ´ng Ä‘á»ƒ Ã½â€ sau khi má»™t cuá»™c Ä‘iá»u tra tai náº¡n cho tháº¥y spaghetti code vá»›i 10000 biáº¿n global. Hackers vÃ  governments stockpile bugs Ä‘á»ƒ theo dÃµi má»i ngÆ°á»i, Äƒn cáº¯p tháº» tÃ­n dá»¥ng, khai thÃ¡c tÃ i nguyÃªn mÃ¡y tÃ­nh Ä‘á»ƒ khá»Ÿi cháº¡y cÃ¡c cuá»™c táº¥n cÃ´ng tá»« chá»‘i dá»‹ch vá»¥ phÃ¢n tÃ¡n (DDoS), crack máº­t kháº©u vÃ  tháº­m chÃ­ Ä‘iá»u khiá»ƒn cuá»™c báº§u cá»­. ChÃºng ta pháº£i lÃ m tá»‘t hÆ¡n. You Compose Software Every DayNáº¿u báº¡n lÃ  nhÃ  phÃ¡t triá»ƒn pháº§n má»m, báº¡n láº­p trÃ¬nh cÃ¡c chá»©c nÄƒng vÃ  cáº¥u trÃºc dá»¯ liá»‡u má»—i ngÃ y, cho dÃ¹ báº¡n cÃ³ biáº¿t hay khÃ´ng. Báº¡n cÃ³ thá»ƒ lÃ m Ä‘iá»u Ä‘Ã³ má»™t cÃ¡ch cÃ³ Ã½ thá»©c (vÃ  tá»‘t hÆ¡n), hoáº·c báº¡n cÃ³ thá»ƒ lÃ m Ä‘iá»u Ä‘Ã³ má»™t cÃ¡ch vÃ´ tÃ¬nh, with duct-tape and crazy glue. QuÃ¡ trÃ¬nh phÃ¡t triá»ƒn pháº§n má»m lÃ  chia nhá» cÃ¡c váº¥n Ä‘á» lá»›n thÃ nh cÃ¡c váº¥n Ä‘á» nhá» hÆ¡n, xÃ¢y dá»±ng cÃ¡c thÃ nh pháº§n giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nhá» hÆ¡n, sau Ä‘Ã³ káº¿t há»£p cÃ¡c thÃ nh pháº§n láº¡i vá»›i nhau Ä‘á»ƒ táº¡o thÃ nh má»™t á»©ng dá»¥ng hoÃ n chá»‰nh. Composing FunctionsFunction composition lÃ  quÃ¡ trÃ¬nh Ã¡p dá»¥ng má»™t function lÃ  output cá»§a function khÃ¡c. Trong Ä‘áº¡i sá»‘, cÃ³ hai hÃ m sá»‘, f vÃ  g, (f âˆ˜ g)(x) = f(g(x)). VÃ²ng trÃ²n lÃ  toÃ¡n tá»­ káº¿t há»£p. NÃ³ thÆ°á»ng Ä‘Æ°á»£c phÃ¡t Ã¢m â€œkáº¿t há»£p vá»›iâ€ hoáº·c lÃ  â€œtheo sauâ€. Báº¡n cÃ³ thá»ƒ nÃ³i nhÆ° â€œf káº¿t há»£p vá»›i g báº±ng f of g of xâ€, or â€œf theo sau g báº±ng f of g of xâ€. ChÃºng ta nÃ³i f theo sau g bá»Ÿi vÃ¬ g is giÃ¡ trá»‹ Ä‘áº§u, sau Ä‘Ã³ output cá»§a nÃ³ Ä‘Æ°á»£c chuyá»ƒn thÃ nh Ä‘á»‘i sá»‘ f. Má»—i láº§n báº¡n viáº¿t code nhÆ° tháº¿ nÃ y, nÃ³ lÃ  composing functions: 12345678const g = n =&gt; n + 1;const f = n =&gt; n * 2;const doStuff = x =&gt; &#123; const afterG = g(x); const afterF = f(afterG); return afterF;&#125;;doStuff(20); // 42 Má»—i khi báº¡n viáº¿t má»™t chuá»—i promise, nÃ³ lÃ  composing functions: 1234567891011121314const g = n =&gt; n + 1;const f = n =&gt; n * 2;const wait = time =&gt; new Promise( (resolve, reject) =&gt; setTimeout( resolve, time ));wait(300) .then(() =&gt; 20) .then(g) .then(f) .then(value =&gt; console.log(value)) // 42; TÆ°Æ¡ng tá»± nhÆ° váº­y, má»—i khi báº¡n thá»±c hiá»‡n cÃ¡c gá»i cÃ¡c chuá»—i phÆ°Æ¡ng thá»©c máº£ng, cÃ¡c hÃ m lodash, observables (RxJS, etcâ€¦) nÃ³ lÃ  composing functions. Náº¿u lÃ  má»™t chuá»—i, thÃ¬ nÃ³ lÃ  composing. Náº¿u báº¡n chuyá»ƒn má»™t giÃ¡ trá»‹ tráº£ vá» vÃ o nhá»¯ng functions khÃ¡c, nÃ³ cÅ©ng lÃ  composing. Náº¿u báº¡n gá»i hai hÃ m theo trÃ¬nh tá»±, nÃ³ lÃ  composing náº¿u sá»­ dá»¥ng dá»¯ liá»‡u hÃ m nÃ y lÃ m dá»¯ liá»‡u Ä‘áº§u vÃ o cho hÃ m kia. Náº¿u lÃ  má»™t chuá»—i, thÃ¬ nÃ³ lÃ  composing. Khi báº¡n viáº¿t má»™t functions cÃ³ chá»§ Ã½, báº¡n sáº½ lÃ m tá»‘t hÆ¡n. Composing functions cÃ³ chá»§ Ã½, chÃºng ta cÃ³ thá»ƒ cáº£i thiá»‡n hÃ m doStuff() thÃ nh 1 dÃ²ng Ä‘Æ¡n giáº£n: 1234const g = n =&gt; n + 1;const f = n =&gt; n * 2;const doStuffBetter = x =&gt; f(g(x));doStuffBetter(20); // 42 Má»™t trong nhá»¯ng pháº£n Ä‘á»‘i chung vá» kiá»ƒu nÃ y lÃ  khÃ³ Ä‘á»ƒ debug. VÃ­ dá»¥, chÃºng ta sáº½ viáº¿t function composition báº±ng cÃ¡ch nÃ o? 12345678910111213const doStuff = x =&gt; &#123; const afterG = g(x); console.log(`after g: $&#123; afterG &#125;`); const afterF = f(afterG); console.log(`after f: $&#123; afterF &#125;`); return afterF;&#125;;doStuff(20); // =&gt;/*\"after g: 21\"\"after f: 42\"*/ Äáº§u tiÃªn, hÃ£y trá»«u tÆ°á»£ng ráº±ng â€œafter fâ€, â€œafter gâ€ vÃ  viáº¿t vÃ o má»™t tiá»‡n Ã­ch nhá» gá»i lÃ  trace(): 1234const trace = label =&gt; value =&gt; &#123; console.log(`$&#123; label &#125;: $&#123; value &#125;`); return value;&#125;; Now we can use it like this: 12345678910111213const doStuff = x =&gt; &#123; const afterG = g(x); trace('after g')(afterG); const afterF = f(afterG); trace('after f')(afterF); return afterF;&#125;;doStuff(20); // =&gt;/*\"after g: 21\"\"after f: 42\"*/ ThÆ° viá»‡n functional programming phá»• biáº¿n nhÆ° Lodash vÃ  Ramda bao gá»“m cÃ¡c tiá»‡n Ã­ch Ä‘á»ƒ thá»±c hiá»‡n function composition dá»… hÆ¡n. Báº¡n cÃ³ thá»ƒ viáº¿t láº¡i hÃ m trÃªn nhÆ° tháº¿ nÃ y: 12345678910111213import pipe from 'lodash/fp/flow';const doStuffBetter = pipe( g, trace('after g'), f, trace('after f'));doStuffBetter(20); // =&gt;/*\"after g: 21\"\"after f: 42\"*/ If you want to try this code without importing something, you can define pipe like this:Náº¿u báº¡n muá»‘n thá»­ code nÃ y mÃ  khÃ´ng cáº§n nháº­p gÃ¬, báº¡n cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh pipe nhÆ° tháº¿ nÃ y: 12// pipe(...fns: [...Function]) =&gt; x =&gt; yconst pipe = (...fns) =&gt; x =&gt; fns.reduce((y, f) =&gt; f(y), x); Äá»«ng lo láº¯ng náº¿u báº¡n chÆ°a thá»ƒ theo dÃµi cÃ¡ch hoáº¡t Ä‘á»™ng. Sau Ä‘Ã³, chÃºng tÃ´i sáº½ khÃ¡m phÃ¡ function composition chi tiáº¿t hÆ¡n. In fact, itâ€™s so essential, youâ€™ll see it defined and demonstrated many times throughout this text. The point is to help you become so familiar with it that its definition and usage becomes automatic. Be one with the composition. pipe() creates a pipeline of functions, passing the output of one function to the input of another. When you use pipe() (and its twin, compose()) You donâ€™t need intermediary variables. Writing functions without mention of the arguments is called point-free style. To do it, youâ€™ll call a function that returns the new function, rather than declaring the function explicitly. That means you wonâ€™t need the function keyword or the arrow syntax (=&gt;). Point-free style can be taken too far, but a little bit here and there is great because those intermediary variables add unnecessary complexity to your functions. There are several benefits to reduced complexity: Working MemoryBá»™ nÃ£o con ngÆ°á»i trung bÃ¬nh chá»‰ cÃ³ má»™t vÃ i tÃ i nguyÃªn Ä‘Æ°á»£c chia sáº» cho lÆ°á»£ng tá»­ rá»i ráº¡c trong bá»™ nhá»› lÃ m viá»‡c working memory, vÃ  má»—i biáº¿n cÃ³ kháº£ nÄƒng tiÃªu thá»¥ má»™t trong nhá»¯ng lÆ°á»£ng tá»­ Ä‘Ã³. As you add more variables, our ability to accurately recall the meaning of each variable is diminished. Working memory models typically involve 4â€“7 discrete quanta. Above those numbers, error rates dramatically increase. Using the pipe form, we eliminated 3 variables â€” freeing up almost half of our available working memory for other things. That reduces our cognitive load significantly. Software developers tend to be better at chunking data into working memory than the average person, but not so much more as to weaken the importance of conservation. Signal to Noise RatioConcise code also improves the signal-to-noise ratio of your code. Itâ€™s like listening to a radio â€” when the radio is not tuned properly to the station, you get a lot of interfering noise, and itâ€™s harder to hear the music. When you tune it to the correct station, the noise goes away, and you get a stronger musical signal. Code is the same way. More concise code expression leads to enhanced comprehension. Some code gives us useful information, and some code just takes up space. If you can reduce the amount of code you use without reducing the meaning that gets transmitted, youâ€™ll make the code easier to parse and understand for other people who need to read it. Surface Area for BugsTake a look at the before and after functions. It looks like the function went on a diet and lost a ton of weight. Thatâ€™s important because extra code means extra surface area for bugs to hide in, which means more bugs will hide in it. Less code = less surface area for bugs = fewer bugs. Composing Objects â€œFavor object composition over class inheritanceâ€ the Gang of Four, â€œDesign Patterns: Elements of Reusable Object Oriented Softwareâ€ â€œIn computer science, a composite data type or compound data type is any data type which can be constructed in a program using the programming languageâ€™s primitive data types and other composite types. [â€¦] The act of constructing a composite type is known as composition.â€ ~ Wikipedia These are primitives: 12const firstName = 'Claude';const lastName = 'Debussy'; And this is a composite: 1234const fullName = &#123; firstName, lastName&#125;; Likewise, all Arrays, Sets, Maps, WeakMaps, TypedArrays, etcâ€¦ are composite datatypes. Any time you build any non-primitive data structure, youâ€™re performing some kind of object composition. Note that the Gang of Four defines a pattern called the composite pattern which is a specific type of recursive object composition which allows you to treat individual components and aggregated composites identically. Some developers get confused, thinking that the composite pattern is the only form of object composition. Donâ€™t get confused. There are many different kinds of object composition. The Gang of Four continues, â€œyouâ€™ll see object composition applied again and again in design patternsâ€, and then they catalog three kinds of object compositional relationships, including delegation (as used in the state, strategy, and visitor patterns), acquaintance (when an object knows about another object by reference, usually passed as a parameter: a uses-a relationship, e.g., a network request handler might be passed a reference to a logger to log the request â€” the request handler uses a logger), and aggregation (when child objects form part of a parent object: a has-a relationship, e.g., DOM children are component elements in a DOM node â€” A DOM node has children). Class inheritance can be used to construct composite objects, but itâ€™s a restrictive and brittle way to do it. When the Gang of Four says â€œfavor object composition over class inheritanceâ€, theyâ€™re advising you to use flexible approaches to composite object building, rather than the rigid, tightly-coupled approach of class inheritance. Weâ€™ll use a more general definition of object composition from â€œCategorical Methods in Computer Science: With Aspects from Topologyâ€ (1989): â€œComposite objects are formed by putting objects together such that each of the latter is â€˜part ofâ€™ the former.â€ Another good reference is â€œReliable Software Through Composite Designâ€, Glenford J Myers, 1975. Both books are long out of print, but you can still find sellers on Amazon or eBay if youâ€™d like to explore the subject of object composition in more technical depth. Class inheritance is just one kind of composite object construction. All classes produce composite objects, but not all composite objects are produced by classes or class inheritance. â€œFavor object composition over class inheritanceâ€ means that you should form composite objects from small component parts, rather than inheriting all properties from an ancestor in a class hierarchy. The latter causes a large variety of well-known problems in object oriented design: The tight coupling problem: Because child classes are dependent on the implementation of the parent class, class inheritance is the tightest coupling available in object oriented design. The fragile base class problem: Due to tight coupling, changes to the base class can potentially break a large number of descendant classes â€” potentially in code managed by third parties. The author could break code theyâ€™re not aware of. The inflexible hierarchy problem: With single ancestor taxonomies, given enough time and evolution, all class taxonomies are eventually wrong for new use-cases. The duplication by necessity problem: Due to inflexible hierarchies, new use cases are often implemented by duplication, rather than extension, leading to similar classes which are unexpectedly divergent. Once duplication sets in, itâ€™s not obvious which class new classes should descend from, or why. The gorilla/banana problem: â€œâ€¦the problem with object-oriented languages is theyâ€™ve got all this implicit environment that they carry around with them. You wanted a banana but what you got was a gorilla holding the banana and the entire jungle.â€ ~ Joe Armstrong, â€œCoders at Workâ€ The most common form of object composition in JavaScript is known as object concatenation (aka mixin composition). It works like ice-cream. You start with an object (like vanilla ice-cream), and then mix in the features you want. Add some nuts, caramel, chocolate swirl, and you wind up with nutty caramel chocolate swirl ice cream. Building composites with class inheritance: 123456789101112class Foo &#123; constructor () &#123; this.a = 'a' &#125;&#125;class Bar extends Foo &#123; constructor (options) &#123; super(options); this.b = 'b' &#125;&#125;const myBar = new Bar(); // &#123;a: 'a', b: 'b'&#125; Building composites with mixin composition: 1234567const a = &#123; a: 'a'&#125;;const b = &#123; b: 'b'&#125;;const c = &#123;...a, ...b&#125;; // &#123;a: 'a', b: 'b'&#125; Weâ€™ll explore other styles of object composition in more depth later. For now, your understanding should be: Thereâ€™s more than one way to do it. Some ways are better than others. You want to select the simplest, most flexible solution for the task at hand. ConclusionThis isnâ€™t about functional programming (FP) vs object-oriented programming (OOP), or one language vs another. Components can take the form of functions, data structures, classes, etcâ€¦ Different programming languages tend to afford different atomic elements for components. Java affords classes, Haskell affords functions, etcâ€¦ But no matter what language and what paradigm you favor, you canâ€™t get away from composing functions and data structures. In the end, thatâ€™s what it all boils down to. Weâ€™ll talk a lot about functional programming, because functions are the simplest things to compose in JavaScript, and the functional programming community has invested a lot of time and effort formalizing function composition techniques. What we wonâ€™t do is say that functional programming is better than object-oriented programming, or that you must choose one over the other. OOP vs FP is a false dichotomy. Every real Javascript application Iâ€™ve seen in recent years mixes FP and OOP extensively. Weâ€™ll use object composition to produce datatypes for functional programming, and functional programming to produce objects for OOP. No matter how you write software, you should compose it well. The essence of software development is composition. A software developer who doesnâ€™t understand composition is like a home builder who doesnâ€™t know about bolts or nails. Building software without awareness of composition is like a home builder putting walls together with duct tape and crazy glue. Itâ€™s time to simplify, and the best way to simplify is to get to the essence. The trouble is, almost nobody in the industry has a good handle on the essentials. We as an industry have failed you, the software developer. Itâ€™s our responsibility as an industry to train developers better. We must improve. We need to take responsibility. Everything runs on software today, from the economy to medical equipment. There is literally no corner of human life on this planet that is not impacted by the quality of our software. We need to know what weâ€™re doing. Itâ€™s time to learn how to compose software. Continued in â€œThe Rise and Fall and Rise of Functional Programmingâ€","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"hof","slug":"hof","permalink":"http://nthung2112.github.io/tags/hof/"}]},{"title":"Sá»­ dá»¥ng kÃ½ phÃ¡p BEM trong CSS","slug":"Su-dung-ky-phap-BEM-trong-CSS","date":"2018-05-20T09:05:00.000Z","updated":"2018-05-20T09:16:00.943Z","comments":true,"path":"2018/05/Su-dung-ky-phap-BEM-trong-CSS.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Su-dung-ky-phap-BEM-trong-CSS.html","excerpt":"KÃ½ phÃ¡p BEM lÃ  gÃ¬BEM viáº¿t táº¯t cá»§a Blocks, Elements, Modifiers, lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘áº·t tÃªn class cho HTML vÃ  CSS. ÄÆ°á»£c phÃ¡t triá»ƒn táº¡i Yandex giÃºp láº­p trÃ¬nh viÃªn hiá»ƒu rÃµ hÆ¡n má»‘i quan há»‡ giá»¯a HTML vÃ  CSS trong dá»± Ã¡n front end.","text":"KÃ½ phÃ¡p BEM lÃ  gÃ¬BEM viáº¿t táº¯t cá»§a Blocks, Elements, Modifiers, lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘áº·t tÃªn class cho HTML vÃ  CSS. ÄÆ°á»£c phÃ¡t triá»ƒn táº¡i Yandex giÃºp láº­p trÃ¬nh viÃªn hiá»ƒu rÃµ hÆ¡n má»‘i quan há»‡ giá»¯a HTML vÃ  CSS trong dá»± Ã¡n front end.VÃ­ dá»¥ sau Ä‘Ã¢y sáº½ minh hoáº¡ cÃ¡ch sá»­ dá»¥ng kÃ½ phÃ¡p BEM: 123456789/* Má»™t Block (khá»‘i) Ä‘á»™c láº­p */.btn &#123;&#125;/* Element (pháº§n tá»­) con, phá»¥ thuá»™c vÃ o Block á»Ÿ trÃªn */.btn__price &#123;&#125;/* Modifier (bá»™ Ä‘iá»u chá»‰nh) thay Ä‘á»•i tráº¡ng thÃ¡i cá»§a Block */.btn--orange &#123;&#125;.btn--big &#123;&#125; Vá»›i cÃ¡ch Ä‘áº·t tÃªn class nÃ y, ta cÃ³ Block sáº½ Ä‘áº¡i diá»‡n cho má»™t component, vÃ  trong vÃ­ dá»¥ á»Ÿ Ä‘Ã¢y, lÃ  má»™t button .btn. Block cÅ©ng sáº½ Ä‘Ã³ng vai trÃ² lÃ  má»™t parent mÃ  trong nÃ³ sáº½ cÃ³ má»™t hoáº·c nhiá»u hÆ¡n Element con liÃªn quan. TÃªn class cho Element vÃ  má»‘i quan há»‡ cá»§a nÃ³ vá»›i Block sáº½ Ä‘Æ°á»£c diá»…n táº£ báº±ng tÃªn cá»§a Block, tiáº¿p theo lÃ  hai gáº¡ch dÆ°á»›i, vÃ  cuá»‘i cÃ¹ng lÃ  tÃªn cá»§a Element .btn__price. ThÃ nh pháº§n thá»© ba cá»§a BEM lÃ  cÃ¡c Modifier mÃ  chÃºng sáº½ giÃºp Ä‘iá»u chá»‰nh cÃ¡c tráº¡ng thÃ¡i hoáº·c phÃ¡i sinh khÃ¡c cá»§a Block / Element. TÃªn cá»§a Modifier sáº½ Ä‘Æ°á»£c ná»‘i vá»›i tÃªn Block / Element phÃ­a trÆ°á»›c bá»Ÿi 02 gáº¡ch ngang .btn--orange. Trong HTML, kÃ½ phÃ¡p BEM sáº½ Ä‘Æ°á»£c dÃ¹ng nhÆ° sau: 1234&lt;a class=\"btn btn--big btn--orange\" href=\"http://int3ractive.com\"&gt; &lt;span class=\"btn__price\"&gt;$9.99&lt;/span&gt; &lt;span class=\"btn__text\"&gt;Subscribe&lt;/span&gt;&lt;/a&gt; áº¤n tÆ°á»£ng Ä‘áº§u tiÃªn vá»›i báº¡n cÃ³ thá»ƒ lÃ  tÃªn class quÃ¡ xáº¥u vÃ  máº¥t thá»i gian hÆ¡n so vá»›i viá»‡c táº¡o riÃªng má»™t class má»›i cho má»™t kiá»ƒu button má»›i. Tuy nhiÃªn, kÃ½ phÃ¡p BEM sáº½ mang láº¡i nhiá»u lá»£i Ã­ch mÃ  tÃ´i sáº½ phÃ¢n tÃ­ch tiáº¿p theo sau Ä‘Ã¢y: Táº¡i sao sá»­ dá»¥ng kÃ½ phÃ¡p BEMTrÆ°á»›c tiÃªn, kÃ½ phÃ¡p BEM giÃºp ngÆ°á»i má»›i tham gia dá»± Ã¡n dá»… dÃ ng phÃ¡t hiá»‡n ra cÃ¡c tráº¡ng thÃ¡i vÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng con cá»§a má»™t component Ä‘Ã£ Ä‘Æ°á»£c viáº¿t sáºµn. Äiá»u nÃ y giÃºp trÃ¡nh cho há» pháº£i viáº¿t láº¡i nhá»¯ng kiá»ƒu CSS Ä‘Ã£ cÃ³ sáºµn vÃ  háº¡n cháº¿ viá»‡c viáº¿t thá»«a code hoáº·c trÃ¹ng kiá»ƒu CSS, Ä‘iá»u mÃ  ráº¥t hay xáº£y ra trong dá»± Ã¡n lá»›n cÃ³ nhiá»u ngÆ°á»i tham gia. Thá»© hai, chá»‰ cáº§n Ä‘á»c HTML, báº¡n váº«n cÃ³ thá»ƒ nhanh chÃ³ng náº¯m Ä‘Æ°á»£c cÃ¡c thÃ nh pháº§n phá»¥ thuá»™c láº«n nhau. Trong vÃ­ dá»¥ trÃªn, báº¡n dá»… dÃ ng nhÃ¬n tháº¥y .btn__price phá»¥ thuá»™c vÃ o .btn máº·c dÃ¹ báº¡n chÆ°a biáº¿t vai trÃ² cá»¥ thá»ƒ cá»§a nÃ³ ngay láº­p tá»©c. Thá»© ba, vá»›i kÃ½ phÃ¡p BEM, má»i Ä‘á»‹nh nghÄ©a chá»‰ cÃ³ má»™t cáº¥p class vÃ  khÃ´ng lá»“ng cáº¥p. Äiá»u nÃ y giÃºp cho Ä‘á»™ Æ°u tiÃªn (specificity) chung cá»§a há»‡ thá»‘ng CSS tháº¥p. ÄÃ¢y lÃ  má»™t lá»£i tháº¿ vÃ¬ sau nÃ y báº¡n khÃ´ng pháº£i â€œchiáº¿n Ä‘áº¥uâ€ vá»›i specificity cá»§a nhá»¯ng thuá»™c tÃ­nh Ä‘Ã£ cÃ³ sáºµn (VD: siÃªu lá»“ng cáº¥p .a .b .c .d .e {...}) cÅ©ng nhÆ° váº­n dá»¥ng nhá»¯ng ká»¹ thuáº­t khÃ´ng hay Ä‘á»ƒ thay tháº¿ Ä‘Æ°á»£c style (cháº³ng háº¡n !important hay inline CSS). Quy luáº­t thÃ¡c nÆ°á»›c cascading cá»§a CSS lÃ  con dao hai lÆ°á»¡i: nÃ³ giÃºp dá»… dÃ ng Ä‘á»‹nh nghÄ©a nhá»¯ng thuá»™c tÃ­nh vÃ  kiá»ƒu chung trÃªn nhá»¯ng selector tá»•ng quÃ¡t mÃ  khÃ´ng cáº§n pháº£i khai bÃ¡o láº·p láº¡i trÃªn tá»«ng pháº§n tá»­, nhÆ°ng náº¿u khÃ´ng náº¯m Ä‘Æ°á»£c táº§m áº£nh hÆ°á»Ÿng, láº­p trÃ¬nh viÃªn CSS ráº¥t dá»… gÃ¢y ra nhá»¯ng tÃ¡c Ä‘á»™ng phá»¥ Ä‘áº¿n cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng liÃªn quan khi chá»‰nh sá»­a trÃªn nhá»¯ng class cÃ³ sáºµn hoáº·c tháº­m chÃ­ viáº¿t má»›i. Vá»›i kÃ½ phÃ¡p BEM, láº­p trÃ¬nh viÃªn sáº½ tá»± tin hÆ¡n khi báº¯t tay chá»‰nh sá»­a hoáº·c viáº¿t thÃªm style vÃ¬ Ä‘Ã£ biáº¿t rÃµ táº§m áº£nh hÆ°á»Ÿng cá»§a selector mÃ  mÃ¬nh Ä‘ang viáº¿t ra. TÃ³m láº¡i, kÃ½ phÃ¡p BEM, náº¿u Ã¡p dá»¥ng triá»‡t Ä‘á»ƒ, sáº½ giÃºp cáº£i thiá»‡n sá»± phá»‘i há»£p giá»¯a cÃ¡c thÃ nh viÃªn trong nhÃ³m. NgoÃ i ra, nÃ³ buá»™c ngÆ°á»i viáº¿t CSS pháº£i Ä‘áº§u tÆ° suy nghÄ© vá» viá»‡c xÃ¢y dá»±ng nhá»¯ng component Ä‘á»™c láº­p vÃ  tÃ¡i sá»­ dá»¥ng Ä‘Æ°á»£c (phÃ¹ há»£p vá»›i tiÃªu chÃ­ cá»§a OOCSS). Sá»­ dá»¥ng BEM vá»›i SASSVá»›i phiÃªn báº£n SASS má»›i nháº¥t hiá»‡n nay, viá»‡c viáº¿t theo kÃ½ phÃ¡p BEM trong SCSS dá»… dÃ ng vÃ  thuáº­n tiá»‡n hÆ¡n bao giá» háº¿t. Báº¡n váº«n sáº½ sá»­ dá»¥ng cÃ¡ch viáº¿t lá»“ng Ä‘á»ƒ cÃ´ láº­p khá»‘i component vÃ  káº¿t há»£p vá»›i biá»ƒu tÆ°á»£ng parent &amp; cá»§a SASS Ä‘á»ƒ Ä‘áº·t tÃªn cho Element vÃ  Modifier mÃ  khÃ´ng pháº£i Ä‘Ã¡nh láº¡i tÃªn cá»§a Block. VD: 123456.block &#123; &amp;__element &#123;&#125; &amp;--mod &#123;&#125;&#125; Máº·c dÃ¹ viáº¿t lá»“ng cáº¥p, khi Ä‘Æ°á»£c biÃªn dá»‹ch thÃ nh CSS, chÃºng váº«n Ä‘Æ°á»£c tráº£i pháº³ng thÃ nh má»™t cáº¥p class theo Ä‘Ãºng tinh tháº§n cá»§a BEM: 12345.block &#123;&#125;.block__element &#123;&#125;.block--mod &#123;&#125; Náº¿u báº¡n sá»­ dá»¥ng LibSass (nhanh hÆ¡n ráº¥t nhiá»u láº§n báº£n gá»‘c Ruby) Ä‘á»ƒ biÃªn dá»‹ch SASS, thÃ¬ hÃ£y Ä‘áº£m báº£o cÃ¡c cÃ´ng cá»¥ wrapper Ä‘Æ°á»£c cáº­p nháº­t cÃ¡c phiÃªn báº£n tÆ°Æ¡ng Ä‘Æ°Æ¡ng hoáº·c má»›i hÆ¡n nhÆ° sau: node-sass 3.4.0, gulp-sass 2.1.0 (náº¿u sá»­ dá»¥ng GulpJS) vÃ  grunt-sass 1.1.0 (náº¿u sá»­ dá»¥ng GruntJS) Tháº¿ cÃ²n LESS? VÃ¬ tÃ´i khÃ´ng sá»­ dá»¥ng LESS nÃªn sáº½ khÃ´ng Ä‘á» cáº­p á»Ÿ Ä‘Ã¢y. Báº¡n cÃ³ thá»ƒ giÃºp bá»• sung hÆ°á»›ng dáº«n cho LESS náº¿u nÃ³ cÃ³ cÃº phÃ¡p trá»£ giÃºp tÆ°Æ¡ng Ä‘Æ°Æ¡ng. CÃ¡c Ã½ kiáº¿n khÃ´ng Ä‘á»“ng tÃ¬nhVáº«n cÃ³ má»™t sá»‘ Ã½ kiáº¿n hoÃ i nghi vÃ  khÃ´ng Ä‘á»“ng tÃ¬nh vá»›i phÆ°Æ¡ng phÃ¡p Ä‘áº·t tÃªn nÃ y. TÃªn class quÃ¡ xáº¥uÄá»“ng Ã½ vá»›i báº¡n ráº±ng BEM trÃ´ng ká»³ quáº·c, tuy nhiÃªn kháº£ nÄƒng mÃ  nÃ³ Ä‘em láº¡i vÃ´ cÃ¹ng lá»›n vÃ  sáº½ hoÃ n toÃ n xoÃ¡ má» háº¡n cháº¿ vá» máº·t â€œngoáº¡i hÃ¬nhâ€ cá»§a nÃ³. NgoÃ i ra BEM Ä‘Ã²i há»i pháº£i gÃµ nhiá»u chá»¯ hÆ¡n vÃ  chiáº¿m nhiá»u byte kÃ½ tá»± hÆ¡n, tuy nhiÃªn vá»›i viá»‡c sá»­ dá»¥ng SASS nhÆ° trÃªn vÃ  viá»‡c gzip file Ä‘Ã£ trá»Ÿ thÃ nh tiÃªu chuáº©n nhÆ° hiá»‡n nay, nhá»¯ng Ä‘iá»u Ä‘Ã³ khÃ´ng cÃ²n lÃ  váº¥n Ä‘á» so vá»›i lá»£i Ã­ch mÃ  BEM mang láº¡i. Descendant selector váº«n giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» nhÆ° trÆ°á»›c giá»CÃ³ má»™t chá»‰ trÃ­ch dÃ nh cho BEM tháº¿ nÃ y: Thay vÃ¬ viáº¿t 123.site-search &#123;&#125;.site-search__field &#123;&#125;.site-search--full &#123;&#125; Há» Ä‘áº·t váº¥n Ä‘á» ráº±ng táº¡i sao khÃ´ng viáº¿t nhÆ° tháº¿ nÃ y: 123.site-search &#123;&#125;.site-search input &#123;&#125;.site-search.full &#123;&#125; RÃµ rÃ ng cáº£ hai cÃ¡ch viáº¿t Ä‘á»u cÃ³ thá»ƒ giÃºp hiá»‡n thá»±c Ä‘Æ°á»£c component cá»¥ thá»ƒ nÃ y vÃ  cÃ¡ch thá»© hai cÃ³ váº» â€œgá»n gÃ ngâ€ hÆ¡n. Tuy nhiÃªn khi CSS cá»§a toÃ n bá»™ dá»± Ã¡n trá»Ÿ nÃªn lá»›n vÃ  phá»©c táº¡p hÆ¡n, thÃ¬ ráº¥t khÃ³ trÃ¡nh khá»i cÃ¡c kiá»ƒu Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a chá»“ng chÃ©o lÃªn nhau ngoÃ i táº§m kiá»ƒm soÃ¡t. Thá»­ tÆ°á»Ÿng tÆ°á»£ng .site-search cÅ©ng náº±m trong má»™t container tÃªn .main vÃ  nhá»¯ng input bÃªn trong .main cáº§n Ä‘Æ°á»£c style vá»›i .main input. NhÆ° váº­y, input bÃªn trong .site-search sáº½ bá»‹ Ä‘iá»u chá»‰nh má»™t cÃ¡ch khÃ´ng mong muá»‘n. TÆ°Æ¡ng tá»±, náº¿u nhÆ° .full trong vÃ­ dá»¥ trÃªn hoáº·c má»™t tÃªn phá»• biáº¿n nhÆ° .label Ä‘Æ°á»£c dÃ¹ng nhÆ° modifier, thÃ¬ sáº½ cÃ³ rá»§i ro (ráº¥t cao) lÃ  má»™t ngÃ y nÃ o Ä‘Ã³ má»™t láº­p trÃ¬nh viÃªn khÃ¡c Ä‘á»‹nh nghÄ©a má»™t class global trÃ¹ng tÃªn vÃ  sáº½ lÃ m há»ng style cá»§a element kia. NgoÃ i ra, khi báº¡n Ä‘á»c trong ngá»¯ cáº£nh HTML, báº¡n sáº½ khÃ³ tháº¥y Ä‘Æ°á»£c quan há»‡ rÃ ng buá»™c giá»¯a input vÃ  .full vá»›i block .site-search. â€œTÃ´i Ä‘Æ¡n giáº£n lÃ  khÃ´ng thÃ­ch kÃ½ phÃ¡p nÃ yâ€Má»™t sá»‘ ngÆ°á»i khi nhÃ¬n tháº¥y cÃ¡ch Ä‘áº·t tÃªn BEM Ä‘Ã£ ngay láº­p tá»©c bÃ¡c bá» nÃ³. Há» khÃ´ng thÃ­ch BEM, Ä‘Ã³ lÃ  quyá»n cá»§a há», tuy nhiÃªn sáº½ lÃ  vÃ´ lÃ½ náº¿u pháº£n bÃ¡c viá»‡c cáº§n cÃ³ má»™t sá»‘ quy táº¯c Ä‘áº·t tÃªn Ä‘á»ƒ dá»… dÃ ng náº¯m báº¯t vÃ  quáº£n lÃ½ CSS trong dá»± Ã¡n trung vÃ  lá»›n. HÆ¡n ná»¯a, báº¡n hoÃ n toÃ n cÃ³ thá»ƒ nghÄ© ra cho mÃ¬nh má»™t cÃ¡ch Ä‘áº·t tÃªn khÃ¡c cho há»£p sá»Ÿ thÃ­ch, nhÆ°ng váº«n dá»±a trÃªn nguyÃªn táº¯c cá»§a BEM Ä‘Ã£ Ä‘á» ra. LÃ  káº¿t quáº£ Ä‘Ãºc káº¿t tá»« nhá»¯ng kiáº¿n trÃºc CSS lá»›n vÃ  phá»©c táº¡p trÆ°á»›c Ä‘Ã¢y, Ä‘á» xuáº¥t cá»§a BEM khÃ´ng pháº£i vÃ´ tÃ¬nh láº¡i cÃ³ má»™t sá»‘ Ä‘iá»ƒm chung vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p quáº£n lÃ½ CSS khÃ¡c nhÆ° SMACSS hay OOCSS. Láº¥y vÃ­ dá»¥ khÃ¡i niá»‡m module cá»§a SMACSS: 12345678/* VÃ­ dá»¥ má»™t module */.btn &#123; &#125;/* Modifier cá»§a má»™t module */.btn-primary &#123; &#125;/* Btn Module vá»›i State */.btn.is-collapsed &#123; &#125; Trong cÃ¡c phÆ°Æ¡ng phÃ¡p quáº£n lÃ½ CSS vá»«a ká»ƒ trÃªn thÃ¬ chá»‰ cÃ³ BEM lÃ  lÃ m rÃµ Ä‘Æ°á»£c má»‘i quan há»‡ vá»›i cÃ¡c thÃ nh pháº§n con bÃªn trong. TÃ³m láº¡i, má»—i phÆ°Æ¡ng phÃ¡p Ä‘á»u cÃ³ Æ°u nhÆ°á»£c Ä‘iá»ƒm. Quan trá»ng lÃ  cáº£ team pháº£i cÃ³ phÆ°Æ¡ng phÃ¡p tiáº¿p cáº­n khoa há»c vÃ  Ã¡p dá»¥ng triá»‡t Ä‘á»ƒ thÃ¬ kiáº¿n trÃºc CSS cá»§a cáº£ dá»± Ã¡n má»›i vá»¯ng vÃ  dá»… báº£o trÃ¬. CÃ¢u há»i thÆ°á»ng gáº·p:â“Há»i: Element cÃ³ modifier hay khÃ´ng?ğŸ’¬ï¸ ÄÃ¡p: CÃ³. Element cÃ³ thá»ƒ cÃ³ modifier riÃªng cá»§a nÃ³. VÃ­ dá»¥: 123.accordion__copy--open &#123; display: block;&#125; â“Há»i: CÃ³ cáº§n pháº£i Ä‘áº·t tÃªn class cho táº¥t cáº£ element (tháº» HTML) trong block hay khÃ´ng?ğŸ’¬ï¸ ÄÃ¡p: KhÃ´ng cáº§n thiáº¿t, chá»‰ nhá»¯ng element cáº§n cÃ³ style riÃªng Ä‘Æ°á»£c viáº¿t trong CSS. Tuy nhiÃªn cÅ©ng khÃ´ng nÃªn láº¡m dá»¥ng nhá»¯ng tháº» wrapper (phá»• biáº¿n nháº¥t lÃ  DIV) má»™t cÃ¡ch vÃ´ tá»™i váº¡ vÃ  khÃ´ng cÃ³ chá»©c nÄƒng vai trÃ² cá»¥ thá»ƒ nÃ o. NhÆ° váº­y viá»‡c Ä‘áº·t tÃªn element con cÅ©ng khiáº¿n báº¡n pháº£i suy nghÄ© má»™t tag nÃ o Ä‘Ã³ cÃ³ tháº­t sá»± cáº§n thiáº¿t thÃªm vÃ o trong block hay khÃ´ng. â“Há»i: BÃªn trong element con foo cÃ³ má»™t tag Ä‘Ã³ng vai trÃ² má»™t element con bar khÃ¡c cá»§a block, váº­y viá»‡c Ä‘áº·t tÃªn class cho element bar nÃ y nhÆ° tháº¿ nÃ o? CÃ³ nÃªn Ä‘áº·t lÃ  .block__foo__bar?ğŸ’¬ï¸ ÄÃ¡p: Váº«n Ä‘áº·t báº±ng tÃªn block vÃ  hai gáº¡ch dÆ°á»›i rá»“i Ä‘áº¿n tÃªn element .block__bar, khÃ´ng chen giá»¯a báº±ng foo__. NÃ³i tÃ³m láº¡i, tÃªn cá»§a element chá»‰ cáº§n thá»ƒ hiá»‡n quan há»‡ phá»¥ thuá»™c vá»›i block, khÃ´ng cáº§n pháº£i chá»‰ rÃµ sá»± lá»“ng bÃªn trong nhau cá»§a cÃ¡c element con. (Xem thÃªm vÃ­ dá»¥ trong cÃ¢u há»i tiáº¿p theo) â“Há»i: Má»™t tháº» HTML cÃ³ thá»ƒ lÃ  element cá»§a 2 block khÃ¡c nhau khÃ´ng?ğŸ’¬ï¸ ÄÃ¡p: HoÃ n toÃ n cÃ³ thá»ƒ. HÃ£y xem vÃ­ dá»¥ sau: 1234&lt;a class=\"btn btn--big btn--orange\" href=\"http://int3ractive.com\"&gt; &lt;span class=\"btn__price\"&gt;&lt;i class=\"icon icon--dollar-sign btn__icon\"&gt;&lt;/i&gt;9.99&lt;/span&gt; &lt;span class=\"btn__text\"&gt;Subscribe&lt;/span&gt;&lt;/a&gt; Button cÃ³ biá»ƒu tÆ°á»£ng dollar-sign lÃ  má»™t block .icon. CÃ³ thá»ƒ trong block .btn, biá»ƒu tÆ°á»£ng dollar-sign cáº§n Ä‘Æ°á»£c style riÃªng, nÃªn cáº§n cÃ³ má»™t cÃ¡i tÃªn xÃ¡c Ä‘á»‹nh rÃµ vai trÃ² vÃ  style cho element nÃ y lÃ  .btn__icon. Náº¿u block .icon.icon--dollar-sign Ä‘Æ°á»£c dÃ¹ng á»Ÿ má»™t ngá»¯ cáº£nh khÃ¡c, thÃ¬ rÃµ rÃ ng nÃ³ khÃ´ng cáº§n class .btn__icon ná»¯a vÃ¬ tÃªn class Ä‘Ã£ chá»‰ rÃµ sá»± rÃ ng buá»™c vá»›i block .btn vÃ  chá»‰ Ä‘Æ°á»£c thÃªm vÃ o khi á»Ÿ bÃªn trong nÃ³. â“Há»i: Má»™t element con cÃ³ thá»ƒ Ä‘Ã³ng vai trÃ² lÃ  block cá»§a riÃªng nÃ³ khÃ´ng? CÃ³ thá»ƒ xÃ¢y dá»±ng chuá»—i component phá»¥ thuá»™c nhau nhÆ° .a__b__c khÃ´ng?ğŸ’¬ï¸ ÄÃ¡p: CÃ¢u há»i nÃ y tháº­t sá»± ngoÃ i táº§m hiá»ƒu biáº¿t vÃ  kinh nghiá»‡m cá»§a tÃ´i. CÃ³ thá»ƒ cÃ³ nhá»¯ng hoÃ n cáº£nh Ä‘áº·t biá»‡t nhÆ° váº­y. Tuy nhiÃªn, theo tÃ´i, náº¿u cÃ³ cÅ©ng khÃ´ng nÃªn quÃ¡ 2 cáº¥p, tá»©c lÃ  element con chá»‰ Ä‘áº·t Ä‘áº¿n .a__b__c lÃ  tá»‘i Ä‘a. Äiá»u nÃ y lÃ  Ä‘á»ƒ sá»± phá»¥ thuá»™c khÃ´ng quÃ¡ sÃ¢u, lÃ m giáº£m kháº£ nÄƒng dÃ¹ng láº¡i cá»§a block (portability) vÃ  sá»± linh hoáº¡t cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng CSS theo tinh tháº§n OOCSS. Xem vÃ­ dá»¥ bÃªn dÆ°á»›i. 1234567/* block list */.list &#123; &#125;/* item lÃ  con cá»§a list */.list__item &#123; &#125;/* link lÃ  con cá»§a block list__item, Ä‘á»ƒ phÃ¢n biá»‡t vá»›i list__linkhoáº·c chá»‰ rÃµ má»‘i quan há»‡ phá»¥ thuá»™c giá»¯a item vÃ  link*/.list__item__link &#123; &#125; Sai láº§m hay máº¯c pháº£i khi sá»­ dá»¥ng BEM:TÃ´i xin háº¹n láº¡i vá» váº¥n Ä‘á» nÃ y trong má»™t bÃ i viáº¿t khÃ¡c, khi mÃ  báº£n thÃ¢n Ä‘Ã£ á»©ng dá»¥ng nhiá»u vÃ  quan sÃ¡t Ä‘Æ°á»£c nhá»¯ng vÃ­ dá»¥ thá»±c tiá»…n hÆ¡n Ä‘á»ƒ tá»•ng há»£p nhá»¯ng sai láº§m hay máº¯c pháº£i do áº£nh hÆ°á»Ÿng tá»« phÆ°Æ¡ng phÃ¡p cÅ© cÅ©ng nhÆ° cÃ¡ch hiá»ƒu chÆ°a Ä‘Ãºng vá» phÆ°Æ¡ng phÃ¡p BEM nÃ y. Xem thÃªm: BÃ i viáº¿t giá»›i thiá»‡u BEM cá»§a CSSWizadry BÃ i viáº¿t giá»›i thiá»‡u BEM cá»§a Smashing Magazine Sá»­ dá»¥ng BEM vÃ  @extend cá»§a SASS BÃ i viáº¿t 5 sai láº§m phá»• biáº¿n vá»›i BEM","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"}]},{"title":"Giá»›i thiá»‡u Progressive Web App","slug":"Gioi-thieu-Progressive-Web-App","date":"2018-05-18T00:30:00.000Z","updated":"2018-05-18T00:43:05.756Z","comments":true,"path":"2018/05/Gioi-thieu-Progressive-Web-App.html","link":"","permalink":"http://nthung2112.github.io/2018/05/Gioi-thieu-Progressive-Web-App.html","excerpt":"Progressive Web App (PWA) lÃ  má»™t dáº¡ng á»©ng dá»¥ng web (web app) má»›i Ä‘ang thu hÃºt ráº¥t nhiá»u sá»± quan tÃ¢m tá»« cÃ¡c nhÃ  phÃ¡t triá»ƒn web kháº¯p tháº¿ giá»›i Ä‘áº·c biá»‡t lÃ  cÃ¡c doanh nghiá»‡p hoáº¡t Ä‘á»™ng trá»±c tuyáº¿n, tuy nhiÃªn nÃ³ váº«n cÃ²n khÃ¡ má»›i máº» táº¡i Viá»‡t Nam.","text":"Progressive Web App (PWA) lÃ  má»™t dáº¡ng á»©ng dá»¥ng web (web app) má»›i Ä‘ang thu hÃºt ráº¥t nhiá»u sá»± quan tÃ¢m tá»« cÃ¡c nhÃ  phÃ¡t triá»ƒn web kháº¯p tháº¿ giá»›i Ä‘áº·c biá»‡t lÃ  cÃ¡c doanh nghiá»‡p hoáº¡t Ä‘á»™ng trá»±c tuyáº¿n, tuy nhiÃªn nÃ³ váº«n cÃ²n khÃ¡ má»›i máº» táº¡i Viá»‡t Nam.ÄÃ£ cÃ³ nhiá»u bÃ i viáº¿t liÃªn quan Ä‘áº¿n PWA dÃ nh cho láº­p trÃ¬nh viÃªn, cho nÃªn trong bÃ i viáº¿t nÃ y tÃ´i sáº½ cá»‘ gáº¯ng giáº£i thÃ­ch PWA Ä‘á»ƒ ngÆ°á»i dÃ¹ng Web phá»• thÃ´ng váº«n cÃ³ thá»ƒ hiá»ƒu. Progressive Web App lÃ  gÃ¬?PWA lÃ  á»©ng dá»¥ng web Ä‘Æ°á»£c viáº¿t Ä‘á»ƒ táº­n dá»¥ng nhá»¯ng tÃ­nh nÄƒng má»›i nháº¥t cá»§a trÃ¬nh duyá»‡t Web trÃªn mÃ¡y tÃ­nh Ä‘á»ƒ bÃ n (desktop) láº«n Ä‘iá»‡n thoáº¡i thÃ´ng minh, nhÆ°ng Ä‘á»“ng thá»i váº«n cháº¡y Ä‘Æ°á»£c trÃªn nhá»¯ng trÃ¬nh duyá»‡t vÃ  thiáº¿t bá»‹ cÅ© hÆ¡n. PWA láº¥y phÆ°Æ¡ng phÃ¡p Cáº£i Tiáº¿n TÄƒng Dáº§n (Progressive Enhancement) lÃ m cá»‘t lÃµi (nÃªn má»›i cÃ³ chá»¯ Progressive). Äá»‘i vá»›i nhá»¯ng trÃ¬nh duyá»‡t vÃ  thiáº¿t bá»‹ cÅ©, PWA hoáº¡t Ä‘á»™ng nhÆ° má»™t mobile website thÃ´ng thÆ°á»ng. NhÆ°ng vá»›i nhá»¯ng trÃ¬nh duyá»‡t trÃªn thiáº¿t bá»‹ di Ä‘á»™ng má»›i nháº¥t, PWA hoáº¡t Ä‘á»™ng nhÆ° má»™t mobile app[^1] thá»±c thá»¥. Nhá»¯ng tÃ¡c giáº£ cá»§a khÃ¡i niá»‡m PWA (Ä‘áº¿n tá»« nhÃ³m phÃ¡t triá»ƒn trÃ¬nh duyá»‡t Chrome) Ä‘Ã£ Ä‘Æ°a ra nhá»¯ng Ä‘áº·c tÃ­nh cáº§n cÃ³ cá»§a má»™t PWA nhÆ° sau: Progressive - Cháº¡y Ä‘Æ°á»£c trÃªn má»i (nÃªn hiá»ƒu: tuyá»‡t Ä‘áº¡i Ä‘a sá»‘) thiáº¿t bá»‹, do Ä‘Æ°á»£c phÃ¡t triá»ƒn vá»›i phÆ°Æ¡ng phÃ¡p Cáº£i Tiáº¿n TÄƒng Dáº§n. Responsive - CÃ³ thiáº¿t káº¿ giao diá»‡n tÃ¹y á»©ng (responsive design), hiá»ƒn thá»‹ vÃ  sá»­ dá»¥ng Ä‘Æ°á»£c trÃªn mobile, tablet, laptop hay báº¥t ká»³ cá»¡ mÃ n hÃ¬nh nÃ o trong tÆ°Æ¡ng lai. Connectivity independent - PWA váº«n cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng tá»‘t vá»›i Ä‘iá»u kiá»‡n káº¿t ná»‘i máº¡ng cháº­p chá»n hoáº·c máº¥t háº³n (offline). App-like - CÃ³ giao diá»‡n vÃ  tráº£i nghiá»‡m nhÆ° mobile app thá»±c thá»¥. Fresh - DÃ¹ nÃ³ hoáº¡t Ä‘á»™ng nhÆ° mobile app, nhÆ°ng tÃ­nh nÄƒng vÃ  giao diá»‡n luÃ´n Ä‘Æ°á»£c cáº­p nháº­t tá»©c thá»i nhá» ná»n táº£ng Web (khÃ´ng cáº§n ngÆ°á»i dÃ¹ng update tá»« Apple App Store hay Google Play - gá»i chung lÃ  app store). Safe - PWA pháº£i Ä‘Æ°á»£c táº£i thÃ´ng qua giao thá»©c TLS (hay nÃ´m na lÃ  HTTPS), Ä‘á»ƒ Ä‘áº£m báº£o viá»‡c trao Ä‘á»•i dá»¯ liá»‡u khÃ´ng bá»‹ bÃªn thá»© ba can thiá»‡p. Discoverable - ThÃ´ng qua file khai bÃ¡o chuáº©n (Ä‘Æ°á»£c thá»‘ng nháº¥t bá»Ÿi tá»• chá»©c W3C), mÃ  cÃ¡c PWA dá»… dÃ ng Ä‘Æ°á»£c cÃ¡c cá»— mÃ¡y tÃ¬m kiáº¿m Ä‘Ã¡nh dáº¥u vÃ  thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng. Re-engageable - PWA cho phÃ©p viá»‡c tÃ¡i tiáº¿p cáº­n ngÆ°á»i dÃ¹ng dá»… dÃ ng hÆ¡n nhá» nhá»¯ng tÃ­nh nÄƒng Ä‘áº·c biá»‡t nhÆ° lÃ  push notification (thÃ´ng bÃ¡o chá»§ Ä‘á»™ng). Installable - PWA cho phÃ©p ngÆ°á»i dÃ¹ng dá»… dÃ ng lÆ°u láº¡i web app trÃªn Ä‘iá»‡n thoáº¡i (thÆ°á»ng lÃ  trÃªn mÃ n hÃ¬nh home screen) mÃ  khÃ´ng cáº§n pháº£i vÃ o app store Linkable - Dá»… dÃ ng share app chá»‰ vá»›i Ä‘Æ°á»ng link vÃ  khÃ´ng cáº§n ngÆ°á»i nháº­n pháº£i cÃ i Ä‘áº·t phá»©c táº¡p chá»‰ Ä‘á»ƒ xem Ä‘Æ°á»£c ná»™i dung báº¡n muá»‘n share. Nhá»¯ng Ä‘iá»ƒm khÃ¡c biá»‡t cá»§a Progressive Web App?TrÆ°á»›c tiÃªn cáº§n hiá»ƒu ráº±ng, sá»± tiáº¿n hÃ³a cá»§a mobile web app cáº§n sá»± há»£p tÃ¡c cá»§a ráº¥t nhiá»u bÃªn liÃªn quan trong Ä‘Ã³ cÃ³ cÃ¡c nhÃ  phÃ¡t triá»ƒn trÃ¬nh duyá»‡t, há»‡ Ä‘iá»u hÃ nh di Ä‘á»™ng, vÃ  cáº£ nhá»¯ng chuyÃªn gia vá» ngÃ´n ngá»¯ láº­p trÃ¬nh cho Web. Sá»± tiáº¿n hÃ³a cá»§a mobile web thÆ°á»ng Ä‘i cÃ¹ng vá»›i sá»± phÃ¡t triá»ƒn vÃ  chuáº©n hÃ³a cá»§a ná»n táº£ng Web do tá»• chá»©c W3C[^2] chá»‹u trÃ¡ch nhiá»‡m. Khi tÃ´i tÆ° váº¥n vÃ  phÃ¡t triá»ƒn app cho khÃ¡ch hÃ ng, ráº¥t nhiá»u láº§n doanh nghiá»‡p tá»« chá»‘i lá»±a chá»n giáº£i phÃ¡p web app hoáº·c hybrid app vá»›i lÃ½ do chÃ­nh lÃ  â€œHTML5 khÃ´ng nhanh báº±ng nativeâ€. Tuy nhiÃªn Ä‘iá»u nÃ y khÃ´ng cÃ²n Ä‘Ãºng táº¡i thá»i Ä‘iá»ƒm hiá»‡n táº¡i. Nhá» nhá»¯ng cáº£i tiáº¿n cá»§a pháº§n cá»©ng thiáº¿t bá»‹, há»‡ Ä‘iá»u hÃ nh di Ä‘á»™ng, trÃ¬nh duyá»‡t, vÃ  nháº¥t lÃ  Ä‘áº·c táº£ Web trong vÃ i nÄƒm gáº§n Ä‘Ã¢y mÃ  web app Ä‘Ã£ thÃªm nhá»¯ng kháº£ nÄƒng khÃ´ng thua kÃ©m native app nhÆ°: Giao diá»‡n tÆ°Æ¡ng tÃ¡c mÆ°á»£t mÃ  hÆ¡n, Ä‘áº·t biá»‡t lÃ  há»— trá»£ Ä‘á»“ há»a 3D, animation tá»« pháº§n cá»©ng (hardware accelerated) Kháº£ nÄƒng chÆ¡i video, audio thÃ´ng qua trÃ¬nh duyá»‡t mobile Ä‘Ã£ hoÃ n thiá»‡n vÃ  Ä‘á»‹nh dáº¡ng gáº§n nhÆ° Ä‘Ã£ thá»‘ng nháº¥t. BÃ n phÃ­m áº£o thÃ­ch á»©ng vá»›i trÆ°á»ng nháº­p web form khÃ¡c nhau: email, URL, telephoneâ€¦ CÃ³ kháº£ nÄƒng truy xuáº¥t cÃ¡c sensor vÃ  bá»™ pháº­n Ä‘a phÆ°Æ¡ng tiá»‡n cá»§a thiáº¿t bá»‹: Ä‘á»‹nh vá»‹ GPS, con quay há»“i chuyá»ƒn, tráº¡ng thÃ¡i pin, network, camera, microphoneâ€¦ CÆ¡ sá»Ÿ dá»¯ liá»‡u (CSDL) táº¡i trÃ¬nh duyá»‡t cho phÃ©p tÃ¬m kiáº¿m vÃ  truy cáº­p nhanh lÆ°á»£ng dá»¯ liá»‡u lá»›n vÃ  cho phÃ©p ngÆ°á»i dÃ¹ng trá»Ÿ láº¡i trang web app nhanh hÆ¡n. Äáº·c táº£ má»›i vá» CSS cho phÃ©p designer vÃ  front end developer táº¡o giao diá»‡n tÃ¹y á»©ng (responsive design) vÃ  giao diá»‡n giá»‘ng app dá»… dÃ ng hÆ¡n. DÃ¹ váº­y, web app váº«n cÃ²n má»™t sá»‘ háº¡n cháº¿ so vá»›i native app. ChÃºng ta hÃ£y xem PWA Ä‘Ã£ Ä‘Æ°á»£c bá»• sung nhá»¯ng kháº£ nÄƒng gÃ¬ Ä‘á»ƒ cÃ³ thá»ƒ xÃ³a dáº§n khoáº£ng cÃ¡ch giá»¯a web vÃ  native: Káº¿t luáº­nÄÆ°á»£c giá»›i thiá»‡u chÃ­nh thá»©c tá»« 2015, PWA Ä‘Ã£ tráº£i qua thá»i gian thá»­ nghiá»‡m vÃ  trÆ°á»Ÿng thÃ nh Ä‘á»§ lÃ¢u Ä‘á»ƒ giá» Ä‘Ã¢y chÃºng ta cÃ³ thá»ƒ kháº³ng Ä‘á»‹nh PWA chÃ­nh lÃ  tÆ°Æ¡ng lai cá»§a Web vÃ  Web App. PWA Ä‘Ã³ng gÃ³p thÃªm má»™t giáº£i phÃ¡p á»©ng dá»¥ng di Ä‘á»™ng nhiá»u há»©a háº¹n, giáº£i phÃ³ng doanh nghiá»‡p khá»i sá»± lá»‡ thuá»™c vÃ o app store, nhá»¯ng háº¡n cháº¿ cá»§a native app. VÃ  náº¿u Ä‘Æ°á»£c thiáº¿t káº¿ há»£p lÃ½, PWA sáº½ lÃ  giáº£i phÃ¡p há»£p nháº¥t cho â€œmá»i ná»n táº£ngâ€ tá»« desktop Ä‘áº¿n mobile. Ghi chÃº:[^1]: Xin tÃ³m táº¯t láº¡i má»™t sá»‘ thuáº­t ngá»¯ vá» â€œappâ€ trÃªn thiáº¿t bá»‹ di Ä‘á»™ng: Mobile app hoáº·c native app: (á»Ÿ Viá»‡t Nam thÆ°á»ng gá»i táº¯t lÃ  â€œappâ€) lÃ  á»©ng dá»¥ng Ä‘Æ°á»£c cÃ i Ä‘áº·t tá»« app store, Ä‘Æ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ láº­p trÃ¬nh dÃ nh riÃªng cho tá»«ng há»‡ Ä‘iá»u hÃ nh di Ä‘á»™ng khÃ¡c nhau. (Mobile) web app: lÃ  website cháº¡y trÃªn trÃ¬nh duyá»‡t cá»§a smart phone nhÆ°ng cÃ³ tráº£i nghiá»‡m giá»‘ng app vÃ  thÆ°á»ng trao Ä‘á»•i nhiá»u dá»¯ liá»‡u giá»¯a ngÆ°á»i dÃ¹ng vÃ  website. Hybrid app: lÃ  á»©ng dá»¥ng Ä‘Æ°á»£c cÃ i Ä‘áº·t tá»« app store, tuy nhiÃªn Ä‘Æ°á»£c viáº¿t báº±ng cÃ¹ng ngÃ´n ngá»¯ láº­p trÃ¬nh vá»›i web app. DÃ¹ hybrid app cÃ³ thá»ƒ cÃ i Ä‘Æ°á»£c trÃªn nhiá»u HÄH khÃ¡c nhau nhÆ°ng nÃ³ chá»‰ cáº§n Ä‘Æ°á»£c viáº¿t cÃ¹ng má»™t bá»™ mÃ£ nguá»“n vá»›i má»™t Ã­t Ä‘iá»u chá»‰nh riÃªng cho má»—i loáº¡i HÄH mÃ  nÃ³ há»— trá»£. [^2]: Tá»• chá»©c World Wide Web Consortium cÃ³ trÃ¡ch nhiá»‡m chuáº©n hÃ³a cÃ¡c Ä‘áº·c táº£ vá» Web vÃ  khuyáº¿n khÃ­ch cÃ¡c trÃ¬nh duyá»‡t khÃ¡c nhau pháº£i tuÃ¢n theo Ä‘á»ƒ cÃ¡c website hoáº¡t Ä‘á»™ng má»™t cÃ¡ch Ä‘á»“ng nháº¥t báº¥t ká»ƒ trÃ¬nh duyá»‡t dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹. [^3]: URL lÃ  Ä‘Æ°á»ng link Ä‘áº¿n má»™t trang web báº¥t ká»³ [^4]: CÃ¡c trÃ¬nh duyá»‡t phá»• biáº¿n nháº¥t bao gá»“m: Chrome, Firefox, Safari, MS Edge, Opera, Samsung Internet, UC Browser. Táº¡i Viá»‡t Nam, trÃ¬nh duyá»‡t phá»• biáº¿n thá»© 2 sau Chrome lÃ  CocCoc. Tuy nhiÃªn CocCoc cÅ©ng lÃ  má»™t trÃ¬nh duyá»‡t biáº¿n thá»ƒ tá»« mÃ£ nguá»“n má»Ÿ cá»§a Chrome nÃªn nhá»¯ng tÃ­nh nÄƒng cá»§a PWA cÅ©ng sáº½ Ä‘Æ°á»£c há»— trá»£. [^5]: NgÆ°á»i dÃ¹ng sáº½ váº«n nháº­n Ä‘Æ°á»£c push notification cho dÃ¹ há» khÃ´ng lÆ°u app vá» home screen chá»‰ cáº§n há» Ä‘Ã£ báº¥m Ä‘á»“ng Ã½ nháº­n push notification. Viá»‡c yÃªu cáº§u gá»­i push notification cáº§n tháº­n trá»ng vÃ  chá»‰ thá»±c hiá»‡n khi ngÆ°á»i dÃ¹ng Ä‘Ã£ thá»ƒ hiá»‡n sá»± quan tÃ¢m Ä‘áº¿n dá»‹ch vá»¥ cá»§a báº¡n. (Náº¿u khÃ´ng kháº£ nÄƒng ngÆ°á»i dÃ¹ng tá»« chá»‘i nháº­n push notification lÃ  ráº¥t cao)","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"pwa","slug":"pwa","permalink":"http://nthung2112.github.io/tags/pwa/"}]},{"title":"Giá»›i thiá»‡u vá» redux saga","slug":"Gioi-thieu-ve-redux-saga","date":"2018-04-30T11:37:00.000Z","updated":"2018-04-30T11:52:22.931Z","comments":true,"path":"2018/04/Gioi-thieu-ve-redux-saga.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Gioi-thieu-ve-redux-saga.html","excerpt":"Redux-Saga lÃ  gÃ¬?Redux-Saga lÃ  má»™t thÆ° viá»‡n redux middleware, giÃºp quáº£n lÃ½ nhá»¯ng side effect trong á»©ng dá»¥ng redux trá»Ÿ nÃªn Ä‘Æ¡n giáº£n hÆ¡n. Báº±ng viá»‡c sá»­ dá»¥ng tá»‘i Ä‘a tÃ­nh nÄƒng Generators (function*) cá»§a ES6, nÃ³ cho phÃ©p ta viáº¿t async code nhÃ¬n giá»‘ng nhÆ° lÃ  synchronos.","text":"Redux-Saga lÃ  gÃ¬?Redux-Saga lÃ  má»™t thÆ° viá»‡n redux middleware, giÃºp quáº£n lÃ½ nhá»¯ng side effect trong á»©ng dá»¥ng redux trá»Ÿ nÃªn Ä‘Æ¡n giáº£n hÆ¡n. Báº±ng viá»‡c sá»­ dá»¥ng tá»‘i Ä‘a tÃ­nh nÄƒng Generators (function*) cá»§a ES6, nÃ³ cho phÃ©p ta viáº¿t async code nhÃ¬n giá»‘ng nhÆ° lÃ  synchronos. Saga khÃ´ng chá»‰ tá»“n táº¡i trong tháº¿ giá»›i javascript, nÃ³ cÃ²n Ä‘Æ°á»£c coi lÃ  1 pattern. Báº¡n cÃ³ thá»ƒ xem qua vá» saga pattern báº±ng clip nÃ y: https://youtu.be/xDuwrtwYHu8 Má»™t cÃ¡ch nhÃ¬n nhanh chÃ³ng thÃ¬ Saga pattern lÃ  cÃ¡ch Ä‘á»ƒ quáº£n lÃ½ nhá»¯ng long transaction vá»›i nhá»¯ng side effect hoáº·c cÃ¡c nguy cÆ¡ tiá»m áº©n. Vá»›i má»—i transaction thÃ nh cÃ´ng, chÃºng ta Ä‘á»u cáº§n cÃ³ counter-transaction Ä‘á»ƒ revert transaction Ä‘Ã³ vá» tráº¡ng thÃ¡i ban Ä‘áº§u náº¿u gáº·p trá»¥c tráº·c. Tham kháº£o thÃªm vá» saga pattern vá»›i bÃ i viáº¿t cá»§a Roman Liutikov : Confusion about Saga pattern Side effect lÃ  gÃ¬??Ta Ä‘Ã£ biáº¿t táº¥t cáº£ nhá»¯ng xá»­ lÃ½ á»Ÿ REDUCER Ä‘á»u pháº£i lÃ  synchronous vÃ  pure tá»©c chá»‰ lÃ  xá»­ lÃ½ Ä‘á»“ng bá»™. NhÆ°ng trong á»©ng dá»¥ng thá»±c táº¿ thÃ¬ cáº§n nhiá»u hÆ¡n váº­y vÃ­ dá»¥ nhÆ° asynchronous (thá»±c hiá»‡n má»™t sá»‘ viá»‡c nhÆ° gá»i má»™t hÃ m AJAX Ä‘á»ƒ fetch dá»¯ liá»‡u vá» nhÆ°ng cáº§n Ä‘á»£i káº¿t quáº£ chá»© káº¿t quáº£ khÃ´ng tráº£ vá» ngay Ä‘Æ°á»£c) hoáº·c lÃ  impure (thá»±c hiá»‡n lÆ°u, Ä‘á»c dá»¯ liá»‡u ra bÃªn ngoÃ i nhÆ° lÆ°u dá»¯ liá»‡u ra á»• cá»©ng hay Ä‘á»c cookie tá»« trÃ¬nh duyá»‡tâ€¦ Ä‘á»u cáº§n Ä‘á»£i káº¿t quáº£). Nhá»¯ng viá»‡c nhÆ° tháº¿ trong láº­p trÃ¬nh hÃ m gá»i nÃ³ lÃ  side effects. Generator function lÃ  gÃ¬??KhÃ¡c vá»›i function bÃ¬nh thÆ°á»ng lÃ  thá»±c thi vÃ  tráº£ vá» káº¿t quáº£, thÃ¬ Generator function cÃ³ thá»ƒ thá»±c thi, táº¡m dá»«ng tráº£ vá» káº¿t quáº£ vÃ  thá»±c thi báº±ng tiáº¿p. Tá»« khÃ³a Ä‘á»ƒ lÃ m Ä‘Æ°á»£c viá»‡c Ä‘áº¥y lÃ  â€œYIELDâ€. Generator Ä‘Æ°á»£c Ä‘Æ°a ra cÃ¡ch Ä‘Ã¢y máº¥y chá»¥c nÄƒm nhÆ°ng Ä‘áº¿n ES2015 má»›i Ä‘Æ°á»£c bá»• sung, cÃ¡c ngÃ´n ngá»¯ khÃ¡c Ä‘Ã£ Ä‘Æ°á»£c bá»• sung tÃ­nh nÄƒng nÃ y nhÆ° C#, PHP, Ruby, C++, Râ€¦ Redux-Saga hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o??Äá»‘i vá»›i logic cá»§a saga, ta cung cáº¥p má»™t hÃ m cho saga, chÃ­nh hÃ m nÃ y lÃ  hÃ m Ä‘á»©ng ra xem xÃ©t cÃ¡c action trÆ°á»›c khi vÃ o store, náº¿u lÃ  action quan tÃ¢m thÃ¬ nÃ³ sáº½ thá»±c thi hÃ m sáº½ Ä‘Æ°á»£c thá»±c thi, náº¿u báº¡n biáº¿t khÃ¡i niá»‡m hook thÃ¬ hÃ m cung cáº¥p cho saga chÃ­nh lÃ  hÃ m hook. Äiá»u Ä‘áº·c biá»‡t cá»§a hÃ m hook nÃ y nÃ³ lÃ  má»™t generator function, trong generator function nÃ y cÃ³ yield vÃ  má»—i khi yield ta sáº½ tráº£ vá» má»™t plain object. Object tráº£ vá» Ä‘Ã³ Ä‘Æ°á»£c gá»i Effect object. effect object nÃ y Ä‘Æ¡n giáº£n chá»‰ lÃ  má»™t object bÃ¬nh thÆ°á»ng nhÆ°ng chá»©a thÃ´ng tin Ä‘áº·c biá»‡t dÃ¹ng Ä‘á»ƒ chá»‰ dáº«n middleware cá»§a Redux thá»±c thi cÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c vÃ­ dá»¥ nhÆ° gá»i má»™t hÃ m async khÃ¡c hay put má»™t action tá»›i store. Äá»ƒ táº¡o ra effect object Ä‘á» cáº­p á»Ÿ trÃªn thÃ¬ ta gá»i hÃ m tá»« thÆ° viá»‡n cá»§a saga lÃ  redux-saga/effects. Táº¡i sao tÃ´i pháº£i sá»­ dá»¥ng Saga??Khi báº¯t Ä‘áº§u tÃ¬m tÃ²i vá» redux, báº¡n hay tÃ¬m tháº¥y cÃ¡c bÃ i hÆ°á»›ng dáº«n sá»­ dá»¥ng redux-thunk hoáº·c redux-saga Ä‘á»ƒ quáº£n lÃ½ cÃ¡c async action. Váº­y táº¡i sao báº¡n láº¡i Ä‘Æ°á»£c khuyÃªn sá»­ dá»¥ng redux-saga ? TrÃ­ch dáº«n trong document cá»§a redux-saga: Contrary to redux thunk, you donâ€™t end up in callback hell, you can test your asynchronous flows easily and your actions stay pure. _Táº¡m dá»‹ch: trÃ¡i vá»›i redux thunk, báº¡n khÃ´ng cáº§n pháº£i phÃ¡t dá»“ lÃªn vá»›i cÃ¡c callback trong má»—i action, Ä‘áº¿n vá»›i saga Ä‘i, báº¡n cÃ³ thá»ƒ test cÃ¡c async action vá»›i má»™t quy trÃ¬nh dá»… dÃ ng mÃ  khÃ´ng lÃ m hÆ° cÃ¡c action Ä‘Ã³ ! So sÃ¡nh saga vÃ  thunk: redux-thunk 1234567891011121314151617181920212223import &#123; API_BUTTON_CLICK, API_BUTTON_CLICK_SUCCESS, API_BUTTON_CLICK_ERROR,&#125; from './actions/consts';import &#123; getDataFromAPI &#125; from './api';const getDataStarted = () =&gt; (&#123; type: API_BUTTON_CLICK &#125;);const getDataSuccess = data =&gt; (&#123; type: API_BUTTON_CLICK_SUCCESS, payload: data &#125;)const getDataError = message =&gt; (&#123; type: API_BUTTON_CLICK_ERROR. payload: message &#125;);const getDataFromAPI = () =&gt; &#123; return dispatch =&gt; &#123; dispatch(getDataStarted()); getDataFromAPI() .then(data =&gt; &#123; dispatch(getUserSuccess(data)); &#125;).fail(err =&gt; &#123; dispatch(getDataError(err.message)); &#125;) &#125;;&#125;; á» Ä‘Ã¢y ta cÃ³ má»™t action creator getDataFromAPI() báº¯t Ä‘áº§u async progress nhÆ° sau: Äáº§u tiÃªn báº¯n ra action cho phÃ©p store biáº¿t ráº±ng chuáº©n bá»‹ 1 API request ( dispatch(getDataStarted()) Tiáº¿p theo thá»±c hiá»‡n API request tráº£ vá» má»™t Promise Cuá»‘i cÃ¹ng báº¯n ra success action náº¿u request thÃ nh cÃ´ng hoáº·c error action náº¿u cÃ³ lá»—i redux-saga 12345678910111213141516171819202122import &#123; call, put, takeEvery &#125; from 'redux-saga/effects';import &#123; API_BUTTON_CLICK, API_BUTTON_CLICK_SUCCESS, API_BUTTON_CLICK_ERROR,&#125; from './actions/consts';import &#123; getDataFromAPI &#125; from './api';export function* apiSideEffect(action) &#123; try &#123; const data = yield call(getDataFromAPI); yield put(&#123; type: API_BUTTON_CLICK_SUCCESS, payload: data &#125;); &#125; catch (e) &#123; yield put(&#123; type: API_BUTTON_CLICK_ERROR, payload: e.message &#125;); &#125;&#125;// the 'watcher' - on every 'API_BUTTON_CLICK' action, run our side effectexport function* apiSaga() &#123; yield takeEvery(API_BUTTON_CLICK, apiSideEffect);&#125; CÃ¹ng má»™t process, nhÆ°ng cÃ¡ch implement khÃ¡c nhau hoÃ n toÃ n. put thay cho dispatch function cuá»‘i (apiSaga()) giÃºp theo dÃµi tá»•ng thá»ƒ toÃ n bá»™ cÃ¡c action (á»Ÿ Ä‘Ã¢y cÃ³ API_BUTTON_CLICK) Vá»›i cÃ¡ch gá»i cá»§a redux-saga, chÃºng ta cÃ³ thá»ƒ get data tá»« báº¥t kÃ¬ async function nÃ o (promise, â€¦) Nháº­n xÃ©tCáº£ 2 cÃ¡ch implement Ä‘á»u dá»… Ä‘á»c, tuy nhiÃªn Ä‘á»‘i vá»›i redux-thunk , báº¡n pháº£i Ä‘á»‘i Ä‘áº§u vá»›i má»™t tÃ¡ cÃ¡c promise, cÃ¡c callback náº¿u cÃ³, ráº¥t máº¥t thá»i gian cho ngÆ°á»i maintain Ä‘á»c vÃ  tÃ¬m code. Vá»›i redux-saga , Ä‘Æ¡n giáº£n báº¡n chá»‰ cáº§n track theo try/catch block Ä‘á»ƒ theo dÃµi dÃ²ng code, bÃªn cáº¡nh Ä‘Ã³ cÃ²n cÃ³ hÃ m giÃºp báº¡n track cÃ¡c action má»™t cÃ¡ch dá»… dÃ ng. Káº¿t luáº­ná» bÃ i viáº¿t nÃ y mÃ¬nh Ä‘á» cáº­p Ä‘áº¿n 2 Ä‘iá»ƒm nháº¥n chÃ­nh cá»§a redux-saga lÃ  giá»¯ cho action pure synchronos theo chuáº©n redux vÃ  loáº¡i bá» hoÃ n toÃ n callback theo javascript truyá»n thá»‘ng. BÃ i viáº¿t tiáº¿p theo mÃ¬nh sáº½ Ä‘á» cáº­p ná»‘t key point cuá»‘i cÃ¹ng cá»§a saga lÃ  easy to test.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"redux","slug":"redux","permalink":"http://nthung2112.github.io/tags/redux/"},{"name":"saga","slug":"saga","permalink":"http://nthung2112.github.io/tags/saga/"}]},{"title":"Thinking in React","slug":"Thinking-in-React","date":"2018-04-30T09:47:00.000Z","updated":"2018-04-30T10:03:55.328Z","comments":true,"path":"2018/04/Thinking-in-React.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Thinking-in-React.html","excerpt":"React is, in our opinion, the premier way to build big, fast Web apps with JavaScript. It has scaled very well for us at Facebook and Instagram. Má»™t trong nhá»¯ng pháº§n quan trá»ng nháº¥t cá»§a React lÃ  cÃ¡ch nÃ³ táº¡o ra cÃ¡ch nghÄ© cá»§a báº¡n vá» cÃ¡c á»©ng dá»¥ng mÃ  báº¡n xÃ¢y dá»±ng. Trong tÃ i liá»‡u nÃ y, chÃºng tÃ´i sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch Ä‘á»ƒ xÃ¢y dá»±ng má»™t á»©ng dá»¥ng tÃ¬m kiáº¿m sáº£n pháº©m trong table vá»›i React.","text":"React is, in our opinion, the premier way to build big, fast Web apps with JavaScript. It has scaled very well for us at Facebook and Instagram. Má»™t trong nhá»¯ng pháº§n quan trá»ng nháº¥t cá»§a React lÃ  cÃ¡ch nÃ³ táº¡o ra cÃ¡ch nghÄ© cá»§a báº¡n vá» cÃ¡c á»©ng dá»¥ng mÃ  báº¡n xÃ¢y dá»±ng. Trong tÃ i liá»‡u nÃ y, chÃºng tÃ´i sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch Ä‘á»ƒ xÃ¢y dá»±ng má»™t á»©ng dá»¥ng tÃ¬m kiáº¿m sáº£n pháº©m trong table vá»›i React. Báº¯t Ä‘áº§uGiáº£ dá»¥ báº¡n Ä‘Ã£ cÃ³ sáºµn má»™t JSON API vÃ  giao diá»‡n Ä‘Ã£ sáºµn sÃ ng gá»i Ä‘áº¿n nÃ³. Cá»¥ thá»ƒ nhÆ° áº£nh sau: Dá»¯ liá»‡u tráº£ vá» cÃ³ dáº¡ng nhÆ° sau: 12345678[ &#123;category: \"Sporting Goods\", price: \"$49.99\", stocked: true, name: \"Football\"&#125;, &#123;category: \"Sporting Goods\", price: \"$9.99\", stocked: true, name: \"Baseball\"&#125;, &#123;category: \"Sporting Goods\", price: \"$29.99\", stocked: false, name: \"Basketball\"&#125;, &#123;category: \"Electronics\", price: \"$99.99\", stocked: true, name: \"iPod Touch\"&#125;, &#123;category: \"Electronics\", price: \"$399.99\", stocked: false, name: \"iPhone 5\"&#125;, &#123;category: \"Electronics\", price: \"$199.99\", stocked: true, name: \"Nexus 7\"&#125;]; BÆ°á»›c 1: Chia UI thÃ nh component theo báº­cViá»‡c Ä‘áº§u tiÃªn báº¡n sáº½ pháº£i váº½ cÃ¡c há»™p xung quanh má»—i component ( vÃ  subcomponent ) vÃ  Ä‘áº·t tÃªn cho chÃºng. NhÆ°ng báº¡n phÃ¢n vÃ¢n khÃ´ng biáº¿t khi nÃ o nÃªn táº¡o ra component? Äá»‘i vá»›i component, má»™t kÄ© thuáº­t Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i Ä‘á»ƒ design component lÃ  sá»­ dá»¥ng nguyÃªn táº¯c Ä‘Æ¡n nhiá»‡m. Khi cÃ¡c component Ä‘Æ°á»£c sinh ra quÃ¡ nhiá»u, báº¡n hÃ£y tÃ¡ch chÃºng ra thÃ nh nhiá»u subcomponent. Äá»‘i vá»›i viá»‡c thuÆ°á»ng xuyÃªn hiá»ƒn thá»‹ dá»¯ liá»‡u JSON, báº¡n nÃªn Ä‘áº£m báº£o vá» tÃ­nh Ä‘Ãºng Ä‘áº¯n cá»§a model, liá»‡u ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c map chÃ­nh xÃ¡c vá»›i UI ( cÃ¡c component ) cá»§a báº¡n? Bá»Ÿi vÃ¬ UI vÃ  cÃ¡c model luÃ´n pháº£i dÃ­nh liá»n vá»›i cáº¥u trÃºc cá»§a thÃ´ng tin, cÃ³ nghÄ©a lÃ  cÃ´ng viá»‡c phÃ¢n chia UI sang component lÃ  khÃ´ng Ä‘Ã¡ng ká»ƒ. Cá»© chia ra thÃ nh cÃ¡c component vÃ  hiá»ƒn thá»‹ chÃ­nh xÃ¡c tá»«ng máº©u dá»¯ liá»‡u cá»§a báº¡n lÃ  á»•n. Äá»‘i vá»›i dá»¯ liá»‡u trong áº£nh, báº¡n sáº½ nghÄ© Ä‘áº¿n 5 component tÆ°Æ¡ng á»©ng vá»›i má»—i mÃ u pháº£i khÃ´ng? Sau Ä‘Ã¢y lÃ  chi tiáº¿t cho tá»«ng component Ä‘Ã³: FilterableProductTable (cam): chá»©a toÃ n bá»™ vÃ­ dá»¥ SearchBar (xanh): nháº­n dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng ProductTable (xanh lÃ¡ cÃ¢y): hiá»ƒn thá»‹ vÃ  lá»c dá»¯ liá»‡u dá»±a trÃªn user input ProductCategoryRow (lam): hiá»ƒn thá»‹ tiÃªu Ä‘á» cho má»—i category ProductRow (Ä‘á»): má»—i hÃ ng lÃ  1 sáº£n pháº©m Náº¿u báº¡n nhÃ¬n vÃ o ProductTable , báº¡n sáº½ tháº¥y cÃ³ header (bao gá»“m nhÃ£n â€œNameâ€ vÃ  â€œPriceâ€) khÃ´ng pháº£i lÃ  chÃ­nh component cá»§a nÃ³. ÄÃ¢y lÃ  váº¥n Ä‘á» cá»§a viá»‡c tinh chá»‰nh. VÃ­ dá»¥, chÃºng ta Ä‘á»ƒ pháº§n header thuá»™c component ProductTable vÃ¬ nÃ³ lÃ  má»™t pháº§n cá»§a viá»‡c render ra dá»¯ liá»‡u, Ä‘Ã³ lÃ  trÃ¡ch nhiá»‡m cá»§a ProductTable. Tuy nhiÃªn, náº¿u header nÃ y khi Ä‘Æ°á»£c sá»­ dá»¥ng má»™t cÃ¡ch phá»©c táº¡p (nhÆ° lÃ  tÆ°Æ¡ng tÃ¡c vá»›i sáº¯p xáº¿p), nÃ³ sáº½ pháº£i táº¡o thÃªm má»™t component riÃªng cho header gá»i lÃ  ProductTableHeader cháº³ng háº¡n. TÃ³m láº¡i, báº¡n nÃªn phÃ¢n chia cáº¥u trÃºc cá»§a component vÃ  cÃ¡c subcomponent nhÆ° sau: FilterableProductTable SearchBar ProductTable ProductCategoryRow ProductRow BÆ°á»›c 2: XÃ¡c Ä‘á»‹nh má»©c tá»‘i thiá»ƒu (nhÆ°ng hoÃ n chá»‰nh)Äá»ƒ UI cá»§a báº¡n tÆ°Æ¡ng tÃ¡c tá»‘t, báº¡n cáº§n xÃ¡c Ä‘á»‹nh cÃ¡c thay Ä‘á»•i Ä‘áº¿n dá»¯ liá»‡u thuá»™c táº§ng dÆ°á»›i (underlying data model) . HÃ£y sá»­ dá»¥ng state cá»§a React. Äáº§u tiÃªn báº¡n nÃªn nghÄ© Ä‘áº¿n viá»‡c tá»‘i giáº£n cÃ¡c mutable state. ChÃ¬a khÃ³a thÃ nh cÃ´ng á»Ÿ Ä‘Ã¢y lÃ  DRY: Donâ€™t Repeat Yourself . VÃ­ dá»¥ vá»›i á»©ng dá»¥ng TODO, báº¡n chá»‰ cáº§n giá»¯ máº£ng cÃ¡c TODO item, khÃ´ng cáº§n Ä‘áº¿n cÃ¡c state khÃ¡c nhÆ° Ä‘á»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng. Thay vÃ o Ä‘Ã³, khi báº¡n muá»‘n Ä‘áº¿m sá»‘ lÆ°á»£ng cá»§a TODO item, Ä‘Æ¡n giáº£n lÃ  láº¥y ra length cá»§a TODO item array. Cá»¥ thá»ƒ vá»›i dá»¯ liá»‡u máº«u trong bÃ i viáº¿t nÃ y, chÃºng ta cÃ³: NguyÃªn máº«u danh sÃ¡ch sáº£n pháº©m Text tÃ¬m kiáº¿m mÃ  user nháº­p vÃ o Value cá»§a checkbox Danh sÃ¡ch Ä‘Ã£ lá»c sáº£n pháº©m HÃ£y suy nghÄ© vá» viá»‡c báº¡n nÃªn Ä‘á»ƒ cÃ¡i nÃ o lÃ  state, trong thá»i gian suy nghÄ©, hÃ£y Ä‘á»c cÃ¡c cÃ¢u há»i dÆ°á»›i vá» luá»“ng data: CÃ³ thá»ƒ pass tá»« parent component thÃ´ng qua props khÃ´ng? Náº¿u cÃ³, state lÃ  khÃ´ng cáº§n thiáº¿t. NÃ³ cÃ³ giá»¯ nguyÃªn tráº¡ng thÃ¡i dá»¯ liá»‡u suá»‘t khÃ´ng? Náº¿u cÃ³, state khÃ´ng thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c. Báº¡n cÃ³ Ä‘oÃ¡n Ä‘Æ°á»£c data dá»±a vÃ o báº¥t kÃ¬ state hay props nÃ o trong component khÃ´ng? Náº¿u cÃ³, chá»— nÃ y cÃ ng khÃ´ng pháº£i chá»— cho state. Danh sÃ¡ch sáº£n pháº©m nguyÃªn báº£n Ä‘Æ°á»£c pass thÃ´ng qua props. Text tÃ¬m kiáº¿m vÃ  checkbox dÆ°á»ng nhÆ° sáº½ thÃ­ch há»£p vá»›i state vÃ¬ nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c thay Ä‘á»•i báº¥t kÃ¬ lÃºc nÃ o bá»Ÿi ngÆ°á»i dÃ¹ng. Váº­y cuá»‘i cÃ¹ng, danh sÃ¡ch lá»c sáº£n pháº©m cÅ©ng khÃ´ng thá»ƒ nÃ o lÃ  state bá»Ÿi vÃ¬ chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­nh toÃ¡n thÃ´ng qua list sáº£n pháº©m ban Ä‘áº§u dá»±a vÃ o search text vÃ  checkbox. TÃ³m láº¡i, báº¡n nÃªn sá»­ dá»¥ng state cho: Search text mÃ  user nháº­p vÃ o GiÃ¡ trá»‹ cá»§a checkbox khi user sá»­ dá»¥ng BÆ°á»›c 4: XÃ¡c Ä‘á»‹nh nÆ¡i sinh sá»‘ng cá»§a stateHÃ£y nhá»› ráº±ng, React lÃ  luá»“ng dá»¯ liá»‡u má»™t chiá»u, phá»¥ thuá»™c theo luá»“ng cá»§a cÃ¡c cáº¥p component. Báº¡n khÃ´ng thá»ƒ Ä‘oÃ¡n ngay Ä‘Æ°á»£c component nÃ y sáº½ cÃ³ nhá»¯ng state gÃ¬. ÄÃ¢y lÃ  viá»‡c chiáº¿m nhiá»u thá»i gian vÃ  cÃ´ng sá»©c nháº¥t dÃ nh cho ngÆ°á»i má»›i tÃ¬m hiá»ƒu vá» react, hÃ£y nhá»›: Ä‘á»«ng vá»™i kháº³ng Ä‘á»‹nh state A thuá»™c component A. Äá»ƒ hÃ¬nh dung ra má»™t cÃ¡ch rÃµ rÃ ng, hÃ£y theo cÃ¡c bÆ°á»›c sau: PhÃ¢n loáº¡i má»—i component sáº½ render ra nhá»¯ng gÃ¬ dá»±a vÃ o state Ä‘Ã³. TÃ¬m thá»­ trong component cha Náº¿u component cha khÃ´ng cÃ³, tÃ¬m tiáº¿p á»Ÿ component cao hÆ¡n component cha Ä‘Ã³ Náº¿u báº¡n khÃ´ng tÃ¬m ra Ä‘Æ°á»£c component Ä‘ang giá»¯ state, thá»­ táº¡o má»™t conponent má»›i Ä‘á»ƒ giá»¯ state Ä‘Ã³ vÃ  thÃªm nÃ³ á»Ÿ Ä‘Ã¢u Ä‘Ã³ trong cáº¥p thÆ° má»¥c cao hÆ¡n thÆ° má»¥c chá»©a component cha. VÃ­ dá»¥ cá»¥ thá»ƒ: ProductTable cáº§n filter sáº£n pháº©m dá»±a vÃ o state vÃ  SearchBar cáº§n pháº£i hiá»ƒn thá»‹ text Ä‘Æ°á»£c nháº­p vÃ  state cá»§a checkbox. Component cha sáº½ lÃ  FilterableProductTable Táº¥t nhiÃªn theo láº½ tá»± nhiÃªn, search text vÃ  giÃ¡ trá»‹ cá»§a checkbox sáº½ Ä‘Æ°á»£c lÆ°u á»Ÿ trong FilterableProductTable. BÆ°á»›c 5: ThÃªm luá»“ng dá»¯ liá»‡uâ€¦ VÃ  Ä‘Ã¢y lÃ  káº¿t quáº£ Káº¿tHy vá»ng ráº±ng, bÃ i viáº¿t nÃ y cho báº¡n Ã½ tÆ°á»Ÿng lÃ m tháº¿ nÃ o Ä‘á»ƒ suy nghÄ© vá» viá»‡c xÃ¢y dá»±ng cÃ¡c component vá»›i React. Máº·c dÃ¹ cÃ³ thá»ƒ khiáº¿n báº¡n gÃµ nhiá»u code hÆ¡n, hÃ£y nhá»› ráº±ng code Ä‘Æ°á»£c Ä‘á»c nhiá»u hÆ¡n nÃ³ Ä‘Æ°á»£c viáº¿t. Khi báº¡n báº¯t Ä‘áº§u xÃ¢y dá»±ng cÃ¡c thÆ° viá»‡n component lá»›n, báº¡n sáº½ Ä‘Ã¡nh giÃ¡ cao sá»± rÃµ rÃ ng vÃ  tÃ­nh mÃ´ Ä‘un, vÃ  vá»›i viá»‡c tÃ¡i sá»­ dá»¥ng code, cÃ¡c dÃ²ng code cá»§a báº¡n sáº½ báº¯t Ä‘áº§u co láº¡i.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Tá»•ng há»£p cÃ¡c cheat sheets tá»‘t nháº¥t cá»§a front-end","slug":"Tong-hop-cac-cheat-sheets-tot-nhat-cua-front-end","date":"2018-04-30T08:36:00.000Z","updated":"2018-04-30T11:52:12.794Z","comments":true,"path":"2018/04/Tong-hop-cac-cheat-sheets-tot-nhat-cua-front-end.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Tong-hop-cac-cheat-sheets-tot-nhat-cua-front-end.html","excerpt":"ChÃºng ta khÃ´ng thá»ƒ nhá»› thuá»™c lÃ²ng táº¥t cáº£ cÃ¡c API. ÄÃ¢y lÃ  lÃºc chÃºng ta cáº§n cÃ¡c trang cheat sheets nÃ y! DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c báº£n cheat sheets tá»‘t nháº¥t mÃ  tÃ´i Ä‘Ã£ thu tháº­p Ä‘Æ°á»£c.","text":"ChÃºng ta khÃ´ng thá»ƒ nhá»› thuá»™c lÃ²ng táº¥t cáº£ cÃ¡c API. ÄÃ¢y lÃ  lÃºc chÃºng ta cáº§n cÃ¡c trang cheat sheets nÃ y! DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c báº£n cheat sheets tá»‘t nháº¥t mÃ  tÃ´i Ä‘Ã£ thu tháº­p Ä‘Æ°á»£c. Javascript ES2015 features Javascript Javascript Regular expression React Redux Vuejs Vuex Angular 4 Flexbox SCSS Stylus GraphQL Missing your favorite cheatsheet? Please let me know in the comments!","categories":[],"tags":[{"name":"cheat sheets","slug":"cheat-sheets","permalink":"http://nthung2112.github.io/tags/cheat-sheets/"}]},{"title":"Táº¥t cáº£ nhá»¯ng gÃ¬ báº¡n cáº§n biáº¿t vá» CSS-in-JS","slug":"Tat-ca-nhung-gi-ban-can-biet-ve-CSS-in-JS","date":"2018-04-30T08:19:00.000Z","updated":"2018-04-30T08:31:39.212Z","comments":true,"path":"2018/04/Tat-ca-nhung-gi-ban-can-biet-ve-CSS-in-JS.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Tat-ca-nhung-gi-ban-can-biet-ve-CSS-in-JS.html","excerpt":"TL;DR:Thinking in components â€” No longer do you have to maintain bunch of style-sheets. CSS-in-JS abstracts the CSS model to the component level, rather than the document level (modularity).","text":"TL;DR:Thinking in components â€” No longer do you have to maintain bunch of style-sheets. CSS-in-JS abstracts the CSS model to the component level, rather than the document level (modularity). Styled React Component Example You probably heard terms like CSS-in-JS, Styled Components, Radium, Aphrodite and youâ€™re left there hanging â€œwhy is this a thing? â€” Iâ€™m perfectly happy with CSS-in-CSS (CSS in .css).â€ Iâ€™m here to shine some light on why this is a thing and hopefully we will least understand the concept and understand why itâ€™s a thing. With that said â€” please feel free to use CSS-in-CSS â€” on no terms are you obligated to use CSS-in-JS. Whatever works best for you and makes you happy is hands down the best solution, always-always! CSS-in-JS is a delicate and controversial topic â€” Iâ€™m advocating having an open mind and weighing if this makes sense to you â€” ask yourself â€œwill it improve my workflow?â€ â€”**in the end â€” thatâ€™s the only thing that matters â€” use tools that make you happier and more productive!** Iâ€™ve always felt awkward having to maintain a huge folder of stylesheets. I would like to try different approaches. Iâ€™ve seen many people asking if there are new styling ideas. CSS-in-JS is so far the best concept. Letâ€™s give CSS-in-JS a shot. What is CSS-in-JS? JSS is a more powerful abstraction over CSS. It uses JavaScript as a language to describe styles in a declarative and maintainable way. It is a high performance JS to CSS compiler which works at runtime and server-side. This core library is low level and framework agnostic. It is about 6KB (minified and gzipped) and is extensible via plugins API. â€” source Keep in mind Inline styles and CSS-in-JS are not the same! Theyâ€™re different â€” Quick demonstration time! How Inline Styles Works In the browser this will get attached to the DOM node like so: How CSS-in-JS works In the browser this will gets attached to the DOM like so: DifferenceSee the slight difference? CSS-in-JS attached a &lt;style&gt; tag on top of the DOM while inline styles just attached the properties to the DOM node. Why does this matter? Not all CSS features can be aliased with JavaScript event handlers , many pseudo selectors (like :disabled, :before, :nth-child) arenâ€™t possible, styling the html and body tags isnâ€™t supported etc. With CSS-in-JS, you have all the power of CSS at your fingertips. Since actual CSS is generated, you can use every media query and pseudo selector you can think of. Some libraries (like jss, styled-components) even add support for neat, non-CSS-native features like nesting! Brilliant article going in depth on how theyâ€™re different. â€œJust write the darn CSS in CSS and be done with it.â€ Yes â€” while thatâ€™s the case for how itâ€™s been done for a long-long time â€” the challenge is modern web is written in components not pages. CSS was never actually made for component based approaches. CSS-in-JS solves exactly this problem. Shout-out to Vue for solving this problem beautifully even tho Vues styles have no access to components state. What are the benefits of using CSS-in-JS? Thinking in components â€” No longer do you have to maintain bunch of style-sheets. CSS-in-JS abstracts the CSS model to the component level, rather than the document level (modularity). CSS-in-JS leverages the full power of the JavaScript ecosystem to enhance CSS. â€œTrue rules isolationâ€ â€” Scoped selectors are not enough. CSS has properties which are inherited automatically from the parent element, if not explicitly defined. Thanks to jss-isolate plugin, JSS rules will not inherit properties. Scoped selectors â€” CSS has just one global namespace. It is impossible to avoid selector collisions in non-trivial applications. Naming conventions like BEM might help within one project, but will not when integrating third-party code. JSS generates unique class names by default when it compiles JSON representation to CSS. Vendor Prefixing â€”The CSS rules are automatically vendor prefixed, so you donâ€™t have to think about it. Code sharing â€” Easily share constants and functions between JS and CSS. Only the styles which are currently in use on your screen are also in the DOM (react-jss). Dead code elimination Unit tests for CSS! What are the drawbacks of using CSS-in-JS? Learning curve. New dependencies. Harder for newer teammates to adapt to the code-base. People who are new to front-end have to learn â€œmoreâ€ things. Challenging the status quo. (not necessarily a con) The pros out-weight the cons heavily â€” letâ€™s give CSS-in-JS a shot! Nothing to lose! Most popular CSS-in-JS libariesWill provide a quick hello world example for all the popular CSS-in-JS librariesâ€” help yourself to choose which one you like the most based on the syntax. Styled Components JSS-React glamorous Radium (caveat: uses inline styles) Note: Radium uses decorators! Aphrodite Stylotron These are really simple examples which demonstrate the core functionality. All of the libraries have much more functionality included â€” for example, theming, dynamic props, server side rendering and much more! Excellent post going in depth about all of the features CSS-in-JS enables. Hereâ€™s the full list â€” go and give all the libraries a quick try! Hate it or love it â€” CSS-in-JS deserves a chance! Convinced CSS-in-JS is not for me? Thereâ€™s another option â€” CSS Modules!Thanks for reading!","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Hiá»ƒu sÃ¢u vá» React Higher Order Components","slug":"Hieu-sau-ve-React-Higher-Order-Components","date":"2018-04-30T08:08:00.000Z","updated":"2018-04-30T08:31:59.004Z","comments":true,"path":"2018/04/Hieu-sau-ve-React-Higher-Order-Components.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Hieu-sau-ve-React-Higher-Order-Components.html","excerpt":"Giá»›i thiá»‡uCháº¯c háº³n ráº¥t nhiá»u ngÆ°á»i trong chÃºng ta Ä‘Ã£ vÃ  Ä‘ang sá»­ dá»¥ng React, vÃ  táº¥t nhiÃªn lÃ  kÃ¨m theo háº±ng tÃ¡ thÆ° viá»‡n Ä‘i kÃ¨m há»— trá»£ nÃ³ (lol) VÃ  cháº¯c háº³n báº¡n Ä‘Ã£ tá»«ng gáº·p thÆ° viá»‡n yÃªu cáº§u báº¡n viáº¿t má»™t Ä‘oáº¡n code kiá»ƒu nÃ y Ä‘á»ƒ thÆ° viá»‡n cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng: 1234import &#123; connect &#125; from 'react-redux';...export default connect(mapStateToProps, mapDispatchToProps)(Component); // Káº¿t ná»‘i Component vá»›i Store cá»§a Redux báº±ng thÆ° viá»‡n react-redux","text":"Giá»›i thiá»‡uCháº¯c háº³n ráº¥t nhiá»u ngÆ°á»i trong chÃºng ta Ä‘Ã£ vÃ  Ä‘ang sá»­ dá»¥ng React, vÃ  táº¥t nhiÃªn lÃ  kÃ¨m theo háº±ng tÃ¡ thÆ° viá»‡n Ä‘i kÃ¨m há»— trá»£ nÃ³ (lol) VÃ  cháº¯c háº³n báº¡n Ä‘Ã£ tá»«ng gáº·p thÆ° viá»‡n yÃªu cáº§u báº¡n viáº¿t má»™t Ä‘oáº¡n code kiá»ƒu nÃ y Ä‘á»ƒ thÆ° viá»‡n cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng: 1234import &#123; connect &#125; from 'react-redux';...export default connect(mapStateToProps, mapDispatchToProps)(Component); // Káº¿t ná»‘i Component vá»›i Store cá»§a Redux báº±ng thÆ° viá»‡n react-redux Hoáº·c lÃ  tháº¿ nÃ y 123456var Radium = require('radium');@Radiumclass Button extends React.Component &#123;...&#125;// Radium thÆ° viá»‡n há»— trá»£ inline style cho React element VÃ  boom Component cá»§a chÃºng ta nháº­n Ä‘Æ°á»£c props, styles vÃ  tháº­m chÃ­ lÃ  render ra má»™t view khÃ¡c CÃ¡c báº¡n Ä‘Ã£ bao giá» tá»± há»i connect() @Radium kia lÃ  gÃ¬, táº¡i sao láº¡i viáº¿t nhÆ° váº­y. VÃ¢ng trong bÃ i viáº¿t nÃ y chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu vá» má»™t khÃ¡i niá»‡m nÃ¢ng cao trong React - Higher-Order Components. Higher-Order Components In a NutshellWhat are Higher-Order Components (HoCs)?Vá» báº£n cháº¥t, HoC khÃ´ng pháº£i lÃ  má»™t pháº§n cá»§a React API, nÃ³ lÃ  má»™t pattern xuáº¥t hiá»‡n tá»« nhá»¯ng thÃ nh pháº§n Ä‘áº·c tÃ­nh cá»§a React. ThÆ°á»ng Ä‘Æ°á»£c implement nhÆ° má»™t function, mÃ  vá» cÆ¡ báº£n, lÃ  má»™t class factory (vÃ¢ng, lÃ  má»™t class factory!) Higher Order Component (HoC) lÃ  má»™t function nháº­n vÃ o má»™t component vÃ  tráº£ vá» má»™t component má»›i. EnhancedComponent = higherOrderComponent(WrappedComponent); What can I do with HOCs?á» cáº¥p Ä‘á»™ cao, HoC cho phÃ©p chÃºng ta: Code reuse, logic vÃ  tá»± Ä‘á»™ng trá»«u tÆ°á»£ng hÃ³a (bootstrap abstraction) Chiáº¿m quyá»n render (Render Highjacking) Trá»«u tÆ°á»£ng hÃ³a (abstraction) vÃ  Ä‘iá»u khiá»ƒn (manipulation) State Äiá»u khiá»ƒn Props ChÃºng ta sáº½ xem chi tiáº¿t vá» nhá»¯ng má»¥c nÃ y, nhÆ°ng trÆ°á»›c tiÃªn, chÃºng ta sáº½ há»c cÃ¡ch implement HoCs bá»Ÿi vÃ¬ viá»‡c implement cho chÃºng ta tháº¥y nhá»¯ng Ä‘iá»u cÃ³ thá»ƒ vÃ  háº¡n cháº¿ mÃ  chÃºng ta thá»±c sá»± cÃ³ thá»ƒ lÃ m vá»›i HoC. HOC factory implementationsCÃ³ 2 cÃ¡ch implement HoCs thÆ°á»ng tháº¥y trong React: Props Proxy (PP) vÃ  Inheritance Inversion (II). Cáº£ 2 cÃ¡ch cho phÃ©p cÃ¡c cÃ¡ch khÃ¡c nhau Ä‘á»ƒ thao tÃ¡c vá»›i WrappedComponent. TrÆ°á»›c khi báº¯t Ä‘áº§u chÃºng ta cáº§n má»™t project 1234create-react-app learnHOCcd learnHOC/src/touch HOC.jsnpm start Props ProxyProps Proxy (PP) Ä‘Æ°á»£c implement thÃ´ng thÆ°á»ng theo cÃ¡ch sau: 1234567function pP(WrappedComponent) &#123; return class PP extends React.Component &#123; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125;/&gt; &#125; &#125;&#125; Pháº§n quan trá»ng nháº¥t á»Ÿ Ä‘Ã¢y lÃ  method render cá»§a HoC tráº£ vá» má»™t React Element cá»§a kiá»ƒu WrappedComponent. ChÃºng ta cÅ©ng truyá»n props mÃ  HoC nháº­n Ä‘Æ°á»£c, vÃ¬ tháº¿ phÆ°Æ¡ng phÃ¡p nÃ y má»›i cÃ³ tÃªn Props Proxy. What can be done with Props Proxy? Äiá»u khiá»ƒn props Truy cáº­p instance thÃ´ng qua Refs Trá»«u tÆ°á»£ng hÃ³a (Abstracting) State Bao WrappedComponent vá»›i elements khÃ¡c Äiá»u khiá»ƒn propsChÃºng ta cÃ³ thá»ƒ Ä‘á»c, thÃªm, sá»­a Ä‘á»•i vÃ  xÃ³a props Ä‘Æ°á»£c truyá»n cho WrappedComponent. NhÆ°ng cáº©n tháº­n vá»›i viá»‡c xÃ³a hay sá»­a Ä‘á»•i cÃ¡c prop quan trá»ng, chÃºng ta nÃªn Ä‘áº·t namespace cho HoC props Ä‘á»ƒ nÃ³ khÃ´ng phÃ¡ vá»¡ WrappedComponent. VÃ­ dá»¥: ThÃªm má»›i props. 123456789101112131415161718// HOC.jsimport React from 'react';function pP(WrappedComponent) &#123; return class PP extends React.Component &#123; render() &#123; const newProps = &#123; newProps: 'something news' &#125; return &lt;WrappedComponent &#123;...this.props&#125; &#123;...newProps&#125;/&gt; &#125; &#125;&#125;module.exports = &#123; pP&#125; Sá»­a láº¡i file App má»™t chÃºt 1234567891011121314// App.jsimport &#123;pP&#125; from './HoC'class App extends Component &#123; render() &#123; console.group('App'); console.log('render'); console.log(this.props); console.groupEnd(); ... &#125;&#125;export default pP(App); VÃ  á»Ÿ console chÃºng ta cÃ³ káº¿t quáº£ Truy cáº­p instance thÃ´ng qua RefsChÃºng ta cÃ³ thá»ƒ truy cáº­p this (instance cá»§a WrappedComponent) vá»›i ref, nhÆ°ng chÃºng ta sáº½ cáº§n má»™t quÃ¡ trÃ¬nh render Ä‘áº§y Ä‘á»§ cá»§a WrappedComponent Ä‘á»ƒ ref cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­nh toÃ¡n. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cáº§n tráº£ vá» WrappedComponent element tá»« method render cá»§a HoC, Ä‘á»ƒ React cÃ³ thá»ƒ lÃ m quÃ¡ trÃ¬nh Ä‘á»‘i chiáº¿u (reconciliation process) vÃ  chÃºng ta sáº½ cÃ³ ref Ä‘áº¿n WrappedComponent instance. VÃ­ dá»¥: ChÃºng ta sáº½ tÃ¬m hiá»ƒu lÃ m tháº¿ nÃ o Ä‘á»ƒ truy cáº­p instance methods vÃ  instance cá»§a chÃ­nh WrappedComponent thÃ´ng qua refs 123456789101112131415161718192021// HOC.jsfunction refsPP(WrappedComponent) &#123; return class RefsPP extends React.Component &#123; proc(wrappedComponentInstance) &#123; console.group('refs Proc'); console.log(wrappedComponentInstance); wrappedComponentInstance.test(); console.groupEnd(); &#125; render() &#123; const props = Object.assign(&#123;&#125;, this.props, &#123;ref: this.proc.bind(this)&#125;) return &lt;WrappedComponent &#123;...props&#125;/&gt; &#125; &#125;&#125;module.exports = &#123; pP, refsPP&#125; Sá»­a file App má»™t chÃºt 1234567891011import &#123;pP, refsPP&#125; from './HoC'class App extends Component &#123; test() &#123; console.log('call Test'); &#125; ..... &#125;&#125;export default refsPP(App); VÃ  á»Ÿ console chÃºng ta cÃ³ káº¿t quáº£ Khi WrappedComponent Ä‘Æ°á»£c render xong thÃ¬ ref callback sáº½ Ä‘Æ°á»£c thá»±c thi, vÃ  chÃºng ta sáº½ cÃ³ ref Ä‘áº¿n WrappedComponent instance. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»c/thÃªm cÃ¡c props vÃ  gá»i cÃ¡c instance method. Trá»«u tÆ°á»£ng hÃ³a (Abstracting) StateChÃºng ta cÃ³ thá»ƒ trá»«u tÆ°á»£ng hÃ³a state báº±ng cÃ¡ch cung cáº¥p props vÃ  callbacks cho WrappedComponent, tÆ°Æ¡ng tá»± nhÆ° Container Components lÃ m vá»›i Presentational components. VÃ­ dá»¥: ChÃºng ta sáº½ thá»±c hiá»‡n trá»«u tÆ°á»£ng hÃ³a state Ä‘á»ƒ kiá»ƒm soÃ¡t input 1234567891011121314151617181920212223242526272829303132333435// HOC.jsfunction statePP(WrappedComponent) &#123; return class StatePP extends React.Component &#123; constructor(props) &#123; super(props) this.state = &#123; fields: &#123;&#125; &#125; &#125; getField(fieldName) &#123; if (!this.state.fields[fieldName]) &#123; this.state.fields[fieldName] = &#123; value: '', onChange: event =&gt; &#123; this.state.fields[fieldName].value = event.target.value this.forceUpdate() &#125; &#125; &#125; return &#123; value: this.state.fields[fieldName].value, onChange: this.state.fields[fieldName].onChange &#125; &#125; render() &#123; const props = Object.assign(&#123;&#125;, this.props, &#123; fields: this.getField.bind(this), &#125;); return &lt;WrappedComponent &#123;...props&#125;/&gt; &#125; &#125;&#125; Sá»­a file App má»™t chÃºt 12345678910111213141516171819202122232425// App.jsimport &#123;pP, refsPP, statePP&#125; from './HoC'class App extends Component &#123; test() &#123; console.log('call Test'); &#125; render() &#123; console.group('App'); console.log('render'); console.log('name', this.props.fields('name')); console.log('email', this.props.fields('email')); console.groupEnd(); return ( &lt;div className=\"App\"&gt; .... &lt;form&gt; &lt;label&gt;Automatically controlled input!&lt;/label&gt; &lt;input type=\"text\" placeholder=\"Name\" &#123;...this.props.fields('name')&#125;/&gt; &lt;input type=\"email\" placeholder=\"Email\" &#123;...this.props.fields('email')&#125;/&gt; &lt;/form&gt; &lt;/div&gt; ); &#125;&#125; VÃ  chÃºng ta cÃ³ káº¿t quáº£ Viá»‡c trá»«u tÆ°á»£ng hÃ³a state cÃ³ nhiá»u á»©ng dá»¥ng, vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng khÃ¡ nhiá»u trong viá»‡c giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» mÃ  Stateless component gáº·p pháº£i nhÆ° khÃ´ng cÃ³ ref cháº³ng háº¡n. Bao WrappedComponent vá»›i elements khÃ¡cChÃºng ta cÃ³ thá»ƒ bao WrappedComponent vá»›i component hoáº·c element khÃ¡c Ä‘á»ƒ styling, layout hoáº·c má»¥c Ä‘Ã­ch khÃ¡c. CÃ¡ch sá»­ dá»¥ng cÆ¡ báº£n cÃ³ thá»ƒ hoÃ n thÃ nh bá»Ÿi Parent Components nhÆ°ng chÃºng ta cÃ³ nhiá»u sá»± linh hoáº¡t hÆ¡n vá»›i HoCs nhÆ° Ä‘Ã£ mÃ´ táº£ á»Ÿ trÃªn. 123456789101112// HOC.jsfunction elmWrapPP(WrappedComponent) &#123; return class ElmWrapPP extends React.Component &#123; render() &#123; return ( &lt;div style=&#123;&#123;display: 'block'&#125;&#125;&gt; &lt;WrappedComponent &#123;...this.props&#125;/&gt; &lt;/div&gt; ) &#125; &#125;&#125; Inheritance InversionInheritance Inversion (II) thÆ°á»ng Ä‘Æ°á»£c implement nhÆ° sau: 1234567function iiHOC(WrappedComponent) &#123; return class Enhancer extends WrappedComponent &#123; render() &#123; return super.render() &#125; &#125;&#125; NhÆ° cÃ¡c báº¡n tháº¥y, HOC tráº£ vá» class (Enhancer) káº¿ thá»«a (extends) WrappedComponent. PhÆ°Æ¡ng phÃ¡p nÃ y gá»i lÃ  Inheritance Inversion lÃ  do thay vÃ¬ WrappedComponent má»Ÿ rá»™ng (káº¿ thá»«a) Enhancer class nÃ o Ä‘Ã³, nÃ³ láº¡i Ä‘Æ°á»£c má»Ÿ rá»™ng (káº¿ thá»«a) bá»Ÿi Enhancer. Theo cÃ¡ch nÃ y, má»‘i quan há»‡ giá»¯a chÃºng dÆ°á»ng nhÆ° bá»‹ Ä‘áº£o ngÆ°á»£c. II cho phÃ©p HoC truy cáº­p vÃ o WrappedComponent instance thÃ´ng qua this, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  HoC cÃ³ quyá»n truy cáº­p state, props, component lifecycle hooks vÃ  cáº£ phÆ°Æ¡ng thá»©c render. ChÃºng ta sáº½ khÃ´ng Ä‘i sau vÃ o chi tiáº¿t chÃºng ta cÃ³ thá»ƒ lÃ m gÃ¬ vá»›i component lifecycle hooks, Ä‘Ã³ khÃ´ng pháº£i lÃ  nhá»¯ng gÃ¬ cá»¥ thá»ƒ HoC lÃ m, nÃ³ lÃ  React. NhÆ°ng lÆ°u Ã½ ráº±ng chÃºng ta hoÃ n toÃ n cÃ³ thá»ƒ táº¡o ra lifecycle hooks má»›i cho WrappedComponent. VÃ  nhá»› rÄƒng luÃ´n gá»i super.[lifecycleHook] Ä‘á»ƒ khÃ´ng phÃ¡ vá»¡ WrappedComponent. QuÃ¡ trÃ¬nh Ä‘á»‘i chiáº¿u (Reconciliation process)TrÆ°á»›c khi báº¯t Ä‘áº§u chÃºng ta cáº§n tÃ³m tÃ¡t vÃ i lÃ½ thuyáº¿t. React Elements mÃ´ táº£ nhá»¯ng gÃ¬ sáº½ hiá»ƒn thá»‹ khi React cháº¡y quÃ¡ trÃ¬nh Ä‘á»‘i chiáº¿u cá»§a nÃ³. React Elements cÃ³ thá»ƒ cÃ³ 2 loáº¡i: String vÃ  Function. String Type React Element (STRE) Ä‘áº¡i diá»‡n cÃ¡c DOM node vÃ  Function Type React Element (FTRE) Ä‘áº¡i diá»‡n cÃ¡c Component Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch má»Ÿ rá»™ng React.Component. Äá»c thÃªm táº¡i post. FTRE sáº½ Ä‘Æ°á»£c phÃ¢n giáº£i ra thÃ nh cÃ¢y STRE trong quÃ¡ trÃ¬nh Ä‘á»‘i chiáº¿u cá»§a React (káº¿t quáº£ cuá»‘i cÃ¹ng luÃ´n lÃ  cÃ¡c DOM Element). Äiá»u nÃ y ráº¥t quan trá»ng vÃ  nÃ³ cÃ³ nghÄ©a lÃ : Inheritance Inversion High Order Components khÃ´ng Ä‘áº£m báº£o lÃ  Ä‘Ã£ giáº£i quyáº¿t Ä‘Æ°á»£c toÃ n bá»™ cÃ¢y con. Äiá»u nÃ y sáº½ Ä‘Æ°á»£c chá»©ng thá»±c khi há»c Render Highjacking. What can you do with Inheritance Inversion? Chiáº¿m quyá»n render (Render Highjacking) Äiá»u khiá»ƒn state (Manipulating state) Render HighjackingPhÆ°Æ¡ng phÃ¡p nÃ y gá»i lÃ  Render Highjacking bá»Ÿi vÃ¬ HoC kiá»ƒm soÃ¡t render output cá»§a WrappedComponent vÃ  chÃºng ta cÃ³ thá»ƒ lÃ m báº¥t kÃ¬ Ä‘iá»u gÃ¬ vá»›i nÃ³. Trong Render Highjacking chÃºng ta cÃ³ thá»ƒ Äá»c, thÃªm, sá»­a, xÃ³a props trong báº¥t kÃ¬ React Elements nÃ o xuáº¥t ra bá»Ÿi render. Äá»c vÃ  sá»­a Ä‘á»•i React elements tree xuáº¥t ra bá»Ÿi render. Hiá»ƒn thá»‹ elements tree theo Ä‘iá»u kiá»‡n. Bao element tree cho má»¥c Ä‘Ã­ch styling (giá»‘ng nhÆ° Ä‘Ã£ nÃ³i á»Ÿ PP)\\ Note: render Ä‘á» cáº¥p Ä‘áº¿n WrappedComponent.render ChÃºng ta khÃ´ng thá»ƒ chá»‰nh sá»­a hoáº·c táº¡o props cá»§a WrappedComponent instace, bá»Ÿi vÃ¬ má»™t React Component khÃ´ng thá»ƒ chá»‰nh sá»­a props mÃ  nÃ³ nháº­n Ä‘Æ°á»£c, nhÆ°ng chÃºng ta cÃ³ thá»ƒ thay Ä‘á»•i cÃ¡c props cá»§a cÃ¡c element xuáº¥t ra tá»« phÆ°Æ¡ng thá»©c render. NhÆ° chÃºng ta Ä‘Ã£ nÃ³i á»Ÿ trÃªn, II HoCs khÃ´ng Ä‘áº£m báº£o toÃ n bá»™ cÃ¢y con Ä‘Æ°á»£c giáº£i quyáº¿t, Ä‘iá»u nÃ y hÃ m Ã½ má»™t sá»‘ giá»›i háº¡n vá»›i ká»¹ thuáº­t Render Highjacking. Quy táº¯c chung lÃ  vá»›i Render Highjacking chÃºng ta cÃ³ thá»ƒ thao tÃ¡c vá»›i element tree mÃ  WrappedComponent.render xuáº¥t ra khÃ´ng nhiá»u hÆ¡n cÅ©ng khÃ´ng Ã­t hÆ¡n. Náº¿u Element tree Ä‘Ã³ cÃ³ chÆ°a má»™t Function Type React Component thÃ¬ chÃºng ta sáº½ khÃ´ng thá»ƒ thao tÃ¡c Ä‘Æ°á»£c vá»›i cÃ¡c con cá»§a Component Ä‘Ã³. (Do chÃºng Ä‘Æ°á»£c hoÃ£n láº¡i bá»Ÿi quÃ¡ trÃ¬nh Ä‘á»‘i chiáº¿u cá»§a React cho Ä‘áº¿n khi nÃ³ thá»±c sá»± Ä‘Æ°á»£c render) VÃ­ dá»¥ 1: Render cÃ³ Ä‘iá»u kiá»‡n HOC sáº½ render chÃ­nh xÃ¡c nhá»¯ng gÃ¬ mÃ  WrappedComponent sáº½ render trá»« khi this.props.loggedIn = false. (Giáº£ Ä‘á»‹nh lÃ  HoC sáº½ nháº­n Ä‘Æ°á»£c loggedIn prop). 123456789101112// HOC.jsfunction rHII(WrappedComponent) &#123; return class Enhancer extends WrappedComponent &#123; render() &#123; if (this.props.loggedIn) &#123; return super.render() &#125; else &#123; return &lt;div&gt;Not loggedIn&lt;/div&gt; &#125; &#125; &#125;&#125; VÃ  táº¥t nhiÃªn App cá»§a chÃºng ta khÃ´ng cÃ³ props loggedIn (LÆ°á»i quÃ¡ (lol) ) nÃªn káº¿t quáº£ sáº½ lÃ  VÃ­ dá»¥ 2: Sá»­a Ä‘á»•i React Element tree xuáº¥t ra bá»Ÿi render. 1234567891011121314151617181920212223242526272829303132333435363738394041// HOC.jsfunction treeII(WrappedComponent) &#123; return class Enhancer extends WrappedComponent &#123; render() &#123; const elementsTree = super.render() let newProps = &#123;&#125;; var newChilds = elementsTree.props.children.map(function (child) &#123; if (child.type === 'input') &#123; var childNewProps = &#123;value: 'may the force be with you'&#125;; var childProps = Object.assign(&#123;&#125;, child.props, childNewProps) return React.cloneElement(child, childProps, child.props.children); &#125; return child; &#125;); const props = Object.assign(&#123;&#125;, elementsTree.props, newProps) const newElementsTree = React.cloneElement(elementsTree, props, newChilds) return newElementsTree &#125; &#125;&#125;&lt;span class=\"hljs-comment\"&gt;// App.js&lt;/span&gt;&lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;App&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;extends&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;Component&lt;/span&gt;&lt;/span&gt; &#123; render() &#123; &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; ( &lt;div className=\"App\"&gt; &lt;div className=\"App-header\"&gt; &lt;img src=&#123;logo&#125; className=\"App-logo\" alt=\"logo\" /&gt; &lt;h2&gt;Welcome to React&lt;/h2&gt; &lt;/div&gt; &lt;p className=\"App-intro\" ref=\"appIntro\"&gt; To get started, edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload. &lt;/p&gt; &lt;input type=\"text\" placeholder=\"Name\"/&gt; &lt;/div&gt; ); &#125;&#125; export default treeII(App); Trong vÃ­ dá»¥ trÃªn, náº¿u output render bá»Ÿi WrappedComponent cÃ³ chá»©a element con cÃ³ type lÃ  `inputâ€™ thÃ¬ HoC sáº½ thay Ä‘á»•i value cá»§a nÃ³ thÃ nh â€˜may the force be with youâ€™. ChÃºng ta cÃ³ thá»ƒ lÃ m má»i thá»© á»Ÿ Ä‘Ã¢y, chÃºng ta cÃ³ thá»ƒ duyá»‡t qua toÃ n bá»™ cÃ¡c pháº§n tá»­ cá»§a element tree vÃ  thay Ä‘á»•i báº¥t kÃ¬ props cá»§a báº¥t kÃ¬ element nÃ o trong tree. VÃ  Ä‘Ã¢y chÃ­nh xÃ¡c lÃ  nhá»¯ng gÃ¬ Radium thá»±c hiá»‡n. Note: ChÃºng ta khÃ´ng thá»ƒ Render Highjack vá»›i Props Proxy. Máº·c dÃ¹ váº«n cÃ³ thá»ƒ truy cáº­p vÃ o phÆ°Æ¡ng thá»©c render thÃ´ng qua WrappedComponent.prototype.render, chÃºng ta sáº½ cáº§n pháº£i mÃ´ phá»ng WrappedComponent instance vÃ  cÃ¡c props cá»§a nÃ³, vÃ  cÃ³ kháº£ nÄƒng lÃ  pháº£i tá»± xá»­ lÃ½ component lifecycle thay vÃ¬ Ä‘á»ƒ React lÃ m nÃ³. Trong thá»±c nghiá»‡m cá»§a tÃ´i, nÃ³ khÃ´ng cÃ³ giÃ¡ trá»‹ nhiá»u láº¯m vÃ  náº¿u chÃºng ta muá»‘n Render Highjacking chÃºng ta nÃªn sá»­ dá»¥ng II thay vÃ¬ PP. HÃ£y nhá»› ráº±ng React xá»­ lÃ½ cÃ¡c component instances ná»™i bá»™ vÃ  cÃ¡ch duy nháº¥t Ä‘á»ƒ chÃºng ta thao tÃ¡c vá»›i instances lÃ  thÃ´ng qua refs. Manipulating stateHOC cÃ³ thá»ƒ Ä‘á»c, chá»‰nh sá»­a vÃ  xÃ³a state cá»§a WrappedComponent instance, vÃ  chÃºng ta cÅ©ng cÃ³ thá»ƒ thÃªm state náº¿u cáº§n. HÃ£y nhá»› ráº±ng chÃºng ta Ä‘ang lÃ m rá»‘i state cá»§a WrappedComponent, Ä‘iá»u cÃ³ thá»ƒ dáº«n chÃºng ta Ä‘áº¿n viá»‡c há»§y hoáº¡i má»i thá»©. Háº§u háº¿t cÃ¡c HOC nÃªn Ä‘Æ°á»£c giá»›i háº¡n Ä‘á»ƒ Ä‘á»c hoáº·c thÃªm state, vÃ  sau Ä‘Ã³ Ä‘Æ°á»£c Ä‘áº·t tÃªn (namespace) Ä‘á»ƒ khÃ´ng lÃ m rá»‘i state cá»§a WrappedComponent. VÃ­ dá»¥: Debugging báº±ng cÃ¡ch truy cáº­p props vÃ  state cá»§a WrappedComponent 1234567891011121314function IIHOCDEBUGGER(WrappedComponent) &#123; return class II extends WrappedComponent &#123; render() &#123; return ( &lt;div&gt; &lt;h2&gt;HOC Debugger Component&lt;/h2&gt; &lt;p&gt;Props&lt;/p&gt; &lt;pre&gt;&#123;JSON.stringify(this.props, null, 2)&#125;&lt;/pre&gt; &lt;p&gt;State&lt;/p&gt;&lt;pre&gt;&#123;JSON.stringify(this.state, null, 2)&#125;&lt;/pre&gt; &#123;super.render()&#125; &lt;/div&gt; ) &#125; &#125;&#125; HOC nÃ y sáº½ bao WrappedComponent vá»›i element khÃ¡c Ä‘á»“ng thá»i hiá»‡n cÃ¡c props vÃ  state cá»§a WrappedComponent. NamingKhi bao má»™t component vá»›i HOC chÃºng ta Ä‘Ã¡nh máº¥t tÃªn cá»§a WrappedComponent, Ä‘iá»u nÃ y sáº½ áº£nh hÆ°á»Ÿng Ä‘áº¿n chÃºng ta trong quÃ¡ trÃ¬nh dev vÃ  debugging. Má»i ngÆ°á»i thÆ°á»ng lÃ m lÃ  tÃ¹y chá»‰nh tÃªn cá»§a HOC báº±ng cÃ¡ch láº¥y tÃªn cá»§a WrappedComponent vÃ  Ä‘áº·t trÆ°á»›c má»™t cÃ¡i gÃ¬ Ä‘Ã³. DÆ°á»›i Ä‘Ã¢y trÃ­ch tá»« React-Redux: 123456HOC.displayName = `HOC($&#123;getDisplayName(WrappedComponent)&#125;)`//orclass HOC extends ... &#123; static displayName = `HOC($&#123;getDisplayName(WrappedComponent)&#125;)` ...&#125; Function getDisplayName Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau 12345function getDisplayName(WrappedComponent) &#123; return WrappedComponent.displayName || WrappedComponent.name || â€˜Componentâ€™&#125; ChÃºng ta thá»±c sá»± khÃ´ng pháº£i viáº¿t láº¡i nÃ³ vÃ¬ thÆ° viá»‡n recompose Ä‘Ã£ cung cáº¥p function nÃ y rá»“i. Phá»¥ lá»¥cHOC and parametersÄÃ´i khi ráº¥t há»¯u Ã­ch khi sá»­ dá»¥ng cÃ¡c parameters cho HOCs. Äiá»u nÃ y áº©n trong nhá»¯ng vÃ­ dá»¥ bÃªn trÃªn vÃ  nÃªn Ä‘Æ°á»£c phÃ¡t triá»ƒn tá»± nhiÃªn Ä‘áº¿n Javascript developers trung gian, nhÆ°ng vÃ¬ lá»£i Ã­ch lÃ m cho bÃ i viáº¿t Ä‘áº§y Ä‘á»§, chÃºng ta sáº½ lÆ°á»›t qua nÃ³ má»™t cÃ¡ch nhanh chÃ³ng. VÃ­ dá»¥: HOC parameters vá»›i Props Proxy thÃ´ng thÆ°á»ng. Äiá»u quan trá»ng lÃ  HOCFactoryFactory function. 12345678910function HOCFactoryFactory(...params)&#123; // do something with params return function HOCFactory(WrappedComponent) &#123; return class HOC extends React.Component &#123; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125;/&gt; &#125; &#125; &#125;&#125; VÃ  chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng nhÆ° tháº¿ nÃ y 1234HOCFactoryFactory(params)(WrappedComponent)//or@HOCFatoryFactory(params)class WrappedComponent extends React.Component&#123;&#125; Difference with Parent ComponentsNhÆ° Ä‘Ã£ nÃ³i á»Ÿ pháº§n â€˜Bao WrappedComponent vá»›i elements khÃ¡câ€™, á»Ÿ má»™t sá»‘ cÃ¡ch cÆ¡ báº£n cáº£u HOC ta cÃ³ thá»ƒ hoÃ n thÃ nh vá»›i Parent Component. Váº­y Ä‘iá»ƒm khÃ¡c biá»‡t giá»¯ HOC vÃ  Parent Component lÃ  gÃ¬? Parent Components lÃ  React Components cÃ³ vÃ i components con. React cÃ³ APIs Ä‘á»ƒ truy cáº­p vÃ  thao tÃ¡c vá»›i component con. VÃ­ dá»¥: 123456789101112class Parent extends React.Component &#123; render() &#123; return ( &lt;div&gt; &#123;this.props.children&#125; &lt;/div&gt; ) &#125; &#125;&#125;render((&lt;Parent&gt;&#123;children&#125;&lt;/Parent&gt; ), mountNode); Giá» chÃºng ta sáº½ duyá»‡t qua xem Parent Components cÃ³ vÃ  khÃ´ng thá»ƒ lÃ m gÃ¬ khi so sÃ¡nh vá»›i HOCs vÃ  thÃªm vÃ i thÃ´ng tin quan trá»ng: CÃ³ thá»ƒ Render Highjacking tÆ°Æ¡ng tá»± nhÆ° vá»›i II HOC CÃ³ thá»ƒ Ä‘iá»u khiá»ƒn inner props tÆ°Æ¡ng tá»± nhÆ° vá»›i II HOC CÃ³ thá»ƒ trá»«u tÆ°á»£ng hÃ³a state, nhÆ°ng cÃ³ nhÆ°á»£c Ä‘iá»ƒm. ChÃºng ta sáº½ khÃ´ng thá»ƒ truy cáº­p state cá»§a Parent Component tá»« bÃªn ngoÃ i trá»« khi chÃºng ta táº¡o hooks cho nÃ³. Äiá»u nÃ y háº¡n cháº¿ tÃ­nh há»¯u Ã­ch cá»§a nÃ³. Bao cÃ¡c elements vá»›i elements khÃ¡c. ÄÃ¢y cÃ³ thá»ƒ lÃ  trÆ°á»ng há»£p duy nháº¥t Parent component lÃ m tá»‘t hÆ¡n HOC. NhÆ°ng táº¥t nhiÃªn lÃ  HOC cÅ©ng lÃ m Ä‘c. Thao tÃ¡c vá»›i child component gáº·p má»™t sá»‘ váº¥n Ä‘á». VÃ­ dá»¥ náº¿u childrent khÃ´ng chá»‰ cÃ³ 1 root element (nhiá»u hÆ¡n 1 first level childrent), thÃ¬ chÃºng ta pháº£i thÃªm 1 element Ä‘á»ƒ bao táº¥t cáº£ children láº¡i, mÃ  Ä‘iá»u nÃ y cÃ³ thá»ƒ gÃ¢y rÆ°á»m ra cho markup cá»§a chÃºng ta. Trong HOCs 1 top level children root Ä‘Æ°á»£c Ä‘áº£m báº£o bá»Ÿi React/JSX. Parent Components cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng tá»± do trong Elements tree, chÃºng khÃ´ng bá»‹ háº¡n cháº¿ 1 Component 1 láº§n nhÆ° HOC. NÃ³i chung, náº¿u chÃºng ta cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c nÃ³ vá»›i Parent Components thÃ¬ chÃºng ta nÃªn lÃ m nÃ³, bá»Ÿi vÃ¬ Parent Components Ã­t â€œhack nÃ£oâ€ hÆ¡n HOCs, nhÆ°ng nhÆ° nhá»¯ng Ä‘iá»u Ä‘Ã£ nÃ³i, vá»›i State nÃ³ kÃ©m linh hoáº¡t hÆ¡n so vá»›i HoCs. ConclusionHi vá»ng lÃ  sau khi Ä‘á»c bÃ i nÃ y, má»i ngÆ°á»i sáº½ hiá»ƒu hÆ¡n má»™t chÃºt vá» React HOCs. ChÃºng thá»±c sá»± cÃ³ Ã½ nghÄ©a vÃ  Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh khÃ¡ tá»‘t trong nhiá»u thÆ° viá»‡n khÃ¡c nhau. React mang láº¡i ráº¥t nhiá»u sá»± Ä‘á»•i má»›i vÃ  nhá»¯ng thÆ° viá»‡n nhÆ° Radium, React-Redux, React-Router trong sá»‘ ráº¥t nhiá»u thÆ° viá»‡n khÃ¡c lÃ  nhá»¯ng báº±ng chá»©ng vá» Ä‘iá»u Ä‘Ã³.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"hoc","slug":"hoc","permalink":"http://nthung2112.github.io/tags/hoc/"}]},{"title":"CÃ¡ch phÃ¢n nhÃ¡nh vÃ  chia viá»‡c trong nhÃ³m vá»›i Git","slug":"Cach-phan-nhanh-va-chia-viec-trong-nhom-voi-Git","date":"2018-04-26T14:50:00.000Z","updated":"2018-04-30T08:06:42.792Z","comments":true,"path":"2018/04/Cach-phan-nhanh-va-chia-viec-trong-nhom-voi-Git.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Cach-phan-nhanh-va-chia-viec-trong-nhom-voi-Git.html","excerpt":"Báº¡n vá»‘n lÃ m viá»‡c má»™t mÃ¬nh má»™t cÃµi, â€œtháº§u nguyÃªn conâ€ dá»± Ã¡n. DÃ¹ pháº£i code sáº¥p máº·t nhÆ°ng cuá»™c Ä‘á»i váº«n tháº­t Ãªm xuÃ´i: tá»‘c Ä‘á»™ tháº§n thÃ¡nh 500 dÃ²ng/giá», commit code má»›i páº·c páº·c vÃ o master, cuá»‘i ngÃ y chá»‰ viá»‡c git push, táº¯t mÃ¡y, rá»“i dáº¯t gáº¥u Ä‘i nháº­u (hoáº·c lá»™i suá»‘i bÄƒng Ä‘Ã¨o vá» nhÃ  thay tÃ£ cho con). Ngá» Ä‘Ã¢u sáº¿p (hoáº·c co-founder) xÃ³t thÆ°Æ¡ng báº¡n váº¥t váº£, bÃ¨n tuyá»ƒn ngay 2 em Ä‘Ã o nhÃ­ vÃ o trá»£ giÃºp. VÃ  má»i chuyá»‡n báº¯t Ä‘áº§u phá»©c táº¡p tá»« Ä‘Ã¢y: code trong team bá»‹ chá»“ng chÃ©o vÃ  xung Ä‘á»™t liÃªn tá»¥c, branch master Ä‘ang tháº³ng thá»›m Ä‘áº¹p xinh bá»—ng phÃ¢n nhÃ¡nh nhÆ° Ä‘iÃªn, tá»‘c Ä‘á»™ code cá»§a báº¡n giáº£m trong khi tá»‘c Ä‘á»™ chá»­i thá» ngÃ y má»™t tÄƒng nhanh. Báº¡n khÃ´ng cÃ²n thá»i giá» dáº¯t gáº¥u Ä‘i nháº­u, cÅ©ng khÃ´ng thá»ƒ lá»™i ká»‹p vá» nhÃ  thay tÃ£ cho con ná»¯a. Cuá»™c Ä‘á»i báº¿ táº¯c.","text":"Báº¡n vá»‘n lÃ m viá»‡c má»™t mÃ¬nh má»™t cÃµi, â€œtháº§u nguyÃªn conâ€ dá»± Ã¡n. DÃ¹ pháº£i code sáº¥p máº·t nhÆ°ng cuá»™c Ä‘á»i váº«n tháº­t Ãªm xuÃ´i: tá»‘c Ä‘á»™ tháº§n thÃ¡nh 500 dÃ²ng/giá», commit code má»›i páº·c páº·c vÃ o master, cuá»‘i ngÃ y chá»‰ viá»‡c git push, táº¯t mÃ¡y, rá»“i dáº¯t gáº¥u Ä‘i nháº­u (hoáº·c lá»™i suá»‘i bÄƒng Ä‘Ã¨o vá» nhÃ  thay tÃ£ cho con). Ngá» Ä‘Ã¢u sáº¿p (hoáº·c co-founder) xÃ³t thÆ°Æ¡ng báº¡n váº¥t váº£, bÃ¨n tuyá»ƒn ngay 2 em Ä‘Ã o nhÃ­ vÃ o trá»£ giÃºp. VÃ  má»i chuyá»‡n báº¯t Ä‘áº§u phá»©c táº¡p tá»« Ä‘Ã¢y: code trong team bá»‹ chá»“ng chÃ©o vÃ  xung Ä‘á»™t liÃªn tá»¥c, branch master Ä‘ang tháº³ng thá»›m Ä‘áº¹p xinh bá»—ng phÃ¢n nhÃ¡nh nhÆ° Ä‘iÃªn, tá»‘c Ä‘á»™ code cá»§a báº¡n giáº£m trong khi tá»‘c Ä‘á»™ chá»­i thá» ngÃ y má»™t tÄƒng nhanh. Báº¡n khÃ´ng cÃ²n thá»i giá» dáº¯t gáº¥u Ä‘i nháº­u, cÅ©ng khÃ´ng thá»ƒ lá»™i ká»‹p vá» nhÃ  thay tÃ£ cho con ná»¯a. Cuá»™c Ä‘á»i báº¿ táº¯c. ThÃ´i Ä‘á»«ng vá»™i láº­t bÃ n quÃ½nh cáº£ sáº¿p láº«n Ä‘Ã o. HÃ£y thá»­ lÃ m theo má»™t sá»‘ quy Æ°á»›c sau Ä‘Ã¢y, Ä‘áº£m báº£o team dev nho nhá» xinh xinh cá»§a báº¡n sáº½ khÃ´ng cÃ²n â€œgiáº«m chÃ¢nâ€ nhau ná»¯a. CÃ´ng viá»‡c xuÃ´i buá»“m mÃ¡t mÃ¡i, tÃ¬nh Ä‘á»“ng nghiá»‡p sáº½ láº¡i thÆ°Æ¡ng máº¿n thÆ°Æ¡ng nÃ¨. Váº­y, váº¥n Ä‘á» chÃ­nh á»Ÿ Ä‘Ã¢y lÃ  gÃ¬?KhÃ´ng cÃ³ gÃ¬ nghiÃªm trá»ng cáº£, chá»‰ lÃ  chÃºng ta chÆ°a cÃ³ má»™t quy Æ°á»›c phÃ¢n chia nhÃ¡nh (branch) há»£p lÃ½ thÃ´i. So vá»›i cÃ¡c chÆ°Æ¡ng trÃ¬nh quáº£n lÃ½ phiÃªn báº£n khÃ¡c nhÆ° SVN, kháº£ nÄƒng phÃ¢n nhÃ¡nh cá»§a Git pháº£i nÃ³i lÃ  siÃªu nháº¹ vÃ  cá»±c kÃ¬ dá»… dÃ ng. Do Ä‘Ã³, báº¡n cÃ³ thá»ƒ chia dá»± Ã¡n thÃ nh 2 nhÃ¡nh chÃ­nh: master dev NhÃ¡nh master sáº½ lÃ  nÆ¡i chá»©a pháº§n code á»•n Ä‘á»‹nh nháº¥t, sáºµn sÃ ng Ä‘á»ƒ triá»ƒn khai báº¥t cá»© lÃºc nÃ o. Trong khi Ä‘Ã³, nhÃ¡nh dev ban Ä‘áº§u Ä‘Æ°á»£c tÃ¡ch ra tá»« master, vÃ  sáº½ chá»©a pháº§n code má»›i nháº¥t Ä‘Æ°á»£c phÃ¡t triá»ƒn. NÃ³i nhá»: Má»™t sá»‘ tÃ i liá»‡u sáº½ Ä‘áº·t tÃªn nhÃ¡nh tÃ¡ch ra lÃ  develop. TÃ¹y báº¡n chá»n tÃªn gÃ¬ cÅ©ng Ä‘Æ°á»£c, nhÆ°ng theo Ehkoo thÃ¬ gÃµ dev nhanh hÆ¡n gÃµ develop :p Nháº¯c bÃ i chÃºt xÃ­uÄá»ƒ táº¡o nhÃ¡nh má»›i trong Git, báº¡n dÃ¹ng lá»‡nh: 1git checkout -b &lt;tÃªn nhÃ¡nh má»›i&gt; [nhÃ¡nh gá»‘c] Cháº³ng háº¡n, Ä‘á»ƒ táº¡o nhÃ¡nh dev tá»« master, báº¡n gÃµ git checkout -b dev master. Náº¿u khÃ´ng cung cáº¥p tham sá»‘ [nhÃ¡nh gá»‘c], nhÃ¡nh má»›i táº¡o sáº½ dá»±a trÃªn nhÃ¡nh hiá»‡n táº¡i báº¡n Ä‘ang á»Ÿ. Äá»ƒ xem nhÃ¡nh hiá»‡n táº¡i lÃ  nhÃ¡nh nÃ o, báº¡n cÃ³ thá»ƒ dÃ¹ng lá»‡nh git branch. 123456$ git branch auth* auth-session dev graphql master Trong vÃ­ dá»¥ trÃªn thÃ¬ nhÃ¡nh hiá»‡n táº¡i chÃ­nh lÃ  auth-session. PhÃ¢n chia cÃ´ng viá»‡cMá»—i khi phÃ¡t triá»ƒn tÃ­nh nÄƒng má»›i, báº¡n sáº½ táº¡o má»™t nhÃ¡nh tá»« dev. 1git checkout -b login dev Äáº·t tÃªn nhÃ¡nh lÃ  gÃ¬ Ä‘Ã¢y?TÃ¹y báº¡n thÃ´i. Má»™t sá»‘ tÃ i liá»‡u sáº½ khuyáº¿n khÃ­ch báº¡n dÃ¹ng tiá»n tá»‘ feature/&lt;tÃªn tÃ­nh nÄƒng&gt; Ä‘á»ƒ dá»… phÃ¢n biá»‡t. NhÆ°ng theo kinh nghiá»‡m cá»§a Ehkoo, ngoÃ i nhÃ¡nh master, dev, vÃ  cÃ¡c nhÃ¡nh fix-xxx, thÃ¬ táº¥t cáº£ cÃ¡c nhÃ¡nh cÃ²n láº¡i Ä‘á»u cÃ³ thá»ƒ ngáº§m hiá»ƒu lÃ  nhÃ¡nh chá»©c nÄƒng. NhÃ¡nh nÃ y dÆ°á»›i quyá»n cai quáº£n cá»§a báº¡n, nÃªn máº·c sá»©c muá»‘n lÃ m gÃ¬ thÃ¬ lÃ m nhÃ©. HÃ£y commit thÆ°á»ng xuyÃªn, dÃ¹ chá»‰ lÃ  nhá»¯ng thay Ä‘á»•i nhá» nháº¥t. CÅ©ng Ä‘á»«ng ngáº§n ngáº¡i ráº±ng commit nhá» sáº½ khiáº¿n git log khÃ³ theo dÃµi. ChÃºng ta sáº½ cÃ³ cÃ¡ch xá»­ lÃ½ chÃºng sau. CÃ¢u há»i: ÃŠ, lá»¡ nhÆ° cÃ³ hai hay nhiá»u ngÆ°á»i cÃ¹ng lÃ m chung má»™t tÃ­nh nÄƒng thÃ¬ sao?Náº¿u váº­y, báº¡n cÃ³ thá»ƒ tiáº¿p tá»¥c chia nhá» hÆ¡n ná»¯a, Ä‘á»ƒ Ä‘áº£m báº£o má»—i ngÆ°á»i lÃ m viá»‡c trÃªn má»™t nhÃ¡nh Ä‘á»™c láº­p. CÅ©ng theo kinh nghiá»‡m riÃªng cá»§a Ehkoo, thÃ¬ má»™t tÃ­nh nÄƒng _to_ sáº½ cÃ³ nhiá»u nháº¥t lÃ  2-3 ngÆ°á»i cÃ¹ng phÃ¡t triá»ƒn. Náº¿u vÆ°á»£t quÃ¡ con sá»‘ nÃ y, thÃ¬ nÃªn xem láº¡i Ä‘á»‹nh nghÄ©a vÃ  cÃ¡ch phÃ¢n chia viá»‡c cho tÃ­nh nÄƒng Ä‘Ã³. Chuáº©n bá»‹ merge vÃ o devSau khi code hoÃ n táº¥t vÃ  táº¥t cáº£ unit tests Ä‘Ã£ cháº¡y thÃ nh cÃ´ng, giá» lÃ  lÃºc báº¡n merge/gá»­i code Ä‘á»ƒ review tÃ­nh nÄƒng má»›i vÃ o dev. ThÃ´ng thÆ°á»ng, sáº½ cÃ³ 2 trÆ°á»ng há»£p xáº£y ra: TrÆ°á»ng há»£p 1: KhÃ´ng cÃ³ gÃ¬ má»›i trong dev Giáº£ sá»­ lÃºc Ä‘Ã³ Git history cá»§a dá»± Ã¡n giá»‘ng nhÆ° tháº¿ nÃ y: NhÆ° báº¡n tháº¥y, nhÃ¡nh login mÃ u vÃ ng Ä‘Æ°á»£c ráº½ ra tá»« nhÃ¡nh dev mÃ u xanh, vÃ  trong nhÃ¡nh dev khÃ´ng cÃ³ code gÃ¬ má»›i. ÄÃ¢y lÃ  trÆ°á»ng há»£p lÃ½ tÆ°á»Ÿng, Ä‘áº£m báº£o khi merge vÃ o dev chÃºng ta sáº½ khÃ´ng bá»‹ xung Ä‘á»™t code. TrÆ°á»ng há»£p 2: CÃ³ commits má»›i trong nhÃ¡nh dev Trong trÆ°á»ng há»£p nÃ y, branch dev (mÃ u xanh) Ä‘ang cÃ³ 2 commits phÃ­a trÆ°á»›c branch login (mÃ u vÃ ng). Náº¿u trong 2 commits Ä‘Ã³ cÃ³ chá»©a thay Ä‘á»•i liÃªn quan Ä‘áº¿n dev, cháº³ng háº¡n nhÆ° package.json, thÃ¬ kháº£ nÄƒng cao lÃ  sáº½ xáº£y ra xung Ä‘á»™t khi merge trá»±c tiáº¿p login vÃ o. MÃ  dÃ¹ cÃ³ may máº¯n khÃ´ng xáº£y ra xung Ä‘á»™t code, thÃ¬ merge vÃ o cÅ©ng sáº½ lÃ m history xáº¥u Ä‘i. Do Ä‘Ã³, chÃºng ta sáº½ cáº§n sá»­a láº¡i history cá»§a nhÃ¡nh login báº±ng cÃ¡ch dÃ¹ng git rebase. git rebase lÃ  gÃ¬?git rebase sáº½ Ä‘em nhá»¯ng commits bÃªn trong nhÃ¡nh login vÃ  Ã¡p dá»¥ng láº¡i vÃ o sau commit má»›i nháº¥t trong nhÃ¡nh dev. CÃº phÃ¡p cá»§a lá»‡nh nÃ y lÃ : 1git rebase &lt;tÃªn nhÃ¡nh muá»‘n Ã¡p dá»¥ng láº¡i&gt; Trong trÆ°á»ng há»£p hiá»‡n táº¡i, chÃºng ta sáº½ cháº¡y nhá»¯ng lá»‡nh sau: 1234567# Cáº­p nháº­t repo hiá»‡n táº¡i, Ä‘á»“ng thá»i láº¥y vá» commits má»›i nháº¥t cá»§a `dev`git pull# Chuyá»ƒn qua nhÃ¡nh `login`, cÃ³ thá»ƒ bá» qua bÆ°á»›c nÃ y náº¿u báº¡n cháº¯c cháº¯n# mÃ¬nh Ä‘ang á»Ÿ `login`git checkout login# Tiáº¿n hÃ nh rebasegit rebase dev Náº¿u xáº£y ra xung Ä‘á»™t code, báº¡n cÃ³ thá»ƒ phÃ¡t hiá»‡n vÃ  giáº£i quyáº¿t chÃºng sá»›m. NguyÃªn táº¯c chung lÃ  khÃ´ng sá»­a code cá»§a ngÆ°á»i khÃ¡c, vÃ  chá»‰ káº¿t há»£p thÃªm nhá»¯ng gÃ¬ báº¡n lÃ m. Viá»‡c thá»±c hiá»‡n rebase táº¡i nhÃ¡nh chá»©c nÄƒng do báº¡n phá»¥ trÃ¡ch giÃºp giáº£m thiá»ƒu kháº£ nÄƒng máº¥t code, vÃ¬ báº¡n lÃ  ngÆ°á»i hiá»ƒu rÃµ nháº¥t pháº§n code báº¡n viáº¿t. Sau khi giáº£i quyáº¿t háº¿t cÃ¡c xung Ä‘á»™t trong code, báº¡n cháº¡y git rebase â€“continue Ä‘á»ƒ tiáº¿p tá»¥c tiáº¿n trÃ¬nh rebase. Báº¡n cÅ©ng cÃ³ thá»ƒ cháº¡y git rebase â€“abort Ä‘á»ƒ há»§y bá» rebase vÃ  Ä‘Æ°a nhÃ¡nh login vá» láº¡i tráº¡ng thÃ¡i ban Ä‘áº§u. MÃ¡ch nhá»:Má»™t cÃ¡ch giÃºp cho viá»‡c giáº£i quyáº¿t xung Ä‘á»™t trong code dá»… dÃ ng hÆ¡n lÃ  dÃ¹ng git mergetool. CÃ³ ráº¥t nhiá»u cÃ´ng cá»¥ há»— trá»£, vÃ  Meld lÃ  má»™t trong sá»‘ Ä‘Ã³. Náº¿u chÆ°a quen rebase, báº¡n cÃ³ thá»ƒ táº¡o má»™t branch má»›i tá»« login, vÃ­ dá»¥: git checkout -b test login, vÃ  tiáº¿n hÃ nh rebase trÃªn branch nÃ y. Sau khi cháº¯c cháº¯n lÃ  má»i thá»© á»•n thá»a, báº¡n cÃ³ thá»ƒ quay láº¡i vÃ  tiáº¿n hÃ nh rebase cho login. Khi rebase xong, mong lÃ  history cá»§a báº¡n trÃ´ng sáº½ giá»‘ng nhÆ° tháº¿ nÃ y: Báº¡n tháº¥y quen khÃ´ng? ChÃ­nh lÃ  trÆ°á»ng há»£p 1 Ä‘Ã£ nÃ³i á»Ÿ trÃªn Ä‘Ã³. rebase interactivelyá» pháº§n trÃªn, chÃºng ta cÃ³ bÄƒn khoÄƒn lÃ  commit thÆ°á»ng xuyÃªn dá»… táº¡o ra nhiá»u commit nhá» Ä‘Ã´i khi khÃ´ng cáº§n thiáº¿t. Báº¡n cÃ³ thá»ƒ dÃ¹ng git rebase Ä‘á»ƒ dá»n dáº¹p chÃºng báº±ng cÃ¡ch thÃªm tham sá»‘ -i (interactively) nhÆ° sau: 1234# Cháº¯c cháº¯n ráº±ng báº¡n Ä‘ang á»Ÿ nhÃ¡nh `login`git checkout login# Rebase lÃªn dev interactivelygit rebase dev -i Báº¡n sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n má»™t giao diá»‡n tÆ°Æ¡ng tá»± nhÆ° bÃªn dÆ°á»›i. 12345678910pick ff80e85 A way to organize routes per modulepick 67cf18d Try Netlify Functionspick 5546901 Add Dashboard viewpick 2a66ae3 Change layoutpick 58755b4 Add Books module, 404 page.pick fd79cb9 Refactor. Reduce inline styling.pick c671f60 Restyling 404 page.pick 33ef874 Basic layout for book management page.pick 49c423a Clean up UI a bitpick 3aa2840 Init Theo lÃ½ thuyáº¿t, rebase sáº½ Ä‘em tá»«ng commit vÃ  Ã¡p dá»¥ng láº¡i theo thá»© tá»± tá»« trÃªn xuá»‘ng dÆ°á»›i. Bá»Ÿi váº­y, báº¡n cÃ³ thá»ƒ thoáº£i mÃ¡i sáº¯p xáº¿p láº¡i thá»© tá»± cá»§a cÃ¡c commits trÃªn. Báº¡n Ä‘á»ƒ Ã½ lá»‡nh pick á»Ÿ phÃ­a trÆ°á»›c má»—i commit. Lá»‡nh nÃ y sáº½ bÃ¡o cho git biáº¿t hÃ nh Ä‘á»™ng báº¡n muá»‘n lÃ m vá»›i commit, trong trÆ°á»ng há»£p nÃ y lÃ  Ã¡p dá»¥ng láº¡i commit. NgoÃ i pick (p), chÃºng ta cÃ²n cÃ³: reword (r): Ã¡p dá»¥ng láº¡i commit, vÃ  sá»­a commit message edit (e): Ã¡p dá»¥ng commit, nhÆ°ng dá»«ng quÃ¡ trÃ¬nh rebase láº¡i Ä‘á»ƒ sá»­a code squash (s): káº¿t há»£p commit hiá»‡n táº¡i vÃ o commit trÆ°á»›c nÃ³ fixup (f): giá»‘ng nhÆ° squash nhÆ°ng bá» Ä‘i commit message exec (x): cháº¡y má»™t lá»‡nh shell nÃ o Ä‘Ã³ drop (d): bá», khÃ´ng sá»­ dá»¥ng commit nÃ y Báº±ng cÃ¡ch dÃ¹ng rebase interactively, chÃºng ta cÃ³ thÃªm nhiá»u quyá»n Ä‘á»ƒ quáº£n lÃ½ vÃ  sá»­a Ä‘á»•i commits theo Ã½ mÃ¬nh, lÃ m cho history sáº¡ch Ä‘áº¹p hÆ¡n. Merge vÃ o devSau khi dá»n dáº¹p nhÃ¡nh login sáº¡ch Ä‘áº¹p, chÃºng ta cÃ³ thá»ƒ merge nhÃ¡nh nÃ y vÃ o dev. ThÃ´ng thÆ°á»ng, báº¡n â€“ dev cá»©ng nháº¥t team â€“ sáº½ lÃ  ngÆ°á»i tiáº¿n hÃ nh kiá»ƒm tra vÃ  merge. Báº¡n cÃ³ thá»ƒ chá»n hai cÃ¡ch tiáº¿p cáº­n: mergeBáº¡n cÃ³ thá»ƒ merge trá»±c tiáº¿p vÃ o dev nhÆ° tháº¿ nÃ y: 1234# Chuyá»ƒn qua nhÃ¡nh `dev`git checkout dev# Merge `login` vÃ o `dev`git merge login Káº¿t quáº£ sáº½ lÃ : NhÆ° báº¡n tháº¥y, má»™t commit má»›i Ä‘Æ°á»£c táº¡o ra, giÃºp báº¡n dá»… dÃ ng nháº­n biáº¿t thá»i Ä‘iá»ƒm nhÃ¡nh login Ä‘Æ°á»£c merge vÃ o. CÃ¡ch thá»©c nÃ y gá»i lÃ  merge fast-forward. Khi dá»± Ã¡n phÃ¡t triá»ƒn dáº§n theo thá»i gian, history cá»§a dev sáº½ nhÆ° tháº¿ nÃ y. BÃªn cáº¡nh Ä‘Ã³, chÃºng ta cÅ©ng cÃ³ cÃ¡ch merge non-fast-forward: 1git merge login --no-ff VÃ  Ä‘Ã¢y lÃ  káº¿t quáº£: Táº¥t cáº£ commits cá»§a login Ä‘Ã£ Ä‘Æ°á»£c káº¿t há»£p vÃ o dev. Boom! login biáº¿n máº¥t khá»i tháº¿ gian nhÆ° chÆ°a há» tá»“n táº¡i. SAD! Lá»£i Ã­ch dá»… tháº¥y nháº¥t cá»§a merge non-fast-forward lÃ  giÃºp cho history cá»§a báº¡n tháº³ng thá»›m gá»n gÃ ng, cÃ²n báº¥t lá»£i lÃ  báº¡n khÃ´ng phÃ¢n biá»‡t Ä‘Æ°á»£c commits nÃ o lÃ  cá»§a nhÃ¡nh tÃ­nh nÄƒng, cÅ©ng nhÆ° thá»i Ä‘iá»ƒm merge diá»…n ra. Trong trÆ°á»ng há»£p nhÃ¡nh tÃ­nh nÄƒng cÃ³ quÃ¡ nhiá»u commits nhá» vÃ  dÆ° thá»«a, cháº³ng háº¡n nhÆ° nhá»¯ng commits sá»­a lá»—i chÃ­nh táº£, cáº­p nháº­t thÆ° viá»‡nâ€¦, history cá»§a báº¡n sáº½ bá»‹ nhiá»…u. rebase, squash vÃ  mergeNgoÃ i cÃ¡ch merge cÃ¡c commits cá»§a nhÃ¡nh tÃ­nh nÄƒng vÃ o dev, báº¡n cÃ³ thá»ƒ rebase vÃ  squash táº¥t cáº£ commits láº¡i lÃ m má»™t, sau Ä‘Ã³ tiáº¿n hÃ nh merge. CÃ¡ch lÃ m nÃ y giÃºp cho dev luÃ´n á»Ÿ tráº¡ng thÃ¡i gá»n gÃ ng nháº¥t, khÃ´ng chá»©a commit dÆ° thá»«a. Trong trÆ°á»ng há»£p lÃ½ tÆ°á»Ÿng, history cá»§a dev sáº½ giá»‘ng nhÆ° sau: Äá»ƒ cÃ¡ch lÃ m nÃ y phÃ¡t huy tá»‘i Ä‘a hiá»‡u quáº£, yÃªu cáº§u commit message pháº£i Ä‘Æ°á»£c viáº¿t tháº­t rÃµ rÃ ng vÃ  chi tiáº¿t. Merge vÃ o masterYay! Sau má»™t thá»i gian quáº±n quáº¡i, cuá»‘i cÃ¹ng team cá»§a báº¡n Ä‘Ã£ ra Ä‘Æ°á»£c sáº£n pháº©m tÆ°Æ¡ng Ä‘á»‘i á»•n. Giá» lÃ  lÃºc merge vÃ o master vÃ  triá»ƒn khai lÃªn server. LÃºc nÃ y, cÅ©ng nhÆ° khi merge vÃ o dev, báº¡n cÃ³ thá»ƒ chá»n merge (fast-forward hoáº·c non-fast-forward) hay rebase, squash vÃ  merge, nhÆ°ng theo kinh nghiá»‡m cá»§a Ehkoo, merge â€“no-ff sáº½ lÃ  lá»±a chá»n tá»‘t nháº¥t, giÃºp cho master vÃ  dev luÃ´n song song vá»›i nhau. HotfixHÃ´m nay, thá»© 6, ngÃ y 1X. Báº¡n cháº¡y npm run build rá»“i rsync code á»Ÿ master lÃªn server. Má»i thá»© hoÃ n toÃ n bÃ¬nh thÆ°á»ng. Báº¡n vÃ o website, click vÃ i cÃ¡i. â€œNgon, cháº¡y rá»“iâ€, báº¡n tháº§m nghÄ©, â€œÄ‘i nháº­u thoy!â€ NhÆ°ng vá»«a vÆ°Æ¡n vai Ä‘á»‹nh gá»i Ä‘iá»‡n cho gáº¥u, thÃ¬ â€œÃ³ e Ã² eâ€, chuÃ´ng Ä‘iá»‡n thoáº¡i reng, sá»‘ mÃ¡y cá»§a sáº¿p. â€œHÃ­ hÃ­, cháº¯c Ä‘Æ°á»£c thÆ°á»Ÿng nÃ³ng chÄƒng?â€ Báº¡n báº¯t mÃ¡y, vÃ  nghe giá»ng sáº¿p Ã¢u yáº¿m Gáº¦M á»Ÿ Ä‘áº§u dÃ¢y: â€œLá»–I Rá»’I MÃÃÃ!!!â€ Xin Ä‘á»«ng trá»¥y tim. HÃ£y hÃ­t má»™t hÆ¡i tháº­t sÃ¢u, rá»“i bÃ¬nh tÄ©nh táº¡o má»™t branch má»›i tá»« master, fix-xxx cháº³ng háº¡n. Nhá» láº¯ng nghe tiáº¿ng sáº¿p gáº§m, báº¡n Ä‘Ã£ mau chÃ³ng mÃ² ra lá»—i trong Ä‘á»‘ng code (vÃ¬ báº¡n lÃ  dev cá»©ng mÃ  hihi). Báº¡n kháº½ rá»§a tháº§m ku Ä‘Ã o nhÃ­ viáº¿t code khÃ´ng kÄ©, tá»± rá»§a nháº¹ báº£n thÃ¢n vÃ¬ review sÃ³t. NhÆ°ng thÃ´i ká»‡, fix nhanh rá»“i cÃ²n vá», káº»o gáº¥u xÃ© xÃ¡c T^T. Báº¡n bÃ¨n merge â€“no-ff nhÃ¡nh fix-xxx vÃ o cáº£ hai nhÃ¡nh master vÃ  dev. Báº±ng cÃ¡ch nÃ y, pháº§n sá»­a lá»—i sáº½ xuáº¥t hiá»‡n á»Ÿ cáº£ hai branches, giÃºp history khÃ´ng bá»‹ ráº½ nhÃ¡nh báº¥t ngá». Báº¡n push, vÃ  chuÃ´ng Ä‘iá»‡n thoáº¡i láº¡i vang lÃªnâ€¦ VÃ i váº¥n Ä‘á» linh tinh khÃ¡cCÃ³ cáº§n nhÃ¡nh staging khÃ´ng?Trong má»™t sá»‘ dá»± Ã¡n, ngoÃ i dev, cÃ²n cÃ³ má»™t Ä‘á»™i ngÅ© â€œtháº§n bÃ­â€ Ä‘Æ°á»£c gá»i lÃ  QA/QC. Há» Ä‘Æ°á»£c sinh ra trong team lÃ  Ä‘á»ƒ bá»›i lá»—i cá»§a anh em nhÃ  dev, nÃªn quan há»‡ Ä‘Ã´i bÃªn khÃ´ng Ä‘Æ°á»£c tÃ¬nh thÆ°Æ¡ng máº¿n thÆ°Æ¡ng cho láº¯m. Dáº§u váº­y, há» váº«n cáº§n má»™t nhÃ¡nh riÃªng cÃ³ tÃªn gá»i staging. NhÃ¡nh nÃ y sáº½ chá»©a pháº§n code á»Ÿ giá»¯a master vÃ  dev. staging Ä‘Æ°á»£c tÃ¡ch ra tá»« dev, cÃ³ nhiá»u tÃ­nh nÄƒng hÆ¡n master, vÃ  tÆ°Æ¡ng Ä‘á»‘i á»•n Ä‘á»‹nh Ä‘á»ƒ cÃ³ thá»ƒ merge vÃ o master. TÃ¹y vÃ o tÃ¬nh hÃ¬nh cá»¥ thá»ƒ cá»§a team mÃ  báº¡n quyáº¿t Ä‘á»‹nh cÃ³ cáº§n staging hay khÃ´ng. Viáº¿t commit message nhÆ° tháº¿ nÃ o cho chuáº©n?Náº¿u báº¡n theo chuáº©n rebase, squash vÃ  merge thÃ¬ chuyá»‡n viáº¿t commit message tá»‘t ráº¥t quan trá»ng, vÃ¬ nÃ³ sáº½ lÃ  tÃ i liá»‡u Ä‘á»ƒ mÃ´ táº£ toÃ n bá»™ má»™t tÃ­nh nÄƒng. NhÆ°ng nÃªn viáº¿t tháº¿ nÃ o? CÃ³ má»™t vÃ i gá»£i Ã½ cho báº¡n Ä‘Ã¢y: DÃ²ng Ä‘áº§u tiÃªn khÃ´ng dÃ i quÃ¡ 80 chá»¯, luÃ´n báº¯t Ä‘áº§u báº±ng Ä‘á»™ng tá»« á»Ÿ thÃ¬ hiá»‡n táº¡i, ngáº¯n gá»n sÃºc tÃ­ch, vÃ­ dá»¥: Add module Authentication. Báº¡n cÃ³ thá»ƒ chá»n thÃªm tiá»n tá»‘ náº¿u cáº§n thiáº¿t, cháº³ng háº¡n: Feature: Add module Authentication hay Fix: unable to get location params from URL Bá» trá»‘ng hai dÃ²ng Sau Ä‘Ã³ mÃ´ táº£ chi tiáº¿t vá» tÃ­nh nÄƒng Ä‘ang lÃ m, nhá»¯ng Ä‘iá»ƒm cáº§n lÆ°u Ã½, pháº§n nÃ o cá»§a tÃ­nh nÄƒng cáº§n Ä‘Æ°á»£c cáº£i thiá»‡nâ€¦ Khuyáº¿n khÃ­ch báº¡n kÃ¨m theo chá»¯ kÃ½ signature khi commit báº±ng git commit -s Má»™t vÃ­ dá»¥ 1234567891011121314151617Feature: Add module AuthenticationSigned-off-by: Long Dep Trai &lt;long@ehkoo.com&gt;This module allows users to register/login into our website usingAWS Cognito account. Added routes:* /auth/register* /auth/loginUsers after registration will receive a SMS to confirm their account.TODO:* Implement social identities* Add Logout feature* Add Forgot password feature Tiáº¿ng Anh hay tiáº¿ng Viá»‡t?TÃ¹y thuá»™c vÃ o team cá»§a báº¡n, nhÆ°ng pháº£i thá»‘ng nháº¥t trong toÃ n dá»± Ã¡n, vÃ  viáº¿t tiáº¿ng Viá»‡t thÃ¬ nhá»› Ä‘á»«ng sai chÃ­nh táº£ káº»o bá»‹ cÃ´ng an báº¯t nhÃ©. CÃ³ nÃªn tag version hay khÃ´ng?CÃ¢u tráº£ lá»i lÃ  HÃŠN XUI, tÃ¹y tÃ­nh cháº¥t tá»«ng team. Náº¿u táº§n suáº¥t triá»ƒn khai code tá»« master cá»§a team khÃ´ng cao, khoáº£ng vÃ i thÃ¡ng/láº§n thÃ¬ tag version lÃ  cÃ¡ch tá»‘t Ä‘á»ƒ theo dÃµi nhá»¯ng thay Ä‘á»•i. Hoáº·c náº¿u báº¡n Ä‘ang xÃ¢y dá»±ng lib hoáº·c lÃ m viá»‡c open source. CÃ²n náº¿u team báº¡n theo chuáº©n â€œmove fast, break thingsâ€, thÃ¬ cÃ³ láº½ khÃ´ng cáº§n tag version Ä‘Ã¢u. ThÃªm ná»¯a, Ä‘á»ƒ tag version phÃ¡t huy hiá»‡u quáº£ tá»‘i Ä‘a, thÃ¬ CHANGELOG cáº§n pháº£i Ä‘Æ°á»£c viáº¿t ká»¹ cÃ ng. Äá»“ng thá»i, Ä‘á»«ng quÃªn tag version theo semver nhÃ©. Káº¿t luáº­nChÃºng ta cÃ³ thá»ƒ tÃ³m táº¯t bÃ i nÃ y láº¡i nhÆ° sau: Dá»± Ã¡n Ä‘Æ°á»£c chia thÃ nh nhiá»u nhÃ¡nh, bao gá»“m master, dev vÃ  cÃ³ thá»ƒ cÃ³ staging CÃ¡c nhÃ¡nh tÃ­nh nÄƒng Ä‘Æ°á»£c chia ra tá»« dev, phÃ¡t triá»ƒn Ä‘á»™c láº­p, Ä‘Æ°á»£c rebase trÆ°á»›c khi merge láº¡i vÃ o dev Rebase cÃ³ thá»ƒ thay Ä‘á»•i má»™t chÃºt history, hoáº·c squash láº¡i thÃ nh má»™t commit duy nháº¥t Merge cÃ³ thá»ƒ lÃ  fast-forward hoáº·c non-fast-forward dev sáº½ Ä‘Æ°á»£c merge vÃ o master má»—i khi triá»ƒn khai. TrÆ°á»ng há»£p cÃ³ staging, dev sáº½ Ä‘Æ°á»£c merge vÃ o staging, vÃ  staging sáº½ Ä‘Æ°á»£c merge vÃ o master. CÃ¡c nhÃ¡nh hotfix sáº½ Ä‘Æ°á»£c chia ra tá»« master, sau Ä‘Ã³ merge â€“no-ff vÃ o master vÃ  dev DÄ© nhiÃªn bÃ i viáº¿t nÃ y chá»‰ mang tÃ­nh tham kháº£o, vÃ¬ má»—i team má»—i cÃ´ng ty sáº½ cÃ³ nhá»¯ng cÃ¡ch lÃ m riÃªng. Tuy nhiÃªn, náº¿u báº¡n khÃ´ng may lÃ¢m vÃ o cáº£nh trÃ¡i ngang nhÆ° á»Ÿ Ä‘áº§u bÃ i, thÃ¬ Ä‘Ã¢y lÃ  má»™t workflow ráº¥t nÃªn nghiÃªn cá»©u vÃ  Ã¡p dá»¥ng. Mong ráº±ng trong tÆ°Æ¡ng lai, dá»± Ã¡n cá»§a báº¡n sáº½ khÃ´ng trá»Ÿ thÃ nh â€œkim tá»± thÃ¡pâ€ nhÆ° hÃ¬nh dÆ°á»›i Ä‘Ã¢y.","categories":[],"tags":[{"name":"git","slug":"git","permalink":"http://nthung2112.github.io/tags/git/"}]},{"title":"TÃ¬m hiá»ƒu vá» má»™t sá»‘ khÃ¡i niá»‡m trong Git","slug":"Tim-hieu-ve-mot-so-khai-niem-trong-Git","date":"2018-04-26T07:39:00.000Z","updated":"2018-04-30T08:06:42.823Z","comments":true,"path":"2018/04/Tim-hieu-ve-mot-so-khai-niem-trong-Git.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Tim-hieu-ve-mot-so-khai-niem-trong-Git.html","excerpt":"Giá»›i thiá»‡uÄá»‘i vá»›i cÃ¡c láº­p trÃ¬nh viÃªn, viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ quáº£n lÃ½ phiÃªn báº£n git lÃ  Ä‘iá»u khÃ´ng thá»ƒ thiá»ƒu trong cÃ´ng viá»‡c háº±ng ngÃ y vÃ  lÃ  má»™t trong nhá»¯ng kÄ© nÄƒng cÆ¡ báº£n nháº¥t mÃ  ai cÅ©ng cáº§n cÃ³ Ä‘Æ°á»£c. Git cÃ³ ráº¥t nhiá»u cÃ¡c khÃ¡i niá»‡m khÃ¡c nhau nÃªn náº¿u báº¡n chá»‰ lÃ  ngÆ°á»i má»›i lÃ m quen vá»›i git thÃ¬ Ä‘Ã¢y chÃ­nh lÃ  bÃ i viáº¿t dÃ nh cho báº¡n. BÃ i viáº¿t sáº½ giáº£i thÃ­ch táº¡i sao chÃºng ta nÃªn sá»­ dá»¥ng git cÅ©ng nhÆ° má»™t sá»‘ khÃ¡i niá»‡m thÆ°á»ng gáº·p khi sá»­ dá»¥ng git.","text":"Giá»›i thiá»‡uÄá»‘i vá»›i cÃ¡c láº­p trÃ¬nh viÃªn, viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ quáº£n lÃ½ phiÃªn báº£n git lÃ  Ä‘iá»u khÃ´ng thá»ƒ thiá»ƒu trong cÃ´ng viá»‡c háº±ng ngÃ y vÃ  lÃ  má»™t trong nhá»¯ng kÄ© nÄƒng cÆ¡ báº£n nháº¥t mÃ  ai cÅ©ng cáº§n cÃ³ Ä‘Æ°á»£c. Git cÃ³ ráº¥t nhiá»u cÃ¡c khÃ¡i niá»‡m khÃ¡c nhau nÃªn náº¿u báº¡n chá»‰ lÃ  ngÆ°á»i má»›i lÃ m quen vá»›i git thÃ¬ Ä‘Ã¢y chÃ­nh lÃ  bÃ i viáº¿t dÃ nh cho báº¡n. BÃ i viáº¿t sáº½ giáº£i thÃ­ch táº¡i sao chÃºng ta nÃªn sá»­ dá»¥ng git cÅ©ng nhÆ° má»™t sá»‘ khÃ¡i niá»‡m thÆ°á»ng gáº·p khi sá»­ dá»¥ng git. Táº¡i sao cáº§n sá»­ dá»¥ng git? Thá»­ tÆ°á»Ÿng tÆ°á»£ng khi lÃ m má»™t project vÃ  báº¡n muá»‘n bá»• sung hoáº·c lÃ m thÃªm tÃ­nh nÄƒng má»›i cho project cá»§a mÃ¬nh. Tuy nhiÃªn Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng báº¡n cÃ³ thá»ƒ quay láº¡i sá»­ dá»¥ng pháº§n code trÆ°á»›c Ä‘Ã³ báº¡n Ä‘Ã£ code trong trÆ°á»ng há»£p tÃ­nh nÄƒng má»›i gÃ¢y lá»—i vÃ  báº¡n khÃ´ng nhá»› pháº£i xÃ³a nhá»¯ng gÃ¬ Ä‘á»ƒ khÃ´i phá»¥c láº¡i tráº¡ng thÃ¡i code trÆ°á»›c Ä‘Ã³ thÃ¬ báº¡n cáº§n pháº£i thá»±c hiá»‡n copy toÃ n bá»™ project Ä‘Ã³ vÃ  paste ra Ä‘Ã¢u Ä‘Ã³ Ä‘á»ƒ lÆ°u trá»¯ rá»“i má»›i báº¯t Ä‘áº§u thá»±c hiá»‡n code tÃ­nh nÄƒng má»›i. NhÆ° váº­y má»—i láº§n muá»‘n lÃ m tÃ­nh nÄƒng má»›i, báº¡n pháº£i láº·p Ä‘i láº·p láº¡i thao tÃ¡c trÃªn vÃ  ráº¥t máº¥t thá»i gian. Sá»­ dá»¥ng Git cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y chá»‰ trong 1 vÃ i dÃ²ng lá»‡nh Náº¿u project báº¡n Ä‘ang lÃ m cÃ³ 2 thÃ nh viÃªn cÃ¹ng lÃ m, má»—i láº§n má»™t ngÆ°á»i hoÃ n thÃ nh má»™t tÃ­nh nÄƒng láº¡i pháº£i gá»­i toÃ n bá»™ source code Ä‘Ã³ thÃ´ng qua usb, google driver hoáº·c cÃ´ng cá»¥ lÆ°u trá»¯ online nÃ o Ä‘Ã³ cho thÃ nh viÃªn cÃ²n láº¡i cÃ³ thá»ƒ download vá» vÃ  paste Ä‘Ã¨ láº¡i lÃªn pháº§n code cá»§a ngÆ°á»i Ä‘Ã³. CÃ´ng viá»‡c nÃ y cÅ©ng máº¥t ráº¥t nhiá»u thá»i gian vÃ  tá»“n táº¡i nhiá»u rá»§i rÃµ khi paste code chá»“ng lÃªn nhau. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, ta cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng git vÃ  má»™t remote repository CÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n trong git1. Repository lÃ  gÃ¬? Khi sá»­ dá»¥ng git, lá»‡nh Ä‘áº§u tiÃªn mÃ  chÃºng ta thÆ°á»ng gÃµ: 1$ git init Lá»‡nh nÃ y sáº½ táº¡o ra má»™t thÆ° má»¥c áº©n cÃ³ tÃªn .git vÃ  Ä‘Ã¢y chÃ­nh lÃ  repository (hay kho chá»©a). CÃ²n pháº§n code hay hay thÆ° má»¥c cá»§a project náº±m cÃ¹ng vá»›i thÆ° má»¥c .git Ä‘Æ°á»£c gá»i lÃ  Working Directory. Git sá»­ dá»¥ng repository nÃ y Ä‘á»ƒ lÆ°u trá»¯, giÃ¡m sÃ¡t toÃ n bá»™ thÃ´ng tin vá» cÃ¡c tráº¡ng thÃ¡i cá»§a vÃ  báº¥t cá»© thay Ä‘á»•i nÃ o vá»›i project lÃºc nÃ y sáº½ Ä‘Æ°á»£c git lÆ°u trá»¯ láº¡i. CÃ³ hai loáº¡i repository gá»“m local repository - lÃ  repository náº±m trÃªn chÃ­nh mÃ¡y tÃ­nh cá»§a chÃºng ta vÃ  remote repository - lÃ  repository náº±m trÃªn má»™t mÃ¡y chá»§ tá»« xa Ä‘Æ°á»£c cung cáº¥p bá»Ÿi cÃ¡c nhÃ  phÃ¢n phá»‘i nhÆ° Github, Gitlab hay Bitbucket, â€¦ 2. Branch lÃ  gÃ¬? NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn vá» váº¥n Ä‘á» khi ta muá»‘n thÃªm má»™t tÃ­nh nÄƒng má»›i mÃ  Ä‘áº£m báº£o váº«n cÃ³ thá»ƒ dá»… dÃ ng khÃ´i phá»¥c láº¡i tráº¡ng thÃ¡i trÆ°á»›c Ä‘Ã³ thÃ¬ ta cÃ³ thá»ƒ sá»­ táº¡o 1 branch má»›i nhau sau: 1$ git branch &lt;tÃªn-branch&gt; hoáº·c 1$ git checkout -b &lt;tÃªn-branch&gt; Branch máº·c Ä‘á»‹nh lÃ  master Branch má»›i Ä‘Æ°á»£c táº¡o ra sáº½ chá»©a toÃ n bá»™ tráº¡ng thÃ¡i vÃ  nhá»¯ng thay Ä‘á»•i Ä‘Ã£ thá»±c hiá»‡n trÃªn project trÆ°á»›c khi Ä‘Æ°á»£c táº¡o Vá»›i má»—i repository ta cÃ³ thá»ƒ táº¡o nhiá»u branch khÃ¡c nhau vÃ  cÃ¡c nhÃ¡nh nÃ y lÃ  Ä‘á»™c láº­p vá»›i nhau nÃªn khi ta cÃ³ thay Ä‘á»•i Ä‘á»‘i vá»›i project trÃªn branch nÃ y sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c branch khÃ¡c Khi tÃ­nh nÄƒng Ä‘Æ°á»£c ta thá»­ nghiá»‡m trÃªn nhÃ¡nh má»›i hoÃ n thiá»‡n vÃ  Ä‘Ã£ Ä‘Æ°á»£c kiá»ƒm tra Ä‘áº§y Ä‘á»§, ta cÃ³ thá»ƒ tiáº¿n hÃ nh há»£p nháº¥t 2 nhÃ¡nh vá»›i nhau (Ä‘Æ°a nhá»¯ng thay Ä‘á»•i cá»§a nhÃ¡nh nÃ y gá»™p vÃ o vá»›i nhÃ¡nh khÃ¡c) CÃ³ hai loáº¡i branch lÃ  local branch - lÃ  branch náº±m trÃªn mÃ¡y tÃ­nh cá»§a chÃºng ta vÃ  remote branch - lÃ  branch náº±m trÃªn mÃ¡y chá»§ tá»« xa 3. LÃ m tháº¿ nÃ o Ä‘á»ƒ xÃ³a má»™t branch? Trong trÆ°á»ng há»£p branch chÃºng ta táº¡o ra trÆ°á»›c Ä‘Ã³ khÃ´ng cÃ²n cáº§n thiáº¿t ná»¯a, ta cÃ³ thá»ƒ tiáº¿n hÃ nh xÃ³a chÃºng Ä‘i báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c lá»‡nh nhÆ° sau: Äá»‘i vá»›i local branch:1$ git branch -d &lt;tÃªn-branch&gt; Vá»›i cÃ¡ch xÃ³a trÃªn, náº¿u branch cáº§n xÃ³a chÆ°a Ä‘Æ°á»£c gá»™p thay Ä‘á»•i vá»›i branch khÃ¡c sáº½ láº­p tá»©c bÃ¡o lá»—i vÃ o yÃªu cáº§u gá»™p vá»›i branch khÃ¡c trÆ°á»›c khi thá»±c hiá»‡n xÃ³a báº±ng lá»‡nh nÃ y 1$ git branch -D &lt;tÃªn-branch&gt; Vá»›i cÃ¡ch xÃ³a nÃ y thÃ¬ branch Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh sáº½ láº­p tá»©c bá»‹ xÃ³a ká»ƒ cáº£ trong trÆ°á»ng há»£p nÃ³ chÆ°a Ä‘Æ°á»£c gá»™p vá»›i branch khÃ¡c Äá»‘i vá»›i remote branch:1$ git push --delete &lt;tÃªn-remote&gt; &lt;tÃªn-branch&gt; hoáº·c 1$ git push &lt;tÃªn-remote&gt; --delete &lt;tÃªn-branch&gt; LÆ°u Ã½: Ä‘á»‘i vá»›i cáº£ local branch vÃ  remote branch ta cÃ³ thá»ƒ tiáº¿n hÃ nh xÃ³a Ä‘á»“ng thá»i nhiá»u branch báº±ng cÃ¡ch liá»‡t kÃª tÃªn cÃ¡c branch cáº§n xÃ³a liá»n ná»‘i tiáº¿p nhau vÃ  cÃ¡ch nhau má»™t khoáº£ng tráº¯ng 4. Push local branch lÃªn remote server vá»›i má»™t tÃªn khÃ¡c ThÃ´ng thÆ°á»ng khi chÃºng ta tiáº¿n hÃ nh push má»™t local branch lÃªn remote server thÃ¬ tÃªn branch máº·c Ä‘á»‹nh cá»§a remote branch lÃºc nÃ y sáº½ lÃ  tÃªn cá»§a local branch, lá»‡nh push nhÆ° sau: 1$ git push &lt;tÃªn-remote&gt; &lt;tÃªn-branch&gt; NhÆ°ng náº¿u ta muá»‘n Ä‘á»•i tÃªn cá»§a remote branch Ä‘Ã³ trÃªn server thÃ¬ ta cáº§n sá»­ dá»¥ng lá»‡nh nhÆ° sau: 1$ git push &lt;tÃªn-remote&gt; &lt;tÃªn-branch&gt;:&lt;tÃªn-remote-branch&gt; 5. PhÃ¢n biá»‡t rebase vÃ  merge Khi muá»‘n tiáº¿n hÃ nh gá»™p 2 branch láº¡i vá»›i nhau, ta cÃ³ thá»ƒ sá»­ dá»¥ng má»™t trong hai lá»‡nh sau: 1$ git merge &lt;tÃªn-branch&gt; hoáº·c 1$ git rebase &lt;tÃªn-branch&gt; Sáº½ tiáº¿n hÃ nh gá»™p branch hiá»‡n táº¡i vá»›i branch mÃ  ta lá»±a chá»n. Tuy cÃ³ cÃ¹ng chá»©c nÄƒng lÃ  gá»™p nhÃ¡nh nhÆ°ng cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a merge vÃ  rebase láº¡i khÃ¡c vá»›i nhau, ta cÃ³ thá»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t thÃ´ng Ä‘Ã³ nhÆ° sau: Giáº£ sá»­ ta cÃ³ 2 branch cáº§n gá»™p vá»›i nhau nhÆ° hÃ¬nh sau: Äá»‘i vá»›i sá»­ dá»¥ng merge káº¿t quáº£ thu Ä‘Æ°á»£c sáº½ nhÆ° sau: Viá»‡c sá»­ dá»¥ng merge sáº½ táº¡o ra má»™t commit má»›i lÃ  káº¿t há»£p tá»« 2 commit cuá»‘i cÃ¹ng cá»§a 2 nhÃ¡nh cáº§n gá»™p vÃ o vá»›i nhau Log commit sáº½ khÃ´ng bá»‹ thay Ä‘á»•i vÃ  thá»© tá»± cÃ¡c commit sáº½ Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»i gian táº¡o commit Äá»‘i vá»›i sá»­ dá»¥ng rebase káº¿t quáº£ thu Ä‘Æ°á»£c sáº½ nhÆ° sau: Rebase sáº½ Ä‘Æ°a toÃ n bá»™ branch Feature lÃªn trÃªn â€˜Ä‘áº§uâ€™ branch master LÃ m thay Ä‘á»•i lá»‹ch sá»­ commit 6. KhÃ¡c nhau giá»¯a fetch vÃ  pull Khi muá»‘n cáº­p nháº­t cÃ¡c thay Ä‘á»•i tá»« trÃªn remote server vá» local repository ta cÅ©ng cÃ³ hai cÃ¡ch Ä‘á»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y nhÆ° sau: 1$ git pull &lt;tÃªn-remote&gt; &lt;tÃªn-remote-branch&gt; Lá»‡nh nÃ y sáº½ tiáº¿n hÃ nh kÃ©o cÃ¡c thay Ä‘á»•i tá»« trÃªn remote server vá» local cá»§a chÃºng ta Ä‘á»“ng thá»i tiáº¿n hÃ nh merge cÃ¡c thay Ä‘á»•i Ä‘Ã³ ngay 1$ git fetch &lt;tÃªn-remote&gt; &lt;tÃªn-remote-branch&gt; Äá»‘i vá»›i lá»‡nh fetch, cÃ¡c thay Ä‘á»•i tá»« remote server sáº½ Ä‘Æ°á»£c kÃ©o vá» mÃ¡y nhÆ°ng khÃ´ng tá»± Ä‘á»™ng merge vÃ o source code cá»§a chÃºng ta mÃ  chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n viá»‡c nÃ y sau khi Ä‘Ã£ review láº¡i cÃ¡c thay Ä‘á»•i Ä‘Ã³ trÆ°á»›c khi tiáº¿n hÃ nh merge. CÃ¡c thay Ä‘á»•i nÃ y Ä‘Æ°á»£c Ä‘áº©y sang má»™t branch khÃ¡c vÃ  ta cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh: 1$ git branch -a Äá»ƒ xem Ä‘Æ°á»£c cÃ¡c branch sau khi fetch Ä‘á»“ng thá»i cÅ©ng cÃ³ thá»ƒ checkout sang branch Ä‘Ã³ Ä‘á»ƒ xem cÃ¡c thay Ä‘á»•i. CÃ³ thá»ƒ hiá»ƒu Ä‘Æ¡n giáº£n láº¡i sá»± khÃ¡c nhau giá»¯a fetch vÃ  pull nhÆ° sau: git pull = git fetch + git merge 7. Tháº¿ nÃ o lÃ  git stash? Trong quÃ¡ trÃ¬nh chÃºng lÃ m viá»‡c, cÃ³ nhá»¯ng lÃºc chÃºng ta Ä‘ang code dá»Ÿ má»™t chá»©c nÄƒng nÃ o Ä‘Ã³ nhÆ°ng báº¥t ngá» á»Ÿ má»™t chá»©c nÄƒng trÃªn branch khÃ¡c Ä‘ang cÃ³ lá»—i cáº§n pháº£i sá»­a gáº¥p vÃ  chÃºng ta muá»‘n lÆ°u láº¡i thay Ä‘á»•i Ä‘Ã£ lÃ m trÃªn nhÃ¡nh hiá»‡n táº¡i nhÆ°ng khÃ´ng muá»‘n thá»±c hiá»‡n commit dÆ° thá»«a thÃ¬ git stash lÃ  lá»‡nh mÃ  chÃºng ta cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y. git stash cho báº¡n kháº£ nÄƒng lÆ°u láº¡i tráº¡ng nhá»¯ng thay Ä‘á»•i mÃ  báº¡n Ä‘Ã£ táº¡o ra mÃ  khÃ´ng cáº§n thiáº¿t pháº£i commit nÃ³ giÃºp báº¡n cÃ³ thá»ƒ dá»… dÃ ng chuyá»ƒn sang nhÃ¡nh khÃ¡c lÃ m viá»‡c vÃ  sau Ä‘Ã³ quay láº¡i vÃ  tiáº¿p tá»¥c nhá»¯ng gÃ¬ báº¡n Ä‘ang lÃ m á»Ÿ nhÃ¡nh Ä‘Ã³. CÃ¡c lá»‡nh liÃªn quan Ä‘áº¿n git stash Äá»ƒ lÆ°u Ä‘Æ°á»£c nhá»¯ng thay Ä‘á»•i mÃ  khÃ´ng cáº§n commit nÃ³, ta cáº§n thá»±c hiá»‡n nhá»¯ng lá»‡nh sau:1$ git add . Äá»ƒ Ä‘Æ°a toÃ n bá»™ cÃ¡c thay Ä‘á»•i Ä‘Ã³ vÃ o tráº¡ng thÃ¡y staged, sau Ä‘Ã³ sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ lÆ°u thay Ä‘á»•i Ä‘Ã³ mÃ  khÃ´ng cáº§n commit: 1$ git stash # hoáº·c &quot;git stash save&quot; Äá»ƒ xem láº¡i cÃ¡c thay Ä‘á»•i Ä‘Ã£ lÆ°u, ta cÃ³ thá»ƒ dÃ¹ng cÃ¡c lá»‡nh sau: 1234$ git stash liststash@&#123;0&#125;: WIP on &lt;branch-name&gt;: &lt;lastest commit&gt;stash@&#123;1&#125;: WIP on &lt;branch-name&gt;: &lt;lastest commit&gt;stash@&#123;2&#125;: WIP on &lt;branch-name&gt;: &lt;lastest commit&gt; Äá»ƒ xem láº¡i danh sÃ¡ch cÃ¡c láº§n Ä‘Ã£ lÆ°u, trong trÆ°á»ng há»£p muá»‘n xem ná»™i dung thay Ä‘á»•i thÃ¬ ta gÃµ lá»‡nh sau: 1$ git stash list -p Hoáº·c náº¿u muá»‘n xem cá»¥ thá»ƒ ná»™i dung thay Ä‘á»•i cá»§a má»™t láº§n lÆ°u cá»¥ thá»ƒ, ta dÃ¹ng lá»‡nh: 123$ git stash show &quot;stash@&#123;n&#125;&quot;// vá»›i n lÃ  láº§n lÆ°u tÆ°Æ¡ng á»©ng trong danh sÃ¡ch// LÆ°u Ã½ pháº§n stash@&#123;n&#125; pháº£i náº±m trong cáº·p ngoáº·c Ä‘Ã´i Äá»ƒ láº¥y láº¡i thay Ä‘á»•i Ä‘Æ°á»£c lÆ°u trong danh sÃ¡ch trÃªn ta dÃ¹ng lá»‡nh: 1$ git stash apply &quot;stash@&#123;n&#125;&quot; Hoáº·c láº¥y thay Ä‘á»•i gáº§n nháº¥t vÃ  xÃ³a láº§n lÆ°u Ä‘Ã³ 1$ git stash pop Äá»ƒ xÃ³a danh sÃ¡ch cÃ¡c thay Ä‘á»•i Ä‘Ã£ lÆ°u, ta dÃ¹ng lá»‡nh: 1$ git stash drop &quot;stash@&#123;n&#125;&quot; Äá»ƒ drop má»™t láº§n lÆ°u chá»‰ Ä‘á»‹nh hoáº·c 1$ git stash clear Äá»ƒ xÃ³a toÃ n bá»™ nhá»¯ng láº§n Ä‘Ã£ lÆ°u 8. LÃ m thá»ƒ nÃ o Ä‘á»ƒ xÃ³a bá» tráº¡ng thÃ i vÃ i commit gáº§n Ä‘Ã¢y?Äá»ƒ thÆ°c hiá»‡n cÃ´ng viá»‡c nÃ y chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng 1 trong 2 lá»‡nh sau: 1$ git revert &lt;commit-hash-code&gt; Lá»‡nh nÃ y sáº½ táº¡o ra má»™t commit má»›i Ä‘áº£o ngÆ°á»£c láº¡i nhá»¯ng thay Ä‘á»•i trong commit Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh. 1$ git reset --hard &lt;commit-hash-code&gt; Keehnh nÃ y sáº½ xÃ³a toÃ n bá»™ cÃ¡c commit trÆ°á»›c Ä‘Ã³ vÃ  Ä‘Æ°a branch hiá»‡n táº¡i trá»Ÿ vá» tráº¡ng thÃ¡i cá»§a commit-hash-code Ä‘Ã£ chá»n 9. Gá»™p má»™t vÃ i commit thÃ nh má»™t commit duy nháº¥t? ÄÃ´i khi trong lÃºc lÃ m viá»‡c, ta thÆ°á»ng táº¡o ra má»™t sá»‘ commit dÆ° thá»«a vÃ  sau Ä‘Ã³ muá»‘n gá»™p chung sá»‘ commit Ä‘Ã³ láº¡i vá»›i má»™t message rÃµ rÃ ng hÆ¡n vá» má»¥c Ä‘Ã­ch chung cá»§a toÃ n bá»™ cÃ¡c commit Ä‘Ã³. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»ƒu nÃ y, ta cÃ³ thá»ƒ sá»­ dá»¥ng nhá»¯ng lá»‡nh sau: 1$ git rebase -i &lt;commit-hash-code&gt; Vá»›i commit-hash-code lÃ  hash code cá»§a commit cuá»‘i cÃ¹ng cá»§a nhÃ³m cáº§n gá»™p hoáº·c: 1$ git rebase -i HEAD~&lt;index&gt; Vá»›i index lÃ  sá»‘ lÆ°á»£ng commit cáº§n gá»“m so vá»›i commit cuá»‘i cÃ¹ng. NgoÃ i ra khi thá»±c hiá»‡n viá»‡c rebase Ä‘á»ƒ gá»™p commit, ta cÃ³ cÃ¡c lá»±a chá»n khÃ¡c nhÆ° pick|squash|fixup Ä‘á»ƒ quyáº¿t Ä‘á»‹nh kiá»ƒu gá»™p. Cuá»‘i cÃ¹ng ta cÅ©ng cÃ³ thá»ƒ dÃ¹ng lá»‡nh sau Ä‘á»ƒ gá»™p commit: 123$ git reset --soft &lt;commit-hash-code&gt;$ git add .$ git commit -m&quot;New commit&quot; Vá»›i commit-hash-code lÃ  mÃ£ hash cá»§a commit trÆ°á»›c Ä‘Ã³ mÃ  ta muá»‘n gá»™p láº¡i tá»« commit cuá»‘i cÃ¹ng Ä‘áº¿n commit chá»‰ Ä‘á»‹nh. 10. PhÃ¢n biá»‡t giá»¯a git reset, reset â€“soft, reset â€“hard1$ git reset &lt;commit-hash-code&gt; Sáº½ di chuyá»ƒn HEAD vá» phÃ­a commit Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh nhÆ°ng váº«n giá»¯ nguyÃªn tráº¡ng thÃ¡i thay Ä‘á»•i cá»§a cÃ¡c file vÃ  Ä‘á»“ng thá»i loáº¡i bá» cÃ¡c file Ä‘Ã³ khá»i tráº¡ng thÃ¡i staged 1$ git reset --soft &lt;commit-hash-code&gt; TÆ°Æ¡ng tÆ° nhÆ° git reset nhÆ°ng toÃ n bá»™ cÃ¡c fle váº«n giá»¯ Ä‘Æ°á»£c tráº¡ng thÃ¡i staged. 1$ git reset --hard &lt;commit-hard-code&gt; TÆ°Æ¡ng tá»± nhÆ° 2 lá»‡nh trÃªn nhÆ°ng toÃ n bá»™ sá»± thay Ä‘á»•i cá»§a cÃ¡c file sáº½ bá»‹ loáº¡i bá» hoÃ n toÃ n nÃªn hÃ£y chÃº Ã½ khi dÃ¹ng lá»‡nh nÃ y Ä‘á»ƒ trÃ¡nh rÆ¡i vÃ o trÆ°á»ng há»£p bao nhiÃªu cÃ´ng sá»©c Ä‘á»• xuá»‘ng sÃ´ng xuá»‘ng biá»ƒn Tháº¿ nÃ o lÃ  cherry-pick? Báº¡n cÃ³ thá»ƒ hiá»ƒu cherry-pick cÅ©ng cÃ³ má»™t sá»‘ Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng vá»›i merge vÃ  rebase lÃ  láº¥y thay Ä‘á»•i tá»« má»™t branch nÃ y vÃ  gá»™p vÃ o branch khÃ¡c. NhÆ°ng Ä‘iá»ƒm khÃ¡c nhau lá»›n nháº¥t giá»¯a cherry-pick vÃ  merge, rebase lÃ  cherry-pick chá»‰ gá»™p má»™t commit Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh tá»« má»™t nhÃ¡nh khÃ¡c vÃ o nhÃ¡nh hiá»‡n táº¡i trong khi merge vÃ  rebase sáº½ gá»™p toÃ n bá»™ cÃ¡c commit láº¡i. Äá»ƒ sá»­ dá»¥ng cherry-pick, ta cáº§n xem láº¡i log cÃ¡c commit sau Ä‘Ã³ láº¥y mÃ£ hash cá»§a commit cáº§n Ä‘Æ°á»£c cherry-pick vÃ  checkout sang nhÃ¡nh cáº§n Ä‘Æ°á»£c gá»™p commit cá»§a mÃ£ hash kia vÃ  thá»±c hiá»‡n lá»‡nh: 1$ git cherry-pick &lt;commit-hash-code&gt; Má»™t hÃ¬nh áº£nh minh há»a cho cherry-pick: Giáº£ sá»­ ta muá»‘n láº¥y commit C tá»« branch master vÃ  gá»™p vÃ o branch cherry-pick Sau khi thá»±c hiá»‡n lá»‡nh cherry-pick nhÆ° Ä‘á» cáº­p á»Ÿ trÃªn, Ä‘Ã¢y sáº½ lÃ  káº¿t quáº£ ta thu Ä‘Æ°á»£c NhÆ° ta cÃ³ thá»ƒ tháº¥y commit C tá»« branch master Ä‘Æ°á»£c gá»™p vÃ o vá»›i branch cherryâ€“pick dÆ°á»›i tÃªn commit lÃ  Câ€™ Git flow lÃ  gÃ¬? Git flow lÃ  má»™t quy trÃ¬nh lÃ m viá»‡c vá»›i git Ä‘Æ°á»£c thiáº¿t káº¿ bá»Ÿi Vincent Driessen. Git flow Ä‘Æ°a ra má»™t mÃ´ hÃ¬nh phÃ¢n nhÃ¡nh giÃºp há»— trá»£ viá»‡c quáº£n lÃ½ cÃ¡c dá»± Ã¡n lá»›n dá»… dÃ ng hÆ¡n. SÆ¡ Ä‘á»“ tá»•ng quan: CÃ¡c branch trong gitflow: Master branch: lÃ  branch dÃ¹ng cho sáº£n pháº©m chÃ­nh thá»©c. ÄÃ¢y luÃ´n lÃ  branch á»•n Ä‘á»‹nh nháº¥t vÃ  nÃ³ chÆ°a lá»‹ch sá»­ cÃ¡c láº§n release cá»§a dá»± Ã¡n Develop branch: lÃ  nhÃ¡nh dÃ¹ng cho sáº£n pháº©m trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn Feature: má»—i tÃ­nh nÄƒng má»›i cho sáº©n pháº©m sáº½ Ä‘Æ°á»£c táº¡o vÃ  phÃ¡t triá»ƒn trÃªn má»™t branch má»›i vá»›i tÃªn quy Æ°á»›c feature/tÃªn_branch. CÃ¡c feature nÃ y sáº½ táº¡o ra tá»« develop branch vÃ  khi Ä‘Æ°á»£c hoÃ n thiá»‡n sáº½ Ä‘Æ°á»£c gá»™p trá»Ÿ láº¡i vá»›i develop branch (LÆ°u Ã½: cÃ¡c Feature khÃ´ng Ä‘Æ°á»£c phÃ©p gá»™p trá»±c tiáº¿p vá»›i master branch) Release: khi develop branch Ä‘Ã£ cÃ³ Ä‘á»§ sá»‘ tÃ­nh nÄƒng cáº§n thiáº¿t Ä‘á»ƒ cÃ³ thá»ƒ release, ta cÃ³ thá»ƒ táº¡o branch má»›i vá»›i tÃªn quy Æ°á»›c release/tÃªn_version. Branch nÃ y sau khi Ä‘Æ°á»£c táº¡o xong sáº½ tiáº¿n hÃ nh merge nÃ³ vá»›i Ä‘á»“ng thá»i cáº£ master branch vÃ  develop branch Hotfix branch: khi sáº£n pháº©m trÃªn master branch cá»§a chÃºng ta gáº·p pháº£i trá»¥c tráº·c vÃ  cáº§n cÃ³ báº£n vÃ¡ ngay láº­p tá»©c thÃ¬ ta sáº½ táº¡o ra hotfix branch. Branch nÃ y tÆ°Æ¡ng tá»± nhÆ° release branch nhÆ°ng nÃ³ Ä‘Æ°á»£c táº¡o ra tá»« master branch thay vÃ¬ tá»« develop branch nhÆ° release (*ChÃº Ã½ hotfix branch cÅ©ng cáº§n Ä‘Æ°á»£c gá»™p láº¡i vá»›i master branch vá»›i develop branch) CÃ¡c lá»‡nh trong gitflow Äá»ƒ khá»Ÿi táº¡o má»™t git-flow cho má»™t project, ta dÃ¹ng lá»‡nh sau 1$ git flow init Lá»‡nh nÃ y sáº½ táº¡o ra hai branch ban Ä‘áº§u lÃ  master vÃ  develop Äá»ƒ báº¯t Ä‘áº§u má»™t feature ta dÃ¹ng lá»‡nh 1$ git flow feature start &lt;tÃªn-feature&gt; Sáº½ táº¡o ra má»™t branch má»›i cÃ³ tÃªn dáº¡ng feature/&lt;tÃªn-feature&gt; Sau khi feature Ä‘Ã³ Ä‘Æ°á»£c thá»±c hiá»‡n xong, ta cÃ³ thá»ƒ cÃ´ng bá»‘ feature Ä‘Ã³ lÃªn remote server Ä‘á»ƒ má»i ngÆ°á»i cÃ¹ng cÃ³ thá»ƒ cáº­p nháº­t báº±ng cÃ¡ch gÃµ lá»‡nh: 1$ git flow feature publish &lt;tÃªn-feature&gt; Äá»ƒ tiáº¿n hÃ nh gá»™p branch Ä‘Ã³ vÃ o develop branch ta dÃ¹ng lá»‡nh: 1$ git flow feature finish &lt;tÃªn-feature&gt; Äá»ƒ táº¡o má»™t báº£n release ta dÃ¹ng lá»‡nh: 1$ git flow release start &lt;verion-no&gt; Äá»ƒ tiáº¿n hÃ nh merge báº£n release Ä‘Ã³ vÃ o master branch vÃ  develop branch ta dÃ¹ng lá»‡nh: 1$ git flow release finish &lt;version-no&gt; Äá»ƒ táº¡o má»™t báº£n hotfix ta dÃ¹ng lá»‡nh: 1$ git flow hotfix start &lt;tÃªn-hotfix&gt; Sau khi báº£n hotfix hoÃ n thiá»‡n ta cÃ³ thá»ƒ tiáº¿n hÃ nh merge láº¡i vá»›i master branch vÃ  develop branch nhÆ° sau: 1$ git flow hotfix finish &lt;tÃªn-hotfix&gt; Káº¿t luáº­nBÃ i viáº¿t á»Ÿ trÃªn chá»§ yáº¿u giá»›i thiá»‡u cho má»i ngÆ°á»i vá» cÃ¡c khÃ¡i niá»‡m trong git cÅ©ng nhÆ° cÃ¡ch sá»­ dá»¥ng nÃ³ trong cÃ´ng viá»‡c thÆ°á»ng ngÃ y cá»§a mÃ¬nh má»™t cÃ¡ch hiá»‡u quáº£ hÆ¡n. CÃ¡m Æ¡n báº¡n Ä‘Ã£ theo dÃµi.","categories":[],"tags":[{"name":"git","slug":"git","permalink":"http://nthung2112.github.io/tags/git/"}]},{"title":"Progressive Web App tÆ°Æ¡ng lai cá»§a ná»n táº£ng web","slug":"Progressive-Web-App-tuong-lai-cua-nen-tang-web","date":"2018-04-25T11:15:00.000Z","updated":"2018-04-30T08:06:42.807Z","comments":true,"path":"2018/04/Progressive-Web-App-tuong-lai-cua-nen-tang-web.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Progressive-Web-App-tuong-lai-cua-nen-tang-web.html","excerpt":"TÃ³m táº¯tâ€œMobile firstâ€ hay â€œThink mobileâ€ lÃ  má»™t trong nhá»¯ng hot trend mÃ  chÃºng ta thÆ°á»ng Ä‘Æ°á»£c nghe gáº§n Ä‘Ã¢y, khi mÃ  sá»‘ lÆ°á»£ng thiáº¿t bá»‹ di Ä‘á»™ng vÃ  sá»‘ lÆ°á»£ng ngÆ°á»i sá»­ dá»¥ng cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng ngÃ y cÃ ng lá»›n. NhÆ°ng think nhÆ° tháº¿ nÃ o cho Ä‘Ãºng lÃ  Ä‘iá»u cáº§n lÃ m rÃµ. BÃ i viáº¿t nÃ y sáº½ cung cáº¥p thÃ´ng tin cho báº¡n vá» cÃ¡ch tÆ° duy theo PWA. PWA khÃ´ng hoÃ n toÃ n lÃ  má»™t giáº£i phÃ¡p vá» cÃ´ng nghá»‡, mÃ  lÃ  má»™t táº­p cÃ¡c tiÃªu chuáº©n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a cho cÃ¡c á»©ng dá»¥ng web hÆ°á»›ng theo, nháº±m mang láº¡i tráº£i nghiá»‡m tá»‘t nháº¥t cho ngÆ°á»i dÃ¹ng, vá»›i sá»± há»— trá»£ cá»§a browser vá» cÃ¡c API cÃ³ liÃªn quan nhÆ° Service Worker, Push Notification v.vâ€¦","text":"TÃ³m táº¯tâ€œMobile firstâ€ hay â€œThink mobileâ€ lÃ  má»™t trong nhá»¯ng hot trend mÃ  chÃºng ta thÆ°á»ng Ä‘Æ°á»£c nghe gáº§n Ä‘Ã¢y, khi mÃ  sá»‘ lÆ°á»£ng thiáº¿t bá»‹ di Ä‘á»™ng vÃ  sá»‘ lÆ°á»£ng ngÆ°á»i sá»­ dá»¥ng cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng ngÃ y cÃ ng lá»›n. NhÆ°ng think nhÆ° tháº¿ nÃ o cho Ä‘Ãºng lÃ  Ä‘iá»u cáº§n lÃ m rÃµ. BÃ i viáº¿t nÃ y sáº½ cung cáº¥p thÃ´ng tin cho báº¡n vá» cÃ¡ch tÆ° duy theo PWA. PWA khÃ´ng hoÃ n toÃ n lÃ  má»™t giáº£i phÃ¡p vá» cÃ´ng nghá»‡, mÃ  lÃ  má»™t táº­p cÃ¡c tiÃªu chuáº©n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a cho cÃ¡c á»©ng dá»¥ng web hÆ°á»›ng theo, nháº±m mang láº¡i tráº£i nghiá»‡m tá»‘t nháº¥t cho ngÆ°á»i dÃ¹ng, vá»›i sá»± há»— trá»£ cá»§a browser vá» cÃ¡c API cÃ³ liÃªn quan nhÆ° Service Worker, Push Notification v.vâ€¦ TrÆ°á»›c khi bÃ n Ä‘áº¿n cÃ¡c tiÃªu chuáº©n cá»§a PWA vÃ  cÃ¹ng tÃ¬m hiá»ƒu cÃ¡c nghiÃªn cá»©u má»›i vá» tráº£i nghiá»‡m cá»§a ngÆ°á»i dÃ¹ng, cÃ¡c cÃ´ng nghá»‡ há»©a háº¹nâ€¦ ChÃºng ta sáº½ cÃ¹ng Ä‘iá»ƒm qua má»™t vÃ i cáº£m nháº­n vÃ  suy nghÄ© trong lÆ°á»£c sá»­ thá»i gian cá»§a ngÃ nh cÃ´ng nghá»‡ web. BÃªn cáº¡nh Ä‘Ã³, chÃºng ta cÅ©ng sáº½ nÃ³i Ä‘Ã´i chÃºt vá» Native App Ä‘áº¿n Hybird App vÃ  tá»« Ä‘Ã³ hiá»ƒu thÃªm vá» lÃ½ do ra Ä‘á»i cá»§a PWA. BÃ i viáº¿t sáº½ cung cáº¥p cho chÃºng ta cÃ¡i nhÃ¬n tá»•ng quÃ¡t vá» cÃ¡c váº¥n Ä‘á» Æ°u nhÆ°á»£c khi phÃ¡t triá»ƒn á»©ng dá»¥ng web theo cÃ¡c tiÃªu chuáº©n cá»§a PWA, nhá»¯ng khÃ³ khÄƒn mÃ  láº­p trÃ¬nh viÃªn cÃ³ thá»ƒ gáº·p pháº£i, hÆ¡n ná»¯a, bÃ i viáº¿t sáº½ cung cáº¥p view nhÃ¬n Ä‘á»ƒ cÃ³ thá»ƒ scale Ä‘Æ°á»£c má»™t dá»± Ã¡n PWA vá» yáº¿u tá»‘ con ngÆ°á»i cÅ©ng nhÆ° vá» chi phÃ­, háº¡ táº§ng. BÃ i viáº¿t khÃ¡ dÃ i, nÃªn báº¡n cÃ³ thá»ƒ pháº£i kiÃªn nháº«n Ä‘á»c háº¿t nhá»¯ng pháº§n bÃªn dÆ°á»›i, hoáº·c lÆ°á»›t qua cÃ¡c cÃ¡c heading Ä‘á»ƒ cÃ³ thá»ƒ chá»n cÃ¡c Ä‘á» má»¥c mÃ  mÃ¬nh tÃ¢m. Má»™t vÃ i cáº£m nháº­n vá» ná»n táº£ng Web &amp; App.Tá»« Web App Ä‘áº¿n Single Page (Web) Application Báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y cÃ¡c nÃ©t sÆ¡ lÆ°á»£c vá» lá»‹ch sá»­ cá»§a trong ngÃ nh web theo Wikipedia vá»›i cÃ¡c cá»™t má»‘c quan trá»ng á»Ÿ Ä‘Ã¢y evolutionoftheweb, vÃ  theo quan Ä‘iá»ƒm cÃ¡ nhÃ¢n cá»§a tÃ¡c giáº£ thÃ¬ trong hÆ¡n 10 nÄƒm qua cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n hai nhÃ³m sá»± kiá»‡n tiÃªu biá»ƒu: Sá»± ra Ä‘á»i cá»§a cÃ¡c browsers chá»‹u thay Ä‘á»•i vÃ  mau láº¹ trong sá»± thay Ä‘á»•i nhÆ° Firefox, Chrome. VÃ¬ chÃ­nh sá»± ra Ä‘á»i nÃ y, cÃ¡c tiáº¿n bá»™ má»›i Ä‘Æ°á»£c nhanh chÃ³ng cÃ i Ä‘áº·t, phá»• biáº¿n Ä‘áº¿n cá»™ng Ä‘á»“ng láº­p trÃ¬nh viÃªn vÃ  ngÆ°á»i sá»­ dá»¥ng. Sá»± ra Ä‘á»i cá»§a AJAX cÃ³ thá»ƒ nÃ³i lÃ  cá»™t má»‘c Ä‘Ã¡ng chÃº Ã½ nháº¥t cá»§a ná»n táº£ng web, Ä‘Ã£ cÃ³ thá»i chÃºng ta Ä‘i Ä‘Ã¢u cÅ©ng nghe ngÆ°á»i ta nÃ³i vá» Ä‘iá»u nÃ y nhÆ° lÃ  má»™t phÆ°Æ¡ng tiá»‡n mang Ä‘áº¿n sá»©c máº¡nh to lá»›n cho báº¥t kÃ¬ má»™t website nÃ o. Má»™t trong cÃ¡c á»©ng dá»¥ng mang Ä‘áº­m dáº¥u áº¥n cá»§a sá»± thay Ä‘á»•i nÃ y lÃ  Gmail, nÃ³ thay Ä‘á»•i cÃ¡ch chÃºng ta suy nghÄ© vá» má»™t pháº§n má»m quáº£n lÃ½ email trÃªn ná»n web. TrÃ¬nh duyá»‡t má»›i Ä‘i kÃ¨m cÃ´ng nghá»‡ tiÃªn tiáº¿n, chÃºng biáº¿n cÃ´ng viá»‡c phÃ¡t triá»ƒn website, á»©ng dá»¥ng web trá»Ÿ nÃªn thÃº vá»‹ dÃ nh cho láº­p trÃ¬nh viÃªn vÃ  khÃ´ng gian sÃ¡ng táº¡o khÃ´ng giá»›i háº¡n dÃ nh cho designer. CÃ¹ng vá»›i sá»± bÃ¹ng ná»• cá»§a internet, cho Ä‘áº¿n sá»± ra Ä‘á»i cá»§a AJAX, Ä‘Ã£ khiáº¿n cÃ¡c website tá»«ng vá»‘n cháº­m cháº¡p giá» trá»Ÿ nÃªn nhanh hÆ¡n, cÃ³ hiá»‡u nÄƒng vÃ  tráº£i nghiá»‡m giá»‘ng nhÆ° má»™t pháº§n má»m trÃªn desktop vÃ  Ä‘Æ°á»£c gá»i lÃ  má»™t Single Page Application (SPA). Tá»« Native App Ä‘áº¿n Hybird AppNgay tá»« nhá»¯ng ngÃ y báº¯t Ä‘áº§u, cÃ¡c á»©ng dá»¥ng di Ä‘á»™ng Ä‘Ã£ táº¡o ra nhá»¯ng Ä‘iá»u â€œtháº­t khÃ´ng thá»ƒ tin ná»•iâ€ vá» sá»± tráº£i nghiá»‡m Ä‘a dáº¡ng. CÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng vá»›i cáº¥u hÃ¬nh ngÃ y cÃ ng máº¡nh máº½ vá»›i chu ká»³ nÃ¢ng cáº¥p 1 Ä‘áº¿n 2 láº§n má»—i nÄƒm vÃ  ngÆ°á»i sá»­ dá»¥ng ngÃ y cÃ ng chá»‹u mÃ³c háº§u bao, bá» thá»i gian cho cÃ¡c á»©ng dá»¥ng trÃªn di Ä‘á»™ng cá»§a mÃ¬nh. BÃªn cáº¡nh Ä‘Ã³, cÃ¡c ná»n táº£ng di Ä‘á»™ng cÃ²n cÃ³ sá»± phong phÃº vá» chá»§ng loáº¡i, phÃ¹ há»£p tÃºi tiá»n, sá»Ÿ thÃ­ch cá»§a ngÆ°á»i tiÃªu dÃ¹ng Ä‘Ã£ nhanh chÃ³ng trá»Ÿ thÃ nh máº£nh Ä‘áº¥t mÃ u má»¡ Ä‘á»ƒ cÃ¡c nhÃ  khá»Ÿi nghiá»‡p nghÄ© vá» cÃ¡c á»©ng dá»¥ng nháº±m táº¡o káº¿t ná»‘i giá»¯a má»i ngÆ°á»i, giáº£i quyáº¿t cÃ´ng Äƒn viá»‡c lÃ m, nhu cáº§u há»c táº­p giáº£i trÃ­, cáº£i thiá»‡n cuá»™c sá»‘ng, chÄƒm sÃ³c sá»©c khoáº»â€¦ nhÆ° Grab lÃ  má»™t vÃ­ dá»¥ vá» á»©ng dá»¥ng di Ä‘á»™ng Ä‘Ã£ táº¡o ra khÃ´ng chá»‰ viá»‡c lÃ m cho cho sinh viÃªn, mÃ  cÄƒn báº£n lÃ  Ä‘Ã£ thay Ä‘á»•i cÃ¡i nhÃ¬n vÃ  thÃ³i quen truyá»n thá»‘ng vá» ngÃ nh dá»‹ch vá»¥ xe Ã´m. CÃ³ thá»ƒ ká»ƒ Ä‘áº¿n cÃ¡c ná»n táº£ng huy hoÃ ng má»™t thá»i nhÆ°: Symbian cá»§a Ä‘áº¿ cháº¿ Nokia, Windows Phone vá»›i Ä‘iá»‡n thoáº¡i O2 má»™t thá»i lÃ m mÆ°a giÃ³, dÃ¢u Ä‘en Blackberry nhá»¯ng ngÃ y hoÃ ng kim Ä‘Ã¬nh Ä‘Ã¡mâ€¦ cho Ä‘áº¿n khi chá»‰ cÃ²n hai cÃ¡i tÃªn thá»‘ng trá»‹ thá»‹ trÆ°á»ng rá»™ng lá»›n vÃ  mÃ u má»¡ nÃ y lÃ  iOS, Android nhÆ° chÃºng ta Ä‘Ã£ biáº¿t. DÃ¹ váº­y, trong trÃ² chÆ¡i vÆ°Æ¡ng quyá»n vá»‘n nguy hiá»ƒm nÃ y, tuy chÆ°a biáº¿t káº» nÃ o sáº½ chiáº¿n tháº¯ng cuá»‘i cÃ¹ng, song cÃ³ ráº¥t nhiá»u Ã´ng lá»›n váº«n khÃ´ng cam chá»‹u, khÃ´ng dá»… dÃ ng bá» cuá»™c chÆ¡i vÃ  tham vá»ng cá»§a mÃ¬nh. VÃ  ngÃ y nay, cÃ¡c á»©ng dá»¥ng phÃ¡t triá»ƒn trÃªn hai ná»n táº£ng Android cá»§a Google, vÃ  iOS cá»§a Apple Ä‘Ã£ lÃªn Ä‘áº¿n nhá»¯ng con sá»‘ khá»•ng lá»“ táº¡o ra má»™t cá»™ng Ä‘á»“ng ngÆ°á»i sá»­ dá»¥ng trung thÃ nh. Äiá»u Ä‘Ã³ cÅ©ng cÃ³ nghÄ©a lÃ  náº¿u báº¡n muá»‘n xÃ¢y dá»±ng á»©ng dá»¥ng Native App báº¡n cÅ©ng pháº£i sáºµn sÃ ng phÃ¡t triá»ƒn hai phiÃªn báº£n khÃ¡c nhau. Tháº­t khÃ´ng may lÃ  chi phÃ­ phÃ¡t triá»ƒn cho hai ná»n táº£ng nÃ y khÃ´ng há» nhá», khi mÃ  báº¡n biáº¿t ráº±ng chi phÃ­ Ä‘Ã³ kÃ¨m theo viá»‡c maintain theo thá»i gian lÃ  má»™t Ã¡c má»™ng, vÃ  pháº§n lá»›n code cá»§a chÃºng gáº§n nhÆ° lÃ  khÃ´ng thá»ƒ tÃ¡i sá»­ dá»¥ng cho nhau. ÄÃ³ lÃ  lÃºc ngÆ°á»i ta nghÄ© Ä‘áº¿n Ä‘iá»u lÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ thá»ƒ viáº¿t má»™t láº§n vÃ  cháº¡y trÃªn nhiá»u ná»n táº£ng, vÃ  cÃ³ nhiá»u giáº£i phÃ¡p cho Ä‘iá»u nÃ y, vÃ­ dá»¥: CÃ¡c ná»n táº£ng build/compile ra Native App nhÆ°: (a) Xamarin, báº¡n cÃ³ thá»ƒ code vá»›i C# vÃ  build ra cÃ¡c ná»n táº£ng khÃ¡c nhau nhÆ° Android, iOS, Windows Phone. (b) React Native, báº¡n cÃ³ thá»ƒ Javascript Ä‘á»ƒ build ra Android, iOS. CÃ¡c ná»n táº£ng cho phÃ©p porting cÃ¡c trang web hiá»‡n cÃ³, hoáº·c xÃ¢y dá»±ng app trÃªn ná»n táº£ng html/css/js Ä‘á»ƒ build ra cÃ¡c á»©ng dá»¥ng cháº¡y trÃªn cáº£ Andriod, iOS nhÆ° PhoneGap, gá»i lÃ  Hybird App báº±ng cÃ¡ch cung cáº¥p bÃªn dÆ°á»›i má»™t Native App nhÆ° lÃ  má»™t Brigde Software Ä‘á»ƒ giÃºp á»©ng dá»¥ng cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i pháº§n cá»©ng bÃªn dÆ°á»›i. Hybird app ra Ä‘á»i táº­n dá»¥ng Ä‘Æ°á»£c nhá»¯ng Æ°u Ä‘iá»ƒm cá»§a ná»n táº£ng web, táº­n dá»¥ng nguá»“n nhÃ¢n lá»±c to lá»›n tá»« ná»n táº£ng nÃ y, giá» Ä‘Ã¢y dÃ¢n láº­p trÃ¬nh web cÅ©ng cÃ³ thá»ƒ viáº¿t app, porting á»©ng dá»¥ng cá»§a mÃ¬nh lÃªn ná»n táº£ng mobile má»™t cÃ¡ch dá»… dÃ ng. Tháº­t vi diá»‡u pháº£i khÃ´ng? CÃ¡c so sÃ¡nh giá»¯a Web vÃ  AppWeb AppÆ¯u Ä‘iá»ƒm Cháº¡y Ä‘Æ°á»£c trÃªn nhiá»u ná»n táº£ng, tá»« mobile Ä‘áº¿n desktop, tá»« Andriod Ä‘áº¿n iOS, tá»« Windows Ä‘áº¿n Linux v.vâ€¦ NgÆ°á»i dÃ¹ng khÃ´ng pháº£i cÃ i Ä‘áº·t á»©ng dá»¥ng náº·ng ná» cÃ³ khi hÃ ng trÄƒm Mb, khÃ´ng pháº£i nÃ¢ng cáº¥p version, chÃºng luÃ´n Ä‘Æ°á»£c cáº­p nháº­t má»›i nháº¥t. CÃ³ thá»ƒ searchable tá»« Google Scale á»©ng dá»¥ng dá»… dÃ ng vá»›i má»™t cá»™ng Ä‘á»“ng láº­p trÃ¬nh viÃªn nÄƒng Ä‘á»™ng vÃ  Ä‘Ã´ng Ä‘áº£o dá»… thuÃª mÆ°á»›n. NhÆ°á»£c Ä‘iá»ƒm KhÃ´ng thá»ƒ can thiá»‡p Ä‘Æ°á»£c sÃ¢u vÃ o há»‡ thá»‘ng mÃ  phá»¥ thuá»™c vÃ o trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng. CÃ¡c chá»©c nÄƒng vá» offline cÃ³ giá»›i háº¡n nhÆ° phá»¥ thuá»™c vÃ o trÃ¬nh duyá»‡t cÃ³ support hay khÃ´ng. Nhiá»u trÃ¬nh duyá»‡t vÃ  cÃ¡c phiÃªn báº£n khÃ¡c nhau báº¡n sáº½ tá»‘n thá»i gian Ä‘á»ƒ Ä‘áº£m báº£o chÃºng cháº¡y giá»‘ng nhau. Bonus: Báº¡n cÃ³ thá»ƒ xem qua hÃ¬nh bÃªn dÆ°á»›i Ä‘á»ƒ nhÃ¬n tháº¥y nhá»¯ng gÃ¬ mÃ  Chrome cÃ³ thá»ƒ support Native AppÆ¯u Ä‘iá»ƒm CÃ³ thá»ƒ sá»­ dá»¥ng háº§u háº¿t cÃ¡c tÃ­nh nÄƒng cá»§a thiáº¿t bá»‹ nhÆ° camera, la bÃ nâ€¦ Cáº£m giÃ¡c vÃ  cÃ¡i nhÃ¬n (feel and look) thÃ¢n thiá»‡n vá»›i ngÆ°á»i dÃ¹ng vÃ¬ sá»­ dá»¥ng cÃ¡c control native cá»§a thiáº¿t bá»‹, do há»‡ Ä‘iá»u hÃ nh cá»§a thiáº¿t bá»‹ cung cáº¥p. Do sá»­ dá»¥ng Native App, nÃªn khi há»‡ Ä‘iá»u hÃ nh cá»§a thiáº¿t bá»‹ Ä‘Æ°á»£c nÃ¢ng cáº¥p (vÃ­ dá»¥ khi nÃ¢ng cáº¥p lÃªn IOS 10, thÃ¬ sáº½ thá»«a káº¿ Ä‘Æ°á»£c) CÃ³ thá»ƒ work offline, truy cáº­p vÃ o danh báº¡ v.vâ€¦ CÃ³ thá»ƒ táº­n dá»¥ng cÃ¡c chá»©c nÄƒng nhÆ° tÄƒng tá»‘c nÃªn tá»‘c Ä‘á»™ cá»§a Native App sáº½ cÃ³ peformance tá»‘t. NhÆ°á»£c Ä‘iá»ƒm Chi phÃ­ phÃ¡t triá»ƒn cao, pháº£i gáº§n nhÆ° lÃ m cho 2 báº£n dÃ nh cho iOS, Android Pháº£i optimize cho cÃ¡c dÃ²ng Ä‘iá»‡n thoáº¡i khÃ´ng pháº£i flagship Pháº£i cÃ i Ä‘áº·t, khÃ´ng thá»ƒ Ä‘Æ°á»£c searchable Dung lÆ°á»£ng cÃ i Ä‘áº·t ráº¥t lá»›n chiáº¿m má»™t khoáº£ng Ä‘Ã¡ng ká»ƒ Ä‘áº·c biá»‡t vá»›i cÃ¡c thiáº¿t bá»‹ cÃ³ bá»™ nhá»› tháº¥p, viá»‡c cÃ i Ä‘áº·t cÃ²n lÃ m tÄƒng chÃ­ phÃ­ vá» máº·t dung lÆ°á»£ng sá»­ dá»¥ng 3G vÃ  ngÆ°á»i sá»­ dá»¥ng cÃ³ thá»ƒ sáº½ pháº£i cÃ¢n nháº¯c thá»i Ä‘iá»ƒm táº£i. NgÆ°á»i dÃ¹ng sau khi Ä‘Ã£ cÃ i Ä‘áº·t thÆ°á»ng cÅ©ng sáº½ khÃ´ng nhá»› tá»›i á»©ng dá»¥ng vÃ  há» cÅ©ng dá»… dÃ ng remove vÃ¬ chiáº¿m tÃ i nguyÃªn vÃ  cáº£m tháº¥y cháº­t chá»™i. Thá»i gian submit vÃ  release ráº¥t lÃ¢u pháº£i chá» Ä‘á»™i ngÅ© Reviewers cá»§a App Stores duyá»‡t qua. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ , khi cÃ³ má»™t bug xáº£y ra viá»‡c fix bug Ä‘á»ƒ giáº£m Ä‘i tÃ¡c Ä‘á»™ng Ä‘áº¿n khÃ¡ch hÃ ng lÃ  khÃ´ng thá»ƒ thá»±c hiá»‡n ngay Ä‘Æ°á»£c. Äiá»u Ä‘Ã³ cÅ©ng cÃ³ nghÄ©a lÃ  chi phÃ­ dÃ nh cho viá»‡c testing cÅ©ng trá»Ÿ nÃªn lá»›n hÆ¡n. Hybird AppÆ¯u Ä‘iá»ƒm Viáº¿t má»™t láº§n vÃ  cháº¡y trÃªn nhiá»u ná»n táº£ng, chÃºng ta chá»‰ code má»™t láº§n cÃ¡i app cá»§a mÃ¬nh, pháº§n cÃ²n láº¡i cÃ¡i cáº§u ná»‘i (Bridge Software) lo. Vá»›i cÃ¡c á»©ng dá»¥ng cÃ³ porting tá»« web, hoáº·c cÃ³ tÃ­nh nÄƒng giá»‘ng nhÆ° mobile web, liÃªn quan náº·ng vá» xá»­ lÃ½ dá»¯ liá»‡u thÃ¬ loáº¡i á»©ng dá»¥ng nÃ y lÃ  phÃ¹ há»£p. CÃ³ thá»ƒ cháº¡y background, offline. NhÆ°á»£c Ä‘iá»ƒm Peformance kÃ©m: CÃ³ thá»ƒ nÃ³i cÃ¡c á»©ng dá»¥ng Hybird gáº·p pháº£i cÃ¡c váº¥n Ä‘á» lá»›n vá» performance, bá»Ÿi pháº£i cháº¡y trÃªn má»™t bridge app Ä‘Æ°á»£c viáº¿t táº¥t cáº£ trong 1 cá»“ng ká»nh, chÃºng tháº­t sá»± gáº§n nhÆ° lÃ  má»™t má»™t trÃ¬nh duyá»‡t di Ä‘á»™ng má»Ÿ rá»™ng (Extended Mobile Browser) cÃ³ bá»• sung thÃªm cÃ¡c API. KhÃ³ customize vÃ  optimize phÃ¹ há»£p vá»›i chá»©c nÄƒng cá»§a mÃ¬nh, Ä‘áº·c biá»‡t cho cÃ¡c á»©ng dá»¥ng nhÆ° Game. CÃ¡c API váº«n chÆ°a há»— trá»£ Ä‘áº§y Ä‘á»§ Ä‘á»ƒ theo ká»‹p sá»± phÃ¡t triá»ƒn cá»§a pháº§n cá»©ng vÃ  sá»± Ä‘a dáº¡ng cá»§a cÃ¡c ná»n táº£ng khÃ¡c nhau. PhoneGap - Ná»n táº£ng ná»•i báº­t cá»§a Hybird AppPhoneGap lÃ  má»™t Ä‘áº¡i diá»‡n tiÃªu biá»ƒu cho nhÃ³m ná»n táº£ng Hybird App, Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Adobe System dÃ¹ng Ä‘á»ƒ phÃ¡t triá»ƒn mobile app, nhÆ°ng khÃ´ng Ä‘Ã²i há»i user cÃ³ kiáº¿n thá»©c vá» Andriod, hay iOS, mÃ  chá»‰ cáº§n kiáº¿n thá»©c vá» web nhÆ° hÃ¬nh minh há»a bÃªn dÆ°á»›i. Báº£ng thá»‘ng kÃª so sÃ¡nh cÃ¡c cÃ´ng nghá»‡Náº¿u báº¡n cáº£m tháº¥y quÃ¡ má»‡t vÃ  loáº¡n vÃ¬ Ä‘á»‘ng chá»¯ á»Ÿ phÃ­a trÃªn, thÃ¬ cÃ³ thá»ƒ nhÃ¬n vÃ o báº£ng tá»•ng há»£p bÃªn dÆ°á»›i Ä‘á»ƒ cÃ³ cÃ¡i nhÃ¬n nhanh vá» so sÃ¡nh tÆ°Æ¡ng Ä‘á»‘i giá»¯a cÃ¡c ná»n táº£ng nÃ y. Sá»± ra Ä‘á»i cá»§a PWACÃ¡c thá»‘ng kÃª thÃº vá»‹ 5 tá»‰ thiáº¿t bá»‹ Ä‘Ã£ vÃ  sáºµn sÃ ng cho ná»n táº£ng web. CÃ³ hÆ¡n 1 tá»‰ trang web trÃªn tháº¿ giá»›i. Tá»›i quÃ½ 2, 2015, cho tháº¥y 90% thá»i gian ngÆ°á»i sá»­ dá»¥ng Ä‘iá»‡n thoáº¡i á»Ÿ Má»¹ lÃ  tÆ°Æ¡ng tÃ¡c vá»›i Native App, chá»‰ cÃ³ 10% sá»­ dá»¥ng browser. NhÆ°ng Ä‘iá»u nÃ y khÃ´ng cÃ³ nghÄ©a lÃ  báº¡n cáº§n pháº£i xÃ¢y dá»±ng má»™t Native App cho á»©ng dá»¥ng cá»§a mÃ¬nh, vÃ¬ pháº§n lá»›n thá»i gian ngÆ°á»i sá»­ dá»¥ng bá» ra láº¡i cho nhá»¯ng App phá»• biáº¿n nhÆ° Facebook, Twitter, YouTube, Instagram v.v.. NgÆ°á»i dÃ¹ng download app dá»… dÃ ng nhÆ°ng cÅ©ng dá»… dÃ ng gá»¡ bá» app, bá»Ÿi pháº§n lá»›n cÃ¡c app Ä‘Æ°á»£c cháº¡y cÃ¡c chÆ°Æ¡ng trÃ¬nh marketing háº¥p dáº«n Ä‘á»ƒ thu hÃºt ngÆ°á»i cÃ i Ä‘áº·t, nhÆ°ng vÃ¬ Ä‘iá»‡n thoáº¡i ráº¥t dá»… bá»‹ háº¿t dung lÆ°á»£ng nÃªn user sáº½ gá»¡ nhá»¯ng app mÃ  há» Ã­t khi dÃ¹ng Ä‘áº¿n. 65% ngÆ°á»i sá»­ dá»¥ng Ä‘iá»‡n thoáº¡i khÃ´ng há» download á»©ng dá»¥ng má»›i hÃ ng thÃ¡ng. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chi phÃ­ cÃ i Ä‘áº·t á»©ng dá»¥ng ngÃ y cÃ ng cao. Táº¥t cáº£ nhá»¯ng Ä‘iá»u nÃ y cho tháº¥y mobile web váº«n cÃ²n ráº¥t quan trá»ng. NhÆ°ng láº¡i cÃ³ thÃªm má»™t nghá»‹ch lÃ½ lÃ , trong khi tá»‰ lá»‡ ngÆ°á»i dÃ¹ng mobile web so vá»›i tá»‰ lá»‡ ngÆ°á»i dÃ¹ng desktop web tÄƒng trÆ°á»Ÿng ráº¥t nhanh vÃ  cao, nhÆ°ng tá»‰ lá»‡ convert thÃ nh giÃ¡ trá»‹ nhÆ° Ä‘Æ¡n hÃ ng láº¡i ráº¥t tháº¥p. Má»™t pháº§n trong Ä‘Ã³ lÃ  vÃ¬ cÃ¡c á»©ng dá»¥ng web hiá»‡n táº¡i khÃ´ng Ä‘Æ°á»£c optimize cho mobile cho cÃ¡c váº¥n Ä‘á» vá» UX/UI vÃ  trong Ä‘iá»u kiá»‡n máº¡ng cháº­m. Má»™t website cÃ³ thá»ƒ táº£i vá» dÆ°á»›i 3s ngÆ°á»i sá»­ dá»¥ng sáº½ happy vá»›i website cá»§a báº¡n, vÃ  cÃ³ nghÄ©a lÃ  tá»‰ lá»‡ rá»i bá» tháº¥p, Ä‘Æ¡n hÃ ng sáº½ tÄƒng lÃªn. CÃ²n tá»« 3s-10s thÃ¬ ngÆ°á»i sá»­ dá»¥ng chá»‰ cÃ³ thá»ƒ nÃ³i lÃ  sáº½ cá»‘ kiÃªn nháº«n. QuÃ¡ 10s ngÆ°á»i sá»­ dá»¥ng sáº½ rá»i bá» trang web cá»§a báº¡n vÃ¬ há» nghÄ© nÃ³ khÃ´ng hoáº¡t Ä‘á»™ng. (Pháº§n viáº¿t nÃ y dá»±a trÃªn sá»± suy Ä‘oÃ¡n cá»§a tÃ¡c giáº£) Sá»± phÃ¡t triá»ƒn máº¡nh máº½ cá»§a Native App, thÃ¡ch thá»©c sá»± thá»‘ng trá»‹ cá»§a Google Search Engine, náº¿u ngÆ°á»i sá»­ dá»¥ng dÃ¹ng app, há» sáº½ khÃ´ng cÃ²n cáº§n vÃ o Google Ä‘á»ƒ tÃ¬m kiáº¿m thÃ´ng tin ná»¯a vÃ  sáº£n pháº©m cá»‘t lÃµi cá»§a Google sáº½ gáº·p ráº¥t nhiá»u váº¥n Ä‘á», mÃ  cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n lÃ  sá»± sá»¥t giáº£m ngÆ°á»i sá»­ dá»¥ng do cÃ¡c thÃ´ng tin khÃ´ng cÃ²n Ä‘Æ°a lÃªn web Ä‘á»ƒ cÃ³ thá»ƒ crawl Ä‘Æ°á»£c, vÃ  kÃ¨m theo Ä‘Ã³ lÃ  sá»± sá»¥t giáº£m vá» kháº£ nÄƒng kiáº¿m tiá»n cá»§a Google. TÃ¡c giáº£ nghÄ© Ä‘Ã³ cÅ©ng cÃ³ thá»ƒ lÃ  lÃ½ do khiáº¿n Google pháº£i Ä‘áº©y máº¡nh phÃ¡t triá»ƒn PWA Ä‘á»ƒ há»— trá»£ cho ná»n táº£ng web, nÃ­u giá»¯ ngÆ°á»i sá»­ dá»¥ng á»Ÿ láº¡i ná»n táº£ng nÃ y. CÃ³ thá»ƒ nÃ³i, sá»± ra Ä‘á»i cá»§a Hybird App lÃ  má»™t cá»™c má»‘c khÃ¡ quan trá»ng thá»ƒ hiá»‡n rÃµ cÃ¡ch nhÃ¬n vÃ  sá»± mong má»i cá»§a cÃ¡c nhÃ  phÃ¡t triá»ƒn trong viá»‡c optimize chi phÃ­. VÃ  cÃ¢u há»i Ä‘áº·t ra lÃ , táº¡i sao cÃ¡c trÃ¬nh duyá»‡t báº£n thÃ¢n nÃ³ khÃ´ng nÃªn lÃ  má»™t Bridge Software cung cáº¥p cÃ¡c API Ä‘á»ƒ cÃ¡c á»©ng dá»¥ng web cÃ³ thá»ƒ truy cáº­p vÃ o pháº§n cá»©ng cá»§a thiáº¿t bá»‹. Do váº­y, chÃºng ta cÃ³ thá»ƒ tin ráº±ng, Ä‘iá»u Ä‘Ã³ sáº¯p tá»›i sáº½ lÃ  má»™t pháº§n trong nhá»¯ng thay Ä‘á»•i, bá»• sung cá»§a cÃ¡c browsers. CÃ¡c tiÃªu chÃ­ vá» PWA: Progressive - Hoáº¡t Ä‘á»™ng cho táº¥t cáº£ má»i ngÆ°á»i, khÃ´ng liÃªn quan tá»›i viá»‡c lá»±a chá»n browser, bá»Ÿi chÃºng Ä‘Æ°á»£c xÃ¢y dá»±ng vá»›i nhá»¯ng sá»± cáº£i tiáº¿n nhÆ° lÃ  má»™t nguyÃªn lÃ½ cá»‘t lÃµi. Responsive - CÃ³ thá»ƒ hoáº¡t Ä‘á»™ng tá»‘t trÃªn má»i thiáº¿t bá»‹ nhÆ° desktop, mobile, tablet, vá»›i má»i kÃ­ch thÆ°á»›c mÃ n hÃ¬nh. Connectivity independent - CÃ³ thá»ƒ hoáº¡t Ä‘á»™ng ngay cáº£ khi offline (dá»±a trÃªn Service Worker) vÃ  hoáº¡t Ä‘á»™ng tá»‘t trong Ä‘iá»u kiá»‡n network cháº­m. App-like - Sá»­ dá»¥ng app-shell Ä‘á»ƒ cung cáº¥p cÃ¡c chá»©c nÄƒng Ä‘á»‹nh hÆ°á»›ng vÃ  sá»± tÆ°Æ¡ng tÃ¡c giá»‘ng nhÆ° app. Fresh - LuÃ´n update phiÃªn báº£n má»›i nháº¥t (dá»±a trÃªn Service Worker) Safe - Táº¥t cáº£ pháº£i Ä‘Æ°á»£c phá»¥c vá»¥ thÃ´ng qua HTTPS Ä‘á»ƒ trÃ¡nh bá»‹ nghe lÃ©n vÃ  Ä‘áº£m báº£o ná»™i dung khÃ´ng bá»‹ giáº£ máº¡o. Discoverable - CÃ³ Ä‘á»ƒ Ä‘Æ°á»£c nháº­n dáº¡ng nhÆ° lÃ  á»©ng dá»¥ng (dá»±a trÃªn Service Worker, vÃ  W3C manifests ) vÃ  cho phÃ©p Search Engines cÃ³ thá»ƒ tÃ¬m tháº¥y. Re-engageable - Táº¡o ra sá»± tÆ°Æ¡ng tÃ¡c láº¡i á»©ng dá»¥ng dá»… dÃ ng thÃ´ng qua cÃ¡c chá»©c nÄƒng cháº³ng háº¡n nhÆ° Push Notification. Installable - CÃ³ thá»ƒ Add to Homescreen Ä‘á»ƒ giá»¯ láº¡i á»©ng dá»¥ng trÃªn mÃ n hÃ¬nh. Linkable - Dá»… dÃ ng share, chia sáº½ Ä‘iá»u mÃ¬nh muá»‘n Ä‘áº¿n vá»›i ngÆ°á»i khÃ¡c thÃ´ng qua URL mÃ  khÃ´ng cáº§n pháº£i cÃ i Ä‘áº·t. 10 tiÃªu chÃ­ nháº­n dáº¡ng má»™t á»©ng dá»¥ng Ä‘Æ°á»£c xem lÃ  PWA vá»›i sá»± giÃºp Ä‘á»¡ cá»§a Google Translator. PWA khÃ´ng hoÃ n toÃ n lÃ  má»™t giáº£i phÃ¡p vá» cÃ´ng nghá»‡, mÃ  lÃ  má»™t táº­p cÃ¡c tiÃªu chuáº©n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a cho cÃ¡c á»©ng dá»¥ng web hÆ°á»›ng theo nháº±m mang láº¡i tráº£i nghiá»‡m tá»‘t nháº¥t cho ngÆ°á»i dÃ¹ng, vá»›i sá»± há»— trá»£ cá»§a browser vá» cÃ¡c API cÃ³ liÃªn quan nhÆ° Service Worker, Push Notification v.vâ€¦ Äiá»u Ã½ nghÄ©a cá»§a má»™t á»©ng dá»¥ng theo tiÃªu chuáº©n cá»§a PWA khÃ´ng pháº£i lÃ  nÃ³ cÃ³ thá»ƒ táº­n dá»¥ng Ä‘Æ°á»£c sá»©c máº¡nh tá»« pháº§n cá»©ng cá»§a ngÆ°á»i sá»­ dá»¥ng hay khÃ´ng, nhÆ° cÃ¡ch mÃ  nhiá»u láº­p trÃ¬nh viÃªn láº§n Ä‘áº§u nghe qua quan tÃ¢m, mÃ  lÃ  nÃ³ giÃºp cho cÃ¡c á»©ng dá»¥ng web trá»Ÿ nÃªn tá»‘t hÆ¡n tá»« gÃ³c Ä‘á»™ performance Ä‘áº¿n nhá»¯ng cáº£i tiáº¿n vá» UX/UI. Äá»ƒ hiá»ƒu Ä‘Æ°á»£c PWA lÃ  gÃ¬, cáº§n pháº£i nhÃ¬n vá» Native App vÃ  Web App á»Ÿ gÃ³c Ä‘á»™ Æ°u nhÆ°á»£c Ä‘iá»ƒm cá»§a tá»«ng Ä‘á»‘i tÆ°á»£ng. VÃ  khi nhÃ¬n tháº¥y nhÆ°á»£c Ä‘iá»ƒm cá»§a chÃºng, cÅ©ng lÃ  lÃ½ do Ä‘áº§y Ä‘á»§ Ä‘á»ƒ chÃºng ta hiá»ƒu PWA ra Ä‘á»i nhÆ° lÃ  má»™t giáº£i phÃ¡p hoÃ n thiá»‡n cáº£ hai ná»n táº£ng nÃ y báº±ng cÃ¡ch mang Æ°u Ä‘iá»ƒm cá»§a cáº£ hai. NghiÃªn cá»©u má»›i vá» tráº£i nghiá»‡m ngÆ°á»i sá»­ dá»¥ngNgÃ y trÆ°á»›c, má»™t website tá»‘t lÃ  má»™t website cÃ³ Page Speed cao, trong thá»i gian vÃ i giÃ¢y nÃ³ pháº£i táº£i toÃ n bá»™ ná»™i dung vá» thiáº¿t bá»‹, tiáº¿p theo Ä‘Ã³ trÃ¬nh duyá»‡t hiá»ƒn thá»‹ giao diá»‡n, cuá»‘i cÃ¹ng lÃ  cho ngÆ°á»i dÃ¹ng tÆ°Æ¡ng tÃ¡c. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ , trong thá»i gian táº£i toÃ n bá»™ ná»™i dung cá»§a website, ngÆ°á»i dÃ¹ng chá»‰ nhÃ¬n tháº¥y má»™t mÃ n hÃ¬nh tráº¯ng tinh khÃ´i, hoáº·c lÃ  má»™t dáº¥u hiá»‡n Ä‘ang táº£i trang vá»›i animation nhÃ m chÃ¡n vÃ  cÃ³ thá»ƒ há» sáº½ báº¯t Ä‘áº§u tháº¥y máº¥t kiÃªn nháº«n trong cÃ¡c Ä‘iá»u kiá»‡n nhÆ° network bá»‹ cháº­m. Theo nghiÃªn cá»©u cá»§a Google, má»™t website tá»‘t pháº£i cho má»™t sá»± tráº£i nghiá»‡m liÃªn tá»¥c khÃ´ng giÃ¡n Ä‘oáº¡n, nháº±m thuyáº¿t phá»¥c ngÆ°á»i dÃ¹ng tin ráº±ng lÃ  nÃ³ Ä‘ang hoáº¡t Ä‘á»™ng Ä‘á»ƒ há» khÃ´ng rá»i bá» Ä‘i chá»— khÃ¡c, cÅ©ng nhÆ° khÃ´ng cáº£m tháº¥y pháº£i khÃ³ chá»‹u khi pháº£i chá» Ä‘á»£i. Sá»± táº£i trang, cÃ¡c ná»™i dung cáº§n thiáº¿t Ä‘á»ƒ cÃ³ thá»ƒ táº¡o ra má»™t á»©ng dá»¥ng hoÃ n chá»‰nh cÃ³ thá»ƒ chia thÃ nh nhiá»u giai Ä‘oáº¡n phÃ¹ há»£p vá»›i nhu cáº§u vÃ  kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng. á»¨ng dá»¥ng khÃ´ng cáº§n pháº£i load táº¥t cáº£ má»i thá»© lÃªn sáºµn trong khi cÃ³ ráº¥t nhiá»u tÃ­nh nÄƒng ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ chÆ°a cáº§n dÃ¹ng tá»›i hoáº·c lÃ  Ã­t khi dÃ¹ng tá»›i. CÃ¡c giai Ä‘oáº¡n tráº£i nghiá»‡m cÆ¡ báº£n First Paint - Äá»‹nh nghÄ©a viá»‡c website cáº§n táº£i tháº­t nhanh Ä‘á»ƒ ngÆ°á»i sá»­ dá»¥ng tháº¥y nÃ³ hoáº¡t Ä‘á»™ng chá»© khÃ´ng pháº£i lÃ  má»™t mÃ n hÃ¬nh tráº¯ng tinh vÃ´ há»“n. First Meaningful Paint - Äá»‹nh nghÄ©a vá» viá»‡c website cáº§n pháº£i hiá»ƒn thá»‹ nhá»¯ng Ä‘iá»u cÃ³ Ã½ nghÄ©a Ä‘á»ƒ ngÆ°á»i sá»­ dá»¥ng cÃ³ thá»ƒ nhÃ¬n tháº¥y vÃ­ dá»¥ nhÆ° nhá»¯ng hÃ¬nh áº£nh banner, video v.vâ€¦ gá»i lÃ  Hero Element Time to Interactive - Äá»‹nh nghÄ©a vá» cÃ¡ch lÃ m tháº¿ nÃ o ngÆ°á»i sá»­ dá»¥ng cÃ³ thá»ƒ báº¯t Ä‘áº§u tÆ°Æ¡ng tÃ¡c vá»›i website cá»§a báº¡n cÅ©ng trong thá»i gian nhanh nháº¥t, cÃ³ thá»ƒ thao tÃ¡c vá»›i Ä‘iá»u há» cáº§n, mÃ  khÃ´ng cáº§n pháº£i Ä‘á»£i táº£i hoÃ n toÃ n trang, vÃ­ dá»¥ nhÆ° há» Ä‘Ã£ cÃ³ thá»ƒ báº¯t Ä‘áº§u vá»›i search box, hoáº·c xem video, Ä‘i vÃ o sáº£n pháº©m chi tiáº¿t. Google Ä‘Ã£ phÃ¡t triá»ƒn má»™t cÃ´ng cá»¥ gá»i lÃ  Lighthouse Ä‘á»ƒ phÃ¢n tÃ­ch website cá»§a báº¡n theo cÃ¡c tiÃªu chÃ­ nÃ y. Táº¡i sao PWA cÃ³ thá»ƒ trá»Ÿ thÃ nh tÆ°Æ¡ng lai cá»§a ngÃ nh webNhÆ° Ä‘Ã£ nÃ³i, viá»‡c mobile web váº«n cÃ³ nhá»¯ng tháº¿ máº¡nh mÃ  khÃ´ng thá»ƒ bá»‹ Ä‘Ã¡nh báº¡i, bá»Ÿi nhá»¯ng giÃ¡ trá»‹ cá»‘t lÃµi chÆ°a thá»ƒ bá»‹ thay tháº¿ trong tÆ°Æ¡ng lai gáº§n nhÆ° Ä‘Ã£ Ä‘á» cáº­p vá»‘n ráº¥t chi tiáº¿t á»Ÿ trÃªn. NhÆ°ng vá»›i sá»± thay Ä‘á»•i nhanh vá» pháº§n cá»©ng cÅ©ng nhÆ° vá» há»‡ sinh thÃ¡i cÃ¡c pháº§n má»m tá»« há»‡ Ä‘iá»u hÃ nh cÅ©ng nhÆ° Native App trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng, Ä‘Ã²i há»i cÃ¡c á»©ng dá»¥ng web pháº£i thay Ä‘á»•i Ä‘á»ƒ thÃ­ch nghi vá»›i sá»± ká»³ vá»ng cao hÆ¡n vá» nhu cáº§u tráº£i nghiá»‡m cá»§a ngÆ°á»i dÃ¹ng. Ráº¥t khÃ³ Ä‘á»ƒ cháº¥p nháº­n vá»›i má»™t thiáº¿t bá»‹ Ä‘áº¹p, cáº¥u hÃ¬nh máº¡nh máº½, vÃ  Ä‘áº¯t Ä‘á» láº¡i táº£i má»™t trang web lÃªn cÃ³ váº» cháº­m cháº¡p, hiá»‡u nÄƒng kÃ©m vÃ  thiáº¿t káº¿ cáº©u tháº£. Nhá»¯ng lÃ½ luáº­n vÃ  tÆ° tÆ°á»Ÿng cá»§a PWA lÃ  tuyá»‡t vá»i vÃ  cÃ³ thá»ƒ Ã¡p dá»¥ng Ä‘á»ƒ lÃ m cho sáº£n pháº©m cá»§a chÃºng ta tá»‘t hÆ¡n, Ä‘iá»u Ä‘Ã³ há»©a háº¹n má»™t thá»‹ trÆ°á»ng háº¥p dáº«n vá» cÃ¡c website Ä‘Ã£ cÃ³ cáº§n pháº£i thay Ä‘á»•i vÃ  cÃ¡c website má»›i cáº§n pháº£i Ä‘Æ°á»£c build trÃªn cÃ¡c ná»n táº£ng cÃ´ng nghá»‡ má»›i vÃ  tÆ° tÆ°á»Ÿng má»›i. Náº¿u chÃºng ta khÃ´ng náº¯m báº¯t Ä‘Ãºng thá»i Ä‘iá»ƒm, Ä‘Ãºng Ä‘iá»ƒm rÆ¡i cá»§a cÃ´ng nghá»‡, chÃºng ta sáº½ bá»‹ bá» láº¡i phÃ­a sau, láº¡c háº­u vÃ  khi pháº§n lá»›n khÃ¡ch hÃ ng quay lÆ°ng Ä‘i vá»›i mÃ¬nh thÃ¬ Ä‘Ã£ muá»™n. CÃ³ ráº¥t nhiá»u bÃ i há»c vá» Ä‘iá»u nÃ y nhÆ° cá»§a Nokia, cá»§a Yahooâ€¦ cÃ³ thá»ƒ sá»± Ä‘á»• vá»¡ cá»§a cÃ¡c táº­p Ä‘oÃ n khá»•ng lá»“ nÃ y Ä‘áº¿n tá»« nhiá»u nguyÃªn nhÃ¢n, nhÆ°ng trong sá»‘ Ä‘Ã³ cháº¯c cháº¯n pháº§n lá»›n tá»« cÃ¡c sáº£n pháº©m thiáº¿u sÃ¡ng táº¡o, kÃ©m háº¥p dáº«n Ä‘á»‘i vá»›i ngÆ°á»i tiÃªu dÃ¹ng, tháº­m chÃ­ khÃ´ng muá»‘n nÃ³i lÃ  láº¡c háº­u trong tá»“n táº¡i cá»§a nÃ³ so vá»›i Ä‘á»‘i thá»§. Nhá»¯ng khÃ³ khÄƒn khi á»©ng dá»¥ng PWA Nguá»“n nhÃ¢n lá»±c vá» PWA hiá»‡n táº¡i Ä‘ang thiáº¿u há»¥t mÃ  chÆ°a dá»… dÃ ng Ä‘Æ°á»£c khoáº£ láº¥p trong thá»i gian ngáº¯n sáº¯p tá»›i, do cÃ¡c cÃ´ng nghá»‡ vÃ  ná»n táº£ng váº«n cÃ²n má»›i. TÃ¡c giáº£ sáº½ viáº¿t má»™t bÃ i sáº¯p tá»›i Ä‘á»ƒ nÃ³i sÃ¢u hÆ¡n vá» váº¥n Ä‘á» nÃ y cÅ©ng nhÆ° giáº£i phÃ¡p kháº¯c phá»¥c cho cÃ¡c tá»• chá»©c muá»‘n phÃ¡t triá»ƒn sáº£n pháº©m theo tÆ° tÆ°á»Ÿng cá»§a PWA. Sá»± thiáº¿u há»— trá»£ Ä‘áº§y Ä‘á»§ tá»« cÃ¡c nhÃ  phÃ¡t triá»ƒn cháº³ng háº¡n nhÆ° tá»« Apple, nhÆ°ng Ä‘iá»u nÃ y Ä‘ang vÃ  sáº½ sá»›m Ä‘Æ°á»£c kháº¯c phá»¥c, báº¡n cÃ³ thá»ƒ tham kháº£o á»Ÿ Ä‘Ã¢y Ä‘á»ƒ tháº¥y tÃ­nh nÄƒng nÃ y Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Apple Nhá»¯ng lo ngáº¡i cá»§a cá»™ng Ä‘á»“ng developer do cÃ¡ch hiá»ƒu sai lÃ  nÃ³ khÃ´ng thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c pháº§n cá»©ng cá»§a thiáº¿t bá»‹. CÃ¡c lÃ£nh Ä‘áº¡o, cáº¥p trÃªn váº«n chÆ°a tháº¥y Ä‘Æ°á»£c nhiá»u value Ä‘á»ƒ chuyá»ƒn Ä‘á»•i tá»« nhá»¯ng website truyá»n thá»‘ng sang ná»n táº£ng má»›i. NhÆ°ng cÃ¡c con sá»‘ vÃ  thá»‘ng kÃª cÅ©ng cho tháº¥y viá»‡c chuyá»ƒn Ä‘á»•i theo tÆ°Æ¡ng tÆ°á»Ÿng vÃ  mÃ´ hÃ¬nh cÃ´ng nghá»‡ má»›i hÆ¡n lÃ  Ä‘iá»u khÃ´ng thá»ƒ nÃ o nÃ© trÃ¡nh. Nhá»¯ng nhÃ  phÃ¡t triá»ƒn tiÃªu biá»ƒuBáº¡n cÃ³ thá»ƒ nhÃ¬n qua cÃ¡c website nÃ y Ä‘á»ƒ tÃ¬m hiá»ƒu cÃ¡c website Ä‘Ã³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o Ä‘á»ƒ tham kháº£o cho website cá»§a mÃ¬nh. á» nÆ°á»›c ngoÃ i cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n: Flipkart - áº¤n Ä‘á»™, xem chi tiáº¿t táº¡i Ä‘Ã¢y. Vá»›i phiÃªn báº£n PWA mobile thá»i gian user á»Ÿ láº¡i website lÃ : 3.5 phÃºt so vá»›i phiÃªn báº£n mobile cÅ© khÃ´ng PWA lÃ  70s. 3x tÄƒng thá»i gian user á»Ÿ láº¡i website. 40% tá»‰ lá»‡ tÆ°Æ¡ng tÃ¡c tÄƒng thÃªm. 70% nhiá»u hÆ¡n CR Ä‘áº¿n tá»« Add to Homescreen. 3x giáº£m tá»‰ lá»‡ sá»­ dá»¥ng dá»¯ liá»‡u. Aliexpress - Trung Quá»‘c, xem chi tiáº¿t táº¡i Ä‘Ã¢y. 104% CR cho ngÆ°á»i dÃ¹ng má»›i táº¥t cáº£ trÃ¬nh duyá»‡t; 82% CR tÄƒng thÃªm trÃªn iOS 2X sá»‘ trang mÃ  ngÆ°á»i sá»­ dá»¥ng xem thÃªm vá»›i má»—i session cho táº¥t cáº£ trÃ¬nh duyá»‡t. 74% tÄƒng thÃªm thá»i gian ngÆ°á»i sá»­ dá»¥ng vá»›i má»—i session táº¥t cáº£ trÃ¬nh duyá»‡t. á» thá»‹ trÆ°á»ng Viá»‡t Nam, cÃ¡c site ná»•i tiáº¿ng cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n: Tiki - Ä‘Ã£ released version PWA vÃ o mÃ¹a hÃ¨ 2017 Sendo - dá»± kiáº¿n released vÃ o cuá»‘i nÄƒm 2017 PWA dÆ°á»›i gÃ³c nhÃ¬n cho doanh nghiá»‡pÄá»‘i vá»›i doanh nghiá»‡p Ä‘iá»u quan trá»ng lÃ  giáº£m chi phÃ­, tÄƒng doanh thu vÃ  lá»£i nhuáº­n thÃ¬ viá»‡c phÃ¡t triá»ƒn má»™t á»©ng dá»¥ng PWA vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p luáº­n vÃ  cÃ¡c giáº£i phÃ¡p má»›i khiáº¿n cho chi phÃ­ phÃ¡t triá»ƒn dá»± Ã¡n xÃ©t vá» lÃ¢u dÃ i cÃ ng giáº£m, vÃ  lá»£i nhuáº­n ngÃ y cÃ ng Ä‘Æ°á»£c tá»‘i Ä‘a hoÃ¡. Sáº£n pháº©m theo ná»n táº£ng nÃ y Ä‘Æ°á»£c thá»«a hÆ°á»Ÿng má»™t há»‡ thá»‘ng lÃ½ luáº­n vÃ  phÆ°Æ¡ng phÃ¡p láº­p trÃ¬nh tá»‘t Ä‘á»ƒ dá»… dÃ ng scale, maintain, improve, vÃ  thay Ä‘á»•i trong tÆ°Æ¡ng lai. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  cÃ¡c tÃ­nh nÄƒng Ä‘Æ°á»£c thÃªm má»›i dá»… dÃ ng vá»›i chi phÃ­ tháº¥p, rá»§i ro vá» lá»—i Ä‘Æ°á»£c giáº£m. PWA dÆ°á»›i gÃ³c nhÃ¬n cho láº­p trÃ¬nh viÃªnBáº¡n cáº§n há»c gÃ¬, lÃ m gÃ¬.Náº¿u báº¡n chÆ°a tá»«ng biáº¿t lÃ m tháº¿ nÃ o thÃ¬ Ä‘á»c bÃ i viáº¿t nÃ y LÃ m tháº¿ nÃ o Ä‘á»ƒ trá»Ÿ thÃ nh Frontend developer Kháº£ nÄƒng scale cá»§a dá»± Ã¡n PWAPWA Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a ra tá»« cÃ¡ch Ä‘Ã¢y tá»« vÃ i nÄƒm trÆ°á»›c, nhÆ°ng Ä‘Ã¢y lÃ  Ä‘iá»ƒm rÆ¡i Ä‘á»ƒ cÃ¡c á»©ng dá»¥ng cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i sang ná»n táº£ng nÃ y, do sá»± phÃ¡t triá»ƒn vÃ´ cÃ¹ng máº¡nh máº½ cá»§a cÃ¡c framework, thÆ° viá»‡n Ä‘Æ°á»£c xÃ¢y dá»±ng vÃ  phÃ¡t triá»ƒn trÃªn ná»n Nodejs, Ä‘Ã¡ng Ä‘á»ƒ ká»ƒ Ä‘áº¿n nhÆ° React, Angular, Polymer dá»±a trÃªn trÃªn cÃ¡c cÃ´ng cá»¥ bundle nhÆ° Grunt, Gulp, Webpackâ€¦ ChÃºng khiáº¿n cho viá»‡c tá»• chá»©c, tá»‘i Æ°u code Ä‘Æ°á»£c dá»… dÃ ng, tá»• chá»©c team hiá»‡u quáº£ vÃ  trÃ¡nh Ä‘Æ°á»£c cÃ¡c rá»§i ro. Kháº£ nÄƒng scale cá»§a dá»± Ã¡n lÃ  dá»… dÃ ng cáº£ vá» yáº¿u tá»‘ con ngÆ°á»i, váº­t lÃ½, vÃ  chi phÃ­. KhÃ´ng cÃ³ sá»± há»— trá»£ vá» cÃ¡c cÃ´ng cá»¥ phÃ¡t triá»ƒn pháº§n má»m tá»« há»‡ sinh thÃ¡i cá»§a Nodejs, ráº¥t khÃ³ Ä‘á»ƒ cÃ³ thá»ƒ á»©ng dá»¥ng Ä‘Æ°á»£c cÃ¡c triáº¿t lÃ½ mÃ  PWA Ä‘Ã£ Ä‘á» ra, vÃ¬ cÃ³ thá»ƒ dá»± Ã¡n sáº½ cÃ³ chi phÃ­ phÃ¡t triá»ƒn cá»±c lá»›n vÃ  rá»§i ro phÃ¡t sinh theo nÃ³ lÃ  khÃ´ng thá»ƒ nÃ o dá»± Ä‘oÃ¡n hay kiá»ƒm soÃ¡t. Tá»« gÃ³c nhÃ¬n outsourcing LÃ m tháº¿ nÃ o Ä‘á»ƒ decoupling cÃ¡c task chá»©c nÄƒng cá»§a á»©ng dá»¥ng, sao cho khi cÃ³ nhiá»u tÃ­nh nÄƒng thÃ¬ cÃ³ thá»ƒ Ä‘áº©y ngÆ°á»i vÃ o, vÃ¬ náº¿u khÃ´ng thá»ƒ decoupling Ä‘Æ°á»£c tÃ­nh nÄƒng, cÃ¡c chá»©c nÄƒng Ä‘Æ°á»£c code Ä‘á»™c láº­p, má»—i ngÆ°á»i lÃ m má»™t pháº§n thÃ¬ khi cÃ ng push ngÆ°á»i vÃ o, thÃ¬ sá»± phÃ¡t triá»ƒn cá»§a dá»± Ã¡n chÆ°a cháº¯c tÆ°Æ¡ng xá»©ng. GiÃºp debug dá»… dÃ ng, khi cÃ³ váº¥n Ä‘á» gÃ¬ xáº£y ra khÃ´ng Ä‘Æ°á»£c nhÆ° mong Ä‘á»£i. Dá»± Ã¡n dá»… testable, cÃ³ thá»ƒ viáº¿t chá»©c nÄƒng test má»™t cÃ¡ch dá»… dÃ ng. Tá»« gÃ³c nhÃ¬n production Bao gá»“m cáº£ cÃ¡c yáº¿u tá»‘ cá»§a outsourcing. Äiá»u quan tÃ¢m lÃ  viá»‡c tÃ­nh scale nhÆ° tháº¿ nÃ o khi cÃ³ sá»± tÄƒng tÆ°á»Ÿng cá»§a ngÆ°á»i sá»­ dá»¥ng, Ä‘áº·c biá»‡t lÃ  khi cÃ¡c phÆ°Æ¡ng phÃ¡p xÃ¢y dá»±ng má»™t á»©ng dá»¥ng PWA phá»¥ thuá»™c náº·ng nÃ o Nodejs ngay cáº£ khi báº¡n dÃ¹ng framework/library nÃ o Ä‘i chÄƒng ná»¯a thÃ¬ cÃ¡c cÃ´ng cá»¥ Ä‘á»ƒ xÃ¢y dá»±ng vÃ  tá»• chá»©c source code, build source code, debug sáº½ cáº§n Ä‘áº¿n gulp/grunt hoáº·c lÃ  Webpack. Nodejs vá» hiá»‡u nÄƒng cÃ³ thá»ƒ Ä‘Æ°á»£c má»i ngÆ°á»i nghÄ© lÃ  kÃ©m so vá»›i cÃ¡c ngÃ´n ngá»¯ khÃ¡c vÃ  khÃ³ scale. NhÆ°ng cÃ¡i nhÃ¬n Ä‘Æ¡n giáº£n Ä‘Ã³ lÃ  chÆ°a Ä‘Ãºng. ChÃºng ta cáº§n nhÃ¬n vá» á»©ng dá»¥ng vá»›i cÃ¡c cÃ´ng nghá»‡ Ä‘Æ°á»£c build stack vá»›i nhau nhÆ°: Nginx, Redis, Database v.vâ€¦ má»™t á»©ng dá»¥ng cháº¡y nhanh cáº§n má»™t thiáº¿t káº¿ tá»‘t, cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh vÃ  scale theo chiá»u ngang chá»© khÃ´ng nÃªn Ä‘Æ°á»£c thiáº¿t káº¿ chá»‰ dá»±a vÃ o ngÃ´n ngá»¯. á» gÃ³c nhÃ¬n production, cÃ¡c ká»³ vá»ng vá» sáº£n pháº©m, vá» chi phÃ­, thá»i gian, con ngÆ°á»i Ä‘á»u cÃ³ Ä‘á»§ phÆ°Æ¡ng phÃ¡p lÃ½ luáº­n vÃ  tá»• chá»©c Ä‘á»ƒ cÃ³ thá»ƒ Ä‘i Ä‘áº¿n viá»‡c dá»… dÃ ng kiá»ƒm soÃ¡t vÃ  Ä‘áº¡t Ä‘Æ°á»£c cÃ¡c tiÃªu chÃ­ Ä‘á» ra. á» má»™t bÃ i viáº¿t tiáº¿p theo, chÃºng ta sáº½ xem xÃ©t má»™t á»©ng dá»¥ng open source PWA máº«u, Ä‘á»ƒ tÃ¬m hiá»ƒu cÃ¡c cÃ´ng nghá»‡ Ä‘Æ°á»£c stacked nhÆ° tháº¿ nÃ o. Káº¿t luáº­nQua má»™t bÃ i viáº¿t khÃ¡ dÃ i, tÃ¡c giáº£ hi vá»ng sáº½ mang láº¡i cho báº¡n má»™t trong nhá»¯ng bÃ i viáº¿t Ä‘áº§y Ä‘á»§ vÃ  chi tiáº¿t nháº±m cung cáº¥p cÃ¡c view nhÃ¬n mang giÃ¡ trá»‹ tham kháº£o vá» má»™t trong nhá»¯ng ná»n táº£ng ráº¥t há»©a háº¹n thay Ä‘á»•i tÆ°Æ¡ng lai cá»§a ngÃ nh láº­p trÃ¬nh vÃ  phÃ¡t triá»ƒn á»©ng dá»¥ng web. BÃ i viáº¿t sáº½ khÃ´ng trÃ¡nh khá»i cÃ¡c thiáº¿u sÃ³t mang tÃ­nh chá»§ quan cá»§a tÃ¡c giáº£ vÃ  cáº£ cÃ¡c sai sÃ³t vá» cÃ¡c thÃ´ng sá»‘, cÃ¡ch trÃ¬nh bÃ y, bá»‘ cá»¥c, lá»—i chÃ­nh táº£â€¦ nÃªn hi vá»ng báº¡n Ä‘á»c thÃ´ng cáº£m bá» qua. Náº¿u báº¡n cÃ³ báº¥t kÃ¬ cÃ¢u há»i hay pháº£n biá»‡n bá»• sung nÃ o vui lÃ²ng Ä‘á»ƒ láº¡i comment bÃªn dÆ°á»›i. Ráº¥t cáº£m Æ¡n quÃ½ Ä‘á»c giáº£ vÃ  cÃ¡c báº¡n vÃ¬ Ä‘Ã£ kiÃªn nháº«n Ä‘á»c háº¿t bÃ i viáº¿t. Tham kháº£o Getting started with Progressive Web Apps Mobile Web Hay Mobile App? Why â€œProgressive Web Apps vs. nativeâ€ is the wrong question to ask","categories":[],"tags":[{"name":"pwa","slug":"pwa","permalink":"http://nthung2112.github.io/tags/pwa/"},{"name":"web","slug":"web","permalink":"http://nthung2112.github.io/tags/web/"}]},{"title":"BiÃªn niÃªn sá»­ vá» bá»‘ cá»¥c trong trang web","slug":"Bien-nien-su-ve-bo-cuc-trong-trang-web","date":"2018-04-25T10:57:00.000Z","updated":"2018-04-25T11:06:06.716Z","comments":true,"path":"2018/04/Bien-nien-su-ve-bo-cuc-trong-trang-web.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Bien-nien-su-ve-bo-cuc-trong-trang-web.html","excerpt":"Giá»›i thiá»‡uBÃ i viáº¿t bÃ n vá» cÃ´ng nghá»‡ cÃ¡c láº­p trÃ¬nh viÃªn web Ã¡p dá»¥ng Ä‘á»ƒ thiáº¿t káº¿ bá»‘ cá»¥c trong trang web (website layout) - qua cÃ¡c thá»i ká»³: table, float, block-inline, flexbox, JS, Twitter Bootstrap vÃ  grid.","text":"Giá»›i thiá»‡uBÃ i viáº¿t bÃ n vá» cÃ´ng nghá»‡ cÃ¡c láº­p trÃ¬nh viÃªn web Ã¡p dá»¥ng Ä‘á»ƒ thiáº¿t káº¿ bá»‘ cá»¥c trong trang web (website layout) - qua cÃ¡c thá»i ká»³: table, float, block-inline, flexbox, JS, Twitter Bootstrap vÃ  grid. Thá»i trÆ°á»›c 2010ÄÃ¢y lÃ  thá»i ká»³ tá»‘i cá»• vá»›i cÃ´ng nghá»‡ website, ngÆ°á»i ta háº§u nhÆ° Ã­t Ä‘áº§u tÆ° giao diá»‡n web, viá»‡c dá»±ng bá»‘ cá»¥c, xÆ°Æ¡ng sÆ°á»n cho trang web sá»­ dá»¥ng tháº» HTML &lt;table&gt; lÃ  chÃ­nh. Layout Table ráº¥t Ä‘Æ¡n giáº£n, vá»›i 1 table 3 rows, 1 row lÃ m header, 1 row lÃ m content, cÃ¡i cuá»‘i lÃ m footer.NhÆ°á»£c Ä‘iá»ƒm cá»§a layout table lÃ : ráº¥t khÃ³ khÄƒn khi tÃ¡i cáº¥u trÃºc láº¡i bá»‘ cá»¥c, khÃ³ khÄƒn khi thiáº¿t káº¿ vÃ¬ table má»¥c Ä‘Ã­ch chÃ­nh lÃ  biá»ƒu diá»…n dá»¯ liá»‡u. CÃ¡c cá»™t cÃ³ chiá»u rá»™ng cá»‘ Ä‘á»‹nh khÃ´ng linh hoáº¡t, nan giáº£i khi xá»­ lÃ½ trÃªn nhiá»u kÃ­ch thÆ°á»›c mÃ n hÃ¬nh.NÄƒm 2012, khi má»›i ra trÆ°á»ng, cÃ´ng viá»‡c Ä‘áº§u tiÃªn cá»§a tÃ´i lÃ  Ä‘áº­p bá» vÃ  thay tháº¿ cÃ¡c layout dáº¡ng table. Tá»›i nay thÃ¬ khÃ´ng cÃ²n ai nghÄ© tá»›i viá»‡c viá»‡c thiáº¿t káº¿ layout báº±ng table ná»¯a.Tuy nhiÃªn cÃ²n ráº¥t nhiá»u tÃ i liá»‡u trong cÃ¡c trÆ°á»ng Ä‘áº¡i há»c chÆ°a Ä‘Æ°á»£c cáº­p nháº­t nÃªn Ä‘á»«ng ngáº¡c nhiÃªn khi báº¡n Ä‘Æ°á»£c dáº¡y thiáº¿t káº¿ layout báº±ng tháº» table nhÃ©. Tá»« 2012 - Float láº­t Ä‘á»• TableKhi layout table quÃ¡ báº¥t cáº­p thÃ¬ giáº£i phÃ¡p thay tháº¿ tuyá»‡t vá»i nháº¥t trong giai Ä‘oáº¡n nÃ y lÃ  dÃ¹ng cÃ¡c tháº» HTML káº¿t há»£p vá»›i CSS property: Float.CÃ¡c khá»‘i block sáº½ Ä‘Æ°á»£c tÃ¡ch ra vÃ  â€œtrÃ´iâ€ qua trÃ¡i, pháº£i, tÃ¹y theo Ã½ muá»‘n cá»§a láº­p trÃ¬nh viÃªn. Æ¯u Ä‘iá»ƒm: code sáº¡ch sáº½ hÆ¡n khi dÃ¹ng table, dá»… thay Ä‘á»•i chá»‰nh sá»­a, linh hoáº¡t trÃªn nhiá»u kÃ­ch thÆ°á»›c mÃ n hÃ¬nh.Khuyáº¿t Ä‘iá»ƒm: dá»… bá»‹ â€œvá»¡ trangâ€, náº¿u láº­p trÃ¬nh viÃªn chÆ°a lÃ m chá»§ Ä‘Æ°á»£c float, chÆ°a biáº¿t cÃ¡ch sá»­ dá»¥ng cÃ¡c tuyá»‡t chiÃªu nhÆ°: clear, overflowâ€¦ Láº¡m dá»¥ng float trÃªn cÃ¡c bá»‘ cá»¥c phá»©c táº¡p. 2013 - thá»i cá»§a cÃ¡c CSS FrameworksVÃ o giai Ä‘oáº¡n nÃ y, cÃ¡c CSS Frameworks nhÆ° Bootstrap, Foundation,â€¦CÃ¡c thÆ° viá»‡n nÃ y há»— trá»£ ráº¥t Ä‘áº¯c lá»±c cho cÃ¡c láº­p trÃ¬nh viÃªn, dá»… sá»­ dá»¥ng, dá»… thiáº¿t káº¿ bá»‘ cá»¥c, chá»‰ cáº§n gáº¯n cÃ¡c class phÃ¹ há»£p. BÃªn cáº¡nh Ä‘Ã³ chÃºng cÃ²n liÃªn tá»¥c cáº­p nháº­t vÃ  cáº£i tiáº¿n khÃ´ng ngá»«ng.Pháº£i nÃ³i trong thá»i gian Ä‘Ã³, cÃ¡c CSS Frameworks nháº¥t lÃ  Bootstrap, trá»Ÿ thÃ nh 1 xu hÆ°á»›ng tá»›i má»©c khi Ä‘i phá»ng váº¥n code web, cháº¯c Äƒn tháº¿ nÃ o há» cÅ©ng há»i báº¡n vÃ i cÃ¢u.Äá»ƒ dÃ¹ng tá»‘t Bootstrap, báº¡n pháº£i há»c cÃ¡c khÃ¡i niá»‡m nhÆ° Grid View System, há»c thuá»™c cÃ¡c class thÃ´ng dá»¥ng , táº­n dá»¥ng tá»‘i Ä‘a cÃ¡c chá»©c nÄƒng cÃ³ sáºµn, ngÆ°á»i giá»i nháº¥t lÃºc nÃ y lÃ  ngÆ°á»i code CSS, style Ã­t nháº¥t.Háº¡n cháº¿ cá»§a cÃ¡c CSS Framework nÃ y lÃ  quÃ¡ ká»nh cÃ ng náº¿u ta khÃ´ng táº­n dá»¥ng háº¿t chá»©c nÄƒng (cÃ³ thá»ƒ kháº¯c phá»¥c báº±ng báº£n tÃ¹y chá»‰nh).NÃ¢ng cáº¥p phiÃªn báº£n cáº§n sá»­a Ä‘á»•i láº¡i tÃªn cÃ¡c class (v2 xÃ i span1 - span12, v3 xÃ i col-, v4 xÃ i col- ). NgÃ y nay cÃ¡c CSS Frameworks nhÆ° Bootstrap Ä‘Ã£ phÃ¡t triá»ƒn hÆ¡n khÃ¡i niá»‡m CSS ráº¥t nhiá»u, ta nÃªn gá»i nÃ³ vá»›i tÃªn front-end component library, vÃ¬ nÃ³ cÃ²n tÃ­ch há»£p nhiá»u thÆ° viá»‡n JavaScript bÃªn trong. Sá»‘ lÆ°á»£ng cÃ¡c front-end libraries ngÃ y nay 2015 - CSS3 vÃ  FlexboxCSS3 Ä‘Ã£ há»— trá»£ má»™t cÃ´ng nghá»‡ thiáº¿t káº¿ layout má»›i, hiá»‡n Ä‘áº¡i hÆ¡n Float Ä‘Ã³ chÃ­nh lÃ  Flexbox. ÄÃºng nhÆ° tÃªn gá»i flexible (linh hoáº¡t), nÃ³ thá»±c sá»± ráº¥t máº¡nh. Flexbox sáº½ giÃºp báº¡n Ä‘iá»u khiá»ƒn Ä‘Æ°á»£c khÃ´ng nhá»¯ng chiá»u ngang (horizontal) mÃ  cÃ²n chiá»u dá»c (vertical) Ä‘iá»u mÃ  CSS thÆ°á»ng vá»›i position ráº¥t cá»©ng nháº¯c. Flexbox cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn Ä‘Æ°á»£c cÃ¡c pháº§n tá»­ bÃªn trong, giÃºp báº¡n dá»… dÃ ng biá»ƒu diá»…n ná»™i dung vÃ  bá»‘ cá»¥c trÃªn cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng. Khuyáº¿t Ä‘iá»ƒm: flexbox máº¡nh vÃ  má»›i nÃªn báº¡n pháº£i bá» nhiá»u cÃ´ng sá»©c Ä‘á»ƒ há»c vÃ  lÃ m chá»§ Ä‘Æ°á»£c nÃ³, khÃ³ hÆ¡n so vá»›i dÃ¹ng float vÃ  Bootstrap. KhÃ´ng khuyáº¿n khÃ­ch dÃ¹ng flexbox Ä‘á»ƒ lÃ m bá»‘ cá»¥c toÃ n trang trá»« trÆ°á»ng há»£p Ä‘áº·c biá»‡t, chá»‰ dÃ¹ng Ä‘á»ƒ bá»‘ cá»¥c cÃ¡c thÃ nh pháº§n bÃªn trong. LÃ½ do vÃ¬ flexbox phá»¥ thuá»™c vÃ o ná»™i dung bÃªn trong nÃ³, nÃªn khi bÃ i viáº¿t dÃ i ngáº¯n cÃ³ thá»ƒ lÃ m â€œbiáº¿n dáº¡ngâ€ bá»‘ cá»¥c website cá»§a báº¡n, chÆ°a ká»ƒ tÃ¬nh huá»‘ng khi web load chÆ°a ká»‹p. Káº¿t há»£p khÃ´n ngoan lÃ  dÃ¹ng grid system Ä‘á»ƒ lÃ m bá»‘ cá»¥c bÃªn ngoÃ i, nhá»¯ng pháº§n bá»‘ cá»¥c cáº§n sá»± linh hoáº¡t thÃ¬ dÃ¹ng flexbox. Bootstrap 4 Ä‘Ã£ tÃ­ch há»£p flexbox vÃ o grid view cá»§a mÃ¬nh, chá»©ng tá» sá»©c máº¡nh cá»§a flexbox vÃ  khÃ´ng thá»ƒ bÃ n cÃ£i, Ä‘á»“ng thá»i cho tháº¥y cÃ¡i tiá»‡n lá»£i khi dÃ¹ng Bootstrap. 2017 - CSS GridGrid vÃ  1 thuá»™c tÃ­nh CSS ráº¥t má»›i, ra Ä‘á»i 3-2017. Tuy nhiÃªn nÃ³ Ä‘Ã£ vÃ  Ä‘ang Ä‘Æ°á»£c giá»›i cÃ´ng nghá»‡ web Ä‘áº·c biá»‡t quan tÃ¢m vÃ¬ nhá»¯ng tÃ­nh nÄƒng Æ°u viá»‡t.Náº¿u nhÆ° Flexbox phÃ¢n bá»‘ cÃ¡c pháº§n tá»­ theo 1 chiá»u duy nháº¥t thÃ¬ Grid cho phÃ©p báº¡n Ä‘iá»ƒu khiá»ƒn pháº§n tá»­ theo 2 chiá»u - ngang vÃ  dá»c.VÃ¬ Ä‘Ã¢y lÃ  1 cÃ´ng nghá»‡ má»›i, nÃªn cÃ¡c tÃ i liá»‡u cháº¥t lÆ°á»£ng vá» nÃ³ háº§u háº¿t lÃ  báº±ng tiáº¿ng anh, sáº¯p tá»›i mÃ¬nh sáº½ cÃ³ bÃ i viáº¿t vá» cÃ´ng nghá»‡ nÃ y, má»›i cÃ¡c báº¡n theo dÃµi.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"}]},{"title":"[Regex] Há»c rá»“i mÃ  nhÆ° chÆ°a há»c","slug":"Regex-Hoc-roi-ma-nhu-chua-hoc","date":"2018-04-25T10:23:00.000Z","updated":"2018-04-25T10:44:38.060Z","comments":true,"path":"2018/04/Regex-Hoc-roi-ma-nhu-chua-hoc.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Regex-Hoc-roi-ma-nhu-chua-hoc.html","excerpt":"NgÆ°á»i dáº«n láº¡i bÃ i nÃ y cÅ©ng Ä‘Æ°á»£c phen lao Ä‘ao khi lá»¥c lá»i láº¡i má»› kiáº¿n thá»©c cÆ¡ báº£n cÅ©. Äá»‘i vá»›i sá»± nghiá»‡p cá»§a má»™t coder thÃ¬ pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n liÃªn tá»¥c, náº¿u khÃ´ng sáº½ ráº¥t dá»… quÃªn vÃ  lÃ³ng ngÃ³ng dÃ¹ chá»‰ lÃ  nhá»¯ng kiáº¿n thá»©c cÆ¡ báº£n nháº¥t. Dáº«u biáº¿t ráº±ng search lÃ  sáº½ tháº¥y nhÆ°ng nhiá»u phen cÅ©ng khÃ´ng khá»i tháº¹n vÃ¬ giáº£i thÃ­ch sai cho Ä‘Ã n em =)) CÅ©ng may Ä‘á»c láº¡i Ä‘Æ°á»£c bÃ i cá»§a cu em cÃ´ng ty, kiáº¿n thá»©c láº¡i nhanh chÃ³ng Ä‘Æ°á»£c khá»a láº¥p, vÃ¬ kiáº¿n thá»©c ná»™i bá»™ nÃªn xin Ä‘Æ°á»£c trÃ­ch láº¡i bÃ i chia sáº» cá»§a em nÃ³ Ä‘á»ƒ Ä‘Ã¢y cho Ä‘á»¡ quÃªn.!","text":"NgÆ°á»i dáº«n láº¡i bÃ i nÃ y cÅ©ng Ä‘Æ°á»£c phen lao Ä‘ao khi lá»¥c lá»i láº¡i má»› kiáº¿n thá»©c cÆ¡ báº£n cÅ©. Äá»‘i vá»›i sá»± nghiá»‡p cá»§a má»™t coder thÃ¬ pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n liÃªn tá»¥c, náº¿u khÃ´ng sáº½ ráº¥t dá»… quÃªn vÃ  lÃ³ng ngÃ³ng dÃ¹ chá»‰ lÃ  nhá»¯ng kiáº¿n thá»©c cÆ¡ báº£n nháº¥t. Dáº«u biáº¿t ráº±ng search lÃ  sáº½ tháº¥y nhÆ°ng nhiá»u phen cÅ©ng khÃ´ng khá»i tháº¹n vÃ¬ giáº£i thÃ­ch sai cho Ä‘Ã n em =)) CÅ©ng may Ä‘á»c láº¡i Ä‘Æ°á»£c bÃ i cá»§a cu em cÃ´ng ty, kiáº¿n thá»©c láº¡i nhanh chÃ³ng Ä‘Æ°á»£c khá»a láº¥p, vÃ¬ kiáº¿n thá»©c ná»™i bá»™ nÃªn xin Ä‘Æ°á»£c trÃ­ch láº¡i bÃ i chia sáº» cá»§a em nÃ³ Ä‘á»ƒ Ä‘Ã¢y cho Ä‘á»¡ quÃªn.! 1. Tá»±a Ä‘á»MÃ¬nh váº«n cÃ²n nhá»› cÃ¡i hÃ´m Ä‘áº¥y. Trong khi mÃ£i ngáº¯m nhÃ¬n nhá»¯ng dÃ²ng code Ä‘áº¿n hoa máº¯t lÃ  lÃºc máº·t trá»i Ä‘Ã£ láº·n khuáº¥t sau nhá»¯ng toÃ  nhÃ  Ä‘Ã´ thá»‹ tá»« lÃºc nÃ o cÅ©ng khÃ´ng ai hay. BÃªn ngoÃ i mÆ°a giÃ³ bÃ£o bÃ¹ng, lÃºc mÃ  mÃ¬nh Ä‘ang cá»‘ release cho cÃ¡i dá»± Ã¡n lá»¥t khÃ´ng cáº§n nÆ°á»›c, cho nÃ³ cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c. NhÆ°ng hÃ´m Ä‘áº¥y cÅ©ng khÃ´ng náº±m ngoÃ i dá»± tÃ­nh, nÃ³ váº«n bá»‹ fail nhÆ° bao láº§n trÆ°á»›c, láº§n nÃ y nguyÃªn nhÃ¢n lÃ  do validate dá»¯ liá»‡u bá»‹ sai. LÃºc Ä‘áº¥y pháº£i cáº§n fix luÃ´n ngay nhÆ°ng tháº­t khÃ´ng may lÃ  anh phá»¥ trÃ¡ch lÃ m pháº§n Ä‘áº¥y Ä‘Ã£ tá»‘c biáº¿n vá» nhÃ  lÃºc nÃ o khÃ´ng rÃµ. CÃ²n báº£n thÃ¢n thÃ¬ cháº£ biáº¿t tÃ­ táº¹o vá» regex cáº£. Má»i thá»© dÆ°á»ng nhÆ° báº¿ táº¯c! ÄÃ£ Ä‘áº¿n lÃºc mÃ¬nh pháº£i Ä‘á»c cÃ¡i regex mÃ  anh kia Ä‘Ã£ viáº¿t! NhÃ¬n nhá»¯ng dÃ²ng Ä‘áº¥y chá»‰ cÃ³ thá»ƒ thá»‘t lÃªn â€œwth, mÃ¬nh Ä‘ang Ä‘á»c cÃ¡i ná»“i gÃ¬ tháº¿ nÃ yâ€. Tháº­t khÃ´ng thá»ƒ náº¿u báº¡n cháº£ cÃ³ kiáº¿n thá»©c gÃ¬ vá» nÃ³ cáº£. Thá»±c ra mÃ¬nh vÃ  nhiá»u ngÆ°á»i hay máº¯c táº­t lÃºc cáº§n lÃ m gÃ¬ lÃ  chá»‰ cáº§n search tá»« khoÃ¡ trÃªn anh google rá»“i copy vÃ o code cá»§a mÃ¬nh, tuy khÃ´ng hiá»ƒu rÃµ nhÆ°ng tháº¥y nÃ³ cháº¡y á»•n thÃ¬ ok. Äáº¿n lÃºc lá»—i lÃªn thÃ¬ cháº£ biáº¿t fix tháº¿ nÃ o. CÅ©ng vÃ¬ nguyÃªn nhÃ¢n Ä‘áº¥y mÃ  mÃ¬nh má»›i biáº¿t lÃ  Ä‘ang lÃ m má»™t cÃ¡ch sai láº§m vÃ  mÃ¹ quÃ¡ng vÃ  báº¯t Ä‘áº§u há»c má»™t cÃ¡ch Ä‘Ãºng Ä‘áº¯n hÆ¡n. TrÆ°á»›c máº¯t lÃ  pháº£i tÃ¬m hiá»ƒu vá» regex xem nÃ³ cÃ³ gÃ¬ mÃ  nhÃ¬n vÃ o Ä‘Ã£ tháº¥y sá»£ rá»“i. Báº¡n Ä‘Ã£ tá»«ng bao giá» rÆ¡i vÃ o trÆ°á»ng há»£p nhÆ° mÃ¬nh chÆ°a, cáº§n kiá»ƒm tra Ä‘á»‹nh dáº¡ng má»™t chuá»—i cÃ³ há»£p lá»‡, hoáº·c tÃ¬m kiáº¿m má»™t chuá»—i náº±m trong má»™t chuá»—i dÃ i khÃ¡c. Äa sá»‘ cÃ¡c báº¡n cáº§n dÃ¹ng Ä‘áº¿n viá»‡c validate (xÃ¡c minh) tÃ­nh há»£p lá»‡ cá»§a dá»¯ liá»‡u Ä‘á»u Ä‘Ã£ tá»« gáº·p pháº£i cÃ¢u há»i Ä‘áº¥y. Náº¿u báº¡n gáº·p trÆ°á»ng há»£p lÃºc Ä‘áº¥y giáº£i phÃ¡p Ä‘áº§u tiÃªn báº¡n nghÄ© Ä‘áº¿n lÃ  gÃ¬ náº¿u chÆ°a biáº¿t gÃ¬ vá» regex? CÃ³ thá»ƒ nÃ³ sáº½ trá»Ÿ thÃ nh má»™t bÃ i toÃ¡n khÃ¡ hÃ³c bÃºa náº¿u báº¡n chá»‰ xá»­ lÃ½ thuáº§n tuÃ½ báº±ng cÃ¡ch duyá»‡t chuá»—i mÃ  khÃ´ng cÃ³ cÃ´ng cá»¥ vÃ  thÆ° viá»‡n xá»­ lÃ½. Váº­y regex lÃ  gÃ¬? NÃ³ giáº£i quyáº¿t bÃ i toÃ¡n khÃ´ng tÆ°á»Ÿng á»Ÿ trÃªn nhÆ° tháº¿ nÃ o? NÃ³ cao siÃªu vÃ  áº£o diá»‡u ra sao? ChÃºng ta hÃ£y cÃ¹ng Ä‘i tÃ¬m hiá»ƒu nÃ o! 2. Giá»›i thiá»‡uTheo anh wiki Biá»ƒu thá»©c chÃ­nh quy (regular expression, viáº¿t táº¯t lÃ  regexp, regex hay regxp) lÃ  má»™t chuá»—i miÃªu táº£ má»™t bá»™ cÃ¡c chuá»—i khÃ¡c, theo nhá»¯ng quy táº¯c cÃº phÃ¡p nháº¥t Ä‘á»‹nh. CÃ¹ng Ä‘iá»ƒm má»™t chÃºt vá» lá»‹ch sá»­ nhá»‰. KhÃ¡i niá»‡m regex Ä‘Æ°á»£c báº¯t Ä‘áº§u Ä‘Æ°a ra tá»« nhá»¯ng nÄƒm 1950 khi mÃ  nhÃ  toÃ¡n há»c ngÆ°á»i Má»¹ Stephen Cole Kleene chÃ­nh thá»©c mÃ´ táº£ má»™t ngÃ´n ngá»¯ chÃ­nh quy KhÃ¡i niá»‡m nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n trong cÃ¡c tiá»‡n Ã­ch xá»­ lÃ½ vÄƒn báº£n Unix. Sau Ä‘áº¥y, tá»« nhá»¯ng nÄƒm 1980, tá»“n táº¡i cÃ¡c cÃº phÃ¡p khÃ¡c nhau Ä‘á»ƒ táº¡o ra cÃ¡c biá»ƒu thá»©c chÃ­nh quy. CÃ¡c chuáº©n Ä‘Æ°á»£c Ä‘Æ°a ra vÃ  sá»­ dá»¥ng rá»™ng rÃ£i nháº¥t lÃ  cÃº phÃ¡p Perl Má»—i láº§n mÃ¬nh tÃ¬m hiá»ƒu xong má»™t thá»i gian khÃ´ng dÃ¹ng Ä‘áº¿n, lÃºc quay láº¡i Ä‘á»c Ä‘á»u cÃ³ cáº£m giÃ¡c nhÆ° má»›i :). 3. CÃ´ng dá»¥ngRegex Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i ráº¥t nhiá»u má»¥c Ä‘Ã­ch khÃ¡c nhau nhÆ°ng thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng nhiá»u vá»›i má»¥c Ä‘Ã­ch Ä‘á»‘i sÃ¡nh vÄƒn báº£n vÃ  kiá»ƒm tra cÃº phÃ¡p trong cÃ¡c trÃ¬nh biÃªn táº­p vÄƒn báº£n vÃ  cÃ¡c tiá»‡n Ã­ch tÃ¬m kiáº¿m vÃ  xá»­ lÃ½ vÄƒn báº£n dá»±a trÃªn cÃ¡c máº«u Ä‘Æ°á»£c quy Ä‘á»‹nh. VÃ­ dá»¥: Náº¿u báº¡n muá»‘n táº¡o bá»™ lá»c vÃ  muá»‘n loáº¡i bá» dá»¯ liá»‡u lÃ  nhá»¯ng trang web mÃ  ngÆ°á»i khÃ¡c táº¡o ra, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy Ä‘á»ƒ loáº¡i trá»« báº¥t ká»³ dá»¯ liá»‡u nÃ o tá»« toÃ n bá»™ dáº£i Ä‘á»‹a chá»‰ IP ngÆ°á»i khÃ¡c sá»­ dá»¥ng. Giáº£ sá»­ cÃ¡c Ä‘á»‹a chá»‰ IP Ä‘Ã³ cÃ³ dáº£i tá»« 198.51.100.1 - 198.51.100.25. Thay vÃ¬ nháº­p 25 Ä‘á»‹a chá»‰ IP khÃ¡c nhau, báº¡n cÃ³ thá»ƒ táº¡o biá»ƒu thá»©c chÃ­nh quy nhÆ° 198.51.100.\\d* Ä‘á»ƒ Ä‘á»‘i sÃ¡nh vá»›i toÃ n bá»™ dáº£i Ä‘á»‹a chá»‰. 4. CÃ¡ch dÃ¹ngCÃ¡c kÃ­ tá»± Ä‘áº·c biá»‡tBáº£ng 4.1 CÃ¡c kÃ­ tá»± Ä‘áº·c biá»‡t trong biá»ƒu thá»©c chÃ­nh quy. KÃ­ tá»± (kÃ­ hiá»‡u, cá») Ã nghÄ©a \\ TÃ¬m vá»›i luáº­t dÆ°á»›i Ä‘Ã¢y: Má»™t dáº¥u gáº¡ch chÃ©o ngÆ°á»£c sáº½ biáº¿n má»™t kÃ­ tá»± thÆ°á»ng liá»n káº¿ phÃ­a sau thÃ nh má»™t kÃ­ tá»± Ä‘áº·c biá»‡t, tá»©c lÃ  nÃ³ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m thÃ´ng thÆ°á»ng ná»¯a. VÃ­ dá»¥, trÆ°á»ng há»£p kÃ­ tá»± â€˜bâ€™ khÃ´ng cÃ³ dáº¥u gáº¡ch chÃ©o ngÆ°á»£c nÃ y sáº½ Ä‘Æ°á»£c khá»›p vá»›i cÃ¡c kÃ­ tá»± â€˜bâ€™ in thÆ°á»ng, nhÆ°ng khi nÃ³ cÃ³ thÃªm dáº¥u gáº¡ch chÃ©o ngÆ°á»£c, â€˜\\bâ€™ thÃ¬ nÃ³ sáº½ khÃ´ng khá»›p vá»›i báº¥t kÃ¬ kÃ­ tá»± nÃ o ná»¯a, lÃºc nÃ y nÃ³ trá»Ÿ thÃ nh kÃ­ tá»± Ä‘áº·c biá»‡t. Xem thÃªm pháº§n word boundary character Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t. Tuy nhiÃªn náº¿u Ä‘á»©ng trÆ°á»›c má»™t kÃ­ tá»± Ä‘áº·c biá»‡t thÃ¬ nÃ³ sáº½ biáº¿n kÃ­ tá»± nÃ y thÃ nh má»™t kÃ­ tá»± thÆ°á»ng, tá»©c lÃ  báº¡n cÃ³ thá»ƒ tÃ¬m kiáº¿m kÃ­ tá»± Ä‘áº·c biá»‡t nÃ y trong xÃ¢u chuá»—i cá»§a báº¡n nhÆ° cÃ¡c kÃ­ tá»± thÆ°á»ng khÃ¡c. VÃ­ dá»¥, máº«u /a/ cÃ³ â€˜â€™ lÃ  kÃ­ tá»± Ä‘áº·c biá»‡t vÃ  máº«u nÃ y sáº½ bá»‹ phá»¥ thuá»™c vÃ o kÃ­ tá»± nÃ y, nÃªn Ä‘Æ°á»£c hiá»ƒu lÃ  sáº½ tÃ¬m khá»›p vá»›i 0 hoáº·c nhiá»u kÃ­ tá»± a. NhÆ°ng, vá»›i máº«u /a/ thÃ¬ kÃ­ tá»± â€˜â€™ lÃºc nÃ y Ä‘Æ°á»£c hiá»ƒu lÃ  kÃ­ tá»± thÆ°á»ng nÃªn máº«u nÃ y sáº½ tÃ¬m kiáº¿m xÃ¢u con lÃ  â€˜a*â€™. Äá»«ng quÃªn \\ cÅ©ng lÃ  má»™t kÃ­ tá»± Ä‘áº·c biá»‡t, khi cáº§n so khá»›p chÃ­nh nÃ³ ta cÅ©ng pháº£i Ä‘Ã¡nh dáº¥u nÃ³ lÃ  kÃ­ tá»± Ä‘áº·c biá»‡t báº±ng cÃ¡ch Ä‘áº·t \\ á»Ÿ trÆ°á»›c (). ^ Khá»›p cÃ¡c kÃ­ tá»± Ä‘á»©ng Ä‘áº§u má»™t chuá»—i. Náº¿u cÃ³ nhiá»u cá» nÃ y thÃ¬ nÃ³ cÃ²n khá»›p Ä‘Æ°á»£c cáº£ cÃ¡c kÃ­ tá»± Ä‘á»©ng Ä‘áº§u cá»§a má»—i dÃ²ng (sau kÃ­ tá»± xuá»‘ng dÃ²ng). VÃ­ dá»¥, /^A/ sáº½ khÃ´ng khá»›p Ä‘Æ°á»£c vá»›i â€˜Aâ€™ trong â€œan Aâ€ vÃ¬ â€˜Aâ€™ lÃºc nÃ y khÃ´ng Ä‘á»©ng Ä‘áº§u chuá»—i, nhÆ°ng nÃ³ sáº½ khá»›p â€œAn Eâ€ vÃ¬ lÃºc nÃ y â€˜Aâ€™ Ä‘Ã£ Ä‘á»©ng Ä‘áº§u chuá»—i. Ã nghÄ©a cá»§a â€˜^â€™ sáº½ thay Ä‘á»•i khi nÃ³ xuáº¥t hiá»‡n nhÆ° má»™t kÃ­ tá»± Ä‘áº§u tiÃªn trong má»™t lá»›p kÃ­ tá»±, xem pháº§n complemented character sets Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t. $ So khá»›p á»Ÿ cuá»‘i chuá»—i. Náº¿u gáº¯n cá» multiline (Ä‘a dÃ²ng), nÃ³ sáº½ khá»›p ngay trÆ°á»›c kÃ­ tá»± xuá»‘ng dÃ²ng.VÃ­ dá»¥, /t$/ khÃ´ng khá»›p vá»›i â€˜tâ€™ trong chuá»—i â€œeaterâ€ nhÆ°ng láº¡i khá»›p trong chuá»—i â€œeatâ€. * Cho phÃ©p kÃ­ tá»± trÆ°á»›c nÃ³ láº·p láº¡i 0 láº§n hoáº·c nhiá»u láº§n. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¡ch viáº¿t {0,}.VÃ­ dá»¥, /bo*/ khá»›p vá»›i â€˜booooâ€™ trong chuá»—i â€œA ghost booooedâ€ nhÆ°ng khÃ´ng khá»›p trong chuá»—i â€œA birth warbledâ€. + Cho phÃ©p kÃ­ tá»± trÆ°á»›c nÃ³ láº·p láº¡i 1 láº§n hoáº·c nhiá»u láº§n. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¡ch viáº¿t {1,}.VÃ­ dá»¥, /a+/ khá»›p vá»›i â€˜aâ€™ trong chuá»—i â€œcandyâ€ vÃ  khá»›p vá»›i táº¥t cáº£ kÃ­ tá»± a liá»n nhau trong chuá»—i â€œcaaaaaaandyâ€. ? Cho phÃ©p kÃ­ tá»± trÆ°á»›c nÃ³ láº·p láº¡i 0 láº§n hoáº·c 1 láº§n duy nháº¥t. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¡ch viáº¿t {0,1}.VÃ­ dá»¥, /e?le?/ khá»›p vá»›i â€˜elâ€™ trong chuá»—i â€œangelâ€ vÃ  â€˜leâ€™ trong chuá»—i â€œangleâ€ hay â€˜lâ€™ trong â€œosloâ€.Náº¿u sá»­ dá»¥ng kÃ­ tá»± nÃ y ngay sau báº¥t kÃ¬ kÃ­ tá»± Ä‘á»‹nh lÆ°á»£ng nÃ o trong sá»‘ *,+,? hay {}, Ä‘á»u lÃ m bá»™ Ä‘á»‹nh lÆ°á»£ng â€œchÃ¡n Äƒnâ€ (dá»«ng so khá»›p sau ngay khi tÃ¬m Ä‘Æ°á»£c kÃ­ tá»± phÃ¹ há»£p), trÃ¡i ngÆ°á»£c vá»›i Ä‘á»©c tÃ­nh â€œtham lamâ€ vá»‘n sáºµn cá»§a chÃºng (khá»›p táº¥t cáº£ kÃ­ tá»± chÃºng tÃ¬m tháº¥y). VÃ­ dá»¥, Ã¡p dá»¥ng biá»ƒu máº«u /\\d+/ cho â€œ123abcâ€ ta Ä‘Æ°á»£c â€œ123â€. NhÆ°ng Ã¡p /\\d+?/ cho chÃ­nh chuá»—i trÃªn ta chá»‰ nháº­n Ä‘Æ°á»£c káº¿t quáº£ lÃ  â€œ1â€.Báº¡n cÃ³ thá»ƒ Ä‘á»c thÃªm trong má»¥c x(?=y) vÃ  x(?!y) cá»§a báº£ng nÃ y. . Dáº¥u . khá»›p vá»›i báº¥t kÃ¬ kÃ­ tá»± Ä‘Æ¡n nÃ o ngoáº¡i trá»« kÃ­ tá»± xuá»‘ng dÃ²ng.VÃ­ dá»¥, /.n/ khá»›p vá»›i â€˜anâ€™ vÃ  â€˜onâ€™ trong chuá»—i â€œno, an apple is on the treeâ€, nhÆ°ng khÃ´ng khá»›p vá»›i â€˜noâ€™. (x) Khá»›p â€˜xâ€™ vÃ  nhá»› káº¿t quáº£ so khá»›p nÃ y, nhÆ° vÃ­ dá»¥ á»Ÿ dÆ°á»›i. CÃ¡c dáº¥u ngoáº·c trÃ²n Ä‘Æ°á»£c gá»i lÃ  cÃ¡c dáº¥u ngoáº·c cÃ³ nhá»›.Biá»ƒu máº«u /(foo) (bar) \\1 \\2/ khá»›p vá»›i â€˜fooâ€™ vÃ  â€˜barâ€™ trong chuá»—i â€œfoo bar foo barâ€. \\1 vÃ  \\2 trong máº«u khá»›p vá»›i 2 tá»« cuá»‘i.ChÃº Ã½ ráº±ng \\1, \\2, \\n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ so khá»›p cÃ¡c pháº§n trong regex, nÃ³ Ä‘áº¡i diá»‡n cho nhÃ³m so khá»›p Ä‘áº±ng trÆ°á»›c. VÃ­ dá»¥: /(foo) (bar) \\1 \\2/ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i biá»ƒu thá»©c /(foo) (bar) foo bar/. CÃº phÃ¡p $1, $2, $n cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng trong viá»‡c thay tháº¿ cÃ¡c pháº§n cá»§a má»™t regex. VÃ­ dá»¥: â€˜bar fooâ€™.replace(/(â€¦) (â€¦)/, â€˜$2 $1â€™) sáº½ Ä‘áº£o vá»‹ trÃ­ 2 tá»« â€˜barâ€™ vÃ  â€˜fooâ€™ cho nhau. (?:x) Khá»›p â€˜xâ€™ nhÆ°ng khÃ´ng nhá»› káº¿t quáº£ so khá»›p. Nhá»¯ng dáº¥u ngoáº·c trÃ²n Ä‘Æ°á»£c gá»i lÃ  nhá»¯ng dáº¥u ngoáº·c khÃ´ng nhá»›, nÃ³ cho phÃ©p báº¡n Ä‘á»‹nh nghÄ©a nhá»¯ng biá»ƒu thá»©c con cho nhá»¯ng toÃ¡n tá»­ so khá»›p. Xem xÃ©t biá»ƒu thá»©c Ä‘Æ¡n giáº£n /(?:foo){1,2}/. Náº¿u biá»ƒu thá»©c nÃ y Ä‘Æ°á»£c viáº¿t lÃ  /foo{1,2}/, {1,2} sáº½ chá»‰ Ã¡p dá»¥ng cho kÃ­ tá»± â€˜oâ€™ á»Ÿ cuá»‘i chuá»—i â€˜fooâ€™. Vá»›i nhá»¯ng dáº¥u ngoáº·c khÃ´ng nhá»›, {1,2} sáº½ Ã¡p dá»¥ng cho cáº£ cá»¥m â€˜fooâ€™. x(?=y) Chá»‰ khá»›p â€˜xâ€™ náº¿u â€˜xâ€™ theo sau bá»Ÿi â€˜yâ€™.VÃ­ dá»¥, /Jack(?=Sprat)/ chá»‰ khá»›p vá»›i â€˜Jackâ€™ náº¿u Ä‘áº±ng sau nÃ³ lÃ  â€˜Spratâ€™. /Jack(?=Sprat x(?!y) Chá»‰ khá»›p â€˜xâ€™ náº¿u â€˜xâ€™ khÃ´ng Ä‘Æ°á»£c theo sau bá»Ÿi â€˜yâ€™.VÃ­ dá»¥: /\\d+(?!.)/ chá»‰ khá»›p vá»›i sá»‘ khÃ´ng cÃ³ dáº¥u . Ä‘áº±ng sau. Biá»ƒu thá»©c /\\d+(?!.)/.exec(â€œ3.141â€)â€‹ cho káº¿t quáº£ lÃ  â€˜141â€™ mÃ  khÃ´ng pháº£i â€˜3.141â€™. x y {n} KÃ­ tá»± Ä‘á»©ng trÆ°á»›c pháº£i xuáº¥t hiá»‡n n láº§n. n pháº£i lÃ  má»™t sá»‘ nguyÃªn dÆ°Æ¡ng.VÃ­ dá»¥, /a{2}/ khÃ´ng khá»›p vá»›i â€˜aâ€™ trong â€œcandyâ€, nhÆ°ng nÃ³ khá»›p vá»›i táº¥t cáº£ kÃ­ tá»± â€˜aâ€™ trong â€œcaandyâ€, vÃ  khá»›p vá»›i 2 kÃ­ tá»± â€˜aâ€™ Ä‘áº§u tiÃªn trong â€œcaaandyâ€. {n,m} KÃ­ tá»± Ä‘á»©ng trÆ°á»›c pháº£i xuáº¥t hiá»‡n tá»« n Ä‘áº¿n m láº§n. n vÃ  m lÃ  sá»‘ nguyÃªn dÆ°Æ¡ng vÃ  n &lt;= m. Náº¿u m bá»‹ bá» qua, nÃ³ tÆ°Æ¡ng Ä‘Æ°Æ¡ng nhÆ° âˆ.VÃ­ dá»¥, /a{1,3}/ khÃ´ng khá»›p báº¥t kÃ¬ kÃ­ tá»± nÃ o trong â€œcndyâ€, kÃ­ tá»± â€˜aâ€™ trong â€œcandyâ€, 2 kÃ­ tá»± â€˜aâ€™ Ä‘áº§u tiÃªn trong â€œcaandyâ€, vÃ  3 kÃ­ tá»± â€˜aâ€™ Ä‘áº§u tiÃªn trong â€œcaaaaaaandyâ€. LÆ°u Ã½ lÃ  â€œcaaaaaaandyâ€ chá»‰ khá»›p vá»›i 3 kÃ­ tá»± â€˜aâ€™ Ä‘áº§u tiÃªn máº·c dÃ¹ chuá»—i Ä‘Ã³ chá»©a 7 kÃ­ tá»± â€˜aâ€™. [xyz] Lá»›p kÃ­ tá»±. Loáº¡i máº«u nÃ y dÃ¹ng Ä‘á»ƒ so khá»›p vá»›i má»™t kÃ­ tá»± báº¥t kÃ¬ trong dáº¥u ngoáº·c vuÃ´ng, bao gá»“m cáº£ escape sequences. Trong lá»›p kÃ­ tá»±, dáº¥u cháº¥m (.) vÃ  dáº¥u hoa thá»‹ (*) khÃ´ng cÃ²n lÃ  kÃ­ tá»± Ä‘áº·c biá»‡t nÃªn ta khÃ´ng cáº§n kÃ­ tá»± thoÃ¡t Ä‘á»©ng trÆ°á»›c nÃ³. Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh má»™t khoáº£ng kÃ­ tá»± báº±ng cÃ¡ch sá»­ dá»¥ng má»™t kÃ­ tá»± gáº¡ch ná»‘i (-) nhÆ° trong vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y:Máº«u [a-d] so khá»›p tÆ°Æ¡ng tá»± nhÆ° máº«u [abcd], khá»›p vá»›i â€˜bâ€™ trong â€œbrisketâ€ vÃ  â€˜câ€™ trong â€œcityâ€. Máº«u /[a-z.]+/ vÃ  /[\\w.]+/ khá»›p vá»›i toÃ n chuá»—i â€œtest.i.ngâ€. [^xyz] Lá»›p kÃ­ tá»± phá»§ Ä‘á»‹nh. Khi kÃ­ tá»± ^ Ä‘á»©ng Ä‘áº§u tiÃªn trong dáº¥u ngoáº·c vuÃ´ng, nÃ³ phá»§ Ä‘á»‹nh máº«u nÃ y.VÃ­ dá»¥, [^abc] tÆ°Æ¡ng tá»± nhÆ° [^a-c], khá»›p vá»›i â€˜râ€™ trong â€œbrisketâ€ vÃ  â€˜hâ€™ trong â€œchopâ€ lÃ  kÃ­ tá»± Ä‘áº§u tiÃªn khÃ´ng thuá»™c khoáº£ng a Ä‘áº¿n c. [\\b] Khá»›p vá»›i kÃ­ tá»± dá»‹ch lÃ¹i - backspace (U+0008). Báº¡n pháº£i Ä‘áº·t trong dáº¥u ngoáº·c vuÃ´ng náº¿u muá»‘n so khá»›p má»™t kÃ­ tá»± dá»‹ch lÃ¹i. (Äá»«ng nháº§m láº«n vá»›i máº«u \\b). \\b Khá»›p vá»›i kÃ­ tá»± biÃªn. KÃ­ tá»± biÃªn lÃ  má»™t kÃ­ tá»± giáº£, nÃ³ khá»›p vá»›i vá»‹ trÃ­ mÃ  má»™t kÃ­ tá»± khÃ´ng Ä‘Æ°á»£c theo sau hoáº·c Ä‘á»©ng trÆ°á»›c bá»Ÿi má»™t kÃ­ tá»± khÃ¡c. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i máº«u (^\\w \\B Khá»›p vá»›i kÃ­ tá»± khÃ´ng pháº£i kÃ­ tá»± biÃªn. Máº«u nÃ y khá»›p táº¡i vá»‹ trÃ­ mÃ  kÃ­ tá»± trÆ°á»›c vÃ  kÃ­ tá»± sau nÃ³ cÃ¹ng kiá»ƒu: hoáº·c cáº£ hai lÃ  kÃ­ tá»± hoáº·c cáº£ hai khÃ´ng pháº£i lÃ  kÃ­ tá»±. Báº¯t Ä‘áº§u vÃ  káº¿t thÃºc chuá»—i khÃ´ng Ä‘Æ°á»£c xem lÃ  nhá»¯ng kÃ­ tá»±.VÃ­ dá»¥, /\\B../ khá»›p vá»›i â€˜ooâ€™ trong â€œnoondayâ€, vÃ  /y\\B./ khá»›p vá»›i â€˜yeâ€™ trong â€œpossibly yesterday.â€ \\cX X lÃ  má»™t kÃ­ tá»± trong khoáº£ng A tá»›i Z. Máº«u nÃ y khá»›p vá»›i má»™t kÃ­ tá»± Ä‘iá»u khiá»ƒn trong má»™t chuá»—i.VÃ­ dá»¥: /\\cM/ khá»›p vá»›i control-M (U+000D) trong chuá»—i. \\d Khá»›p vá»›i má»™t kÃ­ tá»± sá»‘. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i máº«u [0-9].VÃ­ dá»¥: /\\d/ hoáº·c /[0-9]/ khá»›p vá»›i â€˜2â€™ trong chuá»—i â€œB2 is the suite number.â€ \\D Khá»›p vá»›i má»™t kÃ­ tá»± khÃ´ng pháº£i lÃ  kÃ­ tá»± sá»‘. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i máº«u [^0-9].VÃ­ dá»¥; /\\D/ hoáº·c /[^0-9]/ khá»›p vá»›i â€˜Bâ€™ trong â€œB2 is the suite number.â€ \\f Khá»›p vá»›i kÃ­ tá»± phÃ¢n trang - form feed (U+000C). \\n Khá»›p vá»›i kÃ­ tá»± xuá»‘ng dÃ²ng - line feed (U+000A). \\r Khá»›p vá»›i kÃ­ tá»± quay Ä‘áº§u dÃ²ng - carriage return (U+000D). \\s Khá»›p vá»›i má»™t kÃ­ tá»± khoáº£ng tráº¯ng, bao gá»“m trá»‘ng - space, tab, phÃ¢n trang - form feed, phÃ¢n dÃ²ng - line feed. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i [ \\f\\n\\r\\t\\vâ€‹\\u00a0\\u1680â€‹\\u180e\\u2000â€‹\\u2001\\u2002â€‹\\u2003\\u2004â€‹\\u2005\\u2006â€‹\\u2007\\u2008â€‹\\u2009\\u200aâ€‹\\u2028\\u2029â€‹â€‹\\u202f\\u205fâ€‹\\u3000].VÃ­ dá»¥: /\\s\\w*/ khá»›p vá»›i â€˜ barâ€™ trong â€œfoo bar.â€ \\S Khá»›p vá»›i má»™t kÃ­ tá»± khÃ´ng pháº£i khoáº£ng tráº¯ng. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i [^ \\f\\n\\r\\t\\vâ€‹\\u00a0\\u1680â€‹\\u180e\\u2000â€‹\\u2001\\u2002â€‹\\u2003\\u2004â€‹\\u2005\\u2006â€‹\\u2007\\u2008â€‹\\u2009\\u200aâ€‹\\u2028\\u2029â€‹\\u202f\\u205fâ€‹\\u3000].VÃ­ dá»¥: /\\S\\w*/ khá»›p vá»›i â€˜fooâ€™ trong chuá»—i â€œfoo bar.â€ \\t Khá»›p vá»›i kÃ­ tá»± tab (U+0009). \\v Khá»›p vá»›i kÃ­ tá»± vertical tab (U+000B). \\w Khá»›p vá»›i táº¥t cáº£ kÃ­ tá»± lÃ  chá»¯, sá»‘ vÃ  gáº¡ch dÆ°á»›i. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i máº«u [A-Za-z0-9_].VÃ­ dá»¥, /\\w/ khá»›p vá»›i â€˜aâ€™ trong â€œapple,â€ â€˜5â€™ trong â€œ$5.28,â€ vÃ  â€˜3â€™ trong â€œ3D.â€ \\W Khá»›p vá»›i táº¥t cáº£ kÃ­ tá»± khÃ´ng pháº£i lÃ  chá»¯. TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i máº«u [^A-Za-z0-9_].VÃ­ dá»¥, /\\W/ hoáº·c /[^A-Za-z0-9_]/ khá»›p vá»›i â€˜%â€™ trong â€œ50%.â€ \\n Trong Ä‘Ã³, n lÃ  má»™t sá»‘ nguyÃªn dÆ°Æ¡ng, má»™t tham chiáº¿u ngÆ°á»£c tá»›i chuá»—i khá»›p thá»© n trong biá»ƒu thá»©c (Ä‘áº¿m tá»« trÃ¡i sang, báº¯t Ä‘áº§u báº±ng 1).VÃ­ dá»¥, /apple(,)\\sorange\\1/ hay /apple(,)\\sorange,/ khá»›p vá»›i â€˜apple, orange,â€™ trong chuá»—i â€œapple, orange, cherry, peach.â€ \\0 Khá»›p vá»›i kÃ­ tá»± NULL (U+0000). LÆ°u Ã½: khÃ´ng Ä‘Æ°á»£c thÃªm báº¥t kÃ¬ má»™t kÃ­ tá»± sá»‘ nÃ o sau 0, vÃ¬ \\0 lÃ  má»™t biá»ƒu diá»…n há»‡ bÃ¡t phÃ¢n escape sequence. \\xhh Khá»›p vá»›i kÃ­ tá»± vá»›i mÃ£ code lÃ  hh (2 sá»‘ trong há»‡ tháº­p lá»¥c phÃ¢n) \\uhhhh Khá»›p vá»›i kÃ­ tá»± cÃ³ mÃ£ hhhh (4 sá»‘ trong há»‡ tháº­p lá»¥c phÃ¢n). LÃ m viá»‡c vá»›i biá»ƒu thá»©c chÃ­nh quyBáº£ng 4.2 Nhá»¯ng phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c sá»­ dá»¥ng trong biá»ƒu thá»©c chÃ­nh quy PhÆ°Æ¡ng thá»©c MÃ´ táº£ exec Má»™t phÆ°Æ¡ng thá»©c cá»§a RegExp dÃ¹ng Ä‘á»ƒ tÃ¬m kiáº¿m chuá»—i phÃ¹ há»£p vá»›i máº«u so khá»›p. NÃ³ tráº£ vá» má»™t máº£ng chá»©a káº¿t quáº£ tÃ¬m kiáº¿m. test Má»™t phÆ°Æ¡ng thá»©c cá»§a RegExp dÃ¹ng Ä‘á»ƒ kiá»ƒm tra máº«u cÃ³ khá»›p vá»›i chuá»—i hay khÃ´ng. NÃ³ tráº£ vá» giÃ¡ trá»‹ true hoáº·c false. match Má»™t phÆ°Æ¡ng thá»©c cá»§a chuá»—i dÃ¹ng Ä‘á»ƒ tÃ¬m kiáº¿m chuá»—i phÃ¹ há»£p vá»›i máº«u so khá»›p. NÃ³ tráº£ vá» má»™t máº£ng chá»©a káº¿t quáº£ tÃ¬m kiáº¿m hoáº·c null náº¿u khÃ´ng tÃ¬m tháº¥y. search Má»™t phÆ°Æ¡ng thá»©c cá»§a chuá»—i dÃ¹ng Ä‘á»ƒ tÃ¬m kiáº¿m chuá»—i phÃ¹ há»£p vá»›i máº«u so khá»›p vÃ  tráº£ vá» vá»‹ trÃ­ cá»§a chuá»—i Ä‘Ã³ hoáº·c -1 náº¿u khÃ´ng tÃ¬m tháº¥y. replace Má»™t phÆ°Æ¡ng thá»©c cá»§a chuá»—i dÃ¹ng Ä‘á»ƒ tÃ¬m kiáº¿m má»™t chuá»—i theo máº«u so khá»›p vÃ  thay tháº¿ chuá»—i con Ä‘Æ°á»£c khá»›p vá»›i má»™t chuá»—i thay tháº¿. split Má»™t phÆ°Æ¡ng thá»©c cá»§a chuá»—i dÃ¹ng má»™t biá»ƒu máº«u chÃ­nh quy hoáº·c má»™t chuá»—i báº¥t biáº¿n Ä‘á»ƒ ngáº¯t chuá»—i Ä‘Ã³ thÃ nh má»™t máº£ng cÃ¡c chuá»—i con. VÃ­ dá»¥MÃ£ hÃ³a escapse chuá»—i ngÆ°á»i dÃ¹ng nháº­p vÃ o báº±ng má»™t hÃ m thay tháº¿ Ä‘Æ¡n giáº£n sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy: 123function escapeRegExp(string)&#123; return string.replace(/[.*+?^$&#123;&#125;()|[\\]\\\\]/g, \"\\\\$&amp;\");&#125; Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng trang web Regex101.com , dÃ¡n má»™t Ä‘oáº¡n regex vÃ o Ä‘áº¥y, nÃ³ sáº½ giáº£i thÃ­ch Ä‘oáº¡n mÃ£ Ä‘áº¥y lÃ m gÃ¬. LÆ°u Ã½Giá»¯ biá»ƒu thá»©c chÃ­nh quy cá»§a báº¡n Ä‘Æ¡n giáº£n. Regex Ä‘Æ¡n giáº£n giÃºp ngÆ°á»i dÃ¹ng khÃ¡c hiá»ƒu vÃ  sá»­a Ä‘á»•i dá»… dÃ ng hÆ¡n. Biá»ƒu thá»©c chÃ­nh quy vá» báº£n cháº¥t Ä‘á»‘i sÃ¡nh ráº¥t nhiá»u dá»¯ liá»‡u: náº¿u báº¡n khÃ´ng chá»‰ Ä‘á»‹nh cho regex biáº¿t khÃ´ng nÃªn Ä‘á»‘i sÃ¡nh dá»¯ liá»‡u nÃ o, chÃºng sáº½ Ä‘á»‘i sÃ¡nh vá»›i nhá»¯ng gÃ¬ báº¡n chá»‰ Ä‘á»‹nh vÃ  báº¥t ká»³ kÃ½ tá»± liá»n ká» nÃ o. VÃ­ dá»¥: site Ä‘á»‘i sÃ¡nh vá»›i mysite, yoursite, theirsite, parasiteâ€“báº¥t ká»³ chuá»—i cÃ³ chá»©a â€œsiteâ€. Náº¿u báº¡n cáº§n thá»±c hiá»‡n Ä‘á»‘i sÃ¡nh cá»¥ thá»ƒ, hÃ£y thiáº¿t láº­p cáº¥u trÃºc regex cá»§a báº¡n cho phÃ¹ há»£p. VÃ­ dá»¥: náº¿u báº¡n chá»‰ cáº§n Ä‘á»‘i sÃ¡nh vá»›i chuá»—i â€œsiteâ€, hÃ£y thiáº¿t láº­p cáº¥u trÃºc regex cá»§a báº¡n Ä‘á»ƒ â€œsiteâ€ vá»«a lÃ  báº¯t Ä‘áº§u chuá»—i vá»«a lÃ  káº¿t thÃºc chuá»—i: ^site$. 5. Tham kháº£oAnalytics Trá»£ giÃºpNguá»“n N.T.GiÃ¡p - Kaopiz","categories":[],"tags":[{"name":"regex","slug":"regex","permalink":"http://nthung2112.github.io/tags/regex/"}]},{"title":"Há»c Regular Expression vÃ  cuá»™c Ä‘á»i báº¡n sáº½ bá»›t khá»•","slug":"Hoc-Regular-Expression-va-cuoc-doi-ban-se-bot-kho","date":"2018-04-25T08:27:00.000Z","updated":"2018-04-30T08:06:42.792Z","comments":true,"path":"2018/04/Hoc-Regular-Expression-va-cuoc-doi-ban-se-bot-kho.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Hoc-Regular-Expression-va-cuoc-doi-ban-se-bot-kho.html","excerpt":"Regular Expression (RegEx) Ã ? Nghe quen quen.","text":"Regular Expression (RegEx) Ã ? Nghe quen quen. ÄÃ£ bao giá» báº¡n á»Ÿ vÃ o cÃ¡c tÃ­nh huá»‘ng sau Ä‘Ã¢y? Báº¡n cáº§n xá»­ lÃ½ validate (kiá»ƒm tra tÃ­nh há»£p lá»‡) cÃ¡c trÆ°á»ng dá»¯ liá»‡u nháº­p vÃ o Ã´ Text Báº¡n cáº§n copy vÃ  paste ráº¥t nhiá»u text tá»« chá»— nÃ y sang chá»— kiaVÃ­ dá»¥ tá»« XML sang C# hoáº·c CSV, Excel sang C# TÃ¬m kiáº¿m má»™t chuá»—i náº±m á»Ÿ nhiá»u dÃ²ng trong Visual Studio hoáº·c Notepad++VÃ­ dá»¥ tÃ´i cáº§n tÃ¬m vÃ  xÃ³a bá» (replace all) cÃ¡c comment nhÆ° tháº¿ nÃ y á»Ÿ code cÅ©. Báº¡n cáº§n bÃ³c tÃ¡ch dá»¯ liá»‡u cá»§a má»™t trang web.VÃ­ dá»¥ extract (crawling) tÃ¡ch láº¥y dá»¯ liá»‡u tá»« má»™t trang web Ä‘á»ƒ lÆ°u láº¡i vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n CÆ¡n Ã¡c má»™ng Ä‘á»c má»™t chuá»—i string tá»« DB vÃ  cá»‘ gáº¯ng chuyá»ƒn Ä‘á»•i nÃ³ sang DateTimeChuá»—i ngÃ y thÃ¡ng lÆ°u vÃ o CSDL ráº¥t Ä‘a dáº¡ng. Ráº¥t khÃ³ Ä‘á»ƒ dÃ¹ng hÃ m DateTime.TryParse() Ä‘á»ƒ tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i má»™t chuá»—i thÃ nh Datetime ngon lÃ nh cÃ nh Ä‘Ã o. TÃ¬m kiáº¿m má»™t chuá»—i, lÆ°u chuá»—i Ä‘Ã³ láº¡i vÃ  láº¥y chuá»—i Ä‘Ã£ lÆ°u chÃ¨n vÃ o chá»— nÃ o Ä‘Ã³Hay nÃ³i cÃ¡ch khÃ¡c, ta cáº§n thay má»™t chuá»—i báº±ng má»™t chuá»—i khÃ¡c, trong chuá»—i má»›i Ä‘Ã³ láº¡i cÃ³ chá»©a cáº£ chuá»—i vá»«a bá»‹ thay tháº¿. NhÆ° vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y sáº½ cho cÃ¡c báº¡n tháº¥y. Ta cáº§n tÃ¬m ra ClassName, nhÆ°ng khÃ´ng pháº£i thay tháº¿ ClassName Ä‘Ã³ báº±ng Class khÃ¡c mÃ  ta sáº½ nhÃ©t nÃ³ vÃ o 2 vá»‹ trÃ­ thay vÃ¬ chá»‰ cÃ³ 1 vá»‹ trÃ­ nhÆ° hiá»‡n táº¡i. Váº­y RegEx cÃ³ thá»ƒ giÃºp gÃ¬ cho chÃºng ta trong cÃ¡c trÆ°á»ng há»£p trÃªn?Regular Expression sinh ra lÃ  Ä‘á»ƒ giÃºp cho cuá»™c Ä‘á»i cá»§a báº¡n bá»›t khá»•. HÃ£y tÆ°á»Ÿng tÆ°á»£ng xem báº¡n pháº£i nai lÆ°ng ra copy-paste bao nhiÃªu code. Báº¡n hoÃ n toÃ n cÃ³ thá»ƒ download cÃ¡c tool vá» Ä‘á»ƒ replace giÃºp báº¡n. NhÆ°ng báº¡n cáº§n bao nhiÃªu tool cho Ä‘á»§ Ä‘Ã¢y. Thay vÃ o Ä‘Ã³, báº¡n hÃ£y thá»­ há»c RegEx. Bá»™ cÃº phÃ¡p nÃ y sáº½ giÃºp cho báº¡n thao tÃ¡c vá»›i chuá»—i nhÆ° dao chÃ©m chuá»‘i. NhÆ° ta tháº¥y cÃ¡c vÃ­ dá»¥ bÃªn trÃªn, táº¥t cáº£ Ä‘á»u lÃ  Xá»¬ LÃ CHUá»–I vÃ­ dá»¥ Cut Copy Paste hoáº·c Replace chuá»—i. RegEx lÃ  ngÃ´n ngá»¯ giÃºp xá»­ lÃ½ chuá»—i ráº¥t máº¡nh. RegEx khÃ´ng pháº£i lÃ  má»™t ngÃ´n ngá»¯ láº­p trÃ¬nh. NÃ³ chá»‰ lÃ  má»™t Bá»˜ CÃš PHÃP dÃ¹ng Ä‘á»ƒ báº¯t chuá»—i. NhÆ°ng nÃ³ cá»±c ká»³ phá»• biáº¿n vÃ  báº¥t ká»³ ngÃ´n ngá»¯ láº­p trÃ¬nh nÃ o cÅ©ng há»— trá»£. NÃ³ cÃ³ cáº£ trÄƒm ngÃ n á»©ng dá»¥ng vÃ  cÃ´ng cá»¥ Äƒn theo. HÃ£y láº§n lÆ°á»£t xem qua cÃ¡c vÃ­ dá»¥ sau Ä‘Ã¢y Ä‘á»ƒ há»c cÃ¡ch sá»­ dá»¥ng Regular Expression nhÃ©. Báº¯t Ä‘áº§u sá»­ dá»¥ng Regular ExpressionÄá»ƒ báº¯t Ä‘áº§u sá»­ dá»¥ng vÃ  há»c cÃ¡ch dÃ¹ng RegEx, mÃ¬nh hay dÃ¹ng trang web https://regex101.com/. Giao diá»‡n nhÆ° sau: TrÆ°á»›c háº¿t cÃ¡c báº¡n hÃ£y Ä‘á»c qua má»™t lÆ°á»£t cÃ¡c quy táº¯c báº¯t chuá»—i (matching) Ä‘Æ¡n giáº£n nháº¥t cá»§a RegEx [xyz] TÃ¬m vÃ  so sÃ¡nh táº¥t cáº£ kÃ½ tá»± náº±m trong dáº¥u ngoáº·c vuÃ´ng vÃ  trÃ¹ng khá»›p vá»›i 1 kÃ½ tá»± trong dáº¥u ngoáº·c vuÃ´ng. VÃ­ dá»¥: [31] sáº½ trÃ¹ng khá»›p vá»›i 3 hoáº·c 1, [0123456789] sáº½ trÃ¹ng khá»›p vá»›i báº¥t ká»³ má»™t kÃ½ tá»± nÃ o trong khoáº£ng tá»« 0 Ä‘áº¿n 9. [a-z] So sÃ¡nh vÃ  trÃ¹ng khá»›p vá»›i má»™t kÃ½ tá»± náº±m trong khoáº£ng chá»‰ Ä‘á»‹nh. VÃ­ dá»¥: [a-z] sáº½ trÃ¹ng khá»›p vá»›i má»™t kÃ½ tá»± trong khoáº£ng tá»« a Ä‘áº¿n z náº±m trong chuá»—i cáº§n test. [0-9] sáº½ trÃ¹ng khá»›p vá»›i báº¥t ká»³ má»™t kÃ½ tá»± nÃ o trong khoáº£ng tá»« 0 Ä‘áº¿n 9. [^xyz] So sÃ¡nh vÃ  khÃ´ng trÃ¹ng khá»›p vá»›i nhá»¯ng kÃ½ tá»± náº±m trong khoáº£ng chá»‰ Ä‘á»‹nh. Dáº¥u ^ (dáº¥u mÅ©) náº±m trong dáº¥u ngoáº·c vuÃ´ng lÃ  má»™t dáº¥u phá»§ Ä‘á»‹nh. VÃ­ dá»¥: [^a-z] sáº½ khÃ´ng trÃ¹ng khá»›p vá»›i táº¥t cáº£ cÃ¡c kÃ½ tá»± náº±m trong khoáº£ng tá»« a Ä‘áº¿n z. ^ TrÃ¹ng khá»›p vá»›i pháº§n Ä‘áº§u cá»§a chuá»—i Ä‘Ã­ch. VÃ­ dá»¥: ^a sáº½ trÃ¹ng khá»›p vá»›i chá»¯ a trong chuá»—i abc, ^\\w+ sáº½ trÃ¹ng khá»›p vá»›i chá»¯ Ä‘áº§u tiÃªn â€“ chá»¯ â€œtheâ€ cá»§a chuá»—i â€œThe quick brown fox jumps over the lazy dogâ€. $ TrÃ¹ng khá»›p vá»›i pháº§n cuá»‘i cá»§a chuá»—i Ä‘Ã­ch. VÃ­ dá»¥: c$ sáº½ trÃ¹ng khá»›p vá»›i chá»¯ c trong chuá»—i abc, \\w+$ sáº½ trÃ¹ng khá»›p vá»›i chá»¯ cuá»‘i â€“ chá»¯ â€œdogâ€ cá»§a chuá»—i â€œThe quick brown fox jumps over the lazy dogâ€. TrÃ¹ng khá»›p vá»›i 1 hoáº·c nhiá»u láº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. VÃ­ dá»¥ \\d+ sáº½ chá»‰ trÃ¹ng vá»›i chuá»—i cÃ³ tá»« 1 con sá»‘ trá»Ÿ lÃªn. TrÃ¹ng khá»›p vá»›i 0 hoáº·c nhiá»u láº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. VÃ­ dá»¥ \\d* sáº½ trÃ¹ng vá»›i chuá»—i cÃ³ chá»©a 1 chá»¯ sá»‘ hoáº·c k cÃ³ chá»¯ sá»‘ nÃ o cÅ©ng Ä‘c. ? TrÃ¹ng khá»›p vá»›i 0 hoáº·c 1 láº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. TÆ°Æ¡ng tá»± nhÆ° nhÆ°ng nÃ³ láº¡i chá»‰ nhÃ¢n lÃªn 1 láº§n. thÃ¬ nhÃ¢n lÃªn nhiá»u láº§n. . TrÃ¹ng khá»›p vá»›i 1 kÃ½ tá»± Ä‘Æ¡n báº¥t ká»³ ngoáº¡i trá»« kÃ½ tá»± ngáº¯t dÃ²ng (line-break) vÃ  cÅ©ng khÃ´ng láº¥y Ä‘Æ°á»£c kÃ½ tá»± cÃ³ dáº¥u (unicode). VÃ­ dá»¥: . sáº½ trÃ¹ng khá»›p vá»›i kÃ½ tá»± a hoáº·c b hoáº·c c trong chuá»—i abc. NhÆ°ng . sáº½ khÃ´ng báº¯t Ä‘Æ°á»£c cÃ¡c chá»¯ Äƒ hoáº·c Ãª. x{n} TrÃ¹ng khá»›p Ä‘Ãºng vá»›i n láº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. n lÃ  má»™t sá»‘ khÃ´ng Ã¢m. VÃ­ dá»¥ \\d{2} sáº½ báº¯t Ä‘c cÃ¡c sá»‘ cÃ³ 2 chá»¯ sá»‘ Ä‘á»©ng liá»n nhau. x{n,} TrÃ¹ng khá»›p vá»›i Ã­t nháº¥t n láº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. n lÃ  má»™t sá»‘ khÃ´ng Ã¢m.VÃ­ dá»¥ \\d{2,} sáº½ báº¯t Ä‘c cÃ¡c sá»‘ cÃ³ tá»« 2 chá»¯ sá»‘ trá»Ÿ lÃªn Ä‘á»©ng liá»n nhau. x{n,m} TrÃ¹ng khá»›p vá»›i Ã­t nháº¥t n láº§n vÃ  nhiá»u nháº¥t lÃ  m láº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. n vÃ  m lÃ  má»™t sá»‘ khÃ´ng Ã¢m vÃ  n &lt;= m. VÃ­ dá»¥: a{1,3} sáº½ khá»›p vá»›i hah, haah, haaah nhÆ°ng khÃ´ng khá»›p vá»›i haaaah. x|y TrÃ¹ng khá»›p vá»›i x hoáº·c y. VÃ­ dá»¥: slow|fast sáº½ khá»›p vá»›i chá»¯ slow hoáº·c fast trong chuá»—i Ä‘Ã­ch. \\b TrÃ¹ng khá»›p vá»›i toÃ n bá»™ kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. VÃ­ dá»¥: hello\\b sáº½ trÃ¹ng khá»›p vá»›i toÃ n bá»™ tá»« hello trong chuá»—i hello world nhÆ°ng sáº½ khÃ´ng khá»›p vá»›i chuá»—i helloworld. \\B NgÆ°á»£c láº¡i vá»›i \\b, \\B sáº½ khÃ´ng khá»›p vá»›i toÃ n bá»™ mÃ  chá»‰ 1 pháº§n kÃ½ tá»± Ä‘á»©ng trÆ°á»›c nÃ³. VÃ­ dá»¥: hello\\B sáº½ trÃ¹ng khá»›p vá»›i chá»¯ hello trong chuá»—i helloworld nhÆ°ng sáº½ khÃ´ng khá»›p vá»›i chuá»—i hello world. \\d TrÃ¹ng khá»›p 1 kÃ½ tá»± sá»‘ (digit). \\D TrÃ¹ng khá»›p 1kÃ½ tá»± khÃ´ng pháº£i sá»‘ (non-digit). \\s TrÃ¹ng khá»›p 1 kÃ½ tá»± khoáº£ng tráº¯ng (whitespace) bao gá»“m khoáº£ng tráº¯ng táº¡o ra bá»Ÿi phÃ­m Tab. \\S TrÃ¹ng khá»›p vá»›i 1 kÃ½ tá»± khÃ´ng pháº£i lÃ  khoáº£ng tráº¯ng (non-whitespace). \\w TrÃ¹ng khá»›p vá»›i cÃ¡c kÃ½ tá»± lÃ  tá»« (word) bao gá»“m dáº¥u _ (underscore) vÃ  chá»¯ sá»‘. \\W TrÃ¹ng khá»›p vá»›i cÃ¡c kÃ½ tá»± khÃ´ng pháº£i lÃ  tá»« (non-word). VÃ­ dá»¥: \\W sáº½ khá»›p vá»›i kÃ½ tá»± % trong chuá»—i â€œ100%â€. \\uxxxx TrÃ¹ng khá»›p vá»›i 1 kÃ½ tá»± unicode. VÃ­ dá»¥: \\u00FA sáº½ khá»›p vá»›i kÃ½ tá»± â€œÃºâ€, \\u00F9 sáº½ khá»›p vá»›i kÃ½ tá»± â€œÃ¹â€. \\pL TrÃ¹ng khá»›p vá»›i má»™t kÃ½ tá»± Unicode báº¥t ká»³ ngoáº¡i trá»« dáº¥u cÃ¡ch. ÄÃ¢y chÃ­nh lÃ  cÃº phÃ¡p viáº¿t hoÃ n háº£o hÆ¡n cá»§a dáº¥u .,VÃ­ dá»¥ \\pL+ sáº½ láº¥y Ä‘Æ°á»£c chuá»—i truyá»n, thuyáº¿t trong chuá»—i â€œtruyá»n thuyáº¿tâ€. Äá»«ng lo, hÃ£y xem qua cÃ¡c vÃ­ dá»¥ tá»« tá»« rá»“i báº¡n sáº½ hiá»ƒu VÃ­ dá»¥ Ä‘Æ¡n giáº£nTÃ¬m chuá»—i sá»‘ TÃ¬m ngÃ y thÃ¡ng Link demo: https://regex101.com/r/3dNzjU/1 TÃ¬m ngÃ y thÃ¡ng chÃ­nh xÃ¡cTrong vÃ­ dá»¥ trÃªn thÃ¬ ta tháº¥y cÃ³ chuá»—i â€œ60/60/2018â€ cÅ©ng Ä‘Æ°á»£c coi lÃ  ngÃ y thÃ¡ng, nhÆ° tháº¿ lÃ  khÃ´ng chÃ­nh xÃ¡c. Ta hÃ£y viáº¿t láº¡i cho chuáº©n. Link demo: https://regex101.com/r/3dNzjU/2 CÃ¡ch â€œtÃ³m láº¥yâ€ string cáº§n tÃ¬m Ä‘Æ°a vÃ o Group CÃ¡ch táº¡o ra code Ä‘á»ƒ dÃ¹ng RegEx trong cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nhRegEx lÃ  bá»™ cÃº phÃ¡p, tuy nhiÃªn Ä‘á»ƒ Ã¡p dá»¥ng nÃ³ vÃ o cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh láº¡i pháº£i tuÃ¢n thá»§ theo cÃ¡c thÆ° viá»‡n vÃ  quy táº¯c láº­p trÃ¬nh Ä‘á»ƒ láº¥y ra Ä‘Æ°á»£c cÃ¡c Group Ä‘Ã£ capture (thu) Ä‘Æ°á»£c. HÃ£y xem cÃ¡c táº¡o code ngay sau Ä‘Ã¢y: CÃ¡ch báº¯t láº¥y chuá»—i báº¥t ká»³ Link demo: https://regex101.com/r/3dNzjU/3 Sá»­ dá»¥ng RegEx trong thá»±c táº¿Trong thá»±c táº¿ RegEx cÃ³ thá»ƒ Ä‘Æ°á»£c gÃµ trá»±c tiáº¿p á»Ÿ báº¥t ká»³ trÃ¬nh Editor nÃ o. VÃ­ dá»¥ mÃ¬nh hay dÃ¹ng Notepad++, hoáº·c Visual Studio Tham kháº£oTham kháº£o thÃªm toÃ n bá»™ cÃº phÃ¡p RegEx báº±ng tiáº¿ng Anh táº¡i: https://www.cheatography.com/davechild/cheat-sheets/regular-expressions/ Má»™t sá»‘ cÃ´ng cá»¥ test RegEx Online https://regex101.com/ http://regexr.com/ http://www.regexpal.com/ http://regexper.com/ BÃ i táº­p vá» nhÃ Báº¡n ngá»©a tay muá»‘n thá»­ há»c RegEx ngay vÃ  luÃ´n cho nÃ³ng. Váº­y hÃ£y thá»­ thá»±c hÃ nh báº±ng má»™t sá»‘ bÃ i táº­p tá»« dá»… Ä‘áº¿n khÃ³ sau Ä‘Ã¢y nhÃ©. BÃ i táº­p nháº­p mÃ´n: Láº¥y ra cÃ¡c chá»¯ cÃ³ chá»¯ test trong chuá»—i sau: â€œthat tested test is testing the testerâ€™s testsâ€ Láº¥y ra cÃ¡c sá»‘ Ä‘iá»‡n thoáº¡i trong chuá»—i sau: â€œp:444-555-1234 f:246.555.8888 m:1235554567â€ Láº¥y ra cÃ¡c mÃ£ mÃ u RGB trong chuá»—i sau: â€œ#FF006C ABC 99AAB7FF 0xF0F73611â€ Láº¥y ra cÃ¡c chá»¯ cÃ³ 4 kÃ½ tá»± trong chuá»—i sau: â€œdrink beer, itâ€™s very nice!â€ Láº¥y ra tÃªn file trong chuá»—i URL sau: â€œrapidshare.com/asd/asd/File.avi.htmlâ€ ÄÃ¡p Ã¡n á»Ÿ pháº§n comment nhÃ©. BÃ i táº­p dÃ nh cho há»c sinh giá»i (lá»›p há»c thÃªm) TÃ¬m cÃ¡ch láº¥y cÃ¡c URL trong chuá»—i HTML sau: 1234567Lorem gyum&lt;b&gt;Betrag&lt;/b&gt; von &lt;a href=\"http://www.vektor.de\"&gt;Vektoren&lt;/a&gt;(LÃ¤nge eines Vektors)&lt;a href=\"gcfa.com\"&gt;GCFA&lt;/a&gt; &lt;a href=\"//cdn.com/test.js\"&gt;CDN&lt;/a&gt; ist das MaÃŸ einer Menge sozuâ€¦ TÃ¬m cÃ¡ch loáº¡i bá» toÃ n bá»™ COMMENT trong Ä‘oáº¡n code sau: 123456789var sample = 0; var my_string = \"Hello World!\"; // This is a comment! function do_stuff()&#123; // This is another comment! alert(â€˜somethingsâ€™);/* this is a multiline comment */&#125; TÃ¬m cÃ¡ch láº¥y ra chuá»—i tiáº¿ng Nháº­t trong chuá»—i sau: â€œ 1This is a demo story å‰ã«æ¥ãŸæ™‚ã¯åŒ—å´ã‹ã‚‰ã§ã€å½“æ™‚ã®å…‰æ™¯ã¯ã„ã¾ã§ã‚‚æ€ã„å‡ºã›ã‚‹ã€‚And it is true. Láº¥y ra nhá»¯ng file áº£nh vÃ  Ä‘á»™ phÃ¢n giáº£i cá»§a áº£nh tá»« chuá»—i sau: 12345678.bash_profileworkspace.docimg0912.jpg (1280x720)updated_img0912.png (1024x768)documentation.htmlfavicon.gif img0912.jpg (1920x1600)access.htaccess Äá»c ná»™i dung tá»« trang tin rss sau: http://rss.cnn.com/rss/edition.rss Láº¥y ra cÃ¡c TiÃªu Ä‘á», ngÃ y giá» Ä‘Äƒng, ná»™i dung tin váº¯n ÄÃ¡p Ã¡n cÃ¡c báº¡n post vÃ o pháº§n comment vÃ  cÃ¹ng trao Ä‘á»•i nhÃ©. Náº¿u cÃ¡c bÃ i táº­p trÃªn Ä‘Ã¢y váº«n chÆ°a Ä‘á»§, cÃ¡c báº¡n hÃ£y lÃ m thÃªm cÃ¡c bÃ i táº­p táº¡i trang https://regexone.com nhÃ©, ráº¥t nhiá»u vÃ­ dá»¥ hay. Káº¿t luáº­nHi vá»ng bÃ i viáº¿t nhá» nÃ y Ä‘Ã£ giÃºp báº¡n há»c Ä‘Æ°á»£c cÃº phÃ¡p viáº¿t RegEx vÃ  Ã¡p dá»¥ng vÃ o cÃ´ng viá»‡c thÆ°á»ng ngÃ y. MÃ¬nh dÃ¹ng Regex ráº¥t nhiá»u vÃ  nÃ³ lÃ  trá»£ thá»§ Ä‘áº¯c lá»±c trong quÃ¡ trÃ¬nh code. CÃ¡c báº¡n thÃ¬ sao? báº¡n Ä‘Ã£ dÃ¹ng Regex vÃ o nhá»¯ng viá»‡c gÃ¬? HÃ£y ká»ƒ tÃªn bÃªn dÆ°á»›i comment Ä‘á»ƒ mÃ¬nh cÃ¹ng há»c há»i vá»›i nhÃ©. Thanks cÃ¡c báº¡n Ä‘Ã£ Ä‘á»c!","categories":[],"tags":[{"name":"regex","slug":"regex","permalink":"http://nthung2112.github.io/tags/regex/"}]},{"title":"TÃ¬m hiá»ƒu Higher-Order Function (HOF) vÃ  Currying qua má»™t sá»‘ vÃ­ dá»¥","slug":"Tim-hieu-Higher-Order-Function-HOF-va-Currying-qua-mot-so-vi-du-3","date":"2018-04-03T04:20:00.000Z","updated":"2018-05-18T01:02:21.693Z","comments":true,"path":"2018/04/Tim-hieu-Higher-Order-Function-HOF-va-Currying-qua-mot-so-vi-du-3.html","link":"","permalink":"http://nthung2112.github.io/2018/04/Tim-hieu-Higher-Order-Function-HOF-va-Currying-qua-mot-so-vi-du-3.html","excerpt":"HOF vÃ  Currying lÃ  hai ká»¹ thuáº­t khÃ´ng khÃ³, tháº­m chÃ­ cÃ³ thá»ƒ báº¡n Ä‘ang dÃ¹ng nÃ³ hÃ ng ngÃ y mÃ  khÃ´ng Ä‘á»ƒ Ã½. CÃ¹ng tÃ¬m hiá»ƒu chÃºng thÃ´ng qua má»™t sá»‘ vÃ­ dá»¥. BackgroundTÃ´i cho ráº±ng má»™t ká»¹ sÆ° pháº§n má»m pro khÃ´ng pháº£i lÃ  ngÆ°á»i viáº¿t ra nhá»¯ng dÃ²ng code Ä‘Ã¡nh Ä‘á»‘ ngÆ°á»i Ä‘á»c hay Ä‘á»“ng nghiá»‡p, mÃ  lÃ  ngÆ°á»i viáº¿t nhá»¯ng dÃ²ng code mÃ  khi ngÆ°á»i khÃ¡c Ä‘á»c nÃ³ liá»n cáº£m tháº¥y trong sÃ¡ng, dá»… hiá»ƒu, dá»… báº£o trÃ¬. CÅ©ng nhÆ° sá»± tiáº¿n hÃ³a cá»§a con ngÆ°á»i, khi mÃ  â€œÄƒn no, Äƒn sáº¡ch rá»“i Äƒn ngonâ€, thÃ¬ coding cÅ©ng cÃ³ slogan tÆ°Æ¡ng tá»±: â€œcháº¡y Ä‘Æ°á»£c, cháº¡y Ä‘Ãºng, sau cÃ¹ng lÃ  cháº¡y nhanhâ€.Váº­y, sau khi cháº¡y Ä‘Æ°á»£c vÃ  cháº¡y Ä‘Ãºng rá»“i, chÃºng ta nÃªn suy nghÄ© xem ngoÃ i viá»‡c cÃ³ thá»ƒ cháº¡y nhanh hÆ¡n ko, thÃ¬ Ä‘oáº¡n code nÃ y Ä‘Ã£ sÃ¡ng sá»§a chÆ°a? Náº¿u bá»‹/Ä‘Æ°á»£c sá»­a thÃ¬ cÃ³ dá»… ko? HOF vÃ  Currying lÃ  2 trong sá»‘ ti tá»‰ ká»¹ thuáº­t nháº±m giÃºp chÃºng ta, nhá»¯ng láº­p trÃ¬nh viÃªn huyá»n thoáº¡i, Ä‘áº¡t Ä‘Æ°á»£c tiÃªu chÃ­ trÃªn.","text":"HOF vÃ  Currying lÃ  hai ká»¹ thuáº­t khÃ´ng khÃ³, tháº­m chÃ­ cÃ³ thá»ƒ báº¡n Ä‘ang dÃ¹ng nÃ³ hÃ ng ngÃ y mÃ  khÃ´ng Ä‘á»ƒ Ã½. CÃ¹ng tÃ¬m hiá»ƒu chÃºng thÃ´ng qua má»™t sá»‘ vÃ­ dá»¥. BackgroundTÃ´i cho ráº±ng má»™t ká»¹ sÆ° pháº§n má»m pro khÃ´ng pháº£i lÃ  ngÆ°á»i viáº¿t ra nhá»¯ng dÃ²ng code Ä‘Ã¡nh Ä‘á»‘ ngÆ°á»i Ä‘á»c hay Ä‘á»“ng nghiá»‡p, mÃ  lÃ  ngÆ°á»i viáº¿t nhá»¯ng dÃ²ng code mÃ  khi ngÆ°á»i khÃ¡c Ä‘á»c nÃ³ liá»n cáº£m tháº¥y trong sÃ¡ng, dá»… hiá»ƒu, dá»… báº£o trÃ¬. CÅ©ng nhÆ° sá»± tiáº¿n hÃ³a cá»§a con ngÆ°á»i, khi mÃ  â€œÄƒn no, Äƒn sáº¡ch rá»“i Äƒn ngonâ€, thÃ¬ coding cÅ©ng cÃ³ slogan tÆ°Æ¡ng tá»±: â€œcháº¡y Ä‘Æ°á»£c, cháº¡y Ä‘Ãºng, sau cÃ¹ng lÃ  cháº¡y nhanhâ€.Váº­y, sau khi cháº¡y Ä‘Æ°á»£c vÃ  cháº¡y Ä‘Ãºng rá»“i, chÃºng ta nÃªn suy nghÄ© xem ngoÃ i viá»‡c cÃ³ thá»ƒ cháº¡y nhanh hÆ¡n ko, thÃ¬ Ä‘oáº¡n code nÃ y Ä‘Ã£ sÃ¡ng sá»§a chÆ°a? Náº¿u bá»‹/Ä‘Æ°á»£c sá»­a thÃ¬ cÃ³ dá»… ko? HOF vÃ  Currying lÃ  2 trong sá»‘ ti tá»‰ ká»¹ thuáº­t nháº±m giÃºp chÃºng ta, nhá»¯ng láº­p trÃ¬nh viÃªn huyá»n thoáº¡i, Ä‘áº¡t Ä‘Æ°á»£c tiÃªu chÃ­ trÃªn.TrÆ°á»›c khi Ä‘i vÃ o khÃ¡i niá»‡m cá»¥ thá»ƒ, chÃºng ta cÃ¹ng xem vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y: VÃ­ dá»¥ 1NhÃ³c con nhÃ  báº¡n nhá» báº¡n tÃ¬m nhá»¯ng sá»‘ tá»± nhiÃªn khÃ¡c 0 nhá» hÆ¡n 20 vÃ  lÃ  sá»‘ láº».LÃ  má»™t Ã´ng bá»‘ máº«u má»±c vá»›i niá»m kiÃªu hÃ£nh nhiá»u nÄƒm kinh nghiá»‡m fixed hÃ ng trÄƒm bug nhá» vÃ  táº¡o ra hÃ ng tÃ¡ bug to, báº¡n muá»‘n viáº¿t má»™t chÆ°Æ¡ng trÃ¬nh hoÃ nh trÃ¡ng Ä‘á»ƒ láº¥y le vá»›i con mÃ¬nh. Ok, you win!.DÆ°á»›i Ä‘Ã¢y cháº¯c háº³n lÃ  Ä‘oáº¡n code Ä‘áº§u tiÃªn xuáº¥t hiá»‡n trong Ä‘áº§u: 1234567891011function pickOddNumbers(maximum) &#123; const result = []; for (let i = 1; i &lt;= maximum; i += 1) &#123; if (i % 2 === 1) result.push(i); &#125; return result;&#125;pickOddNumbers(20); NhÆ°ng Ä‘á»i khÃ´ng bao giá» lÃ  mÆ¡, khi hÃ´m sau nhÃ³c con láº¡i máº¿u mÃ¡o: â€œCÃ´ giÃ¡o cho thÃªm bÃ i: TÃ¬m nhá»¯ng sá»‘ tá»± nhiÃªn khÃ¡c 0 nhá» hÆ¡n 20 mÃ  náº¿u gáº¥p 3 sá»‘ Ä‘Ã³ rá»“i tá»« Ä‘i 2 thÃ¬ thu Ä‘Æ°á»£c sá»‘ cháºµn.â€.Bá»‘ chiá»u cÃ´ luÃ´n. Váº­y lÃ  báº¡n láº¡i cho ra phiÃªn báº£n má»›i: 1234567891011function pickSpecialNumbers(maximum) &#123; const result = []; for (let i = 1; i &lt;= maximum; i += 1) &#123; if (((i * 3) - 2) % 2 === 0) result.push(i); &#125; return result;&#125;pickSpecialNumbers(20); Äá»i váº«n ko nhÆ° mÆ¡ khi cÃ´ giÃ¡o láº¡i cho thÃªm bÃ i táº­p: â€œTÃ¬m nhá»¯ng sá»‘ tá»± nhiÃªn khÃ¡c 0 nhá» hÆ¡n 20 mÃ  náº¿u láº¥y pháº§n dÆ° sá»‘ Ä‘Ã³ cho 9 rá»“i cá»™ng thÃªm 2 thÃ¬ thu sá»‘ láº».â€Æ  cÃ´ giÃ¡o tá»« tá»«, Ä‘á»ƒ bá»‘ em sá»­a function bÃªn trÃªn Ä‘Ã£ :)))) Cá»© nhÆ° váº­y, má»—i láº§n cÃ´ giÃ¡o cho thÃªm yÃªu cáº§u lÃ  báº¡n láº¡i pháº£i sá»­a phiÃªn báº£n cÅ© hoáº·c cho ra má»™t báº£n má»›i, tuy yÃªu cáº§u khÃ¡c nhau nhÆ°ng xá»­ lÃ½ cÆ¡ báº£n lÃ  giá»‘ng nhau, chá»‰ khÃ¡c á»Ÿ Ä‘oáº¡n xá»­ lÃ½ Ä‘iá»u kiá»‡n cho sá»‘ Ä‘Æ°á»£c chá»n.VÃ  báº¡n chá»£t nhá»› tá»›i HOF, má»™t á»©ng cá»­ viÃªn sÃ¡ng giÃ¡ cho viá»‡c lÃ m Ä‘oáº¡n code trÃªn sáº¡ch hÆ¡n, gá»n hÆ¡n, dá»… sá»­a hÆ¡n. Äá»‹nh nghÄ©a HOFTheo wikipedia thÃ¬: 1234A higher-order function (also functional, functional form or functor) is a function that does at least one of the following:ãƒ»takes one or more functions as arguments,ãƒ»returns a function as its result. Vietsub: 123HOF lÃ  má»™t function mÃ  cho phÃ©p thá»±c hiá»‡n Ã­t nháº¥t 1 trong 2 kháº£ nÄƒng sau:ãƒ»Nháº­n vÃ o má»™t hoáº·c nhiá»u function nhÆ° lÃ  tham sá»‘, hoáº·c/vÃ ãƒ»Tráº£ vá» káº¿t quáº£ lÃ  má»™t function. // Báº¡n cÃ³ thá»ƒ tháº¥y cÃ³ ráº¥t nhiá»u ngÃ´n ngá»¯ há»— trá»£ HOF á»Ÿ link wiki trÃªn. Äáº¿n Java cÃ²n há»— trá»£ ná»¯a lÃ  :v TrÄƒm nghe khÃ´ng báº±ng má»™t tháº¥y, trÄƒm tháº¥y khÃ´ng báº±ng má»™t sá», vÃ  chÃºng ta láº¡i cÃ¹ng sá» vá»›i vÃ­ dá»¥ bÃªn trÃªn.Láº§n nÃ y lÃ  báº£n nÃ¢ng cáº¥p cÃ³ giÃ¡ trá»‹ vá» máº·t há»c thuáº­t, vÃ¬ Ä‘Æ°á»£c Ã¡p dá»¥ng HOF vÃ o cÆ¡ mÃ  :))) 12345678910111213141516171819function pickNumbers(maximum, pickingCondition) &#123; const result = []; for (let i = 1; i &lt;= maximum; i += 1) &#123; if (pickingCondition(i)) result.push(i); &#125; return result;&#125;// Chá»n ra nhá»¯ng sá»‘ láº»pickNumbers(20, function(number) &#123; return number % 2 === 1;&#125;);// Chá»n ra nhá»¯ng sá»‘ mÃ  gáº¥p 3 sá»‘ Ä‘Ã³ rá»“i trá»« Ä‘i 2 thu sá»‘ cháºµnpickNumbers(20, function(number) &#123; return ((number * 3) - 2) % 2 === 0;&#125;); Vá»›i viá»‡c Ä‘Æ°a HOF vÃ o function bÃªn trÃªn, giá» thÃ¬ cÃ´ giÃ¡o thÃ­ch gÃ¬ cÅ©ng chiá»u Ä‘Æ°á»£c nhÃ©,chá»‰ cáº§n thay Ä‘á»•i function kiá»ƒm tra Ä‘iá»u kiá»‡n vÃ o thÃ´i, ko cáº§n pháº£i copy thÃ nh function má»›i ná»¯a. Äá»‹nh nghÄ©a CurryingLáº¡i theo wikipedia: 123Currying is the technique of translating the evaluation of a functionthat takes multiple arguments (or a tuple of arguments)into evaluating a sequence of functions, each with a single argument. Vietsub: 123Currying lÃ  ká»¹ thuáº­t mÃ  cho phÃ©p chuyá»ƒn Ä‘á»•i má»™t function vá»›i nhiá»u tham sá»‘thÃ nh nhá»¯ng functions liÃªn tiáº¿p cÃ³ má»™t tham sá»‘.// VÃ­ dá»¥ f(a,b,c) cÃ³ thá»ƒ Ä‘Æ°á»£c convert thÃ nh g(a)h(b, c) hay g(a)h(b)k(c), tháº­m chÃ­ lÃ  Ä‘á»•i thá»© tá»± cá»§a cÃ¡c function tÆ°Æ¡ng á»©ng... Váº­y dá»… dÃ ng nháº­n tháº¥y Currying lÃ  má»™t trÆ°á»ng há»£p cá»§a HOF, vÃ¬ nÃ³ thá»a mÃ£n Ä‘iá»u kiá»‡n tráº£ vá» káº¿t quáº£ lÃ  má»™t function. Cá»¥ thá»ƒ Ã¡p dá»¥ng cho vÃ­ dá»¥ trÃªn, cÃ³ thá»ƒ viáº¿t thÃ nh dáº¡ng sau: 123456789101112131415161718192021function pickNumbers(maximum) &#123; return function (pickingCondition) &#123; const result = []; for (let i = 1; i &lt;= maximum; i += 1) &#123; if (pickingCondition(i)) result.push(i); &#125; return result; &#125;;&#125;// Chá»n ra nhá»¯ng sá»‘ láº»pickNumbers(20)(function (number) &#123; return number % 2 === 1;&#125;);// Chá»n ra nhá»¯ng sá»‘ mÃ  gáº¥p 3 sá»‘ Ä‘Ã³ rá»“i trá»« Ä‘i 2 thu sá»‘ cháºµnpickNumbers(20)(function (number) &#123; return (number * 3 - 2) % 2 === 0;&#125;); So sÃ¡nh vÃ­ dá»¥ Ã¡p dá»¥ng Currying nÃ y vá»›i vÃ­ dá»¥ sá»­ dá»¥ng HOF á»Ÿ trÃªn, rÃµ rÃ ng lÃ  ta chÆ°a tháº¥y sá»± Æ°u viá»‡t cá»§a Currying so vá»›i HOF, tháº­m chÃ­ cÃ²n tháº¥y hÆ¡i rÆ°á»m rÃ  ná»¯a.Tuy nhiÃªn, hÃ£y cÃ¹ng xem xÃ©t vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y: VÃ­ dá»¥ 2Viáº¿t má»™t function láº¥y ra giÃ¡ trá»‹ cá»§a má»™t key cá»§a object, Ä‘Æ°á»£c chá»n ra tá»« má»™t máº£ng cÃ¡c objects vá»›i Ä‘iá»u kiá»‡n. ÄÆ¡n giáº£n váº­y thÃ´i, nÃªn viá»‡c cÃ i Ä‘áº·t cÅ©ng cÃ³ váº» lÃ  Ä‘Æ¡n giáº£n. Vá»›i HOF: 123456789101112function getValue(objects, key, pickingCondition) &#123; var object = null; for (var i = 0; i &lt; objects.length; i++) &#123; if (pickingCondition(objects[i])) &#123; object = objects[i]; break; &#125; &#125; return object ? object[key] : null;&#125;; Má»—i khi gá»i function vá»›i key khÃ¡c nhau, háº³n lÃ  sáº½ pháº£i gá»i kiá»ƒu nhÆ° váº§y: 12var valueByKey1 = getValue(objects, 'key1', pickingCondition);var valueByKey2 = getValue(objects, 'key2', pickingCondition); Náº¿u nhÆ° coi key lÃ  biáº¿t trÆ°á»›c, chá»‰ thay Ä‘á»•i objects vÃ  pickingCondition, thÃ¬ viá»‡c Ã¡p dá»¥ng Currying lÃ  há»£p lÃ½: 12345678910111213141516171819202122function getValue(key) &#123; return function (objects, pickingCondition) &#123; let object = null; for (let i = 0; i &lt; objects.length; i++) &#123; if (pickingCondition(objects[i])) &#123; object = objects[i]; break; &#125; &#125; return object ? object[key] : null; &#125;;&#125;;// Wrap getValue thÃ nh nhá»¯ng function ngáº¯n hÆ¡n vá»›i tÃªn sÃ¡ng nghÄ©a:var getValueByKey1 = getValue('key1');var getValueByKey2 = getValue('key2');// Sá»­ dá»¥ng:var valueByKey1 = getValueByKey1(objects, pickingCondition);var valueByKey2 = getValueByKey2(objects, pickingCondition); KhÃ¡ lÃ  gá»n gÃ ng. // NgoÃ i lá»: Náº¿u báº¡n lÃ m viá»‡c vá»›i ReactJs, háº³n báº¡n Ä‘Ã£ biáº¿t tá»›i thuáº­t ngá»¯ Higher-Order Component, hay cÃ¡c selectors mÃ  redux-form cung cáº¥p, thÃ¬ chÃºng Ä‘á»u Ã¡p dá»¥ng ká»¹ thuáº­t Currying nÃ y, cÅ©ng nhÆ° HOF. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ i vÃ­ dá»¥ cho tháº¥y tÃ¡c dá»¥ng tá»‘t cá»§a Currying: VÃ­ dá»¥ 3Viáº¿t function Ä‘á»ƒ kiá»ƒm tra Ä‘á»™ dÃ i cá»§a má»™t xÃ¢u s cÃ³ vÆ°á»£t quÃ¡ n hay ko. 1234567891011// CÃ¡ch 1: KhÃ´ng dÃ¹ng Curryingfunction isLengthOver(s, n)&#123; return s.length &gt; n&#125;// CÃ¡ch 2: CÃ³ Curryingfunction isLengthOver(n)&#123; return function(s)&#123; return s.length &gt; n; &#125;&#125; Giáº£ sá»­ cáº£ 2 cÃ¡ch viáº¿t trÃªn Ä‘Æ°á»£c sá»­ dá»¥ng cho viá»‡c validate cá»§a má»™t field trÃªn form, vá»›i n = 10 thÃ¬ cÃ³ sá»± khÃ¡c biá»‡t nhÆ° sau: Vá»›i cÃ¡ch 1: 1&lt;input type=\"text\" validate=&#123;value =&gt; isLengthOver(value, 10)&#125; /&gt; Vá»›i cÃ¡ch 2: 1&lt;input type=\"text\" validate=&#123;isLengthOver(10)&#125; /&gt; QuÃ¡ khÃ¡c bá»t! VÃ­ dá»¥ 4Viáº¿t function hiá»ƒn thá»‹ tÃªn group mÃ  má»™t nhÃ¢n viÃªn Ä‘ang lÃ m viá»‡c, vá»›i: Input: employeeGroupId lÃ  id cá»§a group mÃ  nhÃ¢n viÃªn Ä‘ang lÃ m viá»‡c, Máº£ng chá»©a toÃ n bá»™ groups cÃ³ trong cÃ´ng ty. Äiá»u kiá»‡n ráº±ng buá»™c: Má»™t group luÃ´n cÃ³ id khÃ¡c null, Náº¿u groupB lÃ  group con cá»§a groupA, thÃ¬ groupB sáº½ cÃ³ parentGroupId lÃ  id cá»§a groupA. Group khÃ´ng lÃ  con khi parentGroupId cá»§a nÃ³ lÃ  null, KhÃ´ng cÃ³ quan há»‡ vÃ²ng trÃ²n. (Kiá»ƒu: groupA lÃ  con groupB, groupB lÃ  con groupC, groupC lÃ  con groupA) Output: Full path cá»§a group mÃ  nhÃ¢n viÃªn Ä‘ang lÃ m viá»‡c, phÃ¢n cÃ¡ch bá»Ÿi dáº¥u /. VÃ­ dá»¥ Group A / Group B / Group C Cháº¯c háº³n báº¡n sáº½ nghÄ© tá»›i cÃ¡ch dÃ¹ng vÃ²ng láº·p, kiá»ƒm tra chá»«ng nÃ o cÃ²n tÃ¬m tháº¥y group cÃ³ id báº±ng parentGroupId. VÃ  tÃ´i cÅ©ng nghÄ© váº­y :D 1234567891011const getGroupFullPathName = (groups, employeeGroupId) =&gt; &#123; const groupNames = []; let group = groups.find(grp =&gt; grp.id === employeeGroupId); while (group) &#123; groupNames.unshift(group.name); group = groups.find(grp =&gt; grp.id === group.parentGroupId); &#125; return groupNames.join('/');&#125;; NhÆ°ng Ä‘oáº¡n code trÃªn váº«n chÆ°a ngon, do vi pháº¡m rule Donâ€™t make functions within a loop cá»§a ESLint.Cá»¥ thá»ƒ: Má»—i khi vÃ²ng while Ä‘Æ°á»£c cháº¡y thÃ¬ groups.find(grp =&gt; grp.id === group.parentGroupId) láº¡i sinh ra má»™t anonymous function, chÃ­nh lÃ  grp =&gt; grp.id === group.parentGroupId. CÃ¡ch kháº¯c phá»¥c lÃ  ta viáº¿t má»™t currying bÃªn ngoÃ i vÃ²ng while lÃ  Ä‘Æ°á»£c: 123456789101112const getGroupFullPathName = (groups, employeeGroupId) =&gt; &#123; const groupNames = []; const condition = parentGroupId =&gt; group =&gt; group.id === parentGroupId; let group = groups.find(grp =&gt; grp.id === employeeGroupId); while (group) &#123; groupNames.unshift(group.name); group = groups.find(condition(group.parentDepartmentId)); &#125; return groupNames.join('/');&#125;; Káº¿t luáº­n:BÃ i quÃ¡ dÃ i. // Náº¿u máº¥y vÃ­ dá»¥ trÃªn dÃ¹ng cÃº phÃ¡p cá»§a es6 vÃ  dÃ¹ng cÃ¡c api cá»§a Array thÃ¬ sáº½ ngáº¯n hÆ¡n nhiá»u, nhÆ°ng láº¡i khÃ³ nhÃ¬n rÃµ Ä‘Ã¢u lÃ  function Ä‘Æ°á»£c nháº­n vÃ o/tráº£ ra, nÃªn cÃ¡c báº¡n chá»‹u khÃ³ Ä‘á»c vá»›i cÃº phÃ¡p cÆ¡ báº£n váº­y :D","categories":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/categories/javascript/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"hof","slug":"hof","permalink":"http://nthung2112.github.io/tags/hof/"}]},{"title":"CSS Grid vs Flexbox sá»­ dá»¥ng nhÆ° tháº¿ nÃ o","slug":"CSS-Grid-vs-Flexbox-su-dung-nhu-the-nao","date":"2018-03-25T13:52:00.000Z","updated":"2018-03-25T07:39:52.137Z","comments":true,"path":"2018/03/CSS-Grid-vs-Flexbox-su-dung-nhu-the-nao.html","link":"","permalink":"http://nthung2112.github.io/2018/03/CSS-Grid-vs-Flexbox-su-dung-nhu-the-nao.html","excerpt":"TÃ¬m hiá»ƒu cÃ¡ch chÃºng khÃ¡c nhau, vÃ  khi báº¡n nÃªn sá»­ dá»¥ng nÃ³.CSS Flexbox Ä‘Ã£ trá»Ÿ nÃªn cá»±c ká»³ quen thuá»™c vá»›i cÃ¡c láº­p trÃ¬nh viÃªn front-end trong vÃ i nÄƒm gáº§n Ä‘Ã¢y. Äiá»u nÃ y khÃ´ng Ä‘Ã¡ng ngáº¡c nhiÃªn, bá»Ÿi vÃ¬ nÃ³ giÃºp chÃºng ta táº¡o ra cÃ¡c bá»‘ cá»¥c Ä‘á»™ng (dynamic layout) vÃ  sáº¯p xáº¿p ná»™i dung trong cÃ¡c container dá»… dÃ ng hÆ¡n ráº¥t nhiá»u. Tuy nhiÃªn, cÃ³ má»™t mÃ´-Ä‘un má»›i gá»i lÃ  CSS Grid vÃ  nÃ³ cÃ³ nhiá»u kháº£ nÄƒng giá»‘ng nhÆ° Flexbox. Trong má»™t vÃ i trÆ°á»ng há»£p nÃ³ tá»‘t hÆ¡n so vá»›i Flexbox, vÃ  má»™t sá»‘ trÆ°á»ng há»£p khÃ¡c thÃ¬ khÃ´ng. Äiá»u nÃ y cÃ³ váº» gÃ¢y nháº§m láº«n cho cÃ¡c láº­p trÃ¬nh viÃªn. VÃ¬ váº­y, bÃ i viáº¿t nÃ y sáº½ so sÃ¡nh hai mÃ´-Ä‘un, cáº£ má»©c Ä‘á»™ vi mÃ´ vÃ  vÄ© mÃ´.","text":"TÃ¬m hiá»ƒu cÃ¡ch chÃºng khÃ¡c nhau, vÃ  khi báº¡n nÃªn sá»­ dá»¥ng nÃ³.CSS Flexbox Ä‘Ã£ trá»Ÿ nÃªn cá»±c ká»³ quen thuá»™c vá»›i cÃ¡c láº­p trÃ¬nh viÃªn front-end trong vÃ i nÄƒm gáº§n Ä‘Ã¢y. Äiá»u nÃ y khÃ´ng Ä‘Ã¡ng ngáº¡c nhiÃªn, bá»Ÿi vÃ¬ nÃ³ giÃºp chÃºng ta táº¡o ra cÃ¡c bá»‘ cá»¥c Ä‘á»™ng (dynamic layout) vÃ  sáº¯p xáº¿p ná»™i dung trong cÃ¡c container dá»… dÃ ng hÆ¡n ráº¥t nhiá»u. Tuy nhiÃªn, cÃ³ má»™t mÃ´-Ä‘un má»›i gá»i lÃ  CSS Grid vÃ  nÃ³ cÃ³ nhiá»u kháº£ nÄƒng giá»‘ng nhÆ° Flexbox. Trong má»™t vÃ i trÆ°á»ng há»£p nÃ³ tá»‘t hÆ¡n so vá»›i Flexbox, vÃ  má»™t sá»‘ trÆ°á»ng há»£p khÃ¡c thÃ¬ khÃ´ng. Äiá»u nÃ y cÃ³ váº» gÃ¢y nháº§m láº«n cho cÃ¡c láº­p trÃ¬nh viÃªn. VÃ¬ váº­y, bÃ i viáº¿t nÃ y sáº½ so sÃ¡nh hai mÃ´-Ä‘un, cáº£ má»©c Ä‘á»™ vi mÃ´ vÃ  vÄ© mÃ´. Má»™t chiá»u vs hai chiá»uNáº¿u báº¡n rÃºt ra má»™t bÃ i há»c tá»« bÃ i viáº¿t nÃ y, thÃ¬ Ä‘Ã¢y lÃ  nÃ³: Flexbox Ä‘Æ°á»£c táº¡o ra cho cÃ¡c bá»‘ cá»¥c má»™t chiá»u vÃ  Grid Ä‘Æ°á»£c táº¡o ra cho cÃ¡c bá»‘ cá»¥c hai chiá»u. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  náº¿u báº¡n Ä‘ang Ä‘áº·t cÃ¡c item theo má»™t hÆ°á»›ng (vÃ­ dá»¥ ba nÃºt bÃªn trong header), thÃ¬ báº¡n nÃªn sá»­ dá»¥ng Flexbox: NÃ³ sáº½ linh hoáº¡t hÆ¡n CSS Grid. VÃ  cÅ©ng dá»… dÃ ng hÆ¡n Ä‘á»ƒ báº£o trÃ¬ vÃ  yÃªu cáº§u mÃ£ Ã­t hÆ¡n. Tuy nhiÃªn náº¿u báº¡n Ä‘á»‹nh táº¡o bá»‘ cá»¥c theo hai chiá»u - vá»›i cáº£ cÃ¡c hÃ ng vÃ  cÃ¡c cá»™t - thÃ¬ báº¡n nÃªn sá»­ dá»¥ng CSS Grid: Trong trÆ°á»ng há»£p nÃ y, CSS Grid sáº½ linh hoáº¡t hÆ¡n, lÃ m cho code cá»§a báº¡n Ä‘Æ¡n giáº£n hÆ¡n vÃ  dá»… báº£o trÃ¬ hÆ¡n. Táº¥t nhiÃªn báº¡n cÃ³ thá»ƒ káº¿t há»£p cáº£ hai. Trong vÃ­ dá»¥ á»Ÿ trÃªn, giáº£i phÃ¡p hoÃ n háº£o lÃ  sá»­ dá»¥ng Grid cho viá»‡c bá»‘ cá»¥c trang, vÃ  sau Ä‘Ã³ dÃ¹ng Flexbox Ä‘á»ƒ sáº¯p xáº¿p ná»™i dung bÃªn trong header. Äiá»u nÃ y sáº½ cung cáº¥p cho báº¡n nhá»¯ng chá»©c nÄƒng tá»‘t nháº¥t cá»§a cáº£ hai mÃ´-Ä‘un. Content-first vs layout-firstMá»™t khÃ¡c biá»‡t quan trá»ng ná»¯a giá»¯a 2 mÃ´-Ä‘un lÃ  Flexbox táº­p trung vÃ o ná»™i dung trong khi Grid táº­p trung vÃ o bá»‘ cá»¥c. Äiá»u nÃ y cÃ³ váº» trá»«u tÆ°á»£ng, vÃ¬ váº­y hÃ£y xem má»™t vÃ­ dá»¥ cá»¥ thá»ƒ, nÃ³ sáº½ dá»… hiá»ƒu hÆ¡n. ChÃºng ta sáº½ sá»­ dá»¥ng header. ÄÃ¢y lÃ  code HTML cho nÃ³: 12345&lt;header&gt; &lt;div&gt;Home&lt;/div&gt; &lt;div&gt;Search&lt;/div&gt; &lt;div&gt;Logout&lt;/div&gt;&lt;/header&gt; TrÆ°á»›c khi chÃºng ta style nÃ³ vá»›i Flexbox, cÃ¡c div nÃ y sáº½ Ä‘Æ°á»£c xáº¿p chá»“ng lÃªn nhau nhÆ° tháº¿ nÃ y: Flexbox headerTuy nhiÃªn, khi chÃºng ta style nÃ³ vá»›i display: flex; cÃ¡c item sáº½ Ä‘Æ°á»£c Ä‘áº·t trÃªn má»™t dÃ²ng. 123header &#123; display: flex;&#125; Äá»ƒ di chuyá»ƒn nÃºt logout sang phÃ­a bÃªn pháº£i, chÃºng ta chá»‰ cáº§n chá»n pháº§n tá»­ Ä‘Ã³ vÃ  style vá»›i margin: 123header &gt; div:nth-child(3) &#123; margin-left: auto;&#125; Káº¿t quáº£ sáº½ nhÆ° tháº¿ nÃ y: CÃ¡i tÃ´i muá»‘n báº¡n Ä‘á»ƒ Ã½ á»Ÿ Ä‘Ã¢y lÃ  chÃºng ta Ä‘á»ƒ cÃ¡c item tá»± quyáº¿t Ä‘á»‹nh vá»‹ trÃ­ cá»§a mÃ¬nh. ChÃºng ta khÃ´ng pháº£i xÃ¡c Ä‘á»‹nh trÆ°á»›c báº¥t cá»© Ä‘iá»u gÃ¬ khÃ¡c ngoÃ i display: flex;. ÄÃ¢y lÃ  khÃ¡c biá»‡t chÃ­nh giá»¯a Flexbox vÃ  Grid, vÃ  nÃ³ sáº½ trá»Ÿ nÃªn rÃµ rÃ ng hÆ¡n khi chÃºng ta táº¡o header nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng Grid. Máº·c dÃ¹ CSS Grid khÃ´ng Ä‘Æ°á»£c táº¡o ra cho header má»™t chiá»u, nhÆ°ng váº«n lÃ  má»™t Ã½ hay khi lÃ m Ä‘iá»u nÃ y vÃ¬ nÃ³ dáº¡y cho chÃºng ta vá» sá»± khÃ¡c biá»‡t cá»‘t lÃµi giá»¯a Flexbox vÃ  Grid. Grid headerChÃºng ta cÃ³ thá»ƒ táº¡o header theo nhiá»u cÃ¡ch khÃ¡c nhau vá»›i CSS Grid. TÃ´i sáº½ sá»­ dá»¥ng má»™t cÃ¡ch khÃ¡ Ä‘Æ¡n giáº£n, trong Ä‘Ã³ grid cá»§a chÃºng ta cÃ³ mÆ°á»i cá»™t. 1234header &#123; display: grid; grid-template-columns: repeat(10, 1fr);&#125; NÃ³ sáº½ giá»‘ng há»‡t vá»›i giáº£i phÃ¡p Flexbox. Tuy nhiÃªn, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Chrome inspector Ä‘á»ƒ kiá»ƒm tra cÃ¡c dÃ²ng cá»™t: Sá»± khÃ¡c biá»‡t chÃ­nh vá»›i cÃ¡ch tiáº¿p cáº­n nÃ y lÃ  chÃºng ta pháº£i xÃ¡c Ä‘á»‹nh cÃ¡c cá»™t - bá»‘ cá»¥c - Ä‘áº§u tiÃªn. ChÃºng ta báº¯t Ä‘áº§u vá»›i viá»‡c xÃ¡c Ä‘á»‹nh chiá»u rá»™ng cá»§a cÃ¡c cá»™t, vÃ  sau Ä‘Ã³ chÃºng ta Ä‘áº·t ná»™i dung vÃ o cÃ¡c Ã´ cÃ³ sáºµn trong grid. CÃ¡ch tiáº¿p cáº­n nÃ y buá»™c chÃºng ta pháº£i xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»™t mÃ  chÃºng ta muá»‘n chia trong header. Trá»« khi thay Ä‘á»•i grid, cÃ²n khÃ´ng chÃºng ta luÃ´n cÃ³ 10 cá»™t. Má»™t háº¡n cháº¿ mÃ  chÃºng ta sáº½ khÃ´ng pháº£i Ä‘á»‘i máº·t trong Flexbox. Äá»ƒ thay Ä‘á»•i logout sang phÃ­a bÃªn tay pháº£i, chÃºng ta sáº½ Ä‘áº·t nÃ³ vÃ o cá»™t thá»© mÆ°á»i, nhÆ° sau: 123header &gt; div:nth-child(3) &#123; grid-column: 10;&#125; DÃ¹ng Chrome inspector chÃºng ta sáº½ tháº¥y: ChÃºng ta khÃ´ng thá»ƒ chá»‰ Ä‘Æ¡n giáº£n style nÃ³ vá»›i margin-left: auto; vÃ¬ nÃºt logout Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t trong má»™t Ã´ cá»¥ thá»ƒ trong bá»‘ cá»¥c, trong cá»™t thá»© ba. Äá»ƒ di chuyá»ƒn nÃ³, chÃºng ta pháº£i tÃ¬m má»™t Ã´ khÃ¡c cho nÃ³. Káº¿t há»£p cáº£ haiBÃ¢y giá» chÃºng ta hÃ£y xem cÃ¡ch káº¿t há»£p cáº£ hai, sÃ¡t nháº­p header vÃ o bá»‘ cá»¥c trang web. ChÃºng ta sáº½ báº¯t Ä‘áº§u báº±ng cÃ¡ch xÃ¢y dá»±ng bá»‘ cá»¥c trang web. ÄÃ¢y lÃ  HTML: 123456&lt;div class=\"container\"&gt; &lt;header&gt;HEADER&lt;/header&gt; &lt;aside&gt;MENU&lt;/aside&gt; &lt;main&gt;CONTENT&lt;/main&gt; &lt;footer&gt;FOOTER&lt;/footer&gt;&lt;/div&gt; ÄÃ¢y lÃ  CSS: 12345.container &#123; display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: 50px 350px 50px;&#125; ChÃºng ta sáº½ Ä‘áº·t cÃ¡c item trÃªn grid nhÆ° sau: 12345678910111213header &#123; grid-column: span 12;&#125;aside &#123; grid-column: span 2;&#125;main &#123; grid-column: span 10;&#125;footer &#123; grid-column: span 12;&#125; Tiáº¿p theo, chÃºng ta sáº½ chá»‰ cáº§n thÃªm style cho header. ChÃºng ta sáº½ biáº¿n header - má»™t item trong CSS Grid - thÃ nh má»™t Flexbox container. 123header &#123; display: flex;&#125; ChÃºng ta cÃ³ thá»ƒ thiáº¿t láº­p nÃºt logout sang bÃªn pháº£i: 123header &gt; div:nth-child(3) &#123; margin-left: auto;&#125; Káº¿t quáº£, chÃºng ta cÃ³ má»™t bá»‘ cá»¥c hoÃ n háº£o sá»­ dá»¥ng nhá»¯ng tÃ­nh nÄƒng tá»‘t nháº¥t tá»« cáº£ Grid vÃ  Flexbox. Hai container sáº½ trÃ´ng nhÆ° tháº¿ nÃ y: BÃ¢y giá», báº¡n Ä‘Ã£ hiá»ƒu rÃµ sá»± khÃ¡c biá»‡t nÃ³i chung vÃ  cá»¥ thá»ƒ giá»¯a Flexbox vÃ  Grid, vÃ  biáº¿t cÃ¡ch sá»­ dá»¥ng chÃºng cÃ¹ng vá»›i nhau. TrÃ¬nh duyá»‡t há»— trá»£TrÆ°á»›c khi káº¿t thÃºc, tÃ´i cÅ©ng cáº§n Ä‘á» cáº­p Ä‘áº¿n cÃ¡c trÃ¬nh duyá»‡t há»— trá»£ CSS Grid. VÃ o thá»i Ä‘iá»ƒm nÃ y (25/03/2018), 84.14% website toÃ n cáº§u há»— trá»£ CSS Grid, vÃ  nÃ³ Ä‘ang tÄƒng dáº§n. TÃ´i tin nÄƒm 2018 sáº½ lÃ  nÄƒm cá»§a CSS Grid. NÃ³ sáº½ Ä‘á»™t phÃ¡, vÃ  sáº½ trá»Ÿ thÃ nh má»™t ká»¹ nÄƒng pháº£i cÃ³ cá»§a cÃ¡c láº­p trÃ¬nh viÃªn front-end. Giá»‘ng nhÆ° nhá»¯ng gÃ¬ Ä‘Ã£ xáº£y ra vá»›i CSS Flexbox trong vÃ i nÄƒm gáº§n Ä‘Ã¢y.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"flexbox","slug":"flexbox","permalink":"http://nthung2112.github.io/tags/flexbox/"},{"name":"grid","slug":"grid","permalink":"http://nthung2112.github.io/tags/grid/"}]},{"title":"Má»™t sá»‘ thá»§ thuáº­t Chrome DevTools cÃ³ thá»ƒ báº¡n Ä‘Ã£ biáº¿t","slug":"Mot-so-thu-thuat-Chrome-DevTools-co-the-ban-da-biet","date":"2018-03-25T07:54:00.000Z","updated":"2018-03-25T15:14:28.961Z","comments":true,"path":"2018/03/Mot-so-thu-thuat-Chrome-DevTools-co-the-ban-da-biet.html","link":"","permalink":"http://nthung2112.github.io/2018/03/Mot-so-thu-thuat-Chrome-DevTools-co-the-ban-da-biet.html","excerpt":"1. Drag-and-drop in the Elements panelIn the Elements panel, you can drag and drop any HTML element and change its position across the page","text":"1. Drag-and-drop in the Elements panelIn the Elements panel, you can drag and drop any HTML element and change its position across the page 2. Reference the currently selected element in the ConsoleSelect a node in the Elements panel, and type $0 in the console to reference it. If youâ€™re using jQuery, you can enter $($0) to access the jQuery API on this element. 3. Use the value of the last operation in the ConsoleUse $_ to reference the return value of the previous operation executed in the Console 4. Add CSS and edit the element stateIn the Elements panel there are two super useful buttons. The first lets you add a new CSS property with any selector you want, but pre-filling the currently selected element: The second one lets you trigger a state for the selected element, so you can see the styles applied when itâ€™s active, hovered, or on focus. 5. Save to file the modified CSSClick the name of the CSS file that you edited. The inspector opens it into the Sources pane, and from there you can save it with the live edits you applied. This trick does not work for new selectors added using +, or into the element.style properties, but only for modified, existing ones. 6. Screenshot a single elementSelect an element and press cmd-shift-p (or ctrl-shift-p in Windows) to open the Command Menu, and select Capture node screenshot 7. Find an element using CSS selectorsPressing cmd-f (ctrl-f in Windows) opens the search box in the Elements panel. You can type any string in there to match the source code, or you can also use CSS selectors to have Chrome generate an image for you: 8. Shift-enter in the ConsoleTo write commands that span over multiple lines in the Console, press shift-enter. Once youâ€™re ready, press enter at the end of the script to execute it: You can clear the console using the Clear button on the top-left of the console, or by pressing ctrl-l or cmd-k. 9. Go toâ€¦In the Sources panel: cmd-o (ctrl-o in Windows), shows all the files loaded by your page. cmd-shift-o (ctrl-shift-o in Windows) shows the functions (or classes) in the current file. cmd-l (ctrl-l in Windows) goes to a specific line. 10. Watch ExpressionInstead of writing again and again a variable name or an expression you are going to check a lot during a debug session, add it to the Watch Expression list. 11. XHR/Fetch debuggingFrom the debugger open the XHR/Fetch Breakpoints panel. You can set it to break any time a XHR/Fetch call is sent, or just on specific ones: 12. Debug on DOM modificationsRight-click an element and enable Break on Subtree Modifications. Whenever a script traverses that elementâ€™s children and modifies them, the debugger stops automatically to let you inspect whatâ€™s happening.","categories":[{"name":"Tips","slug":"Tips","permalink":"http://nthung2112.github.io/categories/Tips/"}],"tags":[{"name":"tips","slug":"tips","permalink":"http://nthung2112.github.io/tags/tips/"},{"name":"chorme","slug":"chorme","permalink":"http://nthung2112.github.io/tags/chorme/"}]},{"title":"Kiáº¿n thá»©c cho phá»ng váº¥n Javascript developer","slug":"Kien-thuc-cho-phong-van-Javascript-developer","date":"2018-01-02T15:12:14.000Z","updated":"2018-03-25T04:12:04.733Z","comments":true,"path":"2018/01/Kien-thuc-cho-phong-van-Javascript-developer.html","link":"","permalink":"http://nthung2112.github.io/2018/01/Kien-thuc-cho-phong-van-Javascript-developer.html","excerpt":"JavaScript is the most popular programming language and has been since 2014, according to Stack Overflow Survey. It is no wonder that over 1/3rd of all developer jobs require some JavaScript knowledge. So, if you plan to work as a developer in the near future, you should be familiar with this extremely popular language. The postâ€™s purpose is to bring together all JavaScript concepts that are frequently brought up in developer interviews. It was written so you can review everything you need to know about JavaScript in a single place.","text":"JavaScript is the most popular programming language and has been since 2014, according to Stack Overflow Survey. It is no wonder that over 1/3rd of all developer jobs require some JavaScript knowledge. So, if you plan to work as a developer in the near future, you should be familiar with this extremely popular language. The postâ€™s purpose is to bring together all JavaScript concepts that are frequently brought up in developer interviews. It was written so you can review everything you need to know about JavaScript in a single place. Types &amp; CoercionThere are 7 built-in types: null, undefined , boolean, number, string, object and symbol (ES6). All of these are types are called primitives, except for object. Null vs. Undefined Undefined is the absence of a definition. It is used as the default value for uninitialized variables, function arguments that were not provided and missing properties of objects. Functions return undefined when nothing has been explicitly returned. Null is the absence of a value. It is an assignment value that can be assigned to a variable as a representation of â€˜no-valueâ€™. Implicit coercion Take a look at the following example: In this case, the string variable name is coerced to true and you have â€˜Joey doesnâ€™t share food!â€™ printed in our console. But how do you know what will be coerced to true and what will be coerced to false? Falsy values are values that will be coerced to false when forced a boolean coercion on it. Falsy values: â€œâ€, 0, null, undefined, NaN, false. Anything not explicitly on the falsy list is truthy â€”boolean coerced to true. Yes. You read it right. Empty arrays, objects and functions are boolean coerced to true! String &amp; Number coercion The first thing you need to be aware of is the + operator. This is a tricky operator because it works for both number addition and string concatenation. But, the *, /, and - operators are exclusive for numeric operations. When these operators are used with a string, it forces the string to be coerced to a number. == vs. === It is widely spread that == checks for equality and === checks for equality and type. Well, that is a misconception. In fact, == checks for equality with coercion and === checks for equality without coercion â€” strict equality. Coercion can be tricky. Take a look at the following code: What would you expect for the following comparison?console.log(a == b); (1) This comparison actually returns True. Why?What really happens under the hood is that if you are comparing a boolean with something other than a boolean, JavaScript coerces that boolean to a number and compares. (2) This comparison is now between a number and a string. JavaScript now coerces that string to a number and compares both numbers. (3) In this case, the final comparison 0 == 0 is True. 123'0' == false (1)'0' == 0 (2) 0 == 0 (3) For a fully comprehension on how such comparisons are performed, you can check ES5 documentation here. For a cheat sheet, you can click here. Some tricky comparisons to look out for: Value vs. ReferenceSimple values (also known as primitives) are always assigned by value-copy: null, undefined , boolean, number, string and ES6 symbol. Compound values always create a copy of the reference on assignment: objects, which includes arrays, and functions. To copy a compound value by value, you need to makea copy of it. The reference does not point to the original value. Scop_e_Scope refers to the execution context. It defines the accessibility of variables and functions in the code. Global Scope is the outermost scope. Variables declared outside a function are in the global scope and can be accessed in any other scope. In a browser, the window object is the global scope. Local Scope is a scope nested inside another function scope. Variables declared in a local scope are accessible within this scope as well as in any inner scopes. You may think of Scopes as a series of doors decreasing in size (from biggest to smallest). A short person that fits through the smallest door â€” innermost scope â€” also fits through any bigger doors â€” outer scopes. A tall person that gets stuck on the third door, for example, will have access to all previous doors â€” outer scopes â€” but not any further doors â€” inner scopes. HoistingThe behavior of â€œmovingâ€ var and function declarations to the top of their respective scopes during the compilation phase is called hoisting. Function declarations are completely hoisted. This means that a declared function can be called before it is defined. Variables are partially hoisted. var declarations are hoisted but not its assignments. let and const are not hoisted. Function Expression vs. Function Declaration Function Expression A Function Expression is created when the execution reaches it and is usable from then on â€” it is not hoisted. Function Declaration A Function Declaration can be called both before and after it was defined â€” it is hoisted. Variables: var, let and constBefore ES6, it was only possible to declare a variable using var. Variables and functions declared inside another function cannot be accessed by any of the enclosing scopes â€” they are function-scoped. Variables declared inside a block-scope, such as if statements and for loops, can be accessed from outside of the opening and closing curly braces of the block. Note: An undeclared variable â€” assignment without var, let or const â€” creates a var variable in global scope. ES6 let and const are new. They are not hoisted and block-scoped alternatives for variable declaration. This means that a pair of curly braces define a scope in which variables declared with either let or const are confined in. A common misconception is that const is immutable. It cannot be reassigned, but its properties can be changed! ClosureA closure is the combination of a function and the lexical environment from which it was declared. Closure allows a function to access variables from an enclosing scope â€” environment â€” even after it leaves the scope in which it was declared. The above example covers the two things you need to know about closures: Refers to variables in outer scope.The returned function access themessage variable from the enclosing scope. It can refer to outer scope variables even after the outer function has returned.sayHiToJon is a reference to the greeting function, created when sayHi was run. The greeting function maintains a reference to its outer scope â€” environment â€” in which message exists. One of the main benefits of closures is that it allows data encapsulation. This refers to the idea that some data should not be directly exposed. The following example illustrates that. By the time elementary is created, the outer function has already returned. This means that the staff variable only exists inside the closure and it cannot be accessed otherwise. Letâ€™s go deeper into closures by solving one of the most common interview problems on this subject:What is wrong with the following code and how would you fix it? Considering the above code, the console will display four identical messages â€œThe value undefined is at index: 4â€. This happens because each function executed within the loop will be executed after the whole loop has completed, referencing to the last value stored in i, which was 4. This problem can be solved by using IIFE, which creates a unique scope for each iteration and storing each value within its scope. Another solution would be declaring the i variable with let, which creates the same result. Immediate Invoked Function Expression (IIFE)An IIFE is a function expression that is called immediately after you define it. It is usually used when you want to create a new variable scope. The (surrounding parenthesis) prevents from treating it as a function declaration. The final parenthesis() are executing the function expression. On IIFE you are calling the function exactly when you are defining it. Using IIFE: Enables you to attach private data to a function. Creates fresh environments. Avoids polluting the global namespace. ContextContext is often confused as the same thing as Scope. To clear things up, lets keep the following in mind:Context is most often determined by how a function is invoked. It always refers to the value of this in a particular part of your code.Scope refers to the visibility of variables. Function calls: call, apply and bindAll of these three methods are used to attach thisinto function and the difference is in the function invocation. .call() invokes the function immediately and requires you to pass in arguments as a list (one by one). .apply() invokes the function immediately and allows you to pass in arguments as an array. .call() and .apply() are mostly equivalent and are used to borrow a method from an object. Choosing which one to use depends on which one is easier to pass the arguments in. Just decide whether itâ€™s easier to pass in an array or a comma separated list of arguments. Quick tip: Apply for Array â€” Call for Comma. Note: If you pass in an array as one of the arguments on a call function, it will treat that entire array as a single element.ES6 allows us to spread an array as arguments with the call function. 1char.knows.call(Snow, ...[\"nothing\", \"Jon\"]); // You know nothing, Jon Snow .bind() returns a new function, with a certain context and parameters. It is usually used when you want a function to be called later with a certain context. That is possible thanks to its ability to maintain a given context for calling the original function. This is useful for asynchronous callbacks and events. .bind() works like the call function. It requires you to pass in the arguments one by one separated by a comma. â€˜thisâ€™ keywordUnderstanding the keyword thisin JavaScript, and what it is referring to, can be quite complicated at times. The value of thisis usually determined by a functions execution context. Execution context simply means how a function is called. The keyword thisacts as a placeholder, and will refer to whichever object called that method when the method is actually used. The following list is the ordered rules for determining this. Stop at the first one that applies: new binding â€” When using the new keyword to call a function, thisis the newly constructed object. Explicit binding â€” When call or apply are used to call a function, thisis the object that is passed in as the argument.Note: .bind() works a little bit differently. It creates a new function that will call the original one with the object that was bound to it. Implicit binding â€” When a function is called with a context (the containing object), thisis the object that the function is a property of.This means that a function is being called as a method. Default binding â€” If none of the above rules applies, thisis the global object (in a browser, itâ€™s the window object).This happens when a function is called as a standalone function.A function that is not declared as a method automatically becomes a property of the global object. Note: This also happens when a standalone function is called from within an outer function scope. Lexical this â€” When a function is called with an arrow function =&gt;, thisreceives the thisvalue of its surrounding scope at the time itâ€™s created.thiskeeps the value from its original context. Strict ModeJavaScript is executed in strict mode by using the â€œuse strictâ€ directive. Strict mode tightens the rules for parsing and error handling on your code. Some of its benefits are: Makes debugging easier â€” Code errors that would otherwise have been ignored will now generate errors, such as assigning to non-writable global or property. Prevents accidental global variables â€” Assigning a value to an undeclared variable will now throw an error. Prevents invalid use of delete â€” Attempts to delete variables, functions and undeletable properties will now throw an error. Prevents duplicate property names or parameter values â€” Duplicated named property in an object or argument in a function will now throw an error. (This is no longer the case in ES6) Makes eval() safer â€” Variables and functions declared inside an eval() statement are not created in the surrounding scope. â€œSecuresâ€ JavaScript eliminating this coercion â€” Referencing a this value of null or undefined is not coerced to the global object. This means that in browsers itâ€™s no longer possible to reference the window object using this inside a function. new keywordThe new keyword invokes a function in a special way. Functions invoked using the new keyword are called constructor functions. So what does the new keyword actually do? Creates a new object. Sets the objectâ€™s prototypeto be the prototypeof the constructor function. Executes the constructor function with this as the newly created object. Returns the created object. If the constructor returns an object, this object is returned. What is the difference between invoking a function with the new keyword and without it? Prototype and InheritancePrototype is one of the most confusing concepts in JavaScript and one of the reason for that is because there are two different contexts in which the word prototype is used. Prototype relationship Each object has a prototypeobject, from which it inherits all of its prototypeâ€™s properties..proto is a non-standard mechanism (available in ES6) for retrieving the prototypeof an object (*). It points to the objectâ€™s â€œparentâ€ â€”the objectâ€™s prototype.All normal objects also inherit a .constructor property that points to the constructor of the object. Whenever an object is created from a constructor function, the .proto property links that object to the .prototype property of the constructor function used to create it.(*) _Object.getPrototypeOf()_is the standard ES5 function for retrieving the prototype of an object. Prototype property Every function has a .prototype property.It references to an object used to attach properties that will be inherited by objects further down the prototype chain. This object contains, by default, a .constructor property that points to the original constructor function.Every object created with a constructor function inherits a constructor property that points back to that function. Prototype ChainThe prototype chain is a series of links between objects that reference one another. When looking for a property in an object, JavaScript engine will first try to access that property on the object itself. If it is not found, the JavaScript engine will look for that property on the object it inherited its properties from â€” the objectâ€™s prototype. The engine will traverse up the chain looking for that property and return the first one it finds. The last object in the chain is the built-in Object.prototype, which has null as its prototype. Once the engine reaches this object, it returns undefined. Own vs Inherited PropertiesObjects have own properties and inherited properties. Own properties are properties that were defined on the object. Inherited properties were inherited through prototype chain. Object.create(obj) â€” Creates a new object with the specified prototypeobject and properties. Inheritance by referenceAn inherited property is a copy by reference of the prototype objectâ€™sproperty from which it inherited that property. If an objectâ€™s property is mutated on the prototype, objects which inherited that property will share the same mutation. But if the property is replaced, the change will not be shared. Classical Inheritance vs. Prototypal InheritanceIn classical inheritance, objects inherit from classes â€” like a blueprint or a description of the object to be created â€” and create sub-class relationships. These objects are created via constructor functions using the new keyword. The downside of classical inheritance is that it causes:inflexible hierarchytight coupling problemsfragile base class problemsduplication problemsAnd the so famous gorilla/banana problem â€” â€œWhat you wanted was a banana, what you got was a gorilla holding the banana, and the entire jungle.â€ In prototypal inheritance, objects inherit directly from other objects. Objects are typically created via Object.create(), object literals or factory functions. There are three different kinds of prototypal inheritance: Prototype delegation â€” A delegate prototype is an object which is used as a model for another object. When you inherit from a delegate prototype, the new object gets a reference to the prototype and its properties.This process is usually accomplished by using Object.create(). Concatenative inheritance â€” The process of inheriting properties from one object to another by copying the objectâ€™s prototype properties, without retaining a reference between them.This process is usually accomplished by using Object.assign(). Functional inheritance â€” This process makes use of a factory function(*) to create an object, and then adds new properties directly to the created object.This process has the benefit of allowing data encapsulation via closure.(*)Factory function is a function that is not a class or constructor that returns an object without using the new keyword. You can find a complete article on this topic by Eric Elliott here. Favor composition over class inheritanceMany developers agree that class inheritance should be avoided in most cases. In this pattern you design your types regarding what they are, which makes it a very strict pattern. Composition, on the other hand, you design your types regarding what they do, which makes it more flexible and reusable. Here is a nice video on this topic by Mattias Petter Johansson Asynchronous JavaScriptJavaScript is a single-threaded programming language. This means that the JavaScript engine can only process a piece of code at a time. One of its main consequences is that when JavaScript encounters a piece of code that takes a long time to process, it will block all code after that from running. JavaScript uses a data structure that stores information about active functions named Call Stack. A Call Stack is like a pile of books. Every book that goes into that pile sits on top of the previous book. The last book to go into the pile will be the first one removed from it, and the first book added to the pile will be the last one removed. The solution to executing heavy pieces of code without blocking anything is asynchronous callback functions. These functions are executed later â€” asynchronously. The asynchronous process begins with an asynchronous callback functions placed into a Heap or region of memory. You can think of the Heap as an Event Manager. The Call Stack asks the Event Manager to execute a specific function only when a certain event happens. Once that event happens, the Event Manager moves the function to the Callback Queue. Note: When the Event Manager handles a function, the code after that is not blocked and JavaScript continues its execution. The Event Loop handles the execution of multiple pieces of your code over time. The Event Loop monitors the Call Stack and the Callback Queue. The Call Stack is constantly checked whether it is empty or not. When it is empty, the Callback Queue is checked if there is a function waiting to be invoked. When there is a function waiting, the first function in the queue is pushed into the Call Stack, which will run it. This checking process is called a â€˜tickâ€™ in the Event Loop. Letâ€™s break down the execution of the following code to understand how this process works: Initially the Browser console is clear and the Call Stack and Event Manager are empty. first() is added to the Call Stack. console.log(â€œFirst messageâ€) is added to the Call Stack. console.log(â€œFirst messageâ€) is executed and the Browser console displays â€œFirst messageâ€_._ console.log(â€œFirst messageâ€) is removed from the Call Stack. first() is remove from the Call Stack. setTimeout(second, 0) is added to the Call Stack. setTimeout(second, 0) is executed and handled by the Event Manager. And after 0ms the Event Manager moves second() to the Callback Queue. setTimeout(second, 0) is now completed and removed from the Call Stack. third() is added to the Call Stack. console.log(â€œThird messageâ€) is added to the Call Stack. console.log(â€œThird messageâ€) is executed and the Browser console displays â€œThird messageâ€_._ console.log(â€œThird messageâ€) is removed from the Call Stack. Call Stack is now empty and the second() function is waiting to be invoked in the Callback Queue. The Event Loop moves second() from the Callback Queue to the Call Stack. console.log(â€œSecond messageâ€) is added to the Call Stack. console.log(â€œSecond messageâ€) is executed and the Browser console displays â€œSecond messageâ€. console.log(â€œSecond messageâ€) is removed from the Call Stack. second() is removed from the Call Stack. Note: The second() function is not executed after 0ms. The time you pass in to setTimeout function does not relate to the delay of its execution. The Event Manager will wait the given timebefore moving that function into the Callback Queue. Its execution will only take place on a future â€˜tickâ€™ in the Event Loop.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Cáº£i thiá»‡n tá»‘c Ä‘á»™ Web App vá»›i Tinder","slug":"Cai-thien-toc-do-Web-App-voi-Tinder","date":"2017-12-25T11:29:59.000Z","updated":"2018-03-24T03:25:31.654Z","comments":true,"path":"2017/12/Cai-thien-toc-do-Web-App-voi-Tinder.html","link":"","permalink":"http://nthung2112.github.io/2017/12/Cai-thien-toc-do-Web-App-voi-Tinder.html","excerpt":"Tinder recently swiped right on the web. Their new responsive Progressive Web App â€” Tinder Online â€” is available to 100% of users on desktop and mobile, employing techniques for JavaScript performance optimization, Service Workers for network resilience and Push Notifications for chat engagement. Today weâ€™ll walk through some of their web perf learnings.","text":"Tinder recently swiped right on the web. Their new responsive Progressive Web App â€” Tinder Online â€” is available to 100% of users on desktop and mobile, employing techniques for JavaScript performance optimization, Service Workers for network resilience and Push Notifications for chat engagement. Today weâ€™ll walk through some of their web perf learnings. Journey to a Progressive Web AppTinder Online started with the goal of getting adoption in new markets, striving to hit feature parity with V1 of Tinderâ€™s experience on other platforms. The MVP for the PWA took 3 months to implement using React as their UI library and Redux for state management. The result of their efforts is a PWA that delivers the core Tinder experience in 10% of the data-investment costs for someone in a data-costly or data-scarce market: Comparing the data-investment for Tinder Online vs the native apps. Itâ€™s important to note that this isnâ€™t comparing apples to apples, however. The PWA loads code for new routes on demand, and the cost of additional code is amortized over the lifetime of the application. Subsequent navigations still donâ€™t cost as much data as the download of the app. Early signs show good swiping, messaging and session length compared to the native app. With the PWA: Users swipe more on web than their native apps Users message more on web than their native apps Users purchase on par with native apps Users edit profiles more on web than on their native apps Session times are longer on web than their native apps PerformanceThe mobile devices Tinder Onlineâ€™s users most commonly access their web experience with include: Apple iPhone &amp; iPad Samsung Galaxy S8 Samsung Galaxy S7 Motorola Moto G4 Using the Chrome User Experience report (CrUX), weâ€™re able to learn that the majority of users accessing the site are on a 4G connection: Note: Rick Viscomi recently covered CrUX on PerfPlanet and Inian Parameshwaran covered rUXt for better visualizing this data for the top 1M sites. Testing the new experience on WebPageTest and Lighthouse (using the Galaxy S7 on 4G) we can see that theyâ€™re able to load and get interactive in under 5 seconds: There is of course lots of room to improve this further on median mobile hardware (like the Moto G4), which is more CPU constrained: Tinder are hard at work on optimizing their experience and we look forward to hearing about their work on web performance in the near future. Performance OptimizationTinder were able to improve how quickly their pages could load and become interactive through a number of techniques. They implemented route-based code-splitting, introduced performance budgets and long-term asset caching. Route-level code-splittingTinder initially had large, monolithic JavaScript bundles that delayed how quickly their experience could get interactive. These bundles contained code that wasnâ€™t immediately needed to boot-up the core user experience, so it could be broken up using code-splitting. Itâ€™s generally useful to only ship code users need upfront and lazy-load the rest as needed. To accomplish this, Tinder used React Router and React Loadable. As their application centralized all their route and rendering info a configuration base, they found it straight-forward to implement code splitting at the top level. In summary: React Loadable is a small library by James Kyle to make component-centric code splitting easier in React. Loadable is a higher-order component (a function that creates a component) which makes it easy to split up bundles at a component level. Letâ€™s say we have two components â€œAâ€ and â€œBâ€. Before code-splitting, Tinder statically imported everything (A, B, etc) into their main bundle. This was inefficient as we didnâ€™t need both A and B right away: After adding code-splitting, components A and B could be loaded as and when needed. Tinder did this by introducing React Loadable, dynamic import() and webpackâ€™s magic comment syntax (for naming dynamic chunks) to their JS: For â€œvendorâ€ (library) chunking, Tinder used the webpack CommonsChunkPlugin to move commonly used libraries across routes up to a single bundle file that could be cached for longer periods of time: Next, Tinder used React Loadableâ€™s preload support to preload potential resources for the next page on control component: Tinder also used Service Workers to precache all their route level bundles and include routes that users are most likely to visit in the main bundle without code-splitting. Theyâ€™re of course also using common optimizations like JavaScript minification via UglifyJS: 12345678new webpack.optimize.UglifyJsPlugin(&#123; parallel: true, compress: &#123; warnings: false, screw_ie8: true &#125;, sourceMap: SHOULD_SOURCEMAP &#125;), ImpactAfter introducing route-based code-splitting their main bundle sizes went down from 166KB to 101KB and DCL improved from 5.46s to 4.69s: Long-term asset cachingEnsuring long-term caching of static resources output by webpack benefits from using [chunkhash] to add a cache-buster to each file. Tinder were using a number of open-source (vendor) libraries as part of their dependency tree. Changes to these libraries would originally cause the [chunkhash] to change and invalidate their cache. To address this, Tinder began defining a whitelist of external dependencies and splitting out their webpack manifest from the main chunk to improve caching. The bundle size is now about 160KB for both chunks. Preloading late-discovered resourcesAs a refresher, is a declarative instruction to the browser to load critical, late-discovered resources earlier on. In single-page applications, these resources can sometimes be JavaScript bundles. Tinder implemented support for to preload their critical JavaScript/webpack bundles that were important for the core experience. This reduced load time by 1s and first paint from 1000ms to about 500ms. Performance budgetsTinder adopted performance budgets for helping them hit their performance goals on mobile. As Alex Russell noted in â€œCan you afford it?: real-world performance budgetsâ€, you have a limited headroom to deliver an experience when considering slow 3G connections being used on median mobile hardware. To get and stay interactive quickly, Tinder enforced a budget of ~155KB for their main and vendor chunks, asynchronous (lazily loaded) chunks are ~55KB and other chunks are ~35KB. CSS has a limit of 20KB. This was crucial to ensuring they were able to avoid regressing on performance. Webpack Bundle AnalysisWebpack Bundle Analyzer allows you to discover what the dependency graph for your JavaScript bundles looks like so you can discover whether thereâ€™s low-hanging fruit to optimize. Tinder used Webpack Bundle Analyzer to discover areas for improvement: Polyfills: Tinder are targeting modern browsers with their experience but also support IE11 and Android 4.4 and above. To keep polyfills &amp; transpiled code to a minimum, they use For polyfills, they use babel-preset-env and core-js. Slimmer use of libraries: Tinder replaced localForage with direct use of IndexedDB. Better splitting: Split out components from the main bundles which were not required for first paint/interactive Code re-use: Created asynchronous common chunks to abstract chunks used more than three times from children. CSS: Tinder also removed critical CSS from their core bundles (as they had shifted to server-side rendering and delivered this CSS anyway) Using bundle analysis led to also also taking advantage of Webpackâ€™s Lodash Module Replacement Plugin. The plugin creates smaller Lodash builds by replacing feature sets of modules with noop, identity or simpler alternatives: Webpack Bundle Analyzer can be integrated into your Webpack config. Tinderâ€™s setup for it looks like this: 12345678910plugins: [ new BundleAnalyzerPlugin(&#123; analyzerMode: 'server', analyzerPort: 8888, reportFilename: 'report.html', openAnalyzer: true, generateStatsFile: false, statsFilename: 'stats.json', statsOptions: null &#125;) The majority of the JavaScript left is the main chunk which is trickier to split out without architecture changes to Redux Reducer and Saga Register. CSS StrategyTinder are using Atomic CSS to create highly reusable CSS styles. All of these atomic CSS styles are inlined in the initial paint and some of the rest of the CSS is loaded in the stylesheet (including animation or base/reset styles). Critical styles have a maximum size of 20KB gzipped, with recent builds coming in at a lean &lt; 11KB. Tinder use CSS stats and Google Analytics for each release to keep track of what has changed. Before Atomic CSS was being used, average page load times were ~6.75s. After they were ~5.75s. Tinder Online also uses the PostCSS Autoprefixer plugin to parse CSS and add vendor prefixes based on rules from Can I Use: 12345678910111213141516new webpack.LoaderOptionsPlugin(&#123; options: &#123; context: paths.basePath, output: &#123; path: './' &#125;, minimize: true, postcss: [ autoprefixer(&#123; browsers: [ 'last 2 versions', 'not ie &lt; 11', 'Safari &gt;= 8' ] &#125;) ] &#125;&#125;), Runtime performanceDeferring non-critical work with requestIdleCallback()To improve runtime performance, Tinder opted to use requestIdleCallback() to defer non-critical actions into idle time. 1requestIdleCallback(myNonEssentialWork); This included work like instrumentation beacons. They also simplified some HTML composite layers to reduce paint count while swiping. Using requestIdleCallback() for their instrumentation beacons while swiping: before.. and after.. Dependency upgradesWebpack 3 + Scope Hoisting In older versions of webpack, when bundling each module in your bundle would be wrapped in individual function closures. These wrapper functions made it slower for your JavaScript to execute in the browser. Webpack 3 introduced â€œscope hoistingâ€ â€” the ability to concatenate the scope of all your modules into one closure and allow for your code to have a faster execution time in the browser. It accomplishes this with the Module Concatenation plugin: 1new webpack.optimize.ModuleConcatenationPlugin() Webpack 3â€™s scope hoisting improved Tinderâ€™s initial JavaScript parsing time for vendor chunk by 8%. React 16 React 16 introduced improvements that decreased Reactâ€™s bundle size compared to previous versions. This was in part due to better packaging (using Rollup) as well as removing now unused code. By updating from React 15 to React 16, Tinder reduced the total gzipped size of their vendor chunk by ~7%. The size of react + react-dom used to be~50KB gzipped and is now just ~35KB. Thanks to Dan Abramov, Dominic Gannaway and Nate Hunzaker who were instrumental in trimming down React 16â€™s bundle size. Workbox for network resilience and offline asset cachingTinder also use the Workbox Webpack plugin for caching both their Application Shell and their core static assets like their main, vendor, manifest bundles and CSS. This enables network resilience for repeat visits and ensures that the application starts-up more quickly when a user returns for subsequent visits. OpportunitiesDigging into the Tinder bundles using source-map-explorer (another bundle analysis tool), there are additional opportunities for reducing payload size. Before logging in, components like Facebook Photos, notifications, messaging and captchas are fetched. Moving these away from the critical path could save up to 20% off the main bundle: Another dependency in the critical path is a 200KB Facebook SDK script. Dropping this script (which could be lazily loaded when needed) could shave 1 second off initial loading time. ConclusionsTinder are still iterating on their Progressive Web App but have already started to see positive results from the fruits of their labor. Check out Tinder.com and stay tuned for more progress in the near future! With thanks and congrats to Roderick Hsiao, Jordan Banafsheha, and Erik Hellenbrand for launching Tinder Online and their input to this article. Thanks to Cheney Tsai for his review. Related reading: A Pinterest PWA performance case study A Treebo React &amp; Preact performance case study Twitter Lite and high-performance PWAs at scale This article was cross-posted from Performance Planet. If youâ€™re new to React, Iâ€™ve found React for Beginners a comprehensive starting point.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"JavaScript Start-up Performance","slug":"JavaScript-Start-up-Performance","date":"2017-12-16T07:46:39.000Z","updated":"2017-12-16T07:59:58.668Z","comments":true,"path":"2017/12/JavaScript-Start-up-Performance.html","link":"","permalink":"http://nthung2112.github.io/2017/12/JavaScript-Start-up-Performance.html","excerpt":"JavaScript Start-up PerformanceAs web developers, we know how easy it is to end up with web page bloat. But loading a webpage is much more than shipping bytes down the wire. Once the browser has downloaded our pageâ€™s scripts it then has to parse, interpret &amp; run them. In this post, weâ€™ll dive into this phase for JavaScript, why it might be slowing down your appâ€™s start-up &amp; how you can fix it. Historically, we just havenâ€™t spent a lot of time optimizing for the JavaScript Parse/Compile step. We almost expect scripts to be immediately parsed and executed as soon as the parser hits a &lt;script&gt; tag. But this isnâ€™t quite the case. Hereâ€™s a simplified breakdown of how V8 works: A simplified view of how V8 works. This is our idealized pipeline that weâ€™re working towards. Letâ€™s focus on some of the main phases.","text":"JavaScript Start-up PerformanceAs web developers, we know how easy it is to end up with web page bloat. But loading a webpage is much more than shipping bytes down the wire. Once the browser has downloaded our pageâ€™s scripts it then has to parse, interpret &amp; run them. In this post, weâ€™ll dive into this phase for JavaScript, why it might be slowing down your appâ€™s start-up &amp; how you can fix it. Historically, we just havenâ€™t spent a lot of time optimizing for the JavaScript Parse/Compile step. We almost expect scripts to be immediately parsed and executed as soon as the parser hits a &lt;script&gt; tag. But this isnâ€™t quite the case. Hereâ€™s a simplified breakdown of how V8 works: A simplified view of how V8 works. This is our idealized pipeline that weâ€™re working towards. Letâ€™s focus on some of the main phases. What slows our web apps from booting up?Parsing, Compiling and Executing scripts are things a JavaScript engine spends significant time in during start-up. This matters as if it takes a while, it can delay how soon users can interact with our site. Imagine if they can see a button but not click or touch it for multiple seconds. This can degrade the user experience. Parse &amp; Compile times for a popular website using V8â€™s Runtime Call Stats in Chrome Canary. Notice how a slow Parse/Compile on desktop can take far longer on average mobile phones. Start-up times matter for performance-sensitive code. In fact, V8 - Chromeâ€™s JavaScript engine, spends a large amount of time parsing and compiling scripts on top sites like Facebook, Wikipedia and Reddit: The pink area (JavaScript) represents time spent in V8 and Blinkâ€™s C++, while the orange and yellow represent parse and compile. Parse and Compile have also been highlighted as a bottleneck by a number of large sites &amp; frameworks you may be using. Below are tweets from Facebookâ€™s Sebastian Markbage and Googleâ€™s Rob Wormald: Sam Saccone calls out the cost of JS parse in â€˜Planning for Performanceâ€™As we move to an increasingly mobile world, itâ€™s important that we understand the time spent in Parse/Compile can often be 2â€“5x as long on phones as on desktop. Higher-end phones (e.g the iPhone or Pixel) will perform very differently to a Moto G4. This highlights the importance of us testing on representative hardware (not just high-end!) so our usersâ€™ experiences donâ€™t suffer.Parse times for a 1MB bundle of JavaScript across desktop &amp; mobile devices of differing classes. Notice how close a high-end phone like an iPhone 7 is to perf on a Macbook Pro vs the performance as we go down the graph towards average mobile hardware.If weâ€™re shipping huge bundles for our app, this is where endorsing modern bundling techniques likecode-splitting, tree-shaking and Service Worker caching can really make a huge difference. That said, even a small bundle, written poorly or with poor library choices can result in the main thread being pegged for a long time in compilation or function call times. Itâ€™s important to holistically measure and understand where our real bottlenecks are.### What Are JavaScript Parse &amp; Compile bottlenecks for the average website?â€œBuuuut, Iâ€™m not Facebookâ€, I hear you say dear, reader. â€œHow heavy are Parse &amp; Compile times for average sites out in the wild?â€, you might be asking. Letâ€™s science this out!I spent two months digging into the performance of a large set of production sites (6000+) built with different libraries and frameworks â€” like React, Angular, Ember and Vue. Most of the tests were recently redone on WebPageTest so you can easily redo them yourself or dig into the numbers if you wish. Here are some insights.Apps became interactive in 8 seconds on desktop (using cable) and 16 seconds on mobile (Moto G4 over 3G)What contributed to this? Most apps spent an average of 4 seconds in start-up (Parse/Compile/Exec)..on desktop.On mobile, parse times were up to 36% higher than they were on desktop.Was everyone shipping huge JS bundles? Not as large as I had guessed, but thereâ€™s room for improvement. At the median, developers shipped 410KB of gzipped JS for their pages. This is in line with the 420KB over â€˜average JS per pageâ€™ reported by the HTTPArchive. The worst offenders were sending anywhere up to 10MB of script down the wire. Oof.HTTPArchive stat: the average page ships down 420KB of JavaScriptScript size is important, but it isnâ€™t everything. Parse and Compile times donâ€™t necessarily increase linearly when the script size increases. Smaller JavaScript bundles generally do result in a faster load time (regardless of our browser, device &amp; network connection) but 200KB of our JS !== 200KB of someone elseâ€™s and can have wildly different parse and compile numbers.### Measuring JavaScript Parse &amp; Compile todayChrome DevToolsTimeline (Performance panel) &gt; Bottom-Up/Call Tree/Event Log will let us drill into the amount of time spent in Parse/Compile. For a more complete picture (like the time spent in Parsing, Preparsing or Lazy Compiling), we can turn on V8â€™s Runtime Call Stats. In Canary, this will be in Experiments &gt; V8 Runtime Call Stats on Timeline.Chrome Tracingabout:tracing â€” Chromeâ€™s lower-level Tracing tool allows us to use the disabled-by-default-v8.runtime_stats category to get deeper insights into where V8 spends its time. V8 have a step-by-step guide on how to use this that was published just the other day.WebPageTestWebPageTestâ€™s â€œProcessing Breakdownâ€ page includes insights into V8 Compile, EvaluateScript and FunctionCall time when we do a trace with the Chrome &gt; Capture Dev Tools Timeline enabled.We can now also get out the Runtime Call Stats by specifying disabled-by-default-v8.runtime_stats as a custom Trace category (Pat Meenan of WPT now does this by default!).For a guide on how to get the most out of this, see this gist I wrote up.User TimingItâ€™s possible to measure Parse times through the User Timing API as Nolan Lawson points out below: The third &lt;script&gt; here isnâ€™t important, but itâ€™s the first &lt;script&gt; being separate from the second (performance.mark() starting before the &lt;script&gt; has been reached) that is. This approach can be affected on subsequent reloads by V8â€™s preparser. This could be worked around by appending a random string to the end of the script, something Nolan does in his optimize-js benchmarks. I use a similar approach for measuring the impact of JavaScript Parse times using Google Analytics: A custom Google Analytics dimension for â€˜parseâ€™ allows me to measure JavaScript parse times from real users and devices hitting my pages in the wild. DeviceTiming Etsyâ€™s DeviceTiming tool can help measure parse &amp; execution times for scripts in a controlled environment. It works by wrapping local scripts with instrumentation code so that each time our pages are hit from different devices (e.g laptops, phones, tablets) we can locally compare parse/exec. Daniel Espesetâ€™s Benchmarking JS Parsing and Execution on Mobile Devices goes into more detail on this tool. What can we do to lower our JavaScript parse times today? Ship less JavaScript. The less script that requires parsing, the lower our overall time spent in the parse &amp; compile phases will be. Use code-splitting to only ship the code a user needs for a route and lazy load the rest. This probably is going to help the most to avoid parsing too much JS. Patterns like PRPL encourage this type of route-based chunking, now used by Flipkart, Housing.com and Twitter. Script streaming: In the past, V8 have told developers to use async/defer to opt into script streaming for parse-time improvements of between 10â€“20%. This allows the HTML parser to at least detect the resource early, push the work to the script streaming thread and not halt the document parsing. Now that this is done for parser-blocking scripts too, I donâ€™t think thereâ€™s anything actionable we need to do here. V8 recommend loading larger bundles earlier on as thereâ€™s only one streamer thread (more on this later) Measure the parse cost of our dependencies, such as libraries and frameworks. Where possible, switch them out for dependencies with faster parse times (e.g switch React for Preact or Inferno, which require fewer bytes to bootup and have smaller parse/compile times). Paul Lewis covered framework bootup costs in a recent article. As Sebastian Markbage has also noted, a good way to measure start-up costs for frameworks is to first render a view, delete and then render again as this can tell you how it scales. The first render tends to warm up a bunch of lazily compiled code, which a larger tree can benefit from when it scales. If our JavaScript framework of choice supports an ahead-of-time compilation mode (AoT), this can also help heavily reduce the time spent in parse/compile. Angular apps benefit from this for example: Nolan Lawsonâ€™s â€˜Solving the Web Performance Crisisâ€™ What are browsers doing to improve Parse &amp; Compile times today?Developers are not the only ones to still be catching up on real-world start-up times being an area for improvement. V8 discovered that Octane, one of our more historical benchmarks, was a poor proxy for real-world performance on the 25 popular sites we usually test. Octane can be a poor proxy for 1) JavaScript frameworks (typically code that isnâ€™t mono/polymorphic) and 2) real-page app startup (where most code is cold). These two use-cases are pretty important for the web. That said, Octane isnâ€™t unreasonable for all kinds of workloads. The V8 team has been hard at work improving start-up time and weâ€™ve already seem some wins here: We also estimate a 25% improve on V8 parse times for many pages looking at our Octane-Codeload numbers: And weâ€™re seeing wins in this area for Pinterest too. There are a number of other explorations V8 has started over the last few years to improve Parsing and Compile times. Code caching From using V8â€™s code caching Chrome 42 introduced code caching â€” a way to store a local copy of compiled code so that when users returned to the page, steps like script fetching, parsing and compilation could all be skipped. At the time we noted that this change allowed Chrome to avoid about 40% of compilation time on future visits, but I want to provide a little more insight into this feature: Code caching triggers for scripts that are executed twice in 72 hours. For scripts of Service Worker: Code caching triggers for scripts that are executed twice in 72 hours. For scripts stored in Cache Storage via Service Worker: Code caching triggers for scripts in the first execution. So, yes. If our code is subject to caching V8 will skip parsing and compiling on the third load. We can play around with these in chrome://flags/#v8-cache-strategies-for-cache-storage to look at the difference. We can also run Chrome with â€” js-flags=profile-deserialization to see if items are being loaded from the code cache (these are presented as deserialization events in the log). One caveat with code caching is that it only caches whatâ€™s being eagerly compiled. This is generally only the top-level code thatâ€™s run once to setup global values. Function definitions are usually lazily compiled and arenâ€™t always cached. IIFEs (for users of optimize-js ;)) are also included in the V8 code cache as they are also eagerly compiled. Script Streaming Script streaming allows async or defer scripts to be parsed on a separate background thread once downloading begins and improves page loading times by up to 10%. As noted earlier, this now also works for sync scripts. Since the feature was first introduced, V8 have switched over to allowing all scripts, even parser blocking &lt;script src=â€â€&gt; to be parsed on a background thread so everyone should be seeing some wins here. The only caveat is that thereâ€™s only one streaming background thread and so it makes sense to put our large/critical scripts in here first. Itâ€™s important to measure for any potential wins here. Practically, &lt;script defer&gt; in the &lt;head&gt; so we can discover the resource early and then parse it on the background thread. Itâ€™s also possible to check with DevTools Timeline whether the correct scripts get streamed â€” if thereâ€™s one big script that dominates the parse time, it would make sense to make sure itâ€™s (usually) picked up by the streaming. Better Parsing &amp; Compiling Work is ongoing for a slimmer and faster Parser that frees up memory and is more efficient with data structures. Today, the largest cause of main thread jank for V8 is the nonlinear parsing cost. Take a snippet of UMD: (function (global, module) { â€¦ })(this, function module() { my functions }) V8 wonâ€™t know that module is definitely needed so we wonâ€™t compile it when the main script gets compiled. When we decide to compile module, we need to reparse all of the inner functions. This is what makes V8â€™s parse-times non-linear. Every function at n-th depth is parsed n times and causes jank. V8 are already working on collecting info about inner functions during the initial compile, so any future compilations can ignore their inner functions. For module-style functions, this should result in a large perf improvement. See â€˜The V8 Parser(s) â€” Design, Challenges, and Parsing JavaScript Betterâ€™ for the full story. V8 are also exploring offloading parts of JavaScript compilation to the background during startup. Precompiling JavaScript? Every few years, itâ€™s proposed engines offer a way to precompile scripts so we donâ€™t waste time parsing or compiling code pops up. The idea is if instead, a build-time or server-side tool can just generate bytecode, weâ€™d see a large win on start-up time. My opinion is shipping bytecode can increase your load-time (itâ€™s larger) and you would likely need to sign the code and process it for security. V8â€™s position is for now we think exploring avoiding reparsing internally will help see a decent enough boost that precompilation may not offer too much more, but are always open to discussing ideas that can lead to faster startup times. That said, V8 are exploring being more aggressive at compiling and code-caching scripts when you update a site in a Service Worker and we hope to see some wins with this work. We discussed precompilation at BlinkOn 7 with Facebook and Akamai and my notes can be found here. The Optimize JS lazy-parsing parens â€˜hackâ€™ JavaScript engines like V8 have a lazy parsing heuristic where they pre-parse most of the functions in our scripts before doing a complete round of parsing (e.g to check for syntax errors). This is based on the idea that most pages have JS functions that are lazily executed if at all. Pre-parsing can speed up startup times by only checking the minimal a browser needs to know about functions. This breaks down with IIFEs. Although engines try to skip pre-parsing for them, the heuristics arenâ€™t always reliable and this is where tools like optimize-js can be useful. optimize-js parses our scripts in advance, inserts parenthesis where it knows (or assumes via heuristics) functions will be immediately executed enabling faster execution. Some of the paren-hacked functions are sure bets (e.g IIFEs with !). Others are based on heuristics (e.g in a Browserify or Webpack bundle itâ€™s assumed all modules are eagerly loaded which isnâ€™t necessarily the case). Eventually, V8 hopes for such hacks to not be required but for now this is an optimization we can consider if we know what youâ€™re doing. V8 are also working on reducing the cost for cases where we guess wrong, and that should also reduce the need for the parens hack ConclusionsStart-up performance matters. Acombination of slow parse, compile and execution times can be a real bottleneck for pages that wish to boot-up quickly. Measure how long your pages spend in this phase. Discover what you can do to make it faster. Weâ€™ll keep working on improving V8 start-up performance from our end as much as we can. We promise ;) Happy perfing! Read More Planning for Performance Solving the Web Performance Crisis by Nolan Lawson JS Parse and Execution Time Measuring Javascript Parse and Load Unpacking the Black Box: Benchmarking JS Parsing and Execution on Mobile Devices (slides) When everythingâ€™s important, nothing is! The truth about traditional JavaScript benchmarks Do Browsers Parse JavaScript On Every Page Load With thanks to V8 (Toon Verwaest, Camillo Bruni, Benedikt Meurer, Marja HÃ¶lttÃ¤, Seth Thompson), Nolan Lawson (MS Edge), Malte Ubl (AMP), Tim Kadlec (Synk), Gray Norton (Chrome DX), Paul Lewis, Matt Gaunt and Rob Wormald (Angular) and for their reviews of this article. Update: Thanks to some awesome members of the community, this article is now available in Chinese and Russian too.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Hiá»ƒu rÃµ vá» Regular Expressions: RegEx khÃ´ng khÃ³ nhÆ° tÆ°á»Ÿng tÆ°á»£ng","slug":"Hieu-ro-ve-Regular-Expressions-RegEx-khong-kho-nhu-tuong-tuong","date":"2017-12-15T15:23:22.000Z","updated":"2018-09-07T13:27:14.704Z","comments":true,"path":"2017/12/Hieu-ro-ve-Regular-Expressions-RegEx-khong-kho-nhu-tuong-tuong.html","link":"","permalink":"http://nthung2112.github.io/2017/12/Hieu-ro-ve-Regular-Expressions-RegEx-khong-kho-nhu-tuong-tuong.html","excerpt":"Are you one of those people who stays away from regular expressions because it looks like a foreign language? I was one. Not anymore. Think of all those sounds, traffic signs and smells that you can recognize. Regular expressions are no different. Itâ€™s like a sign language to analyze strings. We are going to get our head around regular expressions today. At least, regularly used expressions. Much like any programming language, a regular expression is a succinct language in its own right. We will know how to put regular expressions to good use by the end of this article. We will solve simple problems and learn loads in the process. Are you willing to invest 30 minutes and come out enlightened in RegEx? Settle down then.","text":"Are you one of those people who stays away from regular expressions because it looks like a foreign language? I was one. Not anymore. Think of all those sounds, traffic signs and smells that you can recognize. Regular expressions are no different. Itâ€™s like a sign language to analyze strings. We are going to get our head around regular expressions today. At least, regularly used expressions. Much like any programming language, a regular expression is a succinct language in its own right. We will know how to put regular expressions to good use by the end of this article. We will solve simple problems and learn loads in the process. Are you willing to invest 30 minutes and come out enlightened in RegEx? Settle down then. Why regular expressions?We each have our own â€˜whyâ€™, donâ€™t we? One may be to test if the string is a valid hex color code. You may be writing a processor library such as Sass that leverages RegEx. Iâ€™ll let the universe throw the why at you and help you cover the how. 0. Get Your Playground ReadyReferencesMost of the time, I find this page adequate to get going: Regular Expressions from MDN. In fact, that page is all you need. You can stop reading this post. Right now. Close this tab. ğŸ˜‰ Still with me? Thanks. You need a sandbox to play around in. Luckily, one is available on your browser. Just use the DevTools in your browserâ€™s console. Familiarize yourself with the syntaxTo start with, we are going to use the /expression/.test(â€˜stringâ€™) syntax. An expression is any regular expression that we build. A string is the string under test. The test method returns true or false depending on the match. Slashes mark the start and end of the expression. Treat them like the double quotes (â€œ) and single quotes (â€˜) that you use to the mark start and end of a plain string. The expression between / is a literal. They are treated as literal characters. Variable names wouldnâ€™t be resolved down to their contents. To make it dynamic, weâ€™ll have to go via the constructor route, using new RegEx(variable_name) syntax. This will come to rescue towards the end of the post. Do it right now. Just type this into your browser console. 12/a/.test(\"a\"); //true/a/.test(\"b\"); //false If that works, you are ready. Donâ€™t worry about what it is. Thatâ€™s what we are going to breakdown into pieces in the following lines. Letâ€™s dive inâ€¦ 1. Start Small With LettersLetâ€™s start small. We need to find if a string has a particular character. Look for the character a in a string. Here is the expression in all its glory: 123/a/.test(\"abc\"); //true /a/.test(\"bcd\"); //false /a/.test(\"cba\"); //true The expression does what we asked for, â€œLook for a in the string under testâ€. In our case, abc and bca do have the character a. But bcd does not have it. BreakdownNow, thatâ€™s a lot of slashes and backslashes. Letâ€™s break them down. Weâ€™ve seen that /expression/ is how we build regular expressions. So no question about slash there. In fact, we can even assign it to a variable and make it look better. The same code: 1234let e=/a/; e.test(\"abc\"); //true e.test(\"bcd\"); //false e.test(\"cba\"); //true The expression between slashes is just a single character a in our case. We are looking only for that one character. Reach Multi-CharactersLetâ€™s scale the solution. What if you want to find more than one character? Put them in sequence. Treat them as a substring. Here is an example: 1234/ab/.test(\"abacus\"); //true /bac/.test(\"abacus\"); //true /abc/.test(\"abacus\"); //false /abas/.test(\"abacus\"); //false The string under test should contain the exact expression within slashes. We get a match if that condition is met. bac is within abacusbut abas is not in abacus as it is. Even though we have those characters scrambled, we do not get an exact match. Review Ground CoveredSymbol /â€¦/ . Slash (/) marks the start and end of the regular expression. Ignore the dots, thatâ€™s where we place the pattern. The /a/ character between slashes is a pattern matched on string under test. The /abc/ characters between slashes are looked up as a sub-string during the pattern matching test on string under test. 2. Patterns in NumbersLetâ€™s spice it up a bit. Letâ€™s say you want to find out if a string is full of numeric characters. Here it is: 123let e=/0|1|2|3|4|5|6|7|8|9/;e.test(\"42\"); //true e.test(\"The answer is 42\"); //true First of all, the pattern looks pretty long. But the same long streak of characters can be expressed in just two characters. I reserved it towards end of this section for a dramatic closure. The second case shouldnâ€™t be true. Weâ€™ll deal with it a bit later. For now, the pipe symbol (|) means or. Outside of regular expressions, weâ€™ve used it as a bitwise or and conditional or with double pipes (||). Thatâ€™s the same guy. I could call that easy and call it a day. But you would scream for something better, right? We are developers. We spend the best part of our day thinking about better Bash and Git aliases to save few keystrokes. Should I type in nine pipe symbols? Nah. Here we go again: 123e=/[0123456789]/; e.test(\"42\"); //true e.test(\"The answer is 42\"); //still true This is better. 9 pipes were replaced with 2 square brackets. 7 characters were saved. Thatâ€™s 77.7% less keystrokes. By the way, anything within square brackets is considered as Either this or that. It is a character set. In our case, the string should contain either 0, or 1, or 2, orâ€¦bear with me, I promised myself to write 1000 words a day, or 3 or 4 or 5. All right, letâ€™s stop. You get it. What are you saying? It still looks quite lengthy? Not satisfied? Okay, here we go once again: 1234e=/[0-9]/; e.test(42); //true e.test(\"42\"); //true e.test(\"The answer is 42\"); //true! How about that? Looks much cleaner, doesnâ€™t it? Anything within square brackets [] means or. 0-9 marks a range, meaning zero to nine. So the test looks for characters from zero to nine in the test string. As you can see, the test takes numbers too. The prefix and suffix patternsLetâ€™s now address that failing second case. The answer is 42 matches our test because our pattern looks for numeric characters somewhere within the string. Not start to end. Letâ€™s bring in ^ and $ to help us. ^ means the start of the string. He is a double agent and heâ€™ll trip us off. His second avatar is unmasked only in the last section. $ means the end of the string. Letâ€™s get the prefix pattern sorted out: 123/^a/.test(\"abc\"); //true /^a/.test(\"bca\"); //false /^http/.test(\"https://pineboat.in\"); //true /^http/.test(\"ftp://pineboat.in\"); //false Any pattern that follows ^ should be at the start of the string under test. The second string starts with b while our pattern looks for a. The fourth one looks for http while the string starts with ftp. This is the reason they fail. The suffix patternsThe suffix pattern follows. $ at the end of the pattern directs the test to look for end of string. 12/js$/.test(\"regex.js\"); //true /js$/.test(\"regex.sj\"); //false That should sound in your head like, â€œLook for js and then the end of the stringâ€. Better yet, â€œLook for a string that ends in jsâ€. Pattern match End to EndThat paves the road to pattern match start to end, you might as well call it end to end. 1234let e=/^[0-9]$/ e.test(\"42\"); //false - NO! e.test(\"The answer is 42\"); //false e.test(\"7\"); //true Surprisingly, the first one failed when we added ^ and $. /^[0-9]$/ reads like, â€œGo to the start of the string. Look for a single numeral from the character set. Check if the string ends right there.â€ Thatâ€™s the reason the last entry returned true. It is just a single number, start to end. Thatâ€™s not what we wanted. We wanted to test if the string had one or more numerals. We are very close. One last thing we need to learn is how to instruct the pattern to look for more than one character in the set. Tale of Three MusketeersA question mark (?), a plus (+) and an asterisk (*) met at a battle ground. Each is differently sighted. The humble question mark (?)says, â€œI can see none or just one.â€ Plus (+) says, â€œI need to see at least one or more.â€ Asterisk (*) says, â€œI get you both. I can see none, one, or more.â€ One of them is cleverly hiding what he is capable of. The question mark gets on stage first: 12345/a?/.test(\"\"); //true /a?/.test(\"a\"); //true /a?/.test(\"b\"); //true! /a?/.test(\"aa\"); //true /^a?$/.test(\"aa\"); //false Matches empty string â€œâ€as ? stands for 0 or 1 Matches aone match Matches b matches 0 occurrence Matches aaone match and the second a is not part of the pattern /^a?$/ does not match aa It looks for zero or one a, start to end, nothing more, nothing less The plus (+) looks at question mark and remarks, â€œIâ€™m impressed, but your focus is so binary!â€. And takes the stage to show off: 1234567/a+/.test(\"a\"); //true /a+/.test(\"aa\"); //true /a+/.test(\"ba\"); //true! /^a+$/.test(\"aa\"); //true /a+/.test(\"\"); //false /a+/.test(\"b\"); //false /^a+$/.test(\"ab\"); //false Remember what plus (+) said? It can match one or more occurrences of preceding pattern. All those returning true have one or more a. We even managed to get a whole string comprised only of a in the last one that returned true with /^a+$/. false should make sense now, but a word on the last one that returned false. /^a+$/ looks for a start to end, no other characters allowed. This is why ab failed the test. Finally, star (*) of the show gets on stage. He boasts that, â€œI can duel alone or duel you both at onceâ€ and says, â€œI can match zero, one or moreâ€. 12345678/a*/.test(\"a\"); //true /a*/.test(\"aa\"); //true /a*/.test(\"ba\"); //true /a*/.test(\"\"); //true /a*/.test(\"b\"); //true /^a*$/.test(\"aa\"); //true /^a*$/.test(\"\"); //true /^a*$/.test(\"ab\"); //false Except the last one, was able to handle all else. /^a$/ reads like, 0 or more a start to end. Which is why empty string â€œâ€ passed the test and â€œabâ€ failed. Back to the Universal AnswerRemember where were we before we met the three musketeers? Yes, â€œThe answer is 42â€. Now if we need to look for only numerals, one or more, start to end, what do we do? 12345//Let's throw in a plus let e=/^[0-9]+$/ e.test(\"4\"); //true e.test(\"42\"); //true e.test(\"The answer 42\"); //false - Hurray The plus sign (+) in [0-9]+ comes to our rescue. Plus means more than one occurrence of the character or pattern in front of it. In our case, more than one numerals. It also fails the match for our last case The answer is 42 because, there are no numerals at the start of the string. Practice Patterns Can you try to write a pattern for hexadecimal numbers (consisting of numerals 0â€“9 and letters a-f, with an optional # in front)? How about a binary number? Can you test if a string is full of just 0 and 1? That Dramatic EndOh, I almost forgot. [0-9] stands for any of the numeric character set and also has a shorthand version \\d. 1let e=/^\\d+$/; e.test(\"4\"); //true e.test(\"42\"); //true e.test(\"The answer 42\"); //false - Hurray Just two characters denoting numerals. And No, it doesnâ€™t get any shorter than that. There are a whole bunch of such special patterns to specify clusters such as numbers (\\d), alpha numeric characters (\\w), white spaces (\\s). Review [123] The expression within square brackets are a character setAny one of the characters match will pass the test. Just ONE character. [0-9]Looks for a single numeric digit between 0 to 9 [0-5]Looks for a single numeric digit between 0 to 5 [a-z]Looks for a single letter between a to z [A-F]Looks for a single letter between A to F [123]+Plus (+) looks for one or more occurrence of the characters within the set This one matches a â€œ23132â€ sub-string that consists of 1, 2 and 3 within a larger string â€œabc23132â€. | Pipe symbol stands for or \\dA shorthand for numeralsMatches a single numeric digit. \\DA shorthand for non-numeric charactersAnything other than numerals thatâ€™ll be matched by \\d 3. Recurrence Match to Find DuplicatesThis is the actual problem I was trying to solve. I dove deep into regular expressions, which eventually led to this post. Youâ€™ve been given a string. Find out if it has been infused with duplicate characters before sunset. Here is the solution for duplicate characters appearing immediately after an occurrence: 123let e=/(\\w)\\1/; e.test(\"abc\"); //false e.test(\"abb\"); //true The expression does not match any part of the string abc as there are no duplicate characters in sequence. So it returns false. But it matches bb part of the string abb and returns true. Go ahead, type that on your DevTool console. Look at this! Letâ€™s break it down to understandable pieces. Backslash \\ UnleashedIâ€™ve been a little quiet about the backslash that was introduced in the last section. To those who have been there and done that, it may not have been a surprise. They might have escaped the confusion. But if you are new to programming world, you need to know more about backslash. In the regular expression language, backslash is special. The backslash alters the meaning of the characters that follow them. Ring a bell? What do you call \\n when you encounter it in a string? Yes, a new line. Weâ€™ve got something similar here. In fact, \\n is what you use as a pattern if you want to look for a new line. Thatâ€™s called escaping the usual meaning of n and giving it a whole new attire called new line. \\d A shorthand for numeralsMatches a single numeric digit \\D A shorthand for non-numeric charactersAnything other than numerals thatâ€™ll be matched by \\d \\sShorthand for single white space character such as space, new line or tab. \\S Antonym of \\sanything other than white space \\wShorthand for alpha-numeric characterMatches a-z, A-Z, 0â€“9 and underscore _. \\WAntonym of \\w Recallable MatchesWe started this section with the solution for finding duplicate characters. /(\\w)\\1/ matched â€œabbâ€. That shows use of memory and recall within regular expressions. Consider the use of brackets in this format (expression). The resulting string that matches the expression within a bracket is remembered for later use. \\1 remembers and uses the match from first expression that is within brackets. Likewise, \\2 from second set of brackets. And so on. Letâ€™s translate our expression (\\w)\\1 to plain English: Match any alpha-numeric character on a given string. Remember it as \\1. Check if that character appears right next to the first occurrence. Extension 1 â€” Reverse PairsLetâ€™s say we want to find two characters appearing in reverse order right next to each other. That is like abba. ab is reversed as ba and is right next to each other. Here is the expression: 1234let e=/(\\w)(\\w)\\2\\1/; e.test(\"aabb\"); //false e.test(\"abba\"); //true e.test(\"abab\"); //false The first (\\w) matches a and remembers it as \\1. The second (\\w) matches b and remembers it as \\2. Then the expression expects \\2 to occur first followed by \\1. Hence, abba is the only string that matches the expression. Extension 2 â€” No duplicatesThis time, we are going to look at sequence of characters with no duplicates. No character should be followed by the same character. Plain and simple. Here, take a look at the solution: 1234let e=/^(\\w)(?!\\1)$/; e.test(\"a\"); //true e.test(\"ab\"); //false e.test(\"aa\"); //false Not the one we wanted, but close. The middle one shouldnâ€™t be false. But we threw in a few more symbols that need explaining. That means confronting the most powerful musketeer once again. Return of the Question MarkRemember the three musketeers we met earlier. The humble question mark is actually the most powerful manipulator that can get other symbols to do his bidding. That is, if you take the backslash for granted. A combination of brackets, question mark and exclamation mark (?!), is called a look ahead. A negative look ahead to be precise. a(?!b) matches a only if it is not followed by b. Across JavaScript ecosystem, the exclamation mark means not. But its cousin CSS takes a u-turn and !important means it is actually very important and should not be overridden. I almost scrolled past Chenâ€™s tweet thinking it is marked not important. I digress. On the other hand, (?=) is a positive look ahead. a(?=b) matches a only if it is followed by b. We had a solution. (\\w)(?!\\1) looks for a character without recurrence. But only for one character. We need to group it and look for 1 or more occurrences of characters with the use of plus (+). Thatâ€™s all. 123let e=/^((\\w)(?!\\1))+$/; e.test(\"madam\"); //false e.test(\"maam\"); //false But it doesnâ€™t seem to be working. If we group the pattern within plain brackets like ((\\w)(?!\\1)), the \\1 does not represent(\\w), it represents higher level bracket pair that groups the pattern. So it fails. What we need is a forgetful grouping option. Thatâ€™s where the question mark, ?, strikes back. It pairs with a colon, (?:) and wipes out any function of memory that the brackets can bring in. One last time: 123let e=/^(?:(\\w)(?!\\1))+$/; e.test(\"madam\"); //true e.test(\"maam\"); //false This time, the first level of brackets are not remembered, thanks to ?:, hence, \\1 remembers the match returned by \\w. It helps us use the plus + against the overall grouping to find similar pairs of characters start to end, which works like magic. In English, â€œLook for a character. Look ahead to ensure it is not followed by the same character. Do this from start to end for all characters.â€ Review \\w represents all the alpha-numeric charactersIf you capitalize â€˜wâ€™ and use \\Wâ€™, that would mean all characters other than alpha-numeric ( )The expression within a bracket is remembered for later use \\1 remembers and uses the match from first expression that is within brackets \\2 from second set of brackets. And so on. a(?!b)A combination of brackets, question mark and exclamation mark (?!), is called a look ahead This matches a only if it is not followed by b a(?=b) The other side of the coinMatch a only if it is followed by b. (?:a)Forgetful grouping Look for a but donâ€™t remember itYou canâ€™t use \\1 pattern to reuse this match 4. Alternating SequenceThe usecase is simple. Match a string that uses only two characters. Those two characters should alternate throughout the length of the string. Two sample tests for â€œababâ€ and â€œxyxyxâ€ will do. It wasnâ€™t easy. I got it wrong on several attempts. This answer directed me down the right street. Here is the solution: 123456let e=/^(\\S)(?!\\1)(\\S)(\\1\\2)*$/; e.test(\"abab\"); //true e.test(\"$#$#\"); //true e.test(\"#$%\"); //false e.test(\"$ $ \"); //false e.test(\"xyxyx\"); //false This is where you say, â€œIâ€™ve had enough!â€ and throw in the towel. But wait for the Aha moment! You are 3 feet away from the gold ore, not the right time to stop digging. Letâ€™s first make sense out of results before we arrive at â€˜how?â€™ abab matches. $#$# matches, this is no different from abab. #$% fails as there is a third character. $ $ fails though they are pairs, because space is excluded in our pattern. All is well except, xyxyx fails, because our pattern doesnâ€™t know how to handle that last x. Weâ€™ll get there. Letâ€™s take a look at the tools added to our belt. Itâ€™ll start to make sense soon. One piece at a timeYou already know most of the pieces. \\S is the opposite of \\s. \\S looks for non white space characters. Now comes the plain English version of /^(\\S)(?!\\1)(\\S)(\\1\\2)*$/. Start from the start /^ Look for a non-white space character (\\S) Remember it as \\1 Look ahead and see if the first character is not followed by the same character (?!\\1).Remember this is a negative look ahead. If we are good so far, look for another character (\\S) Remember it as \\2 Then look for 0 or more pairs of first two matches (\\1\\2)* Look for such pattern until end of the string $/ Apply that to our test cases. â€œababâ€ and â€œ$#$#â€ match. Tail EndAfter looking at the solution you may think this does not demand a separate section. But the simplicity of it is elegant. Letâ€™s fix that one failing case xyxyx. As weâ€™ve seen, the last trailing x is the problem. We have a solution for xyxy. All we need is a pattern to say â€œLook for an optional occurrence of first characterâ€. As usual, letâ€™s start with the solution. 1let e=/^(\\S)(?!\\1)(\\S)(\\1\\2)*\\1?$/; e.test(\"xyxyx\"); //true e.test(\"$#$#$\"); //true The question mark strikes again. There is no escaping him. Itâ€™s better we make him our ally than our enemy. A question mark ? after a character or pattern means 0 or 1 match for the preceding pattern. It is non-greedy in gobbling up characters. In our case, \\1? means, 0 or 1 match of the first character remembered through first set of brackets. Easy. Relax. Review \\SRepresents all characters excluding white space such as a space and new linesNote that it is capital S a*The asterisk or star, looks for 0 or more occurrences of the preceding character. In this case, it is 0 or more aRemember plus (+) which looks for 1 or more? Yeah, these guys are cousins. a(?!b)This combination of brackets, question mark and exclamation mark (?!) is called a look ahead.This matches a only if it is not followed by b.For example, it matches a in aa, ax, a$ but does not match ab Though it uses bracket, it does not remember the matching character after a. \\sSmall caps s matches a single white space character such as a space or new line. a(?=b)This matches a that is followed by b. ^ab*$You may think this translates to 0 or more occurrences of ab, but it matches a followed by 0 or more b For example: This matches abbb, aand ab, but does not match abab ^(ab)*$This matches 0 or more pairs of ab That means it will match empty string â€œâ€, aband abab, but not abb a?? matches 0 or 1 occurrence of preceding character or pattern\\1? matches 0 or 1 recurrence of first remembered match 5. Match an email addressWarning for ProductionRegular expressions alone may not help validate emails. Some would even argue that regular expressions should not be used as it can never match 100% of the emails. Think about all the fancy domain names popping up. Also consider inclusion of symbols within email addresses, such as dot (.) and plus (+). You need to validate email twice. Once on the client side to help users avoid misspelled addresses. Start with a semantic input tag type &lt;input type=&#39;email&#39;&gt;. Some of the browsers automatically validate it without any extra scripting on the front end. Validate it once again on the server by actually sending a confirmation email. Havenâ€™t you seen one such lately? Just try to subscribe to this pineboat. Youâ€™ll get an actual email asking you to confirm that it is yours. That confirmation is a solid proof that your email is valid. That was smooth sailing, wasnâ€™t it? RegEx for EmailNow that we added the disclaimer, youâ€™d actually want to see a pattern right? No, search for regular expression for an email address. One such result from perl module goes for more than a page. So, I am not even going to attempt it. Such long regular expressions are generated by computers through pattern builders. Not for mere mortals like us. 6. Match a Strong PasswordIf you are a coffee person, this is the right time to get a strong one. Because we are at last section of this post, but the longest one so far. It introduces very few new operators and patterns. But it reuses many patterns. As usual, we reserve the shortest optimized one for last. The ASCII range is the best part of this post. Because, I learned it while researching for this post. Now, the problem. Remember that registration form that took several attempts before you could meet their strong password requirements? Weak, good, strong, and very strong? Yeah, we are going to build that validation. The password should: have a minimum of 4 characters contain lowercase contain uppercase contain a number contain a symbol This is a tricky one. Once you start consuming letters, you canâ€™t come back to check if they meet any other condition.There in lies our clue. We canâ€™t look back, but we can look ahead! Length of the stringLetâ€™s first test if the string password is 4 characters long. Pretty simple. Use .length on the password string. Done, right? No, who needs a simple solution? Letâ€™s spice it up. 123456789//expression with just lookahead//wouldn't consume any charactere1=/^(?=.&#123;4,&#125;)$/; e1.test(\"abc\") //falsee1.test(\"abcd\") //false //after lookahead, //pattern to consume character is needed.e2=/^(?=.&#123;4,&#125;).*$/; e2.test(\"abc\") //false e2.test(\"abcd\") //true You may remember (?=) from our previous work on â€œno duplicatesâ€ Thatâ€™s a look ahead useIt does not consume any character The dot (.) is an interesting characterIt means, any character. {4,}Stands for at least 4 preceding characters with no maximum limit \\d{4}Would look for exactly 4 numerals \\w{4,20}Would look for 4 to 20 alpha-numeric characters Letâ€™s translate /^(?=.{4,})$/. â€œStart from the beginning of the string. Look ahead for at least 4 characters. Donâ€™t remember the match. Come back to the beginning and check if the string ends there.â€ Doesnâ€™t sound right. Does it? At least the last bit. Which is why we brought in the variation /^(?=.{4,}).$/. An extra dot and a star. It reads like this, â€œStart from the beginning. Look ahead for 4 characters. Donâ€™t remember the match. Come back to the beginning. Consume all the characters using . and see if you reach the end of the string.â€ This makes sense now. Doesnâ€™t it? Which is why abc fails and abcd passes the pattern. At least One NumberThis is going to be easy. 123456e=/^(?=.*\\d+).*$/ e.test(\"\"); //false e.test(\"a\"); //false e.test(\"8\"); //true e.test(\"a8b\"); //true e.test(\"ab890\"); //true Start from the beginning of the string /^. Look ahead for 0 or more characters ?=.. Check if 1 or more numbers follow \\d+. Once it matches, come back to the beginning (because we were in look ahead). Consume all the characters in the string until end of the string .$/. At Least One Lowercase LetterThis one follows the same patter as above. 1234e=/^(?=.*[a-z]+).*$/; e.test(\"\"); //false e.test(\"A\"); //false e.test(\"a\"); //true Translation? Sure. â€œStart from theâ€¦ okay.â€ Instead of \\d+, we have [a-z]+ which is a character set of letters from a to z. At least One Uppercase LetterLetâ€™s not overkill. [A-Z] instead of [a-z] from the previous section will do. At least One SymbolThis is going to be challenging. One way to match symbols is to place a list of symbols in a character set. /^(?=.[-+=_)(\\&amp;\\^%\\$#@!~â€â€™:;|}]{[/?.&gt;,&lt;]+).*$/.test(â€œ$â€) Thatâ€™s all the symbols in a character set. Properly escaped where necessary. Itâ€™ll take months for me to write it in plain English. So to save all of us from eternal pain, here is a simple one: 1234567891011121314//considers space as symbol let e1; e1=/^(?=.*[^a-zA-Z0-9])[ -~]+$/ e1.test(\"_\"); //true e1.test(\" \"); //true //does not take space let e2; e2=/^(?=.*[^a-zA-Z0-9])[!-~]+$/ e2.test(\" \"); //false e2.test(\"_\"); //true //the underscore exception let e3; e3=/^(?=.*[\\W])[!-~]+$/ e3.test(\"_\"); //false Wait, whatâ€™s that ^ coming again from the middle of no where? If you have reached this far, this is where you realize that unassuming innocent ^ that marks start of a string is a double agent. Which means, the end is not too far. He has been exposed. Within a character set, ^ negates the character set. That is, [^a-z] means, any character other than a to z. [^a-zA-Z0-9] then stands for any character other than lower case alphabets, upper case alphabets, and numerals. We could have used \\W instead of the long character set. But \\W stands for all alpha-numeric characters including underscore _. As you can see in the third set of examples above, that will not accept underscore as a valid symbol. CharSet RangeThe curious case of [!-~]. They stand next to each other in the keyboard, but their ASCII values are diagonally opposite. Remember a-z? A-Z? 0â€“9? These are not constants. They are actually based on the ASCII range of their values. The ASCII table has 125 characters. zero (0) to 31 are not relevant to us. Space starts from 32 going all the way up to 126 which is tilda(~). The exclamation mark is 33. So [!-~] covers all the symbols, letters and numbers we need. The seed for this idea came from another solution to the symbol problem. Assemble the TroopsBringing it all together, we get this nice looking piece of regular expression /^(?=.{5,})(?=.[a-z]+)(?=.\\d+)(?=.[A-Z]+)(?=.[^\\w])[ -~]+$/. Thatâ€™s starting to haunt and intimidate us. Though weâ€™ve been studying them individually. This is where the syntax for dynamically building expression object comes in handy. We are going to build each piece separately and assemble them later. 123456789101112131415161718192021222324252627282930313233//start with prefix let p = \"^\"; //look ahead // min 4 chars p += \"(?=.&#123;4,&#125;)\"; // lower case p += \"(?=.*[a-z]+)\"; // upper case p += \"(?=.*[A-Z]+)\"; // numbers p += \"(?=.*\\\\d+)\"; // symbols p += \"(?=.*[^ a-zA-Z0-9]+)\"; //end of lookaheads //final consumption p += \"[ -~]+\"; //suffix p += \"$\"; //Construct RegEx let e = new RegEx(p); // tests e.test(\"aB0#\"); //true e.test(\"\"); //false e.test(\"aB0\"); //false e.test(\"ab0#\"); //false e.test(\"AB0#\"); //false e.test(\"aB00\"); //false e.test(\"aB!!\"); //false // space is in our control e.test(\"aB 0\"); //false e.test(\"aB 0!\"); //true If your eyes are not tired yet, youâ€™d have noticed two strange syntax in the above code. One, we didnâ€™t use /^, instead we used just ^. We didnâ€™t use $/ to end the expression either, instead just $.The reason is that the RegEx constructor automatically adds starting and trailing slashes for us. Two, to match numbers we used \\d instead of the usual \\d. This is because the variable p is just a normal string within double quotes. To insert a backslash, you need to escape the backslash itself.\\d resolves to \\d within the RegEx constructor Apparently, there should be server side validations for passwords too. Think about SQL injection vulnerabilities if your framework or language doesnâ€™t handle it already. 7. ConclusionThat brings us to the end of the story. But this is the beginning of a journey. We just scratched the pattern matching portion of RegEx with test method. exec method builds on this foundation to return matched sub-strings based on pattern. String object has methods such as match, search, replace, and split that widely uses regular expressions. Hope this sets you off to explore those capabilities further with a solid understanding on composing patterns for RegEx. 8. Call To ActionNo, after all this difficulty weâ€™ve been through, I am not going to ask you to subscribe. Just make good software. If any code blocks presented here do not work, leave a comment on this github issue I created specially for this post. Hope it was useful! Share it if others would benefit. Youâ€™ve been wonderful. Appreciate your time. This content is far long by recent standards. Thanks for reading. Originally published at www.pineboat.in.","categories":[],"tags":[{"name":"regex","slug":"regex","permalink":"http://nthung2112.github.io/tags/regex/"}]},{"title":"React, Inline Functions, and Performance","slug":"React-Inline-Functions-and-Performance","date":"2017-12-08T07:43:28.000Z","updated":"2017-12-12T15:03:58.752Z","comments":true,"path":"2017/12/React-Inline-Functions-and-Performance.html","link":"","permalink":"http://nthung2112.github.io/2017/12/React-Inline-Functions-and-Performance.html","excerpt":"My wife and I just got through a huge remodel. We were beyond excited to show people the new digs. We showed my mother-in-law. She walked in the beautifully remodeled bedroom, looked up at the fantastically framed window and said: â€œNo blinds?â€ ğŸ˜ Our new bedroom; holy crap it looks like a magazine picture. Also, no blinds. I find myself with the same emotion when Iâ€™m talking about React. Iâ€™ll be getting through the first lecture of a workshop, showing off some cool new OSS, and invariably somebody says: â€œinline functions? I heard those are slow.â€","text":"My wife and I just got through a huge remodel. We were beyond excited to show people the new digs. We showed my mother-in-law. She walked in the beautifully remodeled bedroom, looked up at the fantastically framed window and said: â€œNo blinds?â€ ğŸ˜ Our new bedroom; holy crap it looks like a magazine picture. Also, no blinds. I find myself with the same emotion when Iâ€™m talking about React. Iâ€™ll be getting through the first lecture of a workshop, showing off some cool new OSS, and invariably somebody says: â€œinline functions? I heard those are slow.â€It wasnâ€™t always this way. But the last few months it comes up literally every day. As an instructor and library author, it gets exhausting. Unfortunately, Iâ€™m a dummy and I rant on twitter instead of writing something that might be insightful to others. So, this is my attempt at the better option ğŸ˜‚. What is an â€œinline functionâ€In the context of React, an inline function is a function that is defined while React is â€œrenderingâ€. There are two meanings of â€œrenderâ€ in React that people often get confused about: (1) getting the React elements from your components (calling your componentâ€™s render method) during an update and (2) actually rendering updates to the DOM. When I refer to â€œrenderingâ€ in this article, Iâ€™m talking about #1. Here are a few examples of inline functions: Premature optimization is the root of all evilBefore we go any further, we need to talk about how to optimize a program. Ask any performance expert and they will tell you not to prematurely optimize your program. All of them. Yes, every single one of them. 100% of people with deep performance experience will tell you not to prematurely optimize your code. If you arenâ€™t measuring, you canâ€™t even know if your optimizations are better, and you certainly wonâ€™t know if they make things worse! I remember a talk my friend Ralph Holzmann gave about how gzip works that really solidified this idea for me. He talks about an experiment he did with LABjs, an old script loading library. You can watch from 30:02 to about 32:35 in this video to hear about it, or just keep reading. At the time, the source for LABjs did something a little awkward for performance. Instead of using normal object notation (obj.foo) it stored the keys in strings and used bracket notation to access the objects (obj[stringForFoo]). The idea was that after minifying and gzipping, the unnaturally written code would be smaller than the naturally written code. You can see it here. Ralph forked the code and removed the optimizations by writing the code naturally, without thinking about how to optimize for minification and gzip. Turns out, removing the â€œoptimizationsâ€ shaved off 5.3% of the file size! If you arenâ€™t measuring, you canâ€™t even know if your optimizations are better, and you certainly wonâ€™t know if they make things worse! Not only can premature optimization explode development time while hurting code cleanliness, it can even backfire and cause performance problems as it did for LABjs. Had the author been measuring, rather than just imagining performance issues, he would have saved development time, had cleaner code, and better performance. Donâ€™t prematurely optimize. Alright, back to React. Why do people say inline functions are slow?Two reasons: Memory/garbage collection concerns, and shouldComponentUpdate. Memory and garbage collectionFirst, folks (and eslint configs) are concerned about memory and garbage collection costs around creating inline functions. This mostly spilled over from the days before arrow functions became ubiquitous. Lots of code would call bind inline, which has historically had poor performance. For example: Performance issues with Function.prototype.bind got fixed here and arrow functions are either a native thing or are transpiled by babel to plain functions; in both cases we can assume itâ€™s not slow. Remember, you donâ€™t sit back and imagine â€œI bet that code is slowâ€. You write your code naturally, then you measure it. If there are performance problems, fix them. We donâ€™t need to prove an inline arrow function is fast, somebody else needs to prove itâ€™s slow. Otherwise itâ€™s a premature optimization. As far as Iâ€™ve seen, nobody has presented an analysis of their app that indicates inline arrow functions are slow. Until then, itâ€™s not even worth talking about â€” but Iâ€™ll offer one more thought anyway ğŸ˜ If the cost of creating an inline function is high enough to warrant an eslint rule against it, why would we want to move that expense to the hot path of initialization? By prematurely optimizing weâ€™ve slowed down the initialization of the component by 3x! If all the handlers were inline, the initial render would only have to create one function. Instead, weâ€™ve created three. We havenâ€™t measured anything though, so we have no reason to believe any of this is a problem. If you want to completely miss the point, go make an eslint rule that requires inline functions everywhere to speed up the initial render ğŸ¤¦ğŸ¾â€â™€ï¸. PureComponent and shouldComponentUpdateThis is where the real meat of the problem lives. You can see real performance improvements by understanding two things: shouldComponentUpdate and JavaScript strict equality comparisons. If you donâ€™t understand them well, you can inadvertently make your React code harder to work with in the name of performance. When you call setState, React will compare the old React elements to a new set of React elements (this is called r_econciliation_, you can read about it here) and then use that information to update the real DOM elements. Sometimes that can get slow if youâ€™ve got a lot of elements to check (like a big SVG). In these cases, React provides an escape hatch called shouldComponentUpdate. If your component has shouldComponentUpdate defined, before React compares the old and new elements, it will ask shouldComponentUpdate if anything changed. If it returns false, then React will completely skip the element diff, saving some time. If your component is large enough, this can have considerable impact on performance. The most common way to optimize a component is to extend React.PureComponent instead of React.Component. A PureComponent will diff your props and state in shouldComponentUpdate so you donâ€™t have to. 1class Avatar extends React.PureComponent &#123; ... &#125; Avatar will now use a â€œstrict equality comparisonâ€ on its props and state when being asked to update, hopefully speeding things up. Strict Equality ComparisonThere are six primitive types in JavaScript: string, number, boolean, null, undefined, and symbol. When you do a â€œstrict equality comparisonâ€ on two primitives that hold the same value, youâ€™ll get true. For example: 123const one = 1const uno = 1one === uno // true When PureComponent diffs props it uses a strict equality comparison. This works out great for inlined primitive values: . The prop diffing problem arises because of non-primitive types â€” err, excuse me, type. There is only one other type and thatâ€™s Object. What about functions and arrays you say? Well, actually those are just objects. Functions are regular objects with the additional capability of being callable. https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures LOL, okay JavaScript. So anyway, strict equality checks on objects, even with seemingly similar values, will evaluate to false: So, if you inline an object in your JSX, it will fail the PureComponent prop diff and move on to diffing the more expensive React elements. The element diff will come up empty and now weâ€™ve wasted time on both diffs. Since functions are objects and PureComponent does a strict equality check on props, an inline function will always fail the prop diff and move on to the element diff in the reconciler. You can see this isnâ€™t just about inline functions. The function is simply the lead singer of the object, function, array three-piece performance postulation proliferation. In order to make shouldComponentUpdate happy, you have to keep referential identity of the function. For experienced JavaScript developers, itâ€™s not too bad. But, Michael and I have led workshops with over 3,500 people at varying levels of experience and it ainâ€™t easy for a lot of folks. ES classes donâ€™t offer any help either, leading us down all sorts of JavaScript paths: Learning how to keep referential identity of a function leads to surprisingly long conversations. Thereâ€™s usually no reason why weâ€™re forcing people to do this other than an eslint config yelled at them. Iâ€™d like to show that you can have inline functions and performance optimizations both at the same time. But first, I have a personal performance story. My own experience with PureComponentWhen I first learned about PureRenderMixin (the thing from earlier versions of React that later became PureComponent) I put in a bunch of measurements and measured my appâ€™s performance. I then added PureRenderMixin to every single component. When I took the optimized set of measurements I was hoping to have a cool story to tell about how much faster everything got. Much to my surprise, my app got slower ğŸ¤”. Why? Well, think about it. If you have a Component how many diffs are there? If you have a PureComponent how many diffs are there? The answers are â€œjust oneâ€ and â€œat least one and sometimes twoâ€, respectively. If a component usually changes when thereâ€™s an update, then a PureComponent will be doing two diffs instead of just one (props and state in shouldComponentUpdate, and then the normal element diff). Which means itâ€™s going to be slower usually but faster occasionally. Apparently, most of my components changed most of the time, so on the whole, my app got slower. Oops. There are no silver bullets when it comes to performance. You have to measure. The three scenariosAt the start of the article I showed three types of inline functions. Now that we have some background, letâ€™s talk about each one them. But please remember to keep PureComponent on the shelf until you have a measurement to justify it. DOM component event handler123&lt;button onClick=&#123;() =&gt; this.setState(â€¦)&#125;&gt;click&lt;/button&gt; Itâ€™s common to do nothing more than setState inside of event handlers for buttons, inputs, and other DOM components. This often makes an inline function the cleanest approach. Instead of bouncing around the file to find the event handlers, theyâ€™re colocated. The React community generally welcomes colocation. The button component (and every other DOM component) canâ€™t even be a PureComponent, so there are no shouldComponentUpdate referential identity concerns here. So, the only reason to think this is slow is if you think simply defining a function is a big enough expense to worry about. Weâ€™ve discussed that there is no evidence anywhere that it is. Itâ€™s simply armchair performance postulation. These are fine until proven otherwise. A â€œcustom eventâ€ or â€œactionâ€123&lt;Sidebar onToggle=&#123;(isOpen) =&gt; &#123; this.setState(&#123; sidebarIsOpen: isOpen &#125;)&#125;&#125;/&gt; If Sidebar is a PureComponent we will be breaking the prop diff. Again, since the handler is simple, the colocation can be preferable. With an event like onToggle, why is Sidebar even diffing it? There are only two reasons to include a prop in the shouldComponentUpdate diff: You use the prop to render. You use the prop to perform a side-effect in componentWillReceiveProps, componentDidUpdate, or componentWillUpdate. Most on props do not meet either of these requirements. Therefore, most PureComponent usages are over-diffing, forcing developers to maintain referential identity of the handler needlessly. We should only diff the props that matter. That way people can colocate handlers and still get the performance gains youâ€™re seeking (and since weâ€™re concerned about performance, weâ€™re diffing less!). For most components, Iâ€™d recommend creating a PureComponentMinusHandlers class and inherit from that instead of inheriting from PureComponent. It could just skip all checks on functions. Have your cake and eat it too. Well, almost. If you receive a function and pass that function directly into another component, itâ€™ll get stale. Check this out: Hereâ€™s a codesandbox running that app. So, if you like the idea of inheriting from a PureRenderWithoutHandlers, make sure you donâ€™t ever pass your ignored handlers directly to other components â€” you need to wrap them one way or another. Now we either have to maintain referential identity, or we have to avoid referential identity! Welcome to performance optimization. At least with this approach itâ€™s the optimized component that has to deal with it, not the code using it. Iâ€™m going to be candid, that example app is an edit I made after publishing that Andrew Clark brought to my attention. And here you thought I was smart enough to know when to manage referential identity and when not to! ğŸ˜‚ A render prop Render props are a pattern used to create a component that exists to compose and manage shared state. (You can read more about them here.) The contents of the render prop are unknowable to the component. For example: That means an inline render prop function wonâ€™t cause problems with shouldComponentUpdate: It canâ€™t ever know enough to be a PureComponent. So, the only other objection is back to believing that simply defining functions is slow. Repeating from the first example: thereâ€™s no evidence to support that. Itâ€™s simply armchair performance postulation. In summary Write your code naturally, code to the design. Measure your interactions to find slow paths. Hereâ€™s how. Use PureComponent and shouldComponentUpdate only when you need to, skipping prop functions (unless they are used in lifecycle hooks for side-effects).","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"Cáº£i thiá»‡n tá»‘c Ä‘á»™ Web App vá»›i Pinterest ","slug":"Cai-thien-toc-do-Web-App-voi-Pinterest","date":"2017-12-08T06:57:03.000Z","updated":"2017-12-12T15:03:58.744Z","comments":true,"path":"2017/12/Cai-thien-toc-do-Web-App-voi-Pinterest.html","link":"","permalink":"http://nthung2112.github.io/2017/12/Cai-thien-toc-do-Web-App-voi-Pinterest.html","excerpt":"Pinterestâ€™s new mobile web experience is a Progressive Web App. In this post weâ€™ll cover some of their work to load fast on mobile hardware by keeping JavaScript bundles lean and adopting Service Workers for network resilience. Login to https://pinterest.com on your phone to experience their new mobile site","text":"Pinterestâ€™s new mobile web experience is a Progressive Web App. In this post weâ€™ll cover some of their work to load fast on mobile hardware by keeping JavaScript bundles lean and adopting Service Workers for network resilience. Login to https://pinterest.com on your phone to experience their new mobile site Why a Progressive Web App (PWA)? Some history.The Pinterest PWA started because they were focused on international growth, which led them to the mobile web. After analyzing usage for unauthenticated mobile web users, they realized that their old, slow web experience only managed to convert 1% of users into sign-ups, logins or native app installs. The opportunity to improve this conversation rate was huge, leading them to an investment in the PWA. Building and shipping a PWA in a quarter Over 3 months, Pinterest rebuilt their mobile web experience using React, Redux and webpack. Their mobile web rewrite led to several positive improvements in core business metrics. Time spent is up by 40% compared to the old mobile web experience, user-generated ad revenue is up 44% and core engagements are up 60%: Their mobile web rewrite also led to several improvements in performance. Loading fast on average mobile hardware over 3GPinterestâ€™s old mobile web experience was a monolith â€” it included large bundles of CPU-heavy JavaScript that pushed out how quickly Pin pages could load and get interactive. Users often had to wait 23 seconds before any UI was usable at all: Pinterestâ€™s old mobile web site took 23 seconds to get interactive. They would send down over 2.5MB of JavaScript (~1.5MB for the main bundle, 1MB lazily loaded in) taking multiple seconds to get parsed and compiled before the main thread finally settled down enough to be interactive. Their new mobile web experience is a drastic improvement. Not only did they break-up &amp; shave hundreds of KB off their JavaScript, taking down the size of their core bundle from 650KB to 150KB but they also improved on key performance metrics. First Meaningful Paint was down from 4.2s to 1.8s and Time To Interactive reduced from 23s to 5.6s. This is on average Android hardware over a slow 3G network connection. On repeat visits, the situation was even better. Thanks to Service Worker caching of their main JavaScript, CSS and static UI assets they were able to bring down time to interactive on repeat visits all the way down to 3.9s: Although Pinterest vend iOS &amp; Android apps, they were able to deliver the same core home feed experience these apps do on the web in a fraction of the upfront download cost â€” just ~150KB minified &amp; gzipped. This contrasts with the 9.6MB required to deliver this experience for Android and 56MB for iOS: Itâ€™s important to note that this isnâ€™t comparing apples to apples, however. The PWA loads code for new routes on demand, and the cost of additional code is amortized over the lifetime of the application. Subsequent navigations still donâ€™t cost as much data as the download of the app. Pinterestâ€™s Progressive Web App in Firefox, Edge and Safari on mobile. Route-based JavaScript chunkingGetting a web page to load and get interactive quickly benefits from only loading the code a user needs upfront. This reduces network transmission &amp; JavaScript parse/compile times. Non-critical resources can then be lazily loaded as needed. Pinterest started breaking up their multi-megabyte JavaScript bundles by splitting them into three different categories of webpack chunks that worked quite well: a vendor chunk which contained external dependencies (react, redux, react-router, etc) ~ 73KB an entry chunk which contained a majority of the code required to render the app (i.e. common libs, the main shell of the page, our redux store) ~ 72KB async route chunks which contained code pertaining to individual routes ~13â€“18KB A Network waterfall for the experience highlights how a shift to progressively delivering code as needed avoids the need for monolithic bundles: For long-term caching, Pinterest also use a chunk-specific hash substitution for each filename. Pinterest uses webpackâ€™s CommonsChunkPlugin to break out their vendor bundles into their own cacheable chunk: They also used React Router for adding code-splitting to the experience: Use babel-preset-env to only transpile what target browsers needPinterest use Babelâ€™s babel-preset-env to only transpile ES2015+ features unsupported by the modern browsers they target. Pinterest targets the last two versions of modern browsers, and their .babelrc setup looks a little like: There are further optimizations they can do to only conditionally serve polyfills as needed (e.g the Internationalization API for Safari) but this is planned for the future. Analyzing room for improvement with Webpack Bundle Analyzer Webpack Bundle Analyzer is an excellent tool for really understanding what dependencies youâ€™re sending down to your users in JavaScript bundles. Below, youâ€™ll see a lot of purple, pink and blue blocks in its output for an earlier build of Pinterest. These are async chunks for routes being lazily loaded in. Webpack Bundle Analyzer allowed Pinterest to visualize that most of these chunks contained duplicate code: Webpack Bundle Analyzer helped visualize the size ratio of this problem between all their chunks. Using the information about duplicate code in chunks, Pinterest were able to make a call. They moved duplicate code in async chunks to their main chunk. It increased the size of the entry chunk by 20% but decreased the size of all lazily loaded chunks by up to 90%! Image OptimizationMost of the lazy-loading of content in the Pinterest PWA is handled by an infinite Masonry grid. It has built-in support for virtualization and only mounting children that are in the viewport. Pinterest also uses a progressive loading technique for images in their PWA. A placeholder with the dominant color is initially used for each Pin. Pin images are served as Progressive JPEGs, which improve image quality with each scan: React performance pain-pointsPinterest ran into some rendering performance issues with React as part of their use of this Masonry grid. Mounting and unmounting large trees of components (like Pins) can be slow. Thereâ€™s a lot that goes into a Pin: Although at the time of writing Pinterest are using React 15.5.4, their hope is that React 16 (Fiber) will help a lot with reducing time spent unmounting. In the mean time, Virtualizing the grid helped significantly with component unmount time. Pinterest also throttle insertion of Pins so that they can measure/render the first Pins quicker, but means thereâ€™s more overall work for the deviceâ€™s CPU. Navigation TransitionsTo improve perceived performance, Pinterest also update the selected state of navigation bar icons independent of the route. This enables navigations from one route to another to not feel slow due to blocking on the network. The user gets visual UI painted quickly while weâ€™re waiting for the data to arrive: Experience using ReduxPinterest use normalizr (which normalizes nested JSON according to a schema) for all of their API data. This is viewable from the Redux DevTools: The downside to this process is that denormalization is slow so they ended up heavily relying on reselectâ€™s selector pattern for memoizing denormalization during renders. They also always denormalize at the lowest level possible to ensure individual updates donâ€™t cause large re-renders. As an example, their grid item lists are just Pin IDs with the Pin component denormalizing itself. If there are changes to any given Pin, the full grid does not have to re-render. The trade-off is that there are a lot of Redux subscribers in the Pinterest PWA, though this hasnâ€™t resulted in noticeable perf issues. Caching assets with Service WorkersPinterest use the Workbox libraries for generating and managing their Service Workers: Today, Pinterest cache any JavaScript or CSS bundles using a cache-first strategy and also cache their user-interface (the application shell). In a cache-first setup, if a request matches a cache entry, respond with that. Otherwise try to fetch the resource from the network. If the network request succeeds, update the cache. To learn more about caching strategies with Service Worker, read Jake Archibaldâ€™s Offline Cookbook. They define a precache for the initial bundles loaded by the application shell (webpackâ€™s runtime, vendor and entryChunks) too. As Pinterest is a site with a global presence, supporting multiple languages, they also generate a per-locale Service Worker configuration so they can precache locale bundles. Pinterest also use webpackâ€™s named chunks to precache top-level async route bundles. This work was rolled out in several smaller, iterative steps. 1st: Pinterestâ€™s Service Worker only did runtime caching of scripts lazy-loaded on demand. This was to take advantage of V8â€™s code caching, helping skip some of the parse/compile cost on repeat views so they can load quicker. Scripts served from Cache Storage where a Service Worker is present can eagerly opt into code caching as thereâ€™s a good chance the browser knows the user will end up using these resources on repeat views. After this, Pinterest progressed to pre-caching their vendor and entry chunks. Next, Pinterest started precaching a few of the most used routes (like the home page, pin page, search page etc). Finally, they started generating a Service Worker for each locale so that they could also cache the locale bundle. This was important for not just repeat load performance, but also enabling basic offline rendering for most of their audience: Application Shell challengesPinterest found implementing their application shell a little tricky. Because of desktop-era assumptions about how much data could be sent down over a cable connection, initial payloads were large containing a lot of non-critical info, like userâ€™s experiment groups, user info, contextual information etc. They had to ask themselves: â€œdo we cache this stuff in the application shell? or take the perf hit of making a blocking network request before rendering anything to fetch it at allâ€. They decided to cache it in the application shell, which required some management of when to invalidate the app shell (logout, user information updates from settings etc). Each request response has an appVersion â€” if the app version changes, they unregister the Service Worker, register the new one then on the next route change they do a full page reload. Adding this information to the application shell is a little trickier, but worth avoiding the render blocking request for. Auditing with LighthousePinterest used Lighthouse for one-off validations that their performance improvements were on the right track. It was useful for keeping an eye on metrics such as Time to Consistently Interactive. Next year they hope to use Lighthouse as a regression mechanism to verify that page loads remain fast. The FuturePinterest just deployed support for Web Push notifications and have also been working on the unauthenticated (logged-out) experience for their PWA. They are interested in exploring support for to preload critical bundles &amp; reducing the amount of unused JavaScript delivered to users on first load. Stay tuned for more awesome perf work in the future!","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"22 React projects open source","slug":"22-React-projects-open-source","date":"2017-12-08T06:37:30.000Z","updated":"2017-12-12T15:03:58.737Z","comments":true,"path":"2017/12/22-React-projects-open-source.html","link":"","permalink":"http://nthung2112.github.io/2017/12/22-React-projects-open-source.html","excerpt":"This is a collection of open source apps built with React.JS library. In this observation, we compared nearly 1,000 popular React projects to pick the top 22. (React Native: 11, React: 11) React is an open source JavaScript library built by Facebook, providing a view for data rendered as HTML. To evaluate the quality, Mybridge AI considers a variety of factors to determine how useful the projects are for programmers. To give you an idea on the quality, the average number of Github stars from the 22 projects was 3,584. Open source projects can be useful both for beginners to learn from reading the code and for advanced programmers to save time by using the existing code. The aim of this collection is to help you pick a great project right away without having to spend hours of searching.","text":"This is a collection of open source apps built with React.JS library. In this observation, we compared nearly 1,000 popular React projects to pick the top 22. (React Native: 11, React: 11) React is an open source JavaScript library built by Facebook, providing a view for data rendered as HTML. To evaluate the quality, Mybridge AI considers a variety of factors to determine how useful the projects are for programmers. To give you an idea on the quality, the average number of Github stars from the 22 projects was 3,584. Open source projects can be useful both for beginners to learn from reading the code and for advanced programmers to save time by using the existing code. The aim of this collection is to help you pick a great project right away without having to spend hours of searching. Note that React UI components, boilerplates, tools and frameworks are separated out to make this curation more specific to full-working apps built with React. No 1) Redux The Complete React Web Course (2nd Edition): Build apps using Redux, Webpack, React-Router [10,556 recommends, 4.8/5 stars] No 2) React Native The Complete React Native and Redux Course: Build iOS and Android App fast from scratch. [46,695 recommends, 4.6/5 stars] No 3) Beginner React for Beginners. By Wes Bos [14,955 recommends] React native iOS and Android apps that give attendees a schedule for the F8 conference. Courtesy of Alex Kotlyarskiy [11,081 Stars] Hacker News iOS and Android App: Made with React Native. Courtesy of Simar Singh [3,224 Stars] Dribbble app built with React Native. Courtesy of Catalin MIRON [1,778 Stars] Ready-to-use chat interface for iOS and Android React-Native apps. Courtesy of Farid from Safi [4,006 Stars] iOSâ€™s Stocks App clone: Written in React Native available both iOS and Android. Courtesy of kf [1,352 Stars] A Zhihu Daily App client implemented using React Native (Android and iOS). Courtesy of Race604 [3,521 Stars] A Camera app for React Native (also supports barcode scanning). Courtesy of @CharlieHawker [4,248 Stars] Github client written with react-native. Courtesy of David Tse [1,635 Stars] iOS and Android NBA App built with React Native. Courtesy of WangZixiao [1,715 Stars] React Native Reddit Reader. Courtesy of Andrei Hrabouski [323 Stars] FB Basketball game clone built in React.JS Native. Courtesy of Farid from Safi [344 Stars] A Soundcloud client built with React / Redux. Courtesy of Andrew Nguyen [3,888 Stars] Calculator built with React (Website), Electron (Desktop), and React Native (iOS &amp; Android). Courtesy of Benoit VALLON [4,080 Stars] React-color: Color Pickers from Sketch, Photoshop, Chrome &amp; more. Courtesy of Case Sandberg [4,460 Stars] Gatsby: Transform plain text into dynamic blogs and websites using React.js. Courtesy of kylemathews [15,427 Stars] Sentry is cross-platform crash reporting built with React. Courtesy of Armin Ronacher [14,749 Stars] Isomorphic500: A web application featuring photos from 500px, built on express using React and Flux with yahoo/fluxible. Courtesy of gp [1,311 Stars] A React &amp; react-router-powered implementation of Hacker News using its Firebase API. Courtesy of Arthur Stolyar [1,765 Stars] A playground for in-browser interpreters. Built with React/Redux. Courtesy of Mican [659 Stars] Perseus: Khan Academyâ€™s new exercise question editor and renderer built with React [756 Stars] React-based Imgur-like isomorphic demo app. Courtesy of Brandon Tilley [86 Stars] Flatris: Tetris app for Cosmos, built with React. Courtesy of Ovidiu CherecheÈ™ [304 Stars] Thatâ€™s it for Amazing React Projects. If you like this curation, read best daily articles based on your programming skills on our website Recommend &amp; share..","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"React Component Patterns","slug":"React-Component-Patterns","date":"2017-11-28T03:53:16.000Z","updated":"2017-11-30T14:56:01.140Z","comments":true,"path":"2017/11/React-Component-Patterns.html","link":"","permalink":"http://nthung2112.github.io/2017/11/React-Component-Patterns.html","excerpt":"Stateful x Stateless, Container x Presentational, HOCs, Render Callbacks and moreItâ€™s been a while since Iâ€™ve been working with React â€” a Facebook library to build user interfaces using JavaScript â€” and there are a few concepts I wish I knew when I was just starting. This text is an attempt to summarize some patterns I learned during my experience so far â€” and also may be useful for developers who are just about to enter this awesome component-based world.","text":"Stateful x Stateless, Container x Presentational, HOCs, Render Callbacks and moreItâ€™s been a while since Iâ€™ve been working with React â€” a Facebook library to build user interfaces using JavaScript â€” and there are a few concepts I wish I knew when I was just starting. This text is an attempt to summarize some patterns I learned during my experience so far â€” and also may be useful for developers who are just about to enter this awesome component-based world. Stateful x Stateless ComponentsJust as Stateful and Stateless web services, React components can also hold and manipulate state during application usage (Stateful) â€” or just be a simple component that takes the input props and returns what to display (Stateless). A simple Stateless button component that depends on props only: And a Stateful counter component example (using Button component): As you can see, the last oneâ€™s constructor holds a component state, while the first one is a simple component that renders a text via props. This separation of concerns may look simple but makes Button component highly reusable. Container x Presentational ComponentsWhen working with external data, we can divide components into this two new categories. Containers are responsible to reach data that lives outside React scope, like connecting to Redux or Relay â€” while Presentational components are free of dependencies from the rest of the app, depending only on its own state or props received. Letâ€™s take a users list as a Presentational component example: This list can be updated using our Container component: This approach divides data-fetching from rendering and also makes UserListreusable. If you want to learn more about this pattern, thereâ€™s an awesome article from Dan Abramov explaining it precisely. Higher-Order ComponentsHigher-Order Components â€” or just HOCs_ â€” _are useful when you want to reuse a component logic. They are JavaScript functions that take a component as an argument and returns a new component. Letâ€™s say you need to build an expandable menu component that shows some children content when user clicks on it. So, instead of controlling the state on its parent component, you can simply create a generic HOC to handle it: This approach allows us to apply our logic to our ToggleableMenu component using the JavaScript decorator syntax: Now we can pass any children to ToggleableMenu component: If youâ€™re familiar with Reduxâ€™s connect or React Routerâ€™s withRouter functions, youâ€™re already using HOCs! Render CallbacksAnother great way to make a component logic reusable is by turning your component children into a function â€” thatâ€™s why Render Callbacks are also called Function as Child Components. We can take an example of our expandable menu HOC and rewrite it using the Render Callback pattern: Now we can pass a function as our Toggleable component children: The code above is already using a function as children, but, if we want to reuse it just as we did in our HOC example (multiple menus), we could simply create a new component that uses Toggleable logic: Our brand new ToggleableMenu component is ready to be used: Our Menu component looks exactly the same as our HOC example! This approach is really useful when we want to change the rendered content itself regardless of state manipulation: as you can see, weâ€™ve moved our render logic to our ToggleableMenu children function, but kept the state logic to our Toggleablecomponent!","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"The Front-End Checklist","slug":"The-Front-End-Checklist","date":"2017-11-28T03:36:59.000Z","updated":"2017-11-30T14:56:01.153Z","comments":true,"path":"2017/11/The-Front-End-Checklist.html","link":"","permalink":"http://nthung2112.github.io/2017/11/The-Front-End-Checklist.html","excerpt":"An Exhaustive List of all the Elements you need to have/test Before Launching your Website To Production. The Front-End Checklist is an exhaustive list of all elements you need to have / to test before launching your site / HTML page to production. It is based on Front-End developersâ€™ years of experience, with additions coming from other open-source checklists. David Dias is the main author/creator and posted the guide to GitHub where it has taken off! The guide is also available below. Donâ€™t forget to thank David for an awesome guide!","text":"An Exhaustive List of all the Elements you need to have/test Before Launching your Website To Production. The Front-End Checklist is an exhaustive list of all elements you need to have / to test before launching your site / HTML page to production. It is based on Front-End developersâ€™ years of experience, with additions coming from other open-source checklists. David Dias is the main author/creator and posted the guide to GitHub where it has taken off! The guide is also available below. Donâ€™t forget to thank David for an awesome guide! Table of Contents Head HTML Webfonts CSS Images JavaScript Security Performance Accessibility SEO How To UseAll items in the Front-End Checklist are required for the majority of the projects, but some elements can be omitted or are not essential (in the case of an administration web app, you may not need RSS feed for example). Some resources possess an emoticon to help you understand which type of content / help you may find on the checklist: ğŸ“–: documentation or article ğŸ› : online tool / testing tool ğŸ“¹: media or video content Head Notes: You can find a list of everything that could be found in the of an HTML document. Meta tag Doctype: The Doctype is HTML5 and is at the top of all your HTML pages. 12&lt;!-- Doctype HTML5 --&gt;&lt;!doctype html&gt; ğŸ“– Determining the character encoding â€” HTML5 W3C The next 3 meta tags (Charset, X-UA Compatible and Viewport) need to come first in the head. Charset: The charset declared (UTF-8) is declared correctly. 12&lt;!-- Set character encoding for the document --&gt;&lt;meta charset=\"utf-8\"&gt; X-UA-Compatible: The X-UA-Compatible meta tag is present. 12&lt;!-- Instruct Internet Explorer to use its latest rendering engine --&gt;&lt;meta http-equiv=\"x-ua-compatible\" content=\"ie=edge\"&gt; ğŸ“– Specifying legacy document modes (Internet Explorer) Viewport: The viewport is declared correctly. 12&lt;!-- Viewport for responsive web design --&gt;&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt; Title: A title is used on all pages (SEO: Google calculate the pixel width of the characters used in the title, cut off between 472 and 482 pixels. Average character limit would be around 55-characters). 12&lt;!-- Document Title --&gt;&lt;title&gt;Page Title less than 65 characters&lt;/title&gt; ğŸ“– Title â€” HTML â€” MDN ğŸ›  SERP Snippet Generator Description: A meta description is provided, it is unique and doesnâ€™t possess more than 150 characters. 12&lt;!-- Meta Description --&gt;&lt;meta name=\"description\" content=\"Description of the page less than 150 characters\"&gt; ğŸ“–Meta Description â€” HTML â€” MDN Favicons: Each favicon has been created and displays correctly. If you have only a favicon.ico, put it at the root of your site. Normally you wonâ€™t need to use any markup. However, itâ€™s still good practice to link to it using the example below. Today, PNG format is recommended over .ico format (dimensions: 32x32px). 1234&lt;!-- Standard favicon --&gt;&lt;link rel=\"icon\" type=\"image/x-icon\" href=\"https://example.com/favicon.ico\"&gt;&lt;!-- Recommended favicon format --&gt;&lt;link rel=\"icon\" type=\"image/png\" href=\"https://example.com/favicon.png\"&gt; ğŸ›  Favicon Generator ğŸ›  RealFaviconGenerator ğŸ“– Favicon Cheat Sheet ğŸ“– Favicons, Touch Icons, Tile Icons, etc. Which Do You Need? â€” CSS Tricks ğŸ“– PNG favicons â€” caniuse Apple Touch Icon: Apple touch favicon apple-mobile-web-app-capable are present. (Create your Apple Icon file with at least 200x200px dimension to support all dimensions that you may need) 12&lt;!-- Apple Touch Icon --&gt;&lt;link rel=\"apple-touch-icon\" href=\"/custom-icon.png\"&gt; ğŸ“– Configuring Web Applications Windows Tiles: Windows tiles are present and linked. 12&lt;!-- Microsoft Tiles --&gt;&lt;meta name=\"msapplication-config\" content=\"browserconfig.xml\" /&gt; Minimum required xml markup for the browserconfig.xml file is as follows: 1234567891011&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;browserconfig&gt; &lt;msapplication&gt; &lt;tile&gt; &lt;square70x70logo src=\"small.png\"/&gt; &lt;square150x150logo src=\"medium.png\"/&gt; &lt;wide310x150logo src=\"wide.png\"/&gt; &lt;square310x310logo src=\"large.png\"/&gt; &lt;/tile&gt; &lt;/msapplication&gt;&lt;/browserconfig&gt; ğŸ“– Browser configuration schema reference Canonical: Use rel=â€canonicalâ€ to avoid duplicate content. 12&lt;!-- Helps prevent duplicate content issues --&gt;&lt;link rel=\"canonical\" href=\"http://example.com/2017/09/a-new-article-to-red.html\"&gt; ğŸ“– Use canonical URLs â€” Search Console Help â€” Google Support ğŸ“– 5 common mistakes with rel=canonical â€” Google Webmaster Blog HTML tags Language attribute: The lang attribute of your website is specified and related to the language of the current page. 1&lt;html lang=\"en\"&gt; Direction attribute: The direction of lecture is specified on the html tag (It can be used on another HTML tag). 1&lt;html dir=\"rtl\"&gt; ğŸ“– dir â€” HTML â€” MDN Alternate language: The language tag of your website is specified and related to the language of the current page. 1&lt;link rel=\"alternate\" href=\"https://es.example.com/\" hreflang=\"es\"&gt; Conditional comments: Conditional comments are present for IE if needed. ğŸ“– About conditional comments (Internet Explorer) â€” MSDN â€” Microsoft RSS feed: If your project is a blog or has articles, an RSS link was provided. inline critical CSS: CSS which styles content that is immediately visible during pageload (â€œabove the fold contentâ€) is called â€œcritical CSSâ€. It is embedded before your principal CSS call and between in a single line (minified). ğŸ›  Critical by Addy Osmani on Github automates this CSS order: All CSS files are loaded before any JavaScript files in the . (Except the case where sometimes JS files are loaded asynchronously on top of your page). Social metaFacebook OG and Twitter Cards are, for any website, highly recommended. The other social media tags can be considered if you target a particular presence on those and want to ensure the display. Facebook Open Graph: All Facebook Open Graph (OG) are tested and no one is missing or with a false information. Images need to be at least 600 x 315 pixels, 1200 x 630 pixels recommended. 1234567&lt;meta property=\"og:type\" content=\"website\"&gt;&lt;meta property=\"og:url\" content=\"https://example.com/page.html\"&gt;&lt;meta property=\"og:title\" content=\"Content Title\"&gt;&lt;meta property=\"og:image\" content=\"https://example.com/image.jpg\"&gt;&lt;meta property=\"og:description\" content=\"Description Here\"&gt;&lt;meta property=\"og:site_name\" content=\"Site Name\"&gt;&lt;meta property=\"og:locale\" content=\"en_US\"&gt; ğŸ“– A Guide to Sharing for Webmasters ğŸ›  Test your page with the Facebook OG testing Twitter Card: 1234567&lt;meta name=\"twitter:card\" content=\"summary\"&gt;&lt;meta name=\"twitter:site\" content=\"@site_account\"&gt;&lt;meta name=\"twitter:creator\" content=\"@individual_account\"&gt;&lt;meta name=\"twitter:url\" content=\"https://example.com/page.html\"&gt;&lt;meta name=\"twitter:title\" content=\"Content Title\"&gt;&lt;meta name=\"twitter:description\" content=\"Content description less than 200 characters\"&gt;&lt;meta name=\"twitter:image\" content=\"https://example.com/image.jpg\"&gt; ğŸ“– Getting started with cards â€” Twitter Developers ğŸ›  Test your page with the Twitter card validator HTMLBest practices HTML5 Semantic Elements: HTML5 Semantic Elements are used appropriately (header, section, footer, mainâ€¦). ğŸ“– HTML Reference Error pages: Error 404 page and 5xx exist. Remember that the 5xx error pages need to have their CSS integrated (no external call on the current server). Noopener: In case you are using external links with target=â€_blankâ€, your link should have a rel=â€noopenerâ€ attribute to prevent tab nabbing. If you need to support older versions of Firefox, use rel=â€noopener noreferrerâ€. ğŸ“– About rel=noopener Clean up comments: Unnecessary code needs to be removed before sending the page to production. HTML testing W3C compliant: All pages need to be tested with the W3C validator to identify possible issues in the HTML code. ğŸ›  W3C validator HTML Lint: I use tools to help me analyze any issues I could have on my HTML code. ğŸ›  Dirty markup Link checker: There are no broken links in my page, verify that you donâ€™t have any 404 error. ğŸ›  W3C Link Checker Adblockers test: Your website shows your content correctly with adblockers enabled (You can provide a message encouraging people to disable their adblocker). Webfonts Webfont format: WOFF, WOFF2 and TTF are supported by all modern browsers. ğŸ“– WOFF â€” Web Open Font Format â€” Caniuse. ğŸ“– WOFF 2.0 â€” Web Open Font Format â€” Caniuse. ğŸ“– TTF/OTF â€” TrueType and OpenType font support ğŸ“– Using @font-face â€” CSS-Tricks Webfont size: Webfont sizes donâ€™t exceed 2 MB (all variants included). CSS Notes: Take a look at CSS guidelines and Sass Guidelines followed by most Front-End developers. If you have a doubt about CSS properties, you can visit CSS Reference_._ Responsive Web Design: The website is using responsive web design. CSS Print: A print stylesheet is provided and is correct on each page. Preprocessors: Your page is using a CSS preprocessor (Sass is preferred). Unique ID: If IDs are used, they are unique to a page. Reset CSS: A CSS reset (reset, normalize or reboot) is used and up to date. (If you are using a CSS Framework like Bootstrap or Foundation, a Normalize is already included into it.) ğŸ“– Reset.css ğŸ“– Normalize.css ğŸ“– Reboot JS prefix: All classes (or id- used in JavaScript files) begin with js- and are not styled into the CSS files. 123&lt;div id=\"js-slider\" class=\"my-slider\"&gt;&lt;!-- Or --&gt;&lt;div id=\"id-used-by-cms\" class=\"js-slider my-slider\"&gt; Embedded or inline CSS: Avoid at all cost embeding CSS in &lt;style&gt; tags or using inline CSS: only use for valid reasons (e.g. background-image for slider, critical CSS). Vendor prefixes: CSS vendor prefixes are used and are generated accordingly with your browser support compatibility. ğŸ›  Autoprefixer CSS online Performance Concatenation: CSS files are concatenated in a single file. (Not for HTTP/2) Minification: All CSS files are minified. Non-blocking: CSS files need to be non-blocking to prevent the DOM from taking time to load. ğŸ“– loadCSS by filament group ğŸ“– Example of preload CSS using loadCSS Unused CSS: Remove unused CSS. ğŸ›  UnCSS Online ğŸ›  ğŸ›  PurifyCSS ğŸ›  Chrome DevTools Coverage CSS testing Stylelint: All CSS or SCSS files are without any errors. ğŸ›  stylelint, a CSS linter ğŸ“– Sass guidelines Responsive web design: All pages were tested at the following breakpoints: 320px, 768px, 1024px (can be more / different according to your analytics). CSS Validator: The CSS was tested and pertinent errors were corrected. ğŸ›  CSS Validator Desktop Browsers: All pages were tested on all current desktop browsers (Safari, Firefox, Chrome, Internet Explorer, EDGEâ€¦). Mobile Browsers: All pages were tested on all current mobile browsers (Native browser, Chrome, Safariâ€¦). OS: All pages were tested on all current OS (Windows, Android, iOS, Macâ€¦). Pixel perfect: Pages are close to pixel perfect. Depending on the quality of the creatives, you may not be 100% accurate, but your page needs to be close to your template. Pixel Perfect â€” Chrome Extension Reading direction: All pages need to be tested for LTR and RTL languages if they need to be supported. ğŸ“– Building RTL-Aware Web Apps &amp; Websites: Part 1 â€” Mozilla Hacks ğŸ“– Building RTL-Aware Web Apps &amp; Websites: Part 2 â€” Mozilla Hacks Images Notes: For a complete understanding of image optimization, check the free ebook Essential Image Optimizationfrom Addy Osmani. Best practices Optimization: All images are optimized to be rendered in the browser. WebP format could be used for critical pages (like Homepage). ğŸ›  Imagemin ğŸ›  Use ImageOptim to optimise your images for free. Picture/Srcset: You use picture/srcset to provide the most appropriate image for the current viewport of the user. ğŸ“– How to Build Responsive Images with srcset Retina: You provide layout images 2x or 3x, support retina display. Sprite: Small images are in a sprite file (in the case of icons, they can be in an SVG sprite image). Width and Height: Set width and height attributes on if the final rendered image size is known (can be omitted for CSS sizing). Alternative text: All have an alternative text which describe the image visually. ğŸ“– Alt-texts: The Ultimate Guide Lazy loading: Images are lazyloaded (A noscript fallback is always provided). JavaScriptBest practices JavaScript Inline: You donâ€™t have any JavaScript code inline (mixed with your HTML code). Concatenation: JavaScript files are concatenated. Minification: JavaScript files are minified (you can add the .min suffix). ğŸ“– Minify Resources (HTML, CSS, and JavaScript) JavaScript security: ğŸ“– Guidelines for Developing Secure Applications Utilizing JavaScript Non-blocking: JavaScript files are loaded asynchronously using async or deferred using defer attribute. ğŸ“– Remove Render-Blocking JavaScript Modernizr: If you need to target some specific features you can use a custom Modernizr to add classes in your tag. ğŸ›  Customize your Modernizr JavaScript testing ESLint: No errors are flagged by ESLint (based on your configuration or standards rules). ğŸ“– ESLint â€” The pluggable linting utility for JavaScript and JSX SecurityScan and check your web site securityheaders.io Observatory by Mozilla ASafaWeb â€” Automated Security Analyser for ASP.NET Websites Best practices HTTPS: HTTPS is used on every pages and for all external content (plugins, imagesâ€¦). ğŸ›  Letâ€™s Encrypt â€” Free SSL/TLS Certificates ğŸ›  Free SSL Server Test ğŸ“– Strict Transport Security HTTP Strict Transport Security (HSTS): The HTTP header is set to â€˜Strict-Transport-Securityâ€™. ğŸ›  Check HSTS preload status and eligibility ğŸ“– HTTP Strict Transport Security Cheat Sheet â€” OWASP ğŸ“– Transport Layer Protection Cheat Sheet â€” OWASP Cross Site Request Forgery (CSRF): You ensure that requests made to your server-side are legitimate and originate from your website / app to prevent CSRF attacks. ğŸ“– Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet â€” OWASP Cross Site Scripting (XSS): Your page or website is free from XSS possible issues. ğŸ“– XSS (Cross Site Scripting) Prevention Cheat Sheet â€” OWASP ğŸ“– DOM based XSS Prevention Cheat Sheet â€” OWASP Content Type Options: Prevents Google Chrome and Internet Explorer from trying to mime-sniff the content-type of a response away from the one being declared by the server. ğŸ“– X-Content-Type-Options â€” Scott Helme X-Frame-Options (XFO): Protects your visitors against clickjacking attacks. ğŸ“– X-Frame-Options â€” Scott Helme ğŸ“– RFC7034 â€” HTTP Header Field X-Frame-Options PerformanceBest practices Weight page: The weight of each page is between 0 and 500 KB. ğŸ›  Website Page Analysis ğŸ“– Size Limit: Make the Web lighter Minified: Your HTML is minified. ğŸ›  W3C Validator Lazy loading: Images, scripts and CSS need to be lazy loaded to improve the response time of the current page (See details in their respective sections). Cookie size: If you are using cookies be sure each cookie doesnâ€™t exceed 4096 bytes and your domain name doesnâ€™t have more than 20 cookies. ğŸ“– Cookie specification: RFC 6265 ğŸ“– Cookies ğŸ›  Browser Cookie Limits Third party components: Third party iframes or components relying on external JS (like sharing buttons) are replaced by static components when possible, thus limiting calls to external APIs and keeping your users activity private. ğŸ›  Simple sharing buttons generator Preparing upcoming requests ğŸ“– Explanation of the following techniques DNS resolution: DNS of third-party services that may be needed are resolved in advance during idle time using dns-prefetch. 1&lt;link rel=\"dns-prefetch\" href=\"https://example.com\"&gt; Preconnection: DNS lookup, TCP handshake and TLS negociation with services that will be needed soon is done in advance during idle time using preconnect. 1&lt;link rel=\"preconnect\" href=\"https://example.com\"&gt; Prefetching: Resources that will be needed soon (e.g. lazy loaded images) are requested in advance during idle time using prefetch. 1&lt;link rel=\"prefetch\" href=\"image.png\"&gt; Preloading: Resources needed in the current page (e.g. scripts placed at the end of ) in advance using preload. 1&lt;link rel=\"preload\" href=\"app.js\"&gt; ğŸ“– Difference between prefetch and preload Performance testing Google PageSpeed: All your pages were tested (not only the homepage) and have a score of at least 90/100. ğŸ›  Google PageSpeed ğŸ›  Test your mobile speed with Google ğŸ›  WebPagetest â€” Website Performance and Optimization Test Accessibility Notes: You can watch the playlist A11ycasts with Rob Dodson _ğŸ“¹_ Best practices Progressive enhancement: Major functionality like main navigation and search should work without JavaScript enabled. ğŸ“– Enable / Disable JavaScript in Chrome Developer Tools Color contrast: Color contrast should at least pass WCAG AA (AAA for mobile). ğŸ›  Contrast ratio Headings H1: All pages have an H1 which is not the title of the website. Headings: Headings should be used properly in the right order (H1 to H6). ğŸ“¹ Why headings and landmarks are so important â€” A11ycasts #18 Landmarks Role banner: has role=â€bannerâ€. Role navigation: has role=â€navigationâ€. Role main: has role=â€mainâ€. ğŸ“– Using ARIA landmarks to identify regions of a page Semantics Specific HTML5 input types are used: This is especially important for mobile devices that show customized keypads and widgets for different types. ğŸ“– Mobile Input Types Form Label: A label is associated with each input form element. In case a label canâ€™t be displayed, use aria-labelinstead. ğŸ“– Using the aria-label attribute â€” MDN Accessibility testing Accessibility standards testing: Use the WAVE tool to test if your page respects the accessibility standards. ğŸ›  Wave testing Keyboard navigation: Test your website using only your keyboard in a previsible order. All interactive elements are reachable and usable. Screen-reader: All pages were tested in a screen-reader (VoiceOver, ChromeVox, NVDA or Lynx). Focus style: If the focus is disabled, it is replaced by visible state in CSS. ğŸ“¹ Managing Focus â€” A11ycasts #22 SEO Google Analytics: Google Analytics is installed and correctly configured. Headings logic: Heading text helps to understand the content in the current page. sitemap.xml: A sitemap.xml exists and was submitted to Google Search Console (previously Google Webmaster Tools). robots.txt: The robots.txt is not blocking webpages. ğŸ›  Test your robots.txt with Google Robots Testing Tool Structured Data: Pages using structured data are tested and are without errors. Structured data helps crawlers understand the content in the current page. ğŸ“– Introduction to Structured Data â€” Search â€” Google Developers ğŸ›  Test your page with the Structured Data Testing Tool ğŸ›  Complete list of vocabularies that can be used as structured data. Schema.org Full Heirarchy Sitemap HTML: An HTML sitemap is provided and is accessible via a link in the footer of your website. ğŸ“– Sitemap guidelines â€” Google Support ğŸ›  Sitemap generator","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"front-end","slug":"front-end","permalink":"http://nthung2112.github.io/tags/front-end/"}]},{"title":"NghiÃªn cá»©u cáº£i thiá»‡n tá»‘c Ä‘á»™ web app vá»›i React vÃ  Preact: Treebo","slug":"Nghien-cuu-cai-thien-toc-do-web-app-voi-React-va-Preact-Treebo","date":"2017-11-15T01:26:38.000Z","updated":"2017-11-15T01:33:31.147Z","comments":true,"path":"2017/11/Nghien-cuu-cai-thien-toc-do-web-app-voi-React-va-Preact-Treebo.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Nghien-cuu-cai-thien-toc-do-web-app-voi-React-va-Preact-Treebo.html","excerpt":"Treebo is Indiaâ€™s top rated budget hotel chain, operating in a segment of the travel industry worth $20 billion. They recently shipped a new Progressive Web App as their default mobile experience, initially using React and eventually switching to Preact in production. What they saw compared to their old mobile site was a 70%+ improvement in time to first paint , 31% improvement in time-to-interactive. and loaded in under 4 seconds over 3G for many typical visitors and on their target hardware. It was interactive in under 5s using WebPageTestâ€™s slower 3G emulation in India.","text":"Treebo is Indiaâ€™s top rated budget hotel chain, operating in a segment of the travel industry worth $20 billion. They recently shipped a new Progressive Web App as their default mobile experience, initially using React and eventually switching to Preact in production. What they saw compared to their old mobile site was a 70%+ improvement in time to first paint , 31% improvement in time-to-interactive. and loaded in under 4 seconds over 3G for many typical visitors and on their target hardware. It was interactive in under 5s using WebPageTestâ€™s slower 3G emulation in India. Switching from React to Preact was responsible for a 15% improvement in time-to-interactive alone. You can check out Treebo.com for their full experience but today we would like to dive into some of the technical journey that made shipping this PWA possible. Treeboâ€™s Progressive Web App A Performance JourneyThe old mobile siteTreeboâ€™s old mobile site was powered by a monolithic Django setup. Users had to wait for a server side request for every page transition on the website. This original setup had a first paint time of 1.5s, a first meaningful paint time of 5.9s and was first interactive in 6.5s. A basic single-page React appFor their first iteration of the rewrite Treebo started off with a Single Page Application built using React and a simple webpack setup. You can take a look at the actual code used below. This generates some simple (monolithic) JavaScript and CSS bundles. This experience had a first paint of 4.8s, was first interactive in about 5.6s and their meaningful header images painted in about 7.2s. Server-side RenderingNext, they went about optimizing their first paint a little so they tried out Server-side Rendering. Itâ€™s important to note, server side rendering is not free. It optimizes one thing at the cost of another. With server-side rendering, your serverâ€™s response to the browser is the HTML of your page that is ready to be rendered so the browser can start rendering without having to wait for all the JavaScript to be downloaded and executed. Treebo used Reactâ€™s renderToString() to render components to an HTML string and injecting state for the application on initial boot up. In Treebosâ€™ case, using server side rendering dropped their first paint time to 1.1s and first meaningful paint time down to 2.4s â€” this improved how quickly users perceived the page to be ready, they could read content earlier on and it performed slightly better at SEO in tests. But the downside was that it had a pretty negative impact on time to interactive. Although users could view content, the main thread got pegged while booting up their JavaScript and just hung there. With SSR, the browser had to fetch and process a much larger HTML payload than before and then still fetch, parse/compile and execute the JavaScript. It was effectively doing more work. This meant that first interactive happened about 6.6s, regressing. SSR can also push TTI back by locking up the main thread on lower-end devices. Code-splitting &amp; route-based chunkingThe next thing Treebo looked at was route-based chunking to help bring down their time-to-interactive numbers. Route-based chunking aims to serve the minimal code needed to make a route interactive, by code-splitting the routes into â€œchunksâ€ that can be loaded on demand. This encourages delivering resources closer to the granularity they were authored in. What they did here was they split out their vendor dependencies, their Webpack runtime manifests and their routes â€” into separate chunks. This reduced the time to first interactive down to 4.8s. Awesome! The only downside was that it started the current routeâ€™s JavaScript download only after their initial bundles were done executing, which was also not ideal. But it did at least have some positive impact on the experience. For route-based code-splitting and this experience, theyâ€™re doing something a little bit more implicit. Theyâ€™re using React Routerâ€™s declarative support for getComponent with a webpack import() call to asynchronously load in chunks. The PRPL Performance PatternRoute-based chunking is a great first step in intelligently bundling code for more granular serving and caching. Treebo wanted to build on this and looked to the PRPL patternfor inspiration. PRPL is a pattern for structuring and serving PWAs, with an emphasis on the performance of app delivery and launch. PRPL stands for: Push critical resources for the initial URL route. Render initial route. Pre-cache remaining routes. Lazy-load and create remaining routes on demand. A PRPL visualization by Jimmy Moon The â€œPushâ€ part encourages serving an unbundled build designed for server/browser combinations that support HTTP/2 to deliver the resources the browser needs for a fast first paint while optimizing caching. The delivery of these resources can be triggered efficiently using or HTTP/2 Push. Treebo opted to use to preload the current routeâ€™s chunk ahead of time. This had the impact of dropping their first interactive times since the current routeâ€™s chunk was already in the cache when webpack made a call to fetch it after their initial bundles finished executing. It shifted the time down a little bit and so the first interactive happened at the 4.6s mark. The only con they had with preload is that itâ€™s not implemented cross-browser. However, thereâ€™s an implementation of link rel preload in Safari Tech Preview. Iâ€™m hopeful that itâ€™s going to land and stick this year. Thereâ€™s also work underway to try landing it in Firefox. HTML Streaming One difficulty with renderToString() is that it is synchronous, and it can become a performance bottleneck in server-side rendering of React sites. Servers wonâ€™t send out a response until the entire HTML is created. When web servers stream out their content instead, browsers can render pages for users before the entire response is finished. Projects like react-dom-stream can help here. To improve perceived performance and introduce a sense of progressive rendering to their app, Treebo looked to HTML Streaming. They would stream the head tag with link rel preload tags set up to early preload in their CSS and their JavaScripts. They then perform their server side rendering and send the rest of the payload down to the browser. The benefit of this was that resource downloads started earlier on, dropping their first paint to 0.9s and first interactive to 4.4s. The app was consistently interactive around the 4.9/5 second mark. The downside here was that it kept the connection open for a little bit longer between the client and server, which could have issues if you run into longer latency times. For HTML streaming, Treebo defined an early chunk with the content, then they have the main content and the late chunks. All of these being injected into the page. This is what it looks like: Effectively, the early chunk has got their rel=preload statements for all of their different script tags. The late chunk has got the server rendered html and anything thatâ€™s going to include state or actually use the JavaScript thatâ€™s being loaded in. Inlining critical-path CSS CSS Stylesheets can block rendering. Until the browser has requested, received, downloaded and parsed your stylesheets, the page can remain blank. By reducing the amount of CSS the browser has to go through, and by inlining (critical-path styles) it on the page, thus removing a HTTP request, we can get the page to render faster. Treebo added support for Inlining their critical-path CSS for the current route and asynchronously loading in the rest of their CSS using loadCSS on DOMContentLoaded. It had the effect of removing the critical-path render blocking link tag for stylesheets and inlining fewer lines of core CSS, improving first paint times to about 0.4s. The downside was that time to first interactive went up a bit to 4.6s as the payload size was larger with inline styles and took time to parse before JavaScript could be executed. Offline-caching static assets A Service Worker is a programmable network proxy, allowing you to control how network requests from your page are handled. Treebo added support for Service Worker caching of their static assets as well a custom offline page. Below we can see their Service Worker registration and how they used sw-precache-webpack-plugin for resource cachingâ€ Caching static assets like their CSS and JavaScript bundles means pages load up (almost) instantly on repeat visits as they load from the disk cache rather than having to go back out to the network each time. Diligently defined caching headers can have this same effect with respect to disk cache hit-rates, but itâ€™s Service Worker that gives us offline support. Serving JavaScript cached using Service Worker using the Cache API (as we covered in JavaScript Start-up Performance) also has the nice property of early-opting Treebo into V8â€™s code cache so they save a little time on start-up during repeat visits. Next, Treebo wanted to try getting their vendor bundle-size and JS execution time down, so they switched from React to Preact in production. Switching from React to PreactPreact is a tiny 3KB alternative to React with the same ES2015 API. It aims to offer high performance rendering with an optional compatibility later (preact-compat) that works with the rest of the React ecosystem, like Redux. Part of Preactâ€™s smaller size comes from removing Synthetic Events and PropType validations. In addition it: Diffs Virtual DOM against the DOM Allows props like class and for Passes (props, state) to render Uses standard browser events Supports fully async rendering Subtree invalidation by default In a number of PWAs, switching to Preact has led to smaller JS bundle sizes and lower initial JavaScript boot-up times for the application. Recent PWA launches like Lyft, Uber and Housing.com all use Preact in production. Note: Working with a React codebase and want to use Preact? Ideally, you should use preact and preact-compat for your dev, prod and test builds. This will enable you to discover any interop bugs early on. If you would prefer to only alias preact and preact-compat in Webpack for production builds (e.g if your preference is using Enzyme), make sure to thoroughly test everything works as expected before deploying to your servers. In Treeboâ€™s case, this switch had the impact of dropping their vendor bundle sizes from 140kb all the way down to 100kb. This is all gzipped, by the way. It dropped first interactive times from 4.6s to 3.9s on Treeboâ€™s target mobile hardware which was a net win. You can do this in your Webpack config by aliasing react to preact-compat, and react-dom to preact-compat as well. The downside to this approach was that they did have to end up putting together a few workarounds in order to get Preact working exactly with all the different pieces of the React ecosystem that they wanted to use. Preact tends to be a strong choice for the 95% of cases you would use React; for the other 5% you may end up needing to file bugs to work around edge-cases that are not yet factored in. Notes: As WebPageTest does not currently offer a way to test real Moto G4s directly from India, performance tests were run under the â€œMumbai â€” EC2 â€” Chrome â€” Emulated Motorola G (gen 4) â€” 3GSlow â€” Mobileâ€ setting. Should you wish to look at these traces they can be found here_._ Skeleton screens â€œA skeleton screen is essentially a blank version of a page into which information is gradually loaded.â€ ~Luke Wroblewski Treebo like to implement their skeleton screens using preview enhanced components (a little like skeleton screens for each component). The approach is basically to enhance any atomic component (Text, Image etc) to have a preview version, such that if the source data that is required for the component is not present, it shows the preview version of the component instead. For example, if you look at the hotel name, city name, price etc in the list items above, theyâ€™re implemented using Typography components like which take two extra props, preview and previewStyle which is used like so. Basically, if the hotel.name does not exist then the component changes the background to a greyish color with the width and other styles set according to the previewStyle passed down (width defaults to 100% if no previewStyle is passed). Treebo likes this approach because the logic to switch to the preview mode is independent of the data actually being shown which makes it flexible. If you look at the â€œIncl. of all taxesâ€ part, itâ€™s just static text, which could have been shown right at the start but that wouldâ€™ve looked very confusing to the user since the prices are still loading during the api call. So to get the static text â€œIncl. of all pricesâ€ into a preview mode alongside the rest of the ui they just use the price itself as the logic for the preview mode. This way while the prices are loading you get a preview UI and once the api succeeds you get to see the data in all its glory. Webpack-bundle-analyzerAt this point, Treebo wanted to perform some bundle analysis to look at what other low-hanging fruit they could optimize. Note: If youâ€™re using a library like React on mobile, itâ€™s important to be diligent about the other vendor libraries you are pulling in. Not doing so can negatively impact performance. Consider better chunking your vendor libraries so that routes only load those that are needed Treebo used webpack-bundle-analyzer to keep track of their bundle size changes and to monitor what modules are contained in each route chunk. They also use it to find areas where they can optimize to reduce bundle sizes such as stripping moment.jsâ€™ locales and reusing deep dependencies. Optimizing moment.js with webpackTreebo relies heavily on moment.js for their date manipulations. When you import moment.js and bundle it with Webpack, your bundle will include all of moment.js and itâ€™s locales by default which is ~61.95kb gzipped. This seriously bloats your final vendor bundle size. To optimize the size of moment.js, there are two webpack plugins available: IgnorePlugin, ContextReplacementPlugin Treebo opted to remove all locale files with the IgnorePlugin since they didnâ€™t need any of the them. new webpack.IgnorePlugin(/^.\\/locale$/, /moment$/) With the locales stripped out, the moment.jsâ€™ bundled size dropped to ~16.48kb gzipped. The biggest improvement as a side effect of stripping out moment.jsâ€™ locales was that the vendor bundle size dropped from ~179kb to ~119kb. Thatâ€™s a massive 60kb drop from a critical bundle that has to be served on first load. All this translates to a considerable decrease in first interaction times. You can read more about optimizing moment.js here. Reusing existing deep dependenciesTreebo was initially using the â€œqsâ€ module to perform query string operations. Using the webpack-bundle-analyzer output they found that â€œreact-routerâ€ included the â€œhistoryâ€ module which in-turn included the â€œquery-stringâ€ module. Since there were two different modules both accomplishing the same operations, replacing â€œqsâ€ with this version of â€œquery-stringâ€ (by installing it explicitly) in their source code, dropped their bundle size by a further 2.72kb gzipped (size of the â€œqsâ€ module). Treebo have been good open source citizens. Theyâ€™ve been using a lot of open source software. In return, theyâ€™ve actually open sourced most of their Webpack configuration, as well as a boilerplate that contains a lot of the set up theyâ€™re using in production. You can find that here: https://github.com/lakshyaranganath/pwa Theyâ€™ve also committed to trying to keep that up to date. As they evolve you can take advantage of them as another PWA reference implementation. Conclusions and the futureTreebo knows that no application is perfect, they actively explore many methods to keep improving the experience they deliver to their users. Some of which are: Lazy Loading ImagesSome of you might have figured out from the network waterfall graphs before that the website image downloads are competing for bandwidth with the JS downloads. Since image downloads are triggered as soon as the browser parses the img tags, they share the bandwidth during JS downloads. A simple solution would be lazy loading images only when they come into the userâ€™s viewport, this will see a good improvement in our time to interactive. Lighthouse highlights these problems well in the offscreen images audit: Dual Importing Treebo also realise that while they are asynchronously loading the rest of the CSS for the app (after inlining the critical css), this approach is not viable for their users in the long run as their app grows. More features and routes means more CSS, and downloading all of that leads to bandwidth hogging and wastage. Merging approaches followed by loadCSS and babel-plugin-dual-import, Treebo changed their approach to loading CSS by using an explicit call to a custom implemented importCss(â€˜chunknameâ€™) to download the CSS chunk in parallel to their import(â€˜chunkpathâ€™) call for their respective JS chunk. With this new approach, a route transition results in two parallel asynchronous requests, one for JS and the other for CSS unlike the previous approach where all of the CSS was being downloaded on DOMContentLoaded. This is more viable since a user will only ever download the required CSS for the routes they are visiting. A/B Testing Treebo are currently implementing an AB testing approach with server side rendering and code splitting so as to only push down the variant that user needs during both server and client side rendering. (Treebo will follow up with a blog post on how they tackled this). Eager Loading Treebo ideally donâ€™t want to always load all the split chunks of the app on load of the initial page since they want to avoid the bandwidth contention for critical resource downloads â€” this also wastes precious bandwidth for mobile users especially if youâ€™re not caching it with service-worker for their future visits. If we look at how well Treebo is doing on metrics like consistently interactive, thereâ€™s still much room for improvement: This is an area theyâ€™re experimenting with improving. One example is eager loading the next routeâ€™s chunk during the ripple animation of a button. onClick Treebo make a webpack dynamic import() call to the next routeâ€™s chunk entry and delay the route transition with a setTimeout. They also want to make sure that the next routeâ€™s chunk is small enough to be downloaded within the given 400ms timeout on a slow 3g network. Thatâ€™s a wrap.Itâ€™s been fun collaborating on this write-up. Thereâ€™s obviously more work to be done, but we hope you found Treeboâ€™s performance journey an interesting read :) You can find us over on twitter at @addyosmani and @__lakshya (yep, double underscore xD) we would love to hear your thoughts. With thanks to _@zouhir_,_ _@developit and @samcccone for their reviews and input.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"preact","slug":"preact","permalink":"http://nthung2112.github.io/tags/preact/"}]},{"title":"CÃ¡ch chÃ­nh xÃ¡c 100% Ä‘á»ƒ cáº¥u trÃºc á»©ng dá»¥ng React","slug":"Cach-chinh-xac-100-de-cau-truc-ung-dung-React","date":"2017-11-13T16:51:55.000Z","updated":"2017-11-15T01:22:22.141Z","comments":true,"path":"2017/11/Cach-chinh-xac-100-de-cau-truc-ung-dung-React.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Cach-chinh-xac-100-de-cau-truc-ung-dung-React.html","excerpt":"When it comes to structuring a React app, the ideal structure is the one that allows you to move around your code with the least amount of effort. In this post, Iâ€™d like to tell you how _I_ structure my React apps, and what drove my decisions. Along the way Iâ€™ll mention some options I donâ€™t use because they donâ€™t suit me, but that might serve you well. Iâ€™d also like to hear how you do things and what youâ€™ve found works well down in the comments.","text":"When it comes to structuring a React app, the ideal structure is the one that allows you to move around your code with the least amount of effort. In this post, Iâ€™d like to tell you how _I_ structure my React apps, and what drove my decisions. Along the way Iâ€™ll mention some options I donâ€™t use because they donâ€™t suit me, but that might serve you well. Iâ€™d also like to hear how you do things and what youâ€™ve found works well down in the comments. What works for youMaybe this was always obvious to you, but itâ€™s only just clicked for me: the structure of an app has nothing to do with computers. Imagine for a moment an app with only one file for all your components, reducers, the store, utilities, everything. A terrible idea, of course. Now, have a think about why the above would be a bad thing. We both know you didnâ€™t really stop and ponder, so Iâ€™ll just tell you what I think. The problem with this giant file is that itâ€™s going to be difficult to navigate. But what if you could have bookmarks for each area of the code, maybe one bookmark per function. Maybe the ability to have nested bookmarks. How about a table of contents for all of these bookmarks? This might seem like a daft thought experiment, but I think itâ€™s worth establishing that the only thing youâ€™re trying to do when deciding on a file structure is to maximise how easily you can navigate through your code. Your â€˜filesâ€™ are nothing more than markers to parts of the code that will wind up being a single chunk of JS at the end of the day. And this is why you can never get a straight answer to the question â€œwhatâ€™s the best way to structure my appâ€ â€” it depends so much on your own navigation habits and preferences that itâ€™s not a question anyone else can answer for you. To work out what the 100% correct application structure was for me, I set out to quantify my most common code-related activities: Create a new component. Usually this is a copy/paste of some existing component. Import one module into another. Here I mean the actual typing out of import { SomeComponent } from â€˜../blah/de/blah.jsâ€™;. Jump to source. This is when Iâ€™m looking at a file, and it has a reference to something external, say a component, and I jump to where that component is defined. Open a known file. Probably doesnâ€™t need a description, but I want my bullet points to look nice and uniform, so this is where I think in my head â€œI want to open the header navâ€, so I use a keyboard shortcut and type the file name to open it. Dammit, now this is the bullet point with the longest description and it didnâ€™t even need one in the first place. Browse for a file I donâ€™t know the name of. Maybe I didnâ€™t work on the little widget that shows the drop down below the user profile photo and donâ€™t know what itâ€™s called. So I want to go browsing the directory structure for this component. Change tab to another open file. This is exactly what it sounds like. I currently have 7 files open, and I want to switch from one tab to another, by clicking on a tab name (or using the keyboard). Next, I had a think about how often I do each of these things. I went back and counted the components Iâ€™ve created in the last year, the average number of imports per file, and took some wild guesses at the others, to come up with the following: Sorted by the order that I thought of the things With this data in my hot little hands, I was ready to objectively look at all the aspects of structuring a React app. Let us go through them one by one. Directory structureAs a general rule, if a module (a utility, component, etc.) is only used within another module, then I want it nested in the directory structure like so: &lt;HeaderNav&gt; will only be referenced from within the &lt;Header&gt; component, so it lives as a child. A &lt;Button&gt; could be referenced from anywhere, so it lives at the top level. That rule is great, but I also know that following a super strict set of rules here can be annoying. Technically everything resides under App and under Page too. But Iâ€™m not going to represent that in my directory structure, because I donâ€™t want to. This might sound flippant but itâ€™s quite fundamental. If following your own rules creates a structure that is harder to navigate, youâ€™ve taken your eyes off the prize. Outside of components, I donâ€™t think directory structure is very important. You can agonise over whether your reducers and your action creators should be in the same directory as your services until youâ€™re a shade of blue. But if you ask me, any basic structure with sane folder names (actionCreators, reducers, data, etc.) is all you need. This may be the first point where we differ in our needs and wants. I have established that I rarely open files by browsing through a directory structure, so naturally I apply a lower importance to directory structures. Iâ€™ve also never worked on a project with more than a few hundred components. If you rely more heavily on navigating a directory structure, or youâ€™re Facebook with 30,000 components, then your needs will likely vary. Another thing: I would suggest naming your components in a â€˜fully qualifiedâ€™ (and globally unique) way. For example, HeaderNav is inside Header, so you could argue that it could just be named Nav. If that suits you, cool. But I open files by typing their names, and look at the text on tabs to switch files. In both these cases, having a fully qualified name is useful. And of course if youâ€™re following BEM where the block matches the component name, youâ€™re going to need globally unique component names anyway. What about container components?Container components are a tricky one, because theyâ€™re sort of components, but sort of not. I see two broad approaches to fitting container components into your structure: Treat them exactly like presentational components Leave them out of the directory structure. They will live â€˜in the backgroundâ€™, just providing data to a component In the first case, you would actually reference the container component in your markup. So, with the example of a header component that has its own container, it might be included like so: So here Iâ€™m passing through some specific data to the and components, while itâ€™s quite clear that the is going to look after its own data needs. If this is how you roll, the logical structure will be something like this: The second option is to leave container components out of the structure; to think of them like implementation details of the component that they wrap. So maybe your would wrap itself in a container component at the point of export. Something like this: And then you reference it like this: The downside is that it isnâ€™t immediately clear that will be provided data from somewhere else. The upside is one less step in the component hierarchy. If this is how you want to do things, you can then just have the container as a function that lives in the same directory as the component it provides data to: (Also note that I exported the â€˜rawâ€™ Header as well as the default export of the container-wrapped Header. The former is for unit tests, and your linter might tell you that youâ€™re being confusing by exporting a non-default constant with the same name as the file. I tend to agree with the linter.) I have used the first approach in a medium sized project and it worked quite well. I recently tried out the second example in a new project (that only has 6 container components) and it didnâ€™t quite feel right, so Iâ€™ll stick with the first option. I see no problem with either approach. Side note: I think thereâ€™s a fine art to recognising the point at which it makes sense to say â€œyou know what, it doesnâ€™t really matterâ€ and moving on with your day. This article nails it and is a nice short read. (Warning: thereâ€™s a swear word in the title of that article, so donâ€™t click the link if youâ€™re offended by the word fuck.) Self-contained componentsMy rule: if I have a project with more components than a Klein bottle has sides, I put each component in a directory along with a CSS file and a test. This rule is common for good reason, but even if you do have everything neatly tucked away in the same directory, youâ€™re still quite free to make one huge mistakeâ€¦ Take a look at your nearest file that contains a component. At the top of that file you will probably see a list of all other files that the component relies on as a neat set of imports. Unless, that is, you share CSS classes between components. Then you also have a bunch of dependencies that arenâ€™t listed. Sure, you will save 7 seconds by using that .modal-wrapper class in your component because it already had the shadow you wanted, but oh boy do you even know the world of pain that you have just inflicted upon your future selfâ€¦ [deleted scene: 14 paragraph rant about why this is a bad idea] Trying to convince some people to not share CSS classes between components is like trying to convince people to â€œavoid using global variables in JavaScriptâ€ or â€œvaccinate your chickensâ€ â€” some folks just arenâ€™t gonna listen. CSS-module users are no doubt wiggling their butts feeling pretty darn pleased with themselves right now. And they have good reason to be â€” they have a setup that can enforce the explicit import of CSS classes. If you care about keeping your CSS tightly coupled with your components, you should be using CSS modules too. File namingOne rule that I find immensely useful is this: name your file the same as the thing youâ€™re exporting from that file To some this is not even worth typing out itâ€™s so obvious. But Iâ€™ve seen plenty of code where this isnâ€™t the case and boy does it make it slow to move around. (Donâ€™t forget, all of this is personal. When I say â€œslow to move aroundâ€, itâ€™s totally OK for you to think â€œit wouldnâ€™t make it slow for meâ€, and therefore decide that there is no point in naming a file the same as its default export.) Something I do very often is open a file by typing its name. If I have a utility function called toString then I fully expect that I will have a file called toString that I can open by typing exactly that. Something else that I do very often is switch tabs to a file that I already have open. For this Iâ€™ll expect that tab to have â€œtoString.jsâ€ as itâ€™s name. Structures like the below make me want to curl up in a ball in a fireplace that is in use: It staggers me that some people are happy to work like this. Even if your IDE is clever and puts the directory in the tab name for non-unique filenames, you still have a bunch of redundancy there, and will run out of tab room sooner, and you still canâ€™t type the filename to open it. I donâ€™t even need to try this approach to know I wonâ€™t like it. Like my cousinâ€™s new band, Mass Spectrometer that â€œdonâ€™t really fit into any known genreâ€. Get someone else to drive you to the gig. Having said that, I understand that there is reasoning behind this â€” it means your import statement is this: 1**import** Link **from** '../Link'; Instead of this: 1**import** Link **from** '../Link/Link'; Itâ€™s a clear trade-off. Shorter import statements vs file names that match exports. Letâ€™s me just look this upâ€¦ I import a module into another module, on average, 18 times a week. I open a file by typing its name roughly 840 times a week, and I look for a name on a tab roughly 1,892 times a week. So Iâ€™ll take one extra (auto-completed) word in my import path, thanks. Savvy readers will be shouting at their screens: there are two solutions to this that allow you have the file name match the thing being exported, and avoid having to type it twice in the import statement. The first is to put an index.js file in every directory that exports a component, like so: Since Node will look for an index.js file when resolving an import path, a path to ../Link is really a path to ../Link/index.js which is a file that points to the actual component file. If typing fewer characters in your imports is important, then maybe an extra file for every directory sounds like good value. I think itâ€™s a bad deal and I will repeat one more time that itâ€™s seriously OK to have a different opinion on the matter. The second â€˜solutionâ€™ is this monstrosity: By this point you will know that if Node doesnâ€™t find ../Link/index.js itâ€™s going to check to see if ../Link/package.json exists. If it does, itâ€™s going to resolve to the value of the main property. I think you have to really really hate typing one extra word in your import statements to go as far as creating a package.json file for every component. Itâ€™s just weird. And the more weird shit you put in your code, the weirder you become. These two types of â€˜redirectingâ€™ files both mean that your import statement no longer points to the file where the thing is defined. In the olden days, this would break the ability to â€˜jump to sourceâ€™ â€” something that is crucial to me being able to move throughout my code with ease and speed. WebStorm is clever and will resolve these hops (it will â€˜knowâ€™ that I donâ€™t want to jump into the index.js file, I want to jump all the way to the Link.js file), but if your text editor isnâ€™t so clever, this might leave you with a lot of index.js files open, or jumping to source might not work at all. So before subscribing to an approach, try it out and see if itâ€™s going to be a hindrance to the way you work. .js vs .jsx extensionsUntil recently Iâ€™d always used .jsx extensions for any file that contained JSX, and used .js for anything that was vanilla JavaScript. This gave a clear distinction when opening/viewing files and as a bonus, youâ€™ll get proper JSX syntax highlighting in GitHub. However Facebook suggests not using the .jsx extension, so Iâ€™ve recently been using just .js and Iâ€™m glad I didnâ€™t waste too much time weighing the pros and cons because it makes zero difference to me. I recommend flipping a coin to decide. Index files for utilsAs a result of writing this article, and really thinking about what matters to me, I have actually made a change to one small aspect of my personal preference for app structure. I used to create an index.js file for my utils, like so: So that I could import multiple utilities in one go like this: So neat! Whenever I added a new util (0.8 times per week) I would simply add the util file and a new entry in the index file. Whenever I saw a PR that added a util and forgot to add it to index.js I would remind the developer to add that in. I would also occasionally discover utilities that werenâ€™t in index.js, so would have to add them myself. Such an elegant solution. For some reason it took until September 2017 for me to realise that this only added complexity. And that actually ditching the index.js and doing this was better: Itâ€™s fewer lines, one less file, and one less thing to explain to new developers. But those long import paths burn my eyes, so letâ€™s take a look at a couple of solutions. There are two of them, as is often the case with couples. Solution one is to use Webpackâ€™s alias resolving to refer to my utils directory without a relative path. Here Iâ€™ve mapped Utils to src/app/utils; the result is pretty, and aligns nicely with the way I import other utilities. Capital â€˜Uâ€™ by convention to differentiate it from npm packages In the olden days this would confuse some text editors because they wouldnâ€™t know what or where Utils/formatDate was. My IDE is clever and reads my Webpack config (it actually runs webpack under the hood), and makes the connection to the correct file (so I can jump to source, get autocomplete, etc). (The theme continues: the tools we use and the way we use them should most definitely be taken into account when thinking about how to structure our apps.) Soâ€¦ itâ€™s a beautiful, neat, solution. But whatâ€™s behind the scenes? This is a nice solution but it has two negative impacts. It adds complexity. We now have more moving parts to achieve the exact same outcome. It reduces clarity. Someone unfamiliar with your Webpack config canâ€™t look at an import statement and know what itâ€™s referring to. The second solution is to convince myself that I donâ€™t care about the dots and leave them as they are. To convince myself, I thought about how often I type out an import path, and as it turns out itâ€™s exactly as often as I make coffee. Then I thought about how really, itâ€™s not so hard to type eight dots and five slashes, compared to the time it takes to put the little coffee pod in the machine, measure out a teaspoon of sugar into a cup, milk the cow just a little bit (shout out to Daisy) and press the picture of a cup. The trade-offs between these two options are representative of many different decisions (in life, and in programming), so this feels like a good time to debut my clarity/obscurity-simplicity/complexity matrix. ClObSiCo for short For me, the decision between these two is a close call. In the end though, I will favour clarity and simplicity wherever possible, so even though having ../../../../ in an import statement is an eyesore, it is the clear and simple winner. Index files for componentsItâ€™s not my cup of tea, but another thing you might like to do in the battle against the import dots is to create a library for your components. Maybe this gets your motor running: You already know how to do this in your Webpack config: Then in your components directory add an index.js file with a row for each component like so: Boom. n exports per fileHaving one export per file â€” where the thing being exported and the filename are the same â€” works a lot of the time and I think is a good general rule for components and utility functions. But I donâ€™t think this works for constants. I also like to start with a single file for all action creators, until it becomes a burden. Same for reducers. In my experience it doesnâ€™t make much difference whether you have eight, 10-line reducers in a single file or eight different files. If you think it has a significant impact on how quickly you can locate a particular piece of code, then do what works for you. Heck, maybe Redux ducks make your boat float. Sure, whatever. What works for the teamNow seems like a good time to explain the title of this post. If youâ€™re working on a project that is just you, then you might be able to find a React structure that is 100% correct, for you. In fact I think itâ€™s well worth aiming for this. But the more people there are on a team, the less likely it is that youâ€™ll find something â€˜optimalâ€™, and the more likely other factors will come into play. The big one is compromise. Be aware of distinction bias. You can probably tell from the above that for some items I would be happy to go another way if a team member expressed a strong preference. If someone really wanted to use .jsx extensions or have a Utils alias, Iâ€™d be cool with that because although itâ€™s not my preference, it wonâ€™t reduce my ability to work quickly. But if someone really really wanted every damn file to be named index.js then itâ€™d be on like Donkey Kong. Another consideration: if you have, say, 30 developers on a team and youâ€™re starting a new project, you might want to structure it as closely to previous projects as possible, no use reinventing the wheel. Or maybe youâ€™ll want to learn from past mistakes and have a different structure, fix that badly-invented wheel. Another little thing: as your team gets bigger, git conflicts will become a bigger part of your day, and erring on the side of smaller files will be a benefit. If you have a mixture of skill levels on the team, that should encourage you to favour simplicity and clarity. On the flip side, if you have a team of seasoned front end engineers (mmm, seasoned), then go nuts and make it as complex as you like. As long as everyone is on the same wavelength, it doesnâ€™t matter how weird it looks from the outside. SummaryI have a confession to make. I always struggle with summaries. Itâ€™s like, I just wrote you a whole blog post, what more do you want from me! So itâ€™s not a summary, but I think the most interesting aspect of all the different approaches to application structure is the way people deal with disagreements. Thereâ€™s a whole class of internet comments that can be summarised as â€œI disagree and that makes me ANGRYâ€. Which is a pity, because when two reasonable people disagree, thereâ€™s very often something interesting going on, just waiting to be discovered. And since Iâ€™m already doing a terrible job of wrapping this up, how about a movie recommendation? If you liked District 9, and havenâ€™t watched Chappie yet, then watching Chappie is something you should immediately go and do. Thanks for reading. Bye!","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"LÃ m tháº¿ nÃ o Ä‘á»ƒ tá»• chá»©c tá»‘t hÆ¡n nhá»¯ng á»©ng dá»¥ng React","slug":"Lam-the-nao-de-to-chuc-tot-hon-nhung-ung-dung-React","date":"2017-11-13T16:48:00.000Z","updated":"2017-11-13T16:49:59.849Z","comments":true,"path":"2017/11/Lam-the-nao-de-to-chuc-tot-hon-nhung-ung-dung-React.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Lam-the-nao-de-to-chuc-tot-hon-nhung-ung-dung-React.html","excerpt":"Iâ€™ve been working on very large web applications for the past few years, starting from ground zero and, with a dozen other developers, making them scale up to now be used by millions of people. And sometimes, if you didnâ€™t start with a good architecture, it can become difficult to keep your code organized. Nathanael Beisiegel wrote an interesting article where he explains his strategy in the organization of large React applications, but I still wasnâ€™t completely satisfied by his approach. So I decided to spend some time to figure out what could be the best way to organize my future React projects.","text":"Iâ€™ve been working on very large web applications for the past few years, starting from ground zero and, with a dozen other developers, making them scale up to now be used by millions of people. And sometimes, if you didnâ€™t start with a good architecture, it can become difficult to keep your code organized. Nathanael Beisiegel wrote an interesting article where he explains his strategy in the organization of large React applications, but I still wasnâ€™t completely satisfied by his approach. So I decided to spend some time to figure out what could be the best way to organize my future React projects.Note: I use Redux files in all the examples of this article. If you donâ€™t know what Redux is, you can have a look to the documentation here. Note2: All examples are based on ReactJS, but you can use exactly the same structure for a React-Native application. What are the challenges when you build an application?This has happened or will happen to pretty much all developers over the course of their career: You build an application for a client with a team of a few developers, everything works very well all together. Your client requires new features, fine, you add them. Your client asks you to remove some features and add new ones, it starts to get complicated, you didnâ€™t think about that, but you make it work even though itâ€™s not perfect. Your client now wants you to change another feature, remove some others and add another one that wasnâ€™t expected. At that point, you grab the scotch tape and start patching some code. You are not really proud of it but it works. 6 months later, after some other iterations, the code of the application gets really complicated to read and understand, everything looks like some Italian spaghetti pasta. Until the day your client decides to create a new version of the application, with some fresh new code and features. In some cases, you end-up keeping complicated legacy code that lives with the new code, and this becomes even harder to maintain. And all of this happened because your app wasnâ€™t properly designed from the beginning. When I started to learn React, I found a few very good articles explaining how to create Todo lists or very simple games. Those articles were very useful to understand the basics of React, but I quickly got to a point where I wasnâ€™t able to find much about how I could use React to build actual applications, something with a few dozens pages and hundreds of components. After some research, I learned that every React boilerplate project on Github results to similar structures, they organize all the files by type. This might look familiar to you: 12345678910111213141516171819202122232425262728293031/src /actions /notifications.js /components /Header /Footer /Notifications /index.js /containers /Home /Login /Notifications /index.js /images /logo.png /reducers /login.js /notifications.js /styles /app.scss /header.scss /home.scss /footer.scss /notifications.scss /utils index.js This architecture might be okay to build your website or application, but I believe that it is not the best architecture. When you organize your files by type, as your application grows, it often becomes difficult to maintain. By the time you realize this, itâ€™s too late and you will have to invest a lot of time and money to change everything, or to support what you have for the next few years. The good thing with React is that you can structure your application in any way you like. You are not forced to follow a certain folder structure, React is simply a javascript library. What could be a better approach to organize your application?For a couple of years I worked for a financial institution which used Ember as their main javascript framework to build all their new web applications. One interesting thing about Ember is the ability to structure your project by features, instead of by type. And this changes everything. Pods in Ember are great but still limited, and I wanted something much more flexible. After a few experiments, trying to find what would be the best structure, I got to a point where I decided to group all related features together, and nest them as needed. This is what I use now: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546/src /components /Button /Notifications /components /ButtonDismiss /images /locales /specs /index.js /styles.scss /index.js /styles.scss /scenes /Home /components /ButtonLike /services /processData /index.js /styles.scss /Sign /components /FormField /scenes /Login /Register /locales /specs /index.js /styles.scss /services /api /geolocation /session /actions.js /index.js /reducer.js /users /actions.js /api.js /reducer.js index.js store.js Each component, scene or service (a feature) has everything it needs to work on its own, such as its own styles, images, translations, set of actions as well as unit or integration tests. You can see a feature like an independent piece of code you will use in your app (a bit like node modules). To work properly, they should follow these rules: A component can define nested components or services. It cannot use or define scenes. A scene can define nested components, scenes or services. A service can define nested services. It cannot use or define components or scenes. Nested features can only use from its parent. Note: By parent feature, I mean a parent, grandparent, great-grandparent etcâ€¦ You cannot use a feature that is a â€œcousinâ€, this is not allowed. You will need to move it to a parent to use it. Letâ€™s break this down. ComponentsYou all already know what a component is, but one important thing in this organization is the ability to nest a component into another component. Components defined at the root level of your project, in the components folder, are global and can be used anywhere in your application. But if you decide to define a new component inside another component (nesting), this new component can only be used its direct parent. Why would you want to do that? When you develop a large application, it happens quite often that you need to create a component that you definitively know you wonâ€™t reuse anywhere else, but you need it. If you add it at the root level of your components folder, it will get lost with hundreds of components. Sure, you could categorize them, but when itâ€™s time to do some clean-up, you wonâ€™t remember what they are all for or if they are still being used somewhere. Although, if you define at the root level only the main components of your application, such as buttons, form fields, thumbnails, but also more complicated one like listComments, formComposer with their own children components, it gets much easier to find what you need. Example: 1234567891011/src /components /Button /index.js /Notifications /components /ButtonDismiss /index.js /actions.js /index.js /reducer.js Button can be used anywhere in your application. Notifications can also be used anywhere. This component defines a component ButtonDismiss. You cannot use ButtonDismiss anywhere else than in the Notifications component. ButtonDismiss uses Button internally, this is authorized because Button is defined at the root level of components. ScenesA scene is a page of your application. You can see a scene just like any component, but I like to separate them into their own folder. If you use React-Router or React Native Router, you can import all your scenes in your main index.js file and setup your routes. With the same principle components can be nested, you can also nest a scene into a scene, and also define components or services into a scene. You have to remember that if you decide to define something into a scene, you can only use it within the scene folder itself. Example: 12345678910111213141516171819202122232425/src /scenes /Home /components /ButtonShare /index.js /index.js /Sign /components /ButtonHelp /index.js /scenes /Login /components /Form /index.js /ButtonFacebookLogin /index.js /index.js /Register /index.js /index.js Home has a component ButtonShare, it can only be used by the Home scene. Sign has a component ButtonHelp. This component can be used by Login or Register scenes, or by any components defined in those scenes. Form component uses ButtonHelp internally, this is authorized because ButtonHelp is defined by a parent. The Register scene cannot use any of the components defined in Login, but it can use the ButtonHelp. ServicesNot everything can be a component, and you will need to create independent modules that can be used by your components or scenes. You can see a service like a self-contained module where you will define the core business logic of your application. This can eventually be shared between several scenes or even applications, such as a web and native version of you app. 1234567891011/src /services /api /services /handleError /index.js /index.js /geolocation /session /actions.js /index.js /reducer.js I recommend you to create services to manage all api requests. You can see them as a bridge/an adapter between the server API and the view layer (scenes and components) of your application. It can take care of network calls your app will make, get and post content, and transform payloads as needed before being sent or saved in the store of your app (such as Redux). The scenes and components will only dispatch actions, read the store and update themselves based on the new changes. Wrapping upIâ€™ve been working with this architecture for the past few months on a personal project built with React-Native, and I can tell you this saved me a lot of time. Itâ€™s much more simpler to have all related entities grouped together, it makes things easier to work with. This architecture is one of many other ways to organize your project, thatâ€™s the way I like it now and I hope this will help you improve yours! If you are interested to see working projects, I have a few on my Github account that follows this architecture: https://github.com/alexmngn/react-rock-paper-scissors (ReactJS) https://github.com/alexmngn/react-native-authentication (React-Native) Feel free to add a comment below or contact me directly if you have any question, Iâ€™ll be more than happy to help. Have fun!","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"LÃ m tháº¿ nÃ o Ä‘á»ƒ cáº¥u trÃºc cÃ¡c components trong React? ","slug":"Lam-the-nao-de-cau-truc-cac-components-trong-React","date":"2017-11-13T16:41:33.000Z","updated":"2017-11-13T16:46:09.489Z","comments":true,"path":"2017/11/Lam-the-nao-de-cau-truc-cac-components-trong-React.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Lam-the-nao-de-cau-truc-cac-components-trong-React.html","excerpt":"Programming is quite a complex task. Especially crafting clean code is hard. We need to take care of many elements â€” naming variables, scoping functions, handling errors, ensuring security, monitoring performance etc. Still to name single most difficult thing in programming I would go with writing loosely coupled &amp; highly cohesive components. It doesnâ€™t matter if weâ€™re talking about object-oriented or functional programming. Structuring system is the hardest thing and it has a big impact on the overall project. It takes years to become proficient in designing software architecture (&amp; probably one can never really master it â€” in such a fast moving industry mastery is always one step ahead, there is always a way to improve design).","text":"Programming is quite a complex task. Especially crafting clean code is hard. We need to take care of many elements â€” naming variables, scoping functions, handling errors, ensuring security, monitoring performance etc. Still to name single most difficult thing in programming I would go with writing loosely coupled &amp; highly cohesive components. It doesnâ€™t matter if weâ€™re talking about object-oriented or functional programming. Structuring system is the hardest thing and it has a big impact on the overall project. It takes years to become proficient in designing software architecture (&amp; probably one can never really master it â€” in such a fast moving industry mastery is always one step ahead, there is always a way to improve design). I really enjoy working with React &amp; I think its biggest advantage is how simple React is. There is a difference between simple &amp; easy https://www.infoq.com/presentations/Simple-Made-Easy. And I really mean React is simple. Of course, you need to spend some time to get to know it. But after you understand core concepts, everything else is just a consequence. The hard part comes next. Coupling &amp; CohesionThose are the metrics that more or less describe how difficult it will be to change the behaviour of the code. Coupling &amp; cohesion are used in object-oriented programming and refer to some form of classes. Weâ€™ll use them in reference to React components since the same rules apply. Coupling is connection or dependency between elements. If changing one element requires changing another element then we say there is tight coupling. If elements are loosely coupled, changing one element does not imply changes in the other. For example, letâ€™s take a look at displaying bank transfer amount. If displaying amount knows how rates are calculated, then anytime internal structure of transfer changes, displaying code also needs to be updated. If we design system to be loosely coupled, based on the interface of an element, then changes to transfer shouldnâ€™t result in changes to the view layer. Loosely coupled components are easier to manage and maintain. Cohesion tells if elementâ€™s responsibilities form one thing. That metric is connected with Single Responsibility Principle or Unix principle: Do one thing and do it well. If account balance formatter also calculates interest rates and checks the permission to display history, then it has many responsibilities and those are not related to each other. Probably, there should be different components for permission handling or interest rates. On the other hand, if there are multiple components one for integer part, one for floating and one for currency, then anytime programmer wants to display balance, they would need to find all elements. The challenge is to create highly cohesive components. Structuring componentsThere are many ways we can structure components. We want components to be reusable, but only to the degree that is reasonable. We want to build small components that can be used to build bigger concepts. Ideally, we want to build loosely coupled &amp; highly cohesive components, so our system is easier to maintain and grow. In React components props can be treated like function arguments and thatâ€™s exactly the case for functional stateless components. How we define props in a component, defines how a component can be reused. Weâ€™ll use expense manager domain and weâ€™ll analyze expense details formatter. Letâ€™s suppose that expense model looks like this: There are several possibilities to model expense details formatter: no props at all passing expense object passing only required properties passing map of properties passing format as a child Weâ€™ll discuss each of them to see what are benefits and flaws of using each and every. Keep in mind that context is the king and everything depends on the system. Thatâ€™s exactly what weâ€™re paid for â€” building proper abstraction. No props at allThe simplest solution &amp; the one that is often the starting point is building a component with hard-coded data. Passing no props, of course, doesnâ€™t give us any flexibility and component is suitable to be used only in single place. Of course, in the example of expense details, we can see from the beginning that component needs to accept some props. Nevertheless, there are cases that components without any props is good solution. Firstly, we can use components without props for â€œconstantâ€ content like badges, logos, company info etc. Building even small components makes a system more maintainable. Keeping information in one place allows making changes in one place. Donâ€™t repeat yourself. Passing expense objectIn case of expense details definitely, we need to pass data to the component. First, weâ€™ll take a look at passing expense object. Passing expense object to expense details component makes perfect sense. Expense details formatter is highly coherent -&gt; it displays data of expense. Whenever we want to change formatting, this is the only place thatâ€™s going to change. Also changing expense details formatter does not introduce any side effects to expense object itself. The component is tightly coupled to expense object. Is that a bad thing? Definitely not, but we must be aware how that influences our system. Passing expense object as props, results that expense details component relies on the internal structure of expense. Whenever we change the internal structure of expense, weâ€™ll also need to change expense details. Of course, weâ€™ll only need to make changes in one place. How does that design affect future changes? If we want to add, change or remove a field, weâ€™ll only need to change one component. What if we want to add different date formatters? We could add another prop for date formatting. We start adding additional properties to make the component more flexible. As long as there are only a few options, everything is great. The problem starts after system grows and we have a lot of props for different use cases. 1const ExpenseDetails = (&#123; expense, dateFormat, withCurrency, currencyFormat, isOverdue, isPaid ... &#125;) Adding props makes the component more reusable, but it can also be a sign that there are multiple responsibilities of the component. The same rule applies to the function. We can create a function with a number of parameters, but as soon as that number is greater than 3â€“4, it starts to do a lot of things. And probably thatâ€™s the time to split function into smaller one. As number of component props grow, we can decide to split component into more defined ones like: OverdueExpenseDetails, PaidExpenseDetails etc. Passing only required propertiesTo be less coupled with expense object itself, we can pass only required properties. Weâ€™re passing each and every property separately, so weâ€™re moving the responsibility a bit to one who is using component. If internal structure of expense changes, itâ€™s not affecting expense details formatter itself -&gt; but probably it can affect every place that is using component because props need to be changed. When passing props as separate properties, a component is more abstract. How passing only required fields affect future design? Adding/updating/removing fields is not easy now. Whenever we want to add a field, we not only need to change the implementation of expense details but also change every place where component is used :( 1const ExpenseDetails = (&#123; category, description, amount, date, account, comment, case ... &#125;) =&gt; ( ... ) On the other hand, supporting multiple date formatting is done almost out-of-the-box. Since weâ€™re passing date as a prop, we can pass formatted date. Deciding how to display particular field is in the hands of the one who uses the component. That is no longer the case of expense details component implementation. Passing map/array of propertiesGoing even more abstract, we could pass a map of properties. The one who uses component is in control over formatting expense details. The object passed to the component has to be properly formatted. That solution has many flaws. We have very little control over how the component will look. The order of reduce is not specified, so weâ€™ll need to add some kind of order. Instead of a map, we could pass an array with objects to overcome that problem, but it still will have drawbacks. Passing map/array as props is not coupled to expense at all but is also not coherent at all. Adding/removing new properties is only a matter of changing prop, but we have no control over the formatting of the component itself. If we want to change only the formatting of the category, itâ€™s not possible it this solution. (To be precise, there is always a way to tweak stuff. For example by passing another props with formatting config. Yet that solution is no longer clean and straightforward.) Passing format as a childWe could also take as little responsibility as possible and pass data as a child. In that case, expense details is only a container to provide some structure and styling. To display details the one using component has to provide all information. Probably in case of expense details, itâ€™s not a good solution, since weâ€™ll need to repeat a lot. Still, flexibility is huge and there are a lot of different formatting possibilities. Adding/removing/updating fields is only a matter of changing the use of the component. The same goes with date formatting. We lose coherence, but thatâ€™s the price we had to pay. Context is the kingAs you can see, weâ€™re exchanging different advantages and possibilities. Which one is the best? It depends on: on project itself on stage of project on the component â€” do we want more specific components or few with options on oneâ€™s preferences on requirements â€” is that component supposed to change frequently &amp; used frequently There is no single good solution. One size doesnâ€™t fit all. How we structure our components has a great impact on how weâ€™ll maintain a system and how expandable it will be. It all depends on the context. Thankfully we have plenty of options and we can pick and choose. Components are a great abstraction to build both small and big systems. Itâ€™s only a case of picking right solution.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a JavaScript: Quáº£n lÃ½ bá»™ nhá»› + 4 cÃ¡ch xá»­ lÃ½ memoryÂ leaks thÃ´ng dá»¥ng","slug":"Cach-hoat-dong-cua-JavaScript-Quan-ly-bo-nho-4-cach-xu-ly-memory-leaks-thong-dung","date":"2017-11-13T16:26:26.000Z","updated":"2017-11-13T16:31:14.306Z","comments":true,"path":"2017/11/Cach-hoat-dong-cua-JavaScript-Quan-ly-bo-nho-4-cach-xu-ly-memory-leaks-thong-dung.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Cach-hoat-dong-cua-JavaScript-Quan-ly-bo-nho-4-cach-xu-ly-memory-leaks-thong-dung.html","excerpt":"A few weeks ago we started a series aimed at digging deeper into JavaScript and how it actually works: we thought that by knowing the building blocks of JavaScript and how they come to play together youâ€™ll be able to write better code and apps. The first post of the series focused on providing an overview of the engine, the runtime, and the call stack. ThĞµ second post examined closely the internal parts of Googleâ€™s V8 JavaScript engine and also provided a few tips on how to write better JavaScript code.","text":"A few weeks ago we started a series aimed at digging deeper into JavaScript and how it actually works: we thought that by knowing the building blocks of JavaScript and how they come to play together youâ€™ll be able to write better code and apps. The first post of the series focused on providing an overview of the engine, the runtime, and the call stack. ThĞµ second post examined closely the internal parts of Googleâ€™s V8 JavaScript engine and also provided a few tips on how to write better JavaScript code.In this third post, weâ€™ll discuss another critical topic thatâ€™s getting ever more neglected by developers due to the increasing maturity and complexity of programming languages that are being used on a daily basis â€” memory management. Weâ€™ll also provide a few tips on how to handle memory leaks in JavaScript that we at SessionStack follow as we need to make sure SessionStack causes no memory leaks or doesnâ€™t increase the memory consumption of the web app in which we are integrated. OverviewLanguages, like C, have low-level memory management primitives such as malloc() and free(). These primitives are used by the developer to explicitly allocate and free memory from and to the operating system. At the same time, JavaScript allocates memory when things (objects, strings, etc.) are created and â€œautomaticallyâ€ frees it up when they are not used anymore, a process called garbage collection. This seemingly â€œautomaticalâ€ nature of freeing up resources is a source of confusion and gives JavaScript (and other high-level-language) developers the false impression they can choose not to care about memory management. This is a big mistake. Even when working with high-level languages, developers should have an understanding of memory management (or at least the basics). Sometimes there are issues with the automatic memory management (such as bugs or implementation limitations in the garbage collectors, etc.) which developers have to understand in order to handle them properly (or to find a proper workaround, with a minimum trade off and code debt). Memory life cycleNo matter what programming language youâ€™re using, memory life cycle is pretty much always the same: Here is an overview of what happens at each step of the cycle: Allocate memory â€” memory is allocated by the operating system which allows your program to use it. In low-level languages (e.g. C) this is an explicit operation that you as a developer should handle. In high-level languages, however, this is taken care of for you. Use memory â€” this is the time when your program actually makes use of the previously allocated memory. Read and write operations are taking place as youâ€™re using the allocated variables in your code. Release memory â€” now is the time to release the entire memory that you donâ€™t need so that it can become free and available again. As with the Allocate memory operation, this one is explicit in low-level languages. For a quick overview of the concepts of the call stack and the memory heap, you can read our first post on the topic. What is memory?Before jumping straight to memory in JavaScript, weâ€™ll briefly discuss what memory is in general and how it works in a nutshell. On a hardware level, computer memory consists of a large number offlip flops. Each flip flop contains a few transistors and is capable of storing one bit. Individual flip flops are addressable by a unique identifier, so we can read and overwrite them. Thus, conceptually, we can think of our entire computer memory as a just one giant array of bits that we can read and write. Since as humans, we are not that good at doing all of our thinking and arithmetic in bits, we organize them into larger groups, which together can be used to represent numbers. 8 bits are called 1 byte. Beyond bytes, there are words (which are sometimes 16, sometimes 32 bits). A lot of things are stored in this memory: All variables and other data used by all programs. The programsâ€™ code, including the operating systemâ€™s. The compiler and the operating system work together to take care of most of the memory management for you, but we recommend that you take a look at whatâ€™s going on under the hood. When you compile your code, the compiler can examine primitive data types and calculate ahead of time how much memory they will need. The required amount is then allocated to the program in the call stack space. The space in which these variables are allocated is called the stack space because as functions get called, their memory gets added on top of the existing memory. As they terminate, they are removed in a LIFO (last-in, first-out) order. For example, consider the following declarations: 123int n; // 4 bytesint x[4]; // array of 4 elements, each 4 bytesdouble m; // 8 bytes The compiler can immediately see that the code requires4 + 4 Ã— 4 + 8 = 28 bytes. Thatâ€™s how it works with the current sizes for integers and doubles. About 20 years ago, integers were typically 2 bytes, and double 4 bytes. Your code should never have to depend on what is at this moment the size of the basic data types. The compiler will insert code that will interact with the operating system to request the necessary number of bytes on the stack for your variables to be stored. In the example above, the compiler knows the exact memory address of each variable. In fact, whenever we write to the variable n, this gets translated into something like â€œmemory address 4127963â€ internally. Notice that if we attempted to access x[4] here, we would have accessed the data associated with m . Thatâ€™s because weâ€™re accessing an element in the array that doesnâ€™t exist â€” itâ€™s 4 bytes further than the last actual allocated element in the array which is x[3], and may end up reading (or overwriting) some of mâ€™s bits. This would almost certainly have very undesired consequences for the rest of the program. When functions call other functions, each gets its own chunk of the stack when it is called. It keeps all its local variables there, but also a program counter that remembers where in its execution it was. When the function finishes, its memory block is once again made available for other purposes. Dynamic allocationUnfortunately, things arenâ€™t quite as easy when we donâ€™t know at compile time how much memory a variable will need. Suppose we want to do something like the following: 123int n = readInput(); // reads input from the user...// create an array with \"n\" elements Here, at compile time, the compiler does not know how much memory the array will need because it is determined by the value provided by the user. It, therefore, cannot allocate room for a variable on the stack. Instead, our program needs to explicitly ask the operating system for the right amount of space at run-time. This memory is assigned from the heap space. The difference between static and dynamic memory allocation is summarized in the following table: Differences between statically and dynamically allocated memory To fully understand how dynamic memory allocation works, we need to spend more time on pointers, which might be a bit too much of a deviation from the topic of this post. If youâ€™re interested in learning more, just let me know in the comments and we can go into more details about pointers in a future post. Allocation in JavaScriptNow weâ€™ll explain how the first step (allocate memory) works in JavaScript. JavaScript relieves developers from the responsibility to handle memory allocations â€” JavaScript does it by itself, alongside declaring values. 1234567891011121314151617var n = 374; // allocates memory for a numbervar s = 'sessionstack'; // allocates memory for a string var o = &#123; a: 1, b: null&#125;; // allocates memory for an object and its contained valuesvar a = [1, null, 'str']; // (like object) allocates memory for the // array and its contained valuesfunction f(a) &#123; return a + 3;&#125; // allocates a function (which is a callable object)// function expressions also allocate an objectsomeElement.addEventListener('click', function() &#123; someElement.style.backgroundColor = 'blue';&#125;, false); Some function calls result in object allocation as well: 12var d = new Date(); // allocates a Date objectvar e = document.createElement('div'); // allocates a DOM element Methods can allocate new values or objects: 123456789var s1 = 'sessionstack';var s2 = s1.substr(0, 3); // s2 is a new string// Since strings are immutable, // JavaScript may decide to not allocate memory, // but just store the [0, 3] range.var a1 = ['str1', 'str2'];var a2 = ['str3', 'str4'];var a3 = a1.concat(a2); // new array with 4 elements being// the concatenation of a1 and a2 elements Using memory in JavaScriptUsing the allocated memory in JavaScript basically, means reading and writing in it. This can be done by reading or writing the value of a variable or an object property or even passing an argument to a function. Release when the memory is not needed anymoreMost of the memory management issues come at this stage. The hardest task here is to figure out when the allocated memory is not needed any longer. It often requires the developer to determine where in the program such piece of memory is not needed anymore and free it. High-level languages embed a piece of software called garbage collector which job is to track memory allocation and use in order to find when a piece of allocated memory is not needed any longer in which case, it will automatically free it. Unfortunately, this process is an approximation since the general problem of knowing whether some piece of memory is needed is undecidable (canâ€™t be solved by an algorithm). Most garbage collectors work by collecting memory which can no longer be accessed, e.g. all variables pointing to it went out of scope. Thatâ€™s, however, an under-approximation of the set of memory spaces that can be collected, because at any point a memory location may still have a variable pointing to it in scope, yet it will never be accessed again. Garbage collectionDue to the fact that finding whether some memory is â€œnot needed anymoreâ€ is undecidable, garbage collections implement a restriction of a solution to the general problem. This section will explain the necessary notions to understand the main garbage collection algorithms and their limitations. Memory referencesThe main concept garbage collection algorithms rely on is the one of reference. Within the context of memory management, an object is said to reference another object if the former has an access to the latter (can be implicit or explicit). For instance, a JavaScript object has a reference to its prototype (implicit reference) and to its propertiesâ€™ values (explicit reference). In this context, the idea of an â€œobjectâ€ is extended to something broader than regular JavaScript objects and also contains function scopes (or the global lexical scope). Lexical Scoping defines how variable names are resolved in nested functions: inner functions contain the scope of parent functions even if the parent function has returned. Reference-counting garbage collectionThis is the simplest garbage collection algorithm. An object is considered â€œgarbage collectibleâ€ if there are zero references pointing to it. Take a look at the following code: 1234567891011121314151617181920212223242526272829var o1 = &#123; o2: &#123; x: 1 &#125;&#125;;// 2 objects are created. // 'o2' is referenced by 'o1' object as one of its properties.// None can be garbage-collected var o3 = o1; // the 'o3' variable is the second thing that // has a reference to the object pointed by 'o1'. o1 = 1; // now, the object that was originally in 'o1' has a // single reference, embodied by the 'o3' variablevar o4 = o3.o2; // reference to 'o2' property of the object. // This object has now 2 references: one as // a property. // The other as the 'o4' variableo3 = '374'; // The object that was originally in 'o1' has now zero // references to it. // It can be garbage-collected. // However, what was its 'o2' property is still // referenced by the 'o4' variable, so it cannot be // freed.o4 = null; // what was the 'o2' property of the object originally in // 'o1' has zero references to it. // It can be garbage collected. Cycles are creating problemsThere is a limitation when it comes to cycles. In the following example, two objects are created and reference one another, thus creating a cycle. They will go out of scope after the function call, so they are effectively useless and could be freed. However, the reference-counting algorithm considers that since each of the two objects is referenced at least once, neither can be garbage-collected. 12345678function f() &#123; var o1 = &#123;&#125;; var o2 = &#123;&#125;; o1.p = o2; // o1 references o2 o2.p = o1; // o2 references o1\\. This creates a cycle.&#125;f(); Mark-and-sweep algorithmIn order to decide whether an object is needed, this algorithm determines whether the object is reachable. The Mark-and-sweep algorithm goes through these 3 steps: Roots: In general, roots are global variables which get referenced in the code. In JavaScript for example, a global variable that can act as a root is the â€œwindowâ€ object. The identical object in Node.js is called â€œglobalâ€. A complete list of all roots gets built by the garbage collector. The algorithm then inspects all roots and their children and marks them as active (meaning, they are not garbage). Anything that a root cannot reach will be marked as garbage. Finally, the garbage collector frees all memory pieces that are not marked as active and returns that memory to the OS. A visualization of the mark and sweep algorithm in action This algorithm is better than the previous one since â€œan object has zero referenceâ€ leads to this object being unreachable. The opposite is not true as we have seen with cycles. As of 2012, all modern browsers ship a mark-and-sweep garbage-collector. All improvements made in the field of JavaScript garbage collection (generational/incremental/concurrent/parallel garbage collection) over the last years are implementation improvements of this algorithm (mark-and-sweep), but not improvements over the garbage collection algorithm itself, nor its goal of deciding whether an object is reachable or not. In this article, you can read in a greater detail about tracing garbage collection that also covers mark-and-sweep along with its optimizations. Cycles are not a problem anymoreIn the first example above, after the function call returns, the two objects are not referenced anymore by something reachable from the global object. Consequently, they will be found unreachable by the garbage collector. Even though there are references between the objects, theyâ€™re not reachable from the root. Counter intuitive behavior of Garbage CollectorsAlthough Garbage Collectors are convenient they come with their own set of trade-offs. One of them is non-determinism. In other words, GCs are unpredictable. You canâ€™t really tell when a collection will be performed. This means that in some cases programs use more memory that itâ€™s actually required. In other cases, short-pauses may be noticeable in particularly sensitive applications. Although non-determinism means one cannot be certain when a collection will be performed, most GC implementations share the common pattern of doing collection passes during allocation. If no allocations are performed, most GCs stay idle. Consider the following scenario: A sizable set of allocations is performed. Most of these elements (or all of them) are marked as unreachable (suppose we null a reference pointing to a cache we no longer need). No further allocations are performed. In this scenario, most GCs will not run any further collection passes. In other words, even though there are unreachable references available for collection, these are not claimed by the collector. These are not strictly leaks but still, result in higher-than-usual memory usage. What are memory leaks?Just like the memory suggests, memory leaks are pieces of memory that the application have used in the past but is not needed any longer but has not yet been return back to the OS or the pool of free memory. Programming languages favor different ways of managing memory. However, whether a certain piece of memory is used or not is actually an undecidable problem. In other words, only developers can make it clear whether a piece of memory can be returned to the operating system or not. Certain programming languages provide features that help developers do this. Others expect developers to be completely explicit about when a piece of memory is unused. Wikipedia has good articles on manual and automatic memory management. The four types of common JavaScript leaks1: Global variablesJavaScript handles undeclared variables in an interesting way: when a undeclared variable is referenced, a new variable gets created in the global object. In a browser, the global object would be window, which means that 123function foo(arg) &#123; bar = \"some text\";&#125; is the equivalent of: 123function foo(arg) &#123; window.bar = \"some text\";&#125; Letâ€™s say the purpose of bar is to only reference a variable in the foo function. A redundant global variable will be created, however, if you donâ€™t use var to declare it. In the above case, this wonâ€™t cause much harm. You can surely imagine a more damaging scenario though. You can also accidentally create a global variable using this: 12345function foo() &#123; this.var1 = \"potential accidental global\";&#125;// Foo called on its own, this points to the global object (window)// rather than being undefined.foo(); You can avoid all this by adding â€˜use strictâ€™; at the beginning of your JavaScript file which would switch on a much stricter mode of parsing JavaScript which prevents the unexpected creation of global variables. Unexpected globals is certainly an issue, however, more often than not your code would be infested with explicit global variables which by definition cannot be collected by the garbage collector. Special attention needs to be given to global variables used to temporarily store and process large bits of information. Use global variables to store data if you must but when you do, make sure to assign it as null or reassign it once you are done with it. 2: Timers or callbacks that are forgottenLetâ€™s take setInterval for example as itâ€™s often used in JavaScript. Libraries which provide observers and other instruments that accept callbacks usually make sure all references to the callbacks become unreachable once their instances are unreachable too. Still, the code below is not a rare find: 1234567var serverData = loadData();setInterval(function() &#123; var renderer = document.getElementById('renderer'); if(renderer) &#123; renderer.innerHTML = JSON.stringify(serverData); &#125;&#125;, 5000); //This will be executed every ~5 seconds. The snippet above shows the consequences of using timers that reference nodes or data thatâ€™s no longer needed. The renderer object may be replaced or removed at some point which would make the block encapsulated by the interval handler redundant. If this happens, neither the handler, nor its dependencies would be collected as the interval would need to be stopped first (remember, itâ€™s still active). It all boils down to the fact that serverData which surely stores and processes loads of data will not be collected either. When using observers, you need to make sure you make an explicit call to remove them once you are done with them (either the observer is not needed anymore, or the object will become unreachable). Luckily, most modern browsers would do the job for you: theyâ€™ll automatically collect the the observer handlers once the observed object becomes unreachable even if you forgot to remove the listener. In the past some browsers were unable to handle these cases (good old IE6). Still, though, itâ€™s in line with best practices to remove the observers once the object becomes obsolete. See the following example: 123456789101112131415var element = document.getElementById('launch-button');var counter = 0;function onClick(event) &#123; counter++; element.innerHtml = 'text ' + counter;&#125;element.addEventListener('click', onClick);// Do stuffelement.removeEventListener('click', onClick);element.parentNode.removeChild(element);// Now when element goes out of scope,// both element and onClick will be collected even in old browsers // that don't handle cycles well. You no longer need to call removeEventListener before making a node unreachable as modern browsers support garbage collectors that can detect these cycles and handle them appropriately. If you leverage the jQuery APIs (other libraries and frameworks support this too) you can also have the listeners removed before a node is made obsolete. The library would also make sure there are no memory leaks even when the application is running under older browser versions. 3: Closures A key aspect of JavaScript development are closures: an inner function that has access to the outer (enclosing) functionâ€™s variables. Due to the implementation details of the JavaScript runtime, it is possible to leak memory in the following way: 1234567891011121314151617var theThing = null;var replaceThing = function () &#123; var originalThing = theThing; var unused = function () &#123; if (originalThing) // a reference to 'originalThing' console.log(\"hi\"); &#125;; theThing = &#123; longStr: new Array(1000000).join('*'), someMethod: function () &#123; console.log(\"message\"); &#125; &#125;;&#125;;setInterval(replaceThing, 1000); Once replaceThing is called, theThing gets a new object which consists of a big array and a new closure (someMethod). Yet, originalThing is referenced by a closure thatâ€™s held by the unused variable (which is theThing variable from the previous call to replaceThing). The thing to remember is that once a scope for closures is created for closures in the same parent scope, the scope is shared. In this case, the scope created for the closure someMethod is shared with unused. unused has a reference to originalThing. Even though unused is never used, someMethod can be used through theThing outside of the scope of replaceThing (e.g. somewhere globally). And as someMethod shares the closure scope with unused, the reference unused has to originalThing forces it to stay active (the whole shared scope between the two closures). This prevents its collection. In the above example, the scope created for the closure someMethod is shared with unused, while unused references originalThing. someMethod can be used through theThing outside of the replaceThing scope, despite the fact that unused is never used. The fact that unused references originalThing requires that it remains active since someMethod shares the closure scope with unused. All this can result in a considerable memory leak. You can expect to see a spike in memory usage when the above snippet is run over and over again. Its size wonâ€™t shrink when the garbage collector runs. A linked list of closures is created (its root is theThing variable in this case), and each the closure scopes carries forward an indirect reference to the big array. This issue was found by the Meteor team and they have a great article that describes the issue in great detail. 4: Out of DOM referencesThere are cases in which developers store DOM nodes inside data structures. Suppose you want to rapidly update the contents of several rows in a table. If you store a reference to each DOM row in a dictionary or an array, there will be two references to the same DOM element: one in the DOM tree and another in the dictionary. If you decide to get rid of these rows, you need to remember to make both references unreachable. 123456789101112131415var elements = &#123; button: document.getElementById('button'), image: document.getElementById('image')&#125;;function doStuff() &#123; elements.image.src = 'http://example.com/image_name.png';&#125;function removeImage() &#123; // The image is a direct child of the body element. document.body.removeChild(document.getElementById('image')); // At this point, we still have a reference to #button in the //global elements object. In other words, the button element is //still in memory and cannot be collected by the GC.&#125; Thereâ€™s an additional consideration that has to be taken into account when it comes to references to inner or leaf nodes inside a DOM tree. If you keep a reference to a table cell (a tag) in your code and decide to remove the table from the DOM yet keep the reference to that particular cell, you can expect a major memory leak to follow. You might think that the garbage collector would free up everything but that cell. This will not be the case, however. Since the cell is a child node of the table and children keep references to their parents, this single reference to the table cell would keep the whole table in memory. We at SessionStack try to follow these best practices in writing code that handles memory allocation properly, and hereâ€™s why: Once you integrate SessionStack into your production web app, it starts recording everything: all DOM changes, user interactions, JavaScript exceptions, stack traces, failed network requests, debug messages, etc.With SessionStack, you replay issues in your web apps as videos and see everything that happened to your user. And all of this has to take place with no performance impact for your web app.Since the user can reload the page or navigate your app, all observers, interceptors, variable allocations, etc. have to be handled properly, so they donâ€™t cause any memory leaks or donâ€™t increase the memory consumption of the web app in which we are integrated. There is a free plan so you can give it a try now. Resources http://www-bcf.usc.edu/~dkempe/CS104/08-29.pdf https://blog.meteor.com/an-interesting-kind-of-javascript-memory-leak-8b47d2e7f156 http://www.nodesimplified.com/2017/08/javascript-memory-management-and.html https://auth0.com/blog/four-types-of-leaks-in-your-javascript-code-and-how-to-get-rid-of-them/","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Giáº£i thÃ­ch React Lifecycle - componentDidMakeSense","slug":"Giai-thich-React-Lifecycle-componentDidMakeSense","date":"2017-11-04T16:42:53.000Z","updated":"2017-11-04T16:45:48.181Z","comments":true,"path":"2017/11/Giai-thich-React-Lifecycle-componentDidMakeSense.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Giai-thich-React-Lifecycle-componentDidMakeSense.html","excerpt":"Learn the React lifecycle methods and when/how to use them React is incredible because it allows you to build your UI using a declarative API. You tell React what you want the interface to look like, and it handles the rest. As users interact with the application, the state changes which causes updates to the DOM. React provides a set of methods to seamlessly intercept the changes at any point during the updates and take control of the UI. The component lifecycle is typically one of the final pieces to truly mastering React, and this article will ensure that you have a firm grasp. The lifecycle of a component can be defined as the time from when the component is first being inserted into the DOM, the entire time the component is in the DOM, and the point when the component is being removed from the DOM. There is a unique lifecycle for every React component in your code.","text":"Learn the React lifecycle methods and when/how to use them React is incredible because it allows you to build your UI using a declarative API. You tell React what you want the interface to look like, and it handles the rest. As users interact with the application, the state changes which causes updates to the DOM. React provides a set of methods to seamlessly intercept the changes at any point during the updates and take control of the UI. The component lifecycle is typically one of the final pieces to truly mastering React, and this article will ensure that you have a firm grasp. The lifecycle of a component can be defined as the time from when the component is first being inserted into the DOM, the entire time the component is in the DOM, and the point when the component is being removed from the DOM. There is a unique lifecycle for every React component in your code. Check out gitconnected &gt;The community and network for developers and software engineers. Overview of the lifecycleThe lifecycle methods are hooks to allow you to read state changes and control UI updates. The lifecycle can be broken down into 3 categories: Mounting: The component is being added to the DOM. Updates: The component receives changes props or state and is called when the component is being re-rendered. Unmounting: The component is being removed from the DOM. The lifecycle methods provide entry points to take over any of these steps. Any method that begins with componentWill means you access it before the event occurs and any method prepended with componentDid means you capture it after the event occurs. Mounting constructor() componentWillMount() render() componentDidMount() Updating componentWillReceiveProps() shouldComponentUpdate() componentWillUpdate() render() componentDidUpdate() Unmounting componentWillUnmount() constructorThis method is called when your component is being created and before mounting (being added to the DOM). Its primary use is to initialize state and .bind(this) for the componentâ€™s methods. If you do neither of these, then there is no need for a constructor. componentWillMountThis method is executed right before a component is added to the DOM / render(). It is generally recommended that you use the constructor, but this method is still included in the API mostly for backwards compatibility. You should avoid calling any functions that cause side effects in this method as setState wonâ€™t trigger a change and there is no DOM to interact with. Note that this is also the only lifecycle method called on the server. componentDidMountYour component has now been rendered and exists in the DOM. This is the point when you should initiate AJAX requests, add event listeners, and perform any set up that requires a DOM. Calling setState during this method or any time after will cause a re-render. componentWillReceivePropsWhen your component receives new props from its parent, componentWillReceiveProps(nextProps) is triggered. This is a great time to check if there are changes in the incoming props when compared to your current props and trigger a state change based on the new values. A common use-case for this is resetting state based on a change. shouldComponentUpdateThis method exists purely for performance improvements. Renders and reconciliations are expensive in React. shouldComponentUpdate(nextProps, nextState) provides the developer the ability to return a boolean true/false from this method which controls whether React should perform the reconciliation operations and DOM updates. The default behavior is for React to render every update, which works in most cases. If shouldComponentUpdate() returns false, then componentWillUpdate(), render(), and componentDidUpdate() will not be invoked. componentWillUpdateReact invokes this method immediately before rendering when new props or state are being received. There is not much use for componentWillUpdate(nextProps, nextState) and should probably be avoided (similar to componentWillMount). You should not do anything that would change the state at this point â€” use componentWillReceiveProps if you need to do anything before a render. Note that this method is not called on the initial render. componentDidUpdateImmediately after React builds you a shiny new UI, componentDidUpdate(prevProps, prevState) is invoked. This is a great time to interact with the DOM or instantiate a new network request based on what the new interface should look like. componentWillUnmountYour component had a great life and now itâ€™s time for it to leave the UI. This is the moment to clean up everything that was associated with adding and maintaining your component while it was living on the UI. BONUS: componentDidCatchcomponentDidCatch(error, info) is a new lifecycle that was added in React 16. React was notorious for crashing the an entire application if a JavaScript error was thrown inside the React app. It corrupted Reactâ€™s internal state which blew up the app and yielded cryptic error messages. componentDidCatch solves this by catching any JavaScript error occurring in a componentâ€™s tree for the children of the component that implements the method. It is able to capture the error and display a fallback UI.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"HÆ°á»›ng dáº«n xÃ¢y dá»±ng á»©ng dá»¥ng React Redux CRUD","slug":"Huong-dan-xay-dung-ung-dung-React-Redux-CRUD","date":"2017-11-04T16:38:19.000Z","updated":"2017-11-04T16:40:27.398Z","comments":true,"path":"2017/11/Huong-dan-xay-dung-ung-dung-React-Redux-CRUD.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Huong-dan-xay-dung-ung-dung-React-Redux-CRUD.html","excerpt":"Building a single-page CRUD app using React and Redux can be challenging because youâ€™ll have to deal w/ new techniques and terms like â€œReducersâ€, â€œActionsâ€, â€œMiddlewaresâ€, â€œStoresâ€ and so on. Perhaps the trickiest part is making async requests and handling responses. While there are many examples, there is no well established pattern for making async requests and handling responses in Redux apps(just yet). In this blog Iâ€™ll provide a general approach on how to build a Blog app that has 3 pages and show navigate b/w them. Further, Iâ€™ll also establish a pattern for making async requests and handling four async states: â€œloadingâ€, â€œsuccessâ€, â€œerrorâ€ and â€œsuccess-and-navigateâ€. Source code: https://github.com/rajaraodv/react-redux-blog Letâ€™s get started.","text":"Building a single-page CRUD app using React and Redux can be challenging because youâ€™ll have to deal w/ new techniques and terms like â€œReducersâ€, â€œActionsâ€, â€œMiddlewaresâ€, â€œStoresâ€ and so on. Perhaps the trickiest part is making async requests and handling responses. While there are many examples, there is no well established pattern for making async requests and handling responses in Redux apps(just yet). In this blog Iâ€™ll provide a general approach on how to build a Blog app that has 3 pages and show navigate b/w them. Further, Iâ€™ll also establish a pattern for making async requests and handling four async states: â€œloadingâ€, â€œsuccessâ€, â€œerrorâ€ and â€œsuccess-and-navigateâ€. Source code: https://github.com/rajaraodv/react-redux-blog Letâ€™s get started. STEP 1 â€” Write Detailed Mocks For Each Page And Phases.In our app we have 3 pages: An Index page that shows a list of Posts, a Post details page and a New Post page. Each page has â€œSuccessâ€, â€œLoadingâ€ and â€œErrorâ€ phases because they all make AJAX calls to load/delete posts, so we need to mock those things as well. 1.1 Success Phase â€” Detailed Mocks when things are working Note: You can click on the pictures to Zoom and read 1.2 Loading Phase â€” Detailed Mocks when they are loading 1.3 Error Phase â€” Detailed Mocks when there is an Error STEP 2 â€” Divide Each Page Into ComponentsLook at all the phases of each page and roughly divide each page into components based on â€œpurposeâ€ and based on physical location. This helps you identify reusable components across different pages and also any additional ones in a specific phase. For example, you may need a â€œSpinnerâ€ or an â€œErrorâ€ component for different phases. Note: this doesnâ€™t need to be perfect. You can make changes later on. 2.1 â€” Success Phase: Divide Each Page Into Components Index page: 1. Shows list of posts, 2. Allows navigating to Post form page to create new post. So we end up w/ PostsList and Header components. Post details page: 1. Shows details of the post, 2. Allows navigating back to Index page 3. Index page. So we end up with PostDetails and Header components. 3. New Post page: 1. Allows creating posts and 2. allows navigating back to Index. Again we end up with PostForm and Header component. Notice that we can reuse Header across all 3 pages because of the physical location. So we end up with four components (instead of 6): 1. PostsList, 2. PostDetails 3. PostForm and 4. Header components. 2.2 â€” Loading Phase: Divide Each Page Into ComponentsIf you look at the mock, we are simply displaying â€œloading..â€ text in each page and not using some fancy spinner or â€œtoastâ€. So we donâ€™t have any more components. 2.3 â€” Error Phase: Divide Each Page Into ComponentsIf you look at the mock, we are simply throwing an alert popup and not using any custom modals. So we donâ€™t have any more components. So net-net, we have 4 components (1. PostsList, 2. PostDetails 3. PostForm and 4. Header) Redux Terms:Redux Terms â€” â€œActionsâ€ And â€œStatesâ€Every component does two things: 1. Listen to the user and server events and send them to JS functions. In Redux, events are represented as a JSON object called â€œActionsâ€. 1&#123;\"type\": \"FETCH_POST\", \"id\": 1234&#125; // &lt;-- Action 2. Render DOM based on some data. This data is called aâ€œstateâ€, which is also a JSON object. 1&#123;\"post\": &#123;\"id\": 1234, \"title\": \"My Redux Post\"&#125;&#125; // &lt;-- state Redux Terms â€” â€œAction Creatorsâ€These are functions that listen to DOM or server events and return formal JSON â€œActionâ€ object. 123456function fetchPost(id) &#123;return &#123; type: FETCH_POST, result: makeServerRequest(\"http://postsServer.com/api/id\") &#125;;&#125; See Action Creators for our app. Redux Terms â€” â€œDispatching an Actionâ€Redux provides a function called â€œdispatchâ€ which allows us to pass the â€œActionâ€ JSON object to all other components. Dispatching an Action means simply calling the dispatch function w/ the action JSON object. 1//Call the \"Action Creator\" w/ post's id and then use it's return //value (Action JSON object) to finally dispatch it to \"reducers\"dispatch(fetchPost(id)) or dispatch(&#123;type:\"FETCH_POST\", id:1234&#125;) The components calls Action creators to receive Actions and then dispatches the actions. Redux then send the actions to â€œReducersâ€ Redux Terms â€” â€œReducersâ€Reducers are functions that take an Action and the current state that was sent to them via â€œdispatchâ€, apply action to the current state and return a new state. And Redux re-renders all components whenever there is a new state. 1234//If the action is FETCH_POST_SUCCESS, return a new \"activePost\" //state w/ new post)case FETCH_POST_SUCCESS: return &#123;activePost: &#123;post: action.payload.data, error:null, loading: false&#125;&#125;; See Reducers â€œreducer_posts.jsâ€ and main â€œindex.jsâ€ (this combines multiple reducers into one) OK, before we go ahead to step 3, letâ€™s understand how to deal with Async Actions because every page makes AJAX calls. PATTERN: Dealing With Async ActionsIf component is loading an object(e.g. list of Posts) via AJAX call to the server, that objectâ€™s state should keep track of all the potential states. Initial state for such objects should look like: {objName: {obj:null, loading: false, error:null}}. Further, such components should dispatch up to 4 actions such as â€œFETCH_OBJâ€(for loading), â€œFETCH_OBJ_SUCCESSâ€, â€œFETCH_OBJ_FAILUREâ€ and â€œOBJ_RESETâ€(to cleanup dirty previous state). For example, if we are loading list of posts.. Note: You can click on the pictures to zoom and read Initial State: Initial state should look like, 1&#123;postsList:&#123;posts:[], loading:false, error:null&#125;&#125; Actions: FETCH_OBJ â€” Dispatch this to make the server request and also let other components know we are loading. This helps current/other components show â€œloadingâ€ or hide or do something. 1dispatch(&#123;â€œtypeâ€: â€œFETCH_POSTSâ€, loading: true&#125;) Once Redux gets this and passes it through reducers, the new state will look something like: 1&#123;postList: &#123;posts:null, error: null, loading: true&#125;&#125; 2. FETCH_OBJ_SUCCESS: Dispatch this when you get successful response. This is to show the actual data and also to cancel â€œloadingâ€ 1dispatch(&#123;\"type\": \"FETCH_POSTS_SUCCESS\", \"posts\":[post1, post2]) Once Redux gets this and passes it through reducers, the new state will look something like: 1&#123;postsList:&#123;posts:[post1, post2], error:null, loading: false&#125;&#125; 3.FETCH_OBJ_FAILURE: Dispatch this when you get a failed response. This is to show some error message and also to cancel â€œloadingâ€. 1dispatch(&#123;\"type\": \"FETCH_POSTS_FAILURE\", \"error\": \"Error message\"&#125;) Once Redux gets this and passes it through reducers, the new state will look something like: 1&#123;postList:&#123;posts:null, error:&#123;msg: \"Error msg\"&#125;, loading: false&#125;&#125; 4.RESET_OBJ: Dispatch this to reset the componentâ€™s state after success/failure. This is optional but can be useful when you want to reuse a â€œdirtyâ€ component from previous AJAX request. 1dispatch(&#123;\"type\": \"RESET_POST\", loading: false, \"post\": null, \"error\": \"Error message\"&#125;) Once Redux gets this and passes it through reducers, the new state will look something like: 1&#123;postList:&#123;post:null, error:null, loading: false&#125;&#125; STEP 3 â€” List State and Actions For Each Component (AND For Each Phase)Take a look at each component one by one and each phase and list of state and actions. We have 4 components: 1. PostsList, 2. PostDetails 3. PostForm and 4. Header components. 3.1 PostList Component â€” List State And Actions States: List out various data that may change the display of the component in all phases of the component. Shows list of Posts. Letâ€™s call the state as â€œpostsâ€ (an array). Shows â€œLoading..â€, if itâ€™s in the processing fetching the posts. Letâ€™s call this state â€œloadingâ€(boolean) Shows â€œErrorâ€ if there is an error. Letâ€™s call this state as â€œerrorâ€(null or error info). Since all the above are related to PostList, letâ€™s put them in a single state object called postList. 1&#123; postsList: &#123;posts: [], error:null, loading: false&#125; //initial state Actions: This component makes a â€œAJAXâ€ call to load posts, so weâ€™ll use the above mentioned pattern and create 4 actions. 1.Asks server for list of posts. Letâ€™s call this action as: â€œFETCH_POSTSâ€. 123456export function fetchPosts() &#123; const request = axios.get(`$&#123;ROOT_URL&#125;/posts`);return &#123; type: FETCH_POSTS, payload: request &#125;;&#125; 2.Tells every component that it received posts (success case). Letâ€™s call this â€œFETCH_POSTS_SUCCESSâ€ 123456export function fetchPostsSuccess(posts) &#123; return &#123; type: FETCH_POSTS_SUCCESS, payload: posts &#125;;&#125; 3.Tells every component that there was an error(failure case). Letâ€™s call this â€œFETCH_POSTS_FAILUREâ€ 123456export function fetchPostsFailure(error) &#123; return &#123; type: FETCH_POSTS_FAILURE, payload: error &#125;;&#125; 4. Resetting data is not required because this is the 1st page (youâ€™ll see how this is useful in other 2 pages) 3.2 PostDetails Component â€” List State And Actions Note: You can click on the pictures to zoom and read 3.3 PostForm Component â€” State And Actions 3.4 Header Component â€” List State And Actions STEP 4 â€” Create Action Creators For Each ActionWe have a total of 12 actions(4 actions x 3 pages), create action creators for each one. Please see the source code here. 12345678910111213141516//Example Action creators...export function fetchPosts() &#123; const request = axios.get(`$&#123;ROOT_URL&#125;/posts`);return &#123; type: FETCH_POSTS, payload: request &#125;;&#125;export function fetchPostsSuccess(posts) &#123; return &#123; type: FETCH_POSTS_SUCCESS, payload: posts &#125;;&#125;... Redux Term: â€œReducersâ€Reducers are functions that take â€œstateâ€ from Redux and â€œactionâ€ JSON object and returns a new â€œstateâ€ to be stored back in Redux. 1. Reducer functions are called by the â€œContainerâ€ containers when there is a user or server action.2. If the reducer changes the state, Redux passes the new state to each component and React re-renders each component 1234The below function takes the current \"postsList\" inside \"...state\" and merges new \"postList\" and creates a **new** state(json), if the action is \"FECTH_POSTS_SUCCESS\"case FETCH_POSTS_SUCCESS: return &#123; â€¦state, postsList: &#123;posts: action.payload, error:null, loading: false&#125; &#125;; STEP 5 â€” Write Reducers For Each ActionWe have 12 actions, we need to write reducers for each one of them. Please look at the source code for details here. Redux Term: â€œPresentationalâ€ and â€œContainerâ€ ComponentsKeeping React and Redux logic inside each component can make it messy, so Redux recommends creating a dummy presentation only component called â€œPresentationalâ€ component and a parent wrapper component called â€œContainerâ€ component that deals w/ Redux, dispatch â€œActionsâ€ and more. The parent Container then passes the data to the presentational component, handle events, deal with React on behalf of Presentational component. Legend: Yellow dotted lines = â€œPresentationalâ€ components. Black dotted lines = â€œContainerâ€ components. STEP 6 â€” Implement Every Presentational ComponentWe have 4 components: PostsList, PostDetails, PostForm and Header. Letâ€™s create presentational components for each one. 6.1 Implement Presentational Component â€” PostsList Note: You can click on the pictures to zoom and read 6.2 Implement Presentational Component â€” PostDetails 6.3 Implement Presentational Component â€” PostForm Note: In the actual code, I am using the awesome redux-form library for form-validation. Iâ€™ll blog about it in a different post. 6.4 Implement Presentational Component â€” Header Note: You can click on the pictures to zoom and read STEP 7 â€” Create Container Component For Some/All Presentational ComponentWe have 4 components: PostList, PostDetails, PostForm and Header. Letâ€™s create container components for each one. 7.1 Create Container Component â€” PostsListContainer 7.2 Create Container Component â€” PostDetailsContainer 7.3 Create Container Component â€” PostFormContainer 7.4 Create Container Component â€” HeaderContainer STEP 8 â€” Finally Bring Them All TogetherBelow code is a simplified version of wiring everything together. Please see source code of the main index.js and reducers.js to get started. 123456789101112131415161718192021222324import React from 'react'; &lt;-- Main React libimport ReactDOM from 'react-dom'; &lt;-- Main React DOM libimport &#123; Provider &#125; from 'react-redux';&lt;-- Injects Redux to compsimport &#123; createStore, applyMiddleware &#125; from 'redux';&lt;- Reduximport &#123; Router, browserHistory &#125; from 'react-router';&lt;- Navigationimport reducers from './reducers'; &lt;- Import reducersimport promise from 'redux-promise';//Configure middleware w/ redux-promise for AJAX requestsconst createStoreWithMiddleware = applyMiddleware( promise)(createStore);const store = createStoreWithMiddleware(reducers);ReactDOM.render( &lt;Provider store=&#123;store&#125;&gt; &lt;- Inject global redux state to comps &lt;Router history=&#123;browserHistory&#125;&gt; &lt;Route path=â€/â€ component=&#123;App&#125;&gt; &lt;- Wrapper for all pages &lt;IndexRoute component=&#123;PostsIndex&#125; /&gt; &lt;-wrapper Index page &lt;Route path=â€posts/newâ€ component=&#123;PostsNew&#125; /&gt; &lt;- New page &lt;Route path=â€posts/:idâ€ component=&#123;PostsShow&#125; /&gt; &lt;-Details &lt;/Route&gt; &lt;/Router&gt;&lt;/Provider&gt; , document.getElementById('body')); Thatâ€™s it for now!","categories":[],"tags":[]},{"title":"LÃ m tháº¿ nÃ o Ä‘á»ƒ káº¿t há»£p NodeJS Back End vá»›i ReactJS Front End","slug":"Lam-the-nao-de-ket-hop-NodeJS-Back-End-voi-ReactJS-Front-End","date":"2017-11-04T16:34:28.000Z","updated":"2017-11-04T16:36:30.636Z","comments":true,"path":"2017/11/Lam-the-nao-de-ket-hop-NodeJS-Back-End-voi-ReactJS-Front-End.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Lam-the-nao-de-ket-hop-NodeJS-Back-End-voi-ReactJS-Front-End.html","excerpt":"In this post, I want to show how you can build the front and back end of a website using NodeJS for the back end. Weâ€™ll use node to create endpoints, and set up a database in JSON format. Then, weâ€™ll create a front end application using React that will post to the database, and also fetch data from it.","text":"In this post, I want to show how you can build the front and back end of a website using NodeJS for the back end. Weâ€™ll use node to create endpoints, and set up a database in JSON format. Then, weâ€™ll create a front end application using React that will post to the database, and also fetch data from it.For this example, Iâ€™ll be making a guestbook, where users can submit their names and leave messages. Because users wonâ€™t need to log in, or retrieve any data, I wonâ€™t need to store anything in a session. Hereâ€™s the way this will likely work: Basically, we will have this all one one page, with a form for submitting a message, alongside the actual guestbook. To make this work weâ€™â€™ll start by creating the endpoints for our POST and GET requests. Weâ€™ll set up our database, deploy it, so that we can create a React app, and pull data from the online API. Hereâ€™s the order in which I like to do things. You may prefer to work differently. This process makes sense to me, because each step builds on the step before it. During this tutorial, Iâ€™ll go through each step in more detail. To see how the finished project could work, hereâ€™s a link to my project: http://ethan.jarrell.webdeveloper.surge.sh/GuestBook STEP 1 -Our database collection will contain 2 items: The name of the user The message the user writes If you havenâ€™t already done so, go ahead and install MongoDB, and get it running on port 27017. Then, on the command line, weâ€™ll create the database. Weâ€™ll call our database signatures. And the collection, guest_signatures. 12345&gt; Show dbs&gt; Use signaturesswitched to db signatures&gt; show collections&gt; db.createCollection(guest_signatures) Now that we have that set up, we can switch to the text editor, and create the models for the database. STEP 2 -Use the command line to start a new express app. Make the new directory, and then use npm init to create the app. This will automatically create your pkg.JSON file. Since this will be a very basic app, weâ€™ll only need 2 other files in our express app. One for our routes. I like to include all my dependencies in this file as well. Then our second fill will be for our models/schema. Weâ€™ll tackle the model file first. It should look something like this: 12345678910111213141516const mongoose = require('mongoose');let Schema = mongoose.Schema;const signatureSchema = new Schema(&#123; guestSignature: &#123; type: mongoose.Schema.Types.Mixed, required: true, &#125;, message: &#123; type: mongoose.Schema.Types.Mixed, required: true, &#125;,&#125;)const Signature = mongoose.model('Signature', signatureSchema);module.exports = Signature; STEP 3 -Before we create our endpoints here, letâ€™s go ahead an list our dependencies at the top of our file. We donâ€™t need too many. 1234567891011//====LIST DEPENDENCIES===//const express = require('express');const parseurl = require('parseurl');const bodyParser = require('body-parser');const path = require('path');const expressValidator = require('express-validator');const mongoose = require('mongoose');const Signature = require('./models/signature.js')const app = express();const url = 'mongodb://localhost:27017/signatures';//=========================// You donâ€™t necessarily need to connect with mongoose, so feel free to use MongoClient, if you prefer that. Weâ€™re also using the Signature schema that we just created in the previous step. Now, letâ€™s create our endpoints. We only have one model, and weâ€™re only going to read and write to it for now, so weâ€™re only going to have 2 endpoints. Our root directory â€œ/â€, where weâ€™ll redirect to our API Our api, weâ€™ll call â€œ/api/signatures, where weâ€™ll read and write to. At our API endpoint, weâ€™ll have a GET and a POST. Weâ€™ll reference our models, using the find() and create() methods for GET and POST respectively. And our response will need to be in JSON format, so that we can easily access the data there from React later on. Hereâ€™s how those endpoints might look: 12345678910111213141516171819202122232425262728//====ROOT DIRECTORY===//app.get('/', function(req, res) &#123; res.json('you did it');&#125;);//==========================////====GET ALL SIGNATURES===//app.get('/api/signatures', function(req, res) &#123; Signature.find(&#123;&#125;).then(eachOne =&gt; &#123; res.json(eachOne); &#125;) &#125;)//==========================////====POST NEW SIGNATURE===//app.post('/api/signatures', function(req, res) &#123; Signature.create(&#123; guestSignature: req.body.SignatureOfGuest, message: req.body.MessageofGuest, &#125;).then(signature =&gt; &#123; res.json(signature) &#125;);&#125;);//==========================// The only thing I didnâ€™t really mention was the req.body.SignatureOfGuest and req.body.MessageofGuest. Everything else in this section refers to something weâ€™ve already created, like our database, collections and models. This refers to the name of the field that weâ€™ll use in our React App, Our input will have to use the names SignatureOfGuest and MessageofGuest, so weâ€™ll need to remember that. STEP 4 -Now, weâ€™ll want to connect to our local database from out text editor. If you remember, we had this constant in our list: 1const url = 'mongodb://localhost:27017/signatures'; Weâ€™ll write a function using this constant to connect to our local database. 123456789//====MONGOOSE CONNECT===//mongoose.connect(url, function (err, db) &#123; if (err) &#123; console.log('Unable to connect to the mongoDB server. Error:', err); &#125; else &#123; console.log('Connection established to', url); &#125;&#125;);//==========================// In order to make sure everything is working properly, weâ€™ll also need to add an app.listen at the end of our file. At this point, itâ€™s a good idea to pause, and make sure the endpoints and local connection works. You can do that by using Postman to make GET and POST requests. If the endpoints or connections donâ€™t work, you should be able to diagnose the problem here based on the error messages you receive. If everything is working, it should allow you to appropriately read and write to the database. Once everything is working, itâ€™s time to set up our account on Heroku and Mlab. STEP 5-Sign up for a Heroku account here. And create an mLab account here. STEP 6 - After creating your mLab account, click on the Create New button and select a Single node sandbox. There are paid options as well, but the sandbox has plenty of space for getting started. Give your database a name. Since my local database is signatures, Iâ€™m using the same name for my mLab database. Now that you have your database created, you can start a new collection from here. You will also need to add a User or Users who can access your database. Without doing this step, and adding yourself as a User with access, authentication will always fail when you try to deploy it. Now your database is running on mLab. When you click on the database, you should see some information at the top, telling you how to integrate the connection. It should look something like this: 1mongodb://&lt;dbuser&gt;:&lt;dbpassword&gt;[@ds7](http://twitter.com/ds129024 \"Twitter profile for @ds129024\")9234.mlab.com:9234/signatures The actual url of the database will just have the username and password replaced with your username and password. Now letâ€™s head back to our text editor. We currently have the database running locally at this location: 1const url = 'mongodb://localhost:27017/signatures'; To change it, so that we are connected to mLab, simply update the url variable with the information from mLab. It should look something like this: 1const url = 'mongodb://username:password@ds79234.mlab.com:9234/signatures'; However, youâ€™ll likely be putting this on github, or another public place. You donâ€™t want your mlab username and password in a public sphere where anyone can see it. To fix that, weâ€™ll set an environment variable on the command line, and then update our url variable one more time in the text editor. On the command line, use this command: 1export MONGOLAB_URI=\"mongodb://username:password@ds79234.mlab.com:9234/signatures'; Of course, replacing it with your own username, password, numbers and database name. Now, back in our text editor, we will change our url variable to the following: 1const url = process.env.MONGOLAB_URI; Weâ€™ll also want to change our app.listen to reflect the new port. It could look like this: 12app.listen(process.env.PORT || 3000);console.log('starting applicaiton. Good job!'); This way, it will try to run from mongolab, but if it canâ€™t make the connection, it will still listen on port 3000 by default. This will also allow you to run the app locally or from mlab, in case you want to test changes on the local version. The final step in making the connection is deploying your code to your Heroku App. to do this, you can use the following code from the command line: 1heroku config:set MONGOLAB_URI=mongodb://username:password@ds79234.mlab.com:9234/signatures Your app should be successfully deployed on heroku, and you can open it from there now. If you are getting errors, double check to make sure itâ€™s running locally. If so, then itâ€™s probably an error along the way in the connection. In these last two steps, thereâ€™s quite a bit of repetitive code. Iâ€™m going to outline the high level code here. STEP 7 -Use â€˜create-react-appâ€™ from the command line to create a new react app. STEP 8 -Now, weâ€™ll want to create a form, to allow for user input. Hereâ€™s how we do that. In a new component, weâ€™ll create a new class. 1class GuestBook extends Component 2. Weâ€™ll use a constructor and super method to pass props down. 12constructor(props) &#123; super(props); 3. Use the this keyword to handle the name and message of guest, and bind it to (this). 12this.handleSignatureOfGuest = this.handleSignatureOfGuest.bind(this); this.handleMessageofGuest = this.handleMessageofGuest.bind(this); 4. Set the state of the name and message of guest to an empty string. 1234this.state = &#123; SignatureOfGuest: \"\", MessageofGuest: \"\", &#125;; 5. Listen for an event on the state of both the name and message input. 123456handleSignatureOfGuest(event) &#123; this.setState(&#123; SignatureOfGuest: event.target.value &#125;); &#125; handleMessageofGuest(event) &#123; this.setState(&#123; MessageofGuest: event.target.value &#125;); &#125; 6. Create a function that changes the name and message to the value of the target input. 123456addToGuestBook = event =&gt; &#123; event.preventDefault(); this.setState(&#123; SignatureOfGuest: event.target.value, MessageofGuest: event.target.value,&#125;); 7. Iâ€™m now using axios to post the input data to our database, which is on heroku. 12345678910axios.post('&lt;[your-heroku-url here&gt;'](https://ancient-sea-87841.herokuapp.com/api/signatures%27), &#123; SignatureOfGuest: this.state.SignatureOfGuest, MessageofGuest: this.state.MessageofGuest, &#125;) .then(response =&gt; &#123; console.log(response, 'Signature added!'); &#125;) .catch(err =&gt; &#123; console.log(err, 'Signature not added, try again'); &#125;); 8. Then Iâ€™m resetting the state of the input to an empty string. 12345this.setState(&#123; SignatureOfGuest: \"\", MessageofGuest: \"\", &#125;);&#125;; 9. Finally, weâ€™ll make a render method, and return our page with the input fields. Inside the input of each field, weâ€™ll give it an onChange, name, and value. the onChange will be set to the.handlemessage or this.handlename, for each field. The name of each field will be set to what we called it in our node app. The value will use state, and weâ€™ll set that to this.state.message, and this.state.name. 1234567891011121314&lt;input onChange=&#123;this.handleSignatureOfGuest&#125; name=\"SignatureOfGuest\" className=\"NameinputForm\" value=&#123;this.state.SignatureOfGuest&#125; placeholder=\"Enter your name\" /&gt; &lt;textarea onChange=&#123;this.handleMessageofGuest&#125; name=\"MessageofGuest\" className=\"MessageinputForm\" value=&#123;this.state.MessageofGuest&#125; placeholder=\"Type a message\" /&gt; 10. Then weâ€™ll add a submit button, where we call the function from earlier. 1234567&lt;button className=\"submitbuttonguestbook\" type=\"submit\" onClick=&#123;this.addToGuestBook&#125; &gt; Submit to Guestbook&lt;i className=\"GuestBookButton2\" aria-hidden=\"true\" /&gt; &lt;/button&gt; STEP 9-Now weâ€™ll make another component where weâ€™ll render the data thatâ€™s being stored in our database. Then we can export that component, and put it on our guestbook page. Inside this component weâ€™ll do the following: In a new component, weâ€™ll create a new class. 1class GuestNames extends Component &#123; 2. Weâ€™ll use a constructor and super method to pass props down. 12constructor(props) &#123; super(props); 3. Use this.state to set the state of our guestbook messages to an empty string. 123this.state = &#123; messages: \"\", &#125;; 4. Use a componentDidMount lifecycle method 1componentDidMount() &#123; 5. Inside that method weâ€™ll use fetch and the url of our heroku api to fetch the information from the database. 123fetch('&lt;your-heroku-url-goes-here&gt;['](https://ancient-sea-87841.herokuapp.com/api/signatures%27)) .then(results =&gt; &#123; return results.json(); 6. Weâ€™ll map over the data, and return the data we want. 12345data.map((msg) =&gt; &#123; return( &lt;div key=&#123;msg.results&#125;&gt; &lt;h3 className=\"h3msg\"&gt;&#123;msg.message&#125;&lt;/h3&gt;&lt;h2 className=\"h2sig\"&gt;-&#123;msg.guestSignature&#125;&lt;/h2&gt; &lt;/div&gt; 7. Now weâ€™ll use this.setState to set the state of the messages to the new state using the data we just fetched. 1this.setState(&#123;messages: messages&#125;); 8. Now weâ€™ll create render mehod. 1render() &#123; 9. Inside the render method, weâ€™ll create JSX elements to render our data inside the component. Iâ€™m using this.state.messages inside an &lt;h6&gt; tag. 1234return (&lt;div className=\"guestdataContainer\"&gt; &lt;h6&gt;Guestbook Messages&lt;/h6&gt; &#123;this.state.messages&#125; &lt;/div&gt; 10. Finally, weâ€™ll export the component, so we can use it on other pages. 1export default GuestNames; Again, if you have any questions feel free to reach out. Thanks!","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"nodejs","slug":"nodejs","permalink":"http://nthung2112.github.io/tags/nodejs/"}]},{"title":"Tá»•ng há»£p cÃ¡c cheatsheets tá»‘t nháº¥t cá»§a Front-end","slug":"Tong-hop-cac-cheatsheets-tot-nhat-cua-Front-end","date":"2017-11-04T16:28:52.000Z","updated":"2017-11-04T16:31:09.386Z","comments":true,"path":"2017/11/Tong-hop-cac-cheatsheets-tot-nhat-cua-Front-end.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Tong-hop-cac-cheatsheets-tot-nhat-cua-Front-end.html","excerpt":"Itâ€™s rather impossible to remember all the APIs by heart. This is when cheatsheets jump in! Here are the best front-end cheatsheets Iâ€™ve gathered.","text":"Itâ€™s rather impossible to remember all the APIs by heart. This is when cheatsheets jump in! Here are the best front-end cheatsheets Iâ€™ve gathered. Javascript ES2015 featureshttps://devhints.io/es6 Javascripthttp://overapi.com/javascript Javascript Regular expressionhttps://www.debuggex.com/cheatsheet/regex/javascript Reacthttps://devhints.io/react Reduxhttps://github.com/linkmesrl/react-journey-2016/blob/master/resources/egghead-redux-cheat-sheet-3-2-1.pdf Vuejshttps://vuejs-tips.github.io/cheatsheet/ Vuexhttps://vuejs-tips.github.io/vuex-cheatsheet/ Angular 4https://angular.io/guide/cheatsheet Flexboxhttps://yoksel.github.io/flex-cheatsheet/ SCSShttps://devhints.io/sass Stylushttps://devhints.io/stylus GraphQLhttps://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png","categories":[],"tags":[{"name":"front-end","slug":"front-end","permalink":"http://nthung2112.github.io/tags/front-end/"}]},{"title":"Äi Äƒn vÃ  hiá»ƒu nhá»¯ng Ä‘iá»u cÆ¡ báº£n cá»§a Express.js","slug":"Di-an-va-hieu-nhung-dieu-co-ban-cua-Express-js","date":"2017-11-04T16:25:21.000Z","updated":"2017-11-04T16:33:58.328Z","comments":true,"path":"2017/11/Di-an-va-hieu-nhung-dieu-co-ban-cua-Express-js.html","link":"","permalink":"http://nthung2112.github.io/2017/11/Di-an-va-hieu-nhung-dieu-co-ban-cua-Express-js.html","excerpt":"If you have ever visited a sit-down restaurant, then you can understand the basics of Express. But if you are just starting to build your first Node.js back endâ€¦you might be in for a bumpy ride. Yes â€” it is certainly easier to learn Node if you have past experience with JavaScript. But the challenges you will face while building a back end are completely different than the ones you face while using JavaScript on the front end. When I learned Node, I chose the hard way. I studied eBooks, written tutorials, and videos over and over until I finally understood why I was doing what I was doing. There is an easier way. I am going to use a restaurant analogy to explain four key parts of your first Express app. Express.js is a popular framework for organizing your code, and I would recommend it for any beginner. Iâ€™ll explain further in a moment.","text":"If you have ever visited a sit-down restaurant, then you can understand the basics of Express. But if you are just starting to build your first Node.js back endâ€¦you might be in for a bumpy ride. Yes â€” it is certainly easier to learn Node if you have past experience with JavaScript. But the challenges you will face while building a back end are completely different than the ones you face while using JavaScript on the front end. When I learned Node, I chose the hard way. I studied eBooks, written tutorials, and videos over and over until I finally understood why I was doing what I was doing. There is an easier way. I am going to use a restaurant analogy to explain four key parts of your first Express app. Express.js is a popular framework for organizing your code, and I would recommend it for any beginner. Iâ€™ll explain further in a moment.Here are the four key parts we will cover: The require statements Middleware Routing App.listen()/ Starting the server In this analogy, you are a restaurant owner looking to hire a general manager â€” the person who creates all the processes and manages the place so that it runs smoothly and customers leave happy. Here is a preview of what is next: By the end, you will understand the functionality of every part of a basic Express app. Step 1: hiring the manager (require statements)In this example, you are the restaurant owner. And you need to hire an expert to run the day-to-day operations of your new restaurant. You certainly arenâ€™t an expert, and you canâ€™t leave it to the waitstaff and kitchen to figure out. If you want to run an efficient and safe restaurant, you need someone to keep your staff working at maximum efficiency. Express is the new manager. The first part is pretty straightforward. Like with any other NPM package, you need to npm install the express module and then use a require statement to load the module. Unlike many other NPM packages, you also need to use this line: 1const app = express(); This is because you need a variable to hold your new Express application. Express is not a default part of Node. Step 2: making decisions at the restaurant (middleware)Letâ€™s take a step back here. What are some common routines that happen at restaurants? There are three that immediately jump into my head: Seating new customers Taking food orders Presenting the check at the end of the meal For each one, there are a series of checks that you need to run before you can execute the action. For example, before you seat customers you need to know: Are they wearing a shirt and shoes (and pants)? Otherwise, they cannot be seated. If they want to sit at the bar, are they 21 years old (if you are in the United States)? This ainâ€™t a beach bar! Similarly, in your code, you will need to validate that requests have certain criteria before they can continue. For example, if a person tries to log in to your site: Do they have an account? Did they enter the correct password? This is where the concept of middleware comes in. Middleware functions allow you to take action on any incoming request and modify it before sending back a response. In your restaurant, you need a series of rules to decide if you should seat incoming people or not. Letâ€™s say a couple walks through your door. You have one rule before giving them a table: are they wearing a shirt and shoes? First, you start with app.use(). This means that these are simply rules that need to be applied for the routes coming up next. They are not a GET, POST, PUT or DELETE. In line 4, you have an anonymous function with the parameters req, res and next. For the purposes of this code block, you are just inspecting the request (req) to see if it has shirt and shoes. You also need to use the next() function at the end because you are simply validating clothing here. Later, in the routes, you will allow the guests to get an actual table. In lines 5 and 6, you check if they have a shirt and shoes. And in lines 7â€“9, you only proceed if they have both. The code block above is missing one important thing: A path. This is the specific string included with the request. And since it is missing a path, it will run on every single request. Can you imagine? When customers entered the restaurantâ€¦ ordered foodâ€¦ asked for the checkâ€¦ employees would be forced to look up and down at them to make sure they were clothed! That is a quick way to go out of business. So, we change line 4 in the example above. Now, we will only run this code when a user requests along the â€˜/tableâ€™ route. The full explanation: Step 3: executing common routines (routing)Letâ€™s continue with the seating example. So far, we only know how to validate whether someone should be seated or not. But we do not actually know how to lead them to a table and sit them down. This is where routes come in. Routes allow us to script specific actions based on the path. The options are GET, POST, PUT and DELETE, but we will focus on GET and POST for now. In the context of a restaurant, we need to create a GET request in order to choose a specific table and seat the guests. GETs do not modify or add to your database. They just retrieve information based on specific parameters. In this case, letâ€™s say that you need to create a procedure to seat a party of two. The number 2 came from the customer request. Okay, before I explain: Yes, this is only sending a message at the end. It has not actually found a specific table to seat the customer yet. I would need to search an array for an open table, have more of a back storyâ€¦that is outside of the scope of this tutorial. In line 12, we define the procedure for finding a table when a guest requests along the â€˜/tableâ€™ route. Just like the middleware example above, we have request and response parameters available. It also has a parameter, amount. This is two, in this example. In fact, everything after the function declaration in line 12 is technically middleware since it modifies a user request. You will see in the diagram at the end. In line 13, we access the number of people in the party from the parameters of the request object. That is not declared anywhere since the request came from the user, and we do not have any front-end code. So here is what the request might look like if this was a real app: 12345req = &#123; params: &#123; amount: 2; &#125;&#125; In line 13, our party variable accesses the amount property of the params object within the request. Finally in line 14, we send a response back to the customer: we are looking for the appropriately sized table. That is a lot at once. Here is a diagram: Step 3.5: making your restaurant efficient (router)Now you can trace the full path from request to response. But as your app grows in size, you will not want to code the rules for each route individually. You will find that some routes share the same rules, so you need to find a way to apply one set of rules to multiple routes. In terms of seating, you can either seat your customers at the bar or at a table. Those have rules in common like shirt + shoes, but seating at the bar requires every member of the party to be 21. And, in terms of serving customers, you will need to use a slightly different procedure for serving the appetizer, main course, and dinner. But, those three routes have plenty in common as well. This is where the router comes in. The router lets you group your routes so that you can create common rules. We need to create middleware to cover each of these cases. I will just cover the seating cases for now since it will overwrite the code above. Here is the full code snippet: I am going to cover each part individually. In line 4, we declare our router. In lines 6 and 14, we now have seatingRouter.use() in place of app.use() to indicate that this middleware is only related to seatingRouter routes. Finally, in line 21, we add more middleware to show that every seatingRouter route begins with â€˜/seatingâ€™. So, if someone requested a seat at the bar, the full path would be â€˜/seating/bar.â€™ This may feel a little out of order, since you might expect the path to be defined when you create the router in line 4. That is normal! Here is that in diagram form: And, when you add a GET route, it goes above the last statement where you assign routes to the router. Step 4: opening for business (ports)Okay, last part. So far, you have hired a manager, defined what to do before accepting customer requests, and determined what to do with specific customer requests once they come in. Now, you just need to determine the address for the location where all this will happen. Your server has ports that are kind of like the address for the restaurant itself.Since your server can handle many types of restaurants (or server-side scripts) at once, you need to tell it where each script should run. In the example above, the port is 3000 and it is located on your computer. So if you type: 1[https://localhost:3000/](https://localhost:3000/) into your browser, and you are running your Node app, the server knows to run the specific script. In this case, as soon as you enter the URL, you will log the message in the console and be able to use any of your routes. If the restaurant itself is your entire app, then it is now open for business at the address 3000.","categories":[],"tags":[{"name":"nodejs","slug":"nodejs","permalink":"http://nthung2112.github.io/tags/nodejs/"},{"name":"expressjs","slug":"expressjs","permalink":"http://nthung2112.github.io/tags/expressjs/"}]},{"title":"CÃ¡c nguyÃªn táº¯c cÆ¡ báº£n cá»§a Redux","slug":"Cac-nguyen-tac-co-ban-cua-Redux","date":"2017-10-10T15:41:15.000Z","updated":"2017-10-10T15:48:47.120Z","comments":true,"path":"2017/10/Cac-nguyen-tac-co-ban-cua-Redux.html","link":"","permalink":"http://nthung2112.github.io/2017/10/Cac-nguyen-tac-co-ban-cua-Redux.html","excerpt":"Redux lÃ  gÃ¬ vÃ  táº¡i sao pháº£i cáº§n nÃ³ trong React/React Native NgoÃ i Redux ra thÃ¬ cÃ²n cÃ¡i nÃ o Ä‘á»ƒ quáº£n lÃ½ state ná»¯a khÃ´ng? 3 NguyÃªn táº¯c cá»§a Redux NguyÃªn táº¯c 1: Store ( Single Source of Truth ) NguyÃªn táº¯c 2: Action ( State is Read-Only ) NguyÃªn táº¯c 3: Reducer ( Changes are made with Pure Functions ) TÃ³m táº¯t cÃ¡ch hoáº¡t Ä‘á»™ng: Bá»©c tranh tá»•ng quÃ¡t cá»§a Redux CÃ¡ch há»c Redux Chia sáº» cÃ¡ch há»c Redux: Má»™t sá»‘ resources hay","text":"Redux lÃ  gÃ¬ vÃ  táº¡i sao pháº£i cáº§n nÃ³ trong React/React Native NgoÃ i Redux ra thÃ¬ cÃ²n cÃ¡i nÃ o Ä‘á»ƒ quáº£n lÃ½ state ná»¯a khÃ´ng? 3 NguyÃªn táº¯c cá»§a Redux NguyÃªn táº¯c 1: Store ( Single Source of Truth ) NguyÃªn táº¯c 2: Action ( State is Read-Only ) NguyÃªn táº¯c 3: Reducer ( Changes are made with Pure Functions ) TÃ³m táº¯t cÃ¡ch hoáº¡t Ä‘á»™ng: Bá»©c tranh tá»•ng quÃ¡t cá»§a Redux CÃ¡ch há»c Redux Chia sáº» cÃ¡ch há»c Redux: Má»™t sá»‘ resources hay Redux lÃ  gÃ¬ vÃ  táº¡i sao pháº£i cáº§n nÃ³ trong React/React NativeTÃ³m táº¯t React: NguyÃªn táº¯c má»™t app React lÃ  dá»±a vÃ o component. Má»—i component cÃ³ state vÃ  props. Náº¿u state cá»§a má»™t component thay Ä‘á»•i thÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c render láº¡i. Props Ä‘á»ƒ truyá»n data tá»« component cha sang component con Váº¥n Ä‘á» lÃ  khi ta muá»‘n truyá»n props tá»« 2 component khÃ´ng pháº£i cha-con thÃ¬ sáº½ xáº£y ra váº¥n Ä‘á» VÃ­ dá»¥ sau, má»™t app nhá» chá»‰ cÃ³ Main -&gt; Parent -&gt; Child nhÆ° sau thÃ¬ truyá»n props Ä‘Æ¡n giáº£n NhÆ°ng vá»›i app phá»©c táº¡p hÆ¡n má»™t tÃ½, khi muá»‘n truyá»n props giá»¯a 2 component khÃ´ng pháº£i cha-con thÃ¬ ráº¥t phá»©c táº¡p: ÄÃ³ lÃ  lÃ½ do táº¡i sao nÃªn dÃ¹ng Redux: TÃ³m láº¡i cáº§n má»™t cÆ¡ cháº¿ Ä‘á»ƒ quáº£n lÃ½ state trong React/React Native. KhÃ´ng pháº£i cá»© React/React Native lÃ  pháº£i dÃ¹ng Redux. CÅ©ng khÃ´ng pháº£i Redux chá»‰ Ä‘Æ°á»£c dÃ¹ng trong React/React Native NgoÃ i Redux ra thÃ¬ cÃ²n cÃ¡i nÃ o Ä‘á»ƒ quáº£n lÃ½ state ná»¯a khÃ´ng?Thá»±c ra Redux dá»±a theo Ã½ tÆ°á»Ÿng cá»§a Flux. NgoÃ i Redux ra báº¡n cÃ³ thá»ƒ dÃ¹ng: Mobx ( CÃ i nÃ y phá»• biáº¿n chá»‰ sau Redux ) Jumpsuit ( Ä‘áº·t tÃªn ngÃ¡o tháº­t ) NhÆ°ng láº­p trÃ¬nh React Native thÃ¬ nÃªn dÃ¹ng Redux vá»›i Mobx. 3 NguyÃªn táº¯c cá»§a ReduxÄÃ¡ng láº½ ra mÃ¬nh sáº½ viáº¿t bÃ i â€œTáº¡i sao cáº§n Redux vÃ  cÃ¡ch dÃ¹ngâ€. NhÆ°ng Ä‘á»ƒ hiá»ƒu Ä‘Æ°á»£c táº¡i sao vÃ  cÃ¡ch dÃ¹ng thÃ¬ nÃªn hiá»ƒu nguyÃªn táº¯c chÃ­nh cá»§a nÃ³, tá»« Ä‘Ã³ khi há»c chÃºng ta sáº½ Ä‘á»ƒ Ã½ nhá»¯ng nguyÃªn táº¯c nÃ y mÃ  há»c theo. NÆ¡ron tháº§n kinh trong nÃ£o má»›i báº¯t Ä‘áº§u liÃªn káº¿t láº¡i. CÅ©ng giá»‘ng nhÆ° báº¡n há»c láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng sáº½ cÃ³ 4 nguyÃªn táº¯c: trá»«u tÆ°á»£ng, Ä‘Ã³ng gÃ³i, káº¿ thá»«a, Ä‘a hÃ¬nh váº­y. Tá»« Ä‘Ã³ má»›i há»c class , object, properties, method, access modifier, khá»Ÿi táº¡o, káº¿ thá»«a, interface, vv NguyÃªn táº¯c nÃ y tá»« Ä‘Ã¢u? ÄÆ°Æ¡ng nhiÃªn tá»« nhÃ³m táº¡o ra nÃ³ rá»“i, má»™t trong Ä‘Ã³ lÃ  Dan Abramov NguyÃªn táº¯c 1: Store (Single Source of Truth)Chá»‰ cÃ³ má»™t cÃ¢y object trong má»™t á»©ng dá»¥ng, vÃ  ngÆ°á»i ta Ä‘áº·t nÃ³ lÃ  store.VÃ­ dá»¥ mÃ¬nh cÃ³ viáº¿t má»™t á»©ng dá»¥ng tÃ¬m viá»‡c lÃ m Ä‘Æ¡n giáº£n: ThÃ¬ sáº½ Ä‘Æ°á»£c má»™t store nhÆ° sau: auth: dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ Ä‘Äƒng nháº­p jobs: danh sÃ¡ch job táº£i tá»« web service likedJobs: danh sÃ¡ch job Ä‘Ã£ thÃ­ch NguyÃªn táº¯c 2: Action (State is Read-Only)KhÃ´ng update store trá»±c tiáº¿p Ä‘Æ°á»£c, muá»‘n thay Ä‘á»•i cÃ¡i store thÃ¬ pháº£i truyá»n action vÃ o. MÃ  action nghe cao siÃªu váº­y thÃ´i, chá»© nÃ³ chá»‰ lÃ  má»™t object trong Javascript. Quy Ä‘á»‹nh duy nháº¥t cá»§a cá»§a object nÃ y lÃ  pháº£i cÃ³ type. ( type thÆ°á»ng lÃ  chuá»—i string )VÃ­ dá»¥ action Ä‘Äƒng nháº­p Facebook thÃ nh cÃ´ng: VÃ­ dá»¥ action thÃ­ch má»™t cÃ´ng viá»‡c nÃ o Ä‘Ã³: NguyÃªn táº¯c 3: Reducer (Changes are made with Pure Functions)Sáº½ cÃ³ má»™t cÃ¡i hÃ m nháº­n cÃ¡i action á»Ÿ trÃªn, rá»“i tráº£ vá» state má»›i. MÃ  hÃ m nÃ y pháº£i lÃ  pure function. MÃ  pure function lÃ  sao? CÃ¡i pure function nÃ y viáº¿t cáº£ bÃ i cÅ©ng Ä‘Æ°á»£c. NhÆ°ng Ä‘áº¡i Ã½ chÃ­nh lÃ  pure function khÃ´ng gÃ¢y side effects nhÆ°: thay Ä‘á»•i giÃ¡ trá»‹ tham sá»‘, khÃ´ng gá»i web service hay database trong hÃ m nÃ y. TÃ³m táº¯t cÃ¡ch hoáº¡t Ä‘á»™ng:Khi ngÆ°á»i dÃ¹ng nháº¥n like má»™t job ( nháº¥n button like ) -&gt; táº¡o action: Sau Ä‘Ã³ Reducer lÃ  má»™t cÃ¡i hÃ m, nÃ³ tráº£ vá» state má»›i Sau Ä‘Ã³ á»Ÿ component nÃ o muá»‘n xÃ i thÃ¬ liÃªn há»‡ store Ä‘á»ƒ truy cáº­p dá»¯ liá»‡u trong store. Bá»©c tranh tá»•ng quÃ¡t cá»§a ReduxHÃ¬nh nÃ y má»›i mÃ´ táº£ má»™t chiá»u cá»§a dá»¯ liá»‡u: giá»¯a action, reducer vÃ  store ÄÃ¢y má»›i lÃ  hÃ¬nh Ä‘áº§y Ä‘á»§: CÃ¡ch há»c ReduxÄÆ°Æ¡ng nhiÃªn cÃ²n cÃ³ nhiá»u pháº§n chi tiáº¿t bÃªn trong mÃ¬nh chÆ°a Ä‘á» cáº­p Ä‘áº¿n nhÆ°: Action Creator: dÃ¹ng Ä‘á»ƒ táº¡o action, thao tÃ¡c logic. ChÃºng cÅ©ng lÃ  nhá»¯ng hÃ m bÃ¬nh thÆ°á»ng nhÆ°ng sáº½ tráº£ vá» lÃ  action thÃ´i chá»© khÃ´ng cÃ³ gÃ¬ gÃª gá»›m. createStore: táº¡o store applyMiddleware: thÃ nh pháº§n trung gian nhÆ° lÆ°u store offline ( local storage ), async action nhÆ° táº£i data trÃªn web service, vv connect, mapStateToProps: káº¿t ná»‘i store vá»›i component, Ä‘á»ƒ component cÃ³ thá»ƒ xÃ i Ä‘Æ°á»£c state trong store. Chia sáº» cÃ¡ch há»c Redux: Xem video hÆ°á»›ng dáº«n tá»« chÃ­nh anh táº¡o ra Redux:https://egghead.io/courses/getting-started-with-redux LÃªn youtube xem cÃ¡ch dÃ¹ng redux trong má»™t á»©ng dá»¥ng React/React Native Ä‘á»ƒ hiá»ƒu Ä‘Æ°á»£c nhá»¯ng pháº§n cÃ²n thiáº¿u á»Ÿ trÃªn cÅ©ng nhÆ° cÃ¡ch tá»• chá»©c code trong á»©ng dá»¥ng. Äá»c document cá»§a Redux tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i, trong nÃ y cÃ³ hÆ°á»›ng dáº«n code app To Do List:http://redux.js.org/docs/introduction/ Muá»‘n master thÃ¬ viáº¿t láº¡i cÃ¡c hÃ m, cÃ¡c middleware nhÆ° connect, applyMiddleware. MÃ  muá»‘n lÃ m Ä‘Æ°á»£c thÃ¬ cÅ©ng pháº£i master React táº¡i pháº£i dÃ¹ng Higher-Order Components Má»™t sá»‘ resources hayThe Complete React Native and Redux Course Advanced React and Redux HÃ¬nh chÃ´m tá»«: https://www.udemy.com/full-stack-universal-react-with-redux-express-and-mongodb/ https://www.theodo.fr/blog/2016/03/getting-started-with-react-redux-and-immutable-a-test-driven-tutorial-part-2/","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"redux","slug":"redux","permalink":"http://nthung2112.github.io/tags/redux/"}]},{"title":"Kiáº¿n trÃºc tá»•ng quan cá»§a Angular 2/4 - P2","slug":"Kien-truc-tong-quan-cua-Angular-2-4-P2","date":"2017-10-01T09:02:02.000Z","updated":"2017-10-01T10:01:15.067Z","comments":true,"path":"2017/10/Kien-truc-tong-quan-cua-Angular-2-4-P2.html","link":"","permalink":"http://nthung2112.github.io/2017/10/Kien-truc-tong-quan-cua-Angular-2-4-P2.html","excerpt":"Data bindingHÃ£y tÆ°á»Ÿng tÆ°á»£ng ráº±ng, báº¡n Ä‘ang pháº£i code 1 á»©ng dá»¥ng web mÃ  viá»‡c tÆ°Æ¡ng tÃ¡c, thay Ä‘á»•i giÃ¡ trá»‹ trÃªn DOM diá»…n ra liÃªn tá»¥c. Sáº½ thá»±c sá»± lÃ  1 cÆ¡n Ã¡c má»™ng náº¿u báº¡n pháº£i tá»± tay thá»±c hiá»‡n toÃ n bá»™ cÃ¡c thao tÃ¡c update, create value trÃªn cÃ¡c HTML DOM khi cÃ³ hÃ nh Ä‘á»™ng cá»§a ngÆ°á»i dÃ¹ng mÃ  khÃ´ng sá»­ dá»¥ng 1 framework nÃ o khÃ¡c ngoÃ i máº¥y thÆ° viá»‡n kiá»ƒu jQuery :-s Vá»›i Angular, chÃºng ta cÃ³ 1 thuáº­t ngá»¯ lÃ  data binding, má»™t cÆ¡ cháº¿ phá»‘i há»£p nhá»‹p nhÃ ng cÃ¡c thÃ nh pháº§n cá»§a template vá»›i component. Viá»‡c nÃ y ráº¥t Ä‘Æ¡n giáº£n, chÃºng ta chá»‰ cáº§n thÃªm binding markup vÃ o HTML lÃ  Angular tá»± hiá»ƒu vÃ  connect chÃºng tá»›i Component. NhÆ° diagram bÃªn dÆ°á»›i, cÃ³ 4 kiá»ƒu data binding syntax. Má»—i kiá»ƒu Ä‘á»u cÃ³ chiá»u dá»¯ liá»‡u tá»« DOM tá»›i COMPONENT, tá»« COMPONENT tá»›i DOM, vÃ  cÃ³ cáº£ kiá»ƒu cÃ³ 2 chiá»u dá»¯ liá»‡u.","text":"Data bindingHÃ£y tÆ°á»Ÿng tÆ°á»£ng ráº±ng, báº¡n Ä‘ang pháº£i code 1 á»©ng dá»¥ng web mÃ  viá»‡c tÆ°Æ¡ng tÃ¡c, thay Ä‘á»•i giÃ¡ trá»‹ trÃªn DOM diá»…n ra liÃªn tá»¥c. Sáº½ thá»±c sá»± lÃ  1 cÆ¡n Ã¡c má»™ng náº¿u báº¡n pháº£i tá»± tay thá»±c hiá»‡n toÃ n bá»™ cÃ¡c thao tÃ¡c update, create value trÃªn cÃ¡c HTML DOM khi cÃ³ hÃ nh Ä‘á»™ng cá»§a ngÆ°á»i dÃ¹ng mÃ  khÃ´ng sá»­ dá»¥ng 1 framework nÃ o khÃ¡c ngoÃ i máº¥y thÆ° viá»‡n kiá»ƒu jQuery :-s Vá»›i Angular, chÃºng ta cÃ³ 1 thuáº­t ngá»¯ lÃ  data binding, má»™t cÆ¡ cháº¿ phá»‘i há»£p nhá»‹p nhÃ ng cÃ¡c thÃ nh pháº§n cá»§a template vá»›i component. Viá»‡c nÃ y ráº¥t Ä‘Æ¡n giáº£n, chÃºng ta chá»‰ cáº§n thÃªm binding markup vÃ o HTML lÃ  Angular tá»± hiá»ƒu vÃ  connect chÃºng tá»›i Component. NhÆ° diagram bÃªn dÆ°á»›i, cÃ³ 4 kiá»ƒu data binding syntax. Má»—i kiá»ƒu Ä‘á»u cÃ³ chiá»u dá»¯ liá»‡u tá»« DOM tá»›i COMPONENT, tá»« COMPONENT tá»›i DOM, vÃ  cÃ³ cáº£ kiá»ƒu cÃ³ 2 chiá»u dá»¯ liá»‡u. á» vÃ­ dá»¥ HeroListComponent, template cÃ³ 3 kiá»ƒu: app/hero-list.component.html (binding) 123&lt;li&gt;&#123;&#123;hero.name&#125;&#125;&lt;/li&gt;&lt;hero-detail [hero]=\"selectedHero\"&gt;&lt;/hero-detail&gt;&lt;li (click)=\"selectHero(hero)\"&gt;&lt;/li&gt; Markup cÃ³ chá»©c nÄƒng hiá»ƒn thá»‹ giÃ¡ trá»‹ cá»§a componentâ€™s hero.name property vá»›i tháº» . Markup [hero] property binding truyá»n giÃ¡ trá»‹ cá»§a selectedHero tá»« parent HeroListComponent tá»›i cÃ¡c hero property cá»§a HeroDetailComponent. (click) event binding gá»i phÆ°Æ¡ng thá»©c selectHero khi user click vÃ o heroâ€™s name. Kiá»ƒu quan trá»ng thá»© 4, Ä‘Æ°á»£c gá»i lÃ  Two-way data binding. Chá»‰ vá»›i 1 markup notation Ä‘Æ¡n giáº£n sá»­ dá»¥ng ngModel directive, ta cÃ³ thá»ƒ káº¿t há»£p viá»‡c binding event vÃ  property. app/hero-detail.component.html (ngModel) 1&lt;input [(ngModel)]=\"hero.name\"&gt; Angular xá»­ lÃ½ toÃ n bá»™ data bindings trÃªn má»—i JavaScript event, xuáº¥t phÃ¡t tá»« gá»‘c cá»§a cÃ¢y application component duyá»‡t tá»›i toÃ n bá»™ components lÃ¡. Data binding Ä‘Ã³ng má»™t vai trÃ² quan trá»ng trong viá»‡c giao tiáº¿p giá»¯a template vÃ  component. Data binding cÃ²n lÃ  cÃ´ng cá»¥ giao tiáº¿p giá»¯a parent vÃ  child components. DirectivesAngular templates lÃ  dynamic. Khi á»©ng dá»¥ng Angular thá»±c hiá»‡n render template, chÃºng transforms DOM theo cÃ¡c lá»‡nh nháº­n Ä‘Æ°á»£c tá»« directives. Má»™t directive lÃ  má»™t class báº¯t Ä‘áº§u vá»›i @Directive decorator. CÃ³ thá»ƒ coi má»™t component lÃ  má»™t directive-vá»›i-má»™t-template; @Component decorator thá»±c cháº¥t lÃ  má»™t @Directive decorator káº¿ thá»«a tá»« template-oriented features. While a component is technically a directive, components are so distinctive and central to Angular applications that this architectural overview separates components from directives. CÃ¢u trÃ­ch dáº«n trÃªn cho chÃºng ta lÃ½ do táº¡i sao chÃºng ta láº¡i tÃ¡ch Component ra khá»i Directive trong kiáº¿n trÃºc Angular. CÃ³ 2 loáº¡i directives: structural vÃ  attribute directives. ChÃºng xuáº¥t hiá»‡n giá»¯a element tag nhÆ° 1 thuá»™c tÃ­nh (attributes). Structural directives tÃ¹y chá»‰nh layout báº±ng cÃ¡ch thÃªm má»›i, xÃ³a bá» vÃ  thay tháº¿ elements trong DOM. VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y sá»­ dá»¥ng 2 loáº¡i built-in structural directives: app/hero-list.component.html (structural) 12&lt;li *ngFor=\"let hero of heroes\"&gt;&lt;/li&gt;&lt;hero-detail *ngIf=\"selectedHero\"&gt;&lt;/hero-detail&gt; *ngFor giÃºp liá»‡t kÃª cÃ¡c hero tá»« máº£ng heroes trong má»—i tháº» &lt;li&gt; *ngIf include HeroDetail component náº¿u cÃ³ má»™t hero Ä‘Æ°á»£c select. Attribute directives thay tháº¿ appearance hoáº·c behavior cá»§a cÃ¡c element. BÃªn trong templates, chÃºng cháº³ng cÃ³ gÃ¬ khÃ¡c cÃ¡c HTML attributes thÃ´ng thÆ°á»ng, ngoáº¡i trá»« tÃªn :)) ngModel directive, implements two-way data binding, lÃ  má»™t vÃ­ dá»¥ cá»§a attribute directive. ngModel thay Ä‘á»•i behavior cá»§a element (VÃ­ dá»¥ tiÃªu biá»ƒu lÃ  cÃ¡c &lt;input&gt;) báº±ng cÃ¡ch thiáº¿t láº­p value property hiá»ƒn thá»‹ ra cÅ©ng nhÆ° thay Ä‘á»•i chÃºng theo events. app/hero-detail.component.html (ngModel) 1&lt;input [(ngModel)]=\"hero.name\"&gt; NgoÃ i ra, chÃºng ta cÃ²n nhiá»u directives cÃ³ thá»ƒ chá»‰nh sá»­a cáº¥u trÃºc layout (ngSwitch) hoáº·c thay Ä‘á»•i DOM elements vÃ  components (ngStyle vÃ  ngClass). DÄ© nhiÃªn, báº¡n cÅ©ng cÃ³ thá»ƒ tá»± viáº¿t má»™t directives. Components nhÆ° HeroListComponent chÃ­nh lÃ  má»™t loáº¡i custom directive. Services Service cÃ³ thá»ƒ lÃ  báº¥y ká»³ giÃ¡ trá»‹, hÃ m, class,â€¦ tÃ­nh nÄƒng nÃ o cáº§n thiáº¿t cho á»©ng dá»¥ng cá»§a báº¡n hoáº¡t Ä‘á»™ng. Háº§u háº¿t má»i thá»© Ä‘á» cÃ³ thá»ƒ trá»Ÿ thÃ nh service (lol). Má»™t service Ä‘iá»ƒn hÃ¬nh lÃ  má»™t class Ä‘Æ°á»£c thu háº¹p láº¡i trong má»™t má»¥c Ä‘Ã­ch rÃµ rÃ ng. VÃ­ dá»¥: logging service data service message bus tax calculator application configuration KhÃ´ng cÃ³ má»™t chÃºt Ä‘áº·c trÆ°ng cá»§a Angular vá» services. Angular cÅ©ng khÃ´ng cÃ³ báº¥t ká»³ Ä‘á»‹nh nghÄ©a nÃ o vá» service. No service base class, and no place to register a service. Tuy nhiÃªn services láº¡i lÃ  ná»n táº£ng cá»§a báº¥t ká»³ á»©ng dá»¥ng Angular nÃ o. Components cÅ©ng lÃ  má»™t services. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t service class cÃ³ nhiá»‡m vá»¥ logs lÃªn browser console: app/logger.service.ts (class) 12345export class Logger &#123; log(msg: any) &#123; console.log(msg); &#125; error(msg: any) &#123; console.error(msg); &#125; warn(msg: any) &#123; console.warn(msg); &#125;&#125; CÃ²n Ä‘Ã¢y lÃ  HeroService cÃ³ nhiá»‡m vá»¥ láº¥y vá» máº£ng cÃ¡c heroes vÃ  tráº£ vá» chÃºng cÃ¹ng vá»›i resolved Promise. HeroService phá»¥ thuá»™c vÃ o Logger service vÃ  BackendService khÃ¡c náº¯m giá»¯ viá»‡c communication vá»›i server. app/hero.service.ts (class) 12345678910111213141516export class HeroService &#123; private heroes: Hero[] = []; constructor( private backend: BackendService, private logger: Logger) &#123; &#125; ) getHeroes() &#123; this.backend.getAll(Hero).then( (heroes: Hero[]) =&gt; &#123; this.logger.log(`Fetched $&#123;heroes.length&#125; heroes.`); this.heroes.push(...heroes); // fill cache &#125;); return this.heroes; &#125;&#125; Services are everywhere. Component classes nhÆ° má»™t miáº¿ng thá»‹t náº¡c khÃ´ng cÃ³ má»¡ =)) . KhÃ´ng cÃ³ báº¥t kÃ¬ Ä‘oáº¡n code nÃ o fetch data tá»« server, validate user input, hoáº·c log lÃªn console. Táº¥t cÃ¡c cÃ¡c tasks Ä‘Ã³ Ä‘Æ°á»£c giao cho services. CÃ´ng viá»‡c cá»§a má»™t component lÃºc nÃ y khÃ´ng hÆ¡n viá»‡c cho phÃ©p ngÆ°á»i sá»­ dá»¥ng tráº£i nghiá»‡m dá»‹ch vá»¥. Äá»©ng giá»¯a view (rendered bá»Ÿi template) vÃ  táº§ng application logic. Khi code Angular, khÃ´ng ai Ã©p báº¡n lÃ m theo parttern nÃ y, cÅ©ng khÃ´ng quy Ä‘á»‹nh nguyÃªn táº¯c gÃ¬ vá» service, tuy nhiÃªn cháº¯c háº³n má»i ngÆ°á»i sáº½ khÃ´ng phÃ n nÃ n náº¿u báº¡n hoÃ n thÃ nh 1 component vá»›i hÆ¡n 3000 lines code =)) Angular giÃºp ta thá»±c hiá»‡n cÃ¡c nguyÃªn tÃ¡c nÃ y dá»… dÃ ng hÆ¡n báº±ng cÃ¡ch support Dependency injection. Dependency injection Dependency injection lÃ  má»™t cÃ¡ch cung cáº¥p cÃ¡c new instance cá»§a má»™t class cÃ¹ng vá»›i cÃ¡c dependencies phá»¥ thuá»™c mÃ  nÃ³ cáº§n. Háº§u háº¿t cÃ¡c dependencies lÃ  services. Angular sá»­ dá»¥ng dependency injection Ä‘á»ƒ chuáº©n bá»‹ má»™t new component cÃ¹ng vá»›i cÃ¡c services mÃ  nÃ³ cáº§n.@Viá»‡c khai bÃ¡o cÃ¡c services cáº§n thiáº¿t cho má»™t component cÅ©ng vá»›i kiá»ƒu dá»¯ liá»‡u cá»§a nÃ³ Ä‘Æ°á»£c thá»±c hiá»‡n trong chÃ­nh constructor parameters. VÃ­ dá»¥ vá» constructor cá»§a HeroListComponent vÃ  HeroService á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  má»™t dependency : app/hero-list.component.ts (constructor) 1constructor(private service: HeroService) &#123; &#125; Khi Angular khá»Ÿi táº¡o má»™t component, nÃ³ sáº½ há»i injector vá» cÃ¡c services mÃ  component cáº§n. Má»™t injector lÆ°u giá»¯ container cÃ¡c service instances Ä‘Ã£ Ä‘Æ°á»£c táº¡o trÆ°á»›c Ä‘Ã³. Náº¿u cÃ³ má»™t yÃªu cáº§u vá» service instance khÃ´ng cÃ³ trong container, injector sáº½ táº¡o vÃ  thÃªm má»›i nÃ³ rá»“i add nÃ³ vÃ o container trÆ°á»›c khi tráº£ láº¡i service cho Angular. Khi táº¥t cáº£ cÃ¡c request services Ä‘Æ°á»£c giáº£i quyáº¿t (resolved) vÃ  Ä‘Æ°á»£c hoÃ n thÃ nh (returned), Angular cÃ³ thá»ƒ gá»i cÃ¡c componentâ€™s constructor cÃ¹ng vá»›i cÃ¡c tham sá»‘ lÃ  cÃ¡c services. ÄÃ³ chÃ­nh lÃ  dependency injection. QuÃ¡ trÃ¬nh injection cá»§a HeroService cÃ³ thá»ƒ trÃ´ng giá»‘ng sÆ¡ Ä‘á»“ sau: Náº¿u injector khÃ´ng cÃ³ HeroService, Váº­y lÃ m thá»ƒ nÃ o Ä‘á»ƒ Angular biáº¿t nÆ¡i cáº§n láº¥y vÃ  táº¡o ra nÃ³ NhÆ° Ä‘Ã£ mÃ´ táº£ trÆ°á»›c Ä‘Ã³, báº¡n cáº§n pháº£i Ä‘Äƒng kÃ½ (registered) HeroService vá»›i provider cá»§a HeroComponent cÃ¹ng injector. Má»™t provider cÃ³ thá»ƒ create vÃ  return má»™t service. Báº¡n cÃ³ thá»ƒ register providers trong modules hoáº·c trong components. ThÃ´ng thÆ°á»ng, chÃºng ta add providers vÃ o root module, ez, ta cÃ³ instance cá»§a service tá»“n táº¡i á»Ÿ má»i nÆ¡i (ngon). app/app.module.ts (module providers) 12345providers: [ BackendService, HeroService, Logger], Má»™t cÃ¡ch khÃ¡c, ta cÃ³ thá»ƒ register á»Ÿ level component trong providers property cá»§a @Component metadata: app/hero-list.component.ts (component providers) 123456@Component(&#123; moduleId: module.id, selector: 'hero-list', templateUrl: 'hero-list.component.html', providers: [ HeroService ]&#125;) Registering á»Ÿ level component nghÄ©a lÃ  báº¡n cÃ³ thá»ƒ láº¥y ra cÃ¡c new instance cá»§a service vá»›i má»—i má»™t new instance cá»§a component Ä‘Ã³. CÃ¡c Ä‘iá»ƒm cáº§n nhá»› vá» dependency injection: Dependency injection Ä‘Æ°á»£c mÃ³c vÃ o Angular framework vÃ  cÃ³ thá»ƒ sá»­ dá»¥ng á»Ÿ má»i nÆ¡i. Injector cÃ³ 2 cÆ¡ cháº¿ chÃ­nh. Injector duy trÃ¬ má»™t container cÃ¡c service instances mÃ  chÃºng Ä‘Ã£ táº¡o ra. Injector cÃ³ thá»ƒ táº¡o má»›i service instance tá»« provider. Provider lÃ  nÆ¡i khai bÃ¡o cÃ¡ch táº¡o ra service. Register providers vá»›i injectors. THE ENDTham kháº£ohttps://angular.io/docs/ts/latest/guide/architecture.html","categories":[],"tags":[{"name":"angular","slug":"angular","permalink":"http://nthung2112.github.io/tags/angular/"},{"name":"architecture","slug":"architecture","permalink":"http://nthung2112.github.io/tags/architecture/"}]},{"title":"Kiáº¿n trÃºc tá»•ng quan cá»§a Angular 2/4  - P1","slug":"Kien-truc-tong-quan-cua-Angular-2-4-P1","date":"2017-10-01T08:43:49.000Z","updated":"2017-10-01T09:59:54.207Z","comments":true,"path":"2017/10/Kien-truc-tong-quan-cua-Angular-2-4-P1.html","link":"","permalink":"http://nthung2112.github.io/2017/10/Kien-truc-tong-quan-cua-Angular-2-4-P1.html","excerpt":"ÄÃ´i Ä‘iá»u vá» Angular 2 Hiá»ƒu Ä‘Æ¡n giáº£n lÃ  má»™t framework Ä‘á»ƒ giÃºp láº­p trÃ¬nh viÃªn xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng client vá»›i HTML vÃ  JavaScript/Typescript â€¦ Viá»‡c render HTML templates sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi Angularized-markup, viá»‡c cáº§n lÃ m cá»§a má»™t developer lÃ  viáº¿t cÃ¡c component Ä‘á»ƒ quáº£n lÃ½ template, thÃªm má»›i cÃ¡c xá»­ lÃ½ logic bÃªn trong cÃ¡c service, Ä‘Ã³ng gÃ³i component vÃ  service thÃ nh má»™t module. Má»™t á»©ng dá»¥ng Angular2 Ä‘Æ°á»£c cháº¡y dá»±a trÃªn viá»‡c bootstrapping root module vÃ o Angularâ€™s bootstrapper.","text":"ÄÃ´i Ä‘iá»u vá» Angular 2 Hiá»ƒu Ä‘Æ¡n giáº£n lÃ  má»™t framework Ä‘á»ƒ giÃºp láº­p trÃ¬nh viÃªn xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng client vá»›i HTML vÃ  JavaScript/Typescript â€¦ Viá»‡c render HTML templates sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi Angularized-markup, viá»‡c cáº§n lÃ m cá»§a má»™t developer lÃ  viáº¿t cÃ¡c component Ä‘á»ƒ quáº£n lÃ½ template, thÃªm má»›i cÃ¡c xá»­ lÃ½ logic bÃªn trong cÃ¡c service, Ä‘Ã³ng gÃ³i component vÃ  service thÃ nh má»™t module. Má»™t á»©ng dá»¥ng Angular2 Ä‘Æ°á»£c cháº¡y dá»±a trÃªn viá»‡c bootstrapping root module vÃ o Angularâ€™s bootstrapper. Dá»±a vÃ o sÆ¡ Ä‘á»“ kiáº¿n trÃºc trÃªn ta cÃ³ thá»ƒ liá»‡t kÃª ra 8 thÃ nh pháº§n chÃ­nh táº¡o ra má»™t á»©ng dá»¥ng Angular 2: Module Component Template Metadata Data Binding Service Directive Dependency Injection ModulesAngular apps sá»­ dá»¥ng há»‡ thá»‘ng module, hay cÃ²n gá»i lÃ  Angular modules hoáº·c NgModules.Trong bÃ i viáº¿t nÃ y chá»§ yáº¿u lÃ  giá»›i thiá»‡u cÃ¡c modules; Äá»ƒ tÃ¬m hiá»ƒu sÃ¢u hÆ¡n xin vui lÃ²ng tham kháº£o Angular modules.Má»—i á»©ng dá»¥ng Angular Ä‘á»u pháº£i cÃ³ Ã­t nháº¥t má»™t Angular module class, lÃ  root module, hay cÃ²n Ä‘Æ°á»£c Ä‘áº·t tÃªn theo quy Æ°á»›c lÃ  AppModule. Trong cÃ¡c á»©ng dá»¥ng nhá», Ä‘Ã´i khi chá»‰ cÃ³ duy nháº¥t 1 module chÃ­nh lÃ  root module , tuy nhiÃªn á»Ÿ háº§u háº¿t cÃ¡c á»©ng dá»¥ng, cÃ²n cÃ³ thÃªm nhiá»u feature modules.DÃ¹ lÃ  root hay lÃ  feature module, thÃ¬ má»—i class Ä‘á»u cÃ³ @NgModule decorator. Decorators lÃ  design pattern thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thay Ä‘á»•i hÃ nh vi, chá»©c nÄƒng cá»§a JavaScript classes. Angular cung cáº¥p sáºµn nhiá»u decorators gáº¯n cÃ¡c metadata vÃ o cÃ¡c classes Ä‘á»ƒ dá»… dÃ ng biáº¿t Ä‘Æ°á»£c Ã½ nghÄ©a vÃ  cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng. NgModule lÃ  má»™t decorator function (single metadata object) cÃ³ cÃ¡c thuá»™c tÃ­nh mÃ´ táº£ cÃ¡c module. CÃ¡c thuá»™c tÃ­nh quan trá»ng lÃ : declarations - Khai bÃ¡o cÃ¡c View classes thuá»™c vá» module. Angular cÃ³ 3 loáº¡i view classes: components, directives, pipes. exports - Má»™t táº­p con cá»§a declarations kháº£ dá»¥ng trong component templates cá»§a cÃ¡c module khÃ¡c. imports - CÃ¡c module khÃ¡c Ä‘Æ°á»£c exported cÃ¡c classes cáº§n thiáº¿t bá»Ÿi component templates Ä‘Æ°á»£c declarations bÃªn trong module nÃ y. providers - Táº¡o ra cÃ¡c global collection of services cÃ³ thá»ƒ truy cáº­p á»Ÿ má»i ngÃµ ngÃ¡ch cá»§a á»©ng dá»¥ng. bootstrap - Main application view, hay cÃ²n Ä‘Æ°á»£c gá»i lÃ  root component, chá»©a táº¥t cáº£ cÃ¡c app views. Duy nháº¥t root module cÃ³ thuá»™c tÃ­nh bootstrap. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t root module Ä‘Æ¡n giáº£n: app/app.module.ts 12345678910import &#123; NgModule &#125; from '@angular/core';import &#123; BrowserModule &#125; from '@angular/platform-browser';@NgModule(&#123; imports: [ BrowserModule ], providers: [ Logger ], declarations: [ AppComponent ], exports: [ AppComponent ], bootstrap: [ AppComponent ]&#125;)export class AppModule &#123; &#125; Trong trÆ°á»ng há»£p nÃ y, thuá»™c tÃ­nh export cá»§a AppComponent chá»‰ Ä‘Æ¡n giáº£n mÃ´ táº£ cÃ¡ch export; nÃ³ thÃ¬ khÃ´ng cáº§n thiáº¿t trong thá»±c táº¿. Má»™t root module khÃ´ng cÃ³ lÃ½ do gÃ¬ Ä‘á»ƒ export báº¥t cá»© Ä‘iá»u gÃ¬, Ä‘Æ¡n giáº£n lÃ  cÃ¡c component khÃ¡c ko cáº§n thiáº¿t pháº£i import root module. Khá»Ÿi cháº¡y á»©ng dá»¥ng báº±ng cÃ¡ch bootstrapping root module. Trong quÃ¡ trÃ¬nh development, chÃºng ta sáº½ bootstrap AppModule trong file main.ts. app/main.ts 1234import &#123; platformBrowserDynamic &#125; from '@angular/platform-browser-dynamic';import &#123; AppModule &#125; from './app.module';platformBrowserDynamic().bootstrapModule(AppModule); Angular modules vs. JavaScript modulesAngular Module: Class decorator vá»›i @NgModule â€” Ä‘Ã¢y lÃ  1 má»™t tÃ­nh tÄƒng cÆ¡ báº£n Angular. Javascript Module: JavaScript cÅ©ng cÃ³ má»™t há»‡ thá»‘ng module Ä‘á»ƒ quáº£n lÃ½ cÃ¡c JavaScript objects. NÃ³ hoÃ n toÃ n khÃ¡c biá»‡t vÃ  khÃ´ng liÃªn quan tá»›i Angular module system. Trong JavaScript má»—i file lÃ  má»™t module vÃ  táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong file Ä‘á»u thuá»™c vá» module Ä‘Ã³. CÃ¡c module khai bÃ¡o Ä‘á»‘i tÆ°á»£ng public báº±ng cÃ¡ch sá»­ dá»¥ng tá»« khÃ³a export. CÃ¡c module JavaScript khÃ¡c sá»­ dá»¥ng tá»« khÃ³a import Ä‘á»ƒ truy cáº­p vÃ o Ä‘á»‘i tÆ°á»£ng public tá»« cÃ¡c module khÃ¡c. 12import &#123; NgModule &#125; from '@angular/core';import &#123; AppComponent &#125; from './app.component'; 1export class AppModule &#123; &#125; TÃ¬m hiá»ƒu thÃªm vá» Javascript Module. Angular libraries Angular Ä‘Æ°á»£c vÃ­ nhÆ° 1 con tÃ u chuyÃªn chá»Ÿ cÃ¡c JavaScript modules. CÅ©ng cÃ³ thá»ƒ vÃ­ lÃ  cÃ¡c library modules. Má»—i Angular library name Ä‘á»u báº¯t Ä‘áº§u vá»›i tiá»n tá»‘ @angular.Báº¡n cÃ i Ä‘áº·t chÃºng vá»›i npm package manager vÃ  import cÃ¡c pháº§n láº¡i báº±ng cÃ¢u lá»‡nh JavaScript import. Láº¥y vÃ­ dá»¥, import Angularâ€™s Component decorator tá»« @angular/core library nhÆ° sau: 1import &#123; Component &#125; from '@angular/core'; Báº¡n cÅ©ng cÃ³ thá»ƒ import Angular modules tá»« Angular libraries sá»­ dá»¥ng cÃ¢u lá»‡nh JavaScript import: 1import &#123; BrowserModule &#125; from '@angular/platform-browser'; Trong vÃ­ dá»¥ vá» root module bÃªn trÃªn, application module cáº§n BrowserModule. Äá»ƒ truy cáº­p tá»›i BrowserModule, ta thÃªm vÃ o @NgModule metadata imports: 1imports: [ BrowserModule ], Theo cÃ¡ch nÃ y, ta Ä‘ang sá»­ dá»¥ng cáº£ Angular and JavaScript module systems cÃ¹ng nhau. ComponentsMá»™t component Ä‘iá»u khiá»ƒn tá»«ng chá»©c nÄƒng trÃªn mÃ n hÃ¬nh view.VÃ­ dá»¥, view sau Ä‘Æ°á»£c Ä‘iá»u khiá»ƒn bá»Ÿi cÃ¡c components: The app root vá»›i navigation links. The list of heroes. The hero editor. ChÃºng ta cáº§n Ä‘á»‹nh nghÄ©a componentâ€™s application logicâ€”nhá»¯ng gÃ¬ sáº½ support trÃªn viewâ€”bÃªn trong má»™t class. Class sáº½ tÆ°Æ¡ng tÃ¡c vá»›i view thÃ´ng qua API cá»§a cÃ¡c properties vÃ  methods. VÃ­ dá»¥, HeroListComponent cÃ³ má»™t heroes property tráº£ vá» 1 máº£ng cÃ¡c heroes láº¥y tá»« service. HeroListComponent cÅ©ng cÃ³ sáºµn phÆ°Æ¡ng thá»©c selectHero() Ä‘á»ƒ get cÃ¡c thuá»™c tÃ­nh cá»§a selectedHero khi ngÆ°á»i dÃ¹ng chá»n user tá»« danh sÃ¡ch. app/hero-list.component.ts (class) 123456789101112export class HeroListComponent implements OnInit &#123; heroes: Hero[]; selectedHero: Hero; constructor(private service: HeroService) &#123; &#125; ngOnInit() &#123; this.heroes = this.service.getHeroes(); &#125; selectHero(hero: Hero) &#123; this.selectedHero = hero; &#125;&#125; Angular creates, updates, vÃ  destroys components cÃ¹ng vá»›i user di chuyá»ƒn xuyÃªn suá»‘t trong application. App cÃ³ thá»ƒ láº¥y cÃ¡c action á»Ÿ tá»«ng thá»i Ä‘iá»ƒm tron lifecycle thÃ´ng qua lifecycle hooks, nhÆ° ngOnInit() Ä‘Æ°á»£c khai bÃ¡o bÃªn trÃªn. TemplatesChÃºng ta Ä‘á»‹nh nghÄ©a componentâ€™s view vá»›i template cá»§a nÃ³. Má»™t template lÃ  mÃ£ code HTML giÃºp Angular render component. Má»™t template cÃ³ thá»ƒ cÃ³ Ä‘Ã´i chÃºt khÃ¡c biá»‡t vá»›i HTML thÃ´ng thÆ°á»ng, Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ cho template cá»§a HeroListComponent: app/hero-list.component.html 12345678&lt;h2&gt;Hero List&lt;/h2&gt;&lt;p&gt;&lt;i&gt;Pick a hero from the list&lt;/i&gt;&lt;/p&gt;&lt;ul&gt; &lt;li *ngFor=\"let hero of heroes\" (click)=\"selectHero(hero)\"&gt; &#123;&#123;hero.name&#125;&#125; &lt;/li&gt;&lt;/ul&gt;&lt;hero-detail *ngIf=\"selectedHero\" [hero]=\"selectedHero\"&gt;&lt;/hero-detail&gt; Máº·c dÃ¹ template nÃ y sá»­ dá»¥ng cÃ¡c thÃ nh pháº§n cÆ¡ báº£n HTML nhÆ° &lt;h2&gt; vÃ  &lt;p&gt;, nhÆ°ng cÅ©ng cÃ³ Ä‘Ã´i chÃºt khÃ¡c biá»‡t nhÆ° *ngFor, , (click), [hero], vÃ  &lt;hero-detail&gt; sá»­ dá»¥ng Angularâ€™s template syntax. TrÃªn dÃ²ng cuá»‘i cÃ¹ng cá»§a template, &lt;hero-detail&gt; tag lÃ  custom element thá»ƒ hiá»‡n cho new component, HeroDetailComponent. HeroDetailComponent lÃ  má»™t component khÃ¡c vá»›i HeroListComponent chÃºng ta Ä‘ang xem. HeroDetailComponent mÃ´ táº£ chi tiáº¿t tá»«ng hero, mÃ  ngÆ°á»i dÃ¹ng Ä‘Ã£ select tá»« HeroListComponent. HeroDetailComponent lÃ  con (child) cá»§a HeroListComponent. Element cÃ³ thá»ƒ Ä‘Æ°á»£c code thoáº£i mÃ¡i giá»¯a native HTML elements MetadataMetadata giÃºp Angular biáº¿t cÃ¡ch xá»­ lÃ½ cÃ¡c class. Quay trá»Ÿ láº¡i code HeroListComponent bÃªn trÃªn, ta tháº¥y ráº±ng Ä‘Ã³ chá»‰ Ä‘Æ¡n giáº£n lÃ  1 class, ko cÃ³ dáº¥u áº¥n gÃ¬ cá»§a 1 framework cáº£, no â€œAngularâ€ omg Thá»±c táº¿, HeroListComponent thá»±c cháº¥t chá»‰ lÃ  1 class. NÃ³ khÃ´ng pháº£i lÃ  1 component cho tá»›i khi ta khai bÃ¡o nÃ³ vá»›i Angular. Äá»ƒ khai bÃ¡o vá»›i Angular ráº±ng HeroListComponent lÃ  1 component, ta sáº½ gáº¯n tháº» metadata vÃ o class nÃ y. Trong TypeScript, viá»‡c gáº¯n tháº» metadata sá»­ dá»¥ng decorator. DÆ°á»›i Ä‘Ã¢y lÃ  metadata cho HeroListComponent: app/hero-list.component.ts (metadata) 123456789@Component(&#123; moduleId: module.id, selector: 'hero-list', templateUrl: 'hero-list.component.html', providers: [ HeroService ]&#125;)export class HeroListComponent implements OnInit &#123;/* . . . */&#125; Decorator á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  @Component, Ä‘á»‹nh nghÄ©a class ngay bÃªn dÆ°á»›i nhÆ° má»™t component class. @Component decorator khá»Ÿi táº¡o má»™t object vá»›i cÃ¡c thÃ´ng tin mÃ  Angular cáº§n thá»ƒ táº¡o vÃ  biá»ƒu diá»…n má»™t component &amp; view. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ option cáº¥u hÃ¬nh cho @Component: moduleId: Táº­p há»£p cÃ¡c source dá»±a trÃªn address (module.id) vá»›i module-relative URLs nhÆ° templateUrl. selector: CSS selector ra lá»‡nh cho Angular create vÃ  insert má»™t thá»ƒ hiá»‡n component khi nÃ³ tÃ¬m tháº¥y tag trong parent HTML. VÃ­ dá»¥, náº¿u má»™t appâ€™s HTML cÃ³ chá»©a , thÃ¬ Angular sáº½ inserts má»™t instance cá»§a HeroListComponent view giá»¯a cÃ¡c tags. templateUrl: module-relative address cá»§a componentâ€™s HTML template. providers: Máº£ng cÃ¡c dependency injection providers cho services cáº§n thiáº¿t Ä‘á»ƒ component hoáº¡t Ä‘á»™ng. ÄÃ¢y lÃ  1 cÃ¡ch khai bÃ¡o vá»›i Angular ráº±ng, componentâ€™s constructo yÃªu cáº§u 1 HeroService Ä‘á»ƒ nÃ³ cÃ³ thá»ƒ thu Ä‘Æ°á»£c danh sÃ¡ch cÃ¡c heroes phá»¥c vá»¥ viá»‡c hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh. Metadata trong @Component giÃºp Angular biáº¿t cÃ¡ch láº¥y nhá»¯ng thÃ nh pháº§n chÃ­nh táº¡o nÃªn component.Template, Metadata, vÃ  Component Ä‘Æ°á»£c sá»­ dá»¥ng cÃ¹ng vá»›i nhau vá»›i má»¥c Ä‘Ã­ch táº¡o nÃªn View.NgoÃ i @Component, chÃºng ta cÃ²n cÃ³ @Injectable, @Input, vÃ  @Output lÃ  nhá»¯ng decorators ráº¥t hay Ä‘Æ°á»£c sá»­ dá»¥ng. Tham kháº£ohttps://angular.io/docs/ts/latest/guide/architecture.html","categories":[],"tags":[{"name":"angular","slug":"angular","permalink":"http://nthung2112.github.io/tags/angular/"},{"name":"architecture","slug":"architecture","permalink":"http://nthung2112.github.io/tags/architecture/"}]},{"title":"CÃ¡c ká»¹ thuáº­t SEO tá»‘i thiá»ƒu mÃ  developer cáº§n náº¯m vá»¯ng trong láº­p trÃ¬nh web","slug":"Cac-ky-thuat-SEO-toi-thieu-ma-developer-can-nam-vung-trong-lap-trinh-web","date":"2017-10-01T08:28:15.000Z","updated":"2017-10-01T08:40:38.907Z","comments":true,"path":"2017/10/Cac-ky-thuat-SEO-toi-thieu-ma-developer-can-nam-vung-trong-lap-trinh-web.html","link":"","permalink":"http://nthung2112.github.io/2017/10/Cac-ky-thuat-SEO-toi-thieu-ma-developer-can-nam-vung-trong-lap-trinh-web.html","excerpt":"Trong khi Ä‘ang lÃ m viá»‡c táº¡i cÃ´ng ty Basic (1 cÃ´ng ty cá»§a Nháº­t hoáº¡t Ä‘á»™ng trong lÄ©nh vá»±c Web &amp; Media Marketing, váº­n hÃ nh 2 website ferret vÃ  ferretOne), tÃ´i Ä‘Æ°á»£c giao nhiá»‡m vá»¥ tá»‘i Æ°u hoÃ¡ cÃ´ng cá»¥ tÃ¬m kiáº¿m cho website phocase (1 website bÃ¡n phá»¥ kiá»‡n Ä‘iá»‡n thoáº¡i), Ä‘á»ƒ hoÃ n thÃ nh cÃ´ng viá»‡c nÃ y tÃ´i Ä‘Ã£ pháº£i tÃ¬m hiá»ƒu vÃ  há»c thÃªm cÃ¡c kiáº¿n thá»©c, tiá»‡n Ä‘Ã¢y xin Ä‘Æ°á»£c tá»•ng há»£p láº¡i vÃ  chia sáº» vá»›i cÃ¡c báº¡n nhá»¯ng Ä‘iá»u cáº§n nhá»› vá» SEO vá»›i vai trÃ² lÃ  1 ká»¹ sÆ°. TLDR; BÃ i viáº¿t nÃ y dÃ nh cho nhiá»u Ä‘á»‘i tÆ°á»£ng nÃªn tÆ°Æ¡ng Ä‘á»‘i dÃ i, hÃ£y chá»n lá»c cÃ¡c kiáº¿n thá»©c cáº§n thiáº¿t cho mÃ¬nh thÃ´i nhÃ© :v","text":"Trong khi Ä‘ang lÃ m viá»‡c táº¡i cÃ´ng ty Basic (1 cÃ´ng ty cá»§a Nháº­t hoáº¡t Ä‘á»™ng trong lÄ©nh vá»±c Web &amp; Media Marketing, váº­n hÃ nh 2 website ferret vÃ  ferretOne), tÃ´i Ä‘Æ°á»£c giao nhiá»‡m vá»¥ tá»‘i Æ°u hoÃ¡ cÃ´ng cá»¥ tÃ¬m kiáº¿m cho website phocase (1 website bÃ¡n phá»¥ kiá»‡n Ä‘iá»‡n thoáº¡i), Ä‘á»ƒ hoÃ n thÃ nh cÃ´ng viá»‡c nÃ y tÃ´i Ä‘Ã£ pháº£i tÃ¬m hiá»ƒu vÃ  há»c thÃªm cÃ¡c kiáº¿n thá»©c, tiá»‡n Ä‘Ã¢y xin Ä‘Æ°á»£c tá»•ng há»£p láº¡i vÃ  chia sáº» vá»›i cÃ¡c báº¡n nhá»¯ng Ä‘iá»u cáº§n nhá»› vá» SEO vá»›i vai trÃ² lÃ  1 ká»¹ sÆ°. TLDR; BÃ i viáº¿t nÃ y dÃ nh cho nhiá»u Ä‘á»‘i tÆ°á»£ng nÃªn tÆ°Æ¡ng Ä‘á»‘i dÃ i, hÃ£y chá»n lá»c cÃ¡c kiáº¿n thá»©c cáº§n thiáº¿t cho mÃ¬nh thÃ´i nhÃ© :v â˜… Báº¡n cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c gÃ¬ khi Ä‘á»c bÃ i viáº¿t nÃ y ? Sá»± tÆ°Æ¡ng tÃ¡c giá»¯a cÃ¡c Marketer vÃ  Director trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n Nháº­n biáº¿t cÃ¡c Ä‘oáº¡n code mÃ  vÃ´ tÃ¬nh lÃ m giáº£m thá»© háº¡ng cá»§a website trÃªn bá»™ mÃ¡y tÃ¬m kiáº¿m Äá» xuáº¥t cÃ¡c giáº£i phÃ¡p SEO cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c á»Ÿ phÃ­a Developer Náº¯m báº¯t Ä‘Æ°á»£c bá»©c tranh/bá»‘i cáº£nh SEO nÄƒm 2017 Náº¯m báº¯t chÃ­nh xÃ¡c tÃ i liá»‡u Ä‘Æ°á»£c Google chÃ­nh thá»©c cÃ´ng khaiCÃ³ thá»ƒ tÃ¬m kiáº¿m ráº¥t nhiá»u thÃ´ng tin trÃªn cÃ¡c trang web, nhÆ°ng tá»‘i thiá»ƒu thÃ¬ hÃ£y thá»±c hiá»‡n nhá»¯ng chÃ­nh sÃ¡ch Ä‘Æ°á»£c Google Ä‘Æ°a ra vá» rule cá»§a 1 website. Search Engine Optimization Starter Guide NgoÃ i ra báº¡n cÅ©ng cÃ³ thá»ƒ tÃ¬m hiá»ƒu thÃªm cÃ¡c thÃ´ng tin táº¡i website chÃ­nh thá»©c cá»§a Google: Official news on crawling and indexing sites for the Google index â˜… Kiá»ƒm tra láº¡i cÃ¡c biá»‡n phÃ¡p SEO trÆ°á»›c Ä‘Ã³ Ä‘á»ƒ náº¯m Ä‘Æ°á»£c cÃ¡c thÃ´ng tin há»¯u Ã­chHÃ£y tÃ¬m kiáº¿m trong Search Console Help cÃ¡c tá»« khoÃ¡ liÃªn quan tá»›i cÃ¡c cÃ´ng viá»‡c Ä‘Ã£ thá»±c hiá»‡n tá»« trÆ°á»›c, ráº¥t cÃ³ thá»ƒ báº¡n sáº½ phÃ¡t hiá»‡n ra nhá»¯ng ká»¹ thuáº­t bá»‹ bá» sÃ³t mÃ  mÃ¬nh khÃ´ng há» nghÄ© tá»›i. Cháº³ng háº¡n náº¿u nhÆ° báº¡n cÃ³ sá»­ dá»¥ng tháº» alt vá»›i áº£nh trÃªn website, thÃ¬ tÃ´i khuyÃªn báº¡n nÃªn thá»­ tÃ¬m kiáº¿m trong Search Console Help cÃ¡c áº£nh Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh tag trÆ°á»›c Ä‘Ã³.Viá»‡c nhá»“i nhÃ©t quÃ¡ nhiá»u keyword trong tháº» alt cÃ³ thá»ƒ khiáº¿n search engineer Ä‘Æ°a vÃ o danh sÃ¡ch spam, Ä‘Ã¢y cÅ©ng cÃ³ thá»ƒ lÃ  cÃ¡ch Ä‘á»ƒ báº¡n phÃ²ng trÃ¡nh viá»‡c Ä‘Ã³.Search Console Help ChÃ­nh sÃ¡ch cá»§a Google Ä‘á»‘i vá»›i Mobile SiteMobile First Index (MFI)NgÃ y 5/11/2016, Google chÃ­nh thá»©c cÃ´ng bá»‘ chÃ­nh sÃ¡ch cá»§a mÃ¬nh Ä‘á»‘i vá»›i Mobile site: Mobile-first Indexing Vá» cÆ¡ báº£n, cho tá»›i thá»i Ä‘iá»ƒm hiá»‡n táº¡i ngoÃ i rank Ä‘Æ°á»£c Ä‘Ã¡nh cho cÃ¡c website hÆ°á»›ng PC Desktop, Google cÃ²n bá»• sung thÃªm rank cho cÃ¡c website chÃº trá»ng ná»™i dung vÃ  thiáº¿t káº¿ tá»›i SP (Smart phone) NgÃ y 5/4/2017, Táº¡i há»™i nghá»‹ Next10x Conference, CÃ¡c ká»¹ sÆ° cá»§a Google Ä‘Ã£ chÃ­nh thá»©c cÃ´ng bá»‘ má»¥c tiÃªu Ã¡p dá»¥ng vÃ o trong nÄƒm nay, tuy nhiÃªn chÆ°a cÃ´ng bá»‘ chÃ­nh thá»©c khoáº£ng thá»i gian. TrÆ°á»›c khi Ã¡p dá»¥ng MFI (Hiá»‡n táº¡i) PC Search: Hiá»ƒn thá»‹ theo trÃ¬nh tá»± cá»§a rank cho ná»™i dung PC site SP Search: Hiá»ƒn thá»‹ theo trÃ¬nh tá»± cá»§a rank cho ná»™i dung PC site Sau khi Ã¡p dá»¥ng MFI (ChÆ°a xÃ¡c Ä‘á»‹nh thá»i gian) PC Search: Hiá»ƒn thá»‹ theo trÃ¬nh tá»± chÃº trá»ng vÃ o rank cho ná»™i dung SP site (KhÃ´ng cÃ³ nghÄ©a lÃ  khÃ´ng tÃ­nh Ä‘áº¿n rank cá»§a PC site) SP Search: Hiá»ƒn thá»‹ theo trÃ¬nh tá»± cá»§a rank cho ná»™i dung SP site â˜… CÃ¡c site cÃ³ kháº£ nÄƒng chá»‹u áº£nh hÆ°á»Ÿng CÃ³ sá»± khÃ¡c biá»‡n lá»›n giá»¯a phiÃªn báº£n PC vÃ  SP CÃ²n nhiá»u thÃ´ng tin tá»“n táº¡i trÃªn phiÃªn báº£n cho PC nhÆ°ng láº¡i ko cÃ³ trÃªn phiÃªn báº£n SP ÄÃ£ há»— trá»£ vÃ  cÃ³ chiáº¿n lÆ°á»£c SEO cho PC site nhÆ°ng láº¡i chÆ°a cÃ³ cho SP site NgoÃ i header vs footer ra, cÃ¡c ná»™i dung chÃ­nh lÃ  khÃ¡c nhau Cáº¥u trÃºc HTML khÃ¡c nhau Tá»‘c Ä‘á»™ hiá»ƒn thá»‹ cho SP site quÃ¡ cháº­m Mobile FriendlyNgÃ y 21/4/2015, Google cÃ´ng bá»‘ : thá»© tá»± xuáº¥t hiá»‡n trÃªn káº¿t quáº£ tÃ¬m kiáº¿m cÃ³ liÃªn quan tá»›i UI, UX trong trÆ°á»ng há»£p truy cáº­p trang web trÃªn Smart Phone DeviceRolling out the mobile-friendly update Chá»‰ áº£nh hÆ°á»Ÿng tá»›i thá»© tá»± xuáº¥t hiá»‡n káº¿t quáº£ tÃ¬m kiáº¿m trÃªn Mobile Deviceáº¢nh hÆ°á»Ÿng trong pháº¡m vi toÃ n bá»™ cÃ¡c ngÃ´n ngá»¯ trÃªn tháº¿ giá»›iÃp dá»¥ng cho cÃ¡c page riÃªng ráº½, chá»© khÃ´ng pháº£i toÃ n bá»™ trang web Náº¿u nhÆ° website Ä‘Ã³ khÃ´ng Ä‘Æ°á»£c coi lÃ  Mobile Friendly sáº½ cÃ³ thá»© tá»± tháº¥p vÃ  khÃ´ng Ä‘Æ°á»£c Æ°u tiÃªn xuáº¥t hiá»‡n trÃªn káº¿t quáº£ tÃ¬m kiáº¿m. Äiá»u nÃ y cÃ³ tÃ¡c Ä‘á»™ng trá»±c tiáº¿p tá»›i doanh thu cá»§a cÃ¡c website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ (EC site) Sá»­ dá»¥ng website sau, cÃ³ thá»ƒ kiá»ƒm tra tÃ­nh thÃ¢n thiá»‡n vá»›i thiáº¿t bá»‹ mobile cá»§a 1 trang webMobile Friendly Check â˜… CÃ¡c háº¡ng má»¥c cáº§n kiá»ƒm tra Font size cÃ³ thÃ­ch há»£p (&gt;= 16px) khÃ´ng? CÃ³ sá»­ dá»¥ng tháº» meta vÃ  chá»‰ Ä‘á»‹nh viewport cho mobile khÃ´ng? Khoáº£ng cÃ¡ch cá»§a cÃ¡c liÃªn káº¿t cÃ³ bá»‹ quÃ¡ háº¹p khÃ´ng? (phÃ²ng ngá»«a lá»—i) Ná»™i dung trang web cÃ³ bá»‹ trÃ n ra ngoÃ i mÃ n hÃ¬nh khÃ´ng? Website cÃ³ Ä‘Æ°á»£c hiá»ƒn thá»‹ trong vÃ²ng 3s khÃ´ng? (Náº¿u viá»‡c hiá»ƒn thá»‹ tá»‘n quÃ¡ &gt; 3s, thÃ¬ 40% ngÆ°á»i dÃ¹ng sáº½ thoÃ¡t trang web Ä‘Ã³) Äá»‘i vá»›i cÃ¡c website khÃ´ng thoáº£ mÃ£n tá»‘i thiá»ƒu cÃ¡c Ä‘iá»u kiá»‡n trÃªn sáº½ cÃ³ thá»ƒ cÃ³ cÃ³ thá»© háº¡ng tháº¥p trong káº¿t quáº£ tÃ¬m kiáº¿m. â˜… Mobile Friendly Support &amp; YÃªu cáº§u craw láº¡i websiteBáº±ng cÃ¡ch sá»­ dá»¥ng GoogleSearchConsole, báº¡n cÃ³ thá»ƒ náº¯m rÃµ Ä‘Æ°á»£c chi tiáº¿t cÃ¡c thÃ nh pháº§n trÃªn website mÃ¬nh khÃ´ng thoáº£ mÃ£n cÃ¡c háº¡ng má»¥c kiá»ƒm tra phÃ­a trÃªn.Google Webmaster Home Sau khi giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» trÃªn, hÃ£y gá»­i yÃªu cáº§u cho Google crawl láº¡i cÃ¡c URL Ä‘Ã³.Chi tiáº¿t cÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o link sau vá» viá»‡c YÃªu cáº§u Google crawl láº¡i cÃ¡c URL â˜… CÃ¡c háº¡ng má»¥c Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ vá» UX First view cá»§a trang web sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ trong vÃ²ng 1 giÃ¢y (Google recommended) Chuáº©n bá»‹ riÃªng biá»‡t kÃ­ch thÆ°á»›c hÃ¬nh áº£nh vá»›i PC Site, Ä‘á»ƒ giáº£m dung lÆ°á»£ng cá»§a má»™t trang web Sá»­ dá»¥ng cÃ´ng cá»¥ YUI Compressor vÃ  JSMin Ä‘á»ƒ rÃºt ngáº¯n Ä‘oáº¡n code dÃ i nhÆ° thÆ° viá»‡n Thiáº¿t láº­p cÃ¡c ná»™i dung cÃ³ thá»ƒ tab Ä‘Æ°á»£c lá»›n hÆ¡n 48px Äá»ƒ xÃ¡c nháº­n tá»‘c Ä‘á»™ hiá»ƒn thá»‹ cá»§a web site, báº¡n cÃ³ thá»ƒ dá»¥ng cÃ´ng cá»¥: PageSpeed Insights â˜… Chuyá»ƒn tiáº¿p quáº£ng cÃ¡oÄá»‘i vá»›i cÃ¡c quáº£ng cÃ¡o chuyá»ƒn tiáº¿p thÃ¬ Ä‘áº¿n khi hiá»ƒn thá»‹ target page, thÃ¬ hiá»ƒn thá»‹ quáº£ng cÃ¡o vá»›i link [Skip this page] giá»‘ng nhÆ° áº£nh bÃªn dÆ°á»›i, tá»« thÃ¡ng 11 nÄƒm 2016 sáº½ vi pháº¡m Ä‘iá»u luáº­t cá»§a Google. Quote: https://london3.jp/2014/12/skip/ â˜… CÃ¡c tÃ¡c Ä‘á»™ng dáº«n tá»›i viá»‡c giáº£m thá»© háº¡ng rank Ná»™i dung chÃ­nh náº±m trong Popup (ká»ƒ cáº£ Modal) TrÆ°á»›c khi dáº«n tá»›i main content (ná»™i dung chÃ­nh) cá»§a website thÃ¬ hiá»ƒn thá»‹ quáº£ng cÃ¡o giá»‘ng trong áº£nh trÃªn First view cÃ³ chÆ°a quáº£ng cÃ¡o vá»›i kÃ­ch thÆ°á»›c lá»›n, náº¿u khÃ´ng scroll thÃ¬ khÃ´ng tháº¥y Ä‘Æ°á»£c ná»™i dung chÃ­nh â˜… CÃ¡c tÃ¡c Ä‘á»™ng khÃ´ng áº£nh hÆ°á»Ÿng tá»›i thá»© háº¡ng rank Pop-up cáº¥p quyá»n sá»­ dá»¥ng Cookie CÃ¡c hiá»ƒn thá»‹ nhÆ° xÃ¡c minh Ä‘á»™ tuá»•i vá»›i cÆ¡ sá»Ÿ dá»±a vÃ o phÃ¡p luáº­t CÃ¡c page mÃ  chá»‰ má»™t bá»™ pháº­n cá»¥ thá»ƒ ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c hiá»ƒn thá»‹, cháº³ng háº¡n nhÆ° má»™t trang Ä‘Äƒng nháº­p. Banner quáº£ng cÃ¡o Pop-up mÃ  khÃ´ng chiáº¿m nhiá»u diá»‡n tÃ­ch mÃ n hÃ¬nh HÆ¡n ná»¯a, trong cuá»™c Ä‘á»‘i thoáº¡i giá»¯a Google vá»›i ngÆ°á»i sá»­ dá»¥ng cÃ³ cÃ¢u há»i: Vá» ná»™i dung Pop-up (Quáº£ng cÃ¡o) thÃ¬, liá»‡u cÃ³ kháº£ nÄƒng ná»™i dung áº©n bÃªn trong nÃ³ láº¡i Ä‘Æ°á»£c Googlebot Æ°u tiÃªn ko ? Vá» phÃ­a Google Ä‘Ã£ tráº£ lá»i lÃ :ã€ŒChÃ­nh xÃ¡c lÃ  cÃ³ kháº£ nÄƒng Ä‘Ã³ã€, nhÆ° váº­y thÃ¬ viá»‡c hiá»ƒn thá»‹ quáº£ng cÃ¡o dÃ¹ lÃ  = Pop-up hay Modal cÅ©ng lÃ  khÃ´ng nÃªn. CÃ i Ä‘áº·t XML Sitemap &amp; ÄÄƒng kÃ½ RSS FeedCÃ´ng viá»‡c nÃ y Ä‘Ã£ Ä‘Æ°á»£c Google hÆ°á»›ng dáº«n ráº¥t chi tiáº¿t táº¡i link sau:Best practices for XML sitemaps &amp; RSS/Atom feeds RSS, Atom Register vÃ  PubSubHubbub(PuSH)ÄÆ°á»£c sá»­ dá»¥ng nhÆ° Sitemap, cÃ³ format tÆ°Æ¡ng tá»± RSS vÃ  Atom trong RSS Reader.ã€‚ â˜… Lá»£i Ã­ch khi Ä‘Äƒng kÃ½ Feed Chá»‰ URL Ä‘Æ°á»£c cáº­p nháº­t gáº§n Ä‘Ã¢y nháº¥t Ä‘Æ°á»£c Ä‘Äƒng kÃ½. Táº§n suáº¥t Crawl cao hÆ¡n Sitemap thÃ´ng thÆ°á»ng Viá»‡c thÃ´ng bÃ¡o cho Google cÃ¡c Page Ä‘Æ°á»£c create/update gáº§n Ä‘Ã¢y nháº¥t lÃ  má»™t phÆ°Æ¡ng phÃ¡p sá»­ dá»¥ng Feed cÃ³ táº§n suáº¥t Crawl cao hÆ¡n má»™t cÃ¡ch hiá»‡u quáº£. â˜… Thá»±c hiá»‡n index theo thá»i gian thá»±c dá»±a vÃ o PubSubHubbub (PuSH)Má»™t cÃ¡ch Ä‘á»ƒ thá»±c hiá»‡n index realtime khÃ¡c Ä‘Ã³ lÃ : Sá»­ dá»¥ng phÆ°Æ¡ng thá»©c PubSubHubbub (hay cÃ²n gá»i lÃ  PuSH) giÃºp thÃ´ng bÃ¡o tá»›i Google cÃ¡c thay Ä‘á»•i táº¡i thá»i Ä‘iá»ƒm mÃ  cÃ¡c trang Ä‘Æ°á»£c update. Danh sÃ¡ch cÃ¡c repository thá»±c hiá»‡n viá»‡c implement PuSH Ä‘Æ°á»£c viáº¿t trÃªn nhiá»u ngÃ´n ngá»¯ láº­p trÃ¬nh TrÆ°á»ng há»£p code báº±ng PHP, cÃ³ thá»ƒ sá»­ dá»¥ng file Ä‘Æ°á»£c Download tá»« thÆ° viá»‡n sau Ä‘Ã¢y:pubsubhubbub-php-master/library/publisher.php 123require_once './publisher.php' ;$publisher = new Publisher('http://pubsubhubbub.appspot.com/');$publisher-&gt;publish_update('http://example.com/article/1'); ÄÄƒng kÃ½ Sitemapâ˜… HTML Sitemap Sitemap cho ngÆ°á»i sá»­ dá»¥ng truy cáº­p trang web ThÆ°á»ng xuyÃªn quáº£n lÃ½ Ä‘á»ƒ trÃ¡nh cÃ¡c liÃªn káº¿t lá»—i Viá»‡c phÃ¢n loáº¡i sáºµn cÃ¡c Category giÃºp cáº£i thiá»‡n kháº£ nÄƒng sá»­ dá»¥ng â˜… XML SitemapViá»‡c táº¡o sáºµn má»™t Sitemap cÃ³ Ä‘á»‹nh dáº¡ng XML chÃ­nh lÃ  cÃ´ng cá»¥ Ä‘áº¯c lá»±c, trá»£ giÃºp Search Engine index website cá»§a báº¡nDÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c loáº¡i Sitemap: Loáº¡i File XML Vai trÃ² sitemap.xml MÃ´ táº£ cáº¥u trÃºc website, bao gá»“m cáº£ mobile sitemap movie.xml Hiá»ƒn thá»‹ cÃ¡c ná»™i dung video trong tÃ¬m kiáº¿m image.xml Hiá»ƒn thá»‹ cÃ¡c ná»™i dung áº£nh trong tÃ¬m kiáº¿m news.xml Khai bÃ¡o cÃ¡c tá»‡p tin Ä‘Æ°á»£c gá»­i tá»›i Google News Vá»›i má»—i file XML Ä‘Æ°á»£c cÃ i Ä‘áº·t chÃ­nh xÃ¡c, gÃ³p pháº§n xÃºc tiáº¿n viá»‡c index website cá»§a báº¡n Tuy nhiÃªn náº¿u crawler khÃ´ng visit, chÃºng ta cáº§n thá»±c hiá»‡n cáº£i thiá»‡n láº¡i Sitemap Ä‘Ã£ táº¡o trÆ°á»›c Ä‘Ã³ TrÃªn SP site viá»‡c giá»›i háº¡n quyá»n truy cáº­p webiste mobile trÃªn device = .htaccess cÃ³ thá»ƒ khiáº¿n Search Engine Bot khÃ´ng vÃ´ Ä‘Æ°á»£c, vÃ¬ váº­y hÃ£y cho phÃ©p Googlebot-Mobile cÃ³ quyá»n truy cáº­p. Trong thá»±c táº¿, Ä‘á»‘i vá»›i viá»‡c create/submit Sitemap chÃºng ta cÃ³ thá»ƒ tham kháº£o thÃªm táº¡i link Build and submit a sitemap , cÃ³ hÆ°á»›ng dáº«n chi tiáº¿t cÃ¡c loáº¡i tool giÃºp táº¡o vÃ  test sitemap, ráº¥t tiá»‡n lá»£i. â˜… Video, Image SitemapViá»‡c Crawler thu tháº­p thÃ´ng tin tÃ¬m kiáº¿m liÃªn quan tá»›i Video vÃ  áº¢nh lÃ  tÆ°Æ¡ng Ä‘á»‘i khÃ³ khÄƒn, do Ä‘Ã³ chÃºng ta cáº§n sá»­ dá»¥ng Sitemap chuyÃªn dá»¥ng cÃ³ chá»©a thÃ´ng tin cho Video vÃ  Image.Vá» cÃ¡ch create thÃ¬ báº¡n cÃ³ thá»ƒ táº¡o file XML chá»‰ chá»©a cÃ¡c video vÃ  áº£nh má»›i táº¡o hoáº·c bá»• sung chÃºng vÃ o 1 file XML Ä‘Ã£ tá»“n táº¡i Ä‘á»u ok, tuy nhiÃªn hÃ£y thiáº¿t láº­p má»™t sitemap chá»©a nhiá»u thÃ´ng tin.Sitemap Protocol : Video extension, Title, Duration, Description HÆ¡n ná»¯a, báº±ng cÃ¡ch sá»­ dá»¥ng Video Sitemap, khi tiáº¿n hÃ nh tÃ¬m kiáº¿m Video láº«n Image trong Search Engine, Video cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong káº¿t quáº£.VÃ­ dá»¥ file movie.xml nhÆ° sau: 1xmlns:video=&quot;http://www.google.com/schemas/sitemap-video/1.1&quot; Khi váº­n hÃ nh 1 EC site (Website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­) sá»­ dá»¥ng Image Sitemap, doanh nghiá»‡p cÃ³ thá»ƒ thu hÃºt vÃ  tiáº¿p cáº­n Ä‘Æ°á»£c Ä‘á»‘i tÆ°á»£ng ngÆ°á»i dÃ¹ng tÃ¬m kiáº¿m sáº£n pháº©m muá»‘n mua báº±ng áº£nh trÃªn mÃ¡y tÃ¬m kiáº¿m. Nhá»¯ng Ä‘iá»u cáº§n lÆ°u Ã½ khi sá»­ dá»¥ng tag HTMLã€Titleã€‘Trong SEO, tháº» Title lÃ  má»™t trong sá»‘ nhá»¯ng tháº» tag cÃ³ táº§m áº£nh hÆ°á»Ÿng nháº¥t, Trong 1 page chá»‰ Ä‘Æ°á»£c cÃ³ 1 tháº» title trong head tag.index.html 123&lt;head&gt; &lt;title&gt;Page title&lt;/title&gt;&lt;/head&gt; Náº¿u trong tháº» title cÃ³ tá»« khÃ³a tÃ¬m kiáº¿m cá»§a user sáº½ Ä‘Æ°á»£c bÃ´i Ä‘áº­m trÃªn káº¿t quáº£ tÃ¬m kiáº¿m Má»—i Page nÃªn cÃ³ 1 tháº» title vá»›i ná»™i dung khÃ¡c nhau TrÃªn káº¿t quáº£ tÃ¬m kiáº¿m cá»§a Search Engine sáº½ chá»‰ hiá»ƒn thá»‹ tá»‘i Ä‘a ~32 kÃ½ tá»± trong ná»™i dung cá»§a tháº» title Náº¿u trong tháº» title cÃ³ chá»©a cÃ¡c tá»« khÃ³a khÃ´ng cáº§n thiáº¿t sáº½ lÃ m giáº£m trá»ng sá»‘ cá»§a tá»« khÃ³a mong muá»‘n Ä‘Æ°á»£c tÃ¬m kiáº¿m NÃªn lá»±a chá»n ná»™i dung cá»§a tháº» title sao cho dá»±a vÃ o Ä‘Ã³ cÃ³ thá»ƒ Ä‘oÃ¡n Ä‘Æ°á»£c pháº§n nÃ o ná»™i dung cá»§a web page Cáº§n lÆ°u Ã½ ráº±ng trÃªn Search Engine sáº½ chá»‰ hiá»ƒn thá»‹ khoáº£ng 32 kÃ½ tá»± cho tiÃªu Ä‘á» (title) cá»§a 1 website, vÃ  tháº­m chÃ­ lÃ  24 kÃ½ tá»± khi ngÆ°á»i dÃ¹ng tÃ¬m kiáº¿m trÃªn thiáº¿t bá»‹ di dá»™ng.Náº¿u Ä‘áº·t tiÃªu Ä‘á» cho page khÃ´ng liÃªn quan tá»›i ná»™i dung cá»§a page sáº½ lÃ m giáº£m lÆ°á»£ng ngÆ°á»i dÃ¹ng truy cáº­p, dáº«n tá»›i rank website bá»‹ giáº£m. Cho dÃ¹ ngÆ°á»i dÃ¹ng cÃ³ truy cáº­p vÃ o nhÆ°ng do ná»™i dung chÃ­nh vÃ  tiÃªu Ä‘á» khÃ´ng giá»‘ng nhau, há» sáº½ mau chÃ³ng rá»i Ä‘i -&gt; tá»· lá»‡ bounce rate sáº½ ngÃ y cÃ ng tÄƒng. ã€Descriptionã€‘TrÆ°á»›c tiÃªn khi thiáº¿t láº­p Description, ná»™i dung hiá»ƒn thá»‹ trÃªn search engine sáº½ thay Ä‘á»•i táº¡i Ä‘Ã¢y: Viá»‡c thÃªm mÃ´ táº£ cho ná»™i dung mÃ  ngÆ°á»i dÃ¹ng mong muá»‘n tÃ¬m kiáº¿m, gÃ³p pháº§n lÃ m tÄƒng tá»· lá»‡ click rate trÃªn search result.Tuy nhiÃªn náº¿u xÃ©t vá» má»©c Ä‘á»™ áº£nh hÆ°á»Ÿng vá» ranking trong thá»© háº¡ng xuáº¥t hiá»‡n trÃªn Search Engine thÃ¬ cÃ³ váº» lÃ  khÃ´ng lá»›n láº¯m. HÆ¡n ná»¯a á»Ÿ thá»i Ä‘iá»ƒm hiá»‡n táº¡i dÃ¹ khÃ´ng cÃ³ mÃ´ táº£ rÃµ rÃ ng cho page thÃ¬ Google cÅ©ng hiá»‡n thá»‹ Description mÃ  nÃ³ tá»± Ä‘á»™ng táº¡o ra cho web page. Dá»±a vÃ o cÃ¡c mÃ´ táº£ mÃ  Google tá»± Ä‘á»™ng sinh ra cho trang web, vá»›i cÃ¡c trÆ°á»ng há»£p Ä‘Æ°a ra Description phÃ¡n Ä‘oÃ¡n chÃ­nh xÃ¡c thÃ´ng tin trÃªn website: Khuyáº¿n khÃ­ch Ä‘á»ƒ Google tá»± Ä‘á»™ng táº¡o description cho web page CÃ¡c page khÃ¡c nhau pháº£i cÃ³ ná»™i dung khÃ¡c nhau Ná»™i dung description cáº§n nháº¥t quÃ¡n vá»›i title tag TrÃªn search engine chá»‰ hiá»ƒn thá»‹ khoáº£ng 124 kÃ½ tá»± cho pháº§n description Khi tÃ¬m kiáº¿m báº±ng thiáº¿t bá»‹ di Ä‘á»™ng thÃ¬ chá»‰ hiá»ƒn thá»‹ khoáº£ng 80 kÃ½ tá»± cho pháº§n description KhÃ´ng báº¯t buá»™c vÄƒn phong pháº£i chÃ­nh xÃ¡c tuy nhiÃªn ná»™i dung cá»§a tag pháº£i rÃµ rÃ ng, chuáº©n xÃ¡c. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tool sau Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ description trÃªn 1 web page: http://seolaboratory.jp/description/ ã€h1ã€‘Do viá»‡c láº¡m dá»¥ng tháº» h1 quÃ¡ nhiá»u dáº«n tá»›i Google Ä‘Ã£ háº¡ chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡ cá»§a nÃ³, tuy nhiÃªn do váº«n cÃ²n xuáº¥t hiá»‡n trÃªn káº¿t quáº£ tÃ¬m kiáº¿m, nÃªn Ä‘á»‘i vá»›i SEO váº«n cÃ²n khÃ¡ quan trá»ng. Má»—i page chá»‰ nÃªn cÃ³ 1 tháº» h1 Máº·c dÃ¹ Google cÃ³ cÃ´ng bá»‘ chÃ­nh thá»©c ráº±ng cÃ³ thá»ƒ thiáº¿t láº­p nhiá»u tháº» h1, tuy nhiÃªn náº¿u lÃ m váº­y sáº½ gÃ¢y khÃ³ khÄƒn cho viá»‡c nháº­n biáº¿t chá»§ Ä‘á» cá»§a ná»™i dung web page CÃ³ thá»ƒ thiáº¿t thá»ƒ áº£nh bÃªn trong tháº» tag h1 /iphone6/?color=â€whiteâ€ 123&lt;h1&gt; &lt;img src=&quot;/images/iphone6_white.jpg&quot; alt=&quot;Danh sÃ¡ch bao da cho Ä‘iá»‡n thoáº¡i iPhone 6 Ä‘Æ°á»£c ná»¯ giá»›i Æ°a chuá»™m&quot; /&gt;&lt;/h1&gt; Vá»›i cÃ¡ch Ä‘áº·t áº£nh nhÆ° trÃªn thÃ¬ nÃ³ cÅ©ng Ä‘Æ°á»£c nháº­n diá»‡n nhÆ° 1 pháº§n cá»§a h1 tag, do Ä‘Ã³ hÃ£y mÃ´ táº£ chÃ­nh xÃ¡c áº£nh báº±ng cÃ¡ch thÃªm ná»™i dung vÃ o thuá»™c tÃ­nh alt (vÄƒn báº£n thay tháº¿). â˜… Keyword truyá»n táº£i bá»Ÿi TDH (Title Description H1)Náº¿u báº¡n Ä‘áº·t tá»« khÃ³a mÃ¬nh muá»‘n SEO trong táº¥t cáº£ cÃ¡c tháº» TDHï¼ˆTitle Description H1ï¼‰sáº½ lÃ  cÃ¡ch Ä‘áº§u tiÃªn giÃºp Google nháº­n biáº¿t chÃ­nh xÃ¡c tá»« khÃ³a cáº§n SEO.Do Ä‘Ã³, cáº§n xem xÃ©t 3 tháº» trÃªn cÃ³ chá»©a tá»« khÃ³a mÃ¬nh cáº§n lÃªn top khÃ´ng? LÆ°u Ã½ vá»›i tháº»ã€imgã€‘vÃ  thuá»™c tÃ­nh ã€altã€‘Báº±ng cÃ¡ch sá»­ dá»¥ng thuá»™c tÃ­nh alt mÃ´ táº£ ná»™i dung trong áº£nh vÃ  video, thÃ¬ ngÆ°á»i khiáº¿m thá»‹ (Sá»­ dá»¥ng tÃ­nh nÄƒng Ä‘á»c vÄƒn báº£n) hoáº·c ngÆ°á»i dÃ¹ng cÃ³ tá»‘c Ä‘á»™ máº¡ng internet cháº­m cÅ©ng cÃ³ thá»ƒ dá»… dÃ ng nháº­n Ä‘Æ°á»£c thÃ´ng tin vá» website cá»§a báº¡n, Ä‘iá»u nÃ y Ä‘Æ°á»£c Google Ä‘Ã¡nh giÃ¡ ráº¥t cao. Tham kháº£o source code bÃªn dÆ°á»›i vá» Google Search ConsoleNguá»“n: https://support.google.com/webmasters/answer/114016?hl=vi CÃ¡ch sá»­ dá»¥ng khÃ´ng tá»‘t tháº» img vá»›i thuá»™c tÃ­nh alt 123456&lt;img src=\"puppy.jpg\" alt=\"\"/&gt;&lt;img src=\"puppy.jpg\" alt=\"puppy dog baby dog pup pups puppies doggies pups litter puppies dog retriever labrador wolfhound setter pointer puppy jack russell terrier puppies dog food cheap dogfood puppy food\"/&gt; Viá»‡c nhá»“i nhÃ©t quÃ¡ nhiá»u tá»« khÃ³a vÃ o thuá»™c tÃ­nh alt dáº«n tá»›i viá»‡c bá»‹ google nháº­n diá»‡n thÃ nh Spam content. CÃ¡ch sá»­ dá»¥ng tá»‘i Æ°u tháº» img vá»›i thuá»™c tÃ­nhalt 123&lt;img src=\"puppy.jpg\" alt=\"puppy\"/&gt;&lt;img src=\"puppy.jpg\" alt=\"Dalmatian puppy playing fetch\"&gt; Náº¿u cÃ³ thá»ƒ thÃ¬ tá»‘t nháº¥t hÃ£y mÃ´ táº£ báº±ng cÃ¢u vÄƒn thay vÃ¬ chá»‰ sá»­ dá»¥ng 1 tá»« khÃ³a cho cÃ¡c img tag. â˜… CÃ¡c háº¡ng má»¥c khÃ¡c Ä‘Æ°á»£c khuyáº¿n khi khi sá»­ dá»¥ng tháº» ã€imgã€‘ (KhÃ´ng báº¯t buá»™c) Thá»‘ng nháº¥t file name vÃ  ná»™i dung thuá»™c tÃ­nh alt CÃ³ thá»ƒ thiáº¿t láº­p ná»™i dung trong alt mÃ  khÃ´ng cÃ³ khoáº£ng tráº¯ng Cá»‘ gáº¯ng thiáº¿t láº­p mÃ´ táº£ cho áº£nh sao cho gáº§n vá»›i ná»™i dung trong bá»©c áº£nh Ä‘Ã³ nháº¥t cÃ³ thá»ƒ CÃ¡c áº£nh tÆ°Æ¡ng tá»± nhau thÃ¬ nÃªn Ä‘á»ƒ trong cÃ¹ng 1 thÆ° má»¥c host Náº¿u má»™t áº£nh giá»‘ng nhau Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ nhiá»u nÆ¡i, thÃ¬ hÃ£y mÃ´ táº£ tháº­t chi tiáº¿t áº£nh Ä‘Ã³ trÃªn website cá»§a mÃ¬nh, khi Ä‘Ã³ Google sáº½ nháº­n diá»‡n áº£nh cá»§a site báº¡n lÃ  original image, vÃ  hiá»ƒn thá»‹ trÃªn search result ! â˜… Kháº£ nÄƒng index vÃ  thu tháº­p dá»¯ liá»‡u á»Ÿ cÃ¹ng thá»i Ä‘iá»ƒmã€Kháº£ nÄƒng thu tháº­p dá»¯ liá»‡uã€‘Äá»ƒ crawler cá»§a GoogleBot dá»… dÃ ng thu tháº­p dá»¯ liá»‡u, chÃºng ta cáº§n Cáº¥u trÃºc, sá»­ dá»¥ng tháº» HTML pháº£i Ä‘Ãºng chuáº©n Vá»›i cÃ¡c page cÃ³ ná»™i dung liÃªn quan cáº§n cÃ³ liÃªn káº¿t tá»›i nhau, Ä‘á»ƒ Ä‘áº£m báº£o kháº£ nÄƒng crawler tráº£i dÃ i trÃªn toÃ n bá»™ website ã€Kháº£ nÄƒng index - Ä‘Ã¡nh chá»‰ má»¥c tÃ¬m kiáº¿mã€‘Náº¿u Ä‘Ã£ chuáº©n bá»‹ sáºµn cÃ¡c thuá»™c tÃ­nh alt cho áº£nh, Ã¢m thanh, video trÃªn website cá»§a mÃ¬nh thÃ¬ khi GoogleBot crawl sáº½ index Ä‘Æ°á»£c chÃ­nh xÃ¡c ná»™i dung cá»§a chÃºng. ã€aã€‘tagHÃ£y thiáº¿t láº­p chuáº©n xÃ¡c anchor link (text), viá»‡c nÃ y sáº½ giÃºp truyá»n táº£i thÃ´ng tin tá»›i Google dá»… dÃ ng hÆ¡n. CÃ¡c implement cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng tá»›i kháº£ nÄƒng crawler Sá»­ dá»¥ng javascript Ä‘á»ƒ di chuyá»ƒn tá»›i link cáº§n vÃ´ (Google cÃ³ kháº£ nÄƒng nháº­n biáº¿t Ä‘iá»u Ä‘Ã³) TÃ¬m kiáº¿m bÃªn trong website báº±ng cÃ¡ch gá»­i form Link content sá»­ dá»¥ng FLASH ã€rel=â€nextâ€ or â€œprevâ€ã€‘Khi thiáº¿t láº­p Pagination cho website cáº§n chá»‰ Ä‘á»‹nh thuá»™c tÃ­nh rel vá»›i giÃ¡ trá»‹ next hoáº·c prev â˜… rel=â€prev/nextâ€ Ä‘Æ°á»£c xáº¿p háº¡ng Æ°u tiÃªn hÆ¡n rel=â€canonicalâ€VÃ­ dá»¥ vá»ƒ rel=â€canonicalâ€ cho má»i ngÆ°á»i dá»… hiá»ƒu 1&lt;link rel=\"canonical\" href=\"http://example.com/wordpress/seo-plugin/\"&gt; Cho dÃ¹ báº¡n cÃ³ Ä‘á»ƒ link trÃªn cÃ¡c page 2, 3, 4 vá» page 1 báº±ng thuá»™c tÃ­nh canonical, thÃ¬ next vÃ  prev váº«n Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ Æ°u tiÃªn hÆ¡n canonical, do Ä‘Ã³ vá»›i cÃ¡c URL khÃ´ng cÃ³ parameter giá»‘ng nhau nhÆ° bÃªn dÆ°á»›i sáº½ khÃ´ng Ä‘Æ°á»£c tÃ­nh lÃ  next vÃ  prev. VÃ­ dá»¥ chÆ°a tá»‘i Æ°u 1234http://example.com/iphone7?page=1http://example.com/iphone7?color=red&amp;page=2http://example.com/iphone7?page=3http://example.com/iphone7?page=4 VÃ­ dá»¥ tá»‘i Æ°u: Ä‘Æ°á»£c tÃ­nh lÃ  next vÃ  prev 123456789101112131415// page=http://example.com/iphone7?color=red&amp;page=1http://example.com/iphone7?color=red&amp;page=2http://example.com/iphone7?color=red&amp;page=3http://example.com/iphone7?color=red&amp;page=4// viáº¿t táº¯t p=http://example.com/foo.htmlhttp://example.com/foo.html?p=2http://example.com/foo.html?p=3// Sá»­ dá»¥ng URL path thay tháº¿ cho param pagehttp://example.com/foo/1/http://example.com/foo/2/http://example.com/foo/3/ â˜… CÃ¡c Ä‘iá»ƒm cáº§n lÆ°u Ã½ 1 page chá»‰ Ä‘Æ°á»£c phÃ©p cÃ³ 1 next vÃ  1 prev Absolute path thÃ¬ ngon hÆ¡n Relative path URL (KhÃ´ng báº¯t buá»™c) TrÆ°á»ng há»£p hiá»ƒn thá»‹ káº¿t quáº£ tÃ¬m kiáº¿m cá»§a 1 page cÃ³ sá»­ dá»¥ng Ä‘iá»u kiá»‡n filter, thÃ¬ á»Ÿ trong trang Ä‘iá»u kiá»‡n Ä‘Ã³ cÅ©ng cáº§n bá»• sung thuá»‘c tÃ­nh next vÃ  prev Náº¿u báº¡n khÃ´ng muá»‘n hiá»ƒn thá»‹ má»™t page trÃªn káº¿t quáº£ tÃ¬m kiáº¿m, hÃ£y há»c cÃ¡ch sá»­ dá»¥ng canonical ã€rel=â€nofollowâ€ã€‘Vá»›i cÃ¡c target link cÃ³ gáº¯n thuá»™c tÃ­nh rel=â€nofollowâ€ sáº½ khÃ´ng Ä‘Æ°á»£c search engine visit. Thuá»™c tÃ­nh nÃ y xuáº¥t hiá»‡n á»Ÿ tháº» meta vÃ  tháº» a.HÆ¡n ná»¯a, khi GoogleBot visit target link, nÃ³ cÅ©ng tÃ­nh toÃ¡n Ä‘á»™ tin cáº­y cá»§a cÃ¡c target link trÃªn website vÃ  Ä‘Ã¡nh giÃ¡ thá»© háº¡ng site Ä‘Ã³. â˜… Khuyáº¿n khÃ­ch sá»­ dá»¥ng â€œnofollowâ€ vá»›i link trá» tá»›i cÃ¡c website sau CÃ¡c báº£ng tin vÃ  Ã´ comment cÃ³ thá»ƒ Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng nháº­p LiÃªn káº¿t tá»›i bookmark site LiÃªn káº¿t tá»›i ranking site LiÃªn káº¿t khi nháº­n Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ báº±ng tiá»n powerd byâ€¦ link â˜… CÃ¡c liÃªn káº¿t cÃ³ thá»ƒ gÃ¢y áº£nh hÆ°á»›ng xáº¥u tá»›i website cáº§n lÆ°u Ã½ CÃ¡c link mÃ  ngÆ°á»i dÃ¹ng khÃ´ng nhÃ¬n tháº¥y, bá»‹ áº©n Ä‘i cÅ©ng nhÆ° khÃ´ng click Ä‘Æ°á»£c LiÃªn káº¿t qua láº¡i báº±ng cÃ¡c trang web há»— trá»£ liÃªn káº¿t láº«n nhau CÃ¡c liÃªn káº¿t Ä‘áº¿n cÃ¡c trang web Ä‘Æ°á»£c Google xÃ¡c Ä‘á»‹nh lÃ  cÃ³ mÃ£ nguá»“n Ä‘á»™c háº¡i Sá»­ dá»¥ngã€robots.txtã€‘Ä‘á»ƒ khÃ´ng bá»‹ crawl thá»«aNáº¿u khÃ´ng muá»‘n search engin crawl trong nhá»¯ng trÆ°á»ng há»£p dÆ°á»›i Ä‘Ã¢y, hÃ£y thiáº¿t láº­p file robot.txt CÃ¡c web page cÃ³ cháº¥t lÆ°á»£ng tháº¥p, cÃ¡c web page khÃ´ng muá»‘n xuáº¥t hiá»‡n trÃªn káº¿t quáº£ tÃ¬m kiáº¿m File robots.txt Ä‘Æ°á»£c Ä‘áº·t á»Ÿ thÆ° má»¥c gá»‘c (root directory) cá»§a website, CÃ¡c Bot search engine sáº½ tá»± Ä‘á»™ng Ä‘á»c vÃ  láº¥y ra. VÃ­ dá»¥ vá» ná»™i dung file robots.txt 12345User-Agent: *Disallow: /*/matome/Disallow: /ajax/*.jsonDisallow: /image/Disallow: /search HÆ¡n ná»¯a Google cÅ©ng há»— trá»£ tool kiá»ƒm tra file robots.txt : Google robots.txt Tester ã€rel=â€noindexâ€ã€‘HÃ£y sá»­ dá»¥ng nÃ³ khi báº¡n cÃ³ chá»§ Ã½ muá»‘n 1 page nÃ o Ä‘Ã³ trÃªn website cá»§a mÃ¬nh khÃ´ng xuáº¥t hiá»‡n trÃªn káº¿t quáº£ tÃ¬m kiáº¿m cá»§a Google. â˜… Äiá»ƒm khÃ¡c biá»‡t vá»›i robots.txtSá»­ dá»¥ng robots.txt Ä‘á»“ng nghÄ©a vá»›i viá»‡c khÃ´ng cho Bot Search Enginer thu tháº­p dá»¯ liá»‡u cÅ©ng nhÆ° xáº¿p háº¡ng page Ä‘Ã³. Trong khi sá»­ dá»¥ng noindex thÃ¬ sau má»™t thá»i Ä‘iá»ƒm nÃ o Ä‘Ã³ khi link tá»›i website cá»§a báº¡n Ä‘Æ°á»£c share nhiá»u trÃªn máº¡ng xÃ£ há»™i, thÃ¬ SEO rank váº«n cÃ²n vÃ  link tá»›i web page Ä‘Ã³ váº«n Ä‘Æ°á»£c xáº¿p háº¡ng. â˜… Má»¥c Ä‘Ã­ch chÃ­nh cá»§a viá»‡c sá»­ dá»¥ng â€œnoindexâ€ Vá»›i cÃ¡c page cháº¥t lÆ°á»£ng tháº¥p, náº¿u cÃ³ gáº¯n thuá»™c tÃ­nh noindex sáº½ ko bá»‹ xáº¿p háº¡ng tháº¥p website Support cÃ¡c page chÆ°a Ä‘Æ°á»£c setting trong robots.txt cho tá»›i thá»i Ä‘iá»ƒm hiá»‡n táº¡i 404 Page (Thiáº¿t láº­p á»Ÿ cÃ¡c page tráº£ vá» status lá»—i 404) CÃ¡ch thá»©c setting: 1&lt;meta name=â€robotsâ€ content=â€noindexâ€&gt; â˜… CÃ¡ch kiá»ƒm tra tÃ¬nh tráº¡ng index cá»§a má»™t websiteCÃ³ thá»ƒ dÃ¹ng Google Search Console - Index Status Hiá»ƒn thá»‹ Rich snippetsRich Snippets lÃ  Ä‘oáº¡n thÃ´ng tin Ä‘áº·c biá»‡t dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹ cÃ¡c thÃ´ng tin thÃªm cÃ³ trong nhá»¯ng bÃ i viáº¿t Ä‘áº·c biá»‡t (bÃ i Ä‘Ã¡nh giÃ¡, sáº£n pháº©m, á»©ng dá»¥ng, cÃ´ng thá»©c náº¥u Äƒn, Ä‘á»‹a chá»‰ cÃ´ng ty..v.v..) trÃªn cÃ¡c mÃ¡y tÃ¬m kiáº¿m (Google, Yahoo, Bing) nháº±m cung cáº¥p thÃªm nhá»¯ng thÃ´ng tin giÃ¡ trá»‹ Ä‘áº¿n ngÆ°á»i tÃ¬m kiáº¿m giÃºp há» xÃ¡c Ä‘á»‹nh káº¿t quáº£ tÃ¬m kiáº¿m mÃ  há» Ä‘ang cáº§n. NhÃ¬n vÃ o káº¿t quáº£ tÃ¬m kiáº¿m sau, ta tháº¥y cÃ³ má»™t Ä‘iá»u ráº¥t Ä‘áº·c biá»‡t: Xuáº¥t hiá»‡n áº£nh thumbnail trong káº¿t quáº£ :v Rich Snippets cÃ³ 10 loáº¡i phá»• biáº¿n sau: Author Breadcrumbs Event Organizations People Products Recipes Review Software Application Facebook Share Viá»‡c sá»­ dá»¥ng cÃ¡c markup báº±ng cáº¥u trÃºc Ä‘Æ°á»£c cÃ´ng bá»‘ trÃªn schema.org sáº½ lÃ m tÄƒng kháº£ nÄƒng hiá»ƒn thá»‹ rich snippet trÃªn káº¿t quáº£ tÃ¬m kiáº¿m cá»§a google.Hiá»‡n táº¡i thÃ¬ rich snippet khÃ´ng áº£nh hÆ°á»Ÿng tá»›i rank cá»§a 1 website, tuy nhiÃªn cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng tá»›i thá»© háº¡ng trong káº¿t quáº£ tÃ¬m kiáº¿m: Google Webmaster Central office-hours hangout VÃ­ dá»¥ vá» 1 page cÃ³ hiá»ƒn thá»‹ snippets 123456789&lt;section itemscope itemtype=\"http://schema.org/Game\"&gt; &lt;h1&gt;Monster Hunter Game Series&lt;/h1&gt; &lt;span itemprop=\"name\"&gt;Monster Hunter Double Cross&lt;/span&gt; &lt;p itemprop=\"description\"&gt;Latest Monhan Series with 6 large main Monsters&lt;/p&gt; &lt;div itemprop=\"author\" itemscope itemtype=\"http://schema.org/Corporation\"&gt; &lt;p itemprop=\"name\"&gt;CONAMI&lt;/p&gt; &lt;p itemprop=\"email\"&gt;example@conamikan.jp&lt;/p&gt; &lt;/div&gt;&lt;/section&gt; Nhá»¯ng lÆ°u Ã½ vá» URL (ÄÆ°á»ng dáº«n)ã€Soft 404ã€‘TÃ¬nh trang má»™t page cÃ³ status=200 nhÆ°ng ná»™i dung page Ä‘Ã³ láº¡i cho biáº¿t URL nÃ y khÃ´ng tá»“n táº¡i Ä‘Æ°á»£c gá»i lÃ  soft 404 Chi tiáº¿t thÃªm vá» lá»—i nÃ y báº¡n cÃ³ thá»ƒ tham kháº£o táº¡i Ä‘Ã¢y: https://support.google.com/webmasters/answer/181708?hl=vi Sá»­ dá»¥ng Google Search Console, Ä‘á»ƒ dá»… dÃ ng confirm láº¡i cÃ¡c page dÃ­nh lá»—i soft 404 Gáº§n Ä‘Ã¢y Google Bot cÃ³ kháº£ nÄƒng phÃ¢n biá»‡t Ä‘Æ°á»£c lá»—i soft 404, nÃªn sáº½ ko cÃ³ hÃ¬nh pháº¡t nÃ o Ä‘Æ°á»£c Ã¡p dá»¥ng vá»›i site dÃ­nh lá»—i nÃ y. Tráº£ vá» status code = 404 khi cÃ³ lá»—i trong CakePHP 1throw new NotFoundException(); NgoÃ i ra, báº¡n cÃ³ thá»ƒ tÃ¬m hiá»ƒu thÃªm vá» lá»—i soft 404 á»Ÿ Ä‘Ã¢y: https://www.suzukikenichi.com/blog/does-google-penalize-your-site-for-having-soft-404/ Chuáº©n hÃ³a URLViá»‡c hiá»ƒn thá»‹ 1 web page cÃ³ ná»™i dung giá»‘ng nhau nhÆ°ng vá»›i nhiá»u URL khÃ¡c nhau trÃªn trÃ¬nh duyá»‡t xáº£y ra khÃ¡ phá»• biáº¿n. Tuy nhiÃªn, náº¿u viá»‡c nÃ y xáº£y ra vá»›i Google search engine thÃ¬ cÃ³ thá»ƒ website cá»§a báº¡n sáº½ bá»‹ Ã¡p dá»¥ng cÃ¡c hÃ¬nh pháº¡t lÃ m giáº£m thá»© háº¡ng tÃ¬m kiáº¿m. ChÃ­nh vÃ¬ láº½ Ä‘Ã³ chÃºng ta cáº§n chuáº©n hÃ³a láº¡i URL. â˜… CÃ¡c lá»£i Ã­ch cÃ³ Ä‘Æ°á»£c khi quy chuáº©n hÃ³a Ä‘Æ°á»ng dáº«nGiáº£ sá»­: Viá»‡c url má»™t website cÃ³ chá»©a www vÃ  ko chÆ°a www Ä‘Æ°á»£c coi lÃ  cÃ¡c page khÃ¡c nhauVáº¥n Ä‘á»: LÃºc nÃ y viá»‡c Ä‘Ã¡nh giÃ¡ rank cho website bá»‹ phÃ¢n tÃ¡n giá»¯a cÃ¡c link cÃ³ vÃ  ko cÃ³ wwwHÆ°á»›ng giáº£i quyáº¿t: CÃ³ thá»ƒ chuyá»ƒn hÆ°á»›ng (301 redirect) cÃ¡c page cÃ³ www sang page ko cÃ³ www â˜… 301 Redirect Wiki: List of HTTP status codes Khi thay Ä‘á»•i tÃªn miá»n/url, hÃ£y sá»­ dá»¥ng chuyá»ƒn hÆ°á»›ng 301 sang Ä‘Æ°á»ng dáº«n má»›i Tá»« sau khi thiáº¿t láº­p 301 Redirect, cÃ³ thá»ƒ máº¥t tá»›i má»™t thÃ¡ng Ä‘áº» Bot Search crawl láº¡i website â˜… VÃ­ dá»¥ sá»­ dá»¥ng 301 Redirect Sá»­ dá»¥ng 301 Redirect trong viá»‡c cÃ³ vÃ  khÃ´ng cÃ³ www trÃªn URL Loáº¡i bá» viá»‡c thÃªm index.html vÃ o sau URL TrÆ°á»ng há»£p Pagination /search/?page=1 vÃ  /search/ hiá»ƒn thá»‹ ná»™i dung giá»‘ng nhau TrÆ°á»ng há»£p cÃ³ vÃ  ko cÃ³ dáº¥u slash (/) sau URL. Ex: /search/ vÃ  /search LÆ°u Ã½ khi code: tÃ¹y vÃ o chá»©c nÄƒng cá»§a trÃ¬nh duyá»‡t web, náº¿u thá»±c hiá»‡n Ä‘iá»u hÆ°á»›ng 301 tá»« 1 URL tá»›i 1 URL nháº¥t Ä‘á»‹nh thÃ¬ viá»‡c di chuyá»ƒn page nÃ y sáº½ Ä‘Æ°á»£c lÆ°u vÃ o cache cho tá»›i khi trÃ¬nh duyá»‡t xÃ³a nÃ³ Ä‘i. ã€Canonicalã€‘CÃ¹ng má»™t ná»™i dung tÆ°Æ¡ng tá»± nhau (CÃ³ thá»ƒ lÃ  1 bÃ i viáº¿t Ä‘Æ°á»£c chia lÃ m nhiá»u pháº§n), thÃ¬ khÃ´ng chá»‰ ngÆ°á»i dÃ¹ng mÃ  Google Bot cÅ©ng muá»‘n biáº¿t bÃ i viáº¿t nÃ o lÃ  bÃ i viáº¿t gá»‘c, cÃ¢u tráº£ lá»i cho váº¥n Ä‘á» nÃ y chÃ­nh lÃ  thuá»™c tÃ­nh rel=â€canonicalâ€. Máº·t khÃ¡c cháº¯c háº³n báº¡n cÅ©ng gáº·p pháº£i trÆ°á»ng há»£p Single Page vÃ  Search Page cÃ³ chá»©a 1 lÆ°á»£ng lá»›n ná»™i dung trÃ¹ng láº·p. Nhá» viá»‡c thiáº¿t láº­p canonical cho 1 page, mÃ  ta cÃ³ thá»ƒ ngÄƒn ngá»«a Ä‘Æ°á»£c viá»‡c Google Ä‘Ã¡nh tá»¥t thá»© háº¡ng tÃ¬m kiáº¿m tá»« ná»™i dung bá»‹ trÃ¹ng láº·p VÃ­ dá»¥ khi website cÃ³ 2 phiÃªn báº£n cho Desktop vÃ  Mobile: 12345&lt;head&gt; ... &lt;link rel=\"canonical\" href=\"http://www.example.com/\" /&gt; ...&lt;/head&gt; NgoÃ i canonical, cÃ²n cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»“ng thá»i vá»›i alternate Ä‘Æ°á»£c giáº£i thÃ­ch chi tiáº¿t bÃªn dÆ°á»›i. â˜… VÃ­ dá»¥ vá» sá»­ dá»¥ng Canonical TrÃªn káº¿t quáº£ tÃ¬m kiáº¿m xuáº¥t hiá»‡n nhiá»u page cÃ³ content giá»‘ng nhau Mobile page vÃ  Desktop page cÃ³ ná»™i dung tÆ°Æ¡ng tá»± nhau Thiáº¿t láº­p URL Ä‘á»ƒ Google Analytics tiáº¿n hÃ nh Ä‘o lÆ°á»ng cÃ¡c thÃ´ng sá»‘ Khi cÃ´ng khai cÃ¹ng 1 ná»™i dung trÃªn nhiá»u website TrÆ°á»ng há»£p khÃ´ng sá»­ dá»¥ng 301 redirect TrÆ°á»ng há»£p sá»­ dá»¥ng mirror site Ä‘á»ƒ giáº£m táº£i cho web/detect DDOS. (TuyÃªn nhiÃªn viá»‡c nÃ y ko Ä‘Æ°á»£c khuyáº¿n khÃ­ch sá»­ dá»¥ng vÃ¬ dá»… bá»‹ nháº­n diá»‡n lÃ  spam) ã€Alternateã€‘Tháº» alternate Ä‘Æ°á»£c khuyáº¿n khÃ­ch sá»­ dá»¥ng khi báº¡n cÃ³ : Má»™t phiÃªn báº£n website Ä‘Æ°á»£c phiÃªn dá»‹ch hoÃ n toÃ n sang má»™t ngÃ´n ngá»¯ khÃ¡c 2 trang vá»›i cáº¥u trÃºc, ná»™i dung tÆ°Æ¡ng tá»± nhau vÃ  chá»‰ cÃ³ má»™t vÃ i Ä‘iá»ƒm nháº¥n khÃ¡c biá»‡t vá» ngÃ´n ngá»¯ trong ná»™i dung VÃ­ dá»¥: Website example.com 12345&lt;head&gt; ... &lt;link rel=\"alternate\" href=\"http://example.com/\" /&gt; ...&lt;/head&gt; Khi sá»­ dá»¥ng alternate, chÃºng ta thÃ´ng bÃ¡o cho Bot biáº¿t website cho smart phone lÃ  sp.example.com. Khi sá»­ dá»¥ng canonical, chÃºng ta thÃ´ng bÃ¡o cho Bot biáº¿t phiÃªn báº£n website chÃ­nh thá»©c cá»§a há»‡ thá»‘ng lÃ  example.com Website sp.example.com 12345&lt;head&gt; ... &lt;link rel=\"canonical\" href=\"http://sp.example.com/\" /&gt; ...&lt;/head&gt; canonical dÃ¹ng Ä‘á»ƒ thÃ´ng bÃ¡o vá»›i Search Engine Ä‘Ã¢u lÃ  page gá»‘c (original page). CÃ³ thá»ƒ vÃ­ nhÆ° quan há»‡ n:1alternate trá»Ÿ thÃ nh quan há»‡ 1:1 khi cÃ¹ng tham chiáº¿u tá»›i canonical vÃ  alternate Thuá»™c tÃ­nh canonical vÃ  alternate trÃªn website https://ferret-plus.com/1426 Ä‘Ã£ giÃºp Bot Search Engine biáº¿t Ä‘Æ°á»£c phiÃªn báº£n nÃ o lÃ  website dÃ nh cho thiáº¿t bá»‹ di Ä‘á»™ng. CloakingCloaking lÃ  sá»± che Ä‘áº­y hay che dáº¥u má»™t cÃ¡i gÃ¬ Ä‘Ã³. Trong ká»¹ thuáº­t SEO thÃ¬ cloaking Ã¡m chá»‰ hÃ nh Ä‘á»™ng cá»§a webmaster che dáº¥u bot cá»§a search engine nhÆ° Google crawl cÃ¡c ná»™i dung mÃ  ngÆ°á»i dÃ¹ng nhÃ¬n tháº¥y, Ä‘á»“ng thá»i Ä‘á» xuáº¥t cho cÃ¡c cáº­u Bot nhÃ¬n tháº¥y cÃ¡c ná»™i dung Ä‘Æ°á»£c Onpage optimize tá»‘t nháº±m má»¥c Ä‘Ã­ch Ä‘áº¡t Ä‘Æ°á»£c cÃ¡c vá»‹ trÃ­ cao trÃªn Search Engine. Viá»‡c tá»“n táº¡i cÃ¡c thÃ´ng tin trÃªn website mÃ  hiá»ƒn thá»‹ giá»¯a GoogleBot vÃ  ngÆ°á»i sá»­ dá»¥ng khÃ¡c biá»‡t nhau sáº½ áº£nh hÆ°á»Ÿng tá»›i thá»© háº¡ng hiá»ƒn thá»‹ cá»§a website trÃªn káº¿t quáº£ tÃ¬m kiáº¿m. (Website cÃ³ hÃ nh vi nÃ y sáº½ bá»‹ google Ã¡p dá»¥ng cÃ¡c hÃ¬nh pháº¡t) Website khi truy cáº­p = PC hiá»‡n ra thÃ´ng bÃ¡oã€ŒHÃ£y truy cáº­p báº±ng smart phoneã€, dÃ¹ cho khi User-Agent lÃ  smart phone truy cáº­p cÃ³ hiá»ƒn thá»‹ chÃ­nh xÃ¡c Ä‘i chÄƒng ná»¯a cÅ©ng ráº¥t cÃ³ thá»ƒ bá»‹ Google hiá»ƒu lÃ  Cloaking ??? Website á»Ÿ tÃ¬nh tráº¡ng bá»‹ hack cÅ©ng cÃ³ thá»ƒ bá»‹ Ä‘Æ°a vÃ o tráº¡ng thÃ¡i Cloaking, hÃ£y thÆ°á»ng xuyÃªn quan sÃ¡t log Ä‘á»ƒ tÃ¬m ra cÃ¡c hÃ nh Ä‘á»™ng kháº£ nghi vÃ  tiáº¿n hÃ nh deploy láº¡i náº¿u cáº§n. ÄÃ¡nh giÃ¡ Ä‘á»™ á»•n Ä‘á»‹nh cá»§a URLCÃ¡c bá»™ mÃ¡y tÃ¬m kiáº¿m cÃ³ tiÃªu chÃ­ Ä‘á»ƒ xáº¿p háº¡ng URL lÃ : URL Ä‘Ã£ cung cáº¥p thÃ´ng tin cho ngÆ°á»i sá»­ dá»¥ng trong má»™t thá»i gian dÃ i bao lÃ¢u?.Do Ä‘Ã³ khi báº¡n thay Ä‘á»•i URL, sá»­ dá»¥ng 301 Redirect thÃ¬ cÅ©ng ko cÃ³ gÃ¬ Ä‘áº£m báº£o lÃ  toÃ n bá»™ ranking cá»§a URL trÃªn site cÅ© sáº½ Ä‘Æ°á»£c chuyá»ƒn háº¿t sang URL site má»›i. â˜… CÃ¡c háº¡ng má»¥c cáº§n kiá»ƒm tra khi thiáº¿t káº¿ URL CÃ³ chá»©a ext cá»§a file nhÆ° .php hay khÃ´ng ? Viá»‡c nÃ y sáº½ gÃ¢y áº£nh hÆ°á»Ÿng náº¿u chuyá»ƒn framework vÃ­ dá»¥ tá»« CakePHP sang Rails cháº³ng háº¡n. CÃ³ thá»ƒ dÃ¹ng dáº¥u - hoáº·c _ trong URL, tuy nhiÃªn Google khuyáº¿n khÃ­ch sá»­ dá»¥ng dáº¥u - Ä‘á»ƒ phÃ¢n tÃ¡ch tá»« khÃ³a ToÃ n bá»™ kÃ½ tá»± trong URL pháº£i Ä‘Æ°á»£c viáº¿t thÆ°á»ng URL dÃ i cÅ©ng khÃ´ng váº¥n Ä‘á» (Sáº½ giáº£i thÃ­ch sau) URL khÃ´ng nÃªn chia quÃ¡ nhiá»u cáº¥p, náº±m sÃ¢u trong nhiá»u directory Chá»©a tá»« khÃ³a thÃ¬ cÃ ng tá»‘t (CÃ³ thá»ƒ chá»©a tiáº¿ng Nháº­t) URL khÃ´ng die cho dÃ¹ sau nÃ y cÃ³ Ã¡p dÃ¹ng nhiá»u thay Ä‘á»•i SEO Ä‘i chÄƒng ná»¯a KhÃ´ng sinh ra duplicated content â˜… Äáº£m báº£o viá»‡c thiáº¿t káº¿ URL khÃ´ng sinh ra ná»™i dung trÃ¹ng láº·pWeb Page bÃªn dÆ°á»›i sinh ra ná»™i dung trÃ¹ng láº·p, dÃ³ Ä‘Ã³ kiá»ƒu thiáº¿t káº¿ URL nÃ y khÃ´ng Ä‘Æ°á»£c khuyáº¿n khÃ­chVÃ­ dá»¥ï¼šAnime Home Page Hero list page All characters list page Khi Ä‘Ã³ giáº£ sá»­ ta cÃ³ nhÃ¢n váº­t tÃªn lÃ  â€œyamadaâ€, khi Ä‘Ã³ ná»™i dung 2 trang sau lÃ  giá»‘ng nhau vÃ  Ä‘á»u mÃ´ táº£ vá» â€œyamadaâ€ heros/yamada.html characters/yamada.html CÃ¹ng 1 ná»™i dung nhÆ°ng láº¡i khÃ¡c URL lÃ  má»™t thiáº¿t káº¿ tá»“i vÃ  bá»‹ xáº¿p vÃ o duplicated content. URL dÃ i cÅ©ng khÃ´ng váº¥n Ä‘á»Theo Google cÃ´ng bá»‘ thÃ¬ Ä‘á»™ dÃ i cá»§a URL cÃ³ thá»ƒ ngáº¯n hoáº·c dÃ i tÃ¹y Ã½ Äá»™ dÃ i cá»§a URL thÃ¬ khÃ´ng áº£nh hÆ°á»Ÿng tá»›i rankingTuy nhiÃªn cáº§n Ä‘á»§ Ä‘á»ƒ nháº­n diá»‡n Ä‘Æ°á»£c URL Máº·c dÃ¹ khÃ´ng áº£nh hÆ°á»Ÿng tá»›i SEO, tuy nhiÃªn trÃ¬nh duyá»‡t IE chá»‰ support URL cÃ³ Ä‘á»™ dÃ i tá»‘i Ä‘a 2083 kÃ½ tá»±, nÃªn hÃ£y setting URL length &lt;= 2083 â˜… CÃ¡c khuyáº¿n khÃ­ch vá» URL VÃ¬ URL lÃ  thá»© hiá»ƒn thá»‹ trÃªn káº¿t quáº£ search, nÃªn hÃ£y chá»n cÃ¡c tá»« Ä‘Æ¡n trong URL cÃ³ liÃªn quan tá»›i ná»™i dung bÃ i viáº¿t Khi URL cÃ³ chá»©a tá»« ngá»¯ trÃ¹ng vá»›i tá»« khÃ³a mÃ  user search thÃ¬ sáº½ Ä‘Æ°á»£c bÃ´i Ä‘áº­m trÃªn káº¿t quáº£ Search engine sá»­ dá»¥ng dáº¥u â€œ-â€œ Ä‘á»ƒ tÃ¡ch tá»«, nÃªn URL cÅ©ng nÃªn sá»­ dá»¥ng dáº¥u â€œ-â€œ Ä‘á»ƒ ngÄƒn cÃ¡ch cÃ¡c tá»« khÃ³a trong nÃ³. Máº·t khÃ¡c viá»‡c sá»­ dá»¥ng quÃ¡ nhiá»u GET parameter nhÆ° ?color=2 trong URL cÃ³ thá»ƒ khiáº¿n URL khÃ³ nhá»›, dá»… nháº§m láº«n, vÃ  khÃ³ chia sáº». Dáº«n tá»›i viá»‡c truy cáº­p pháº£i URL khÃ´ng chÃ­nh xÃ¡c náº¿u khÃ´ng Ä‘á»§ parameter. Cáº¥u trÃºc liÃªn káº¿t cáº§n Ä‘Æ°á»£c chÃº trá»ng hÆ¡n cáº¥u trÃºc thÆ° má»¥cChÃºng ta cÃ³ 2 Ä‘Æ°á»ng dáº«n sau: https://viblo.asia/cau-truc-duong-dan-nao-tot-cho-seo-file-name-hay-thu-muc.htmlhttps://viblo.asia/seo/seo-onpage/cau-truc-duong-dan-nao-tot-cho-seo-file-name-hay-thu-muc.html NhÆ° báº¡n Ä‘Ã£ biáº¿t, hai Ä‘Æ°á»ng dáº«n trÃªn Ä‘á»u lÃ  2 Ä‘Æ°á»ng dáº«n tá»‘i Æ°u cho SEO. ÄÆ°á»ng dáº«n thá»© nháº¥t lÃ  Ä‘Æ°á»ng dáº«n kiá»ƒu file name vÃ  Ä‘Æ°á»ng dáº«n thá»© hai lÃ  Ä‘Æ°á»ng dáº«n theo kiá»ƒu thÆ° má»¥c. CÃ¢u há»i Ä‘áº·t ra á»Ÿ Ä‘Ã¢y lÃ  Ä‘Æ°á»ng dáº«n nÃ o tá»‘t hÆ¡n? â˜… Náº¿u cáº¥u trÃºc thÆ° má»¥c quÃ¡ sÃ¢u cÃ³ thá»ƒ khiáº¿n Bot ko crawl Ä‘Æ°á»£cTham kháº£o link : https://support.google.com/webmasters/answer/156184?hl=viGoogle Bot sáº½ crawl theo thá»© tá»± tá»« nÃ´ng tá»›i sÃ¢u, dÃ³ Ä‘Ã³ URL á»Ÿ cÃ¡c cáº¥p sÃ¢u mÃ  khÃ´ng Ä‘Æ°á»£c liÃªn káº¿t tá»›i bá»Ÿi page nÃ o trong site cÃ³ thá»ƒ rÆ¡i vÃ o tÃ¬nh tráº¡ng Ä‘Æ°á»£c crawl cháº­m vÃ  khÃ´ng Ä‘Æ°á»£c Ä‘Ã¡nh index.Vá»›i tÆ° cÃ¡ch lÃ  developer, báº¡n Ä‘á»«ng quÃªn táº¡o cÃ¡c link trong site internal liÃªn káº¿t tá»›i cÃ¡c page quan trá»ng cá»§a site. LÆ°u Ã½: Viá»‡c táº¡o cáº¥u trÃºc thÆ° má»¥c Ä‘Æ¡n giáº£n chá»‰ giÃºp cho Google Bot crawl dá»… dÃ ng hÆ¡n chá»© khÃ´ng áº£nh hÆ°á»Ÿng tá»›i thá»© háº¡ng trÃªn Search Result. â˜… Cáº¥u trÃºc liÃªn káº¿t áº£nh hÆ°á»Ÿng tá»›i SEOCáº¥u trÃºc liÃªn káº¿t Ä‘Æ°á»£c tÃ³m gá»n trong cÃ¢u sau: â€œKhi báº¡n click vÃ o liÃªn káº¿t bao nhiÃªu láº§n cÅ©ng váº«n access Ä‘Æ°á»£c page Ä‘Ã³â€. Cáº¥u trÃºc link náº¿u vÆ°á»£t quÃ¡ 5 cáº¥p cÃ³ thá»ƒ khiáº¿n Google index cháº­m. Vá» cÆ¡ báº£n chá»‰ nÃªn setting dÆ°á»›i 4 cáº¥p Ä‘á»• láº¡i. Tham kháº£o: http://s-supporter.hatenablog.jp/entry/seo-difference-of-the-hierarchy#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªéšå±¤ã¨ãƒªãƒ³ã‚¯éšå±¤ã®é•ã„ LÆ°u Ã½ khi thÃªm Parameter vÃ o URLTheo ká»¹ sÆ° John Muelle tá»« Google thÃ¬ viá»‡c thÃªm params vÃ o URL cá»§a cÃ¡c dynamic page Ä‘á»ƒ dá»… dÃ ng thay Ä‘á»•i ná»™i dung Ä‘Æ°á»£c khuyáº¿n khÃ­ch. Just wanted to add that from Googleâ€™s point of view, the clean, parameterized URL is generally preferred to any unnecessary URL-rewriting. If you want a nice-looking URL-line in search, use breadcrumb markup instead. Tuy nhiÃªn trÃªn káº¿t quáº£ search thÃ¬ vá»›i nhá»¯ng page Ä‘á»™ng sá»­ dá»¥ng params Ä‘á»ƒ thay Ä‘á»•i ná»™i dung cáº§n thiáº¿t láº­p thÃªm Canonical Ä‘á»ƒ trÃ¡nh xáº£y ra hiá»‡n tÆ°á»£ng duplicated content. DÃ¹ng GET params sáº½ lÃ m giáº£m indexViá»‡c sá»­ dá»¥ng quÃ¡ nhiá»u GET params cÃ³ thá»ƒ lÃ m kháº£ nÄƒng index giáº£m Ä‘i, do Ä‘Ã³ cáº§n trÃ¡nh thÃªm quÃ¡ nhiá»u param lÃ  URL quÃ¡ dÃ i, hoáº·c thá»±c hiá»ƒn chuyá»ƒn Ä‘á»•i url Ä‘á»™ng sang url tÄ©nh vá»›i param ngáº¯n hÆ¡n. â˜… Chuyá»ƒn Ä‘á»‘i URL tÄ©nhViá»‡c chuyá»ƒn Ä‘á»•i URL Ä‘á»™ng sang tÄ©nh cÃ³ thá»ƒ hiá»ƒu Ä‘Æ¡n giáº£n nhÆ° sau: loáº¡i bá» bá»›t GET params, chuyá»ƒn nÃ³ vÃ o path cá»§a URL VÃ­ dá»¥:Ta cÃ³ 1 URL khÃ¡ dÃ i vá»›i 3 GET params 1https://phocase.jp/iphone7/?color=3&amp;material=3&amp;category=cute Ta sáº½ Ä‘Æ°a category vÃ o path cá»§a URL, lÃºc nÃ y sá»‘ lÆ°á»£ng params chá»‰ cÃ²n lÃ  2 1https://phocase.jp/iphone7/cute/?color=3&amp;material=3 â˜… CÃ¡c Ä‘iá»ƒm cáº§n lÆ°u Ã½ khi chuyá»ƒn Ä‘á»•i sang URL tÄ©nh Loáº¡i bá» cÃ¡c params khÃ´ng cáº§n thiáº¿t KhÃ´ng quáº£n lÃ½ param theo session ID Thá»±c hiá»ƒn chuyá»ƒn Ä‘á»•i cÃ¡c params cÃ³ tháº» Ä‘Æ°a vÃ o URL path KhÃ´ng nÃªn Ä‘Æ°a quÃ¡ nhiá»u param vÃ o URL path dáº«n tá»›i URL quÃ¡ dÃ i, giáº£m kháº£ nÄƒng index cÅ©ng nhÆ° crawl URL cÃ ng cÃ³ Ã½ nghÄ©a cÃ ng tá»‘t â˜… CÃ¡c thá»©c Ä‘Æ¡n giáº£n Ä‘á»ƒ thá»±c chuyá»ƒn Ä‘á»•i tÄ©nhÄá»ƒ chuyá»ƒn Ä‘á»•i sang URL tÄ©nh cÃ³ thá»ƒ implement láº¡i routing cá»§a system, tuy nhiÃªn cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t lÃ  thiáº¿t láº­p láº¡i file .htaccess 123RewriteEngine OnRewriteRule http://phocase.jp/([0-9]+)/$ http://phocase.jp/?color=$1 [L,NC] How To Create Temporary and Permanent Redirects with Apache and Nginx CÃ¡c Ä‘iá»ƒm cáº§n lÆ°u Ã½ vá»›i Site contentSite cÃ³ sá»‘ lÆ°á»£ng index lá»›nTheo nguá»“n tin chÃ­nh thá»©c tá»« Google thÃ¬ viá»‡c 1 website cÃ³ quÃ¡ nhiá»u page khÃ´ng Ä‘Æ°á»£c chÃº trá»ng vÃ o ná»™i dung sáº½ Ä‘Æ°á»£c coi lÃ  1 website vÃ´ nghÄ©a, chá»‰ nÃªn táº­p trung vÃ o 1 sá»‘ lÆ°á»£ng page cÃ³ ná»™i dung Ä‘Æ°á»£c chÃº trá»ng thay vÃ¬ táº¡o ra hÃ ng loáº¡t cÃ¡c page cÃ³ ná»™i dung nghÃ¨o nÃ n. â˜… Site ranking ThÃ´ng tin chá»‰ Ä‘Æ°á»£c tá»“n táº¡i/sá»Ÿ há»¯u duy nháº¥t bá»Ÿi website CÃ³ chá»© nhiá»u ná»™i dung dá»… hiá»ƒu nhÆ° áº£nh vÃ  video MÃ´ táº£ thÃ´ng tin chi tiáº¿t, rÃµ rÃ ng vÃ  dá»… hiá»ƒu Khi implement cÃ¡c page Ä‘á»™ng thÃ¬ sá»‘ lÆ°á»£ng page Ä‘Æ°á»£c index sáº½ tÄƒng lÃªn, do Ä‘Ã³ cáº§n xÃ¡c Ä‘á»‹nh trÆ°á»›c sá»‘ lÆ°á»£ng tá»‘i Ä‘a page sáº½ Ä‘Æ°á»£c sinh ra. â˜… CÃ¡ch thá»©c Ä‘á»‘i á»©ng Sá»­ dá»¥ng chá»©c nÄƒng URL parameter trong Google Search Console Sá»­ dá»¥ng noindex content báº±ng file robots.txtJapanese search quality guidelines Tá»“n táº¡i ná»™i dung há»¯u Ã­ch vá»›i First View khÃ´ng?Khi truy cáº­p 1 website mÃ  ko thá»±c hiá»‡n scroll xuá»‘ng dÆ°á»›i, thÃ¬ pháº¡m vi ngÆ°á»i dÃ¹ng quan sÃ¡t Ä‘Æ°á»£c trÃªn mÃ n hÃ¬nh lÃºc nÃ y Ä‘Æ°á»£c gá»i lÃ  First view Vá» cÆ¡ báº£n First view cÃ³ kÃ­ch thÆ°á»›c khoáº£ng 500Ã—950px thÃ¬ cáº§n lÆ°u Ã½ nhá»¯ng Ä‘iá»ƒm sau: â˜… CÃ¡c Ä‘iá»ƒm cáº§n lÆ°u Ã½ KhÃ´ng setting external link Setting keyword cho SEO vá»«a pháº£i Thiáº¿t láº­p alt cho áº£nh, vÃ  tÃªn file áº£nh pháº£i cÃ³ liÃªn quan tá»›i ná»™i dung bá»©c áº£nh CÃ¡c cÃ´ng cá»¥ mÃ  tÃ¡c giáº£ Ä‘ang sá»­ dá»¥ng https://adwords.google.co.jp/KeywordPlanner http://www.related-keywords.com https://www.google.com/intl/ja_jp/analytics https://www.similarweb.com","categories":[],"tags":[{"name":"seo","slug":"seo","permalink":"http://nthung2112.github.io/tags/seo/"}]},{"title":"Táº¡o loading Facebook báº±ng CSS tháº­t Ä‘Æ¡n giáº£n!","slug":"Tao-loading-Facebook-bang-CSS-that-don-gian","date":"2017-09-27T04:31:18.000Z","updated":"2017-10-01T08:27:03.106Z","comments":true,"path":"2017/09/Tao-loading-Facebook-bang-CSS-that-don-gian.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Tao-loading-Facebook-bang-CSS-that-don-gian.html","excerpt":"Dáº¡o gáº§n Ä‘Ã¢y nhÃ  mÃ¬nh hay máº¥t máº¡ng, mÃ  ai cÅ©ng biáº¿t rá»“i dÃ¢n IT, Design, Gaming, XXX, mÃ  khÃ´ng cÃ³ internet thÃ¬ há»¡i Æ¡i cá»© nhÆ° lÃ  sá»‘ng á»Ÿ thá»i kÃ¬ Ä‘á»“ Ä‘Ã¡. NhÆ°ng cÅ©ng nhá» tháº¿ mÃ  tÃ¬nh cá» phÃ¡t hiá»‡n Ä‘Æ°á»£c cÃ¡i loading hay hay cá»§a facebook, twitter, bitbucket â€¦ náº¿u máº¡ng báº¡n quÃ¡ cháº­m nÃ³ sáº½ show ra tÆ°Æ¡ng tá»± giá»‘ng nÃ y. Sau Ä‘Ã¢y lÃ  chÃºt tÃ² mÃ² vÃ  mÃ´ phá»ng Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c sá»± nháº¥p nhÃ¡y kÃ¬ láº¡ Ä‘Ã³.","text":"Dáº¡o gáº§n Ä‘Ã¢y nhÃ  mÃ¬nh hay máº¥t máº¡ng, mÃ  ai cÅ©ng biáº¿t rá»“i dÃ¢n IT, Design, Gaming, XXX, mÃ  khÃ´ng cÃ³ internet thÃ¬ há»¡i Æ¡i cá»© nhÆ° lÃ  sá»‘ng á»Ÿ thá»i kÃ¬ Ä‘á»“ Ä‘Ã¡. NhÆ°ng cÅ©ng nhá» tháº¿ mÃ  tÃ¬nh cá» phÃ¡t hiá»‡n Ä‘Æ°á»£c cÃ¡i loading hay hay cá»§a facebook, twitter, bitbucket â€¦ náº¿u máº¡ng báº¡n quÃ¡ cháº­m nÃ³ sáº½ show ra tÆ°Æ¡ng tá»± giá»‘ng nÃ y. Sau Ä‘Ã¢y lÃ  chÃºt tÃ² mÃ² vÃ  mÃ´ phá»ng Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c sá»± nháº¥p nhÃ¡y kÃ¬ láº¡ Ä‘Ã³. Váº½ Photoshop cÃ¡i khungBÆ°á»›c nÃ y chá»‰ Ä‘á»ƒ cháº£nh chÃ³ lÃ  biáº¿t Photoshop thÃ´i nha, chá»› ai dÃ¹ng gÃ¬ váº½ cÅ©ng Ä‘Æ°á»£c, hoáº·c Ä‘áº¿ch cáº§n váº½ cÅ©ng cháº³ng sao :D! MÃ¬nh chá»¥p cÃ¡i hÃ¬nh nÃ³ láº¡i, má»Ÿ cÃ¡i gÃ¬ Ä‘Ã³ lÃªn check láº¡i Ä‘Æ°á»£c máº¥y cÃ¡i mÃ£ mÃ u cá»§a nÃ³.Cá»¥ thá»ƒ lÃ : Thumnail: #f6f7f9; background: #e9ebee; background line: #ebedf0; box-shadow: #d0d1d5; cÃ²n thiáº¿u mÃ u tráº¯ng tinh cá»§a trung tÃ¬nh cho cÃ¡c box bá»±.CÃ¡c bÃ¡c cÃ³ tháº¯c máº¯c vá»¥ láº¥y mÃ£ mÃ u gÃ¬ khÃ´ng? NÃ³i chung cÃ¡c bÃ¡c láº¥y mÃ£ nÃ o cÅ©ng Ä‘Æ°á»£c táº¡i Ä‘ang chÃ©m nÃªn váº½ báº­y Ä‘Ã³ thÃ´i. Okay, xong vá»¥ láº¥y mÃ£ mÃ u, giá» thÃ¬ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cÅ©ng nhÆ° kÃ­ch thÆ°á»›c cá»§a tá»«ng thÃ nh pháº§n trong cá»§a cÃ¡i box nÃ y. Cá»¥ thá»ƒ lÃ : Thumbnail: 40x40 Line: height 6px cÃ²n width thÃ¬ tuá»³ chá»‰nh tháº¥y Ä‘á»¥p Ä‘á»¥p lÃ  á»•n nhÃ© cÃ¡c bÃ¡c Khoáº£n cÃ¡ch cá»§a line: 13px, sá»‘ hÆ¡i xui tÃ­. CÃ¡i box bá»±: 520x325. Tháº¿ lÃ  cÃ³ dá»¯ liá»‡u thÃ´ rá»“i, nhÃ o vÃ o pháº§n lÃªn cÃºc trÃºc html nÃ o. LÃªn cáº¥u trÃºc HTMLRá»“i bÃ¢y giá» chÃºng ta táº¡o 1 thÆ°c má»¥c, táº¡o 1 file tÃªn lÃ  index.html má»Ÿ nÃ³ lÃªn báº±ng editor nÃ o mÃ  báº¡n thÃ­ch, rá»“i chiáº¿n: NghÃ­a qua cÃ¡i box báº±ng Ä‘Ã´i máº¯t khÃ´ng Ä‘Æ°á»£c lÃ© cá»§a chÃºng ta thÃ¬ cÃ¡c thÃ nh pháº§n chÃ­nh nhÆ° sao: CÃ¡i box to class=â€box-loadingâ€ CÃ¡i thumbnail class=â€box-thumbnailâ€ CÃ³ khoáº£n 5 cÃ¡i line vá»›i cÃ¡c kÃ­ch thÆ°á»›c khÃ¡c nhau nÃªn chÃºng ta cÃ³ thá»ƒ Ä‘áº·t tÃªn lÃ  â€œbox-line-xs, -sm, -df, -lg, -lgxâ€ 1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Loading-facebook&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"style.css\"&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"box-loading\"&gt; &lt;div class=\"box-thumbnail\"&gt;&lt;/div&gt; &lt;div class=\"box-line-sm\"&gt;&lt;/div&gt; &lt;div class=\"box-line-xs\"&gt;&lt;/div&gt; &lt;div class=\"box-line-df\"&gt;&lt;/div&gt; &lt;div class=\"box-line-lgx\"&gt;&lt;/div&gt; &lt;div class=\"box-line-lg\"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; Okay váº­y lÃ  xong rá»“i cÃ¡i pháº§n html nhÃ©, quÃ¡ nhanh vÃ  quÃ¡ huy hiá»ƒm. LÃªn cáº¥u trÃºc CSSÄÃ£ done html rá»“i thÃ¬ bÃ¢y giá» ta táº¡o 1 file style.css nhÃ©. Äá»ƒ tÃ´ mÃ u chÆ¡i cho vui thÃ´i.Nhá»› link vÃ o file html nhÃ© 1&lt;link href=\"style.css\"&gt; Sau Ä‘Ã³ ta má»Ÿ file style.css vÃ  viáº¿t vÃ o giá»‘ng tháº¿ láº§y. 123456789101112131415161718body &#123; background: #e9ebee;&#125;.box-loading &#123; background: #fff; height: 325px; width: 520px; display: block; box-shadow: 0 1px 1px rgba(0,0,0,0.1); -o-box-shadow: 0 1px 1px rgba(0,0,0,0.1); -moz-box-shadow: 0 1px 1px rgba(0,0,0,0.1); -webkit-box-shadow: 0 1px 1px rgba(0,0,0,0.1); border-radius: 3px; -o-border-radius: 3px; -moz-border-radius: 3px; -webkit-border-radius: 3px; margin: 0 auto;&#125; Äá»ƒ cÃ³ Ä‘Æ°á»£c káº¿t quáº£ lÃ  cÃ¡i box: Canh chá»‰nh box content Pháº§n box-shadow mÃ¬nh viáº¿t nhÆ° tháº¿ Ä‘á»ƒ nÃ³ gáº§n giá»‘ng vá»›i mÃ£ mÃ u cá»§a cÃ¡i line trÃªn facebook vÃ  cÅ©ng nhÆ° lÃ  all device, Ä‘á»ƒ vÃ o pháº§n Sass cÃ¡c báº¡n sáº½ tháº¥y thÃº vá»‹ hÆ¡n á»Ÿ chá»• nÃ y nhÃ©. Tiáº¿p Ä‘áº¿n lÃ  máº¥y cÃ¡i line: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556body &#123; background: #e9ebee;&#125;// cÃ¡i nÃ o cÃ³ class lÃ  box- thÃ¬ nÃ³ sáº½ nháº­n css[class*=\"box-\"] &#123; height: 6px; width: 400px; background: #f6f7f9; margin-bottom: 13px; margin-right: 5px;&#125;.box-loading &#123; background: #fff; height: 305px; width: 500px; padding: 10px; display: block; box-shadow: 0 1px 1px rgba(0,0,0,0.1); -o-box-shadow: 0 1px 1px rgba(0,0,0,0.1); -moz-box-shadow: 0 1px 1px rgba(0,0,0,0.1); -webkit-box-shadow: 0 1px 1px rgba(0,0,0,0.1); border-radius: 3px; -o-border-radius: 3px; -moz-border-radius: 3px; -webkit-border-radius: 3px; margin: 0 auto;&#125;.box-thumbnail &#123; height: 40px; width: 40px; float: left; margin-right: 20px; display: inline-block;&#125;// chá»‹u khÃ³ viáº¿t style cho tá»«ng line nhÃ©.box-line-sm &#123; width: 120px; margin-top: 10px; margin-left: 50px;&#125;.box-line-xs &#123; width: 80px; margin-left: 50px;&#125;.box-line-df &#123; margin-top: 30px; width: 380px;&#125;.box-line-lg &#123; width: 200px;&#125;.box-line-lgx &#123; width: 450px;&#125; Animation CSS loadingCÃ¡c báº¡n tháº¥y nÃ£y giá» toÃ n lÃ  trÃ² mÃ¨o Ä‘Ãºng khÃ´ng? Giá» chÃºng ta má»›i vÃ o pháº§n trá»ng tÃ¢m cá»§a cÃ¡i loading facebooking 1234567891011121314151617[class*=\"box-line\"],.box-thumbnail &#123; animation: timeline; // tÃªn cá»§a animation Ä‘á»ƒ truyá»n action animation-duration: 1s; // thá»i gian thá»±c thi action animation-timing-function: linear; // hiá»‡u á»©ng cho action, cÃ³ nhiá»u láº¯m thá»±c cháº¥t nÃ³ lÃ  cubic-bezier, ai muá»‘n custom thÃ¬ xem link nÃ y http://cubic-bezier.com animation-iteration-count: infinite; // sá»‘ láº§n cháº¡y action, mÃ¬nh cho nÃ³ vÃ´ táº­n luÃ´n background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%); // gradient cho tá»«ng cÃ¡i line background-size: 800px auto; // kÃ­ch thÆ°á»›c cá»§a cÃ¡i bÃ³ng má» má» (gradient)&#125;// hÃ nh Ä‘á»™ng cá»§a animation cho nÃ³ cháº¡y tá»« trÃ¡i sang pháº£i@keyframes timeline &#123; 0% &#123; background-position: -350px 0;&#125; 100% &#123; background-position: 400px 0; &#125;&#125; Recode CSS thÃ nh SASSCÃ¡i nÃ y cÅ©ng cháº³ng cÃ³ gÃ¬ háº¥p dáº«n láº¯m, nhÆ°ng viáº¿t luÃ´n cho bÃ¡c nÃ o thÃ­ch chÆ¡i vá»›i tháº±ng thá»© ba thÃ¬ chÆ¡i: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081body &#123; background: #e9ebee;&#125;[class*=\"box-\"] &#123; height: 6px; width: 400px; background: #f6f7f9; margin-bottom: 13px; margin-right: 5px;&#125;@mixin box-shadow($box_shadow) &#123; box-shadow: $box_shadow; -o-box-shadow: $box_shadow; -moz-box-shadow: $box_shadow; -webkit-box-shadow: $box_shadow;&#125;@mixin border-radius($border_radius) &#123; border-radius: $border_radius; -o-border-radius: $border_radius; -moz-border-radius: $border_radius; -webkit-border-radius: $border_radius;&#125;.box &#123; &amp;-loading &#123; background: #fff; height: 305px; width: 500px; padding: 10px; display: block; margin: 0 auto; @include box-shadow(0 0 0 rgba(0,0,0,0.1)); @include border-radius(3px); &#125; &amp;-thumbnail &#123; height: 40px; width: 40px; float: left; margin-right: 20px; display: inline-block; &#125;&#125;.box-line &#123; &amp;-sm &#123; width: 120px; margin-top: 10px; margin-left: 50px; &#125; &amp;-xs &#123; width: 80px; margin-left: 50px; &#125; &amp;-df &#123; margin-top: 30px; width: 380px; &#125; &amp;-lg &#123; width: 200px; &#125; &amp;-lgx &#123; width: 450px; &#125;&#125;[class*=\"box-line\"],.box-thumbnail &#123; animation: timeline; animation-duration: 1s; animation-timing-function: linear; animation-iteration-count: infinite; background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%); background-size: 800px auto; background-position: 100px 0;&#125;@keyframes timeline &#123; 0% &#123; background-position: -350px 0;&#125; 100% &#123; background-position: 400px 0; &#125;&#125; CÃ¡c bÃ¡c cÃ³ thá»ƒ xem trÃªn nÃ y luÃ´n cho tiá»‡n nhÃ¡. Lá»i káº¿tOkay tháº¿ lÃ  cÃ³ cÃ¡i loading cá»§a facebook rá»“i, máº·t dÃ¹ lÃ  hÃ ng face nhÆ°ng hi vá»ng cÅ©ng cÃ³ tháº¿ giÃºp Ã­t cho bÃ¡c nÃ o muá»‘n dÃ¹ng. LÆ°u Ã½: Báº¡n nÃªn Ä‘á»c láº¡i ká»¹ má»™t chÃºt vá» cÃ¡c thuá»™c tÃ­nhbackground: linear-gradient, background-size, background-position vÃ  cÃ¡c thuá»™c tÃ­nh animation, trÆ°á»›c khi lÃ mNÃªn tá»± gÃµ, Ä‘á»«ng copy rá»“i paste, vÃ¬ nhÆ° tháº¿ báº¡n cháº³ng nhá»› gÃ¬ Ä‘Ã¢u.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"trick","slug":"trick","permalink":"http://nthung2112.github.io/tags/trick/"}]},{"title":"Má»™t bá»™ phim hoáº¡t hÃ¬nh giá»›i thiá»‡u vá» Redux","slug":"Mot-bo-phim-hoat-hinh-gioi-thieu-ve-Redux","date":"2017-09-22T07:25:25.000Z","updated":"2017-10-01T08:24:53.462Z","comments":true,"path":"2017/09/Mot-bo-phim-hoat-hinh-gioi-thieu-ve-Redux.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Mot-bo-phim-hoat-hinh-gioi-thieu-ve-Redux.html","excerpt":"One thing that causes even more confusion than Flux is the difference between Flux and Redux, a pattern that was inspired by Flux. In this article Iâ€™ll explain the differences between the two. If you havenâ€™t read the last article about Flux, you should do that first.","text":"One thing that causes even more confusion than Flux is the difference between Flux and Redux, a pattern that was inspired by Flux. In this article Iâ€™ll explain the differences between the two. If you havenâ€™t read the last article about Flux, you should do that first. Why change Flux?Redux solves the same problems as Flux, plus some. Just like Flux, it makes state changes in apps more predictable. If you want to change state, you have to fire off an action. Thereâ€™s no way to change the state directly because the thing holding the state (the store) only has a getter, not setters. These basics of Flux and Redux are pretty similar. So why a different pattern? Redux creator Dan Abramov saw an opportunity to improve on Flux. He wanted better developer tools. He saw that if you moved a couple of things around, you could make better developer tools possible, but still have the same predictability that Flux gives you. He wanted hot reloading and time travel debugging (thereâ€™s another cartoon to explain these). But there were some problems which made developer tooling hard to do with Flux. Problem 1: The code for stores canâ€™t be reloaded without wiping out the stateIn Flux, the store contains two things: The state change logic The current state itself Having these two on the same object is a problem for hot reloading. When you reload the store object to see the effect that the new state change logic has, you lose the state that the store is holding on to. Plus, you mess up the event subscriptions that tie the store to the rest of the system. Solution Separate these two functions. Have one object that holds on to the state. This object doesnâ€™t get reloaded. Have another object that contains all of the state change logic. This object can be reloaded because it doesnâ€™t have to worry about holding on to any state. Problem 2: The state is being rewritten with every actionIn time travel debugging, you keep track of each version of a state object. That way, you can go back to an earlier state. Each time the state is changed, you need to add the old state to an array of previous state objects. But because of the way JavaScript works, simply adding the variable to the array wonâ€™t work. This doesnâ€™t create a snapshot of the object, it just creates a new pointer to the same object. To make it work, each version needs to be an entirely separate object so that you arenâ€™t accidentally changing past versions. SolutionWhen an action comes in to the store, donâ€™t handle it by changing the state. Instead, copy the state and make changes to the copy. Problem 3: There arenâ€™t good places for third-party plugins to jump inWhen youâ€™re making developer tools, you need to be able to write them generically. A user should be able to just drop the tool in without having to custom fit their own code around it. For this to work, you need extension pointsâ€¦ places where the code expects to have things added to it. An example is logging. Letâ€™s say you want to console.log() every action as it comes in, and then console.log() the state that results from it. In Flux, youâ€™d have to subscribe to the dispatcherâ€™s updates and to updates from each store. But thatâ€™s custom code, not something a third-party module can easily do. SolutionMake it easy to wrap parts of the system in other objects. These other objects add their bit of functionality on top of the original. You can see these kinds of extension points in things like â€œenhancersâ€ or â€œhigher orderâ€ objects, as well as middleware. In addition, use a tree to structure the state change logic. This makes it so the store only emits one event to notify the views that the state has changed. This event comes after the whole state tree has been processed. Note: With these problems and solutions, Iâ€˜m focusing on the developer tooling use case. These changes help in other use cases, too. On top of that, there are other differences between Redux and Flux. For example, Redux also reduces boilerplate and it makes it easier to reuse logic in the store. Hereâ€™s a list of some other upsides to Redux_._ So letâ€™s see how Redux makes these things possible. The new cast of charactersThe cast of characters changes a little bit from Flux to Redux. Action creators Redux keeps the action creator from Flux. Whenever you want to change the state of the application, you shoot off an action. Thatâ€™s the only way that the state should be changed. As I said in the article on Flux, I think of the action creator as a telegraph operator. You go to the action creator knowing basically what message you want to send, and then the action creator formats that in a way that the rest of the system can understand. Unlike Flux, action creators in Redux do not send the action to the dispatcher. Instead, they return a formatted action object. The storeI described stores in Flux as over-controlling bureaucrats. All state changes must be made personally by a store and have to go through the action pipeline, instead of being requested directly. The store in Redux is still controlling and bureaucratic, but itâ€™s a little bit different. In Flux, you can have multiple stores. Each store has its own little fiefdom, and it is in total control. It holds on to its little slice of state, and has all the logic for changing that little slice of state. The Redux store tends to delegate more. And it has to. In Redux, there is only one storeâ€¦ so if it did everything itself, it would be taking on too much work. Instead, it takes care of holding on to the whole state tree. It then delegates the work of figuring out what state changes need to happen. The reducers, headed up by the root reducer, take on this task. You might have noticed thereâ€™s no dispatcher. Thatâ€™s because, in a bit of a power grab, the store has also taken over dispatching. The reducersWhen the store needs to know how an action changes the state, it asks the reducers. The root reducer takes charge and slices the state up based on the state objectâ€™s keys. It passes each slice of state to the reducer that knows how to handle it. I think of the reducers as a department of white-collar workers who are a little overzealous about photocopying. They donâ€™t want to mess anything up, so they donâ€™t change the state that has been passed in to them. Instead, they make a copy and make all their changes on the copy. This is one of the key ideas of Redux. The state object isnâ€™t manipulated directly. Instead, each slice is copied and then all of the slices are combined into a new state object. The reducers pass their copies back to the root reducer, which pastes the copies together to form the updated state object. Then the root reducer sends the new state object back to the store, and the store makes it the new official state. If you have a small application, you might only have one reducer making a copy of the whole state object and making its changes. Or if you have a large application, you might have a whole tree of reducers. This is another difference between Flux and Redux. In Flux, the stores arenâ€™t necessarily connected to each other and they have a flat structure. In Redux, the reducers are in a heirarchy. This hierarchy can have as many levels as needed, just like the component hierarchy. The views: smart and dumb componentsFlux has controller views and regular views. The controller views act as middle managers, managing the communication between the store and their child views. In Redux, thereâ€™s a similar concept: smart and dumb components. The smart components are the managers. They follow a few more rules than the controller views, though: Smart components are in charge of the actions. If a dumb component underneath them needs to trigger an action, the smart component passes a function in via the props. The dumb component can then just treat that as a callback. Smart components do not have their own CSS styles. Smart components rarely emit DOM of their own. Instead, they arrange dumb components, which handle laying out DOM elements. Dumb components donâ€™t depend on action files directly, since all actions are passed in via props. This means that the dumb component can be reused in a different app that has different logic. They also contain the styles that they need to look reasonably good (though you can allow for custom styling â€” just accept a style prop and merge it in to the default styles). The view layer binding To connect the store to the views, Redux needs a little help. It needs something to bind the two together. This is called the view layer binding. If youâ€™re using React, this is react-redux. The view layer binding is kind of like the IT department for the view tree. It makes sure that all of the components can connect to the store. It also takes care of a lot of technical details so that the rest of the hierarchy doesnâ€™t have to understand them. The view layer binding introduces three concepts: The Provider component: This is wrapped around the component tree. It makes it easy for the root componentâ€™s children to hook up to the store using connect(). connect(): This is a function provided by react-redux. If a component wants to get state updates, it wraps itself using connect(). Then the connect function will set up all the wiring for it, using the selector. selector: This is a function that you write. It specifies what parts of the state a component needs as properties. The root component All React applications have root components. This is just the component at the top level of the component hierarchy. But in Redux applications, this component takes on more responsibility. The role it plays is kind of like a C-level executive. It puts all of the teams in place to tackle the work. It creates the store, telling it what reducer to use, and brings together the view layer binding and the views. The root component is pretty hands-off after it initializes the app, though. It doesnâ€™t get caught up in the day-to-day concerns of triggering rerenders. It leaves that to the components below it, assisted by the view layer binding. How they all work togetherLetâ€™s see how these parts work together to create a functioning app. The setupThe different parts of the app need to be wired up together. This happens in setup. 1. Get the store ready. The root component creates the store, telling it what root reducer to use, using createStore(). This root reducer already has a team of reducers which report to it. It assembled that team of reducers using combineReducers(). 2. Set up the communication between the store and the components. The root component wraps its subcomponents with the provider component and makes the connection between the store and the provider. The Provider creates whatâ€™s basically a network to update the components. The smart components connect to network using connect(). This ensures theyâ€™ll get state updates. 3. Prepare the action callbacks. To make it easier for dumb components to work with actions, the smart components can setup action callbacks by using bindActionCreators(). This way, they can just pass down a callback to the dumb component. The action will be automatically dispatched after it is formatted. The data flowNow that the application is set up, the user can start interacting with it. Letâ€™s trigger an action to see the data flow. 1. The view requests an action. The action creator formats it and returns it. 2. The action is either dispatched automatically (if bindActionCreators() was used in setup), or the view dispatches the action. 3. The store receives the action. It sends the current state tree and the action to the root reducer. 4. The root reducer cuts apart the state tree into slices. Then it passes each slice to the subreducer that knows how to deal with it. 5. The subreducer copies the slice and makes changes to the copy. It returns the copy of the slice to the root reducer. 6. Once all of the subreducers have returned their slice copies, the root reducer pastes all of them together to form the whole updated state tree, which it returns to the store. The store replaces the old state tree with the new one. 7. The store tells the view layer binding that thereâ€™s new state. 8. The view layer binding asks the store to send over the new state. 9. The view layer binding triggers a rerender. So thatâ€™s how I think of Redux and its differences from Flux. Hope it helps! Coming up nextIâ€™m making a list of topics. If you have any suggestions, or there are any parts of the React ecosystem that you find confusing and youâ€™d like to see explained, let me know on Twitter. Resources Redux docs Dan Abramovâ€™s React Europe talk The Evolution of Flux Frameworks Smart and Dumb Components The upsides of using Redux The downsides of using Redux JS Jabber: The Evolution of Flux Libraries with Andrew Clark and Dan Abramov","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"redux","slug":"redux","permalink":"http://nthung2112.github.io/tags/redux/"}]},{"title":"Redux tháº­t lÃ  Ä‘Æ¡n giáº£n (Pháº§n 2)","slug":"Redux-that-la-don-gian-Phan-2","date":"2017-09-22T07:13:23.000Z","updated":"2017-10-01T08:24:53.492Z","comments":true,"path":"2017/09/Redux-that-la-don-gian-Phan-2.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Redux-that-la-don-gian-Phan-2.html","excerpt":"Redux vá»›i React Native BÃ i trÆ°á»›c NguyÃªn LÃ½ cá»§a Redux cÃ¡c báº¡n Ä‘Ã£ náº¯m Ä‘Æ°á»£c cÆ¡ báº£n pháº§n lÃ½ thuyáº¿t vá» Redux vÃ  dÃ¹ng cho viá»‡c gÃ¬, sau Ä‘Ã¢y chÃºng ta sáº½ Ä‘i vÃ o Ã¡p dá»¥ng nÃ³ vá»›i React hoáº·c React Native, á»Ÿ Ä‘Ã¢y mÃ¬nh chá»n React Native vÃ¬ nÃ³ váº«n Ä‘ang cÃ²n khÃ¡ HOT :D (Thá»±c ra React hay React Native thÃ¬ Ä‘á»u dÃ¹ng Redux lÃ  y há»‡t nhau)","text":"Redux vá»›i React Native BÃ i trÆ°á»›c NguyÃªn LÃ½ cá»§a Redux cÃ¡c báº¡n Ä‘Ã£ náº¯m Ä‘Æ°á»£c cÆ¡ báº£n pháº§n lÃ½ thuyáº¿t vá» Redux vÃ  dÃ¹ng cho viá»‡c gÃ¬, sau Ä‘Ã¢y chÃºng ta sáº½ Ä‘i vÃ o Ã¡p dá»¥ng nÃ³ vá»›i React hoáº·c React Native, á»Ÿ Ä‘Ã¢y mÃ¬nh chá»n React Native vÃ¬ nÃ³ váº«n Ä‘ang cÃ²n khÃ¡ HOT :D (Thá»±c ra React hay React Native thÃ¬ Ä‘á»u dÃ¹ng Redux lÃ  y há»‡t nhau)Äáº§u tiÃªn cÃ¡c báº¡n vÃ o link:https://facebook.github.io/react-native/docs/getting-started.html Ä‘á»ƒ lÃ m theo vÃ  táº¡o 1 project vá»›i React Native. LÆ°u Ã½: MÃ¡y pháº£i Ä‘Æ°á»£c cÃ i sáºµn yarn (https://yarnpkg.com/en/) hoáº·c dÃ¹ng npm sau khi Ä‘Ã£ cÃ i node, vÃ¬ náº¿u cÃ i yarn thÃ¬ nÃ³ sáº½ Ä‘á»“ng thá»i cÃ i node luÃ´n cho báº¡n. Pháº§n 1: Táº¡o giao diá»‡n mÃ n hÃ¬nh vá»›i React NativeSau khi install xong, táº¡o thÃªm thÆ° má»¥c src -&gt; file Main.js nhÆ° sau: á» Ä‘Ã¢y mÃ¬nh sáº½ minh há»a táº¡o chá»©c nÄƒng háº¿t sá»©c Ä‘Æ¡n giáº£n lÃ  Báº¥m â€” TÄƒng â€” Giáº£m 1 sá»‘ dÃ¹ng React Native + Redux cÃ³ mÃ n hÃ¬nh hiá»ƒn thá»‹ lÃªn nhÆ° sau: Main.js Trong thÆ° má»¥c components ta táº¡o thÃªm 1 component cÃ³ tÃªn Button.js, thá»±c táº¿ báº¡n khÃ´ng cáº§n pháº£i viáº¿t háº³n 1 component chá»‰ render má»—i cÃ¡i Button nhÆ° nÃ y, do mÃ¬nh muá»‘n tÃ¡ch nhá» component nÃªn táº¡m láº¥y vÃ­ dá»¥ viáº¿t 1 component con riÃªng ra. (trong component nÃ y mÃ¬nh cÃ³ dÃ¹ng react-native-elements cÃ i Ä‘áº·t nÃ³ qua yarn báº±ng lá»‡nh sau:yarn add react-native-elements Component Ä‘á»ƒ hiá»ƒn thá»‹ text number: Okay tá»›i Ä‘Ã¢y coi nhÆ° xong giao diá»‡n, nhÆ° váº­y báº¡n Ä‘Ã£ cÃ³ 1 app counter khÃ¡ Ä‘Æ¡n giáº£n :D vÃ  hoÃ n toÃ n cÃ³ thá»ƒ lÃ m dÃ¹ng React Native Ä‘Æ¡n giáº£n hÆ¡n nhiá»u, nhÆ°ng Ä‘á»ƒ hiá»ƒu vá» Redux thÃ¬ chÃºng ta nÃªn báº¯t Ä‘áº§u tá»« viá»‡c Ä‘Æ¡n giáº£n Ä‘Ã£. Pháº§n 2: CÃ i Ä‘áº·t ReduxStep1: install Redux, React-Redux dependencies yarn add redux react-redux Step 2: Táº¡o cáº¥u trÃºc thÆ° má»¥c project nhÆ° hÃ¬nh: 3 nhÃ¢n tá»‘ cá»§a Redux lÃ  actions, reducers vÃ  store tÆ°Æ¡ng á»©ng vá»›i 3 thÆ° má»¥c trong project. actions: index.js chá»©a cÃ¡c action (nÃ³ sáº½ export ra cho cÃ¡c class cÃ³ thá»ƒ gá»i tá»›i cÃ¡c function bÃªn trong nÃ³) types.js Ä‘á»‹nh nghÄ©a cÃ¡c háº±ng sá»‘ vá» kiá»ƒu cá»§a actions: reducers: Táº¡o 1 reducer counterReducer: lÃ m nhiá»‡m vá»¥ update state counter má»—i khi cÃ³ action click Tiáº¿p theo táº¡o file index.js, file nÃ y cÃ³ nhiá»‡m vá»¥ combine cÃ¡c reducers con thÃ nh 1 reducer duy nháº¥t Ä‘á»ƒ Ä‘Æ°a vÃ o store Store:táº¡o 1 file index.js trong thÆ° má»¥c store. (MÃ¬nh cÃ³ config thÃªm redux-devtools-extension Ä‘á»ƒ tiá»‡n debug vÃ  xem store khi redux hoáº¡t Ä‘á»™ng trÃªn extention cá»§a chrome). Step 3: connect React component vá»›i store cá»§a Redux Viá»‡c cáº§n lÃ m lÃ  lÃ m sao Ä‘á»ƒ káº¿t ná»‘i toÃ n bá»™ components cá»§a app vá»›i store cá»§a Redux. ThÆ° viá»‡n react-redux Ä‘Ã£ cung cáº¥p 1 tháº±ng cÃ³ tÃªn Provider Ä‘á»ƒ lÃ m cáº§u ná»‘i cho React vÃ  Redux, chÃºng ta chá»‰ viá»‡c bá»c nÃ³ bao ngoÃ i root component cá»§a React vÃ  truyá»n 1 tham sá»‘ duy nháº¥t lÃ  store vÃ o (store Ä‘Ã£ Ä‘Æ°á»£c táº¡o á»Ÿ thÆ° má»¥c store vÃ  Ä‘Æ°á»£c import vÃ o file nÃ y). Step 4: Gá»i 1 action tá»« 1 component vÃ  map data tá»« store ra View Quay láº¡i bÃ i trÆ°á»›c nhÆ° Ä‘Ã£ biáº¿t thÃ¬ flow cá»§a redux: action â†’ reducer â†’ store â†’ View 3 bÆ°á»›c Ä‘Ã£ thá»±c hiá»‡n xong á»Ÿ trÃªn, viá»‡c cÃ²n láº¡i lÃ  store vÃ  View tÆ°Æ¡ng tÃ¡c nhÆ° nÃ o, cÃ¢u há»i Ä‘áº·t ra lÃ  : PhÃ¡t Ä‘i 1 action tá»« component â†’ store nhÆ° tháº¿ nÃ o? Cáº­p nháº­t data thay Ä‘á»•i tá»« store â†’ View ra sao? Nhiá»‡m vá»¥ quan trá»ng nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi hÃ m connect() trong react-redux. HÃ m connect() cÃ³ 2 tham sá»‘: mapDispatchToProps(dispatch) nhiá»‡m vá»¥ map hÃ m dispatch() cá»§a store trá»Ÿ thÃ nh 1 thuá»™c tÃ­nh cá»§a props cá»§a component Ä‘Ã³, cá»¥ thá»ƒ á»Ÿ code bÃªn dÆ°á»›i thÃ¬ actions chÃ­nh lÃ  1 props cá»§a component Ä‘Ã³ vÃ  giá» muá»‘n phÃ¡t Ä‘i 1 action ta chá»‰ viá»‡c gá»i this.props.actions.tÃªn_action_ mapStateToProps(state) nhiá»‡m vá»¥ háº¿t sá»©c Ä‘Æ¡n giáº£n giá»‘ng nhÆ° cÃ¡i tÃªn cá»§a nÃ³, biáº¿n cÃ¡c state tá»« store thÃ nh props cá»§a component vÃ  sau Ä‘Ã³ show ra View Äá»ƒ Ä‘Æ¡n giáº£n vÃ  ngáº¯n gá»n hÆ¡n ta sáº½ bá» Ä‘i hÃ m mapDispatchToProps(dispatch) vÃ  thay báº±ng viá»‡c truyá»n trá»±c tiáº¿p actions vÃ o hÃ m connect() cuá»‘i cÃ¹ng sáº½ lÃ : connnect(mapStateToProps, actions)(COMPONENT) Quay trá»Ÿ láº¡i code React Native á»Ÿ trÃªn, á»Ÿ pháº§n View ta cÃ³: main.js Giáº£i thÃ­ch: Actions Ä‘Æ°á»£c import tá»« thÆ° má»¥c actions â†’ Ä‘Æ°á»£c truyá»n vÃ o lÃ  tham sá»‘ thá»© 2 cá»§a hÃ m connect() Má»—i khi button Ä‘c báº¥m thÃ¬ ta gá»i tá»›i hÃ m handle tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½ actions, nhá»› ráº±ng Ä‘Ã£ thá»±c hiá»‡n connnect(null, actions) á»Ÿ trÃªn thÃ¬ bÃ¢y giá» cÃ¡c actions export ra tá»« file index trong thÆ° má»±c actions trá»Ÿ thÃ nh cÃ¡c thuá»™c tÃ­nh cá»§a props trong component Main.js â†’ khi gá»i tá»›i action thÃ¬ ta chá»‰ viá»‡c gá»i this.props.action_name_tÆ°Æ¡ng_á»©ng_ Tiáº¿p theo lÃ  hiá»ƒn thá»‹ ra View á»Ÿ component child.js á» file nÃ y ta vá»«a gÃ¡n thuá»™c tÃ­nh counter : state.counter lÃºc nÃ y counter cÅ©ng trá»Ÿ thÃ nh 1 props cá»§a component Child â†’ gá»i show ra View ta chá»‰ cáº§n gá»i nhÆ° thÃ´ng thÆ°á»ng {this.props.counter} NhÆ° váº­y lÃ  1 app counter Ä‘Æ¡n giáº£n báº±ng React Native vÃ  Redux Ä‘Ã£ thá»±c hiá»‡n xong tÃ³m láº¡i flow nhÆ° sau: 1. View gá»“m 2 button Increase vÃ  Decrease vÃ  1 component hiá»ƒn thá»‹ number 2. Khi Button Ä‘Æ°á»£c click â†’ dispatch() tá»›i 1 action creator cÃ³ tÃªncounterIncrease() 3. counterIncrease() sáº½ táº¡o ra 1 Object (Trong redux action pháº£i lÃ  1 plain object cÃ³ thuá»™c tÃ­nh lÃ  type vÃ  payload, type lÃ  báº¯t buá»™c) á»Ÿ Ä‘Ã¢y chá»‰ cÃ³ 1 thuá»™c tÃ­nh {type:â€INCREASEâ€} sau Ä‘Ã³ nÃ³ truyá»n tá»›i counterReducer() Ä‘á»ƒ xá»­ lÃ½. 4. counterReducer(state, action) =&gt; kiá»ƒm tra xem action cÃ³ kiá»ƒu type = â€œincreaseâ€ tráº£ ra 1 state má»›i lÃ : state + 1 (state cá»§a redux lÃ  immutable) 5 á»Ÿ component View(Child) hiá»ƒn thá»‹ number ta sáº½ dÃ¹ng hÃ m mapStateToProps(state) Ä‘áº» nháº­n state lÃ  counter rá»“i update vÃ o View. â†’ App Ä‘Ã£ cháº¡y ngon lÃ nh :D Giáº£ sá»­ bÃ¢y giá» yÃªu cáº§u bÃ i toÃ¡n cÃ³ thay Ä‘á»•i chÃºt nhÆ° sau: Náº¿u click vÃ o nÃºt tÄƒng hoáº·c giáº£m mÃ  sau 1s con sá»‘ má»›i thay Ä‘á»•i. NÃ¢ng cao hÆ¡n chÃºt lÃ  náº¿u click vÃ o button increase number thÃ¬ number cháº¡y tá»« 0 cho tá»›i 1 con sá»‘ báº¥t ká»³ trong khoáº£ng 1s rá»“i dá»«ng láº¡i. BÃ¬nh thÆ°á»ng á»Ÿ bÃ i toÃ¡n trÃªn ta báº¥m nÃºt thÃ¬ ngay láº­p tá»©c action Ä‘Ã¡p tráº£ káº¿t quáº£, nhÆ°ng trong thá»±c táº¿ cÃ³ nhiá»u bÃ i toÃ¡n ko láº­p tá»©c cÃ³ thay Ä‘á»•i luÃ´n Ä‘iá»ƒn hÃ¬nh nhÆ° call api tá»›i server Ä‘á»ƒ fetch data, thÃ¬ pháº£i máº¥t 1 lÃºc káº¿t quáº£ má»›i Ä‘Æ°á»£c tráº£ vá». Hay nhÆ° bÃ i toÃ¡n báº¥m nÃºt thÃ¬ sau 1s má»›i thay Ä‘á»•i â†’ thÃ¬ nhá»¯ng Ä‘iá»u nÃ y ngÆ°á»i ta gá»i Ä‘Ã³ lÃ  side-effect . NhÆ° Ä‘Ã£ biáº¿t thÃ¬ Redux yÃªu cáº§u 1 object Ä‘Æ°á»£c tráº£ ra pháº£i lÃ  Plain object: {type: ACTION_TYPE, payload:params} vÃ  reducer pháº£i lÃ  pure function,hay nÃ³i cÃ¡ch khÃ¡c lÃ  hoÃ n toÃ n ko cÃ³ side-effect. Okay cÃ³ láº½ bÃ i thá»© 2 vá» redux Ä‘áº¿n Ä‘Ã¢y lÃ  dÃ i rá»“i :)) MÃ¬nh sáº½ giáº£i quyáº¿t váº¥n Ä‘á» side-effect á»Ÿ bÃ i sau dÃ¹ng Redux-middleware Háº¹n gáº·p láº¡i cÃ¡c báº¡n vá» bÃ i cuá»‘i cá»§a Redux. Source code vÃ­ dá»¥ trÃªn: check out branch lesson_2 https://github.com/tridungbk2010/react-native-class","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"redux","slug":"redux","permalink":"http://nthung2112.github.io/tags/redux/"}]},{"title":"Redux tháº­t lÃ  Ä‘Æ¡n giáº£n! (Pháº§n 1)","slug":"Redux-that-la-don-gian-Phan-1","date":"2017-09-22T07:02:19.000Z","updated":"2017-10-01T08:24:53.481Z","comments":true,"path":"2017/09/Redux-that-la-don-gian-Phan-1.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Redux-that-la-don-gian-Phan-1.html","excerpt":"NguyÃªn lÃ½ cÆ¡ báº£n cá»§a ReduxRedux ná»•i lÃªn trong vÃ²ng 2 nÄƒm nay nhÆ° 1 hiá»‡n tÆ°á»£ng, nÃ³ tháº­m chÃ­ thay tháº¿ luÃ´n kiáº¿n trÃºc Flux cá»§a Facebook dÃ¹ng cho React, vÃ  hiá»‡n táº¡i Facebook cÅ©ng khuyáº¿n cÃ¡o dev chuyá»ƒn qua dÃ¹ng Redux vÃ¬ nhiá»u Æ°u Ä‘iá»ƒm Ä‘Æ°á»£c cáº£i tiáº¿n tá»« Flux. Máº·c dÃ¹ nÃ³ ko cÃ²n tÃ­nh thá»i sá»± nhÆ° hÆ¡n 1 nÄƒm trÆ°á»›c nhÆ°ng mÃ¬nh váº«n quyáº¿t Ä‘á»‹nh viáº¿t series Redux Ä‘á»ƒ giÃºp cÃ¡c báº¡n má»›i há»c React vÃ  Redux tiáº¿p cáº­n dá»… dÃ ng hÆ¡n.","text":"NguyÃªn lÃ½ cÆ¡ báº£n cá»§a ReduxRedux ná»•i lÃªn trong vÃ²ng 2 nÄƒm nay nhÆ° 1 hiá»‡n tÆ°á»£ng, nÃ³ tháº­m chÃ­ thay tháº¿ luÃ´n kiáº¿n trÃºc Flux cá»§a Facebook dÃ¹ng cho React, vÃ  hiá»‡n táº¡i Facebook cÅ©ng khuyáº¿n cÃ¡o dev chuyá»ƒn qua dÃ¹ng Redux vÃ¬ nhiá»u Æ°u Ä‘iá»ƒm Ä‘Æ°á»£c cáº£i tiáº¿n tá»« Flux. Máº·c dÃ¹ nÃ³ ko cÃ²n tÃ­nh thá»i sá»± nhÆ° hÆ¡n 1 nÄƒm trÆ°á»›c nhÆ°ng mÃ¬nh váº«n quyáº¿t Ä‘á»‹nh viáº¿t series Redux Ä‘á»ƒ giÃºp cÃ¡c báº¡n má»›i há»c React vÃ  Redux tiáº¿p cáº­n dá»… dÃ ng hÆ¡n.Series gá»“m 3 pháº§n: Pháº§n 1: NguyÃªn lÃ½ cÆ¡ báº£n cá»§a Redux Pháº§n 2: CÃ i Ä‘áº·t vÃ  sá»­ dá»¥ng vá»›i React Native Pháº§n 3: Redux-middleware (Thunk, Saga, Observable) nÃªn dÃ¹ng cÃ¡i nÃ o? Má»i cÃ¡c báº¡n Ä‘Ã³n Ä‘á»c! Lá»‹ch sá»­ Redux (CÃ¢u chuyá»‡n vui) NÄƒm QuÃ½ Tá»‹ (2013), Facebook gia tá»™c bá»‘ cÃ¡o thiÃªn háº¡ ráº±ng Ä‚n GÃ´ La Ä‘áº¡i phÃ¡p (Angular) cá»§a Google gia tá»™c cháº­m cháº¡p, náº·ng ná», cho xuáº¥t tháº¿ má»™t bá»™ chiÃªu thá»©c gá»i lÃ  Rá»‘i An TÃ¢m PhÃ¡p (React). Tháº¿ nhÆ°ng Rá»‘i An TÃ¢m PhÃ¡p láº¡i chá»‰ laÌ€ mÃ´Ì£t bÃ´Ì£ tÃ¢m phaÌp cÆ°á»ng thÃ¢n kiÃªÌ£n thá»ƒ, khÃ´ng thá»ƒ duÌ€ng Ä‘ÃªÌ‰ rÃ¨n luyá»‡n ná»™i cÃ´ng (chá»‰ lÃ  má»™t library Ä‘á»ƒ render view). Do Ä‘Ã³, khÃ´ng lÃ¢u sau Facebook gia tá»™c tiáº¿p tá»¥c cho ra Ä‘á»i má»™t bá»™ tÃ¢m phÃ¡p cÆ¡ báº£n (kiáº¿n trÃºc thiáº¿t káº¿) vÃ  má»™t cÃ´ng phÃ¡p cÃ¹ng tÃªn lÃ  Phá» Láº¯c tháº§n cÃ´ng (Flux). Nghe Ä‘á»“n Rá»‘i An TÃ¢m PhÃ¡p vÃ  Phá» Láº¯c Tháº§n CÃ´ng káº¿t há»£p láº¡i sáº½ thÃ nh tuyá»‡t há»c dá»i non láº¥p bá»ƒ, khÃ´ng gÃ¬ khÃ´ng lÃ m Ä‘c. NhÃ¢n sÄ© giang há»“ (coder) vá»‘n nháº¹ dáº¡ cáº£ tin láº¡i rá»§ nhau tu luyá»‡n. Phá» Láº¯c tháº§n cÃ´ng rá»‘i ráº¯m khÃ³ há»c, nhÃ¢n sÄ© 10 pháº§n há»c thÃ¬ 4â€“5 pháº§n táº©u há»a nháº­p ma, pháº§n cÃ²n láº¡i cÅ©ng tráº§y da trÃ³c váº©y mÃ  cÃ´ng lá»±c cÅ©ng cháº³ng Ä‘Æ°á»£c nhÆ° lá»i Facebook gia tá»™c quáº£ng cÃ¡o. Báº¥y giá» cÃ³ má»™t nhÃ¢n sÄ© giang há»“ tá»± lÃ  Äan (Dan Abramov), Ä‘ang tu luyá»‡n Ä‘á»“ng thá»i Phá» láº¯c tháº§n cÃ´ng vÃ  ÃŠ La tháº§n cÃ´ng (Elm) má»›i nháº­n ra ráº±ng hai mÃ´n vÃµ cÃ´ng cÃ³ nhiá»u Ä‘iá»ƒm chung, chá»‰ khÃ¡c chiÃªu thá»©c, Äan bÃ¨n náº£y ra Ã½ Ä‘á»‹nh há»£p nháº¥t hai mÃ´n nÃ y láº¡i. KhÃ´ng lÃ¢u sau (5/2015), Äan cho xuáº¥t tháº¿ má»™t bá»™ cÃ´ng phÃ¡p mang tÃªn RÃ¬ Äáº¯t tháº§n cÃ´ng (Redux), mang Æ°u Ä‘iá»ƒm cá»§a cáº£ hai mÃ´n vÃµ cÃ´ng Ä‘á»“ng thá»i loáº¡i bá» nhá»¯ng phá»©c táº¡p dÆ° thá»«a cá»§a Phá» Láº¯c tháº§n cÃ´ng. NhÃ¢n sÄ© giang há»“ nghe váº­y má»«ng láº¯m, tháº¿ lÃ  láº¡i kÃ©o nhau Ä‘i há»c RÃ¬ Äáº¯t, cÃ²n Äan thÃ¬ Ä‘Æ°á»£c Facebookgia tá»™c má»i vá» lÃ m tá»™c nhÃ¢n. TrÃ­ch â€œJavaScript LÆ°á»£c Sá»­ Giang Há»“â€ Äá»c qua Ä‘oáº¡n Ä‘áº­m mÃ u sáº¯c kiáº¿m hiá»‡p á»Ÿ trÃªn cháº¯c cÃ¡c báº¡n pháº§n nÃ o cÅ©ng hÃ¬nh dung Ä‘Æ°á»£c Redux sinh ra Ä‘á»ƒ lÃ m gÃ¬ Ä‘Ãºng ko? 1. Redux sinh ra Ä‘á»ƒ lÃ m gÃ¬?Do yÃªu cáº§u cho cÃ¡c á»©ng dá»¥ng single-page sá»­ dá»¥ng Javascript ngÃ y cÃ ng trá»Ÿ lÃªn phá»©c táº¡p thÃ¬ code cá»§a chÃºng ta pháº£i quáº£n lÃ½ nhiá»u state hÆ¡n. State cÃ³ thá»ƒ bao gá»“m lÃ  data tráº£ vá» tá»« phÃ­a Server vÃ  Ä‘Æ°á»£c cached láº¡i hay nhÆ° dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra vÃ  thao tÃ¡c á»Ÿ phÃ­a client mÃ  chÆ°a Ä‘Æ°á»£c Ä‘áº©y lÃªn phÃ­a server. UI state cÅ©ng trá»Ÿ lÃªn phá»©c táº¡p vÃ¬ chÃºng ta cáº§n quáº£n lÃ½ viá»‡c active Routes, selected tabs, spinners, Ä‘iá»u khiá»ƒn phÃ¢n trang â€¦vv. Viá»‡c quáº£n lÃ½ tá»«ng thay Ä‘á»•i cá»§a state lÃ  ráº¥t khÃ³: VÃ¬ náº¿u nhÆ° khi ta thay Ä‘á»•i 1 Model -&gt; Model khÃ¡c cÅ©ng thay Ä‘á»•i theo vÃ  náº¿u 1 View thay Ä‘á»•i -&gt; Model thay Ä‘á»•i -&gt; Model khÃ¡c ná»¯a cÅ©ng thay Ä‘á»•i theo. Vá» phÃ­a Front-end development, thÃ¬ Ä‘Æ°á»£c ká»³ vá»ng xá»­ lÃ½ cÃ¡c váº¥n Ä‘á» nhÆ° â€œoptimistic updatesâ€ (Hiá»ƒu nhÆ° thá»ƒ má»™t thay Ä‘á»•i trÃªn giao diá»‡n Ä‘Æ°á»£c thá»±c hiá»‡n thÃ nh cÃ´ng trÆ°á»›c khi Ä‘Æ°á»£c xÃ¡c nháº­n tá»« phÃ­a server), render phÃ­a server, featching data trÆ°á»›c khi thá»±c hiá»‡n chuyá»ƒn trang â€¦vv. Náº¿u nhÆ° ko cÃ³ má»™t luá»“ng xá»­ lÃ½ khoa há»c vÃ  rÃµ rÃ ng thÃ¬ viá»‡c quáº£n lÃ½ dá»¯ liá»‡u vá»›i cÃ¡c dá»± Ã¡n lá»›n lÃ  vÃ´ cÃ¹ng phá»©c táº¡p. Váº¥n Ä‘á» phá»©c táº¡p nhÆ° Ä‘á» cáº­p á»Ÿ trÃªn sáº½ cÃ²n cÃ ng khÃ³ xá»­ lÃ½ hÆ¡n ná»¯a vÃ¬ chÃºng ta Ä‘ang trá»™n láº«n 2 khÃ¡i niá»‡m mÃ  nÃ³ ko tá»± nhiÃªn vá»›i tÆ° duy thÃ´ng thÆ°á»ng cá»§a con ngÆ°á»i Ä‘Ã³ lÃ : Biáº¿n Ä‘á»•i dá»¯ liá»‡u (Mutation) vÃ  tÃ­nh báº¥t Ä‘á»“ng bá»™ (Asynchronicity), máº·c dÃ¹ chÃºng sáº½ lÃ  tuyá»‡t vá»i náº¿u dÃ¹ng tÃ¡ch rá»i nhau, nhÆ°ng hoáº¡t Ä‘á»™ng cÃ¹ng nhau sáº½ gÃ¢y ra sá»± há»—n Ä‘á»™n. React JS Ä‘Ã£ cá»‘ gáº¯ng giáº£i quyáº¿t Ä‘iá»u nÃ y á»Ÿ trong táº§ng View báº±ng viá»‡c loáº¡i bá» Báº¥t Ä‘á»“ng bá»™ vÃ  KhÃ´ng thao tÃ¡c trá»±c tiáº¿p trÃªn DOM, tuy nhiÃªn viá»‡c quáº£n lÃ½ state lÃ  tÃ¹y thuá»™c vÃ o cÃ¡ch cá»§a báº¡n do váº­y Ä‘Ã¢y chÃ­nh lÃ  lÃ­ do Redux xuáº¥t hiá»‡n Ä‘á»ƒ giÃºp báº¡n quáº£n lÃ½ state má»™t cÃ¡ch khoa há»c vÃ  hiá»‡u quáº£ hÆ¡n. 2. Táº¡i sao ngÆ°á»i ta hay dÃ¹ng React vá»›i Redux?Redux ra Ä‘á»i láº¥y cáº£m há»©ng tá»« tÆ° tÆ°á»Ÿng cá»§a ngÃ´n ngá»¯ Elm vÃ  kiáº¿n trÃºc Flux cá»§a Facebook . Do váº­y Redux thÆ°á»ng dÃ¹ng káº¿t há»£p vá»›i React. Tuy nhiÃªn hoÃ n toÃ n cÃ³ thá»ƒ sá»­ dá»¥ng vá»›i cÃ¡c framework khÃ¡c nhÆ° Angular, Angular2, Backbone, Falcor, Deku, Swift. Váº­y báº¡n cÃ³ cáº§n biáº¿t Flux trÆ°á»›c khi Ä‘áº¿n vá»›i Redux ko? cÃ¢u tráº£ lá»i lÃ  KHÃ”NG vÃ¬ tháº­t sá»± náº¿u báº¡n Ä‘Ã£ dÃ¹ng flux thÃ¬ cÅ©ng tá»‘t, cÃ²n khÃ´ng thÃ¬ báº¡n láº¡i dá»… tiáº¿p cáº­n hÆ¡n (trÃ¡nh lá»‘i mÃ²n :D). 3. Quáº£n lÃ½ state báº±ng Redux nhÆ° tháº¿ nÃ o?Giáº£ xá»­ chÃºng ta cÃ³ 1 á»©ng dá»¥ng mÃ  cÃ¡c node nhÆ° trong hÃ¬nh lÃ  tÆ°á»£ng trÆ°ng cho má»™t single page application Ä‘Æ°á»£c mÃ´ hÃ¬nh tree-node. HÃ¬nh dung app cá»§a chÃºng ta váº­n hÃ nh báº±ng viá»‡c chuyá»ƒn Ä‘á»•i qua láº¡i data gá»¯a cÃ¡c node, má»—i node (trang con) chá»©a má»™t state vÃ  cÃ¡c node con nháº­n data Ä‘Æ°á»£c truyá»n tá»« node cha vÃ o node con. Giáº£ sá»­ náº¿u cÃ³ 1 action á»Ÿ node d3 Ä‘Æ°á»£c kÃ­ch hoáº¡t vÃ  ta muá»‘n thay Ä‘á»•i state d4 vÃ  c3 thÃ¬ luá»“ng dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c truyá»n tá»« node d3 trá»Ÿ vá» node gá»‘c lÃ  a, xong sau Ä‘Ã³ tá»« node a láº¡i phÃ¡t Ä‘i data Ä‘áº¿n cÃ¡c node con: Cáº­p nháº­t state cho node d4: d3-c2-b1-a-b2-c4-d4 Cáº­p nháº­t state cho node c3: d3-c2-b1-a-b2-c3 Vá»›i nhá»¯ng bÃ i toÃ¡n nhá» (chá»‰ cáº§n dÃ¹ng React JS ko cáº§n Redux) thÃ¬ update state qua láº¡i giá»¯a cÃ¡c page cÃ³ thá»ƒ dá»… dÃ ng nhÆ°ng báº¡n thá»­ hÃ¬nh dung á»©ng dá»¥ng lá»›n hÆ¡n cÃ³ ráº¥t nhiá»u nhÃ¡nh vÃ  node con thÃ¬ viá»‡c thao tÃ¡c update state qua láº¡i giá»¯a cÃ¡c page trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n khiáº¿n cho flow cá»§a code cÅ©ng khÃ³ Ä‘á»c vÃ  khÃ³ debug hÆ¡n. VÃ  giáº£i phÃ¡p Redux Ä‘Æ°a ra lÃ  nhÆ° sau: Quay láº¡i bÃ i toÃ¡n á»Ÿ trÃªn thÃ¬ ta chá»‰ cáº§n map Action tá»« node d3 vá» store cá»§a redux rá»“i á»Ÿ node c3 vÃ  d4 chá»‰ cáº§n connect vá»›i store vÃ  cáº­p nháº­t data thay Ä‘á»•i -&gt; háº¿t sá»©c Ä‘Æ¡n giáº£n pháº£i ko? 4. NguyÃªn táº¯c hoáº¡t Ä‘á»™ng cá»§a ReduxVá»«a xong pháº§n lÃ½ thuyáº¿t Ä‘á»ƒ pháº§n nÃ o cÃ¡c báº¡n mÆ°á»ng tÆ°á»£ng ra triáº¿t lÃ½ cá»§a Redux tiáº¿p theo sau Ä‘Ã¢y mÃ¬nh sáº½ Ä‘i sÃ¢u vÃ o giáº£i thÃ­ch cá»¥ thá»ƒ hÆ¡n cÃ¡c thÃ nh pháº§n cá»§a Redux a. KhÃ¡i niá»‡m cá»‘t lÃµi: HÃ£y tÆ°á»Ÿng tÆ°á»£ng state cá»§a app cá»§a báº¡n Ä‘Æ°á»£c mÃ´ táº£ nhÆ° 1 object thuáº§n dÆ°á»›i Ä‘Ã¢y: 12345678910&#123; todos: [&#123; text: 'Eat food', completed: true &#125;, &#123; text: 'Exercise', completed: false &#125;], visibilityFilter: 'SHOW_COMPLETED'&#125; Tháº­t sá»± thÃ¬ nÃ³ trÃ´ng giá»‘ng nhÆ° 1 model ko cÃ³ phÆ°Æ¡ng thá»©c setters ( nghÄ©a lÃ  chá»‰ cÃ³ thá»ƒ láº¥y ra data mÃ  ko cho phÃ©p thay Ä‘á»•i data Ä‘Ã³), Ä‘iá»u nÃ y Ä‘á»ƒ trÃ¡nh cÃ¡c thay Ä‘á»•i tÃ¹y tiá»‡n trong khi code gÃ¢y ra viá»‡c khÃ³ debug. Äá»ƒ thay Ä‘á»•i state, chá»‰ cÃ³ 1 cÃ¡ch duy nháº¥t lÃ  dispatch 1 action (MÃ¬nh sáº½ nÃ³i á»Ÿ pháº§n sau). b. 3 nguyÃªn táº¯c cá»§a Redux Single source of truth: State cá»§a toÃ n bá»™ á»©ng dá»¥ng Ä‘Æ°á»£c lÆ°u trong trong 1 store duy nháº¥t lÃ  1 Object mÃ´ hÃ¬nh tree. - State is read-only: Chá»‰ cÃ³ 1 cÃ¡ch duy nháº¥t Ä‘á»ƒ thay Ä‘á»•i state Ä‘Ã³ lÃ  táº¡o ra má»™t action (lÃ  1 object mÃ´ táº£ nhá»¯ng gÃ¬ xáº£y ra) Changes are made with pure functions: Äá»ƒ chá»‰ rÃµ state tree Ä‘Æ°á»£c thay Ä‘á»•i bá»Ÿi 1 action báº¡n pháº£i viáº¿t pure reducers c. NguyÃªn lÃ½ váº­n hÃ nh ActionsTrong Redux action lÃ  1 pure object Ä‘á»‹nh nghÄ©a 2 thuá»™c tÃ­nh lÃ  : type: kiá»ƒu mÃ´ táº£ action, vÃ  payload: giÃ¡ trá»‹ tham sá»‘ truyá»n lÃªn 1234&#123; type: \"KIEU_ACTION\", payload: //tham sá»‘&#125; ReducersAction cÃ³ nhiá»‡m vá»¥ mÃ´ táº£ nhá»¯ng gÃ¬ xáº£y ra nhÆ°ng láº¡i khÃ´ng chá»‰ rÃµ pháº§n state nÃ o cá»§a response thay Ä‘á»•i -&gt; Viá»‡c nÃ y sáº½ lÃ  cá»§a Reducer Ä‘áº£m nhiá»‡m: Reducer nháº­n 2 tham sá»‘ vÃ o: 1 state cÅ© vÃ  action Ä‘Æ°á»£c gá»­i lÃªn sau Ä‘Ã³ tráº£ ra má»™t state má»›i, ko lÃ m thay Ä‘á»•i state cÅ©. 1(previousState, action) =&gt; newState StoreStore lÃ  1 object lÆ°u trá»¯ state cá»§a toÃ n bá»™ á»©ng dá»¥ng cÃ³ 3 phÆ°Æ¡ng thá»©c sau: getState(): GiÃºp láº¥y ra state hiá»‡n táº¡i dispatch(action): Thá»±c hiá»‡n gá»i 1 action subscrible(listener):NÃ³ cÃ³ vai trÃ² cá»±c quan trá»ng, luÃ´n luÃ´n láº¯ng nghe xem cÃ³ thay Ä‘á»•i gÃ¬ ko rá»“i ngay láº­p tá»©c cáº­p nháº­t ra View Äá»ƒ cho dá»… hiá»ƒu hÆ¡n mÃ¬nh sáº½ minh há»a báº±ng vÃ­ dá»¥ sau: Ta cÃ³ 1 reducer, khá»Ÿ táº¡o store thÃ´ng qua hÃ m createStore(reducer), trong Redux. PhÃ¢n tÃ­ch vá»‹ dá»¥ trÃªn ta cÃ³: Step 1: Khá»Ÿi táº¡o store cho project mÃ  nÃ³ nháº­n tham sá»‘ Ä‘áº§u vÃ o lÃ  reducer counter á»Ÿ trÃªn: 1const store = createStore(counter); Step 2: Sau Ä‘Ã³ giáº£ sá»­ ta muá»‘n tÄƒng giÃ¡ trá»‹ lÃªn 1 thÃ¬ call action vá»›i type lÃ  â€œINCREMENTâ€ dÃ¹ng hÃ m dispatch() cá»§a store: 123document.addEventListener('click', () =&gt; &#123; store.dispatch(&#123;type:\"INCREMENT\"&#125;);&#125;); Step 3: lÃºc nÃ y lÃ  nhá»‡m vá»¥ cá»§a reducer, sáº½ xem kiá»ƒu action gá»i lÃªn lÃ  gÃ¬ â€œINCREMENTâ€ hay â€œDECREMENTâ€ Ä‘á»ƒ nÃ³ return ra 1 new state cá»¥ thá»ƒ á»Ÿ Ä‘Ã¢y lÃ  state + 1. Step 4: tháº±ngsubcrible() trong store sáº½ lÃ m nhiá»‡m vá»¥ cáº­p nháº­t tÃ¬nh hÃ¬nh thay Ä‘á»•i ra View: 123store.subcrible(() =&gt; &#123; document.body.innerText = store.getState(); &#125;); Äáº¿n Ä‘Ã¢y thÃ¬ cÆ¡ báº£n báº¡n Ä‘Ã£ náº¯m Ä‘Æ°á»£c nguyÃªn lÃ½ hoáº¡t Ä‘á»™ng cÆ¡ báº£n nháº¥t cá»§a Redux mÃ  tÃ´i táº¡m rÃºt gá»n láº¡i flow lÃ : action -&gt; reducer -&gt; store -&gt; View 5. TÃ³m láº¡iá» pháº¡m vi bÃ i nÃ y mÃ¬nh Ä‘Ã£ trÃ¬nh bÃ y nguyÃªn lÃ½ cÆ¡ báº£n vÃ  cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a Redux Ä‘á»ƒ cÃ¡c báº¡n cÃ³ thá»ƒ náº¯m Ä‘Æ°á»£c cÅ©ng nhÆ° hÃ¬nh dung nÃ³ sinh ra Ä‘á»ƒ lÃ m viá»‡c gÃ¬, bÃ i viáº¿t má»›i thá»ƒ hiá»‡n Ä‘Æ°á»£c cÃ¡c tÃ¬nh huá»‘ng Ä‘Æ¡n giáº£n nháº¥t thÃ´ng qua vÃ­ dá»¥ Ä‘Æ¡n giáº£n, cÃ²n trong khi lÃ m dá»± Ã¡n thá»±c táº¿ cÃ´ng viá»‡c chá»§ yáº¿u lÃ  tÆ°Æ¡ng tÃ¡c vá»›i server (fetch data) vÃ  xá»­ lÃ½ data sau Ä‘Ã³, thÃ¬ Ä‘Ã³ lÃ  vá» báº¥t Ä‘á»“ng bá»™ asynchronous vÃ  xá»­ lÃ½ side-effect sau má»—i action Ä‘Æ°á»£c gá»i. Viá»‡c nÃ y sáº½ Ä‘Æ°á»£c Redux xá»­ lÃ½ vá»›i Redux-middleware Háº¹n gáº·p láº¡i cÃ¡c báº¡n á»Ÿ pháº§n 2 vá» Redux: â€œRedux-middlewareâ€ 6. Nguá»“n tham kháº£o: http://redux.js.org/ https://toidicodedao.com/2016/08/18/js-truyen-ki-chuong-2-vo-lam-day-song/ https://egghead.io/lessons/javascript-redux-store-methods-getstate-dispatch-and-subscribe","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"redux","slug":"redux","permalink":"http://nthung2112.github.io/tags/redux/"}]},{"title":"Nhá»¯ng khÃ¡i niá»‡m Javascript báº¡n cáº§n biáº¿t khi phá»ng váº¥n","slug":"Nhung-khai-niem-Javascript-ban-can-biet-khi-phong-van","date":"2017-09-09T02:11:28.000Z","updated":"2018-05-18T01:01:57.921Z","comments":true,"path":"2017/09/Nhung-khai-niem-Javascript-ban-can-biet-khi-phong-van.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Nhung-khai-niem-Javascript-ban-can-biet-khi-phong-van.html","excerpt":"Tá»± há»cCÃ³ hÃ ng ngÃ n ngÆ°á»i Ä‘ang há»c JavaScript vÃ  web development vá»›i hy vá»ng cÃ³ Ä‘Æ°á»£c má»™t cÃ´ng viá»‡c. ThÆ°á»ng xuyÃªn tá»± há»c nhá»¯ng kiáº¿n thá»©c há»•ng trong sá»± hiá»ƒu biáº¿t cá»§a con ngÆ°á»i vá» ngÃ´n ngá»¯ JavaScript. Tháº­t ngáº¡c nhiÃªn lÃ  cáº§n Ã­t ngÃ´n ngá»¯ Ä‘á»ƒ táº¡o ra cÃ¡c trang web phá»©c táº¡p. Nhá»¯ng ngÆ°á»i lÃ m toÃ n bá»™ cÃ¡c trang web thÆ°á»ng khÃ´ng náº¯m Ä‘Æ°á»£c cÃ¡c nguyÃªn táº¯c cÆ¡ báº£n cá»§a Javascript. KhÃ¡ dá»… dÃ ng Ä‘á»ƒ trÃ¡nh cÃ¡c chá»§ Ä‘á» phá»©c táº¡p vÃ  thá»±c hiá»‡n cÃ¡c tÃ­nh nÄƒng sá»­ dá»¥ng cÃ¡c ká»¹ nÄƒng cÆ¡ báº£n. CÅ©ng khÃ¡ dá»… Ä‘á»ƒ táº¡o ra má»™t trang web báº±ng cÃ¡ch dá»±a vÃ o Stack Overflow mÃ  khÃ´ng hiá»ƒu code Ä‘ang Ä‘Æ°á»£c copied.","text":"Tá»± há»cCÃ³ hÃ ng ngÃ n ngÆ°á»i Ä‘ang há»c JavaScript vÃ  web development vá»›i hy vá»ng cÃ³ Ä‘Æ°á»£c má»™t cÃ´ng viá»‡c. ThÆ°á»ng xuyÃªn tá»± há»c nhá»¯ng kiáº¿n thá»©c há»•ng trong sá»± hiá»ƒu biáº¿t cá»§a con ngÆ°á»i vá» ngÃ´n ngá»¯ JavaScript. Tháº­t ngáº¡c nhiÃªn lÃ  cáº§n Ã­t ngÃ´n ngá»¯ Ä‘á»ƒ táº¡o ra cÃ¡c trang web phá»©c táº¡p. Nhá»¯ng ngÆ°á»i lÃ m toÃ n bá»™ cÃ¡c trang web thÆ°á»ng khÃ´ng náº¯m Ä‘Æ°á»£c cÃ¡c nguyÃªn táº¯c cÆ¡ báº£n cá»§a Javascript. KhÃ¡ dá»… dÃ ng Ä‘á»ƒ trÃ¡nh cÃ¡c chá»§ Ä‘á» phá»©c táº¡p vÃ  thá»±c hiá»‡n cÃ¡c tÃ­nh nÄƒng sá»­ dá»¥ng cÃ¡c ká»¹ nÄƒng cÆ¡ báº£n. CÅ©ng khÃ¡ dá»… Ä‘á»ƒ táº¡o ra má»™t trang web báº±ng cÃ¡ch dá»±a vÃ o Stack Overflow mÃ  khÃ´ng hiá»ƒu code Ä‘ang Ä‘Æ°á»£c copied. Náº¿u báº¡n Ä‘ang tÃ¬m kiáº¿m Ä‘á»ƒ lÃ m chá»§ phá»ng váº¥n JavaScript, hÃ£y vÃ o Ä‘Ã¢y Step Up Your JS: A Comprehensive Guide to Intermediate JavaScript Phá»ng váº¥nVáº¥n Ä‘á» lÃ  cÃ¡c cÃ¢u há»i kiá»ƒm tra sá»± hiá»ƒu biáº¿t cá»§a báº¡n vá» JS lÃ  chÃ­nh xÃ¡c lÃ  nhá»¯ng cÃ´ng ty cÃ´ng nghá»‡ yÃªu cáº§u trong cÃ¡c cuá»™c phá»ng váº¥n cá»§a há». NÃ³ trá»Ÿ nÃªn ráº¥t nhanh khi ngÆ°á»i á»©ng tuyá»ƒn biáº¿t Ä‘á»§ Ä‘á»ƒ vÆ°á»£t qua, nhÆ°ng khÃ´ng cÃ³ sá»± hiá»ƒu biáº¿t cháº¯c cháº¯n vá» ngÃ´n ngá»¯ nÃ y. ÄÃ¢y lÃ  nhá»¯ng khÃ¡i niá»‡m Ä‘Æ°á»£c há»i thÆ°á»ng xuyÃªn trong cÃ¡ch cuá»™c phá»ng váº¥n vá» phÃ¡t triá»ƒn web. Äiá»u nÃ y giáº£ Ä‘á»‹nh báº¡n Ä‘Ã£ biáº¿t nhá»¯ng Ä‘iá»u cÆ¡ báº£n nhÆ° loops, functions, vÃ  callbacks. KhÃ¡i niá»‡m Value vs. Reference â€” Understand how objects, arrays, and functions are copied and passed into functions. Know that the reference is whatâ€™s being copied. Understand that primitives are copied and passed by copying the value. Scope â€” Understand the difference between global scope, function scope, and block scope. Understand which variables are available where. Know how the JavaScript engine performs variable lookup. Hoisting â€” Understand that variable and function declarations are hoisted to the top of their available scope. Understand that function expressions are not hoisted. Closures â€” Know that a function retains access to the scope that it was created in. Know what this lets us do, such as data hiding, memoization, and dynamic function generation. this â€” Know the rules of this binding. Know how it works, know how to figure out what it will be equal to in a function, and know why itâ€™s useful. new â€” Know how it relates to object oriented programming. Know what happens to a function called with new. Understand how the object generated by using new inherits from the functionâ€™s prototype property. apply, call, bind â€” Know how each of these functions work. Know how to use them. Know what they do to this. Prototypes &amp; Inheritance â€” Understand that inheritance in JavaScript works through the [[Prototype]] chain. Understand how to set up inheritance through functions and objects and how new helps us implement it. Know what the __proto__ and prototype properties are and what they do. Asynchronous JS â€” Understand the event loop. Understand how the browser deals with user input, web requests, and events in general. Know how to recognize and correctly implement asynchronous code. Understand how JavaScript is both asynchronous and single-threaded. Higher Order Functions â€” Understand that functions are first-class objects in JavaScript and what that means. Know that returning a function from another function is perfectly legal. Understand the techniques that closures and higher order functions allow us to use. TÃ i nguyÃªn khÃ¡cNáº¿u cÃ¡c link trÃªn chÆ°a Ä‘á»§, cÃ³ vÃ´ sá»‘ tÃ i nguyÃªn trÃªn máº¡ng Ä‘á»ƒ giÃºp báº¡n tÃ¬m hiá»ƒu nhá»¯ng khÃ¡i niá»‡m nÃ y. CÃ¡ nhÃ¢n tÃ´i Ä‘Ã£ táº¡o Step Up Your JS: A Comprehensive Guide to Intermediate JavaScript Ä‘á»ƒ giÃºp cÃ¡c dev nÃ¢ng cao kiáº¿n thá»©c cá»§a há». NÃ³ bao gá»“m cÃ¡c khÃ¡i niá»‡m nÃ y vÃ  nhiá»u hÆ¡n ná»¯a. ÄÃ¢y lÃ  nhá»¯ng resources TÃ´i Ä‘Ã£ Ä‘á»c hoáº·c xem Ã­t nháº¥t vÃ  cÃ³ thá»ƒ gá»£i Ã½ cho báº¡n: Step Up Your JS You Donâ€™t Know JS JavaScript is Sexy javascript.com Frontend Masters Eloquent JavaScript ChÃºc may máº¯n trong cuá»™c phá»ng váº¥n cá»§a báº¡n.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"interview","slug":"interview","permalink":"http://nthung2112.github.io/tags/interview/"}]},{"title":"Truy cáº­p vÃ  thay Ä‘á»•i cÃ¡c biáº¿n CSS vá»›i Javascript","slug":"Truy-cap-va-thay-doi-cac-bien-CSS-voi-Javascript","date":"2017-09-08T13:46:11.000Z","updated":"2017-09-09T01:20:21.873Z","comments":true,"path":"2017/09/Truy-cap-va-thay-doi-cac-bien-CSS-voi-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Truy-cap-va-thay-doi-cac-bien-CSS-voi-Javascript.html","excerpt":"Táº¡i sao nÃ³ tá»‘t hÆ¡n sá»­ dá»¥ng biáº¿n SASSBiáº¿n trong SASS Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng trong má»™t thá»i gian. ChÃºng cho phÃ©p báº¡n Ä‘á»‹nh nghÄ©a má»™t biáº¿n má»™t láº§n lÃºc runtime vÃ  sá»­ dá»¥ng biáº¿n Ä‘Ã³ á»Ÿ nhiá»u nÆ¡i.â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“","text":"Táº¡i sao nÃ³ tá»‘t hÆ¡n sá»­ dá»¥ng biáº¿n SASSBiáº¿n trong SASS Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng trong má»™t thá»i gian. ChÃºng cho phÃ©p báº¡n Ä‘á»‹nh nghÄ©a má»™t biáº¿n má»™t láº§n lÃºc runtime vÃ  sá»­ dá»¥ng biáº¿n Ä‘Ã³ á»Ÿ nhiá»u nÆ¡i.â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ TÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c biáº¿n CSS vá»›i JS post-runtime.Trong báº£n demo nÃ y chÃºng ta sáº½ xÃ¢y dá»±ng má»™t form Ä‘Æ¡n giáº£n vÃ  sáº½ sá»­ dá»¥ng JS Ä‘á»ƒ tá»± Ä‘á»™ng cáº­p nháº­t cÃ¡c biáº¿n CSS (trong trÆ°á»ng há»£p nÃ y lÃ  thay Ä‘á»•i color vÃ  margin cá»§a má»™t dáº¥u cháº¥m) jsfiddle result JSFiddle Demo ChÃºng ta hÃ£y nhÃ¬n vÃ o nhá»¯ng pháº§n dÆ°á»›i Ä‘Ã¢y: CSScss with root vars ÄÃ¢y lÃ  má»™t vÃ i thÃ´ng tin vá» CSS :root, á»Ÿ Ä‘Ã¢y cÅ©ng váº­y. Tá»« MDN: The :root CSS pseudo-class matches the root element of a tree representing the document. In HTML, :root represents the html element and is identical to the selector html, except that its specificity is higher. CÃ¡c biáº¿n CSS Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong :root vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ dÃ²ng 13â€“14. -- lÃ  Ä‘á»‹nh nghÄ©a chuáº©n cá»§a CSS cho cÃ¡c biáº¿n. HTMLform markup Dá»… dÃ ng á»Ÿ Ä‘Ã¢y, lÆ°u Ã½ cÃ¡c thuá»™c tÃ­nh input trÃªn type=&quot;range&quot;. ChÃºng giá»¯ giÃ¡ trá»‹ min vÃ  max cÅ©ng nhÆ° giÃ¡ trá»‹ khá»Ÿi táº¡o value. TÆ°Æ¡ng tá»± cho loáº¡i input type=&quot;color&quot;. GiÃ¡ trá»‹ mÃ u khá»Ÿi táº¡o lÃ  #2cba92. JAVASCRIPTjs accessing css vars ThÃ´ng tin tá»«ng dÃ²ng: 4 â€” láº¥y pháº§n tá»­ footer 5 â€” láº¥y táº¥t cáº£ input trÃªn trang NodeList 7 â€” input CHANGE EventListener 8 â€” input MOUSEMOVE EventListener(updates dynamic margin on slide) 10 â€” hÃ m Ä‘áº·t láº¡i giÃ¡ trá»‹ mong muá»‘n CSS var(chÃº Ã½ chÃºng ta thÃªm px vÃ o biáº¿n cho margin á»Ÿ dÃ²ng line 14) VÃ  Ä‘Ã³ táº¥t cáº£ cho Truy cáº­p vÃ  thay Ä‘á»•i cÃ¡c biáº¿n CSS vá»›i Javascript.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"}]},{"title":"Cheatsheet cÆ¡ báº£n vá» Flexbox","slug":"Cheatsheet-co-ban-ve-Flexbox","date":"2017-09-06T00:05:26.000Z","updated":"2017-09-06T00:55:37.240Z","comments":true,"path":"2017/09/Cheatsheet-co-ban-ve-Flexbox.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Cheatsheet-co-ban-ve-Flexbox.html","excerpt":"Tá»•ng quan vá» cÃ¡ch sá»­ dá»¥ng flexible box layoutI spent the last days wrapping my head around flexbox, and how to use it correctly. Maybe you can relate to when I say, that it is not that easy to understand how it exactly works, or why some CSS rules donâ€™t behave as expected under certain circumstances. In this article, I just want to give a summary of what I think is important to know. So please keep in mind that this will not be an exhaustive description of all possible CSS rules and scenarios.","text":"Tá»•ng quan vá» cÃ¡ch sá»­ dá»¥ng flexible box layoutI spent the last days wrapping my head around flexbox, and how to use it correctly. Maybe you can relate to when I say, that it is not that easy to understand how it exactly works, or why some CSS rules donâ€™t behave as expected under certain circumstances. In this article, I just want to give a summary of what I think is important to know. So please keep in mind that this will not be an exhaustive description of all possible CSS rules and scenarios. Whatâ€™s flexbox? Flexbox is a layout mode which is designed for laying out more complex applications and webpages. â€” w3.org When using the flexbox layout model we distinguish between the two main elements: flex container and flex items. The flex container is the parent element of your flex items. You set display: flex or display: inline-flex on this element to activate the flex layout mode. Before outlining the details of a flex container or flex items, I want to talk about the terminology of the flex box layout model, which I found somehow confusing in the beginning. Hereâ€™s what I found about that in the flexbox specification: An illustration of the various directions, sizing and positioning terms as applied to a â€˜rowâ€™ flex container. First of all, in flexbox layout there is no horizontal or vertical. Instead, we orientate ourselves by a main axis and a cross axis. Flex items are always laid out along the main-axis. In the image above, you can see, that the main-axis for a row flex container goes from the left end of the flex container (main start) to the right end (main end). Basically, a column flex container is just a row flex container tilted by 90 degrees to the right. An illustration of the various directions, sizing and positioning terms as applied to a â€˜columnâ€™ flex container. For a column flex container things would look a bit different. As you can see in the image on the left, as soon as you use flex-direction: column, the main-axis points towards the bottom of the screen, while the cross-axis goes from the right end to the left end of the flex container. So basically the whole picture is just tilted to the right, by 90 degrees. This helped me a lot to orientate myself within a column flex container, since the CSS properties change their effective direction between row and column flex containers. Now thatâ€™s all we need for now. In the following sections Iâ€™m going to describe the different CSS rules which are applicable for flex container and flex items. The Flex Container CSS RulesLetâ€™s start with the CSS rules which are used on the flex container. I included some screenshots and put the respective CSS setting into the caption of the images. flex-directionThis rule determines if the flex-items are aligned in a row or in a column. Additionally, there is an option to align them in reverse order, heading from main-end to main-start. flex-direction: row; (default) flex-direction: column; flex-wrapIf you add more flex-items to a line, you will get to the point where there is not enough space for more. Since the flex-items shrink by default (see: flex-shrink the flex-items section) the items will get smaller the more items you add. By using flex-wrap you can control this behaviour if the items should stay in the same line (this is the default behaviour; flex-wrap: nowrap;) or wrap to the next line ( flex-wrap: wrap; or flex-wrap: wrap-reverse;) flex-wrap: nowrap; as as applied to a â€˜rowâ€™ flex-containerflex-wrap: wrap; flex-flowThis is the first shorthand I will show you today. You can combine the CSS rules flex-direction and flex-wrap within one single CSS rule. The following list should speak for itself: flex-flow: row wrap; flex-flow: row wrap-reverse; flex-flow: column wrap; flex-flow: column wrap-reverse; justify-contentTo position the flex-items alongside the main axis, you can use justify-content: justify-content: flex-start; (default behaviour)justify-content: flex-end;justify-content: center;justify-content: space-between;justify-content; space-around; align-itemsNow that you learned about justify-content to lay out items along the main axis, this is an easier one. align-items is used to align items along the cross-axis on the current line. align-items: flex-start; (default behaviour)align-items: flex-end;align-items: center;align-items: stretch;align-items: baseline; As you see, align-items also allows to stretch items to use the available space in the current line, as well as align-items: baseline;aligns items along the bottom line of their first line of text. But what do you do if you donâ€™t want to align the items within one line, but rather align the whole bunch of items within the available space of the flex-container? Thatâ€™s what align-content is used for. align-contentLetâ€™s have a look how we can align the whole bunch of flex-items within our flex container: align-content: flex-start; (default behaviour)align-content: flex-end;align-content: center;align-conent; stretch; That was a rather short overview of what you are capable to do with flex-container CSS rules. In the next section Iâ€™m going to show you how you can adjust the behaviour of flex-items. The Flex Item CSS RulesIn the last section you learned how to align all flex items at once â€” either within their line or within the available space of their flex container. Now itâ€™s time to have a look at flex-grow ,flex-shrink ,flex-basis and the flex shorthand for those three rules. flex-growDefines if items cang row to use the available space along the main-axis. The default value is 0, which means that flex-items donâ€™t grow automatically. In the following pictures you can see which effect flex-grow has on flex items in a â€˜rowâ€™ and in a â€˜columnâ€™ container. flex-grow: 0; (default behaviour) in a â€˜rowâ€™ containerflex-grow: 1; in a â€˜rowâ€™ containerflex-grow: 0; (default behaviour) in a â€˜columnâ€™ containerflex-grow: 1; in a â€˜columnâ€™ container With flex-grow it is also possible to let certain items grow more than others. Example: We have three items. Two of them have flex-grow set to 1, while one of them got flex-grow set to 2. What happened here? First of all, all flex-grow values of a line are added, which results in a total of 4 which represents 100% of our available space.Then each item is sized according to the relational size of its flex-grow setting to the sum of all flex-grow settings of said line. According to that calculation, the first two items get 25% of the available space and the third one gets 50%. Please note that I did not consider the padding and margin which is set in the image. flex-shrinkBy default, the shrink rule is set to 1. This means that as soon as the window is resized, the flex items will shrink if necessary. Possible values are 0 and 1. Example: The flex item of the following picture has a width of 500px. With flex-shrink set to itâ€™s default value 1, resizing the window means that the item will shrink to less than 500px width. When setting flex-shrink to 0, the item will not shrink and would exceed the window size and a scrollbar appears. The item has a width of 500px. (Sidenote: flex-grow is switched off)flex-shrink is turned on â€” resizing the window also resizes the item.flex-shrink turned off. The item exceeds the window (scrollbars omitted in this picture) flex-basisThe flex basis defines the initial main-size of a flex item. This setting will be evaluated before the available space is distributed to flex-grow, or the items are resized by flex-shrink. The initial main size of the flex item before free space is distributed to the flex factors. â€” w3.org flex-basis accepts either a length in px || em || rem or percentages, as well as auto. If flex-basis is set to auto, the width will be calculated based on content size. So the more you increase the content of a flex item, the bigger it gets. As soon as you set a fixed size to flex-basis, the content of the item will adjust to fit into the item. flex-basis: auto;flex-basis: auto; with more contentflex-basis: 100px; The flex shorthandBecause it is way more comfortable to set the above rules all at once, there is a shorthand to do so: The default setting for this is flex: 0 1 auto; With the shorthand you define flex-grow with the first, flex-shrink with the second, and flex-basis with the third argument. It is also possible to omit the last parameter: flex: 0 1 which defaults flex-basis to zero_._ The following pictures show some examples how you can arrange flex-items using the flex shorthand. flex: 0 1 auto (default behaviour) The item size is defined by its content. flex: 0 1 auto; (default behaviour) flex: 1 1 auto flex: 1 1 auto; flex: 0 0 autoThis is the same as the example in the above section â€œflex-shrinkâ€. Shrinking is turned off, which leads to the item overflowing the window size. flex: 0 0 auto; Relative size of flex-items To use the same â€œrelativeâ€ sizing technique I described in the section â€œflex-growâ€, you have to set flex-basis to zero. In the next picture, the first item has flex: 2 1 0; while the second item has flex: 1 1 0; The first item got 2/3 of the available size while the second one got 1/3 ConclusionWell that article grew a bit bigger than it was planned, but in the end, I hope you enjoyed the read. Maybe this article can serve as a handy guide to look up the different CSS rules if you want to brush up your knowledge, as this is something one might not memorize completely. As I said in the beginning, this was never meant to be an exhaustive list of szenarios and rules which can apply, if you are interested in this in detail, I would suggest to read the articles I mentioned in the beginning of the article, as well as parts of the specification (if you donâ€™t want to read the whole thing) Understanding Flexbox: Everything you need to know (Ohans Emmanuel) 11 things I learned reading the flexbox spec (David Gilbertson) CSS Flexible Box Layout Module Level 1 At first, I planned to also create this as a handy cheatsheet, but then I found a really good one by Chris Coyier which I want to share with you: A Complete Guide to Flexbox Thanks for reading this article!","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"flexbox","slug":"flexbox","permalink":"http://nthung2112.github.io/tags/flexbox/"}]},{"title":"Má»™t sá»‘ SASS Mixins nÃªn sá»­ dá»¥ng","slug":"Mot-so-SASS-Mixins-nen-su-dung","date":"2017-09-01T02:53:15.000Z","updated":"2017-09-05T01:12:39.032Z","comments":true,"path":"2017/09/Mot-so-SASS-Mixins-nen-su-dung.html","link":"","permalink":"http://nthung2112.github.io/2017/09/Mot-so-SASS-Mixins-nen-su-dung.html","excerpt":"Danh sÃ¡ch má»™t sá»‘ SASS mixins mÃ  cÃ¡c Web designers nÃªn cÃ³ Ä‘á»ƒ cÃ´ng viá»‡c cá»§a há» nhanh hÆ¡n. TÃ´i Ä‘Ã£ sá»­ dá»¥ng SASS khÃ´ng quÃ¡ lÃ¢u, nhÆ°ng ká»ƒ tá»« khi tÃ´i báº¯t Ä‘áº§u vá»›i nÃ³, TÃ´i Ä‘Ã£ sá»­ dá»¥ng má»™t sá»‘ mixins Ä‘á»ƒ auto má»™t sá»‘ thá»© trong dá»± Ã¡n cá»§a tÃ´i. Mixins giá»‘ng nhÆ° cÃ¡c hÃ m tá»± Ä‘á»™ng táº¡o ra code CSS vÃ  giÃºp báº¡n tiáº¿t kiá»‡m viáº¿t code giá»‘ng nhau láº·p Ä‘i láº·p láº¡i. CÃ³ má»™t sá»‘ lÆ°á»£ng tá»‘t thÆ° viá»‡n SASS mixin sáºµn cÃ³ trÃªn web (eg. bourbon) má»™t hoáº·c má»™t sá»‘ trong sá»‘ Ä‘Ã³ báº¡n cÃ³ thá»ƒ Ä‘Ã£ sá»­ dá»¥ng. Hoáº·c nhÆ° tÃ´i, báº¡n cÃ³ thá»ƒ Ä‘Ã£ táº¡o ra má»™t bá»™ tÃ¹y chá»‰nh báº±ng cÃ¡ch thu tháº­p cÃ¡c mixins siÃªu há»¯u Ã­ch tá»« web.","text":"Danh sÃ¡ch má»™t sá»‘ SASS mixins mÃ  cÃ¡c Web designers nÃªn cÃ³ Ä‘á»ƒ cÃ´ng viá»‡c cá»§a há» nhanh hÆ¡n. TÃ´i Ä‘Ã£ sá»­ dá»¥ng SASS khÃ´ng quÃ¡ lÃ¢u, nhÆ°ng ká»ƒ tá»« khi tÃ´i báº¯t Ä‘áº§u vá»›i nÃ³, TÃ´i Ä‘Ã£ sá»­ dá»¥ng má»™t sá»‘ mixins Ä‘á»ƒ auto má»™t sá»‘ thá»© trong dá»± Ã¡n cá»§a tÃ´i. Mixins giá»‘ng nhÆ° cÃ¡c hÃ m tá»± Ä‘á»™ng táº¡o ra code CSS vÃ  giÃºp báº¡n tiáº¿t kiá»‡m viáº¿t code giá»‘ng nhau láº·p Ä‘i láº·p láº¡i. CÃ³ má»™t sá»‘ lÆ°á»£ng tá»‘t thÆ° viá»‡n SASS mixin sáºµn cÃ³ trÃªn web (eg. bourbon) má»™t hoáº·c má»™t sá»‘ trong sá»‘ Ä‘Ã³ báº¡n cÃ³ thá»ƒ Ä‘Ã£ sá»­ dá»¥ng. Hoáº·c nhÆ° tÃ´i, báº¡n cÃ³ thá»ƒ Ä‘Ã£ táº¡o ra má»™t bá»™ tÃ¹y chá»‰nh báº±ng cÃ¡ch thu tháº­p cÃ¡c mixins siÃªu há»¯u Ã­ch tá»« web.Táº¡o thÆ° viá»‡n tÃ¹y chá»‰nh luÃ´n luÃ´n phá»¥c vá»¥ tá»‘t vÃ  gá»n gÃ ng. Báº±ng cÃ¡ch nÃ y báº¡n trÃ¡nh thÃªm code khÃ´ng cáº§n thiáº¿t vÃ  chá»‰ thÃªm nhá»¯ng gÃ¬ báº¡n thá»±c sá»± cáº§n. DÆ°á»›i Ä‘Ã¢y lÃ  danh sÃ¡ch má»™t sá»‘ SASS mixins tiá»‡n dá»¥ng TÃ´i Ä‘Ã£ sá»­ dá»¥ng háº±ng ngÃ y vá»›i cÃ¡c dá»± Ã¡n cá»§a tÃ´i. Má»™t sá»‘ trong sá»‘ chÃºng Ä‘Æ°á»£c thu tháº­p tá»« web, má»™t sá»‘ Ä‘Æ¡n giáº£n lÃ  Ä‘á»§ Ä‘á»ƒ viáº¿t cho mÃ¬nh. Kiá»ƒm tra cÃ¡c Ä‘oáº¡n mixins dÆ°á»›i Ä‘Ã¢y, cÃ¡ch sá»­ dá»¥ng vÃ­ dá»¥, vÃ  output cá»§a chÃºng: 1. ThÃªm kÃ­ch thÆ°á»›cMá»™t mixin Ä‘Æ¡n giáº£n Ä‘á»ƒ cho kÃ­ch thÆ°á»›c vÃ o má»™t box. 1234@mixin box($width, $height=$width) &#123; width: $width; height: $height;&#125; UsageBáº¡n pháº£i cung cáº¥p Ã­t nháº¥t má»™t tham sá»‘ Ä‘á»ƒ lÃ m cho nÃ³ hoáº¡t Ä‘á»™ng: 1234567.square &#123; @include box(50px);&#125;.rectangle &#123; @include box(100px, 50px);&#125; Output123456789.square &#123; width: 50px; height: 50px;&#125;.rectangle &#123; width: 100px; height: 50px;&#125; 2. ClearfixImplementing micro-clearfix hack the SASS way. 1234567@mixin clearfix &#123; &amp;:after &#123; content: \"\"; display: table; clear: both; &#125;&#125; Usage123.cf &#123; @include clearfix;&#125; Output12345.cf:after &#123; content: \"\"; display: table; clear: both;&#125; 3. OpacityCSS Opacity with fallback for IE8+. 12345@mixin opacity($opacity) &#123; opacity: $opacity; $opacity-ie: $opacity * 100; filter: alpha(opacity = $opacity-ie); //IE8&#125; Output123.fade &#123; @include opacity(.4);&#125; Output1234.fade &#123; opacity: .4; filter: alpha(opacity = 40); //IE8&#125; 4. PositioningEasy and quick CSS positioning, thanks to Hugo Giraudel. 12345678910111213141516171819202122@mixin position($position, $args) &#123; @each $o in top right bottom left &#123; $i: index($args, $o); @if $i and $i + 1 &lt;= length($args) and type-of(nth($args, $i + 1)) == number &#123; #&#123;$o&#125;: nth($args, $i + 1); &#125; &#125; position: $position;&#125;// Positioning helpers@mixin absolute($args: '') &#123; @include position(absolute, $args);&#125;@mixin fixed($args: '') &#123; @include position(fixed, $args);&#125;@mixin relative($args: '') &#123; @include position(relative, $args);&#125; UsageYou should only use absolute(), relative(), and fixed() functions to add the respective positioning to the elements. Parameters are optional and can be given as demonstrated below: 1234567891011.menu li &#123; @include relative;&#125;.sub-menu &#123; @include absolute(top 100% left 0);&#125;.sticky-bar &#123; @include fixed(top 0 left 0);&#125; 5. Rem unitsImplementing CSS rem units with pixel fallback. 1234@mixin font-size($size, $base: 16) &#123; font-size: $size; // fallback for old browsers font-size: ($size / $base) * 1rem;&#125; Usage1234567body &#123; @include font-size(16);&#125;p &#123; @include font-size(12, 10);&#125; Báº¡n pháº£i cung cáº¥p Ã­t nháº¥t má»™t giÃ¡ trá»‹ khi sá»­ dá»¥ng mixin, giÃ¡ trá»‹ nÃ y sáº½ Ä‘Æ°á»£c coi lÃ  font-size vÃ  sáº½ Ä‘Æ°á»£c xuáº¥t ra sau khi Ä‘Æ°á»£c tÃ­nh toÃ¡n vá»›i font-size máº·c Ä‘á»‹nh (16). Hoáº·c báº¡n cÃ³ thá»ƒ cung cáº¥p má»™t giÃ¡ trá»‹ cÆ¡ sá»Ÿ khÃ¡c náº¿u báº¡n muá»‘n. Output1234body &#123; font-size: 16px; font-size: 1rem;&#125; 6. Vendor prefixingVendor prefixing made easy with full control over prefixes, customize as you use: 12345678910@mixin prefix($property, $value, $vendors: webkit moz ms o, $default: true) &#123; @if $vendors &#123; @each $vendor in $vendors &#123; #&#123;\"-\" + $vendor + \"-\" + $property&#125;: #&#123;$value&#125;; &#125; &#125; @if $default &#123; #&#123;$property&#125;: #&#123;$value&#125;; &#125;&#125; Usage123456789html &#123; @include prefix('box-sizing', 'border-box', moz webkit);&#125;*,*:before,*:after &#123; @include prefix('box-sizing', 'inherit', moz webkit);&#125; As shown above, you may provide the vendor prefixes as the 3rd parameter in the mixin, each separated by a space. Output12345678910111213html &#123; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;&#125;*,*:before,*:after &#123; -moz-box-sizing: inherit; -webkit-box-sizing: inherit; box-sizing: inherit;&#125; 7. Media queriesHandling CSS Media queries was never this easy: 12345678910111213141516171819202122232425@mixin screen($size) &#123; $desktop: \"(min-width: 1024px)\"; $tablet: \"(min-width: 768px) and (max-width: 1023px)\"; $mobile: \"(max-width: 767px)\"; @if $size == desktop &#123; @media only screen and #&#123;$desktop&#125; &#123; @content; &#125; &#125; @else if $size == tablet &#123; @media only screen and #&#123;$tablet&#125; &#123; @content; &#125; &#125; @else if $size == mobile &#123; @media only screen and #&#123;$mobile&#125; &#123; @content; &#125; &#125; @else &#123; @media only screen and #&#123;$size&#125; &#123; @content; &#125; &#125;&#125; Usage1234567891011.wrapper &#123; margin: 0 auto; width: 100%; @include screen('tablet') &#123; width: 90%; &#125; @include screen('desktop') &#123; width: 85%; &#125;&#125; Output1234567891011121314.wrapper &#123; margin: 0 auto; width: 100%;&#125;@media only screen and (min-width: 768px) and (max-width: 1023px) &#123; .wrapper &#123; width: 90%; &#125;&#125;@media only screen and (min-width: 1024px) &#123; .wrapper &#123; width: 85%; &#125;&#125; In place of â€˜mobileâ€™, â€˜tabletâ€™, or â€˜desktopâ€™, you may also provide a custom breakpoint values, for eg: 12345.wrapper &#123; @include screen('(min-width: 1367px)') &#123; width: 1280px; &#125;&#125; 8. Retina ImagesShow the retina images on retina-friendly devices only: 1234567891011@mixin retina($image, $width, $height) &#123; @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6/2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) &#123; /* Serving 2x image on Retina display */ background-image: url($image); background-size: $width $height; &#125;&#125; Usage1234.logo &#123;background-image: url(\"img/logo.png\"); @include retina(\"img/logo@2x.png\", 100px, 21px);&#125; Output12345678910.logo &#123; background-image: url(\"img/logo.png\");&#125;@media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) &#123; .logo &#123; /* Serving HQ image on Retina display */ background-image: url(\"img/logo@2x.png\"); background-size: 100px 21px; &#125;&#125; The above example usage may not be perfect and you may add more rules for specifying width and height of the element to be optimized for retina screen. 9. CSS3 KeyframesCSS3 keyframes canâ€™t be implemented with the vendor prefixing mixin mentioned above. The below mixin is meant to render keyframes correctly with the vendor prefixes: 12345678910111213@mixin keyframes($name) &#123; @-webkit-keyframes #&#123;$name&#125; &#123; @content; &#125; @-moz-keyframes #&#123;$name&#125; &#123; @content; &#125; @keyframes #&#123;$name&#125; &#123; @content; &#125;&#125; Usage12345678@include keyframes(animate) &#123; 50% &#123; transform: rotate(90deg); &#125; 100% &#123; transform: rotate(-90deg); &#125;&#125; Output123456789101112131415161718192021222324@-webkit-keyframes animate &#123; 50% &#123; transform: rotate(90deg); &#125; 100% &#123; transform: rotate(-90deg); &#125;&#125;@-moz-keyframes animate &#123; 50% &#123; transform: rotate(90deg); &#125; 100% &#123; transform: rotate(-90deg); &#125;&#125;@keyframes animate &#123; 50% &#123; transform: rotate(90deg); &#125; 100% &#123; transform: rotate(-90deg); &#125;&#125; 10. Background GradientQuick and simple SASS mixin to implement CSS linear gradients: 12345678910111213@mixin gradient($start-color, $end-color, $orientation) &#123; background: $start-color; @if $orientation == 'vertical' &#123; background: -webkit-linear-gradient(top, $start-color, $end-color); background: linear-gradient(to bottom, $start-color, $end-color); &#125; @else if $orientation == 'horizontal' &#123; background: -webkit-linear-gradient(left, $start-color, $end-color); background: linear-gradient(to right, $start-color, $end-color); &#125; @else &#123; background: -webkit-radial-gradient(center, ellipse cover, $start-color, $end-color); background: radial-gradient(ellipse at center, $start-color, $end-color); &#125;&#125; Usage123.gradient &#123; @include gradient(#07c, #06f, vertical);&#125; Output12345.gradient &#123; background: #07c; background: -webkit-linear-gradient(top, #07c, #06f); background: linear-gradient(to bottom, #07c, #06f);&#125; 11. @font-face123456789101112@mixin font-face($font-name, $file-name, $weight: normal, $style: normal) &#123; @font-face &#123; font-family: quote($font-name); src: url($file-name + '.eot'); src: url($file-name + '.eot?#iefix') format('embedded-opentype'), url($file-name + '.woff') format('woff'), url($file-name + '.ttf') format('truetype'), url($file-name + '.svg##&#123;$font-name&#125;') format('svg'); font-weight: $weight; font-style: $style; &#125;&#125; Usage1@include font-face(\"MyFont\", \"path/to/MyFont\", $style: normal, $weight: normal); Output1234567@font-face &#123; font-family: \"MyFont\"; src: url(\"path/to/MyFont.eot\"); src: url(\"path/to/MyFont.eot?#iefix\") format(\"embedded-opentype\"), url(\"path/to/MyFont.woff\") format(\"woff\"), url(\"path/to/MyFont.ttf\") format(\"truetype\"), url(\"path/to/MyFont.svg#MyFont\") format(\"svg\"); font-weight: normal; font-style: normal;&#125; 12. Centering a block12345@mixin center-block &#123; display: block; margin-left: auto; margin-right: auto;&#125; Usage123.wrapper &#123; @include center-block;&#125; Output12345.wrapper &#123; display: block; margin-left: auto; margin-right: auto;&#125; 13. Vertical centering123456@mixin center-vertically &#123; position: absolute; top: 50%; left: 50%; @include prefix(transform, translate(-50%, -50%), 'webkit' 'ms');&#125; Usage123.vc-box &#123; @include center-vertically;&#125; Output12345678.vc-box &#123; position: absolute; top: 50%; left: 50%; -webkit-transform: translate(-50%, -50%); -ms-transform: translate(-50%, -50%); transform: translate(-50%, -50%);&#125; Káº¿t thÃºc á»Ÿ Ä‘Ã¢y, hy vá»ng nÃ³ cÃ³ Ã­ch. Vui lÃ²ng chá»‰ ra váº¥n Ä‘á» hoáº·c chia sáº» cÃ¡c Ä‘á» xuáº¥t cá»§a báº¡n qua nháº­n xÃ©t. Thanks :)","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"sass","slug":"sass","permalink":"http://nthung2112.github.io/tags/sass/"}]},{"title":"HÆ°á»›ng dáº«n toÃ n táº­p vá» Flexbox","slug":"Huong-dan-toan-tap-ve-Flexbox","date":"2017-08-31T08:32:14.000Z","updated":"2017-09-05T01:12:39.022Z","comments":true,"path":"2017/08/Huong-dan-toan-tap-ve-Flexbox.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Huong-dan-toan-tap-ve-Flexbox.html","excerpt":"BackgroundThe Flexbox Layout (Flexible Box) module nháº±m cung cáº¥p má»™t cÃ¡ch hiá»‡u quáº£ hÆ¡n viá»‡c bá»‘ trÃ­, sáº¯p xáº¿p vÃ  cÃ¢n Ä‘á»‘i khÃ´ng gian giá»¯a cÃ¡c pháº§n tá»­ trong má»™t Container, ngay cáº£ khi kÃ­ch thÆ°á»›c cá»§a cÃ¡c pháº§n tá»­ nÃ y chÆ°a Ä‘Æ°á»£c biáº¿t hay nÃ³i cÃ¡ch khÃ¡c lÃ  Ä‘á»™ng (flex). Má»¥c Ä‘Ã­ch chÃ­nh cá»§a Flex layout lÃ  cung cáº¥p má»™t flex container cÃ³ kháº£ nÄƒng thay Ä‘á»•i cÃ¡c item bÃªn trong nÃ³ chiá»u rá»™ng, chiá»u cao, thá»© tá»± cá»§a cÃ¡c item giÃºp cho Flex container nÃ y hiá»ƒn thá»‹ tá»‘t trÃªn má»i thiáº¿t bá»‹ vÃ  má»i kÃ­ch cá»¡ mÃ n hÃ¬nh. CÃ¡c item trong má»™t flex container sáº½ tá»± má»Ÿ rá»™ng Ä‘á»ƒ láº¥p Ä‘áº§y khÃ´ng gian hoáº·c tá»± co láº¡i Ä‘á»ƒ ngÄƒn cháº·n chá»‘ng trÃ n (Overflow).","text":"BackgroundThe Flexbox Layout (Flexible Box) module nháº±m cung cáº¥p má»™t cÃ¡ch hiá»‡u quáº£ hÆ¡n viá»‡c bá»‘ trÃ­, sáº¯p xáº¿p vÃ  cÃ¢n Ä‘á»‘i khÃ´ng gian giá»¯a cÃ¡c pháº§n tá»­ trong má»™t Container, ngay cáº£ khi kÃ­ch thÆ°á»›c cá»§a cÃ¡c pháº§n tá»­ nÃ y chÆ°a Ä‘Æ°á»£c biáº¿t hay nÃ³i cÃ¡ch khÃ¡c lÃ  Ä‘á»™ng (flex). Má»¥c Ä‘Ã­ch chÃ­nh cá»§a Flex layout lÃ  cung cáº¥p má»™t flex container cÃ³ kháº£ nÄƒng thay Ä‘á»•i cÃ¡c item bÃªn trong nÃ³ chiá»u rá»™ng, chiá»u cao, thá»© tá»± cá»§a cÃ¡c item giÃºp cho Flex container nÃ y hiá»ƒn thá»‹ tá»‘t trÃªn má»i thiáº¿t bá»‹ vÃ  má»i kÃ­ch cá»¡ mÃ n hÃ¬nh. CÃ¡c item trong má»™t flex container sáº½ tá»± má»Ÿ rá»™ng Ä‘á»ƒ láº¥p Ä‘áº§y khÃ´ng gian hoáº·c tá»± co láº¡i Ä‘á»ƒ ngÄƒn cháº·n chá»‘ng trÃ n (Overflow).Quan trá»ng nháº¥t, Flexbox layout dá»±a trÃªn phÆ°Æ¡ng hÆ°á»›ng bá»‘ trÃ­ ngÆ°á»£c vá»›i cÃ¡ch bá»‘ trÃ­ bÃ¬nh thÆ°á»ng (block theo chiá»u dá»c vÃ  inline theo chiá»u ngang). Máº·c dÃ¹ nhá»¯ng trang nÃ y hoáº¡t Ä‘á»™ng tá»‘t, nhÆ°ng chÃºng thiáº¿u tÃ­nh linh hoáº¡t Ä‘á»ƒ há»— trá»£ cÃ¡c á»©ng dá»¥ng lá»›n hoáº·c phá»©c táº¡p (Ä‘áº·c biá»‡t liÃªn quan Ä‘áº¿n thay Ä‘á»•i hÆ°á»›ng, thay Ä‘á»•i kÃ­ch cá»¡, kÃ©o dÃ i, co láº¡i, etc.). ChÃº Ã½: Flexbox layout lÃ  thÃ­ch há»£p nháº¥t vá»›i cÃ¡c thÃ nh pháº§n cá»§a má»™t á»©ng dá»¥ng, vÃ  bá»‘ trÃ­ quy mÃ´ nhá», trong khi Ä‘Ã³ Grid layout lÃ  dÃ nh cho bá»‘ trÃ­ quy mÃ´ lá»›n hÆ¡n. KhÃ¡i niá»‡m cÆ¡ báº£n &amp; Thuáº­t ngá»¯Flexbox lÃ  má»™t module toÃ n bá»™ chá»© khÃ´ng pháº£i má»™t thuá»™c tÃ­nh duy nháº¥t, nÃ³ bao gá»“m ráº¥t nhiá»u thá»© ká»ƒ cáº£ cÃ¡c thuá»™c tÃ­nh. Má»™t sá»‘ trong chÃºng lÃ  Ä‘á»ƒ Ä‘Æ°á»£c Ä‘áº·t cho container (element cha, Ä‘Æ°á»£c gá»i lÃ  â€œflex containerâ€) trong khi nhá»¯ng thá»© khÃ¡c lÃ  Ä‘á»ƒ Ä‘Æ°á»£c Ä‘áº·t cho children (gá»i lÃ  â€œflex itemsâ€). Flex container lÃ  thÃ nh pháº§n lá»›n bao quanh chá»©a cÃ¡c pháº§n tá»­ (Flex items) bÃªn trong. Flex items lÃ  pháº§n tá»­ con náº±m trong thÃ nh pháº§n lá»›n bao quanh gá»i lÃ  nhá»¯ng Flex items, cÃ¡c báº¡n cÃ³ thá»ƒ sáº¯p xáº¿p thá»© tá»± cá»§a cÃ¡c Flex items nÃ y. Náº¿u cÃ¡ch bá»‘ trÃ­ thÃ´ng thÆ°á»ng dá»±a trÃªn luá»“ng block vÃ  inline, flex layout lÃ  dá»±a vÃ o â€œflex-flow directionsâ€. NhÃ¬n vÃ o nhá»¯ng thÃ´ng sá»‘ ká»¹ thuáº­t vÃ  giáº£i thÃ­ch Ã½ tÆ°á»Ÿng cá»§a flex layout á»Ÿ hÃ¬nh bÃªn dÆ°á»›i. Vá» cÆ¡ báº£n, nhá»¯ng items sáº½ Ä‘Æ°á»£c sáº¯p xáº¿p theo má»™t trong hai trá»¥c chÃ­nh (tá»« main-start Ä‘Ãªn main-end) hoáº·c trá»¥c dá»c (tá»« cross-start Ä‘áº¿n cross-end). main axis - The main axis of a flex container is the primary axis along which flex items are laid out. Beware, it is not necessarily horizontal; it depends on the flex-direction property (see below). main-start | main-end - The flex items are placed within the container starting from main-start and going to main-end. main size - A flex itemâ€™s width or height, whichever is in the main dimension, is the itemâ€™s main size. The flex itemâ€™s main size property is either the â€˜widthâ€™ or â€˜heightâ€™ property, whichever is in the main dimension. cross axis - The axis perpendicular to the main axis is called the cross axis. Its direction depends on the main axis direction. cross-start | cross-end - Flex lines are filled with items and placed into the container starting on the cross-start side of the flex container and going toward the cross-end side. cross size - The width or height of a flex item, whichever is in the cross dimension, is the itemâ€™s cross size. The cross size property is whichever of â€˜widthâ€™ or â€˜heightâ€™ that is in the cross dimension. Properties for the Parent (flex container) displayÄÃ¢y lÃ  Ä‘á»‹nh nghÄ©a má»™t flex container; inline hoáº·c block tÃ¹y thuá»™c vÃ o giÃ¡ trá»‹ nháº¥t Ä‘á»‹nh. NÃ³ cho phÃ©p má»™t flex context cho táº¥t cáº£ con trá»±c tiáº¿p cá»§a nÃ³. 123.container &#123; display: flex; /* or inline-flex */&#125; ChÃº Ã½ ráº±ng CSS columns khÃ´ng cÃ³ tÃ¡c dá»¥ng trong vÃ¹ng flex container. flex-direction Äá»‹nh nghÄ©a nÃ y cho trá»¥c chÃ­nh, do Ä‘Ã³ Ä‘á»‹nh nghÄ©a direction flex items Ä‘áº·t á»Ÿ trong flex container. Flexbox lÃ  má»™t khÃ¡i niá»‡m layout Ä‘Æ¡n hÆ°á»›ng. HÃ£y nghÄ© flex items lÃ  chá»§ yáº¿u Ä‘áº·t trong hÃ ng ngang hoáº·c cá»™t dá»c. 123.container &#123; flex-direction: row | row-reverse | column | column-reverse;&#125; row (default): tá»« trÃ¡i sang pháº£i trong ltr; tá»« pháº£i sang trÃ¡i rtl row-reverse: pháº£i sang trÃ¡i trong ltr; trÃ¡i sang pháº£i trong rtl column: giá»‘ng nhÆ° row nhÆ°ng tá»« trÃªn xuá»‘ng dÆ°á»›i column-reverse: giá»‘ng nhÆ° row-reverse nhÆ°ng tá»« trÃªn xuá»‘ng dÆ°á»›i flex-wrap Máº·c Ä‘á»‹nh, flex items sáº½ cá»‘ gáº¯ng Ä‘áº·t vÃ o 1 dÃ²ng. Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i Ä‘iá»u Ä‘Ã³ vÃ  nhá»¯ng items sáº½ wrap khi cÃ³ thuá»™c tÃ­nh nÃ y. 123.container&#123; flex-wrap: nowrap | wrap | wrap-reverse;&#125; nowrap (default): cÃ¡c flex items sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ trÃªn má»™t dÃ²ng wrap: cÃ¡c flex items sáº½ hiá»ƒn thá»‹ thÃ nh nhiá»u dÃ²ng, tá»« trÃªn xuá»‘ng dÆ°á»›i. wrap-reverse: cÃ¡c flex items sáº½ hiá»ƒn thá»‹ thÃ nh nhiá»u dÃ²ng tá»« dÆ°á»›i lÃªn trÃªn. CÃ³ má»™t vÃ i vÃ­ dá»¥ thá»±c táº¿ cá»§a flex-wrap á»Ÿ Ä‘Ã¢y. flex-flow (Ãp dá»¥ng cho: pháº§n tá»­ cha flex container)ÄÃ¢y lÃ  cÃ¡ch viáº¿t gá»n cá»§a thuá»™c tÃ­nh flex-direction vÃ  flex-wrap, chÃºng cÃ¹ng nhau Ä‘á»‹nh nghÄ©a flex containerâ€™s trá»¥c chÃ­nh hay trá»¥c dá»c. Máº·c Ä‘á»‹nh lÃ  row nowrap. 1flex-flow: &lt;â€˜flex-directionâ€™&gt; || &lt;â€˜flex-wrapâ€™&gt; justify-contentÄiá»u nÃ y xÃ¡c Ä‘á»‹nh sá»± sáº¯p xáº¿p theo trá»¥c chÃ­nh. It helps distribute extra free space left over when either all the flex items on a line are inflexible, or are flexible but have reached their maximum size. It also exerts some control over the alignment of items when they overflow the line. 123.container &#123; justify-content: flex-start | flex-end | center | space-between | space-around | space-evenly;&#125; flex-start (default): items are packed toward the start line flex-end: items are packed toward to end line center: items are centered along the line space-between: items are evenly distributed in the line; first item is on the start line, last item on the end line space-around: items are evenly distributed in the line with equal space around them. Note that visually the spaces arenâ€™t equal, since all the items have equal space on both sides. The first item will have one unit of space against the container edge, but two units of space between the next item because that next item has its own spacing that applies. space-evenly: items are distributed so that the spacing between any two items (and the space to the edges) is equal. align-itemsThis defines the default behaviour for how flex items are laid out along the cross axis on the current line. Think of it as the justify-content version for the cross-axis (perpendicular to the main-axis). 123.container &#123; align-items: flex-start | flex-end | center | baseline | stretch;&#125; flex-start: cross-start margin edge of the items is placed on the cross-start line flex-end: cross-end margin edge of the items is placed on the cross-end line center: items are centered in the cross-axis baseline: items are aligned such as their baselines align stretch (default): stretch to fill the container (still respect min-width/max-width) align-contentThis aligns a flex containerâ€™s lines within when there is extra space in the cross-axis, similar to how justify-content aligns individual items within the main-axis. Note: this property has no effect when there is only one line of flex items. 123.container &#123; align-content: flex-start | flex-end | center | space-between | space-around | stretch;&#125; flex-start: lines packed to the start of the container flex-end: lines packed to the end of the container center: lines packed to the center of the container space-between: lines evenly distributed; the first line is at the start of the container while the last one is at the end space-around: lines evenly distributed with equal space around each line stretch (default): lines stretch to take up the remaining space Thuá»™c tÃ­nh cá»§a Children (flex items) orderMáº·c Ä‘á»‹nh cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c sáº¯p xáº¿p theo giÃ¡ trá»‹ nguá»“n html, vá»›i thuá»™c tÃ­nh order chÃºng ta cÃ³ thá»ƒ xáº¯p xáº¿p láº¡i thá»© tá»± cÃ¡c pháº§n tá»­ theo Ã½ muá»‘n mÃ  ko cáº§n thay Ä‘á»•i giÃ¡ trá»‹ nguá»“n html. 123.item &#123; order: &lt;integer&gt;;&#125; flex-growThis defines the ability for a flex item to grow if necessary. It accepts a unitless value that serves as a proportion. It dictates what amount of the available space inside the flex container the item should take up. If all items have flex-grow set to 1, the remaining space in the container will be distributed equally to all children. If one of the children has a value of 2, the remaining space would take up twice as much space as the others (or it will try to, at least). 123.item &#123; flex-grow: &lt;number&gt;; /* default 0 */&#125; Sá»‘ Ã¢m khÃ´ng há»£p lá»‡ vá»›i thuá»™c tÃ­nh nÃ y. flex-shrinkÄá»‹nh nghÄ©a má»™t flex item cÃ³ thá»ƒ kháº£ nÄƒng thu nhá» náº¿u cáº§n thiáº¿t. 123.item &#123; flex-shrink: &lt;number&gt;; /* default 1 */&#125; Sá»‘ Ã¢m khÃ´ng há»£p lá»‡ vá»›i thuá»™c tÃ­nh nÃ y. flex-basisÄá»‹nh nghÄ©a kÃ­ch thÆ°á»›c máº·c Ä‘á»‹nh cá»§a má»™t pháº§n tá»­ trÆ°á»›c khi phÃ¢n bá»‘ khÃ´ng gian cá»§a pháº§n cÃ²n láº¡i. NÃ³ cÃ³ thá»ƒ lÃ  má»™t chiá»u dÃ i (e.g. 20%, 5rem, etc.) hay má»™t tá»« khÃ³a. Tá»« khÃ³a auto cÃ³ nghÄ©a lÃ  â€œnhÃ¬n vÃ o thuá»™c tÃ­nh width hoáº·c height cá»§a tÃ´iâ€ (which was temporarily done by the main-size keyword until deprecated). The content keyword means â€œsize it based on the itemâ€™s contentâ€ - this keyword isnâ€™t well supported yet, so itâ€™s hard to test and harder to know what its brethren max-content, min-content, and fit-content do. 123.item &#123; flex-basis: &lt;length&gt; | auto; /* default auto */&#125; If set to 0, the extra space around content isnâ€™t factored in. If set to auto, the extra space is distributed based on its flex-grow value. See this graphic. flexÄÃ¢y lÃ  viáº¿t táº¯t cho flex-grow, flex-shrink vÃ  flex-basis. CÃ¡c thÃ´ng sá»‘ thá»© hai vÃ  thá»© ba (flex-shrink vÃ  flex-basis) lÃ  tÃ¹y chá»n. Máº·c Ä‘á»‹nh lÃ  0 1 auto. 123.item &#123; flex: none | [ &lt;'flex-grow'&gt; &lt;'flex-shrink'&gt;? || &lt;'flex-basis'&gt; ]&#125; It is recommended that you use this shorthand property rather than set the individual properties. The short hand sets the other values intelligently. align-selfThis allows the default alignment (or the one specified by align-items) to be overridden for individual flex items. Please see the align-items explanation to understand the available values. 123.item &#123; align-self: auto | flex-start | flex-end | center | baseline | stretch;&#125; Note that float, clear and vertical-align have no effect on a flex item. ExamplesLetâ€™s start with a very very simple example, solving an almost daily problem: perfect centering. It couldnâ€™t be any simpler if you use flexbox. 12345678910.parent &#123; display: flex; height: 300px; /* Or whatever */&#125;.child &#123; width: 100px; /* Or whatever */ height: 100px; /* Or whatever */ margin: auto; /* Magic! */&#125; This relies on the fact a margin set to auto in a flex container absorb extra space. So setting a vertical margin of auto will make the item perfectly centered in both axis. Now letâ€™s use some more properties. Consider a list of 6 items, all with a fixed dimensions in a matter of aesthetics but they could be auto-sized. We want them to be evenly and nicely distributed on the horizontal axis so that when we resize the browser, everything is fine (without media queries!). 1234567891011121314.flex-container &#123; /* We first create a flex layout context */ display: flex; /* Then we define the flow direction and if we allow the items to wrap * Remember this is the same as: * flex-direction: row; * flex-wrap: wrap; */ flex-flow: row wrap; /* Then we define how is distributed the remaining space */ justify-content: space-around;&#125; Done. Everything else is just some styling concern. Below is a pen featuring this example. Be sure to go to CodePen and try resizing your windows to see what happens. See the Pen Demo Flexbox 1. Letâ€™s try something else. Imagine we have a right-aligned navigation on the very top of our website, but we want it to be centered on medium-sized screens and single-columned on small devices. Easy enough. 1234567891011121314151617181920212223/* Large */.navigation &#123; display: flex; flex-flow: row wrap; /* This aligns items to the end line on main-axis */ justify-content: flex-end;&#125;/* Medium screens */@media all and (max-width: 800px) &#123; .navigation &#123; /* When on medium sized screens, we center it by evenly distributing empty space around items */ justify-content: space-around; &#125;&#125;/* Small screens */@media all and (max-width: 500px) &#123; .navigation &#123; /* On small screens, we are no longer using row direction but column */ flex-direction: column; &#125;&#125; See the Pen Demo Flexbox 2. Letâ€™s try something even better by playing with flex items flexibility! What about a mobile-first 3-columns layout with full-width header and footer. And independent from source order. 12345678910111213141516171819202122232425262728293031323334353637.wrapper &#123; display: flex; flex-flow: row wrap;&#125;/* We tell all items to be 100% width */.header, .main, .nav, .aside, .footer &#123; flex: 1 100%;&#125;/* We rely on source order for mobile-first approach * in this case: * 1\\. header * 2\\. nav * 3\\. main * 4\\. aside * 5\\. footer *//* Medium screens */@media all and (min-width: 600px) &#123; /* We tell both sidebars to share a row */ .aside &#123; flex: 1 auto; &#125;&#125;/* Large screens */@media all and (min-width: 800px) &#123; /* We invert order of first sidebar and main * And tell the main element to take twice as much width as the other two sidebars */ .main &#123; flex: 2 0px; &#125; .aside-1 &#123; order: 1; &#125; .main &#123; order: 2; &#125; .aside-2 &#123; order: 3; &#125; .footer &#123; order: 4; &#125;&#125; See the Pen Demo Flexbox 3. Prefixing FlexboxFlexbox requires some vendor prefixing to support the most browsers possible. It doesnâ€™t just include prepending properties with the vendor prefix, but there are actually entirely different property and value names. This is because the Flexbox spec has changed over time, creating an â€œoldâ€, â€œtweenerâ€, and â€œnewâ€ versions. Perhaps the best way to handle this is to write in the new (and final) syntax and run your CSS through Autoprefixer, which handles the fallbacks very well. Alternatively, hereâ€™s a Sass @mixin to help with some of the prefixing, which also gives you an idea of what kind of things need to be done: 1234567891011121314151617181920212223242526272829303132@mixin flexbox() &#123; display: -webkit-box; display: -moz-box; display: -ms-flexbox; display: -webkit-flex; display: flex;&#125;@mixin flex($values) &#123; -webkit-box-flex: $values; -moz-box-flex: $values; -webkit-flex: $values; -ms-flex: $values; flex: $values;&#125;@mixin order($val) &#123; -webkit-box-ordinal-group: $val; -moz-box-ordinal-group: $val; -ms-flex-order: $val; -webkit-order: $val; order: $val;&#125;.wrapper &#123; @include flexbox();&#125;.item &#123; @include flex(1 200px); @include order(2);&#125; Related Properties A Complete Guide to Grid Almanac entries on Grid properties, like grid-row / grid-column BugsFlexbox is certainly not without its bugs. The best collection of them Iâ€™ve seen is Philip Walton and Greg Whitworthâ€™s Flexbugs. Itâ€™s an open source place to track all of them, so I think itâ€™s best to just link to that.","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"flexbox","slug":"flexbox","permalink":"http://nthung2112.github.io/tags/flexbox/"}]},{"title":"CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a Flexbox - Giáº£i thÃ­ch vá»›i áº£nh gif Ä‘áº§y mÃ u sáº¯c","slug":"Cach-thuc-hoat-dong-cua-Flexbox","date":"2017-08-31T02:45:26.000Z","updated":"2017-08-31T15:55:28.617Z","comments":true,"path":"2017/08/Cach-thuc-hoat-dong-cua-Flexbox.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Cach-thuc-hoat-dong-cua-Flexbox.html","excerpt":"Flexbox há»©a háº¹n sáº½ giáº£i quyáº¿t nhiá»u váº¥n Ä‘á» hiá»‡n Ä‘ang tá»“n táº¡i trong CSS thuáº§n (vÃ­ dá»¥ nhÆ° cÄƒn chá»‰nh chiá»u dá»c). NhÆ°ng Ä‘á»ƒ cÃ³ thá»ƒ lÃ m chá»§ vÃ  sá»­ dá»¥ng Ä‘Æ°á»£c flexbox thÃ¬ láº¡i lÃ  viá»‡c khÃ´ng há» dá»… dÃ ng. NguyÃªn táº¯c cÆ¡ báº£n cá»§a Flexbox lÃ  lÃ m cho viá»‡c dÃ n trang linh hoáº¡t vÃ  trá»±c quan hÆ¡n. Äá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c Ä‘iá»u nÃ y, cÃ¡c thÃ nh pháº§n bao ngoÃ i (containers) Ä‘Æ°á»£c tá»± quyáº¿t Ä‘á»‹nh cÃ¡ch phÃ¢n bá»‘ cÃ¡c pháº§n tá»­ con (items) â€“ bao gá»“m cáº£ kÃ­ch thÆ°á»›c vÃ  khoáº£ng cÃ¡ch giá»¯a chÃºng. Äiá»u nÃ y vá» nguyÃªn táº¯c nghe cÃ³ váº» tá»‘t. NhÆ°ng chÃºng ta hÃ£y xem nÃ³ cÃ³ váº» nhÆ° trong thá»±c táº¿.","text":"Flexbox há»©a háº¹n sáº½ giáº£i quyáº¿t nhiá»u váº¥n Ä‘á» hiá»‡n Ä‘ang tá»“n táº¡i trong CSS thuáº§n (vÃ­ dá»¥ nhÆ° cÄƒn chá»‰nh chiá»u dá»c). NhÆ°ng Ä‘á»ƒ cÃ³ thá»ƒ lÃ m chá»§ vÃ  sá»­ dá»¥ng Ä‘Æ°á»£c flexbox thÃ¬ láº¡i lÃ  viá»‡c khÃ´ng há» dá»… dÃ ng. NguyÃªn táº¯c cÆ¡ báº£n cá»§a Flexbox lÃ  lÃ m cho viá»‡c dÃ n trang linh hoáº¡t vÃ  trá»±c quan hÆ¡n. Äá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c Ä‘iá»u nÃ y, cÃ¡c thÃ nh pháº§n bao ngoÃ i (containers) Ä‘Æ°á»£c tá»± quyáº¿t Ä‘á»‹nh cÃ¡ch phÃ¢n bá»‘ cÃ¡c pháº§n tá»­ con (items) â€“ bao gá»“m cáº£ kÃ­ch thÆ°á»›c vÃ  khoáº£ng cÃ¡ch giá»¯a chÃºng. Äiá»u nÃ y vá» nguyÃªn táº¯c nghe cÃ³ váº» tá»‘t. NhÆ°ng chÃºng ta hÃ£y xem nÃ³ cÃ³ váº» nhÆ° trong thá»±c táº¿.Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ nghiÃªn cá»©u 5 thuá»™c tÃ­nh ná»•i trá»™i nháº¥t cá»§a Flexbox, khÃ¡m phÃ¡ chá»©c nÄƒng cÅ©ng nhÆ° cÃ¡ch sá»­ dá»¥ng chÃºng vÃ  káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c. Thuá»™c tÃ­nh #1: Display: FlexHÃ£y xem vÃ­ dá»¥ trang web dÆ°á»›i Ä‘Ã¢y: CÃ³ 4 tháº» divs kÃ­ch cá»¡ khÃ¡ch nhau Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u vá»›i cÃ¡c mÃ u khÃ¡c nhau Ä‘áº·t trong tháº» div container mÃ u xÃ¡m. Máº·c Ä‘á»‹nh má»—i tháº» div sáº½ cÃ³ thuá»™c tÃ­nh lÃ  display: block. Má»—i Ã´ vuÃ´ng vÃ¬ váº­y sáº½ chiáº¿m háº¿t bá» ngang cá»§a má»—i dÃ²ng. Äá»ƒ báº¯t Ä‘áº§u vá»›i Flexbox, báº¡n cáº§n Ä‘Æ°a container cá»§a báº¡n vá» dáº¡ng cá»§a flex container nhÆ° sau: 123#container &#123; display: flex;&#125; ChÆ°a cÃ³ thay Ä‘á»•i gÃ¬ ngoÃ i viá»‡c cÃ¡c tháº» div hiá»ƒn thá»‹ trÃªn cÃ¹ng má»™t dÃ²ng. Tuy nhiÃªn Ä‘Ã¢y láº¡i lÃ  má»™t sá»± thay Ä‘á»•i ráº¥t Ä‘Ã¡ng ká»ƒ. ChÃºng ta Ä‘áº·t tÃªn cho vÃ¹ng xung quanh Ä‘Ã³ gá»i lÃ  flex context. BÃ¢y giá» báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u Ä‘á»‹nh vá»‹ trÃ­ cho chÃºng mÃ  khÃ´ng gáº·p nhiá»u khÃ³ khÄƒn nhÆ° khi sá»­ dá»¥ng CSS thÃ´ng thÆ°á»ng Thuá»™c tÃ­nh #2: Flex DirectionMá»™t Flexbox container cÃ³ hai trá»¥c: má»™t trá»¥c chÃ­nh vÃ  má»™t trá»¥c dá»c, máº·c Ä‘á»‹nh hiá»ƒn thá»‹ nhÆ° dÆ°á»›i Ä‘Ã¢y: Máº·c Ä‘á»‹nh, cÃ¡c items Ä‘Æ°á»£c sáº¯p xáº¿p theo hÆ°á»›ng cá»§a trá»¥c chÃ­nh, tá»« trÃ¡i qua pháº£i. ÄÃ¢y lÃ  lÃ­ do táº¡i sao cÃ¡c Ã´ vuÃ´ng hiá»ƒn thá»‹ trÃªn cÃ¹ng má»™t dÃ²ng khi báº¡n sá»­ dá»¥ng display: flex. Tuy nhiÃªn, báº¡n cÃ³ thá»ƒ thay Ä‘á»•i trá»¥c chÃ­nh báº±ng thuá»™c tÃ­nh Flex-direction. 1234#container &#123; display: flex; flex-direction: column;&#125; CÃ³ má»™t sá»± khÃ¡c biá»‡t quan trá»ng táº¡o ra á»Ÿ Ä‘Ã¢y: flex-direction: column khÃ´ng sáº¯p xáº¿p cÃ¡c Ã´ vuÃ´ng trÃªn trá»¥c dá»c (across axis) thay vÃ¬ trá»¥c chÃ­nh (main axis). NÃ³ lÃ m trá»¥c chÃ­nh thay Ä‘á»•i, xoay tá»« ngang thÃ nh dá»c. Báº¡n cÃ³ thá»ƒ sáº¯p xáº¿p flex-direction theo má»™t sá»‘ cÃ¡ch khÃ¡c nhÆ°: row-reverse and column-reverse. Thuá»™c tÃ­nh #3: Justify ContentJustify-content sáº¯p xáº¿p cÃ¡c items theo theo main axis. ChÃºng ta sáº½ nghiÃªn cá»©u chi tiáº¿t hÆ¡n vá» sá»± khÃ¡c nhau giá»¯a trá»¥c chÃ­nh vÃ  trá»¥c dá»c. TrÆ°á»›c háº¿t, hÃ£y quay láº¡i vá»›i flex-direction: row. 12345#container &#123; display: flex; flex-direction: row; justify-content: flex-start;&#125; Báº¡n cÃ³ nÄƒm thuá»™c tÃ­nh Ä‘á»ƒ sá»­ dá»¥ng vá»›i justify-content: Flex-start Flex-end Center Space-between Space-around Sá»± khÃ¡c nhau giá»¯a space-around vÃ  space-between hÆ¡i khÃ³ Ä‘á»ƒ nháº­n ra. Vá»›i space-between, cÃ¡c Ã´ vuÃ´ng sáº½ Ä‘Æ°á»£c cÄƒn cÃ¡ch Ä‘á»u nhau, khÃ´ng bao gá»“m khoáº£ng cÃ¡ch giá»¯a Ã´ vuÃ´ng Ä‘áº§u vÃ  cuá»‘i vá»›i container Space-around Ä‘áº·t má»™t khoáº£ng cÃ¡ch á»Ÿ hai bÃªn cáº¡nh má»—i Ã´ vuÃ´ng â€” cÃ³ nghÄ©a lÃ  khoáº£ng cÃ¡ch giá»¯a Ã´ vuÃ´ng ngoÃ i cÃ¹ng phÃ­a Ä‘áº§u vÃ  cuá»‘i vá»›i container sáº½ báº±ng má»™t ná»­a khoáº£ng cÃ¡ch giá»¯a cÃ¡c Ã´ vuÃ´ng vá»›i nhau (Giáº£ sá»­ má»—i Ã´ vuÃ´ng Ä‘á»u cÃ³ má»™t giÃ¡ trá»‹ cÄƒn lá» báº±ng nhau vÃ  khÃ´ng bá»‹ ghi Ä‘Ã¨, vÃ¬ váº­y khoáº£ng cÃ¡ch giá»¯a 2 Ã´ vuÃ´ng sáº½ gáº¥p Ä‘Ã´i). ChÃº Ã½: HÃ£y nhá»› ráº±ng thuá»™c tÃ­nh justify-content hoáº¡t Ä‘á»™ng theo trá»¥c chÃ­nh, vÃ  flex-direction lÃ m thay Ä‘á»•i trá»¥c chÃ­nh. ÄÃ¢y lÃ  Ä‘iá»u quan trá»ng nháº¥t Ä‘á»ƒ báº¡n chuyá»ƒn sang pháº§n tiáº¿p theoâ€¦ Thuá»™c tÃ­nh #4: Align ItemsNáº¿u nhÆ° báº¡n Ä‘Ã£ náº¯m Ä‘Æ°á»£c thuá»™c tÃ­nh justify-content, align-items sáº½ khÃ´ng khÃ³ khÄƒn. Trong khi justify-content hoáº¡t Ä‘á»™ng theo trá»¥c chÃ­nh, align-items Ã¡p dá»¥ng Ä‘á»‘i vá»›i trá»¥c dá»c. HÃ£y thiáº¿t láº­p láº¡i flex-direction thÃ nh row, Ä‘á»ƒ hai trá»¥c hiá»ƒn thá»‹ nhÆ° hÃ¬nh trÃªn. Sau Ä‘Ã³, báº¯t Ä‘áº§u Ä‘i sÃ¢u vÃ o giÃ¡ trá»‹ cá»§a align-items. flex-start flex-end center stretch baseline Ba giÃ¡ trá»‹ Ä‘áº§u tiÃªn chÃ­nh xÃ¡c lÃ  giá»‘ng nhÆ° justify-content, vÃ¬ váº­y khÃ´ng cÃ³ gÃ¬ quÃ¡ láº¡ á»Ÿ Ä‘Ã¢y. Tuy nhiÃªn, hai giÃ¡ trá»‹ káº¿ tiáº¿p cÃ³ má»™t chÃºt khÃ¡c biá»‡t. Vá»›i giÃ¡ trá»‹ stretch, cÃ¡c items sáº½ chiáº¿m toÃ n bá»™ trá»¥c chÃ­nh, vÃ  baseline, Ä‘Ã¡y cá»§a nhá»¯ng tags paragraph sáº½ Ä‘Æ°á»£c canh Ä‘á»u. (ChÃº Ã½ vá»›i align-items: stretch, TÃ´i Ä‘Ã£ pháº£i Ä‘áº·t chiá»u cao cá»§a Ã´ vuÃ´ng lÃ  auto. Náº¿u khÃ´ng, thuá»™c tÃ­nh chiá»u cao sáº½ ghi Ä‘Ã¨ lÃªn stretch.) Vá»›i baseline, hÃ£y lÆ°u Ã½ ráº±ng náº¿u báº¡n bá» Ä‘i tags paragraph, cÃ¡c Ã´ vuÃ´ng sáº½ Ä‘Æ°á»£c cÄƒn lá» dÆ°á»›i nhÆ° hÃ¬nh sau: Äá»ƒ minh há»a rÃµ hÆ¡n cho trá»¥c chÃ­nh vÃ  trá»¥c dá»c vá»›i nÃ³, hÃ£y káº¿t há»£p thuá»™c tÃ­nh justify-content vÃ  align-items vÃ  xem sá»± khÃ¡c biá»‡t giá»¯a 2 giÃ¡ trá»‹ center cá»§a thuá»™c tÃ­nh flex-direction: Vá»›i dÃ²ng, cÃ¡c Ã´ vuÃ´ng Ä‘Æ°á»£c thiáº¿t láº­p dá»c theo má»™t trá»¥c chÃ­nh ngang. Vá»›i cá»™t, chÃºng xáº¿p dá»c theo trá»¥c chÃ­nh tháº³ng Ä‘á»©ng. CÃ¡c Ã´ vuÃ´ng Ä‘Æ°á»£c cÄƒn giá»¯a cáº£ theo trá»¥c ngang vÃ  dá»c trong 2 trÆ°á»ng há»£p, cáº£ 2 trÆ°á»ng há»£p Ä‘á»u ko thay Ä‘á»•i! Thuá»™c tÃ­nh #5: Align SelfAlign-self cho phÃ©p báº¡n thao tÃ¡c thá»§ cÃ´ng liÃªn káº¿t cá»§a má»™t pháº§n tá»­ riÃªng biá»‡t. NÃ³ sáº½ Ä‘Ã¨ lÃªn thuá»™c tÃ­nh align-items cá»§a 1 Ã´ vuÃ´ng. Táº¥t cáº£ thuá»™c tÃ­nh Ä‘á»u nhÆ° nhau, bá»Ÿi vÃ¬ máº·c Ä‘á»‹nh nÃ³ lÃ  auto, nÃªn cÃ¡c Ã´ vuÃ´ng sáº½ theo thuá»™c tÃ­nh align-items cá»§a container bao nÃ³. 1234567#container &#123; align-items: flex-start;&#125;.square#one &#123; align-self: center;&#125;// Only this square will be centered. HÃ£y xem káº¿t quáº£. Báº¡n sáº½ Ä‘áº·t thuá»™c tÃ­nh align-self cho 2 Ã´ vuÃ´ng, vÃ  thuá»™c tÃ­nh align-items: center vÃ  flex-direction: row vá»›i cÃ¡c Ã´ vuÃ´ng cÃ²n láº¡i. ConclusionMáº·c dÃ¹ chá»‰ lÃ  nhá»¯ng tÃ¬m hiá»ƒu cÆ¡ báº£n vá» Flexbox, tÃ´i tin nhá»¯ng Ä‘iá»u nÃ y cÅ©ng cung cáº¥p cho báº¡n nhá»¯ng kiáº¿n thá»©c Ä‘á»ƒ dÃ n trang má»™t cÃ¡ch cÆ¡ báº£n nháº¥t cÅ©ng nhÆ° sáº¯p xáº¿p ná»™i dung chÃ­nh bÃ i viáº¿t cá»§a báº¡n. Cáº£m Æ¡n vÃ¬ Ä‘Ã£ Ä‘á»c!","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"flexbox","slug":"flexbox","permalink":"http://nthung2112.github.io/tags/flexbox/"}]},{"title":"Trá»Ÿ thÃ nh Functional Programmer - Pháº§n 6","slug":"Tro-thanh-Functional-Programmer-Phan-6","date":"2017-08-23T16:30:13.000Z","updated":"2017-08-23T16:30:49.096Z","comments":true,"path":"2017/08/Tro-thanh-Functional-Programmer-Phan-6.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Tro-thanh-Functional-Programmer-Phan-6.html","excerpt":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP.","text":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP. BÆ°á»›c tiáº¿p theo ThÃ´ng qua 5 pháº§n trÆ°á»›c, tÃ´i Ä‘Ã£ giá»›i thiá»‡u Ä‘áº¿n cÃ¡c báº¡n táº¥t cáº£ cÃ¡c concepts tuyá»‡t vá»i mÃ  FP mang láº¡i, nhÆ°ng Ä‘á»“ng thá»i cÅ©ng dáº¥y lÃªn trong cÃ¡c báº¡n cÃ¢u há»i : â€œGiá» thÃ¬ sao? Liá»‡u nhá»¯ng kiáº¿n thá»©c Ä‘Ã³ cÃ³ thá»ƒ cÃ³ Ã­ch gÃ¬ cho tÃ´i trong cÃ´ng viá»‡c hÃ ng ngÃ y chá»©?â€ CÃ¢u tráº£ lá»i sáº½ lÃ  tÃ¹y theo tá»«ng ngÆ°á»i. Náº¿u báº¡n cÃ³ thá»ƒ/Ä‘ang lÃ m viá»‡c vá»›i cÃ¡c ngÃ´n ngá»¯ Pure Functional Language nhÆ° lÃ  Elm hay Haskell, thÃ¬ báº¡n cÃ³ thá»ƒ táº­n dá»¥ng toÃ n bá»™ nhá»¯ng kiáº¿n thá»©c Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n, Ä‘á»“ng thá»i cÃ¡c ngÃ´n ngá»¯ Ä‘Ã³ sáº½ há»— trá»£ báº¡n trong viá»‡c váº­n dá»¥ng chÃºng má»™t cÃ¡ch thuáº­n tiá»‡n nháº¥t. CÃ²n náº¿u báº¡n váº«n Ä‘ang tiáº¿p tá»¥c sá»­ dá»¥ng cÃ¡c ngÃ´n ngá»¯ Imperative nhÆ° Javascript - giá»‘ng nhÆ° háº§u háº¿t cÃ¡c láº­p trÃ¬nh viÃªn hiá»‡n nay, thÃ¬ báº¡n váº«n cÃ³ thá»ƒ váº­n dá»¥ng nhá»¯ng concepts Ä‘Ã£ há»c Ä‘Æ°á»£c, nhÆ°ng sáº½ cáº§n má»™t vÃ i tÃ¹y chá»‰nh vÃ  nguyÃªn táº¯c cáº§n tuÃ¢n thá»§. Functional Javascript - Code JS theo hÆ°á»›ng Functional Javascript cÃ³ thá»ƒ thá»±c hiá»‡n ráº¥t nhiá»u concepts cá»§a FP. Máº·c dÃ¹ nÃ³ khÃ´ng thuáº§n khiáº¿t (pure) cho láº¯m, nhÆ°ng JS váº«n cÃ³ lá»±a chá»n Ä‘á»ƒ sá»­ dá»¥ng kháº£ nÄƒng immutability (tÃ­nh báº¥t biáº¿n) hoáº·c náº¿u sá»­ dá»¥ng cÃ¡c thÆ° viá»‡n Ä‘Ã£ cÃ³, thÃ¬ viá»‡c há»— trá»£ FP concepts cÃ²n máº¡nh máº½ hÆ¡n. Máº·c dÃ¹ Ã¡p dá»¥ng FP vÃ o JS khÃ´ng hoÃ n toÃ n lÃ½ tÆ°á»Ÿng, nhÆ°ng náº¿u báº¡n cÃ³ thá»ƒ táº­n dá»¥ng má»™t vÃ i lá»£i Ã­ch tá»« FP thÃ¬ táº¡i sao khÃ´ng thá»­ nhá»‰? Immutability - TÃ­nh báº¥t biáº¿nÄiá»u Ä‘áº§u tiÃªn mÃ  ta cÃ³ thá»ƒ xem xÃ©t Ã¡p dá»¥ng lÃ  tÃ­nh báº¥t biáº¿n. Trong phiÃªn báº£n ES2015 - hay cÃ²n gá»i lÃ  ES6, cÃ³ má»™t tá»« khÃ³a má»›i Ä‘Ã£ Ä‘Æ°á»£c giá»›i thiá»‡u cÃ³ tÃªn lÃ  const. VÃ  Ä‘Ãºng nhÆ° tÃªn gá»i cá»§a tá»« khÃ³a nÃ y, nÃ³ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ khai bÃ¡o má»™t biáº¿n mÃ  giÃ¡ trá»‹ khÃ´ng thá»ƒ gÃ¡n láº¡i Ä‘Æ°á»£c : 123const a = 1;a = 2; // sáº½ cÃ³ exception cÃ³ tÃªn lÃ  TypeError trong Chrome, Firefox hoáº·c Node // nhÆ°ng khÃ´ng cÃ³ náº¿u dÃ¹ng Safari (báº£n 10/2016) á» Ä‘Ã¢y biáº¿n a Ä‘Æ°á»£c khai bÃ¡o lÃ  má»™t háº±ng sá»‘ (const) nÃªn nÃ³ sáº½ khÃ´ng thá»ƒ Ä‘Æ°á»£c set láº¡i giÃ¡ trá»‹ ná»¯a. VÃ¬ tháº¿ mÃ  Ä‘oáº¡n code a = 2 sáº½ sinh ra Exception (ngoáº¡i trá»« Safari). Tuy nhiÃªn, cÃ³ má»™t váº¥n Ä‘á» vá»›i const, Ä‘Ã³ lÃ  nÃ³ váº«n chÆ°a hoÃ n toÃ n implement tÃ­nh báº¥t biáº¿n má»™t cÃ¡ch Ä‘áº§y Ä‘á»§. Äoáº¡n code dÆ°á»›i Ä‘Ã¢y sáº½ thá»ƒ hiá»‡n háº¡n cháº¿ nÃ y: 123456const a = &#123; x: 1, y: 2&#125;;a.x = 2; // KHÃ”NG CÃ“ EXCEPTION!a = &#123;&#125;; // cÃ³ exception TypeError Báº¡n sáº½ tháº¥y ráº±ng khi set a.x = 2 thÃ¬ sáº½ khÃ´ng gÃ¢y ra lá»—i. Thá»© duy nháº¥t mÃ  tá»« khÃ³a const Ã¡p dá»¥ng Ä‘á»ƒ kiá»ƒm tra tÃ­nh báº¥t biáº¿n chá»‰ lÃ  biáº¿n a. CÃ²n táº¥t cáº£ nhá»¯ng thÃ nh pháº§n mÃ  a cÃ³ thá»ƒ liÃªn káº¿t Ä‘áº¿n thÃ¬ váº«n cÃ³ thá»ƒ thay Ä‘á»•i Ä‘Æ°á»£c (á» Ä‘Ã¢y sáº½ hiá»ƒu lÃ  keyword const chá»‰ check a cÃ³ lÃ  object váº«n táº¡o ra tá»« Ä‘áº§u hay khÃ´ng, mÃ  khÃ´ng check Ä‘Æ°á»£c cÃ¡c thuá»™c tÃ­nh cá»§a a bá»‹ thay Ä‘á»•i). TÃ´i tháº¥y khÃ¡ lÃ  tháº¥t vá»ng khi nháº­n ra Ä‘iá»u nÃ y, vÃ¬ náº¿u Ä‘Æ°á»£c implement má»™t cÃ¡ch hoÃ n háº£o, JS Ä‘Ã£ cÃ³ thá»ƒ trá»Ÿ nÃªn tá»‘t hÆ¡n ráº¥t nhiá»u. Váº­y liá»‡u cÃ³ cÃ¡ch nÃ o Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng tÃ­nh báº¥t biáº¿n vÃ o JS má»™t cÃ¡ch toÃ n diá»‡n nháº¥t khÃ´ng? CÃ¢u tráº£ lá»i lÃ  CÃ³ thá»ƒ, nhÆ°ng chÃºng ta pháº£i sá»­ dá»¥ng má»™t thÆ° viá»‡n cÃ³ tÃªn lÃ  Immutable. ThÆ° viá»‡n nÃ y sáº½ há»— trá»£ tÃ­nh báº¥t biáº¿n tá»‘t hÆ¡n so vá»›i const nhÆ°ng láº¡i khiáº¿n code cá»§a chÃºng ta giá»‘ng Java hÆ¡n lÃ  Javascript. Currying vÃ  Compositioná» cÃ¡c series trÆ°á»›c Ä‘Ã³, chÃºng ta Ä‘Ã£ há»c Ä‘Æ°á»£c cÃ¡ch viáº¿t hÃ m há»— trá»£ kháº£ nÄƒng Currying. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ phá»©c táº¡p hÆ¡n: 1const f = a =&gt; b =&gt; c =&gt; d =&gt; a + b + c + d Äá»ƒ Ã½ ráº±ng phiá»n toÃ¡i Ä‘áº§u tiÃªn lÃ  chÃºng ta pháº£i chá»‰ rÃµ pháº§n currying (a =&gt; b =&gt; c =&gt; d) VÃ  náº¿u pháº£i gá»i hÃ m f, thÃ¬ má»i thá»© sáº½ cÃ²n phá»©c táº¡p hÆ¡n 1console.log(f(1)(2)(3)(4)); // prints 10 QuÃ¡ nhiá»u dáº¥u ngoáº·c Ä‘Æ¡n nhÆ° trÃªn lÃ  Ä‘á»§ Ä‘á»ƒ khiáº¿n láº­p trÃ¬nh Lisp pháº£i khÃ³c rÃ²ng rá»“i (Lisp dÃ¹ng nhiá»u dáº¥u ngoáº·c Ä‘Æ¡n, nÃªn náº¿u láº­p trÃ¬nh viÃªn Lisp cÃ²n pháº£i khÃ³c trÆ°á»›c sá»‘ lÆ°á»£ng dáº¥u ngoáº·c Ä‘Æ¡n nhÆ° nÃ y thÃ¬ Ä‘á»§ tháº¥y sá»± kinh khá»§ng cá»§a dÃ²ng code trÃªn lÃ  nhÆ° nÃ o :D) VÃ  vÃ¬ tháº¿ cÃ³ ráº¥t nhiá»u thÆ° viá»‡n Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y. VÃ  thÆ° viá»‡n mÃ  tÃ´i thÃ­ch nháº¥t cÃ³ tÃªn lÃ  Ramda Khi dÃ¹ng Ramda thÃ¬ chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i Ä‘oáº¡n code trÃªn nhÆ° sau: 1234const f = R.curry((a, b, c, d) =&gt; a + b + c + d);console.log(f(1, 2, 3, 4)); // prints 10console.log(f(1, 2)(3, 4)); // also prints 10console.log(f(1)(2)(3, 4)); // also prints 10 Pháº§n Ä‘á»‹nh nghÄ©a hÃ m khÃ´ng Ä‘Æ°á»£c cáº£i thiá»‡n nhÆ°ng láº¯m, nhÆ°ng chÃºng ta Ä‘Ã£ loáº¡i bá» Ä‘Æ°á»£c viá»‡c yÃªu cáº§u pháº£i viáº¿t dáº¥u ngoáº·c Ä‘Æ¡n á»Ÿ pháº§n gá»i hÃ m phÃ­a sau. Äá»“ng thá»i má»—i láº§n gá»i hÃ m â€˜fâ€™, chÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng Ä‘Ãºng hoáº·c Ã­t hÆ¡n sá»‘ lÆ°á»£ng tham sá»‘ náº¿u muá»‘n. DÆ°á»›i Ä‘Ã¢y sáº½ lÃ  code viáº¿t láº¡i hÃ m mult5AfterAdd10 (á»Ÿ Pháº§n 4) sá»­ dá»¥ng Ramda: 123const add = R.curry((x, y) =&gt; x + y);const mult5 = value =&gt; value * 5;const mult5AfterAdd10 = R.compose(mult5, add(10)); NgoÃ i kháº£ nÄƒng trÃªn, Ramda cÃ²n cÃ³ má»™t sá»‘ hÃ m Ä‘Ã£ Ä‘Æ°á»£c viáº¿t sáºµn Ä‘á»ƒ há»— trá»£ viá»‡c viáº¿t cÃ¡c hÃ m theo phong cÃ¡ch Currying, vÃ­ dá»¥ nhÆ° lÃ  R.add hoáº·c R.multiply, giÃºp chÃºng ta Ä‘á»¡ pháº£i viáº¿t nhiá»u code hÆ¡n: 1const mult5AfterAdd10 = R.compose(R.multiply(5), R.add(10)); CÃ¡c hÃ m Map, Reduce, Filter trong JSMá»™t kháº£ nÄƒng ná»¯a cá»§a thÆ° viá»‡n Ramda lÃ  viá»‡c cung cáº¥p sáºµn cÃ¡c hÃ m map, filter, reduce. Máº·c dÃ¹ cÃ¡c hÃ m nÃ y Ä‘Ã£ cÃ³ trong Array.prototype cá»§a JS core, nhÆ°ng cÃ¡c hÃ m nÃ y cá»§a Ramda cao cáº¥p hÆ¡n á»Ÿ chá»— chÃºng lÃ  cÃ¡c curried function. 12345678const isOdd = R.flip(R.modulo)(2);const onlyOdd = R.filter(isOdd);const isEven = R.complement(isOdd);const onlyEven = R.filter(isEven);const numbers = [1, 2, 3, 4, 5, 6, 7, 8];console.log(onlyEven(numbers)); // prints [2, 4, 6, 8]console.log(onlyOdd(numbers)); // prints [1, 3, 5, 7] HÃ m R.modulo yÃªu cáº§u 2 tham sá»‘, Ä‘áº§u tiÃªn lÃ  dividend (sá»‘ bá»‹ chia), tiáº¿p theo lÃ  divisor (sá»‘ chia). Biáº¿n isOdd sáº½ lÃ  hÃ m Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ láº¥y ra pháº§n dÆ° cá»§a viá»‡c láº¥y sá»‘ bá»‹ chia chia cho 2. Náº¿u pháº§n dÆ° lÃ  0 sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i giÃ¡ trá»‹ false, thá»ƒ hiá»‡n sá»‘ bá»‹ chia khÃ´ng pháº£i lÃ  sá»‘ láº», cÃ²n náº¿u pháº§n dÆ° lÃ  1 thÃ¬ sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i giÃ¡ trá»‹ true, thá»ƒ hiá»‡n sá»‘ bá»‹ chia lÃ  sá»‘ láº». HÃ m R.flip Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ Ä‘á»•i vá»‹ trÃ­ giá»¯a 2 tham sá»‘ cá»§a hÃ m R.modulo, khiáº¿n giÃ¡ trá»‹ tham sá»‘ truyá»n vÃ o lÃºc Ä‘áº§u sáº½ lÃ  sá»‘ chia (á»Ÿ Ä‘Ã¢y lÃ  2).(káº¿t quáº£ cuá»‘i cÃ¹ng khi gá»i isOdd vá»›i 1 tham sá»‘ sáº½ tráº£ vá» káº¿t quáº£ lÃ  tham sá»‘ Ä‘Ã³ cÃ³ pháº£i lÃ  sá»‘ cháºµn hay khÃ´ng. VD isOdd(4) = false hay isOdd(5) = true). VÃ  hÃ m isEven sáº½ lÃ  pháº§n bÃ¹ cá»§a hÃ m isOdd (tá»©c lÃ  giÃ¡ trá»‹ tráº£ vá» cá»§a isEven sáº½ ngÆ°á»£c vá»›i isOdd nÃªn ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m R.complement) Tiáº¿p theo, hÃ m onlyOdd lÃ  káº¿t quáº£ cá»§a hÃ m filter vá»›i hÃ m dÃ¹ng Ä‘á»ƒ lá»c dá»¯ liá»‡u lÃ  isOdd, vÃ  hÃ m nÃ y sáº½ cáº§n tham sá»‘ lÃ  má»™t máº£ng cÃ¡c sá»‘ nguyÃªn Ä‘á»ƒ thá»±c hiá»‡n. TÆ°Æ¡ng tá»± vá»›i hÃ m onlyEven, chá»‰ khÃ¡c lÃ  hÃ m nÃ y dÃ¹ng isEven lÃ  hÃ m Ä‘á»ƒ lá»c dá»¯ liá»‡u. Khi chÃºng ta truyá»n má»™t máº£ng vÃ o tham sá»‘ numbers tá»›i hÃ m onlyOdd hoáº·c onlyEven, hÃ m isOdd vÃ  isEven sáº½ nháº­n tham sá»‘ lÃ  tá»«ng pháº§n tá»­ trong máº£ng vÃ  thá»±c hiá»‡n tráº£ vá» káº¿t quáº£ 0 hoáº·c 1, tÆ°Æ¡ng á»©ng vá»›i true vÃ  false, vÃ  tá»« Ä‘Ã³ hÃ m onlyOdd hoáº·c onlyEven sáº½ giá»¯ láº¡i cÃ¡c giÃ¡ trá»‹ mong muá»‘n (chá»‰ sá»‘ láº» hoáº·c sá»‘ cháºµn). Nhá»¯ng thiáº¿u sÃ³t cá»§a Javascript Vá»›i táº¥t cáº£ nhá»¯ng thÆ° viá»‡n vÃ  nhá»¯ng tÃ­nh nÄƒng Ä‘Æ°á»£c chÃ­nh JS há»— trá»£, chÃºng ta cÃ³ thá»ƒ cÃ³ nhá»¯ng bÆ°á»›c tiáº¿n nháº¥t Ä‘á»‹nh trong viá»‡c Ã¡p dá»¥ng FP vÃ o JS. Tuy nhiÃªn, cÃ³ má»™t sá»± tháº­t khÃ´ng thá»ƒ chá»‘i cÃ£i ráº±ng JS váº«n chá»‰ lÃ  má»™t Imperative Language Ä‘ang cá»‘ Ä‘á»ƒ thá»a mÃ£n táº¥t cáº£ má»i ngÆ°á»i. Ráº¥t nhiá»u láº­p trÃ¬nh viÃªn frontend Ä‘ang máº¯c káº¹t vá»›i JS bá»Ÿi láº½ Ä‘áº¿n thá»i Ä‘iá»ƒm hiá»‡n táº¡i, Ä‘Ã³ háº§u nhÆ° lÃ  lá»±a chá»n duy nháº¥t vÃ  khÃ´ng thá»ƒ trÃ¡nh khá»i. NhÆ°ng xu hÆ°á»›ng hiá»‡n nay thÃ¬ ráº¥t nhiá»u láº­p trÃ¬nh viÃªn JS Ä‘ang viáº¿t code JS má»™t cÃ¡ch khÃ´ng trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³, há» viáº¿t má»™t ngÃ´n ngá»¯ khÃ¡c vÃ  biÃªn dá»‹ch, hay nÃ³i chÃ­nh xÃ¡c hÆ¡n, biáº¿n Ä‘á»•i chÃºng thÃ nh Javascript. Má»™t trong sá»‘ cÃ¡c ngÃ´n ngá»¯ cho viá»‡c trÃªn lÃ  CoffeScript. VÃ  vá»›i AngularJS 2, TypeScript Ä‘Ã£ Ä‘Æ°á»£c giá»›i thiá»‡u vá»›i tÃ­nh nÄƒng tÆ°Æ¡ng tá»±. NgoÃ i ra thÃ¬ Babel cÅ©ng Ä‘Æ°á»£c coi nhÆ° má»™t cÃ´ng cá»¥ Ä‘á»ƒ biáº¿n Ä‘á»•i JS. Xu tháº¿ hiá»‡n nay cho thÃ y cÃ ng ngÃ y cÃ ng cÃ³ nhiá»u ngÆ°á»i sá»­ dá»¥ng cÃ¡ch tiáº¿p cáº­n nÃ y trong sáº£n pháº©m cá»§a mÃ¬nh. NhÆ°ng háº¡n cháº¿ rÃµ rÃ ng nháº¥t lÃ  cÃ¡c ngÃ´n ngá»¯ nÃ y Ä‘á»u xuáº¥t phÃ¡t tá»« JS vÃ  chá»‰ cÃ³ thá»ƒ lÃ m nÃ³ tá»‘t hÆ¡n má»™t chÃºt mÃ  thÃ´i. Váº­y thÃ¬ sao chÃºng ta khÃ´ng triá»‡t Ä‘á»ƒ háº³n, biáº¿n Ä‘á»•i tá»« má»™t ngÃ´n ngá»¯ Pure Functional Language sang JS nhá»‰? VÃ  Ä‘Ã³ chÃ­nh lÃ  cÃ¡ch mÃ  Elm Ä‘Æ°á»£c phÃ¡t triá»ƒn. Elm Trong suá»‘t series nÃ y, chÃºng ta Ä‘Ã£ tá»«ng sá»­ dá»¥ng Elm Ä‘á»ƒ há»— trá»£ trong viá»‡c hiá»ƒu vá» FP. Váº­y Elm lÃ  gÃ¬? VÃ  chÃºng ta cÃ³ thá»ƒ dÃ¹ng Elm nhÆ° tháº¿ nÃ o?Elm lÃ  má»™t ngÃ´n ngá»¯ hoÃ n toÃ n lÃ  Pure Functional Language, mÃ  source code Ä‘Æ°á»£c viáº¿t bá»Ÿi Elm sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c biáº¿n Ä‘á»•i thÃ nh code Javascript. VÃ  vÃ¬ tháº¿, ta cÃ³ thá»ƒ sá»­ dá»¥ng Elm Ä‘á»ƒ táº¡o ra cÃ¡c Web Application theo Kiáº¿n TrÃºc Elm, hay cÃ²n gá»i lÃ  TEA (kiáº¿n trÃºc nÃ y thá»±c táº¿ Ä‘Ã£ gÃ¢y cáº£m há»©ng cho cÃ¡c ká»¹ sÆ° táº¡o ra Redux). NgÃ´n ngá»¯ Elm sáº½ khÃ´ng cÃ³ báº¥t ká»³ lá»—i Runtime Error nÃ o (lá»—i khi thá»±c hiá»‡n code). Elm Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng trong mÃ´i trÆ°á»ng production (mÃ´i trÆ°á»ng sáº£n pháº©m tháº­t) bá»Ÿi cÃ¡c cÃ´ng ty nhÆ° lÃ  NoRedink, mÃ  cÃ´ng ty Ä‘Ã³ hiá»‡n Ä‘ang cÃ³ Evan Czapliki - ngÆ°á»i táº¡o ra Elm - lÃ m viá»‡c (trÆ°á»›c Ä‘Ã¢y Ã´ng Ä‘Ã£ lÃ m cho Prezi). Äá»ƒ biáº¿t thÃªm chi tiáº¿t, má»i cÃ¡c báº¡n tham kháº£o bÃ i nÃ³i chuyá»‡n 6 thÃ¡ng lÃ m Elm vá»›i production, Ä‘Æ°á»£c táº¡o ra bá»Ÿi Richard Feldman vÃ  nhá»¯ng tÃ­n Ä‘á»“ Elm. Liá»‡u tÃ´i cÃ³ pháº£i thay Ä‘á»•i táº¥t cáº£ code JS cá»§a mÃ¬nh báº±ng Elm khÃ´ng?KhÃ´ng. Báº¡n cÃ³ thá»ƒ thay tháº¿ tá»«ng pháº§n má»™t. BÃ i viáº¿t sau Ä‘Ã¢y sáº½ mÃ´ táº£ chi tiáº¿t kháº£ nÄƒng nÃ y : LÃ m tháº¿ nÃ o Ä‘á»ƒ sá»­ dá»¥ng Elm trong cÃ´ng viá»‡c VÃ¬ sao há»c Elm? LÃ m viá»‡c vá»›i má»™t ngÃ´n ngá»¯ Pure Functional Language vá»«a cÃ³ sá»± háº¡n cháº¿ vÃ  sá»± tá»± do. Sá»± háº¡n cháº¿ Ä‘áº¿n tá»« viá»‡c báº¡n khÃ´ng thá»ƒ lÃ m nhá»¯ng thá»© Ä‘Ã£ lÃ m Ä‘Æ°á»£c trÆ°á»›c Ä‘Ã³ (mÃ  nhá»¯ng thá»© nÃ y háº§u háº¿t láº¡i giá»›i háº¡n output mÃ  báº¡n cÃ³ thá»ƒ táº¡o ra), nhÆ°ng Ä‘á»“ng thá»i, sá»± tá»± do sáº½ Ä‘Æ°á»£c thá»ƒ hiá»‡n á»Ÿ nhá»¯ng pháº§n má»m khÃ´ng cÃ³ lá»—i, cÃ³ thiáº¿t káº¿ tá»‘t, bá»Ÿi láº½ cÃ¡c pháº§n má»m Ä‘Æ°á»£c viáº¿t bá»Ÿi Elm sáº½ tuÃ¢n theo TEA (Kiáº¿n trÃºc Elm), má»™t mÃ´ hÃ¬nh phÃ¹ há»£p vá»›i FP. FP sáº½ giÃºp báº¡n trá»Ÿ thÃ nh má»™t láº­p trÃ¬nh viÃªn cháº¥t lÆ°á»£ng hÆ¡n. Táº¥t cáº£ cÃ¡c Ã½ tÆ°á»Ÿng trong series bÃ i viáº¿t nÃ y chá»‰ lÃ  nhá»¯ng pháº§n trÃªn cá»§a táº£ng bÄƒng trÃ´i. Chá»‰ khi Ã¡p dá»¥ng chÃºng vÃ o trong thá»±c táº¿, báº¡n má»›i biáº¿t Ä‘Æ°á»£c sá»± lá»£i háº¡i vÃ  há»¯u Ã­ch cá»§a FP trong viá»‡c phÃ¡t triá»ƒn cÃ¡c pháº§n má»m phÃ¹ há»£p vá»›i nhiá»u yÃªu cáº§u, Ä‘á»“ng thá»i tÄƒng trÆ°á»Ÿng má»™t cÃ¡ch á»•n Ä‘á»‹nh. Javascript lÃ  má»™t ngÃ´n ngá»¯ Ä‘Æ°á»£c viáº¿t trong 10 ngÃ y, sau Ä‘Ã³ Ä‘Æ°á»£c chá»‰nh sá»­a trong 2 tháº­p ká»‰ gáº§n Ä‘Ã¢y Ä‘á»ƒ cá»‘ gáº¯ng trá»Ÿ thÃ nh má»™t ngÃ´n ngá»¯ vá»«a functional, vá»«a hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng, trong khi báº£n cháº¥t váº«n lÃ  má»™t imperative language. Trong khi Ä‘Ã³, Elm Ä‘Æ°á»£c thiáº¿t káº¿ dá»±a trÃªn 30 nÄƒm kinh nghiá»‡m lÃ m viá»‡c vá»›i Haskell, vÃ  hÃ ng tháº­p ká»· nghiÃªn cá»©u trong toÃ¡n há»c cÅ©ng nhÆ° khoa há»c mÃ¡y tÃ­nh. Äá»“ng thá»i kiáº¿n trÃºc Elm(TEA) Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t káº¿ vÃ  tinh chá»‰nh hÃ ng nÄƒm trá»i, vÃ  lÃ  káº¿t quáº£ tá»« luáº­n vÄƒn cá»§a Evan vá» váº¥n Ä‘á» há»— trá»£ functional cá»§a cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh. Báº¡n cÃ³ thá»ƒ tham kháº£o bÃ i nÃ³i Watch Controlling Time and Space Ä‘á»ƒ biáº¿t rÃµ hÆ¡n Evan Ä‘Ã£ hiá»‡n thá»±c hÃ³a Ã½ tÆ°á»Ÿng cá»§a mÃ¬nh nhÆ° tháº¿ nÃ o khi thiáº¿t káº¿ ra TEA Elm Ä‘Æ°á»£c thiáº¿t káº¿ cho láº­p trÃ¬nh viÃªn frontend. Má»¥c tiÃªu cá»§a nÃ³ lÃ  khiáº¿n cuá»™c Ä‘á»i láº­p trÃ¬nh viÃªn dá»… thá»Ÿ hÆ¡n. Má»i tham kháº£o bÃ i nÃ³i Letâ€™s be Mainstream Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n má»¥c tiÃªu nÃ y. TÆ°Æ¡ng lai Viá»‡c biáº¿t trÆ°á»›c tÆ°Æ¡ng lai sáº½ diá»…n biáº¿n nhÆ° tháº¿ nÃ o lÃ  báº¥t kháº£ thi, nhÆ°ng chÃºng ta cÃ³ thá»ƒ cÃ³ má»™t vÃ i dá»± Ä‘oÃ¡n cÃ³ cÆ¡ sá»Ÿ. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c dá»± Ä‘oÃ¡n cá»§a tÃ´i vá» tÆ°Æ¡ng lai: Sáº½ cÃ³ thÃªm nhiá»u ngÃ´n ngá»¯ Ä‘Æ°á»£c viáº¿t Ä‘á»ƒ biáº¿n Ä‘á»•i ra JS.CÃ¡c Ã½ tÆ°á»Ÿng cá»§a FP Ä‘Ã£ tá»“n táº¡i trÃªn 40 nÄƒm sáº½ Ä‘Æ°á»£c tÃ¡i nhÃ¬n nháº­n vÃ  sá»­ dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» phá»©c táº¡p cá»§a pháº§n má»m hiá»‡n nayHiá»‡n tráº¡ng cá»§a cÃ¡c thiáº¿t bá»‹ pháº§n cá»©ng hiá»‡n nay, nhÆ° hÃ ng Gigabytes bá»™ nhá»› giÃ¡ ráº» vÃ  chip xá»­ lÃ½ nhanh sáº½ biáº¿n cÃ¡c ká»¹ thuáº­t FP thÃ nh kháº£ thiCPUs sáº½ tÄƒng trÆ°á»Ÿng theo hÆ°á»›ng cÃ³ nhiá»u nhÃ¢n hÆ¡n lÃ  tÄƒng tá»‘c Ä‘á»™ xá»­ lÃ½Pháº§n má»m cÃ³ tráº¡ng thÃ¡i biáº¿n Ä‘á»•i khi thá»±c hiá»‡n sáº½ Ä‘Æ°á»£c coi lÃ  má»™t trong nhá»¯ng váº¥n Ä‘á» lá»›n nháº¥t trong cÃ¡c há»‡ thá»‘ng pháº§n má»m phá»©c táº¡p. LÃ½ do khiáº¿n tÃ´i viáº¿t series nÃ y lÃ  bá»Ÿi vÃ¬ tÃ´i tin ráº±ng FP sáº½ lÃ  tÆ°Æ¡ng lai cá»§a ngÃ nh pháº§n má»m, vÃ  bá»Ÿi vÃ¬ tÃ´i cÅ©ng Ä‘Ã£ tá»‘n vÃ i nÄƒm Ä‘á»ƒ há»c nÃ³ (hiá»‡n táº¡i tÃ´i váº«n Ä‘ang tiáº¿p tá»¥c há»c FP) NÃªn má»¥c tiÃªu cá»§a tÃ´i vá»›i bÃ i viáº¿t nÃ y lÃ  Ä‘á»ƒ giÃºp má»i ngÆ°á»i cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c nhá»¯ng concepts cá»§a FP má»™t cÃ¡ch dá»… dÃ ng vÃ  nhanh chÃ³ng hÆ¡n so vá»›i tÃ´i, Ä‘á»“ng thá»i náº¿u cÃ³ thá»ƒ - giÃºp cÃ¡c báº¡n trá»Ÿ thÃ nh nhá»¯ng láº­p trÃ¬nh viÃªn tá»‘t hÆ¡n, vÃ  cÃ³ sá»± nghiá»‡p sÃ¡ng giÃ¡ trong tÆ°Æ¡ng lai. Ká»ƒ cáº£ viá»‡c dá»± Ä‘oÃ¡n ráº±ng Elm sáº½ lÃ  má»™t ngÃ´n ngá»¯ phÃ¡t triá»ƒn trong tÆ°Æ¡ng lai cá»§a tÃ´i cÃ³ thá»ƒ sai, thÃ¬ tÃ´i váº«n cÃ³ thá»ƒ tá»± tin kháº³ng Ä‘á»‹nh ráº±ng FP vÃ  Elm sáº½ náº±m trÃªn quá»¹ Ä‘áº¡o chuyá»ƒn Ä‘á»™ng cá»§a tÆ°Æ¡ng lai - cho dÃ¹ Ä‘Ã³ lÃ  tÆ°Æ¡ng lai nÃ o Ä‘i ná»¯a. Hy vá»ng ráº±ng sau series nÃ y, má»i ngÆ°á»i sáº½ tá»± tin hÆ¡n vÃ o kháº£ nÄƒng cá»§a mÃ¬nh, cÅ©ng nhÆ° cá»§ng cá»‘, náº¯m vá»¯ng Ä‘Æ°á»£c nhá»¯ng concepst mÃ  tÃ´i Ä‘Ã£ giá»›i thiá»‡u. Lá»i cuá»‘i cÃ¹ng, chÃºc má»i ngÆ°á»i may máº¯n trong nhá»¯ng ná»— lá»±c phÃ­a trÆ°á»›c. Náº¿u báº¡n muá»‘n tham gia vÃ o cá»™ng Ä‘á»“ng cÃ¡c nhÃ  phÃ¡t triá»ƒn web muá»‘n há»c vÃ  giÃºp Ä‘á»¡ láº«n nhau vá» FP trong Elm, má»i cÃ¡c báº¡n tham gia Group Facebook sau: Learn Elm Programming VÃ  Ä‘Ã¢y lÃ  Twitter cá»§a tÃ¡c giáº£ : @cscalfani","categories":[],"tags":[]},{"title":"Trá»Ÿ thÃ nh Functional Programmer - Pháº§n 5","slug":"Tro-thanh-Functional-Programmer-Phan-5","date":"2017-08-23T16:28:13.000Z","updated":"2017-08-24T00:53:11.555Z","comments":true,"path":"2017/08/Tro-thanh-Functional-Programmer-Phan-5.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Tro-thanh-Functional-Programmer-Phan-5.html","excerpt":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP.","text":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP. Concept 8 : Referential Transparency - Tham chiáº¿u minh báº¡ch Referential Transparency - Tham chiáº¿u minh báº¡ch lÃ  má»™t cá»¥m tá»« khÃ¡ lÃ  mÃ u mÃ¨ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ´ táº£ kháº£ nÄƒng cá»§a pure function (náº¿u chÆ°a rÃµ pure function lÃ  gÃ¬, má»i xem láº¡i Pháº§n 1) khi cÃ¡c vá»‹ trÃ­ sá»­ dá»¥ng pure function Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c thay tháº¿ báº±ng pháº§n Ä‘á»‹nh nghÄ©a cá»§a chÃ­nh nÃ³ (nÃ³i Ä‘Æ¡n giáº£n lÃ  chá»— nÃ o gá»i hÃ m thÃ¬ Ä‘á»u cÃ³ thá»ƒ thay tháº¿ báº±ng pháº§n thÃ¢n - cÃ¡c biá»ƒu thá»©c Ä‘á»‹nh nghÄ©a hÃ m). VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y sáº½ giÃºp chÃºng ta hiá»ƒu rÃµ hÆ¡n. Giáº£ sá»­ ta cÃ³ má»™t biá»ƒu thá»©c toÃ¡n há»c khÃ¡ quen thuá»™c nhÆ° sau : y = x + 10 VÃ  khi gÃ¡n giÃ¡ trá»‹ cá»¥ thá»ƒ cho x: x = 3 ThÃ¬ chÃºng ta cÃ³ thá»ƒ thay tháº¿ 3 á»Ÿ vá»‹ trÃ­ cá»§a x vÃ o biá»ƒu thá»©c, khiáº¿n biá»ƒu thá»©c trá»Ÿ thÃ nh : y = 3 + 10 CÃ³ thá»ƒ tháº¥y lÃ  y = 3 + 10 váº«n lÃ  má»™t biá»ƒu thá»©c hoÃ n toÃ n há»£p lá»‡. VÃ  vá»›i pure function, viá»‡c thay tháº¿ tÆ°Æ¡ng tá»± nhÆ° trÃªn lÃ  hoÃ n toÃ n cÃ³ thá»ƒ. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t hÃ m trong Elm Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thÃªm dáº¥u nhÃ¡y Ä‘Æ¡n vÃ o trÆ°á»›c vÃ  sau má»™t String : 12quote str = &quot;&apos;&quot; ++ str ++ &quot;&apos;&quot; VÃ  Ä‘Ã¢y lÃ  má»™t ngá»¯ cáº£nh dÃ¹ng hÃ m á»Ÿ trÃªn: 12findError key = &quot;Unable to find &quot; ++ (quote key) á» Ä‘áº¥y hÃ m findError sáº½ xuáº¥t ra má»™t message thÃ´ng bÃ¡o lá»—i khi viá»‡c tÃ¬m kiáº¿m key khÃ´ng thÃ nh cÃ´ng. VÃ¬ hÃ m quote lÃ  má»™t pure function, chÃºng ta cÃ³ thá»ƒ thay tháº¿ viá»‡c gá»i hÃ m Ä‘Ã³ trong thÃ¢n hÃ m findError báº±ng chÃ­nh pháº§n thÃ¢n hÃ m cá»§a hÃ m quote nhÆ° sau : 12findError key = &quot;Unable to find &quot; ++ (&quot;&apos;&quot; ++ str ++ &quot;&apos;&quot; ) Viá»‡c thay tháº¿ nÃ y tÃ´i gá»i lÃ  TÃ¡i cáº¥u trÃºc ngÆ°á»£c - Reverse Refactoring (vÃ¬ nÃ³ nghe há»£p tai thÃ´i), vÃ  Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  quÃ¡ trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi láº­p trÃ¬nh viÃªn hoáº·c chÆ°Æ¡ng trÃ¬nh pháº§n má»m (vÃ­ dá»¥ nhÆ° bá»™ biÃªn dá»‹ch - compiler hay lÃ  pháº§n má»m test) Ä‘á»ƒ hiá»ƒu vá» Ã½ nghÄ©a vÃ  luá»“ng hoáº¡t Ä‘á»™ng cá»§a code, Ä‘áº·c biá»‡t khi tÃ¬m hiá»ƒu cÃ¡c hÃ m Ä‘á»‡ quy. Execution Order - Thá»© tá»± thá»±c hiá»‡n Háº§u háº¿t cÃ¡c pháº§n má»m hiá»‡n nay Ä‘á»u lÃ  Ä‘Æ¡n luá»“ng (single-thread), cÃ³ nghÄ©a lÃ  trong má»™t thá»i Ä‘iá»ƒm, cÃ³ má»™t vÃ  chá»‰ má»™t Ä‘oáº¡n code Ä‘Æ°á»£c thá»±c hiá»‡n. Ngay cáº£ khi báº¡n lÃ m ra má»™t pháº§n má»m theo hÆ°á»›ng Ä‘a luá»“ng, háº§u háº¿t cÃ¡c luá»“ng sáº½ bá»‹ cháº·n vÃ  pháº£i chá» cho cÃ¡c tÃ¡c vá»¥ xá»­ lÃ½ I/O hoÃ n thÃ nh (tÃ¡c vá»¥ I/O lÃ  cÃ¡c tÃ¡c vá»¥ liÃªn quan Ä‘áº¿n xá»­ lÃ½ input vÃ  output cá»§a há»‡ thá»‘ng nhÆ° file, network,... DÆ°á»›i Ä‘Ã¢y lÃ  má»™t cÃ¡ch lÃ½ giáº£i cho viá»‡c chÃºng ta thÆ°á»ng sáº½ nghÄ© theo cÃ¡c bÆ°á»›c tuáº§n tá»± khi viáº¿t code. TrÆ°á»›c háº¿t hÃ£y xem vÃ­ dá»¥ sau : 1234567891. Láº¥y bÃ¡nh má»³ 2. Äáº·t 2 lÃ¡t bÃ¡nh má»³ vÃ o mÃ¡y nÆ°á»›ng3. Chá»n má»©c nÆ°á»›ng4. Báº¥m nÃºt báº¯t Ä‘áº§u nÆ°á»›ng5. Chá» cho Ä‘áº¿n khi bÃ¡nh má»³ nÆ°á»›ng xong6. Cáº¥t mÃ¡y nÆ°á»›ng 7. Láº¥y bÆ¡ 8. Láº¥y dao cáº¯t bÆ¡9. Pháº¿t bÆ¡ vÃ o bÃ¡nh má»³ nÆ°á»›ng NhÃ¬n vÃ o cÃ¡c bÆ°á»›c thá»±c hiá»‡n cho viá»‡c táº¡o ra bÃ¡nh má»³ nÆ°á»›ng bÆ¡ á»Ÿ trÃªn, chÃºng ta cÃ³ thá»ƒ tháº¥y cÃ³ 2 luá»“ng hoáº¡t Ä‘á»™ng Ä‘á»™c láº­p : Láº¥y bÆ¡ vÃ  nÆ°á»›ng bÃ¡nh. VÃ  2 luá»“ng hoáº¡t Ä‘á»™ng nÃ y chá»‰ tÆ°Æ¡ng tÃ¡c vá»›i nhau á»Ÿ bÆ°á»›c cuá»‘i cÃ¹ng - bÆ°á»›c thá»© 9. VÃ¬ tháº¿ chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n 2 cÃ´ng viá»‡c sau song song vá»›i nhau : 1 viá»‡c bao gá»“m cÃ¡c bÆ°á»›c tá»« 1 Ä‘áº¿n 6, vÃ  1 viá»‡c bao gá»“m 2 bÆ°á»›c 7 vÃ  8. VÃ  ta sáº½ Ä‘Æ°a 2 cÃ´ng viá»‡c nÃ y thÃ nh 2 luá»“ng. NhÆ°ng khi chÃºng ta lÃ m nhÆ° váº­y, má»i thá»© sáº½ trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n : Luá»“ng thá»© 1 Láº¥y bÃ¡nh má»³ Äáº·t 2 lÃ¡t bÃ¡nh má»³ vÃ o mÃ¡y nÆ°á»›ng Chá»n má»©c nÆ°á»›ng Báº¥m nÃºt báº¯t Ä‘áº§u nÆ°á»›ng Chá» cho Ä‘áº¿n khi bÃ¡nh má»³ nÆ°á»›ng xong Cáº¥t mÃ¡y nÆ°á»›ng Luá»“ng thá»© 2 Láº¥y bÆ¡ Láº¥y dao cáº¯t bÆ¡ Chá» luá»“ng thá»© nháº¥t thá»±c hiá»‡n xong Pháº¿t bÆ¡ vÃ o bÃ¡nh má»³ nÆ°á»›ng á» Ä‘Ã¢y luá»“ng thá»© 2 cÃ³ thÃªm má»™t cÃ´ng viá»‡c lÃ  chá» luá»“ng thá»© 1 thá»±c hiá»‡n xong. Váº­y Ä‘iá»u gÃ¬ sáº½ xáº£y ra vá»›i luá»“ng thá»© 2 náº¿u luá»“ng thá»© 1 tháº¥t báº¡i? NguyÃªn táº¯c vÃ  cÃ¡ch thá»©c Ä‘á»ƒ 2 luá»“ng cÃ³ thá»ƒ giao tiáº¿p vÃ  há»£p tÃ¡c vá»›i nhau lÃ  gÃ¬? Ai sáº½ sá»Ÿ há»¯u bÃ¡nh má»³ nÆ°á»›ng: Luá»“ng 1, luá»“ng 2, hay cáº£ hai? Táº¥t cáº£ cÃ¡c cÃ¢u há»i trÃªn sáº½ xáº£y ra khi chÃºng ta muá»‘n lÃ m Ä‘a luá»“ng, vÃ  náº¿u cá»© Ä‘á»ƒ nguyÃªn á»Ÿ dáº¡ng Ä‘Æ¡n luá»“ng, chÃºng ta cÃ³ thá»ƒ bá» qua khÃ´ng cáº§n pháº£i suy nghÄ© gÃ¬ Ä‘áº¿n cÃ¡c váº¥n Ä‘á» phá»©c táº¡p á»Ÿ trÃªn. Váº­y lÃ  báº¡n Ä‘Ã£ hiá»ƒu lÃ½ do vÃ¬ sao con ngÆ°á»i luÃ´n tá»± nhiÃªn suy nghÄ© vÃ  thá»±c hiá»‡n cÃ´ng viá»‡c theo má»™t luá»“ng cÃ³ thá»© tá»± duy nháº¥t rá»“i chá»©. NhÆ°ng chÃºng ta cáº§n nÃ¢ng cao tá»‘i Ä‘a hiá»‡u nÄƒng cá»§a pháº§n má»m báº±ng má»i cÃ¡ch cÃ³ thá»ƒ, nÃªn viá»‡c Ã¡p dá»¥ng Ä‘a luá»“ng sáº½ trá»Ÿ thÃ nh má»™t Ä‘iá»u ta cáº§n ná»— lá»±c Ä‘á»ƒ cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c nhá»¯ng káº¿t quáº£ Ä‘Ã¡ng ghi nháº­n. Tuy nhiÃªn, sáº½ cÃ³ 2 váº¥n Ä‘á» khi lÃ m viá»‡c vá»›i Ä‘a luá»“ng. Äáº§u tiÃªn, cÃ¡c pháº§n má»m Ä‘a luá»“ng sáº½ ráº¥t khÃ³ Ä‘á»ƒ viáº¿t, Ä‘á»c, lÃ½ giáº£i, test vÃ  debug (Ä‘Æ°Æ¡ng nhiÃªn rá»“i). Thá»© hai, má»™t sá»‘ ngÃ´n ngá»¯ nhÆ° Javascript thÃ¬ khÃ´ng há»— trá»£ Ä‘a luá»“ng, hoáº·c cÃ¡c ngÃ´n ngá»¯ cÃ³ há»— trá»£ thÃ¬ há»— trá»£ má»™t cÃ¡ch nghÃ¨o nÃ n. NhÆ°ng sáº½ ra sao náº¿u thá»© tá»± thá»±c hiá»‡n bá»—ng chá»‘c trá»Ÿ nÃªn khÃ´ng cÃ²n quan trá»ng ná»¯a, má»i thá»© cÃ³ thá»ƒ thá»±c hiá»‡n song song? Äiá»u nÃ y nghe cÃ³ váº» Ä‘iÃªn rá»“, nhÆ°ng tÃ´i sáº½ cho báº¡n tháº¥y ráº±ng nÃ³ cÃ³ thá»ƒ. HÃ£y xem má»™t Ä‘oáº¡n code Elm mÃ´ táº£ cho lÃ½ luáº­n trÃªn: 12345678buildMessage message value = let upperMessage = String.toUpper message quotedValue = &quot;&apos;&quot; ++ value &quot;&apos;&quot; in upperMessage ++ &quot;: &quot; ++ value á» Ä‘Ã¢y hÃ m buildMessage nháº­n 2 tham sá»‘ lÃ  message vÃ  value, sau Ä‘Ã³ sáº½ tráº£ vá» message phiÃªn báº£n chá»¯ hoa, kÃ¨m vá»›i má»™t dáº¥u hai cháº¥m vÃ  value náº±m trong dáº¥u nhÃ¡y Ä‘Æ¡n. Trong hÃ m nÃ y 2 biáº¿n upperMessage vÃ  quotedValue lÃ  Ä‘á»™c láº­p vá»›i nhau. Ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu lÃ½ do vÃ¬ sao cÃ³ thá»ƒ káº¿t luáº­n Ä‘Æ°á»£c nhÆ° váº­y? Äá»ƒ xÃ©t vá» tÃ­nh Ä‘á»™c láº­p, sáº½ cÃ³ 2 ná»™i dung cáº§n Ä‘Æ°á»£c xÃ¡c nháº­n lÃ  Ä‘Ãºng. Thá»© nháº¥t, cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c xÃ©t Ä‘áº¿n Ä‘á»u pháº£i lÃ  pure function. Äiá»u nÃ y lÃ  cá»±c ká»³ quan trá»ng bá»Ÿi vÃ¬ cÃ¡c Ä‘á»‘i tÆ°á»£ng nÃ y pháº£i biá»‡t láº­p vá»›i cÃ¡c xá»­ lÃ½ khÃ¡c bÃªn ngoÃ i. Náº¿u cÃ¡c Ä‘á»‘i tÆ°á»£ng nÃ y khÃ´ng pure, chÃºng ta sáº½ khÃ´ng bao giá» biáº¿t Ä‘Æ°á»£c chÃºng cÃ³ Ä‘á»™c láº­p hay khÃ´ng. VÃ  trong trÆ°á»ng há»£p Ä‘Ã³, ta sáº½ pháº£i dá»±a vÃ o thá»© tá»± Ä‘Æ°á»£c gá»i cá»§a cÃ¡c hÃ m nÃ y Ä‘Æ°á»£c viáº¿t trong code Ä‘á»ƒ xÃ¡c Ä‘á»‹nh thá»© tá»± thá»±c hiá»‡n cá»§a chÃºng. VÃ  Ä‘Ã³ lÃ  cÃ¡ch mÃ  cÃ¡c ngÃ´n ngá»¯ Imperative hoáº¡t Ä‘á»™ng. Thá»© hai, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh tÃ­nh Ä‘á»™c láº­p, thÃ¬ output cá»§a má»™t hÃ m khÃ´ng Ä‘Æ°á»£c cÃ¡c hÃ m cÃ²n láº¡i láº¥y lÃ m input. Náº¿u Ä‘iá»u nÃ y bá»‹ vi pháº¡m, thÃ¬ chÃºng ta sáº½ pháº£i chá» má»™t hÃ m Ä‘Æ°á»£c thá»±c hiá»‡n xong thÃ¬ má»›i thá»±c hiá»‡n tiáº¿p hÃ m cÃ²n láº¡i, vÃ  Ä‘iá»u nÃ y thÃ¬ khiáº¿n chÃºng khÃ´ng cÃ²n Ä‘á»™c láº­p ná»¯a. Trong vÃ­ dá»¥ tÃ´i vá»«a nÃªu, cáº£ upperMessage vÃ  quotedValue Ä‘á»u lÃ  káº¿t quáº£ cá»§a 2 hÃ m pure vÃ  chÃºng Ä‘á»u khÃ´ng yÃªu cáº§u output cá»§a láº«n nhau. Do Ä‘Ã³, 2 hÃ m nÃ y cÃ³ thá»ƒ thá»±c hiá»‡n theo Báº¤T Ká»² THá»¨ Tá»° NÃ€O. Bá»™ biÃªn dá»‹ch (compiler) - vÃ¬ tháº¿ cÃ³ thá»ƒ tá»± quyáº¿t Ä‘á»‹nh thá»© tá»± thá»±c hiá»‡n cá»§a 2 hÃ m trÃªn mÃ  khÃ´ng cáº§n sá»± chá»‰ Ä‘áº¡o cá»¥ thá»ƒ cá»§a ngÆ°á»i láº­p trÃ¬nh. Viá»‡c nÃ y chá»‰ cÃ³ thá»ƒ kháº£ thi vá»›i cÃ¡c ngÃ´n ngá»¯ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh lÃ  Pure Functional Language (lÃ  cÃ¡c ngÃ´n ngá»¯ FP mÃ  cÃ¡c biá»ƒu thá»©c - expression Ä‘á»u lÃ  pure - hay nÃ³i cÃ¡ch khÃ¡c, khÃ´ng táº¡o ra side-effect), bá»Ÿi vÃ¬ náº¿u khÃ´ng sáº½ ráº¥t khÃ³, tháº­m chÃ­ lÃ  khÃ´ng thá»ƒ xá»­ lÃ½ cÃ¡c side-effect khi chÃºng xáº£y ra. Thá»© tá»± thá»±c hiá»‡n trong cÃ¡c ngÃ´n ngá»¯ Pure Functional Language cÃ³ thá»ƒ Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh bá»Ÿi trÃ¬nh biÃªn dá»‹ch (compiler). ÄÃ¢y thá»±c sá»± lÃ  má»™t lá»£i Ã­ch hiá»ƒn nhiÃªn khi trong thá»i Ä‘áº¡i ngÃ y nay, cÃ¡c bá»™ vi xá»­ lÃ½ thay vÃ¬ Ä‘Æ°á»£c nÃ¢ng cao tá»‘c Ä‘á»™ thÃ¬ chÃºng sáº½ Ä‘Æ°á»£c trang bá»‹ ngÃ y cÃ ng nhiá»u nhÃ¢n hÆ¡n. Viá»‡c thá»© tá»± thá»±c hiá»‡n cÃ³ thá»ƒ Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh bá»Ÿi trÃ¬nh biÃªn dá»‹ch sáº½ khiáº¿n cho code cÃ³ thá»ƒ Ä‘Æ°á»£c cháº¡y song song trÃªn nhiá»u nhÃ¢n má»™t lÃºc, vÃ  vÃ¬ tháº¿, hiá»‡u nÄƒng sáº½ Ä‘Æ°á»£c nÃ¢ng cao. ÄÃ¡ng tiáº¿c lÃ  vá»›i cÃ¡c ngÃ´n ngá»¯ Imperative, chÃºng ta khÃ´ng thá»ƒ táº­n dá»¥ng tá»‘i Ä‘a viá»‡c CPU cÃ³ nhiá»u nhÃ¢n, trá»« khi cÃ³ sá»± thay Ä‘á»•i á»Ÿ pháº§n tháº¥p, tháº­m chÃ­ lÃ  lÃµi cá»§a ngÃ´n ngá»¯, mÃ  khi Ä‘Ã³ thÃ¬ sáº½ kÃ©o theo ráº¥t nhiá»u thay Ä‘á»•i trong kiáº¿n trÃºc cá»§a cÃ¡c pháº§n má»m viáº¿t ra dá»±a trÃªn cÃ¡c ngÃ´n ngá»¯ Ä‘Ã³. Vá»›i cÃ¡c ngÃ´n ngá»¯ Pure Functional Language, chÃºng ta sáº½ cÃ³ tiá»m nÄƒng váº­n dá»¥ng cÃ¡c nhÃ¢n cá»§a CPU má»™t cÃ¡ch hiá»‡u quáº£ nháº¥t mÃ  khÃ´ng cáº§n pháº£i thay Ä‘á»•i báº¥t cá»© dÃ²ng code nÃ o. Type Annotation - XÃ¡c Ä‘á»‹nh kiá»ƒu dá»¯ liá»‡u Trong cÃ¡c ngÃ´n ngá»¯ cÃ³ kiá»ƒu dá»¯ liá»‡u tÄ©nh (Statically Typed Language), kiá»ƒu Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong cÃ¹ng 1 dÃ²ng. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t Ä‘oáº¡n code Java Ä‘á»ƒ tham kháº£o : 123public static String quote(String str) &#123; return &quot;&apos;&quot; + str + &quot;&apos;&quot;;&#125; Báº¡n hÃ£y Ä‘á»ƒ Ã½ pháº§n xÃ¡c Ä‘á»‹nh kiá»ƒu tráº£ vá» cá»§a hÃ m vÃ  cá»§a tham sá»‘ Ä‘á»u Ä‘Æ°á»£c viáº¿t trong cÃ¹ng dÃ²ng vá»›i pháº§n Ä‘á»‹nh nghÄ©a hÃ m. VÃ  khi ta dÃ¹ng generics, thÃ¬ nhÃ¬n cÃ²n tá»‡ hÆ¡n ná»¯a : 123private final Map&lt;Integer, String&gt; getPerson(Map&lt;String, String&gt; people, Integer personId) &#123; // ...&#125; á» Ä‘Ã¢y cÃ¡c pháº§n dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh kiá»ƒu dá»¯ liá»‡u sáº½ lÃ  Map&lt;Integer, String&gt;, Map&lt;String, String&gt;, Integer, vÃ  bá»Ÿi vÃ¬ chÃºng náº±m láº«n vá»›i pháº§n Ä‘á»‹nh nghÄ©a hÃ m, chá»©a cáº£ tÃªn hÃ m vÃ  cÃ¡c biáº¿n, nÃªn chÃºng ta sáº½ máº¥t thá»i gian vÃ  cáº§n nhiá»u sá»± táº­p trung Ä‘á»ƒ cÃ³ tháº¿ tÃ¬m ra tÃªn cÃ¡c tham sá»‘. NgÆ°á»£c láº¡i, vá»›i cÃ¡c ngÃ´n ngá»¯ cÃ³ kiá»ƒu dá»¯ liá»‡u Ä‘á»™ng (Dynamically Typed Language), chÃºng ta khÃ´ng gáº·p pháº£i váº¥n Ä‘á» á»Ÿ trÃªn. VÃ­ dá»¥ nhÆ° vá»›i Javascript, hÃ m á»Ÿ trÃªn sáº½ chá»‰ cáº§n viáº¿t nhÆ° sau lÃ  Ä‘á»§ : 123var getPerson = function(people, personId) &#123; //...&#125;; CÃ³ thá»ƒ tháº¥y ráº±ng phiÃªn báº£n báº±ng JS á»Ÿ trÃªn dá»… Ä‘á»c hÆ¡n ráº¥t nhiá»u vÃ¬ ko cÃ³ nhá»¯ng khai bÃ¡o kiá»ƒu dá»¯ liá»‡u loáº±ng ngoáº±ng nhÆ° vá»›i phiÃªn báº£n cá»§a Java. Váº¥n Ä‘á» duy nháº¥t á»Ÿ Ä‘Ã¢y lÃ  máº·c dÃ¹ dá»… Ä‘á»c hÆ¡n, nhÆ°ng chÃºng ta Ä‘Ã£ pháº£i bá» qua sá»± an toÃ n khi Ä‘á»‹nh nghÄ©a rÃµ kiá»ƒu dá»¯ liá»‡u. Ta cÃ³ thá»ƒ dá»… dÃ ng truyá»n vÃ o cÃ¡c biáº¿n cÃ³ kiá»ƒu khÃ´ng phÃ¹ há»£p, nhÆ° lÃ  má»™t sá»‘ cho biáº¿n people hoáº·c má»™t Object cho biáº¿n personID. VÃ  viá»‡c truyá»n nháº§m kiá»ƒu dá»¯ liá»‡u nÃ y chá»‰ cÃ³ thá»ƒ phÃ¡t hiá»‡n Ä‘áº¿n khi cÃ¡c Ä‘oáº¡n code Ä‘Æ°á»£c thá»±c hiá»‡n, nÃªn cÃ³ thá»ƒ sáº½ xáº£y ra lá»—i sau khi chÃºng ta Ä‘Ã£ Ä‘Æ°a code lÃªn mÃ´i trÆ°á»ng tháº­t hÃ ng thÃ¡ng trá»i. NhÆ°ng vá»›i Java thÃ¬ sáº½ khÃ´ng gáº·p lá»—i nÃ y, vÃ  sáº½ Ä‘Æ°á»£c phÃ¡t hiá»‡n khi code Ä‘Æ°á»£c biÃªn dá»‹ch (compile). ÄÃ³ lÃ  nhá»¯ng Ä‘iá»ƒm lá»£i vÃ  báº¥t lá»£i giá»¯a kiá»ƒu dá»¯ liá»‡u Ä‘á»™ng vÃ  tÄ©nh, vÃ  náº¿u chÃºng ta cÃ³ thá»ƒ káº¿t há»p Æ°u Ä‘iá»ƒm cá»§a cáº£ hai, bao gá»“m syntax Ä‘Æ¡n giáº£n dá»… hiá»ƒu bÃªn phÃ­a Javascript vÃ  sá»± an toÃ n khi Ä‘á»‹nh rÃµ kiá»ƒu dá»¯ liá»‡u bÃªn Java, thÃ¬ cháº³ng pháº£i sáº½ ráº¥t tuyá»‡t hay sao? VÃ  thá»±c táº¿ lÃ  chÃºng ta cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» má»™t hÃ m trong Elm vá»›i viá»‡c Ä‘á»‹nh rÃµ kiá»ƒu dá»¯ liá»‡u: 123add : Int -&gt; Int -&gt; Intadd x y = x + y HÃ£y Ä‘á»ƒ Ã½ ráº±ng thÃ´ng tin vá» kiá»ƒu dá»¯ liá»‡u cá»§a tham sá»‘ vÃ  giÃ¡ trá»‹ tráº£ vá» cá»§a hÃ m Ä‘Æ°á»£c viáº¿t báº±ng má»™t dÃ²ng riÃªng biá»‡t. VÃ  sá»± tÃ¡ch riÃªng nhÆ° nÃ y Ä‘em Ä‘áº¿n ráº¥t ráº¥t nhiá»u Ä‘iá»u khÃ¡c biá»‡t. Náº¿u láº§n Ä‘áº§u nhÃ¬n vÃ o Ä‘oáº¡n code trÃªn, báº¡n cÃ³ thá»ƒ nghÄ© ráº±ng pháº§n khai bÃ¡o thÃ´ng tin kiá»ƒu dá»¯ liá»‡u (dÃ²ng Ä‘áº§u tiÃªn) cÃ³ lá»—i Ä‘Ã¡nh mÃ¡y. TÃ´i cÅ©ng Ä‘Ã£ tá»«ng cáº£m tháº¥y nhÆ° váº­y. LÃºc Ä‘Ã³ tÃ´i Ä‘Ã£ nghÄ© dáº¥u -&gt; Ä‘áº§u tiÃªn nÃªn lÃ  dáº¥u pháº©y. NhÆ°ng thá»±c táº¿ thÃ¬ cÃ¢u lá»‡nh Ä‘Ã³ hoÃ n toÃ n chÃ­nh xÃ¡c. Náº¿u Ä‘áº·t thÃªm vÃ i dáº¥u Ä‘Ã³ng má»Ÿ ngoáº·c, báº¡n sáº½ báº¯t Ä‘áº§u tháº¥y nÃ³ cÃ³ váº» há»£p lÃ½ hÆ¡n : 1add : Int -&gt; ( Int -&gt; Int) Biá»ƒu thá»©c á»Ÿ trÃªn chá»‰ ra ráº±ng hÃ m add lÃ  má»™t hÃ m cÃ³ má»™t tham sá»‘ cÃ³ kiá»ƒu Int vÃ  tráº£ vá» má»™t hÃ m cÅ©ng cÃ³ má»™t tham sá»‘ kiá»ƒu Intvá»›i káº¿t quáº£ tráº£ vá» lÃ  má»™t giÃ¡ trá»‹ Int. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t khai bÃ¡o hÃ m phá»©c táº¡p hÆ¡n má»™t chÃºt: 123doSomething : String -&gt; (Int -&gt; (String -&gt; String))doSomething prefix value suffix = prefix ++ (toString value) ++ suffix Äoáº¡n code trÃªn Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ khai bÃ¡o má»™t hÃ m cÃ³ tÃªn lÃ  doSomething sáº½ nháº­n má»™t tham sá»‘ cÃ³ kiá»ƒu String, vÃ  tráº£ vá» 1 hÃ m (táº¡m gá»i lÃ  hÃ m A). HÃ m A lÃ  hÃ m nháº­n má»™t tham sá»‘ cÃ³ kiá»ƒu Int, vÃ  tráº£ vá» 1 hÃ m (hÃ m B). HÃ m B lÃ  hÃ m nháº­n má»™t tham sá»‘ cÃ³ kiá»ƒu String, vÃ  tráº£ vá» káº¿t quáº£ lÃ  giÃ¡ trá»‹ kiá»ƒu String. CÃ³ thá»ƒ tháº¥y ráº±ng táº¥t cáº£ cÃ¡c hÃ m Ä‘á»u chá»‰ cÃ³ má»™t tham sá»‘. ÄÃ³ lÃ  bá»Ÿi táº¥t cáº£ cÃ¡c hÃ m trong Elm Ä‘á»u há»— trá»£ Currying. VÃ  bá»Ÿi vÃ¬ dáº¥u ngoáº·c Ä‘Æ¡n luÃ´n Ä‘Æ°á»£c Ä‘áº·t vÃ o tá»« phÃ­a ngoÃ i cÃ¹ng bÃªn pháº£i, láº§n lÆ°á»£t theo tá»«ng dáº¥u mÅ©i tÃªn nÃªn chÃºng ta cÃ³ thá»ƒ bá» qua khÃ´ng cáº§n chá»‰ Ä‘á»‹nh rÃµ, vÃ  káº¿t quáº£ sáº½ lÃ : 1doSomething : String -&gt; Int -&gt; String -&gt; String Dáº¥u ngoáº·c Ä‘Æ¡n chá»‰ thá»±c sá»± cáº§n thiáº¿t khi chÃºng ta muá»‘n truyá»n hÃ m trong tham sá»‘. Náº¿u khÃ´ng sá»­ dá»¥ng chÃºng thÃ¬ viá»‡c xÃ¡c Ä‘á»‹nh kiá»ƒu dá»¯ liá»‡u sáº½ trá»Ÿ nÃªn mÃ¹ má». VÃ­ dá»¥: 123takes2Params : Int -&gt; Int -&gt; Stringtakes2Params num1 num2 = -- do something sáº½ khÃ¡c hoÃ n toÃ n so vá»›i : 123takes1Param : (Int -&gt; Int) -&gt; Stringtakes1Param f = -- do something take2Params lÃ  má»™t hÃ m yÃªu cáº§u 2 tham sá»‘ Int, Ä‘á»ƒ cÃ³ thá»ƒ tráº£ vá» giÃ¡ trá»‹ kiá»ƒu String. NhÆ°ng take1Param lÃ  hÃ m yÃªu cáº§u 1 tham sá»‘ lÃ  má»™t hÃ m f, mÃ  hÃ m f Ä‘Ã³ cÃ³ 1 tham sá»‘ lÃ  Int vÃ  tráº£ vá» káº¿t quáº£ lÃ  Int. VÃ  Ä‘Ã¢y lÃ  pháº§n Ä‘á»‹nh kiá»ƒu dá»¯ liá»‡u cho hÃ m map chÃºng ta Ä‘Ã£ dÃ¹ng á»Ÿ pháº§n trÆ°á»›c 123map : (a -&gt; b) -&gt; List a -&gt; List bmap f list = // ... á» Ä‘Ã¢y dáº¥u ngoáº·c Ä‘Æ¡n lÃ  cáº§n thiáº¿t bá»Ÿi vÃ¬ hÃ m f dÃ¹ng trong hÃ m map sáº½ cÃ³ kiá»ƒu lÃ  (a -&gt; b), vá»›i Ã½ nghÄ©a lÃ  má»™t hÃ m nháº­n vÃ o giÃ¡ trá»‹ kiá»ƒu a vÃ  tráº£ vá» giÃ¡ trá»‹ kiá»ƒu b. Chá»¯ a á»Ÿ Ä‘Ã¢y Ä‘Æ°á»£c hiá»ƒu vá»›i nghÄ©a lÃ  báº¥t ká»³ kiá»ƒu nÃ o. Náº¿u má»™t kiá»ƒu cÃ³ kÃ½ tá»± hoa, thÃ¬ nÃ³ sáº½ lÃ  má»™t kiá»ƒu cá»¥ thá»ƒ, vÃ­ dá»¥ nhÆ° String. CÃ²n náº¿u má»™t kiá»ƒu chá»‰ cÃ³ kÃ½ tá»± thÆ°á»ng, nÃ³ cÃ³ thá»ƒ lÃ  báº¥t cá»© kiá»ƒu dá»¯ liá»‡u nÃ o. VÃ¬ tháº¿ kiá»ƒu a cÃ³ thá»ƒ lÃ  String hay Int Ä‘á»u Ä‘Æ°á»£c. Náº¿u báº¡n nhÃ¬n tháº¥y kiá»ƒu Ä‘á»‹nh nghÄ©a hÃ m lÃ  (a -&gt; a) thÃ¬ nÃ³ sáº½ cÃ³ Ã½ nghÄ©a lÃ  kiá»ƒu dá»¯ liá»‡u cá»§a tham sá»‘ vÃ  giÃ¡ trá»‹ tráº£ vá» PHáº¢I giá»‘ng nhau, máº·c dÃ¹ cÃ³ thá»ƒ lÃ  báº¥t ká»³ kiá»ƒu dá»¯ liá»‡u nÃ o (tá»©c lÃ  náº¿u hÃ m nháº­n input kiá»ƒu Int thÃ¬ pháº£i tráº£ vá» kiá»ƒu Int, nháº­n input kiá»ƒu String thÃ¬ pháº£i tráº£ vá» kiá»ƒu String). NhÆ°ng trong trÆ°á»ng há»£p cá»§a hÃ m map Ä‘Æ°á»£c viáº¿t lÃ  (a -&gt; b). Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  hÃ m f CÃ³ thá»ƒ tráº£ vá» kiá»ƒu dá»¯ liá»‡u khÃ¡c vá»›i tham sá»‘ nhÆ°ng CÅ¨NG cÃ³ thá»ƒ tráº£ vá» kiá»ƒu dá»¯ liá»‡u giá»‘ng vá»›i kiá»ƒu cá»§a tham sá»‘. NhÆ°ng khi kiá»ƒu cá»§a a Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh, thÃ¬ a sáº½ mang kiá»ƒu Ä‘Ã³ trong suá»‘t pháº§n Ä‘á»‹nh nghÄ©a kiá»ƒu dá»¯ liá»‡u cá»§a hÃ m. VÃ­ dá»¥ náº¿u a lÃ  kiá»ƒu Int vÃ  b lÃ  String thÃ¬ Ä‘á»‹nh nghÄ©a kiá»ƒu dá»¯ liá»‡u phÃ­a trÃªn cá»§a hÃ m map sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i : 1(Int -&gt; String) -&gt; List Int -&gt; List String Báº¡n sáº½ tháº¥y ráº±ng táº¥t cáº£ cÃ¡c chá»— dÃ¹ng a trong Ä‘á»‹nh nghÄ©a kiá»ƒu dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c thay tháº¿ báº±ng Int (á»Ÿ pháº§n Ä‘á»‹nh nghÄ©a hÃ m f cÃ³ (a -&gt; b), cÅ©ng nhÆ° pháº§n tham sá»‘ thá»© 2 lÃ  List a), vÃ  táº¥t cáº£ cÃ¡c chá»— dÃ¹ng b Ä‘á»u Ä‘Æ°á»£c thay tháº¿ báº±ng String. Kiá»ƒu dá»¯ liá»‡u List Int cÃ³ nghÄ©a lÃ  má»™t danh sÃ¡ch chá»©a cÃ¡c pháº§n tá»­ cÃ³ kiá»ƒu Int, vÃ  List String tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i má»™t danh sÃ¡ch chá»©a cÃ¡c pháº§n tá»­ cÃ³ kiá»ƒu String. Náº¿u báº¡n Ä‘Ã£ tá»«ng sá»­ dá»¥ng generics trong Java hoáº·c cÃ¡c ngÃ´n gná»¯u khÃ¡c, thÃ¬ háº³n báº¡n sáº½ tháº¥y quen thuá»™c vá»›i concept nÃ y (vÃ­ dá»¥ trong Java lÃ  List&lt;T&gt;). Äáº§u cá»§a tÃ´i!!!! HÃ´m nay Ä‘áº¿n Ä‘Ã¢y thÃ´i lÃ  Ä‘á»§. Trong pháº§n tiáº¿p theo, cÅ©ng lÃ  pháº§n cuá»‘i cÃ¹ng cá»§a series nÃ y, tÃ´i sáº½ Ä‘á» cáº­p Ä‘áº¿n viá»‡c sá»­ dá»¥ng táº¥t cáº£ nhá»¯ng concept mÃ  tÃ´i Ä‘Ã£ giá»›i thiá»‡u vÃ o cÃ´ng viá»‡c hÃ ng ngÃ y nhÆ° tháº¿ nÃ o, cá»¥ thá»ƒ sáº½ lÃ  trong viá»‡c láº­p trÃ¬nh Javascript nhÆ°ng theo hÆ°á»›ng functional, vÃ  láº­p trÃ¬nh vá»›i Elm. Náº¿u báº¡n muá»‘n tham gia vÃ o cá»™ng Ä‘á»“ng cÃ¡c nhÃ  phÃ¡t triá»ƒn web muá»‘n há»c vÃ  giÃºp Ä‘á»¡ láº«n nhau vá» FP trong Elm, má»i cÃ¡c báº¡n tham gia Group Facebook sau: Learn Elm Programming VÃ  Ä‘Ã¢y lÃ  Twitter cá»§a tÃ¡c giáº£ : @cscalfani","categories":[],"tags":[]},{"title":"Trá»Ÿ thÃ nh Functional Programmer - Pháº§n 4","slug":"Tro-thanh-Functional-Programmer-Phan-4","date":"2017-08-23T16:26:54.000Z","updated":"2017-08-24T00:53:04.969Z","comments":true,"path":"2017/08/Tro-thanh-Functional-Programmer-Phan-4.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Tro-thanh-Functional-Programmer-Phan-4.html","excerpt":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP.","text":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP. Concept 7 : Currying Tiáº¿p tá»¥c cÃ¢u chuyá»‡n á»Ÿ cuá»‘i Pháº§n 3 , lÃ½ do khiáº¿n chÃºng ta gáº·p pháº£i váº¥n Ä‘á» trong viá»‡c káº¿t há»£p hai hÃ m mul5 vÃ  add lÃ  bá»Ÿi vÃ¬ hÃ m mult5 cÃ³ 1 tham sá»‘, trong khi hÃ m add láº¡i cÃ³ 2. ChÃºng ta cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch giá»›i háº¡n láº¡i má»—i hÃ m chá»‰ láº¥y má»™t tham sá»‘. Nghe cÃ³ váº» hÆ¡i ká»³ ká»³, nhÆ°ng tin tÃ´i Ä‘i, Ã½ tÆ°á»Ÿng nÃ y khÃ´ng tá»‡ má»™t chÃºt nÃ o Ä‘Ã¢u. ChÃºng ta sáº½ chá»‰ Ä‘Æ¡n giáº£n lÃ  viáº¿t má»™t hÃ m add váº«n cÃ³ hai tham sá»‘, nhÆ°ng cÃ³ kháº£ nÄƒng nháº­n giÃ¡ trá»‹ cho má»™t tham sá»‘ trong má»™t thá»i Ä‘iá»ƒm. VÃ  hÃ m há»— trá»£ kháº£ nÄƒng nÃ y Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i cÃ¡i tÃªn lÃ  Curried Function. Má»™t Curried Fuction lÃ  má»™t hÃ m chá»‰ nháº­n má»™t tham sá»‘ trong má»™t thá»i Ä‘iá»ƒm. Äiá»u nÃ y sáº½ cho phÃ©p chÃºng ta gÃ¡n giÃ¡ trá»‹ tham sá»‘ Ä‘áº§u tiÃªn cá»§a hÃ m add trÆ°á»›c khi káº¿t há»£p vá»›i hÃ m mult5. VÃ  sau Ä‘Ã³ khi hÃ m mult5AfterAdd10 Ä‘Æ°á»£c gá»i, hÃ m add sáº½ nháº­n giÃ¡ trá»‹ tham sá»‘ thá»© hai. Trong Javascript, chÃºng ta cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y báº±ng cÃ¡ch viáº¿t láº¡i hÃ m add nhÆ° sau: 1var add = x =&gt; y =&gt; x + y PhiÃªn báº£n nÃ y cá»§a hÃ m add sáº½ nháº­n hai tham sá»‘ gá»“m x vÃ  y, nhÆ°ng má»™t tham sá»‘ (x) sáº½ Ä‘Æ°á»£c set khi gá»i hÃ m láº§n Ä‘áº§u tiÃªn vÃ  tham sá»‘ cÃ²n láº¡i (y) sáº½ Ä‘Æ°á»£c set khi gá»i hÃ m láº§n thá»© 2. Cá»¥ thá»ƒ hÆ¡n, Ä‘áº§u tiÃªn, hÃ m add sáº½ nháº­n giÃ¡ trá»‹ cho tham sá»‘ x, vÃ  tráº£ vá» má»™t hÃ m má»›i vá»›i má»™t tham sá»‘ cÃ³ tÃªn lÃ  y, vá»›i giÃ¡ trá»‹ káº¿t quáº£ tráº£ vá» lÃ  tá»•ng cá»§a hai tham sá»‘ x vÃ  y. VÃ  bÃ¢y giá» chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng phiÃªn báº£n trÃªn cá»§a hÃ m add Ä‘á»ƒ táº¡o ra hÃ m mult5AfterAdd10 nhÆ° mong muá»‘n : 12var compose = (f, g) =&gt; x =&gt; f(g(x));var mult5AfterAdd10 = compose(mult5, add(10)); HÃ m compose sáº½ nháº­n 2 tham sá»‘ lÃ  f vÃ  g, vÃ  tráº£ vá» má»™t hÃ m nháº­n 1 tham sá»‘ x, mÃ  khi Ä‘Æ°á»£c gá»i sáº½ thá»±c hiá»‡n láº§n lÆ°á»£t 2 hÃ m g vÃ  f lÃªn vá»›i tham sá»‘ nháº­n Ä‘Æ°á»£c (gá»i hÃ m g(x), káº¿t quáº£ nháº­n Ä‘Æ°á»£c truyá»n vÃ o hÃ m f, tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c gá»i f(g(x))). Váº­y chÃ­nh xÃ¡c ta Ä‘Ã£ lÃ m gÃ¬? Theo lÃ½ thuyáº¿t thÃ¬ ta Ä‘Ã£ táº¡o ra má»™t phiÃªn báº£n curried function cá»§a hÃ m add truyá»n thá»‘ng. Viá»‡c nÃ y lÃ m hÃ m add trá»Ÿ nÃªn linh Ä‘á»™ng hÆ¡n, bá»Ÿi vÃ¬ 2 tham sá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c set á»Ÿ 2 thá»i Ä‘iá»ƒm khÃ¡c nhau. Tham sá»‘ Ä‘áº§u tiÃªn, 10 Ä‘Æ°á»£c truyá»n vÃ o Ä‘á»ƒ táº¡o ra hÃ m mult5AfterAdd10, vÃ  tham sá»‘ thá»© 2 Ä‘Æ°á»£c truyá»n vÃ o khi thá»±c hiá»‡n hÃ m mul5AfterAdd10 vá»›i má»™t tham sá»‘ báº¥t ká»³. Äáº¿n Ä‘Ã¢y, báº¡n cÃ³ thá»ƒ nghÄ© ráº±ng lÃ m tháº¿ nÃ o Ä‘á»ƒ viáº¿t láº¡i hÃ m add theo phong cÃ¡ch trÃªn báº±ng ngÃ´n ngá»¯ Elm. TÃ´i xin giáº£i Ä‘Ã¡p luÃ´n lÃ  báº¡n khÃ´ng cáº§n pháº£i lÃ m tháº¿ Ä‘Ã¢u. Trong Elm vÃ  cÃ¡c ngÃ´n ngá»¯ FP khÃ¡c, táº¥t cáº£ cÃ¡c hÃ m Ä‘á»u lÃ  curried function. Váº­y lÃ  hÃ m add trong Elm váº«n giá»¯ nguyÃªn cÃ¡ch khai bÃ¡o : 12add x y = x + y VÃ  Ä‘Ã¢y lÃ  cÃ¡ch mÃ  hÃ m mult5AfterAdd10 nÃªn Ä‘Æ°á»£c viáº¿t: 12mult5AfterAdd10 = (mult5 &lt;&lt; add 10) Vá» máº·t cÃº phÃ¡p, cÃ³ thá»ƒ nÃ³i ráº±ng Elm Ä‘Ã£ Ä‘Ã¡nh báº¡i hoÃ n toÃ n Javascript cÅ©ng nhÆ° cÃ¡c ngÃ´n ngá»¯ Imperative khÃ¡c bá»Ÿi vÃ¬ nÃ³ Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u cho nhá»¯ng concept cÆ¡ báº£n cá»§a FP nhÆ° lÃ  Currying hay Composition. Currying vÃ  TÃ¡i cáº¥u trÃºc code NgoÃ i kháº£ nÄƒng dÃ¹ng Ä‘á»ƒ táº¡o ra cÃ¡c hÃ m há»£p nhÆ° Ä‘Ã£ mÃ´ táº£ á»Ÿ trÃªn, Currying cÃ²n ráº¥t há»¯u Ã­ch khi chÃºng ta thá»±c hiá»‡n tÃ¡i cáº¥u trÃºc code. ÄÃ³ lÃ  khi ta muá»‘n táº¡o má»™t hÃ m tá»•ng vá»›i ráº¥t nhiá»u tham sá»‘, vÃ  sau Ä‘Ã³ sá»­ dá»¥ng nÃ³ Ä‘á»ƒ táº¡o ra cÃ¡c hÃ m cá»¥ thá»ƒ phÃ¹ há»£p vá»›i tá»«ng ngá»¯ cáº£nh sá»­ dá»¥ng, mÃ  yÃªu cáº§u Ã­t tham sá»‘ hÆ¡n. Láº¥y vÃ­ dá»¥, khi chÃºng ta cÃ³ 2 hÃ m sau Ä‘Ã¢y dÃ¹ng Ä‘á»ƒ thÃªm 1 hoáº·c 2 dáº¥u ngoáº·c nhá»n vÃ o trÆ°á»›c vÃ  sau 1 String: 1234bracket str = &quot;&#123;&quot; ++ str ++ &quot;&#125;&quot;doubleBracket str = &quot;&#123;&#123;&quot; ++ str ++ &quot;&#125;&#125;&quot; VÃ  Ä‘Ã¢y lÃ  má»™t sá»‘ ngá»¯ cáº£nh chÃºng ta sáº½ sá»­ dá»¥ng 2 hÃ m Ä‘Ã³ : 1234bracketedJoe = bracket &quot;Joe&quot;doubleBracketedJoe = doubleBracket &quot;Joe&quot; ChÃºng ta cÃ³ thá»ƒ tá»•ng quÃ¡t hÃ³a 2 hÃ m bracket vÃ  doubleBracket thÃ nh 1 hÃ m nhÆ° sau : 12generalBracket prefix str suffix = prefix ++ str ++ suffix NhÆ°ng nhÆ° váº­y thÃ¬ má»—i khi sá»­ dá»¥ng hÃ m generalBracket, chÃºng ta sáº½ pháº£i truyá»n thÃªm giÃ¡ trá»‹ dáº¥u Ä‘Ã³ng/má»Ÿ ngoáº·c : 1234bracketedJoe = generalBracket &quot;&#123;&quot; &quot;Joe&quot; &quot;&#125;&quot;doubleBracketedJoe = generalBracket &quot;&#123;&#123;&quot; &quot;Joe&quot; &quot;&#125;&#125;&quot; CÃ¡i chÃºng ta thá»±c sá»± muá»‘n lÃ  táº­p há»£p cÃ¡c lá»£i Ã­ch cá»§a cáº£ 2 cÃ¡ch: sá»­ dá»¥ng Ä‘Æ¡n giáº£n (truyá»n má»—i String vÃ o hÃ m), nhÆ°ng khÃ´ng Ä‘Æ°á»£c láº·p code. Náº¿u chÃºng ta sáº¯p xáº¿p láº¡i thá»© tá»± cÃ¡c tham sá»‘ cá»§a hÃ m generateBracket, chÃºng ta cÃ³ thá»ƒ táº¡o ra 2 hÃ m bracket vÃ  doubleBracket vÃ¬ hÃ m generateBracket vá»‘n Ä‘Ã£ há»— trá»£ Currying rá»“i: 123456generalBracket prefix suffix str = prefix ++ str ++ suffixbracket = generalBracket &quot;&#123;&quot; &quot;&#125;&quot;doubleBracket = generalBracket &quot;&#123;&#123;&quot; &quot;&#125;&#125;&quot; Äá»ƒ Ã½ ráº±ng báº±ng viá»‡c Ä‘Æ°a cÃ¡c tham sá»‘ cÃ³ váº» nhÆ° sáº½ Ä‘Æ°á»£c set cá»‘ Ä‘á»‹nh trÆ°á»›c lÃªn Ä‘áº§u tiÃªn, trong vÃ­ dá»¥ nÃ y lÃ  prefix vÃ  suffix, vÃ  Ä‘Æ°a cÃ¡c tham sá»‘ sáº½ Ä‘Æ°á»£c set sau cÃ¹ng vÃ o phÃ­a sau, chÃºng ta cÃ³ thá»ƒ táº¡o ra cÃ¡c phiÃªn báº£n cá»¥ thá»ƒ vÃ  phÃ¹ há»£p vá»›i nhu cáº§u sá»­ dá»¥ng tá»« hÃ m generalBracket. Thá»© tá»± cÃ¡c tham sá»‘ lÃ  ráº¥t quan trá»ng trong viá»‡c táº­n dá»¥ng kháº£ nÄƒng Currying. Äá»“ng thá»i, ta cÅ©ng cÃ³ thá»ƒ nháº­n tháº¥y lÃ  cÃ¡c hÃ m bracket vÃ  doubleBracket Ä‘á»u Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng Point-free Notation, cá»¥ thá»ƒ trong trÆ°á»ng há»£p nÃ y tham sá»‘ str Ä‘Æ°á»£c loáº¡i bá». Cáº£ 2 hÃ m bracket vÃ  doubleBracket Ä‘á»u lÃ  nhá»¯ng hÃ m Ä‘ang chá» Ä‘á»£i tham sá»‘ cuá»‘i cÃ¹ng. VÃ  giá» chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng 2 hÃ m Ä‘Ã³ nhÆ° trÆ°á»›c khi tÃ¡i cáº¥u trÃºc code : 1234bracketedJoe = bracket &quot;Joe&quot;doubleBracketedJoe = doubleBracket &quot;Joe&quot; NhÆ°ng láº§n nÃ y chÃºng ta Ä‘Ã£ sá»­ dá»¥ng má»™t hÃ m tá»•ng quÃ¡t há»— trá»£ Currying cÃ³ tÃªn generalBracket. Má»™t sá»‘ hÃ m functional cÆ¡ báº£n Giá» chÃºng ta sáº½ Ä‘áº¿n vá»›i 3 hÃ m cÆ¡ báº£n thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong Functional Programming. NhÆ°ng trÆ°á»›c tiÃªn, tÃ´i muá»‘n má»i báº¡n xem Ä‘oáº¡n code sau trong Javascript: 123for (var i = 0; i &lt; something.length; ++i) &#123; // do stuff&#125; CÃ³ má»™t váº¥n Ä‘á» khÃ¡ Ä‘iá»ƒn hÃ¬nh vá»›i Ä‘oáº¡n code trÃªn. Máº·c dÃ¹ khÃ´ng pháº£i lÃ  bug, nhÆ°ng Ä‘oáº¡n code trÃªn sáº½ Ä‘Æ°á»£c chÃºng ta viáº¿t hoáº·c copy paste má»—i láº§n muá»‘n sá»­ dá»¥ng vÃ²ng láº·p (boilerplate code - code khuÃ´n máº«u), nÃªn sáº½ khiáº¿n viá»‡c viáº¿t Ä‘á»c code trá»Ÿ nÃªn má»‡t má»i dáº§n theo thá»i gian. Náº¿u lÃ m viá»‡c vá»›i cÃ¡c ngÃ´n ngá»¯ Imperative nhÆ° lÃ  Java, C#, Javascript, PHP, Python,â€¦ báº¡n sáº½ dá»… dÃ ng nháº­n tháº¥y mÃ¬nh pháº£i liÃªn tá»¥c viáº¿t Ä‘i viáº¿t láº¡i cÃ¡c dÃ²ng code tÆ°Æ¡ng tá»± nhÆ° trÃªn nhiá»u hÆ¡n báº¥t cá»© thá»© gÃ¬ khÃ¡c. VÃ  Ä‘Ã³ chÃ­nh lÃ  váº¥n Ä‘á» mÃ  tÃ´i muá»‘n nÃ³i Ä‘áº¿n. VÃ¬ váº­y tiáº¿p theo Ä‘Ã¢y chÃºng ta sáº½ bÃ n vá» viá»‡c khá»­ cÃ¡c Ä‘oáº¡n code nhÃ m chÃ¡n Ä‘Ã³. HÃ£y Ä‘Æ°a chÃºng vÃ  má»™t hÃ m (hoáº·c má»™t vÃ i hÃ m) vÃ  ta sáº½ khÃ´ng bao giá» pháº£i viáº¿t má»™t vÃ²ng láº·p for má»™t láº§n nÃ o ná»¯a. Thá»±c táº¿ thÃ¬ Ä‘iá»u Ä‘Ã³ khÃ¡ lÃ  báº¥t kháº£ thi, náº¿u nhÆ° chÃºng ta khÃ´ng biáº¿t Ä‘áº¿n FP. TrÆ°á»›c háº¿t, hÃ£y báº¯t Ä‘áº§u báº±ng viá»‡c thay Ä‘á»•i má»™t máº£ng cÃ³ tÃªn lÃ  things: 12345var things = [1, 2, 3, 4];for (var i = 0; i &lt; things.length; ++i) &#123; things[i] = things[i] * 10; // MUTATION ALERT !!!!&#125;console.log(things); // [10, 20, 30, 40] Báº¡n cÃ³ nháº­n tháº¥y Ä‘iá»u gÃ¬ á»Ÿ Ä‘Ã¢y ko? ÄÃ³ chÃ­nh lÃ  Mutability - biáº¿n things Ä‘Ã£ bá»‹ thay Ä‘á»•i giÃ¡ trá»‹ ChÃºng ta sáº½ thá»­ láº¡i, láº§n nÃ y sáº½ khÃ´ng thay Ä‘á»•i giÃ¡ trá»‹ biáº¿n things ná»¯a: 123456var things = [1, 2, 3, 4];var newThings = [];for (var i = 0; i &lt; things.length; ++i) &#123; newThings[i] = things[i] * 10;&#125;console.log(newThings); // [10, 20, 30, 40] Láº§n nÃ y thÃ¬ chÃºng ta khÃ´ng thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n things, nhÆ°ng vá» máº·t ká»¹ thuáº­t thÃ¬ chÃºng ta váº«n thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n newThings, nhÆ°ng chÃºng ta sáº½ bá» qua vÃ  cháº¥p nháº­n Ä‘iá»u Ä‘Ã³, vÃ¬ hiá»‡n táº¡i ta váº«n Ä‘ang sá»­ dá»¥ng Javascript. Khi chuyá»ƒn sang cÃ¡c ngÃ´n ngá»¯ FP, báº¡n sáº½ khÃ´ng thay Ä‘á»•i biáº¿n Ä‘Æ°á»£c ná»¯a Ä‘Ã¢u. Má»¥c Ä‘Ã­ch mÃ  tÃ´i muá»‘n nÃ³i á»Ÿ Ä‘Ã¢y lÃ  giáº£i thÃ­ch rÃµ rÃ ng hÆ¡n cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nhá»¯ng hÃ m cÆ¡ báº£n trong FP (map, reduce, filter,â€¦ ), cÅ©ng nhÆ° tÃ¡c dá»¥ng cá»§a chÃºng trong viá»‡c giáº£m bá»›t nhá»¯ng phiá»n phá»©c khÃ´ng Ä‘Ã¡ng cÃ³ trong code cá»§a mÃ¬nh. Do Ä‘Ã³ code JS cÃ³ thá»ƒ khÃ´ng mÃ´ táº£ Ä‘Ãºng hoÃ n toÃ n cÃ¡ch cÃ¡c hÃ m Ä‘Ã³ thá»±c hiá»‡n, nhÆ°ng vá» concept thÃ¬ cÃ¡c báº¡n cá»© yÃªn tÃ¢m mÃ  theo dÃµi nhÃ©. Giá» vá»›i Ä‘oáº¡n code á»Ÿ trÃªn (khÃ´ng thay Ä‘á»•i biáº¿n things), chÃºng ta sáº½ Ä‘Æ°a nÃ³ vÃ o má»™t hÃ m cÆ¡ báº£n Ä‘áº§u tiÃªn cÃ³ tÃªn lÃ  map, vá»›i nhiá»‡n vá»¥ lÃ  Ã¡nh xáº¡ (map) tá»«ng giÃ¡ trá»‹ cá»§a máº£ng cÅ© Ä‘áº¿n má»™t máº£ng má»›i, thÃ´ng qua má»™t hÃ m biáº¿n Ä‘á»•i f: 1234567var map = (f, array) =&gt; &#123; var newArray = []; for (var i = 0; i &lt; array.length; ++i) &#123; newArray[i] = f(array[i]); &#125; return newArray;&#125;; Ta cÃ³ thá»ƒ tháº¥y hÃ m map ngoÃ i tham sá»‘ lÃ  má»™t máº£ng cáº§n biáº¿n Ä‘á»•i, sáº½ nháº­n thÃªm má»™t tham sá»‘ lÃ  f, Ä‘áº¡i diá»‡n cho viá»‡c mÃ  chÃºng ta muá»‘n xá»­ lÃ½ vá»›i tá»«ng pháº§n tá»­ trong máº£ng cÅ© trÆ°á»›c khi Ä‘Æ°a vÃ o máº£ng má»›i. (VD : nhÃ¢n Ä‘Ã´i tá»«ng pháº§n tá»­ thÃ¬ hÃ m f sáº½ lÃ  var f = x =&gt; x *2, hoáº·c cá»™ng má»—i pháº§n tá»­ thÃªm 1 thÃ¬ hÃ m f sáº½ lÃ  var f = x =&gt; x+1, â€¦) VÃ  vá»›i code ban Ä‘áº§u, chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m map nhÆ° sau : 12var things = [1, 2, 3, 4];var newThings = map(v =&gt; v * 10, things); Báº¡n cÃ³ thá»ƒ tháº¥y lÃ  chÃºng ta Ä‘Ã£ khÃ´ng cÃ²n sá»­ dá»¥ng vÃ²ng láº·p for ná»¯a, Ä‘á»“ng thá»i code cÅ©ng trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n (chÃºng ta cÃ³ thá»ƒ hiá»ƒu Ä‘oáº¡n code trÃªn lÃ  táº¡o ra má»™t newThings lÃ  má»™t máº£ng gá»“m cÃ¡c pháº§n tá»­ nhÆ° máº£ng things, nhÆ°ng má»—i pháº§n tá»­ cÃ³ giÃ¡ trá»‹ Ä‘Æ°á»£c nhÃ¢n lÃªn 10 láº§n). Vá» máº·t ká»¹ thuáº­t thÃ¬ váº«n cÃ³ vÃ²ng láº·p for á»Ÿ trong hÃ m map. NhÆ°ng Ã­t ra thÃ¬ chÃºng ta sáº½ khÃ´ng pháº£i copy paste hoáº·c gÃµ láº¡i cÃ¡i Ä‘oáº¡n code máº«u Ä‘Ã³ thÃªm má»™t láº§n ná»¯a. Giá» thÃ¬ chÃºng ta sáº½ viáº¿t thÃªm má»™t hÃ m cÃ³ filter Ä‘á»ƒ lá»c cÃ¡c pháº§n tá»­ cá»§a má»™t máº£ng theo Ä‘iá»u kiá»‡n báº¥t ká»³: 12345678var filter = (pred, array) =&gt; &#123; var newArray = [];for (var i = 0; i &lt; array.length; ++i) &#123; if (pred(array[i])) newArray[newArray.length] = array[i]; &#125; return newArray;&#125;; LÆ°u Ã½ hÃ m dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ³ láº¥y pháº§n tá»­ Ä‘Ã³ hay khÃ´ng Ä‘Æ°á»£c truyá»n thÃ´ng qua biáº¿n pred, chá»‰ tráº£ vá» giÃ¡ trá»‹ Boolean thÃ´i nhÃ©. HÃ m nÃ y sáº½ tráº£ vá» TRUE khi chÃºng ta muá»‘n giá»¯ láº¡i pháº§n tá»­, vÃ  FALSE náº¿u chÃºng ta muá»‘n loáº¡i nÃ³ ra. VÃ  Ä‘Ã¢y lÃ  cÃ¡ch sá»­ dá»¥ng hÃ m filter Ä‘á»ƒ láº¥y ra cÃ¡c pháº§n tá»­ lÃ  sá»‘ láº» trong má»™t máº£ng : 1234var isOdd = x =&gt; x % 2 !== 0;var numbers = [1, 2, 3, 4, 5];var oddNumbers = filter(isOdd, numbers);console.log(oddNumbers); // [1, 3, 5] Sá»­ dá»¥ng hÃ m filter vá»«a viáº¿t á»Ÿ trÃªn sáº½ Ä‘Æ¡n giáº£n vÃ  dá»… dÃ ng hÆ¡n ráº¥t nhiá»u vá»›i viá»‡c pháº£i Ä‘Ã³ng má»Ÿ vÃ²ng for, set cÃ¡c biáº¿n lÆ°u giÃ¡ trá»‹,â€¦ nhá»¯ng cÃ´ng viá»‡c nhÃ m chÃ¡n láº¡i hay sai. HÃ m thÆ°á»ng xuyÃªn Ä‘Æ°á»£c sá»­ dá»¥ng trong FP tÃ´i muá»‘n giá»›i thiá»‡u cuá»‘i cÃ¹ng cÃ³ tÃªn lÃ  reduce. Vá» cÆ¡ báº£n, nÃ³ Ä‘Æ°á»£c dÃ¹ng vá»›i giÃ¡ trá»‹ Ä‘áº§u vÃ o lÃ  má»™t danh sÃ¡ch, vÃ  káº¿t quáº£ tráº£ ra lÃ  má»™t giÃ¡ trá»‹ Ä‘Æ¡n láº» (nÃªn má»›i Ä‘Æ°á»£c gá»i lÃ  reduce - rÃºt gá»n), nhÆ°ng thá»±c táº¿ thÃ¬ cÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ Ã¡p dá»¥ng. HÃ m reduce thÆ°á»ng Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i cÃ¡i tÃªn lÃ  fold trong FP: 123456var reduce = (f, start, array) =&gt; &#123; var acc = start; for (var i = 0; i &lt; array.length; ++i) acc = f(array[i], acc); // f() takes 2 parameters return acc;&#125;); HÃ m reduce sáº½ gá»“m 3 tham sá»‘, bao gá»“m má»™t hÃ m f dÃ¹ng Ä‘á»ƒ thá»±c hiá»‡n rÃºt gá»n (reduce), má»™t giÃ¡ trá»‹ khá»Ÿi Ä‘áº§u start vÃ  má»™t máº£ng Ä‘á»ƒ thao tÃ¡c array. Äá»ƒ Ã½ ráº±ng hÃ m dÃ¹ng cho viá»‡c rÃºt gá»n lÃ  f sáº½ nháº­n 2 tham sá»‘, má»™t lÃ  giÃ¡ trá»‹ hiá»‡n táº¡i cá»§a máº£ng array, má»™t lÃ  giÃ¡ trá»‹ tÃ­ch lÅ©y acc Ä‘ang Ä‘Æ°á»£c tÃ­nh toÃ¡n vÃ  thay Ä‘á»•i khi duyá»‡t qua tá»«ng pháº§n tá»­ trong máº£ng. GiÃ¡ trá»‹ acc á»Ÿ bÆ°á»›c cuá»‘i cÃ¹ng sáº½ Ä‘Æ°á»£c tráº£ vá» vÃ  cÅ©ng lÃ  káº¿t quáº£ cá»§a hÃ m reduce. VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y sáº½ giÃºp chÃºng ta hiá»ƒu rÃµ hÆ¡n cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a hÃ m nÃ y : 1234var add = (x, y) =&gt; x + y;var values = [1, 2, 3, 4, 5];var sumOfValues = reduce(add, 0, values);console.log(sumOfValues); // 15 HÃ m add sáº½ nháº­n vÃ o 2 tham sá»‘ vÃ  tráº£ vá» tá»•ng cá»§a chÃºng. HÃ m reduce cá»§a chÃºng ta cháº¥p nháº­n cÃ¡c hÃ m cho viá»‡c rÃºt gá»n vá»›i 2 tham sá»‘, nÃªn trong trÆ°á»ng há»£p nÃ y hÃ m add lÃ  hoÃ n toÃ n há»£p lÃ½. ChÃºng ta báº¯t Ä‘áº§u vá»›i giÃ¡ trá»‹ start lÃ  0 vÃ  truyá»n vÃ o má»™t máº£ng values, do Ä‘Ã³ káº¿t quáº£ nháº­n láº¡i cá»§a hÃ m reduce sáº½ lÃ  tá»•ng cÃ¡c pháº§n tá»­ trong máº£ng values. Trong hÃ m reduce, giÃ¡ trá»‹ tá»•ng cÃ¡c pháº§n tá»­ sáº½ Ä‘Æ°á»£c tÃ­ch lÅ©y, cá»™ng dá»“n sau má»—i láº§n duyá»‡t tá»«ng pháº§n tá»­ cá»§a máº£ng. Báº¯t Ä‘áº§u acc = start = 0, giÃ¡ trá»‹ Ä‘áº§u tiÃªn cá»§a máº£ng lÃ  1, láº§n thá»±c hiá»‡n Ä‘áº§u tiÃªn cá»§a hÃ m add sáº½ lÃ  add(1,0) vÃ  acc mang giÃ¡ trá»‹ 1 giÃ¡ trá»‹ thá»© 2 cá»§a máº£ng lÃ  2, acc = 1, hÃ m add lÃºc nÃ y sáº½ Ä‘Æ°á»£c gá»i vá»›i giÃ¡ trá»‹ add(2, 1),vÃ  acc = 3 Tiáº¿p tá»¥c nhÆ° váº­y Ä‘áº¿n cuá»‘i cÃ¹ng, giÃ¡ trá»‹ acc = 15 sau láº§n duyá»‡t pháº§n tá»­ cuá»‘i cÃ¹ng (5) cá»§a máº£ng value vÃ  Ä‘Æ°á»£c tráº£ vá» bá»Ÿi hÃ m reduce. CÃ³ thá»ƒ tháº¥y ráº±ng, má»—i hÃ m map, filter, reduce sáº½ cho phÃ©p chÃºng ta thá»±c hiá»‡n cÃ¡c biáº¿n Ä‘á»•i thÃ´ng thÆ°á»ng vá»›i má»™t máº£ng mÃ  khÃ´ng pháº£i viáº¿t nhá»¯ng Ä‘oáº¡n code sá»­ dá»¥ng vÃ²ng láº·p dÃ i dÃ²ng vÃ  khÃ³ hiá»ƒu ná»¯a. NhÆ°ng trong FP, khi mÃ  chÃºng ta chá»‰ cÃ³ Ä‘á»‡ quy, cÃ²n vÃ²ng láº·p thÃ¬ khÃ´ng tá»“n táº¡i, thÃ¬ cÃ¡c hÃ m duyá»‡t vÃ  biáº¿n Ä‘á»•i máº£ng á»Ÿ trÃªn sáº½ trá»Ÿ nÃªn cá»±c kÃ¬ há»¯u Ã­ch vÃ  cáº§n thiáº¿t. Äáº§u cá»§a tÃ´i!!!! HÃ´m nay Ä‘áº¿n Ä‘Ã¢y thÃ´i lÃ  Ä‘á»§. Trong cÃ¡c pháº§n sau cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ nÃ³i vá» cÃ¡c váº¥n Ä‘á» nhÆ° lÃ  Referential Integrity, Execution Order, Types vÃ  má»™t vÃ i thá»© ná»¯a Náº¿u báº¡n muá»‘n tham gia vÃ o cá»™ng Ä‘á»“ng cÃ¡c nhÃ  phÃ¡t triá»ƒn web muá»‘n há»c vÃ  giÃºp Ä‘á»¡ láº«n nhau vá» FP trong Elm, má»i cÃ¡c báº¡n tham gia Group Facebook sau: Learn Elm Programming VÃ  Ä‘Ã¢y lÃ  Twitter cá»§a tÃ¡c giáº£ : @cscalfani","categories":[],"tags":[]},{"title":"Trá»Ÿ thÃ nh Functional Programmer - Pháº§n 3","slug":"Tro-thanh-Functional-Programmer-Phan-3","date":"2017-08-23T16:25:03.000Z","updated":"2017-08-24T00:52:55.335Z","comments":true,"path":"2017/08/Tro-thanh-Functional-Programmer-Phan-3.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Tro-thanh-Functional-Programmer-Phan-3.html","excerpt":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP.","text":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP. Concept 5: Function Composition - HÃ m há»£p LÆ°á»i lÃ  má»™t trong nhá»¯ng Ä‘áº·c trÆ°ng cá»§a láº­p trÃ¬nh viÃªn chÃºng ta. Äiá»ƒn hÃ¬nh cho cÃ¡i tÃ­nh lÆ°á»i nÃ y lÃ  sá»± ngÃ¡n ngáº©m khi pháº£i thá»±c hiá»‡n Ä‘i thá»±c hiá»‡n láº¡i cÃ´ng viá»‡c chá»‰nh sá»­a, test, deploy code mÃ  mÃ¬nh Ä‘Ã£ tá»«ng viáº¿t trÆ°á»›c Ä‘Ã³. VÃ¬ tháº¿, chÃºng ta luÃ´n luÃ´n tÃ¬m ra nhá»¯ng cÃ¡ch Ä‘á»ƒ chá»‰ lÃ m má»™t láº§n vÃ  Ä‘em ra tÃ¡i sá»­ dá»¥ng má»™t lÃºc nÃ o Ä‘Ã³. TÃ¡i sá»­ dá»¥ng code (code reuse) lÃ  má»™t thá»© tháº­t tuyá»‡t vá»i nhÆ°ng ráº¥t khÃ³ Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c. Náº¿u cÃ¡c Ä‘oáº¡n code quÃ¡ cá»¥ thá»ƒ thÃ¬ ta khÃ´ng thá»ƒ nÃ o tÃ¡i sá»­ dá»¥ng Ä‘Æ°á»£c. NhÆ°ng náº¿u cÃ¡c Ä‘oáº¡n code Ä‘Ã³ láº¡i quÃ¡ chung chung thÃ¬ láº¡i ráº¥t khÃ³ khi Ã¡p dá»¥ng vÃ o tá»«ng trÆ°á»ng há»£p cá»¥ thá»ƒ. Do Ä‘Ã³ chÃºng ta cáº§n má»™t sá»± cÃ¢n báº±ng giá»¯a hai tÃ­nh cháº¥t trÃªn, cáº§n má»™t cÃ¡ch Ä‘á»ƒ táº¡o ra cÃ¡c khá»‘i code nhá», cÃ³ thá»ƒ dá»… dÃ ng tÃ¡i sá»­ dá»¥ng - giá»‘ng nhÆ° cÃ¡c viÃªn gáº¡ch váº­y - Ä‘á»ƒ táº¡o nÃªn cÃ¡c chá»©c nÄƒng phá»©c táº¡p. Trong FP, hÃ m Ä‘Æ°á»£c coi nhÆ° cÃ¡c khá»‘i váº­t liá»‡u xÃ¢y dá»±ng nÃªn chÆ°Æ¡ng trÃ¬nh. ChÃºng ta sáº½ viáº¿t cÃ¡c hÃ m cho nhá»¯ng cÃ´ng viá»‡c cá»¥ thá»ƒ, nhÆ°ng sau Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ ghÃ©p chÃºng láº¡i nhÆ° ghÃ©p Lego váº­y. VÃ  concept mÃ´ táº£ cho viá»‡c nÃ y cÃ³ tÃªn lÃ  Function Composition - HÃ m há»£p Váº­y nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o? Äá»ƒ hiá»ƒu rÃµ hÆ¡n, hÃ£y cÃ¹ng báº¯t Ä‘áº§u vá»›i 2 hÃ m Javascript sau : 123456var add10 = function(value) &#123; return value + 10;&#125;;var mult5 = function(value) &#123; return value * 5;&#125;; NhÃ¬n 2 hÃ m nÃ y khÃ¡ lÃ  rá»‘i ráº¯m, nÃªn chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i báº±ng cÃ¡ch sá»­ dá»¥ng Arrow function nhÆ° sau: 12var add10 = value =&gt; value + 10;var mult5 = value =&gt; value * 5; Gá»n hÆ¡n rá»“i nhá»‰. LÃºc nÃ y hÃ£y thá»­ tÆ°á»Ÿng tÆ°á»£ng ráº±ng chÃºng ta cÃ³ má»™t hÃ m nháº­n má»™t giÃ¡ trá»‹ sá»‘ rá»“i cá»™ng vá»›i 10, sau Ä‘Ã³ nhÃ¢n káº¿t quáº£ nháº­n Ä‘Æ°á»£c vá»›i 5. ChÃºng ta cÃ³ thá»ƒ viáº¿t nhÆ° sau : 1var mult5AfterAdd10 = value =&gt; 5 * (value + 10) Máº·c dÃ¹ Ä‘Ã¢y chá»‰ lÃ  má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n, nhÆ°ng chÃºng ta sáº½ cÃ³ cáº£m giÃ¡c ráº±ng mÃ¬nh khÃ´ng há» muá»‘n viáº¿t hÃ m nÃ y tá»« con sá»‘ 0 má»™t chÃºt nÃ o. LÃ½ do Ä‘áº§u tiÃªn, vÃ¬ chÃºng ta cÃ³ thá»ƒ pháº¡m pháº£i má»™t sá»‘ sai láº§m nhÆ° lÃ  quÃªn máº¥t dáº¥u Ä‘Ã³ng/má»Ÿ ngoáº·c. LÃ½ do thá»© hai, chÃºng ta Ä‘Ã£ cÃ³ 2 hÃ m trÆ°á»›c Ä‘Ã³, add10 dÃ¹ng Ä‘á»ƒ cá»™ng thÃªm 10 vÃ o 1 giÃ¡ trá»‹, mult5 dÃ¹ng Ä‘á»ƒ nhÃ¢n 5 láº§n giÃ¡ trá»‹ nháº­n Ä‘Æ°á»£c, nÃªn viá»‡c viáº¿t láº¡i hÃ m mul5AfterAdd10 thá»±c cháº¥t chá»‰ lÃ  viáº¿t láº¡i nhá»¯ng gÃ¬ Ä‘Ã£ viáº¿t. VÃ  vÃ¬ tháº¿, chÃºng ta sáº½ dÃ¹ng 2 hÃ m add10 vÃ  mult5 lÃ m thÃ nh pháº§n cho viá»‡c xÃ¢y dá»±ng nÃªn hÃ m má»›i: 1var mult5AfterAdd10 = value =&gt; mult5(add10(value)); Ta Ä‘Ã£ vá»«a sá»­ dá»¥ng cÃ¡c hÃ m Ä‘Ã£ cÃ³ Ä‘á»ƒ táº¡o nÃªn hÃ m mult5AfterAdd10, nhÆ°ng váº«n cÃ²n cÃ¡ch cáº£i thiá»‡n Ä‘oáº¡n code trÃªn. ChÃºng ta sáº½ nháº¯c láº¡i má»™t chÃºt vá» toÃ¡n há»c. f âˆ˜ g lÃ  phÃ©p há»£p hÃ m vÃ  Ä‘Æ°á»£c diá»…n giáº£i lÃ  hÃ m f káº¿t há»£p vá»›i hÃ m g, hoáº·c theo ngÃ´n ngá»¯ phá»• thong, hÃ m f sau hÃ m g. VÃ¬ tháº¿ (f âˆ˜ g)(x) tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c gá»i hÃ m f sau khi gá»i hÃ m g vá»›i tham sá»‘ lÃ  x, hay viáº¿t gá»n láº¡i lÃ  f(g(x)). VÃ­ dá»¥ á»Ÿ trÃªn sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i mult5 âˆ˜ add10 hoáº·c lÃ  hÃ m mult5 theo sau hÃ m add10, vÃ  vÃ¬ tháº¿ tÃªn hÃ m sáº½ lÃ  mult5AfterAdd10. VÃ  Ä‘Ã³ chÃ­nh xÃ¡c lÃ  nhá»¯ng gÃ¬ mÃ  chÃºng ta Ä‘Ã£ lÃ m. Ta gá»i hÃ m mult5 sau khi gá»i hÃ m add10 vá»›i tham sá»‘ lÃ  value, hay viáº¿t gá»n lÃ  mult5(add10(value)). VÃ¬ Javascript khÃ´ng há»— trá»£ FP má»™t cÃ¡ch hoÃ n toÃ n nÃªn code cÃ³ váº» khÃ¡ phá»©c táº¡p, chÃºng ta hÃ£y nhÃ¬n sang phiÃªn báº£n cá»§a Elm: 123456add10 value = value + 10mult5 value = value * 5mult5AfterAdd10 value = (mult5 &lt;&lt; add10) value ToÃ¡n tá»­ &lt;&lt; Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ káº¿t há»£p hÃ m á»Ÿ trong Elm. VÃ  viá»‡c sá»­ dá»¥ng toÃ¡n tá»­ nÃ y sáº½ cho chÃºng ta má»™t hÃ¬nh dung khÃ¡ rÃµ rÃ ng vá» luá»“ng xá»­ lÃ½ dá»¯ liá»‡u. Äáº§u tiÃªn, biáº¿n value Ä‘Æ°á»£c truyá»n cho hÃ m add10, sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c truyá»n sang hÃ m mult5. Äá»“ng thá»i hÃ£y lÆ°u Ã½ dáº¥u má»Ÿ vÃ  Ä‘Ã³ng ngoáº·c á»Ÿ hÃ m mult5AfterAdd10, cá»¥ thá»ƒ lÃ  á»Ÿ Ä‘oáº¡n (mult5 &lt;&lt; add10). Viá»‡c sá»­ dá»¥ng Ä‘Ã³ng má»Ÿ ngoáº·c á»Ÿ Ä‘Ã¢y nháº±m Ä‘áº£m báº£o ráº±ng 2 hÃ m sáº½ Ä‘Æ°á»£c káº¿t há»£p trÆ°á»›c khi xá»­ lÃ½ tham sá»‘ value. Ta cÅ©ng cÃ³ thá»ƒ káº¿t há»£p nhiá»u hÃ m náº¿u thÃ­ch : 12f x = (g &lt;&lt; h &lt;&lt; s &lt;&lt; r &lt;&lt; t) x á» Ä‘Ã¢y biáº¿n x sáº½ Ä‘Æ°á»£c truyá»n vÃ o hÃ m t, káº¿t quáº£ Ä‘Æ°á»£c truyá»n sang hÃ m r, sau Ä‘Ã³ káº¿t quáº£ á»Ÿ hÃ m rláº¡i sang hÃ ng s vÃ  tiáº¿p tá»¥c cho Ä‘áº¿n háº¿t hÃ m g. PhiÃªn báº£n hÃ m há»£p tÆ°Æ¡ng Ä‘Æ°Æ¡ng á»Ÿ Javascript sáº½ lÃ  g(h(s(r(t(x))))) - trÃ´ng nhÆ° má»™t Ä‘á»‘ng ngá»•n ngang toÃ n dáº¥u Ä‘Ã³ng má»Ÿ ngoáº·c. Concept 6 : Point-Free Notation(Lá»i ngÆ°á»i dá»‹ch : Tá»« nÃ y mÃ¬nh khÃ´ng tÃ¬m tháº¥y tá»« tiáº¿ng Viá»‡t tÆ°Æ¡ng á»©ng, theo Ã½ hiá»ƒu cá»§a mÃ¬nh cÃ³ nghÄ©a lÃ  kÃ½ hiá»‡u hÃ m mÃ  khÃ´ng pháº£i chá»‰ Ä‘á»‹nh rÃµ tham sá»‘ nÃªn Ä‘Æ°á»£c gá»i lÃ  Point - Free) CÃ³ má»™t phong cÃ¡ch viáº¿t code mÃ  khÃ´ng pháº£i chá»‰ Ä‘á»‹nh rÃµ tham sá»‘ vá»›i tÃªn gá»i lÃ  Point-Free Notation. Ban Ä‘áº§u phong cÃ¡ch nÃ y nhÃ¬n cÃ³ thá»ƒ ká»³ cá»¥c nhÆ°ng theo thá»i gian, chÃºng ta sáº½ cáº£m nháº­n Ä‘Æ°á»£c tÃ¡c dá»¥ng cá»§a sá»± váº¯n táº¯t nÃ y. Quay trá»Ÿ láº¡i vÃ­ dá»¥ vá» hÃ m mult5AfterAdd10, ta nháº­n tháº¥y ráº±ng biáº¿n value Ä‘Æ°á»£c ghi ra hai láº§n. Má»™t láº§n trong danh sÃ¡ch tham sá»‘ vÃ  má»™t láº§n Ä‘Æ°á»£c sá»­ dá»¥ng trong thÃ¢n hÃ m 123-- This is a function that expects 1 parametermult5AfterAdd10 value = (mult5 &lt;&lt; add10) value NhÆ°ng thá»±c táº¿ thÃ¬ tham sá»‘ nÃ y lÃ  khÃ´ng cáº§n thiáº¿t vÃ¬ hÃ m add10 - hÃ m á»Ÿ ngoÃ i cÃ¹ng bÃªn pháº£i cá»§a hÃ m há»£p, cÅ©ng dÃ¹ng chÃ­nh xÃ¡c tham sá»‘ Ä‘Ã³. DÆ°á»›i Ä‘Ã¢y sáº½ lÃ  phiÃªn báº£n point-free tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i hÃ m trÃªn: 123-- This is also a function that expects 1 parametermult5AfterAdd10 = (mult5 &lt;&lt; add10) Khi viáº¿t theo cÃ¡ch nÃ y, thá»±c táº¿ sáº½ Ä‘em láº¡i cho ta ráº¥t nhiá»u lá»£i Ã­ch. Äáº§u tiÃªn, chÃºng ta khÃ´ng pháº£i chá»‰ rÃµ cÃ¡c tham sá»‘ Ä‘Æ°á»£c rÃºt gá»n, do Ä‘Ã³ chÃºng ta khÃ´ng pháº£i máº¥t thá»i gian Ä‘á»ƒ nghÄ© tÃªn cho táº¥t cáº£ cÃ¡c tham sá»‘ Ä‘Ã³. Thá»© hai, viáº¿t theo kiá»ƒu nÃ y sáº½ dá»… Ä‘á»c vÃ  suy luáº­n hÆ¡n vÃ¬ nÃ³ sáº½ bá»›t rá»‘i ráº¯m. VÃ­ dá»¥ phÃ­a trÃªn ráº¥t Ä‘Æ¡n giáº£n, nhÆ°ng hÃ£y tÆ°á»Ÿng tÆ°á»£ng náº¿u má»™t hÃ m nháº­n nhiá»u hÆ¡n má»™t tham sá»‘. Ráº¯c rá»‘i chá»‘n thiÃªn Ä‘Æ°á»ng Tá»« Ä‘áº§u bÃ i viáº¿t Ä‘áº¿n giá», chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu cÃ¡ch HÃ m há»£p hoáº¡t Ä‘á»™ng vÃ  lÃ½ do cÅ©ng nhÆ° cÃ¡ch chÃºng ta nÃªn viáº¿t hÃ m dÆ°á»›i dáº¡ng Point-Free Notation cho sá»± máº¡ch láº¡c, rÃµ rÃ ng vÃ  linh Ä‘á»™ng. Giá», hÃ£y thá»­ Ã¡p dá»¥ng cÃ¡c Ã½ tÆ°á»Ÿng trÃªn vÃ o má»™t bá»‘i cáº£nh khÃ¡c vÃ  xem chÃºng hoáº¡t Ä‘á»™ng ra sao nhÃ©. TÆ°á»Ÿng tÆ°á»£ng chÃºng ta thay hÃ m add10 báº±ng hÃ m add nhÆ° sau : 1234add x y = x + ymult5 value = value * 5 CÃ¢u há»i giá» lÃ  : LÃ m tháº¿ nÃ o Ä‘á»ƒ táº¡o ra hÃ m mult5After10 chá»‰ vá»›i 2 hÃ m trÃªn. TrÆ°á»›c khi Ä‘i tiáº¿p, tÃ´i khuyÃªn báº¡n hÃ£y dá»«ng láº¡i vÃ  nghÄ© má»™t chÃºt. KhÃ´ng cÃ³ gÃ¬ nghiÃªm trá»ng cáº£, chá»‰ Ä‘Æ¡n giáº£n lÃ  dá»«ng láº¡i vÃ  thá»­ ngáº«m nghÄ© má»™t chÃºt thÃ´i. Ok, náº¿u báº¡n Ä‘Ã£ bá» thá»i gian suy nghÄ©, thÃ¬ cÃ³ thá»ƒ báº¡n Ä‘Ã£ nghÄ© Ä‘áº¿n giáº£i phÃ¡p nhÆ° dÆ°á»›i Ä‘Ã¢y: 123-- This is wrong !!!!mult5AfterAdd10 = (mult5 &lt;&lt; add) 10 NhÆ°ng thá»±c táº¿ nÃ³ sáº½ khÃ´ng hoáº¡t Ä‘á»™ng. VÃ¬ sao? VÃ¬ hÃ m add cáº§n hai - hai chá»© khÃ´ng pháº£i má»™t tham sá»‘. Náº¿u trong Elm nhÃ¬n cÃ³ váº» khÃ´ng hiá»ƒn nhiÃªn, chÃºng ta sáº½ quay láº¡i vá»›i phiÃªn báº£n Javascript: 1var mult5AfterAdd10 = mult5(add(10)); // cÃ¡i nÃ y khÃ´ng hoáº¡t Ä‘á»™ng Äoáº¡n code nÃ y khÃ´ng Ä‘Ãºng, nhÆ°ng lÃ½ do lÃ  vÃ¬ sao? NguyÃªn nhÃ¢n lÃ  vÃ¬ hÃ m add chá»‰ láº¥y 1 trong 2 tham sá»‘ Ä‘á»ƒ tÃ­nh toÃ¡n, táº¡o ra káº¿t quáº£ sai, mÃ  káº¿t quáº£ sai Ä‘Ã³ sáº½ Ä‘Æ°á»£c truyá»n sang hÃ m mult5, dáº«n Ä‘áº¿n káº¿t quáº£ cuá»‘i cÃ¹ng khÃ´ng Ä‘Ãºng. Trong thá»±c táº¿, vá»›i Elm, bá»™ biÃªn dá»‹ch - compiler sáº½ khÃ´ng bao giá» bá» qua nhá»¯ng dÃ²ng code sai Ä‘á»‹nh dáº¡ng nhÆ° trÃªn (vÃ  Ä‘Ã³ lÃ  má»™t trong nhá»¯ng Ä‘iá»ƒm tuyá»‡t vá»i cá»§a Elm). ChÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i nhÆ° sau : 1var mult5AfterAdd10 = y =&gt; mult5(add(10, y)); // not point-free ÄÃ¢y khÃ´ng pháº£i lÃ  cÃ¡ch viáº¿t hÃ m theo phong cÃ¡ch point-free, nhÆ°ng Ã­t ra thÃ¬ nÃ³ sáº½ Ä‘áº£m báº£o Ä‘Æ°á»£c káº¿t quáº£ Ä‘Ãºng. NhÆ°ng giá» thÃ¬ ta khÃ´ng thá»ƒ dÃ¹ng toÃ¡n tá»­ káº¿t há»£p cÃ¡c hÃ m láº¡i thÃ nh hÃ m há»£p ná»¯a (lÃ  pháº§n &lt;&lt;). Thay vÃ¬ tháº¿ ta Ä‘ang táº¡o ra má»™t hÃ m má»›i. Sau nÃ y náº¿u ká»‹ch báº£n trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n, vÃ­ dá»¥ nhÆ° muá»‘n káº¿t há»£p hÃ m mult5AfterAdd10 vá»›i má»™t cÃ¡i gÃ¬ Ä‘Ã³ khÃ¡c, lÃºc nÃ y má»i thá»© sáº½ trá»Ÿ nÃªn thá»±c sá»± ráº¯c rá»‘i. VÃ¬ tháº¿ khi chÃºng ta khÃ´ng thá»ƒ káº¿t há»£p hai hÃ m á»Ÿ trÃªn, cÃ³ má»™t Ä‘iá»u ta nháº­n tháº¥y rÃµ rÃ ng lÃ  HÃ m há»£p cÃ³ sá»± háº¡n cháº¿ nháº¥t Ä‘á»‹nh. Äiá»u Ä‘Ã³ tháº­t tá»‡ vÃ¬ HÃ m há»£p lÃ  má»™t concept khÃ¡ máº¡nh máº½. Váº­y lÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta giáº£i quyáº¿t váº¥n Ä‘á» trÃªn? ChÃºng ta cáº§n thá»© gÃ¬ Ä‘á»ƒ cÃ³ thá»ƒ thá»•i bay sá»± ráº¯c rá»‘i nÃ y? Giáº£ sá»­ chÃºng ta cÃ³ thá»ƒ lÃ m cÃ¡ch nÃ o Ä‘Ã³ Ä‘á»ƒ chá»‰ truyá»n cho hÃ m add má»™t giÃ¡ trá»‹ tham sá»‘ trÆ°á»›c tiÃªn (khi táº¡o hÃ m há»£p) , vÃ  tham sá»‘ thá»© 2 sáº½ Ä‘Æ°á»£c truyá»n vÃ o sau Ä‘Ã³ khi thá»±c hiá»‡n hÃ m há»£p - á»Ÿ Ä‘Ã¢y lÃ  lÃºc hÃ m mult5AfterAdd10 Ä‘Æ°á»£c gá»i, cháº³ng pháº£i váº¥n Ä‘á» á»Ÿ trÃªn sáº½ dá»… dÃ ng Ä‘Æ°á»£c giáº£i quyáº¿t sao. VÃ  thá»±c táº¿ lÃ  cÃ¡ch Ä‘Ã³ cÃ³ tá»“n táº¡i, vá»›i tÃªn gá»i lÃ  Currying. Äáº§u cá»§a tÃ´i!!!! HÃ´m nay Ä‘áº¿n Ä‘Ã¢y thÃ´i lÃ  Ä‘á»§. Trong cÃ¡c pháº§n sau cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ nÃ³i vá» cÃ¡c váº¥n Ä‘á» nhÆ° lÃ  Currying, cÃ¡c functional functions cÆ¡ báº£n (nhÆ° lÃ  map, filter, fold,â€¦ ), Referential Transparency vÃ  má»™t vÃ i thá»© ná»¯a Náº¿u báº¡n muá»‘n tham gia vÃ o cá»™ng Ä‘á»“ng cÃ¡c nhÃ  phÃ¡t triá»ƒn web muá»‘n há»c vÃ  giÃºp Ä‘á»¡ láº«n nhau vá» FP trong Elm, má»i cÃ¡c báº¡n tham gia Group Facebook sau: Learn Elm Programming VÃ  Ä‘Ã¢y lÃ  Twitter cá»§a tÃ¡c giáº£ : @cscalfani","categories":[],"tags":[]},{"title":"Trá»Ÿ thÃ nh Functional Programmer - Pháº§n 2","slug":"Tro-thanh-Functional-Programmer-Phan-2","date":"2017-08-23T16:22:32.000Z","updated":"2017-08-24T00:52:47.992Z","comments":true,"path":"2017/08/Tro-thanh-Functional-Programmer-Phan-2.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Tro-thanh-Functional-Programmer-Phan-2.html","excerpt":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP.","text":"Nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn cá»§a viá»‡c hiá»ƒu rÃµ cÃ¡c concepts trong láº­p trÃ¬nh hÃ m (Functional Programming - FP) lÃ  nhá»¯ng bÆ°á»›c quan trá»ng nháº¥t, vÃ  Ä‘Ã´i khi lÃ  nhá»¯ng bÆ°á»›c khÃ³ khÄƒn nháº¥t. NhÆ°ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n, má»i thá»© sáº½ trá»Ÿ nÃªn dá»… hiá»ƒu hÆ¡n ráº¥t nhiá»u. VÃ  Ä‘Ã¢y lÃ  series Ä‘Æ°á»£c táº¡o ra nháº±m má»¥c Ä‘Ã­ch giÃºp cÃ¡c báº¡n dá»… thá»Ÿ hÆ¡n trong quÃ¡ trÃ¬nh tiáº¿p cáº­n vá»›i FP. Má»™t chÃºt lÆ°u Ã½ TÃ´i mong cÃ¡c báº¡n sáº½ Ä‘á»c cÃ¡c dÃ²ng code má»™t cÃ¡ch tá»« tá»‘n. VÃ  hÃ£y Ä‘áº£m báº£o ráº±ng báº¡n Ä‘Ã£ hoÃ n toÃ n hiá»ƒu rÃµ, náº¯m vá»¯ng cÃ¡c ná»™i dung vá»«a Ä‘á»c Ä‘Æ°á»£c trÆ°á»›c khi tiáº¿p tá»¥c. CÃ¡c pháº§n tiáº¿p theo Ä‘Æ°á»£c phÃ¡t triá»ƒn tá»« cÃ¡c pháº§n trÆ°á»›c Ä‘Ã³, nÃªn náº¿u báº¡n vá»™i vÃ£, báº¡n cÃ³ thá»ƒ bá» qua má»™t vÃ i kiáº¿n thá»©c quan trá»ng, cáº§n thiáº¿t cho cÃ¡c pháº§n sau nÃ y. TÃ¡i cáº¥u trÃºc - Refactoring Pháº§n nÃ y sáº½ nÃ³i vá» TÃ¡i cáº¥u trÃºc - má»™t ká»¹ thuáº­t khÃ¡ quen thuá»™c Ä‘á»‘i vá»›i cÃ¡c láº­p trÃ¬nh viÃªn. Sau Ä‘Ã¢y má»i cÃ¡c báº¡n xem má»™t Ä‘oáº¡n code Javascript: function validateSsn(ssn) {if (/^\\d{3}-\\d{2}-\\d{4}/.exec(ssn)) console.log(â€˜Valid SSNâ€˜); else console.log(â€˜Invalid SSNâ€˜); } function validatePhone(phone) { if (/^(\\d{3})\\d{3}-\\d{4}/.exec(phone)) console.log(â€˜Valid Phone Numberâ€˜); else console.log(â€˜Invalid Phone Numberâ€˜);} Háº³n lÃ  báº¡n Ä‘Ã£ tá»«ng viáº¿t nhá»¯ng dÃ²ng code kiá»ƒu nhÆ° tháº¿ nÃ y, vÃ  theo thá»i gian, báº¡n sáº½ dáº§n nháº­n ra ráº±ng 2 hÃ m phÃ­a trÃªn khÃ¡ lÃ  giá»‘ng nhau, chá»‰ cÃ³ Ä‘Ã´i chÃºt khÃ¡c biá»‡t (pháº§n Ä‘Æ°á»£c bÃ´i Ä‘áº­m). VÃ¬ tháº¿, thay vÃ¬ copy láº¡i hÃ m validateSSn vÃ  thay Ä‘á»•i Ä‘á»ƒ táº¡o ra hÃ m validatePhone má»›i, chÃºng ta cÃ³ thá»ƒ chá»‰ táº¡o má»™t hÃ m vÃ  biáº¿n cÃ¡c pháº§n khÃ¡c nhau thÃ nh tham sá»‘. Trong vÃ­ dá»¥ nÃ y, chÃºng ta nÃªn tham sá»‘ hÃ³a pháº§n value, pháº§n regulare expression vÃ  pháº§n message Ä‘Æ°á»£c in ra (lÃ  nhá»¯ng pháº§n bÃ´i Ä‘áº­m á»Ÿ trÃªn). ÄÃ¢y lÃ  code sau khi refactor: 123456function validateValue(value, regex, type) &#123; if (regex.exec(value)) console.log(&apos;Invalid &apos; + type); else console.log(&apos;Valid &apos; + type);&#125; CÃ¡c tham sá»‘ ssn vÃ  phone á»Ÿ trong pháº§n code cÅ© Ä‘Ã£ Ä‘Æ°á»£c thay tháº¿ báº±ng biáº¿n value. 2 biá»ƒu thá»©c chÃ­nh quy (regulare expression) /^\\d{3}-\\d{2}-\\d{4}$/ vÃ  /^\\(\\d{3}\\)\\d{3}-\\d{4}$/ Ä‘Æ°á»£c thay tháº¿ báº±ng biáº¿n regex. VÃ  pháº§n sau cá»§a message gá»“m SNS vÃ  Phone Number sáº½ Ä‘Æ°á»£c thay tháº¿ báº±ng biáº¿n type. Viá»‡c chá»‰ cÃ³ má»™t hÃ m nhÆ° tháº¿ nÃ y sáº½ tá»‘t hÆ¡n ráº¥t nhiá»u so vá»›i viá»‡c cÃ³ 2, hoáº·c xáº¥u hÆ¡n lÃ  3, 4 hay 10 hÃ m. Viá»‡c nÃ y sáº½ giÃºp code cá»§a báº¡n sáº¡ch sáº½ vÃ  dá»… báº£o trÃ¬ hÆ¡n. VÃ­ dá»¥, náº¿u cÃ³ lá»—i xáº£y ra, báº¡n sáº½ chá»‰ pháº£i fix á»Ÿ má»™t chá»— thay vÃ¬ tÃ¬m kiáº¿m trong táº¥t cáº£ source code Ä‘á»ƒ tÃ¬m cÃ¡c chá»— mÃ  hÃ m nÃ y CÃ“ THá»‚ Ä‘Ã£ Ä‘Æ°á»£c copy/paste vÃ  thay Ä‘á»•i. Tiáº¿p theo chÃºng ta cÃ¹ng xem xÃ©t trÆ°á»ng há»£p phá»©c táº¡p hÆ¡n má»™t chÃºt : 123456789101112function validateAddress(address) &#123; if (parseAddress(address)) console.log(&apos;Valid Address&apos;); else console.log(&apos;Invalid Address&apos;);&#125;function validateName(name) &#123; if (parseFullName(name)) console.log(&apos;Valid Name&apos;); else console.log(&apos;Invalid Name&apos;);&#125; á» Ä‘Ã¢y parseAddress vÃ  parseFullName lÃ  2 hÃ m Ä‘á»u nháº­n vÃ o má»™t chuá»—i vÃ  tráº£ vá» true náº¿u parse thÃ nh cÃ´ng. Báº¡n sáº½ refactor code trong trÆ°á»ng há»£p nÃ y nhÆ° tháº¿ nÃ o Ä‘Ã¢y? Giá»‘ng nhÆ° trÆ°á»ng há»£p trÆ°á»›c Ä‘Ã³, ta cÃ³ thá»ƒ sá»­ dá»¥ng biáº¿n value cho address vÃ  name, type cho Address vÃ  Name giá»‘ng nhÆ° Ä‘Ã£ lÃ m trÆ°á»›c Ä‘Ã³, nhÆ°ng á»Ÿ vá»‹ trÃ­ cá»§a biá»ƒu thá»©c chÃ­nh quy lÃºc trÆ°á»›c giá» láº¡i lÃ  2 hÃ m khÃ¡c nhau. Náº¿u nhÆ° chÃºng ta cÃ³ thá»ƒ Ä‘Æ°a hÃ m vÃ o tham sá»‘ thÃ¬ â€¦ Concept 3: Higher-Order Functions(ChÃº thÃ­ch cá»§a ngÆ°á»i dá»‹ch: High-order Function mÃ¬nh Ä‘Ã£ tÃ¬m hiá»ƒu nhÆ°ng khÃ³ cÃ³ tá»« tiáº¿ng Viá»‡t tÆ°Æ¡ng Ä‘Æ°Æ¡ng, báº¡n cÃ³ thá»ƒ hiá»ƒu Higher-Order Functions cÃ³ nghÄ©a lÃ  HÃ m cÃ³ cáº¥p báº­c cao hÆ¡n - vá»›i Ã½ nghÄ©a lÃ  hÃ m cÃ³ nhiá»u kháº£ nÄƒng vÃ  linh hoáº¡t hÆ¡n so vá»›i cÃ¡c ngÃ´n ngá»¯ Imperative Programming thÃ´ng thÆ°á»ng nhÆ° Java, C, C++) Ráº¥t nhiá»u ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ´ng há»— trá»£ viá»‡c Ä‘Æ°a hÃ m vÃ o thÃ nh tham sá»‘. Má»™t sá»‘ ngÃ´n ngá»¯ thÃ¬ cÃ³ thá»ƒ nhÆ°ng cÃ¡ch thá»±c hiá»‡n thÃ¬ khÃ´ng há» dá»… dÃ ng chÃºt nÃ o. Trong Functional Programming, má»™t hÃ m sáº½ Ä‘Æ°á»£c coi nhÆ° lÃ  má»™t cÃ´ng dÃ¢n háº¡ng nháº¥t trong ngÃ´n ngá»¯ Ä‘Ã³. Hay nÃ³i cÃ¡ch khÃ¡c, hÃ m sáº½ giá»‘ng nhÆ° cÃ¡c loáº¡i giÃ¡ trá»‹ (sá»‘, text, object,â€¦) khÃ¡c. Bá»Ÿi vÃ¬ hÃ m sáº½ Ä‘Æ°á»£c coi nhÆ° cÃ¡c loáº¡i giÃ¡ trá»‹ khÃ¡c, nÃªn hÃ m cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n dÆ°á»›i dáº¡ng tham sá»‘. Máº·c dÃ¹ khÃ´ng pháº£i lÃ  ngÃ´n ngá»¯ há»— trá»£ FP chÃ­nh thá»‘ng, nhÆ°ng má»™t vÃ i concept trong FP cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi Javascript. VÃ  Ä‘Ã¢y lÃ  cÃ¡ch thu gá»n hai hÃ m á»Ÿ trÃªn thÃ nh má»™t báº±ng viá»‡c Ä‘Æ°a hÃ m thá»±c hiá»‡n viá»‡c parse dá»¯ liá»‡u thÃ nh tham sá»‘ cá»§a hÃ m má»›i cÃ³ tÃªn lÃ  parseFunc: 123456function validateValueWithFunc(value, parseFunc, type) &#123; if (parseFunc(value)) console.log(&apos;Invalid &apos; + type); else console.log(&apos;Valid &apos; + type);&#125; VÃ  hÃ m má»›i cá»§a chÃºng ta Ä‘Æ°á»£c gá»i lÃ  Higher-order Function. Higher-order Functions lÃ  cÃ¡c hÃ m hoáº·c nháº­n hÃ m lÃ m tham sá»‘, hoáº·c tráº£ vá» hÃ m, hoáº·c vá»«a nháº­n hÃ m lÃ m tham sá»‘ vá»«a tráº£ vá» hÃ m. VÃ  giá» chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i cáº£ 4 hÃ m trÃªn báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m validateValueWithFunc nhÆ° sau ( lÆ°u Ã½ ráº±ng hÃ m Regex.exec sáº½ tráº£ vá» true náº¿u chuá»—i kÃ½ tá»± match vá»›i biá»ƒu thá»©c chÃ­nh quy ): 1234validateValueWithFunc(&apos;123-45-6789&apos;, /^\\d&#123;3&#125;-\\d&#123;2&#125;-\\d&#123;4&#125;$/.exec, &apos;SSN&apos;);validateValueWithFunc(&apos;(123)456-7890&apos;, /^\\(\\d&#123;3&#125;\\)\\d&#123;3&#125;-\\d&#123;4&#125;$/.exec, &apos;Phone&apos;);validateValueWithFunc(&apos;123 Main St.&apos;, parseAddress, &apos;Address&apos;);validateValueWithFunc(&apos;Joe Mama&apos;, parseName, &apos;Name&apos;); Code Ä‘Æ°á»£c viáº¿t láº¡i nhÆ° trÃªn nhÃ¬n ngon hÆ¡n háº³n so vá»›i viá»‡c cÃ³ 4 hÃ m tá»«a tá»±a nhau nhá»‰? :D Äá»ƒ Ã½ kÄ© hÆ¡n má»™t chÃºt, 2 hÃ m sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy nhÃ¬n cÃ³ váº» khÃ¡ lÃ  rÆ°á»m rÃ , nháº¥t lÃ  khi sau nÃ y biá»ƒu thá»©c chÃ­nh quy cÃ³ thá»ƒ trá»Ÿ nÃªn dÃ i vÃ  phá»©c táº¡p hÆ¡n. ChÃºng ta cÃ³ thá»ƒ lÃ m cho nÃ³ gá»n hÆ¡n báº±ng cÃ¡ch Ä‘Æ°a pháº§n gá»i biá»ƒu thá»©c chÃ­nh quy ra ngoÃ i nhÆ° sau : 1234567var parseSsn = /^\\d&#123;3&#125;-\\d&#123;2&#125;-\\d&#123;4&#125;$/.exec;var parsePhone = /^\\(\\d&#123;3&#125;\\)\\d&#123;3&#125;-\\d&#123;4&#125;$/.exec;validateValueWithFunc(&apos;123-45-6789&apos;, parseSsn, &apos;SSN&apos;);validateValueWithFunc(&apos;(123)456-7890&apos;, parsePhone, &apos;Phone&apos;);validateValueWithFunc(&apos;123 Main St.&apos;, parseAddress, &apos;Address&apos;);validateValueWithFunc(&apos;Joe Mama&apos;, parseName, &apos;Name&apos;); Má»i thá»© tá»‘t hÆ¡n rá»“i nhá»‰. Sau nÃ y náº¿u muá»‘n kiá»ƒm tra má»™t sá»‘ Ä‘iá»‡n thoáº¡i khÃ¡c, thay vÃ¬ pháº£i copy láº¡i biá»ƒu thá»©c chÃ­nh quy, ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m parsePhone vÃ  validateValueWithFunc. Tuy nhiÃªn, hÃ£y thá»­ tÆ°á»Ÿng tÆ°á»£ng náº¿u chÃºng ta cÃ³ nhiá»u biá»ƒu thá»©c chÃ­nh quy cáº§n thá»±c hiá»‡n, ngoÃ i 2 hÃ m parseSsn vÃ  parsePhone thÃ¬ sáº½ ra sao nhá»‰? Äá»ƒ Ã½ ráº±ng má»—i khi gá»i hÃ m xá»­ lÃ½ biá»ƒu thá»©c chÃ­nh quy, ta Ä‘á»u pháº£i gá»i thÃªm .exec vÃ o cuá»‘i, vÃ  náº¿u sá»‘ lÆ°á»£ng biá»ƒu thá»©c chÃ­nh quy tÄƒng lÃªn thÃ¬ sáº½ khÃ¡ lÃ  phiá»n phá»©c, vÃ  tin tÃ´i Ä‘i, sáº½ cÃ³ lÃºc báº¡n sáº½ quÃªn máº¥t khÃ´ng thÃªm .exec vÃ o Ä‘Ã³. Äá»ƒ trÃ¡nh máº¯c pháº£i lá»—i nÃ y, chÃºng ta cÃ³ thá»ƒ táº¡o ra má»™t hÃ m dáº¡ng high-order function Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ tráº£ vá» hÃ m exec tá»« biá»ƒu thá»©c chÃ­nh quy truyá»n vÃ o nhÆ° sau : 123456789function makeRegexParser(regex) &#123; return regex.exec;&#125;var parseSsn = makeRegexParser(/^\\d&#123;3&#125;-\\d&#123;2&#125;-\\d&#123;4&#125;$/);var parsePhone = makeRegexParser(/^\\(\\d&#123;3&#125;\\)\\d&#123;3&#125;-\\d&#123;4&#125;$/);validateValueWithFunc(&apos;123-45-6789&apos;, parseSsn, &apos;SSN&apos;);validateValueWithFunc(&apos;(123)456-7890&apos;, parsePhone, &apos;Phone&apos;);validateValueWithFunc(&apos;123 Main St.&apos;, parseAddress, &apos;Address&apos;);validateValueWithFunc(&apos;Joe Mama&apos;, parseName, &apos;Name&apos;); á» Ä‘Ã¢y, hÃ m makeRegexParser nháº­n tham sá»‘ lÃ  má»™t biá»ƒu thá»©c chÃ­nh quy, vÃ  tráº£ vá» hÃ m exec cá»§a biá»ƒu thá»©c chÃ­nh quy Ä‘Ã³, vá»›i tham sá»‘ lÃ  má»™t chuá»—i string. LÃºc nÃ y, hÃ m validateValueWithFunc sáº½ nháº­n chuá»—i string tá»« biáº¿n value, sau Ä‘Ã³ truyá»n sang hÃ m parseSsn hoáº·c parsePhone, Ä‘á»‘i vÃ­ dá»¥ trÃªn thá»±c cháº¥t sáº½ lÃ  hÃ m exec Ä‘Æ°á»£c tráº£ vá» tá»« hÃ m parseSsn hoáº·c parsePhone. NhÆ° cÃ¡c báº¡n Ä‘Ã£ tháº¥y, Ä‘Ã¢y tuy chá»‰ lÃ  má»™t quÃ¡ trÃ¬nh tÃ¡i cáº¥u trÃºc code nho nhá», nhÆ°ng nÃ³ Ä‘Ã£ thá»ƒ hiá»‡n kháº£ nÄƒng vÃ  sá»± tiá»‡n lá»£i cá»§a High-order function khi há»— trá»£ viá»‡c tráº£ vá» hÃ m. Lá»£i Ã­ch cá»§a viá»‡c thay Ä‘á»•i nÃ y sáº½ thá»ƒ hiá»‡n má»™t cÃ¡ch rÃµ rÃ ng hÆ¡n khi hÃ m makeRegexParser trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ khÃ¡c vá» má»™t High-order function cÃ³ káº¿t quáº£ tráº£ vá» lÃ  má»™t hÃ m : 12345function makeAdder(constantValue) &#123; return function adder(value) &#123; return constantValue + value; &#125;;&#125; ChÃºng ta cÃ³ má»™t hÃ m makeAdder nháº­n vÃ o tham sá»‘ lÃ  constantValue (giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh), vÃ  tráº£ vá» má»™t hÃ m tÃªn lÃ  adder, vá»›i kháº£ nÄƒng cá»™ng thÃªm giÃ¡ trá»‹ constantValue vÃ o tham sá»‘ truyá»n vÃ o. ÄÃ¢y lÃ  cÃ¡ch hÃ m adder cÃ³ thá»ƒ sá»­ dá»¥ng : 1234var add10 = makeAdder(10);console.log(add10(20)); // prints 30console.log(add10(30)); // prints 40console.log(add10(40)); // prints 50 ChÃºng ta Ä‘Ã£ táº¡o ra má»™t hÃ m cÃ³ tÃªn lÃ  add10 báº±ng viá»‡c truyá»n giÃ¡ trá»‹ 10 vÃ o hÃ m makeAdder, mÃ  hÃ m add10 sáº½ hoáº¡t Ä‘á»™ng Ä‘Ãºng nhÆ° tÃªn cá»§a nÃ³, cá»™ng thÃªm 10 vÃ o báº¥t ká»³ biáº¿n nÃ o truyueenf vÃ o. Äá»ƒ Ã½ ráº±ng hÃ m adder cÃ³ thá»ƒ truy cáº­p Ä‘áº¿n biáº¿n constantValue ngay cáº£ khi hÃ m makeAddr Ä‘Ã£ hoÃ n thÃ nh. LÃ½ do lÃ  bá»Ÿi vÃ¬ biáº¿n constantValue Ä‘Ã£ á»Ÿ trong cÃ¹ng má»™t scope (pháº¡m vi) khi hÃ m adder Ä‘Æ°á»£c táº¡o. Kháº£ nÄƒng nÃ y ráº¥t quan trá»ng bá»Ÿi vÃ¬ náº¿u thiáº¿u nÃ³, viá»‡c hÃ m tráº£ vá» hÃ m sáº½ khÃ´ng cÃ²n nhiá»u lá»£i Ã­ch ná»¯a. VÃ¬ tháº¿ viá»‡c hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng vÃ  tÃªn gá»i cá»§a kháº£ nÄƒng nÃ y cÅ©ng lÃ  Ä‘iá»u mÃ  chÃºng ta cáº§n tÃ¬m hiá»ƒu, vÃ  nÃ³ cÃ³ tÃªn lÃ  Closure. Concept 4: Closures - Bao Ä‘Ã³ng DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ giáº£ tÆ°á»Ÿng nháº±m minh há»a viá»‡c hÃ m sá»­ dá»¥ng closures: 12345678910function grandParent(g1, g2) &#123; var g3 = 3; return function parent(p1, p2) &#123; var p3 = 33; return function child(c1, c2) &#123; var c3 = 333; return g1 + g2 + g3 + p1 + p2 + p3 + c1 + c2 + c3; &#125;; &#125;;&#125; Trong vÃ­ dá»¥ nÃ y, hÃ m child cÃ³ thá»ƒ truy cáº­p cÃ¡c biáº¿n cá»§a chÃ­nh nÃ³, cÃ¡c biáº¿n cá»§a hÃ m parent vÃ  cáº£ cÃ¡c biáº¿n cá»§a hÃ m grandParent ná»¯a.(Ä‘á»§ g1, g2, g3, p1, p2, p3, c1, c2, c3) HÃ m parent cÃ³ thá»ƒ truy cáº­p cÃ¡c biáº¿n cá»§a chÃ­nh nÃ³ vÃ  cá»§a hÃ m grandParent. (bao gá»“m g1, g2, g3, p1, p2, p3) HÃ m grandParent chá»‰ cÃ³ thá»ƒ truy cáº­p cÃ¡c biáº¿n cá»§a chÃ­nh nÃ³. (bao gá»“m g1, g2, g3). (Má»i ngÆ°á»i cÃ³ thá»ƒ tham kháº£o hÃ¬nh váº½ kim tá»± thÃ¡p phÃ­a bÃªn trÃªn Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n). Sau Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ sá»­ dá»¥ng hÃ m 3 Ä‘á»i á»Ÿ trÃªn : 1234var parentFunc = grandParent(1, 2); // returns parent() - tráº£ vá» hÃ m parent() vá»›i g1 = 1, g2 = 2, g3 = 3var childFunc = parentFunc(11, 22); // returns child() - tráº£ vá» hÃ m child() vá»›i g1 = 1, g2 = 2, g3 = 3, p1 = 11, p2 = 22, p3 = 33console.log(childFunc(111, 222)); // prints 738 - in ra 738 vÃ¬ :// 1 + 2 + 3 + 11 + 22 + 33 + 111 + 222 + 333 == 738 á» Ä‘Ã¢y, biáº¿n parentFunc sáº½ giá»¯ cho scope cá»§a hÃ m parent tá»“n táº¡i sau khi thá»±c hiá»‡n hÃ m grandParent, lÃºc nÃ y hÃ m parent sáº½ tráº£ vá» vÃ  tham chiáº¿u thÃ´ng qua biáº¿n parentFunc (scope cá»§a parent á»Ÿ Ä‘Ã¢y sáº½ bao gá»“m cÃ¡c giÃ¡ trá»‹ Ä‘Æ°á»£c hÃ m parent tham chiáº¿u Ä‘áº¿n, tá»©c lÃ  sáº½ lÆ°u giá»¯ cÃ¡c giÃ¡ trá»‹ g1, g2, g3, p1, p2, p3). TÆ°Æ¡ng tá»± nhÆ° váº­y, biáº¿n childFunc sáº½ giá»¯ scope cá»§a hÃ m child tá»“n táº¡i sau khi thá»±c hiá»‡n gá»i hÃ m parent thÃ´ng qua biáº¿n parentFunc, lÃºc nÃ y hÃ m child Ä‘Æ°á»£c tráº£ vá» vÃ  tá»“n táº¡i vÃ¬ cÃ³ biáº¿n childFunc tham chiáº¿u Ä‘áº¿n. Má»—i khi má»™t hÃ m Ä‘Æ°á»£c táº¡o ra, táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ náº±m trong scope cá»§a nÃ³ á»Ÿ thá»i Ä‘iá»ƒm hÃ m Ä‘Æ°á»£c táº¡o sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  cÃ³ thá»ƒ truy cáº­p trong suá»‘t vÃ²ng Ä‘á»i cá»§a hÃ m Ä‘Ã³. VÃ  hÃ m sáº½ cÃ²n tá»“n táº¡i chá»«ng nÃ o cÃ²n cÃ³ tham chiáº¿u (reference) Ä‘áº¿n nÃ³. VÃ­ dá»¥, scope cá»§a hÃ m child sáº½ cÃ²n tá»“n táº¡i cho Ä‘áº¿n khi nÃ o biáº¿n childFunc váº«n tham chiáº¿u Ä‘áº¿n nÃ³. Má»™t closure (bao Ä‘Ã³ng) lÃ  má»™t scope cá»§a má»™t hÃ m mÃ  sáº½ tá»“n táº¡i chá»«ng nÃ o cÃ²n cÃ³ tham chiáº¿u Ä‘áº¿n hÃ m Ä‘Ã³. LÆ°u Ã½ ráº±ng, trong Javascript, closures sáº½ gÃ¢y ra nhiá»u ráº¯c rá»‘i bá»Ÿi vÃ¬ cÃ¡c biáº¿n cÃ³ thá»ƒ thay Ä‘á»•i (mutable), vÃ  vÃ¬ tháº¿ cÃ¡c biáº¿n Ä‘Ã³ cÃ³ thá»ƒ bá»‹/Ä‘Æ°á»£c thay Ä‘á»•i giÃ¡ trá»‹ tá»« lÃºc chÃºng Ä‘Æ°á»£c Ä‘Ã³ng láº¡i cho Ä‘áº¿n lÃºc hÃ m tráº£ vá» Ä‘Æ°á»£c gá»i. (á» Ä‘Ã¢y Ä‘Ã³ng láº¡i Ã½ nÃ³i lÃºc dÃ¹ng High-order function Ä‘á»ƒ tráº£ vá» má»™t hÃ m, lÃºc nÃ y cÃ¡c biáº¿n trong scope cá»§a hÃ m Ä‘Ã³ váº«n cÃ³ thá»ƒ truy cáº­p vÃ  thay Ä‘á»•i giÃ¡ trá»‹, do Ä‘Ã³ Ä‘áº¿n lÃºc thá»±c thi hÃ m nÃ y, cÃ¡c biáº¿n nÃ y giÃ¡ trá»‹ cÃ³ thá»ƒ khÃ¡c so vá»›i lÃºc Ä‘Æ°á»£c tráº£ vá», gÃ¢y ra cÃ¡c káº¿t quáº£ khÃ´ng mong muá»‘n) Tháº­t may máº¯n lÃ  cÃ¡c biáº¿n trong FP sáº½ lÃ  báº¥t biáº¿n (immutable - Ä‘Ã£ nÃ³i Ä‘áº¿n á»Ÿ pháº§n 1), nÃªn cÃ¡c lá»—i cÃ³ thá»ƒ xáº£y ra do Closure nhÆ° trong JS sáº½ khÃ´ng gáº·p pháº£i ná»¯a. Äáº§u cá»§a tÃ´i!!!! HÃ´m nay Ä‘áº¿n Ä‘Ã¢y thÃ´i lÃ  Ä‘á»§. Trong cÃ¡c pháº§n sau cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ nÃ³i vá» cÃ¡c váº¥n Ä‘á» nhÆ° lÃ  Functional Composition, Currying, cÃ¡c functional functions cÆ¡ báº£n (nhÆ° lÃ  map, filter, fold,â€¦ ), vÃ  má»™t vÃ i thá»© ná»¯a Náº¿u báº¡n muá»‘n tham gia vÃ o cá»™ng Ä‘á»“ng cÃ¡c nhÃ  phÃ¡t triá»ƒn web muá»‘n há»c vÃ  giÃºp Ä‘á»¡ láº«n nhau vá» FP trong Elm, má»i cÃ¡c báº¡n tham gia Group Facebook sau: Learn Elm Programming VÃ  Ä‘Ã¢y lÃ  Twitter cá»§a tÃ¡c giáº£ : @cscalfani","categories":[],"tags":[]},{"title":"Trá»Ÿ thÃ nh Functional Programmer - Pháº§n 1","slug":"Tro-thanh-Functional-Programmer-Phan-1","date":"2017-08-23T16:19:26.000Z","updated":"2017-08-24T00:52:40.637Z","comments":true,"path":"2017/08/Tro-thanh-Functional-Programmer-Phan-1.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Tro-thanh-Functional-Programmer-Phan-1.html","excerpt":"Viá»‡c sÃ¡ng tá», ngá»™ ra concept cá»§a Functional Programming thÆ°á»ng lÃ  má»™t trong nhá»¯ng bÆ°á»›c phÃ¡t triá»ƒn quan trá»ng nháº¥t trong sá»± nghiá»‡p láº­p trÃ¬nh cá»§a báº¡n, vÃ  Ä‘Ã´i khi cÅ©ng lÃ  bÆ°á»›c khÃ³ khÄƒn nháº¥t. Tuy nhiÃªn chÃºng ta cÃ³ thá»ƒ vÆ°á»£t qua nÃ³ má»™t cÃ¡ch dá»… dÃ ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n. BÃ i viáº¿t sau Ä‘Ã¢y sáº½ hÆ°á»›ng dáº«n má»i ngÆ°á»i Ä‘áº¿n Ä‘Æ°á»£c vá»›i vÃ¹ng chÃ¢n lÃ½ Ä‘Ã³.","text":"Viá»‡c sÃ¡ng tá», ngá»™ ra concept cá»§a Functional Programming thÆ°á»ng lÃ  má»™t trong nhá»¯ng bÆ°á»›c phÃ¡t triá»ƒn quan trá»ng nháº¥t trong sá»± nghiá»‡p láº­p trÃ¬nh cá»§a báº¡n, vÃ  Ä‘Ã´i khi cÅ©ng lÃ  bÆ°á»›c khÃ³ khÄƒn nháº¥t. Tuy nhiÃªn chÃºng ta cÃ³ thá»ƒ vÆ°á»£t qua nÃ³ má»™t cÃ¡ch dá»… dÃ ng vá»›i cÃ¡ch tiáº¿p cáº­n Ä‘Ãºng Ä‘áº¯n. BÃ i viáº¿t sau Ä‘Ã¢y sáº½ hÆ°á»›ng dáº«n má»i ngÆ°á»i Ä‘áº¿n Ä‘Æ°á»£c vá»›i vÃ¹ng chÃ¢n lÃ½ Ä‘Ã³. Báº¯t Ä‘áº§u tá»« viá»‡c há»c lÃ¡i xe Láº§n Ä‘áº§u lÃ¡i xe thÆ°á»ng lÃ  nhá»¯ng ká»‰ niá»‡m Ä‘au thÆ°Æ¡ng vÃ  khá»‘n khá»• nháº¥t cá»§a chÃºng ta. Sáº½ tháº­t dá»… dÃ ng khi nhÃ¬n ngÆ°á»i khÃ¡c lÃ¡i, nhÆ°ng khi thá»±c sá»± Ä‘áº·t tay vÃ o vÃ´-lÄƒng, má»i thá»© bá»—ng trá»Ÿ nÃªn khÃ³ khÄƒn hÆ¡n chÃºng ta tÆ°á»Ÿng. VÃ  chÃºng ta sáº½ pháº£i táº­p luyá»‡n báº±ng xe cá»§a gia Ä‘Ã¬nh cho Ä‘áº¿n khi cÃ³ thá»ƒ lÃ m chá»§ nhá»¯ng Ä‘oáº¡n Ä‘Æ°á»ng xung quanh nhÃ  trÆ°á»›c khi thoÃ¡t xÃ¡c lÃªn cung Ä‘Æ°á»ng cao tá»‘c. NhÆ°ng cuá»‘i cÃ¹ng thÃ¬ thÃ´ng qua quÃ¡ trÃ¬nh luyá»‡n táº­p láº·p Ä‘i láº·p láº¡i vÃ  má»™t sá»‘ khoáº£ng thá»i gian khiáº¿n gia Ä‘Ã¬nh thÃ³t tim, cuá»‘i cÃ¹ng báº¡n cÅ©ng sáº½ há»c Ä‘Æ°á»£c cÃ¡ch lÃ¡i xe vÃ  cÃ³ báº±ng lÃ¡i cho riÃªng mÃ¬nh. Vá»›i táº¥m báº±ng lÃ¡i trong tay, chÃºng ta cÃ³ thá»ƒ lÃ¡i báº¥t cá»© cÃ¡i xe nÃ o náº¿u cÃ³ thá»ƒ ná»• mÃ¡y. VÃ  vá»›i má»—i chuyáº¿n Ä‘i, sá»± tá»± tin, lÃ m chá»§ tay lÃ¡i sáº½ ngÃ y cÃ ng Ä‘Æ°á»£c cá»§ng cá»‘. VÃ  cÅ©ng sáº½ Ä‘áº¿n cÃ¡i ngÃ y chÃºng ta pháº£i lÃ¡i xe cuáº£ ngÆ°á»i khÃ¡c, hay lÃ  pháº£i thay chiáº¿c xe cÃ  tÃ ng báº±ng má»™t chiáº¿c má»›i hiá»‡n Ä‘áº¡i hÆ¡n. Cáº£m xÃºc khi lÃ¡i má»™t chiáº¿c xe khÃ¡c sáº½ nhÆ° tháº¿ nÃ o nhá»‰? Liá»‡u cÃ³ giá»‘ng vá»›i cáº£m xÃºc khi láº§n Ä‘áº§u cháº¡m tay vÃ o vÃ´ lÄƒng? KhÃ´ng háº³n. Láº§n Ä‘áº§u tiÃªn lÃ¡i xe, chÃºng ta hoÃ n toÃ n bá»¡ ngá»¡. Máº·c dÃ¹ trÆ°á»›c Ä‘Ã³ Ä‘Ã£ ngá»“i trÃªn xe nhÆ°ng chÃºng ta chá»‰ cÃ³ vai trÃ² lÃ  hÃ nh khÃ¡ch. CÃ²n láº§u Ä‘áº§u tiÃªn lÃ¡i xe lÃ  khi cÃ³ qtoÃ n quyá»n Ä‘iá»u khiá»ƒn chiáº¿c xe Ä‘Ã³. CÃ²n vá»›i láº§n lÃ¡i chiáº¿c xe thá»© hai trá»Ÿ Ä‘i, chÃºng ta chá»‰ tÃ¬m kiáº¿m cÃ¢u tráº£ lá»i cho nhá»¯ng cÃ¢u há»i Ä‘Æ¡n giáº£n : ChÃ¬a khÃ³a á»Ÿ Ä‘Ã¢u nhá»‰? ÄÃ¨n á»Ÿ Ä‘Ã¢u nhá»‰? Chá»‰nh gÆ°Æ¡ng vá»›i Ä‘Ã¨n chiáº¿u á»Ÿ Ä‘Ã¢u ta? Sau nhá»¯ng tháº¯c máº¯c Ä‘Ã³, má»i thá»© diá»…n ra tháº­t tá»± nhiÃªn nhÆ° nÆ°á»›c cháº£y mÃ¢y trÃ´i, viá»‡c lÃ¡i xe tháº­t dá»… dÃ ng hÆ¡n khÃ´ng biáº¿t bao nhiÃªu láº§n so vá»›i láº§n Ä‘áº§u cáº§m lÃ¡i. NguyÃªn do cho sá»± viá»‡c trÃªn lÃ  chiáº¿c xe má»›i sáº½ váº­n hÃ nh giá»‘ng gáº§n háº¿t chiáº¿c xe cÅ©. Cáº£ 2 chiáº¿c xe Ä‘á»u cÃ³ nhá»¯ng thá»© cÆ¡ báº£n cho viá»‡c lÃ¡i xe, vÃ  cÃ¡c thá»© Ä‘Ã³ háº§u háº¿t Ä‘á»u á»Ÿ cÃ¹ng má»™t vá»‹ trÃ­ Má»™t vÃ i thá»© nho nhá» sáº½ Ä‘Æ°á»£c thay Ä‘á»•i, hoáº·c thÃªm chÃ­ cÃ³ thÃªm vÃ i tÃ­nh nÄƒng má»›i, nhÆ°ng chÃºng ta háº§u háº¿t sáº½ khÃ´ng dÃ¹ng chÃºng vÃ o láº§n Ä‘áº§u tiÃªn, tháº­m chÃ­ láº§n thá»© 2. Dáº§n dáº§n sau cÃ¹ng chÃºng ta má»›i há»c sá»­ dá»¥ng cÃ¡c tÃ­nh nÄƒng má»›i, mÃ  chá»‰ lÃ  cÃ¡c tÃ­nh nÄƒng mÃ  chÃºng ta quan tÃ¢m thÃ´i. Viá»‡c há»c láº­p trÃ¬nh cÅ©ng tÆ°Æ¡ng tá»± nhÆ° há»c lÃ¡i xe váº­y. Láº§n Ä‘áº§u tiÃªn bao giá» cÅ©ng lÃ  láº§n khÃ³ khÄƒn nháº¥t. NhÆ°ng khi báº¡n Ä‘Ã£ quen rá»“i, thÃ¬ nhá»¯ng láº§n sau sáº½ trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n ráº¥t nhiá»u. Má»—i khi báº¡n báº¯t Ä‘áº§u viá»‡c há»c má»™t ngÃ´n ngá»¯ má»›i, sáº½ cÃ³ má»™t sá»‘ cÃ¢u há»i báº¡n sáº½ thÆ°á»ng tá»± há»i mÃ¬nh nhÆ° lÃ  : LÃ m tháº¿ nÃ o Ä‘á»ƒ táº¡o má»™t module? LÃ m tháº¿ nÃ o Ä‘á»ƒ tÃ¬m kiáº¿m trong 1 máº£ng? Tham sá»‘ cho hÃ m thay tháº¿ chuá»—i lÃ  gÃ¬? Báº¡n hoÃ n toÃ n tá»± tin ráº±ng mÃ¬nh sáº½ sá»­ Ä‘á»¥ng Ä‘Æ°á»£c ngÃ´n ngá»¯ má»›i nÃ y, bá»Ÿi vÃ¬ nÃ³ gá»£i nhá»› láº¡i cho báº¡n nhá»¯ng ká»‰ niá»‡m, hiá»ƒu biáº¿t vá»›i ngÃ´n ngá»¯ cÅ©, cÃ¹ng vá»›i má»™t vÃ i Ä‘iá»u má»›i máº» vá»›i hy vá»ng ráº±ng lÃ m cho cuá»™c Ä‘á»i cá»§a báº¡n trá»Ÿ nÃªn Ä‘áº¹p Ä‘áº½ hÆ¡n. Äáº¿n con tÃ u vÅ© trá»¥ Ä‘áº§u tiÃªn Giá» hÃ£y thá»­ tÆ°á»Ÿng tÆ°á»£ng ráº±ng báº¡n Ä‘Ã£ lÃ¡i hÃ ng tÃ¡ xe Ã´ tÃ´ trong cuá»™c Ä‘á»i, rá»“i Ä‘áº¿n má»™t ngÃ y báº¡n Ä‘Æ°á»£c Ä‘áº·t vÃ o khoang Ä‘iá»u khiá»ƒn cá»§a má»™t chiáº¿c TÃ u khÃ´ng gian. LÃºc nÃ y báº¡n bá»—ng trá»Ÿ nÃªn hoang mang, khÃ´ng biáº¿t ráº±ng liá»‡u nhá»¯ng kinh nghiá»‡m lÃ¡i xe cÃ³ giÃºp Ã­ch Ä‘Æ°á»£c gÃ¬ cho mÃ¬nh khÃ´ng. Báº¡n cáº£m giÃ¡c nhÆ° mÃ¬nh Ä‘ang báº¯t Ä‘áº§u láº¡i tá»« con sá»‘ 0 trÃ²n trÄ©nh. (ChÃºng ta lÃ  láº­p trÃ¬nh viÃªn, chÃºng ta Ä‘áº¿m tá»« sá»‘ 0) Báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u viá»‡c luyá»‡n táº­p vá»›i cáº£m giÃ¡c ráº±ng má»i thá»© sáº½ trá»Ÿ nÃªn ráº¥t khÃ¡c á»Ÿ trong khÃ´ng gian, vÃ  cÃ¡ch váº­n hÃ nh con tÃ u khÃ¡c hoÃ n toÃ n nÃ y sáº½ ráº¥t khÃ¡c so vá»›i viá»‡c lÃ¡i xe trÃªn máº·t Ä‘áº¥t. Tuy nhiÃªn thÃ¬ cÃ¡c Ä‘á»‹nh luáº­t váº­t lÃ½ Ä‘á»u khÃ´ng thay Ä‘á»•i. Chá»‰ khÃ¡c á»Ÿ chá»— cÃ¡ch báº¡n di chuyá»ƒn trong cÃ¹ng má»™t vÅ© trá»¥ mÃ  thÃ´i. VÃ  vá»›i viá»‡c há»c Functional Programming (láº­p trÃ¬nh hÃ m) cÅ©ng tÆ°Æ¡ng tá»± nhÆ° váº­y. Báº¡n dá»± Ä‘oÃ¡n, cáº£m giÃ¡c ráº±ng má»i thá»© sáº½ ráº¥t khÃ¡c. KhÃ¡c Ä‘áº¿n ná»—i mÃ  khiáº¿n cho nhá»¯ng kinh nghiá»‡m, kiáº¿n thá»©c Ä‘Ã£ tá»«ng cÃ³ Ä‘Æ°á»£c sáº½ bá»‹ xÃ³a sá»•, khÃ´ng quay láº¡i Ä‘Æ°á»£c nhÆ° xÆ°a ná»¯a. VÃ  má»i thá»© sáº½ Ä‘Æ°á»£c má»Ÿ Ä‘áº§u báº±ng cÃ¢u nÃ³i kinh Ä‘iá»ƒn dÆ°á»›i Ä‘Ã¢y. QuÃªn táº¥t cáº£ nhá»¯ng thá»© Ä‘Ã£ biáº¿tMá»i ngÆ°á»i ráº¥t thÃ­ch cÃ¢u nÃ³i sau Ä‘Ã¢y, vÃ  nÃ³ cÅ©ng khÃ¡ Ä‘Ãºng trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p: Há»c láº­p trÃ¬nh hÃ m (FP) cÅ©ng giá»‘ng nhÆ° báº¯t Ä‘áº§u láº¡i má»i thá»© váº­y. KhÃ´ng hoÃ n toÃ n lÃ  nhÆ° váº­y, nhÆ°ng Ä‘Ã³ lÃ  má»™t suy nghÄ© khÃ¡ hiá»‡u quáº£ khi tiáº¿p xÃºc vá»›i FP. CÃ³ ráº¥t nhiá»u concepts giá»‘ng nhau giá»¯a láº­p trÃ¬nh mÃ  báº¡n Ä‘Ã£ biáº¿t vÃ  FP, nhÆ°ng viá»‡c tiáº¿p cáº­n FP vá»›i tÆ° tÆ°á»Ÿng ráº±ng mÃ¬nh sáº½ pháº£i há»c láº¡i táº¥t cáº£ má»i thá»© thÆ°á»ng tá» ra hiá»‡u quáº£ nháº¥t. Vá»›i cÃ¡ch tiáº¿p cáº­n chÃ­nh xÃ¡c, báº¡n sáº½ cÃ³ nhá»¯ng tÆ° tÆ°á»Ÿng, suy nghÄ© Ä‘Ãºng Ä‘áº¯n, lÃ  nhá»¯ng thá»© sáº½ giÃºp báº¡n khÃ´ng bá» cuá»™c khi viá»‡c há»c hÃ nh trá»Ÿ nÃªn khÃ³ khÄƒn. Báº¡n sáº½ pháº£i xÃ¡c Ä‘á»‹nh ráº±ng cÃ³ ráº¥t nhiá»u thá»© mÃ  báº¡n Ä‘Ã£ tá»«ng há»c vÃ  lÃ m quen trÃªn con Ä‘Æ°á»ng lÃ m lÃ¢p trÃ¬nh viÃªn tá»« trÆ°á»›c Ä‘áº¿n giá», khi Ä‘áº¿n vá»›i FP, sáº½ biáº¿n máº¥t hoáº·c khÃ´ng thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c ná»¯a. LiÃªn há»‡ vá»›i viá»‡c lÃ¡i xe, báº¡n cÃ³ thá»ƒ quen vá»›i viá»‡c dÃ¹ng sá»‘ lÃ¹i Ä‘á»ƒ Ä‘áº­u xe. Tuy nhiÃªn má»™t con tÃ¹a khÃ´ng gian sáº½ khÃ´ng cÃ³ sá»‘ lÃ¹i. CÃ³ thá»ƒ báº¡n sáº½ nghÄ© ráº±ng : CÃI GÃŒ CÆ ? KHÃ”NG CÃ“ Sá» LÃ™i!?! TÃ”I LÃI TÃ€U THáº¾ QUÃI NÃ€O KHI KHÃ”NG CÃ“ Sá» LÃ™I BÃ‚Y GIá»œ?! Thá»±c táº¿ lÃ  tÃ u khÃ´ng gian cÃ³ thá»ƒ di chuyá»ƒn trong khÃ´ng gian 3 chiá»u (Ã´ tÃ´ lÃ  2 chiá»u), nÃªn sáº½ khÃ´ng cáº§n sá»‘ lÃ¹i. Khi báº¡n náº¯m rÃµ cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a tÃ u khÃ´ng gian, báº¡n sáº½ khÃ´ng cáº§n pháº£i sá»­ dá»¥ng sá»‘ lÃ¹i thÃªm má»™t láº§n nÃ o ná»¯a. VÃ  rá»“i báº¡n sáº½ tháº¥y ráº±ng máº¥y cÃ¡i xe tháº­t lÃ  cÃ¹i =)) Vá»›i FP cÅ©ng váº­y, tuy nhiÃªn: Há»c FP sáº½ máº¥t thá»i gian. VÃ¬ tháº¿ hÃ£y kiÃªn nháº«n VÃ  giá» chÃºng ta cÃ¹ng Ä‘áº¿n vá»›i miá»n Ä‘áº¥t há»©a cá»§a Functional Programming, bá» qua vÃ¹ng Ä‘áº¥t láº¡nh láº½o, nhÃ m chÃ¡n cá»§a Imperative Programming Ä‘Ã£ quÃ¡ quen thuá»™c. Nhá»¯ng gÃ¬ dÆ°á»£c viÃªt tiáº¿p theo Ä‘Ã¢y lÃ  má»™t series bÃ i viáº¿t giá»›i thiá»‡u cÃ¡c Concepts cá»§a FP vá»›i má»¥c Ä‘Ã­ch giÃºp ngÆ°á»i Ä‘á»c lÃ m quen trÆ°á»›c khi Ä‘i vÃ o báº¥t kÃ¬ ngÃ´n ngá»¯ láº­p trÃ¬nh FP nÃ o. Hoáº·c náº¿u báº¡n Ä‘Ã£ sá»­ dá»¥ng FP rá»“i, thÃ¬ Ä‘Ã¢y sáº½ lÃ  bÃ i viáº¿t giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n nhá»¯ng viá»‡c mÃ¬nh Ä‘ang lÃ m . VÃ  mong cÃ¡c báº¡n khÃ´ng vá»™i vÃ ng. HÃ£y dÃ nh thá»i gian Ä‘á»c nhá»¯ng gÃ¬ tÃ´i sáº¯p viáº¿t sau Ä‘Ã¢y, cÅ©ng nhÆ° dÃ nh thá»i gian Ä‘á»ƒ hiá»ƒu nhá»¯ng Ä‘oáº¡n code vÃ­ dá»¥. Báº¡n cÃ³ thá»ƒ táº¡m dá»«ng sau má»—i Ä‘oáº¡n Ä‘á»ƒ kiáº¿n thá»©c ngáº¥m hoÃ n toÃ n vÃ o ngÆ°á»i, sau Ä‘Ã³ hÃ£y quay láº¡i vÃ  tiáº¿p tá»¥c. Äiá»u quan trá»ng nháº¥t lÃ  kiáº¿n thá»©c cá»§a báº¡n. Concept 1: Purity - Sá»± thuáº§n khiáº¿t Khi nhá»¯ng láº­p trÃ¬nh viÃªn FP nÃ³i vá» Purity, Ä‘Ã³ lÃ  khi há» muá»‘n Ä‘á» cáº­p Ä‘áº¿n Pure Function . Pure Function lÃ  nhá»¯ng hÃ m háº¿t sá»©c Ä‘Æ¡n giáº£n, chá»‰ thao tÃ¡c dá»±a trÃªn tham sá»‘ Ä‘áº§u vÃ o. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» má»™t hÃ m Ä‘Æ°á»£c gá»i lÃ  Pure trong Javascript : 1234var z = 10;function add(x, y) &#123; return x + y;&#125; Báº¡n cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng hÃ m add khÃ´ng há» Ä‘á»¥ng vÃ o biáº¿n z. HÃ m Ä‘Ã³ khÃ´ng Ä‘á»c giÃ¡ trá»‹ cá»§a biáº¿n z, cÅ©ng nhÆ° khÃ´ng thay Ä‘á»•i giÃ¡ trá»‹ biáº¿n z. NÃ³ chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘á»c 2 tham sá»‘ x vÃ  y, lÃ  2 tham sá»‘ Ä‘áº§u vÃ o, rá»“i tráº£ vá» giÃ¡ trá»‹ lÃ  tá»•ng cá»§a 2 tham sá»‘ Ä‘Ã³. HÃ m add, vÃ¬ lÃ½ do Ä‘Ã³, Ä‘Æ°á»£c gá»i lÃ  Pure Function. Náº¿u hÃ m add cÃ³ báº¥t ká»³ xá»­ lÃ½ nÃ o liÃªn quan Ä‘áº¿n biáº¿n z, hÃ m Ä‘Ã³ sáº½ khÃ´ng cÃ²n lÃ  pure ná»¯a. ChÃºng ta cÃ¹ng tham kháº£o má»™t hÃ m khÃ¡c: 123function justTen() &#123; return 10;&#125; Náº¿u hÃ m justTen lÃ  pure, thÃ¬ nÃ³ chá»‰ cÃ³ thá»ƒ tráº£ vá» má»™t giÃ¡ trá»‹ duy nháº¥t, cá»‘ Ä‘á»‹nh. NguyÃªn nhÃ¢n lÃ  vÃ¬ hÃ m nÃ y khÃ´ng cÃ³ báº¥t kÃ¬ má»™t tham sá»‘ nÃ o. VÃ  Ä‘á»ƒ Ä‘áº£m báº£o nÃ³ lÃ  pure function, hÃ m nÃ y sáº½ khÃ´ng thá»ƒ truy cáº­p báº¥t kÃ¬ giÃ¡ trá»‹ nÃ o ngoÃ i cÃ¡c tham sá»‘ cá»§a nÃ³. á» Ä‘Ã¢y khÃ´ng cÃ³ tham sá»‘ nÃ o, nÃªn giÃ¡ trá»‹ tráº£ vá» cá»§a hÃ m nÃ y lÃºc nÃ o cÅ©ng lÃ  má»™t giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh. VÃ  pure function mÃ  khÃ´ng cÃ³ tham sá»‘ nÃ o Ä‘á»ƒ thá»±c hiá»‡n thÃ¬ cÃ³ váº» hÆ¡i vÃ´ nghÄ©a, vÃ  chÃºng ta nÃªn thay tháº¿ hÃ m justTen báº±ng má»™t háº±ng sá»‘ (constant) thÃ¬ tá»‘t hÆ¡n. Háº§u háº¿t cÃ¡c Pure Function Ä‘á»u cÃ³ Ã­t nháº¥t má»™t tham sá»‘. Tiáº¿p theo chÃºng ta Ä‘áº¿n vá»›i má»™t hÃ m khÃ¡c: 123function addNoReturn(x, y) &#123; var z = x + y&#125; Dá»… dÃ ng nháº­n tháº¥y ráº±ng hÃ m addNoReturn khÃ´ng cÃ³ giÃ¡ trá»‹ tráº£ vá». HÃ m nÃ y chá»‰ Ä‘Æ¡n giáº£n lÃ  xá»­ lÃ½ viá»‡c cá»™ng 2 tham sá»‘ x vÃ  y rá»“i lÆ°u vÃ o biáº¿n z, nhÆ°ng khÃ´ng tráº£ vá» giÃ¡ trá»‹ tÃ´ng.ÄÃ¢y máº·c dÃ¹ váº«n lÃ  má»™t pure function khi nÃ³ chá»‰ xá»­ lÃ½ cÃ¡c tham sá»‘ cá»§a chÃ­nh mÃ¬nh. NÃ³ thá»±c hiá»‡n viá»‡c cá»™ng 2 input, nhÆ°ng vÃ¬ khÃ´ng tráº£ vá» báº¥t cá»© giÃ¡ trá»‹ gÃ¬, nÃªn nÃ³ vÃ´ dá»¥ng (vÃ¬ chÃºng ta khÃ´ng cÃ³ cÃ¡ch nÃ o láº¥y Ä‘Æ°á»£c giÃ¡ trá»‹ Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½). Má»™t Pure Function chá»‰ cÃ³ giÃ¡ trá»‹ sá»­ dá»¥ng khi cÃ³ giÃ¡ trá»‹ tráº£ vá». VÃ  giá» chÃºng ta quay láº¡i hÃ m add lÃºc Ä‘áº§u má»™t láº§n ná»¯a : 123456function add(x, y) &#123; return x + y;&#125;console.log(add(1, 2)); // prints 3console.log(add(1, 2)); // still prints 3console.log(add(1, 2)); // WILL ALWAYS print 3 CÃ³ thá»ƒ tháº¥y ráº±ng viá»‡c thá»±c hiá»‡n add(1,2) luÃ´n tráº£ vá» giÃ¡ trá»‹ 3. KhÃ´ng pháº£i lÃ  má»™t Ä‘iá»u gÃ¬ quÃ¡ ngáº¡c nhiÃªn, nhÆ°ng Ä‘iá»u nÃ y chá»‰ cÃ³ thá»ƒ thá»±c hiá»‡n náº¿u hÃ m Ä‘Ã³ lÃ  pure function. Náº¿u hÃ m add sá»­ dá»¥ng báº¥t kÃ¬ má»™t biáº¿n nÃ o á»Ÿ bÃªn ngoÃ i, thÃ¬ báº¡n sáº½ khÃ´ng bao giá» dá»± Ä‘oÃ¡n Ä‘Æ°á»£c káº¿t quáº£ tráº£ vá» Pure Function sáº½ luÃ´n tráº£ vá» cÃ¹ng output vá»›i cÃ¹ng input, báº¥t ká»ƒ cÃ³ thá»±c hiá»‡n bao nhiÃªu láº§n. VÃ¬ pure function sáº½ khÃ´ng tÃ¡c Ä‘á»™ng Ä‘áº¿n cÃ¡c biáº¿n náº±m ngoÃ i chÃºng, nÃªn cÃ¡c hÃ m sau sáº½ Ä‘Æ°á»£c coi lÃ  impure (khÃ´ng thuáº§n khiáº¿t =)) ): 1234writeFile(fileName);updateDatabaseTable(sqlCmd);sendAjaxRequest(ajaxRequest);openSocket(ipAddress); Táº¥t cáº£ cÃ¡c hÃ m nÃ y Ä‘á»u cÃ³ má»™t Ä‘áº·c tÃ­nh chung Ä‘Æ°á»£c gá»i lÃ  Side Effects (tÃ¡c dá»¥ng phá»¥). Khi báº¡n gá»i vÃ  thá»±c thi chÃºng, cÃ¡c hÃ m nÃ y sáº½ thay Ä‘á»•i file, cáº­p nháº­t cÆ¡ sá»­ dá»¯ liá»‡u, gá»­i data vá» phÃ­a server hoáº·c gá»i há»‡ Ä‘iá»u hÃ nh Ä‘á»ƒ láº¥y socket. ChÃºng lÃ m nhiá»u thá»© hÆ¡n lÃ  chá»‰ thao tÃ¡c vá»›i tham sá»‘ Ä‘áº§u vÃ o vÃ  tráº£ vá» output. VÃ¬ tháº¿, báº¡n cÃ³ thá»ƒ khÃ´ng bao giá» dá»± Ä‘oÃ¡n Ä‘Æ°á»£c giÃ¡ trá»‹ mÃ  nhá»¯ng hÃ m nÃ y sáº½ tráº£ vá». Pure Function Ä‘áº£m báº£o viá»‡c hÃ m sáº½ khÃ´ng cÃ³ Side Effects. Trong cÃ¡c ngÃ´n ngá»¯ Imperative Language nhÆ° lÃ  Javascript, Java, hay C#, Side Effects xuáº¥t hiá»‡n á»Ÿ kháº¯p má»i nÆ¡i. Äiá»u nÃ y khiáº¿n cho viá»‡c debug ráº¥t khÃ³ vÃ¬ biáº¿n cÃ³ thá»ƒ Ä‘Æ°á»£c thay Ä‘á»•i á»Ÿ báº¥t ká»³ Ä‘Ã¢u trong chÆ°Æ¡ng trÃ¬nh. VÃ¬ tháº¿ khi cÃ³ má»™t lá»—i xáº£y ra do má»™t biáº¿n thay Ä‘á»•i thÃ nh giÃ¡ trá»‹ khÃ´ng muá»‘n muá»‘n, báº¡n sáº½ pháº£i tÃ¬m á»Ÿ Ä‘Ã¢u? Kháº¯p má»i ngÃ³c ngÃ¡ch? Äiá»u Ä‘Ã³ tháº­t khÃ´ng tá»‘t chÃºt nÃ o. Äáº¿n Ä‘Ã¢y, cÃ³ thá»ƒ báº¡n sáº½ tháº¯c máº¯c ráº±ng: Váº¬Y LÃ€M THáº¾ QUÃI NÃ€O MÃ€ TÃ”I CÃ“ THá»‚ LÃ€M VIá»†C CHá»ˆ Vá»šI PURE FUNCTION CHá»¨?! Trong FP, Pure Function khÃ´ng pháº£i lÃ  thá»© duy nháº¥t mÃ  báº¡n sáº½ vieests. FP khÃ´ng thá»ƒ loáº¡i trá»« hoÃ n toÃ n Side Effects, mÃ  chá»‰ cÃ³ thá»ƒ cÃ´ láº­p chÃºng. VÃ¬ cÃ¡c pháº§n má»m pháº£i giao tiáº¿p, thao tÃ¡c vá»›i tháº¿ giá»›i thá»±c, nÃªn má»™t sá»‘ thÃ nh pháº§n báº¯t buá»™c pháº£i impure. Má»¥c tiÃªu cá»§a FP lÃ  tá»‘i thiá»ƒu hÃ³a háº¿t má»©c cÃ³ thá»ƒ sá»‘ lÆ°á»£ng impure code vÃ  tÃ¡ch biá»‡t chÃºng hoÃ n toÃ n khá»i cÃ¡c pháº§n khÃ¡c cá»§a chÆ°Æ¡ng trÃ¬nh. Concept 2 - Immutability : Sá»± báº¥t biáº¿n Báº¡n cÃ²n nhá»› láº§n Ä‘áº§u nhÃ¬n tháº¥y dÃ²ng code kiá»ƒu nhÆ° nÃ y chá»© : 12var x = 1;x = x + 1; Khi Ä‘Ã³, háº³n lÃ  ngÆ°á»i nÃ o Ä‘Ã³ dáº¡y báº¡n lÃ¢p trÃ¬nh Ä‘Ã£ nÃ³i ráº±ng : HÃ£y quÃªn nhá»¯ng gÃ¬ Ä‘Ã£ há»c á»Ÿ mÃ´n ToÃ¡n Ä‘i? VÃ¬ trong toÃ¡n há»c, x khÃ´ng bao giá» báº±ng x+1 Ä‘Æ°á»£c cáº£ NhÆ°ng trong cÃ¡c ngá»—n ngá»¯ Imperative Programming, cÃ¡c cÃ¢u lá»‡nh trÃªn cÃ³ nghÄ©a lÃ , láº¥y giÃ¡ trá»‹ hiá»‡n táº¡i cá»§a biáº¿n x, cá»™ng nÃ³ thÃªm 1 vÃ  gÃ¡n káº¿t quáº£ tráº£ vá» vÃ o láº¡i biáº¿n x. Tuy nhiÃªn sang Ä‘áº¿n FP, x = x + 1 láº¡i trá»Ÿ thÃ nh khÃ´ng Ä‘Ãºng, khÃ´ng Ä‘Æ°á»£c phÃ©p. VÃ  báº¡n sáº½ pháº£i nhá»› láº¡i nhá»¯ng gÃ¬ mÃ  báº¡n Ä‘Ã£ bá»‹ báº¯t pháº£i quÃªn trÆ°á»›c Ä‘Ã³ vá» toÃ¡n há»c. Hmmâ€¦ Trong Functional Programming khÃ´ng cÃ³ khÃ¡i niá»‡m vá» biáº¿n (variable) Äá»ƒ lÆ°u trá»¯ cÃ¡c giÃ¡ trá»‹, khÃ¡i niá»‡m biáº¿n (variable) váº«n Ä‘Æ°á»£c sá»­ dá»¥ng, nhÆ°ng cÃ¡c biáº¿n nÃ y Ä‘á»u lÃ  háº±ng sá»‘ (constant), tá»©c lÃ  náº¿u biáº¿n x Ä‘Ã£ lÆ°u má»™t giÃ¡ trá»‹ nÃ o Ä‘Ã³ (lÃ  1 cháº³ng háº¡n), thÃ¬ giÃ¡ trá»‹ cá»§a biáº¿n x sáº½ khÃ´ng thay Ä‘á»•i, váº«n giá»¯ nguyÃªn lÃ  1 nhÆ° ban Ä‘áº§u Ä‘Æ°á»£c set (vÃ  chÃºng ta gá»i lÃ  biáº¿n háº±ng sá»‘ - constant variable) Náº¿u báº¡n Ä‘ang lo láº¯ng vá» bá»™ nhá»›, thÃ¬ báº¡n cÃ³ thá»ƒ an tÃ¢m khi trong FP, x thÆ°á»ng chá»‰ lÃ  biáº¿n cá»¥c nÃªn thá»i gian tá»“n táº¡i thÆ°á»ng ráº¥t ngáº¯n. Tuy nhiÃªn trong suá»‘t thá»i gian tá»“n táº¡i, giÃ¡ chá»‹ cá»§a x lÃ  báº¥t biáº¿n. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» biáº¿n háº±ng sá»‘ trong Elm, má»™t ngÃ´n ngá»¯ thuáº§n FP cho láº­p trÃ¬nh Web: 12345addOneToSum y z = let x = 1 in x + y + z Náº¿u báº¡n khÃ´ng quen vá»›i syntax dáº¡ng ML-Style , hÃ£y Ä‘á»ƒ tÃ´i giáº£i thÃ­ch. HÃ m addOneToSum nháº­n 2 tham sá»‘ lÃ  y vÃ  z. Trong block cá»§a let, biáº¿n x Ä‘Æ°á»£c gÃ¡n vá»›i giÃ¡ trá»‹ 1, tá»©c lÃ  x sáº½ giá»¯ giÃ¡ trá»‹ Ä‘Ã³ trong suá»‘t pháº§n Ä‘á»i cá»§a nÃ³. VÃ²ng Ä‘á»i cá»§a x sáº½ káº¿t thÃºc khi hÃ m káº¿t thÃºc cháº¡y, cá»¥ thá»ƒ hÆ¡n lÃ  sau khi block let Ä‘Æ°á»£c thá»±c hiá»‡n. BÃªn trong block in, cÃ¡c dÃ²ng lá»‡nh cÃ³ thá»ƒ chá»©a vÃ  tham chiáº¿u Ä‘áº¿n cÃ¡c giÃ¡ trá»‹ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÃ´ng pháº§n block let, á»Ÿ Ä‘Ã¢y lÃ  x. Káº¿t quáº£ cá»§a viá»‡c tÃ­nh toÃ¡n x + y + z Ä‘Æ°á»£c xá»­ lÃ½ vÃ  tráº£ vá», cá»¥ thá»ƒ hÆ¡n á»Ÿ Ä‘Ã¢y lÃ  1 + y + z sáº½ Ä‘Æ°á»£c tÃ­nh toÃ¡n tráº£ vá», vÃ¬ x = 1. VÃ  báº¡n cÃ³ thá»ƒ tháº¥y bá»‘i rá»‘i mÃ  tháº¯c máº¯c ráº±ng : TÃ”I LÃ€M TRÃŒNH KIá»‚U MÃ‰O GÃŒ KHI MÃ€ KHÃ”NG CÃ“ BIáº¾N Sá» ÄÃ‚Y?! HÃ£y bÃ¬nh tÄ©nh vÃ  nghÄ© Ä‘áº¿n thá»i Ä‘iá»ƒm mÃ  báº¡n muá»‘n thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n sá»‘. Sáº½ cÃ³ 2 trÆ°á»ng há»£p cÆ¡ báº£n nháº£y ra trong Ä‘áº§u báº¡n : Thay Ä‘á»•i biáº¿n sá»‘ chá»©a nhiá»u giÃ¡ trá»‹ (vd nhÆ° thay Ä‘á»•i má»™t/nhiá»u thuá»™c tÃ­nh cá»§a má»™t Ä‘á»‘i tÆ°á»£ng hoáº·c báº£n ghi) vÃ  thay Ä‘á»•i biáº¿n sá»‘ chá»©a má»™t giÃ¡ trá»‹ (vd nhÆ° bá»™ Ä‘áº¿m trong vÃ²ng láº·p). FP xá»­ lÃ½ viá»‡c thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ trong má»™t báº£n ghi báº±ng cÃ¡ch táº¡o ra má»™t báº£n sao cá»§a báº£n ghi vá»›i dá»¯ liá»‡u Ä‘Æ°á»£c cáº­p nháº­t. FP xá»­ lÃ½ trÆ°á»ng há»£p thay Ä‘á»•i giÃ¡ trá»‹ nÃ y báº±ng cÃ¡ch: khÃ´ng copy láº¡i táº¥t cáº£ cÃ¡c thÃ nh pháº§n cá»§a báº£n ghi, mÃ  sá»­ dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u Ä‘á»ƒ thá»±c hiá»‡n viá»‡c nÃ y má»™t cÃ¡ch hiá»‡u quáº£ nháº¥t. Vá» viá»‡c xá»­ lÃ½ trÆ°á»ng há»£p thay Ä‘á»•i biáº¿n sá»‘ chá»©a má»™t giÃ¡ trá»‹, FP cÅ©ng lÃ m tÆ°Æ¡ng tá»± nhÆ° trÃªn, cÅ©ng báº±ng cÃ¡ch táº¡o ra má»™t báº£n sao cá»§a biáº¿n sá»‘ Ä‘Ã³. VÃ  sáº½ KHÃ”NG cÃ³ vÃ²ng láº·p trong FP Ä‘Ã¢u. Äáº¦U TIÃŠN THÃŒ KHÃ”NG CÃ“ BIáº¾N, VÃ€ GIá»œ THÃŒ KHÃ”NG CÃ“ VÃ’NG Láº¶P?! GHÃ‰T Rá»’I Äáº¤Y BÃ¬nh tÃ¬nh nÃ o. KhÃ´ng pháº£i lÃ  chÃºng ta khÃ´ng thá»ƒ táº¡o ra cÃ¡c vÃ²ng láº·p trong FP (tÃ´i khÃ´ng chÆ¡i chá»¯ Ä‘Ã¢u nhÃ©), mÃ  chá»‰ Ä‘Æ¡n giáº£n lÃ  chÃºng ta sáº½ khÃ´ng cÃ³ cÃ¡c cáº¥u trÃºc láº·p nhÆ° lÃ  for, while, do, repeat, â€¦ thÃ´i. Functional Programming sá»­ dá»¥ng Ä‘á»‡ quy cho viá»‡c láº·p. DÆ°á»›i Ä‘Ã¢y lÃ  2 cÃ¡ch thá»±c hiá»‡n vÃ²ng láº·p trong Javascript: 123456789101112// simple loop constructvar acc = 0;for (var i = 1; i &lt;= 10; ++i) acc += i;console.log(acc); // prints 55// without loop construct or variables (recursion)function sumRange(start, end, acc) &#123; if (start &gt; end) return acc; return sumRange(start + 1, end, acc + start)&#125;console.log(sumRange(1, 10, 0)); // prints 55 Báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng, báº±ng viá»‡c sá»­ dá»¥ng Ä‘á»‡ quy, chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c Ä‘Ãºng nhÆ° nhá»¯ng gÃ¬ mÃ  vÃ²ng láº·p for phÃ­a trÃªn Ä‘Ã£ thá»±c hiá»‡n. Vá»›i viá»‡c sá»­ dá»¥ng hÃ m sumRange gá»i láº¡i chÃ­nh nÃ³ sau má»—i láº§n cháº¡y vá»›i tham sá»‘ start má»›i (start + 1) vÃ  tham sá»‘ acc má»›i (acc + start). HÃ m nÃ y khÃ´ng há» thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ má»›i. Thay vÃ o Ä‘Ã³ nÃ³ sá»­ dá»¥ng cÃ¡c giÃ¡ trá»‹ má»›i Ä‘Æ°á»£c tÃ­nh toÃ¡n tá»« cÃ¡c giÃ¡ trá»‹ cÅ©. Tháº­t khÃ´ng may, viá»‡c nÃ y khÃ¡ lÃ  khÃ³ Ä‘á»ƒ cÃ³ thá»ƒ nhÃ¬n tháº¥y rÃµ rÃ ng trong Javascript, ká»ƒ cáº£ báº¡n Ä‘Ã£ bá» ra chÃºt thá»i gian Ä‘á»ƒ nghiÃªn cá»©u vá» nÃ³, bá»Ÿi 2 lÃ½ do sau Ä‘Ã¢y. Thá»© nháº¥t lÃ  do syntax trong Javascript khÃ¡ lÃ  khÃ³ nhÃ¬n vÃ  thá»© hai, lÃ  báº¡n cÃ³ thá»ƒ khÃ´ng quen vá»›i tÆ° duy suy nghÄ© theo Ä‘á»‡ quy. Náº¿u sá»­ dá»¥ng Elm, viá»‡c Ä‘á»c sáº½ trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n, vÃ  do Ä‘Ã³, dá»… hiá»ƒu hÆ¡n Ä‘á»‘i vá»›i báº¡n: 12345sumRange start end acc = if start &gt; end then acc else sumRange (start + 1) end (acc + start) ÄÃ¢y lÃ  káº¿t quáº£ Ä‘oáº¡n code trÃªn thá»±c hiá»‡n: 123456789101112sumRange 1 10 0 = -- sumRange (1 + 1) 10 (0 + 1)sumRange 2 10 1 = -- sumRange (2 + 1) 10 (1 + 2)sumRange 3 10 3 = -- sumRange (3 + 1) 10 (3 + 3)sumRange 4 10 6 = -- sumRange (4 + 1) 10 (6 + 4)sumRange 5 10 10 = -- sumRange (5 + 1) 10 (10 + 5)sumRange 6 10 15 = -- sumRange (6 + 1) 10 (15 + 6)sumRange 7 10 21 = -- sumRange (7 + 1) 10 (21 + 7)sumRange 8 10 28 = -- sumRange (8 + 1) 10 (28 + 8)sumRange 9 10 36 = -- sumRange (9 + 1) 10 (36 + 9)sumRange 10 10 45 = -- sumRange (10 + 1) 10 (45 + 10)sumRange 11 10 55 = -- 11 &gt; 10 =&gt; 5555 Báº¡n cÃ³ thá»ƒ cho ráº±ng vÃ²ng láº·p for sáº½ dá»… hiá»ƒu hÆ¡n. Trong khi váº¥n Ä‘á» nÃ y váº«n Ä‘ang Ä‘Æ°á»£c tranh cÃ£i khÃ¡ lÃ  nhiá»u, mÃ  cÃ³ thá»ƒ nguyÃªn nhÃ¢n chá»§ yáº¿u lÃ  do sá»± quen thuá»™c, thÃ¬ cÃ³ má»™t sá»± tháº­t lÃ  cÃ¡c vÃ²ng láº·p for cáº§n Ä‘áº¿n kháº£ nÄƒng biáº¿n Ä‘á»•i cá»§a hÃ m sá»‘, mÃ  Ä‘iá»u nÃ y Ä‘Æ°á»£c cho lÃ  khÃ´ng tá»‘t trong FP. TÃ´i sáº½ khÃ´ng giáº£i thÃ­ch chi tiáº¿t nhá»¯ng lá»£i Ã­t cá»§a tÃ­nh báº¥t biáº¿n trong bÃ i viáº¿t nÃ y, nhÆ°ng báº¡n cÃ³ thá»ƒ xem pháº§n Global Mutate State trong bÃ i viáº¿t VÃ¬ sao Láº­p trÃ¬nh viÃªn cáº§n cÃ³ giá»›i háº¡n Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t. Má»™t lá»£i Ã­ch rÃµ rÃ ng cá»§a tÃ­nh báº¥t biáº¿n, Ä‘Ã³ lÃ  náº¿u báº¡n pháº£i truy cáº­p Ä‘áº¿n má»™t giÃ¡ trá»‹ báº¥t ká»³ trong chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n, báº¡n chá»‰ cÃ³ thá»ƒ cÃ³ quyá»n Ä‘á»c nÃ³, vÃ  Ä‘iá»u Ä‘Ã³ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c khÃ´ng ai cÃ³ thá»ƒ thay Ä‘á»•i giÃ¡ trá»‹ cá»§a nÃ³. Ká»ƒ cáº£ chÃ­nh báº¡n. VÃ  do Ä‘Ã³ sáº½ trÃ¡nh Ä‘Æ°á»£c nhá»¯ng thay Ä‘á»•i khÃ´ng mong muá»‘n. VÃ  náº¿u chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n há»— trá»£ Ä‘a luá»“ng (multi-threaded), thÃ¬ sáº½ khÃ´ng cÃ³ báº¥t ká»³ má»™t thread nÃ o cÃ³ thá»ƒ khiáº¿n báº¡n Ä‘au Ä‘áº§u. GiÃ¡ trá»‹ Ä‘Æ°á»£c set sáº½ lÃ  háº±ng sá»‘, vÃ  náº¿u báº¥t kÃ¬ má»™t thread nÃ o muá»‘n thay Ä‘á»•i nÃ³, thread Ä‘Ã³ sáº½ pháº£i táº¡o má»™t giÃ¡ trá»‹ má»›i tá»« cÃ¡i cÅ©. Quay trá»Ÿ láº¡i nhá»¯ng nÄƒm 90, tÃ´i Ä‘Ã£ tá»«ng viáº¿t má»™t Game Engine cho trÃ² chÆ¡i Creature Crunch , vÃ  nguyÃªn nhÃ¢n gÃ¢y ra nhiá»u bug nháº¥t chÃ­nh lÃ  cÃ¡c váº¥n Ä‘á» liÃªn quan Ä‘áº¿n xá»­ lÃ½ Ä‘a luá»“ng. TÃ´i Æ°á»›c gÃ¬ mÃ¬nh Ä‘Ã£ biáº¿t vá» TÃ­nh báº¥t biáº¿n lÃºc Ä‘Ã³. MÃ  thá»±c ra Ä‘iá»u tÃ´i quan tÃ¢m nháº¥t khi áº¥y lÃ  sá»± khÃ¡c nhau giá»¯a tá»‘c Ä‘á»™ Ä‘á»c 2x vÃ  4x cá»§a á»• Ä‘Ä©a CD-ROM sáº½ áº£nh hÆ°á»Ÿng tháº¿ nÃ o Ä‘áº¿n hiá»‡u nÄƒng cháº¡y game. TÃ­nh báº¥t biáº¿n táº¡o ra cÃ¡c dÃ²ng code Ä‘Æ¡n giáº£n hÆ¡n vÃ  an toÃ n hÆ¡n Äáº§u cá»§a tÃ´i!!!!Táº¡m thá»i Ä‘áº¿n Ä‘Ã¢y thÃ´i lÃ  Ä‘á»§. Trong cÃ¡c pháº§n sau cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ nÃ³i vá» cÃ¡c váº¥n Ä‘á» nhÆ° lÃ  High-order Function, Functional Composition, Curring, v..vâ€¦ Náº¿u báº¡n muá»‘n tham gia vÃ o cá»™ng Ä‘á»“ng cÃ¡c nhÃ  phÃ¡t triá»ƒn web muá»‘n há»c vÃ  giÃºp Ä‘á»¡ láº«n nhau vá» FP trong Elm, má»i cÃ¡c báº¡n tham gia Group Facebook sau: Learn Elm Programming VÃ  Ä‘Ã¢y lÃ  Twitter cá»§a tÃ¡c giáº£ : @cscalfani","categories":[],"tags":[]},{"title":"Giáº£i thÃ­ch vá» Value vÃ  Reference trong Javascript","slug":"Explaining-Value-vs-Reference-in-Javascript","date":"2017-08-21T12:32:28.000Z","updated":"2017-08-31T00:53:23.895Z","comments":true,"path":"2017/08/Explaining-Value-vs-Reference-in-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Explaining-Value-vs-Reference-in-Javascript.html","excerpt":"DÃ¹ng má»™t cÃ¡i nhÃ¬n Ä‘Æ¡n giáº£n cá»§a bá»™ nhá»› mÃ¡y tÃ­nh giáº£i thÃ­ch Ä‘iá»u nÃ y Javascript cÃ³ 5 kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c thÃ´ng qua value: Boolean, null, undefined, String, vÃ  Number. ChÃºng ta sáº½ gá»i chung lÃ  primitive types. Javascript cÃ³ 5 kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c thÃ´ng qua reference: Array, Function, vÃ  Object. Vá» máº·t ká»¹ thuáº­t Ä‘Ã³ lÃ  Objects, vÃ¬ váº­y chÃºng ta sáº½ Ä‘á» cáº­p Ä‘áº¿n chÃºng chung chung nhÆ° Objects.","text":"DÃ¹ng má»™t cÃ¡i nhÃ¬n Ä‘Æ¡n giáº£n cá»§a bá»™ nhá»› mÃ¡y tÃ­nh giáº£i thÃ­ch Ä‘iá»u nÃ y Javascript cÃ³ 5 kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c thÃ´ng qua value: Boolean, null, undefined, String, vÃ  Number. ChÃºng ta sáº½ gá»i chung lÃ  primitive types. Javascript cÃ³ 5 kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c thÃ´ng qua reference: Array, Function, vÃ  Object. Vá» máº·t ká»¹ thuáº­t Ä‘Ã³ lÃ  Objects, vÃ¬ váº­y chÃºng ta sáº½ Ä‘á» cáº­p Ä‘áº¿n chÃºng chung chung nhÆ° Objects. Primitives (NguyÃªn thá»§y)Náº¿u má»™t kiá»ƒu nguyÃªn thá»§y Ä‘Æ°á»£c gÃ¡n cho má»™t biáº¿n, chÃºng ta cÃ³ thá»ƒ nghÄ© ráº±ng biáº¿n Ä‘Ã³ chá»©a Ä‘á»±ng giÃ¡ trá»‹ nguyÃªn thá»§y. 123var x = 10;var y = 'abc';var z = null; x chá»©a Ä‘á»±ng 10. y chá»©a Ä‘á»±ng &#39;abc&#39;. Äá»ƒ cá»§ng cá»‘ Ã½ tÆ°á»Ÿng nÃ y, chÃºng tÃ´i sáº½ cung cáº¥p má»™t hÃ¬nh áº£nh vá» nhá»¯ng gÃ¬ cÃ¡c biáº¿n nÃ y vÃ  cÃ¡c giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng giá»‘ng nhÆ° trong bá»™ nhá»›. Khi chÃºng ta gÃ¡n cÃ¡c biáº¿n nÃ y cho cÃ¡c biáº¿n khÃ¡c sá»­ dá»¥ng dáº¥u =, ChÃºng ta copy giÃ¡ trá»‹ cho biáº¿n má»›i. ChÃºng Ä‘Æ°á»£c sao chÃ©p theo giÃ¡ trá»‹. 12345var x = 10;var y = 'abc';var a = x;var b = y;console.log(x, y, a, b); // -&gt; 10, 'abc', 10, 'abc' Cáº£ a vÃ  x bÃ¢y giá» chá»©a 10. Cáº£ b vÃ  y bÃ¢y giá» chá»©a &#39;abc&#39;. ChÃºng lÃ  tÃ¡ch biá»‡t, vÃ¬ cÃ¡c giÃ¡ trá»‹ Ä‘Æ°á»£c sao chÃ©p. Khi thay Ä‘á»•i má»™t biáº¿n nÃ³ khÃ´ng thay Ä‘á»•i cÃ¡i khÃ¡c. HÃ£y suy nghÄ© lÃ  cÃ¡c biáº¿n nhÆ° khÃ´ng cÃ³ má»‘i quan há»‡ vá»›i nhau. 12345678var x = 10;var y = 'abc';var a = x;var b = y;a = 5;b = 'def';console.log(x, y, a, b); // -&gt; 10, 'abc', 5, 'def' ObjectsThis will feel confusing, but bear with me and read through it. Once you get through it, itâ€™ll seem easy. Variables that are assigned a non-primitive value are given a reference to that value. That reference points to the objectâ€™s location in memory. The variables donâ€™t actually contain the value. Objects are created at some location in your computerâ€™s memory. When we write arr = [], weâ€™ve created an array in memory. What the variable arr receives is the address, the location, of that array. Letâ€™s pretend that address is a new data type that is passed by value, just like number or string. An address points to the location, in memory, of a value that is passed by reference. Just like a string is denoted by quotation marks (&#39;&#39; or &quot;&quot;), an address will be denoted by arrow brackets, &lt;&gt;. When we assign and use a reference-type variable, what we write and see is: 121) var arr = [];2) arr.push(1); A representation of lines 1 and 2 above in memory is: 1. 2. Notice that the value, the address, contained by the variable arr is static. The array in memory is what changes. When we use arr to do something, such as pushing a value, the Javascript engine goes to the location of arr in memory and works with the information stored there. Assigning by ReferenceWhen a reference type value, an object, is copied to another variable using =, the address of that value is whatâ€™s actually copied over as if it were a primitive. Objects are copied by reference instead of by value. 12var reference = [1];var refCopy = reference; The code above looks like this in memory. Each variable now contains a reference to the same array. That means that if we alter reference, refCopy will see those changes: 12reference.push(2);console.log(reference, refCopy); // -&gt; [1, 2], [1, 2] Weâ€™ve pushed 2 into the array in memory. When we use reference and refCopy, weâ€™re pointing to that same array. Reassigning a ReferenceReassigning a reference variable replaces the old reference. 1var obj = &#123; first: 'reference' &#125;; In memory: When we have a second line: 12var obj = &#123; first: 'reference' &#125;;obj = &#123; second: 'ref2' &#125; The address stored in obj changes. The first object is still present in memory, and so is the next object: When there are no references to an object remaining, as we see for the address #234 above, the Javascript engine can perform garbage collection. This just means that the programmer has lost all references to the object and canâ€™t use the object any more, so the engine can go ahead and safely delete it from memory. In this case, the object { first: &#39;reference&#39; } is no longer accessible and is available to the engine for garbage collection. == and ===When the equality operators, == and ===, are used on reference-type variables, they check the reference. If the variables contain a reference to the same item, the comparison will result in true. 12var arrRef = [â€™Hi!â€™];var arrRef2 = arrRef;console.log(arrRef === arrRef2); // -&gt; true If theyâ€™re distinct objects, even if they contain identical properties, the comparison will result in false. 12var arr1 = ['Hi!'];var arr2 = ['Hi!'];console.log(arr1 === arr2); // -&gt; false If we have two distinct objects and want to see if their properties are the same, the easiest way to do so is to turn them both into strings and then compare the strings. When the equality operators are comparing primitives, they simply check if the values are the same. 12var arr1str = JSON.stringify(arr1);var arr2str = JSON.stringify(arr2);console.log(arr1str === arr2str); // true Another option would be to recursively loop through the objects and make sure each of the properties are the same. Passing Parameters through FunctionsWhen we pass primitive values into a function, the function copies the values into its parameters. Itâ€™s effectively the same as using =. 1234567var hundred = 100;var two = 2;function multiply(x, y) &#123; // PAUSE return x * y;&#125;var twoHundred = multiply(hundred, two); In the example above, we give hundred the value 100. When we pass it into multiply, the variable x gets that value, 100. The value is copied over as if we used an = assignment. Again, the value of hundred is not affected. Here is a snapshot of what the memory looks like right at the PAUSE comment line in multiply. Pure FunctionsWe refer to functions that donâ€™t affect anything in the outside scope as pure functions. As long as a function only takes primitive values as parameters and doesnâ€™t use any variables in its surrounding scope, it is automatically pure, as it canâ€™t affect anything in the outside scope. All variables created inside are garbage-collected as soon as the function returns. A function that takes in an Object, however, can mutate the state of its surrounding scope. If a function takes in an array reference and alters the array that it points to, perhaps by pushing to it, variables in the surrounding scope that reference that array see that change. After the function returns, the changes it makes persist in the outer scope. This can cause undesired side effects that can be difficult to track down. Many native array functions, including Array.map and Array.filter, are therefore written as pure functions. They take in an array reference and internally, they copy the array and work with the copy instead of the original. This makes it so the original is untouched, the outer scope is unaffected, and weâ€™re returned a reference to a brand new array. Letâ€™s go into an example of a pure vs. impure function. 123456789101112function changeAgeImpure(person) &#123; person.age = 25; return person;&#125;var alex = &#123; name: 'Alex', age: 30&#125;;var changedAlex = changeAgeImpure(alex);console.log(alex); // -&gt; &#123; name: 'Alex', age: 25 &#125;console.log(changedAlex); // -&gt; &#123; name: 'Alex', age: 25 &#125; This impure function takes in an object and changes the property age on that object to be 25. Because it acts on the reference it was given, it directly changes the object alex. Note that when it returns the person object, it is returning the exact same object that was passed in. alex and alexChanged contain the same reference. Itâ€™s redundant to return the person variable and to store the reference in a new variable. Letâ€™s look at a pure function. 12345678910111213function changeAgePure(person) &#123; var newPersonObj = JSON.parse(JSON.stringify(person)); newPersonObj.age = 25; return newPersonObj;&#125;var alex = &#123; name: 'Alex', age: 30&#125;;var alexChanged = changeAgePure(alex);console.log(alex); // -&gt; &#123; name: 'Alex', age: 30 &#125;console.log(alexChanged); // -&gt; &#123; name: 'Alex', age: 25 &#125; In this function, we use JSON.stringify to transform the object weâ€™re passed into a string, and then parse it back into an object with JSON.parse. By performing this transformation and storing the result in a new variable, weâ€™ve created a new object. There are other ways to do the same thing such as looping through the original object and assigning each of its properties to a new object, but this way is simplest. The new object has the same properties as the original but it is a distinctly separate object in memory. When we change the age property on this new object, the original is unaffected. This function is now pure. It canâ€™t affect any object outside its own scope, not even the object that was passed in. The new object needs to be returned and stored in a new variable or else it gets garbage collected once the function completes, as the object is no longer in scope. Test YourselfValue vs. reference is a concept often tested in coding interviews. Try to figure out for yourself whatâ€™s logged here. 1234567891011121314151617function changeAgeAndReference(person) &#123; person.age = 25; person = &#123; name: 'John', age: 50 &#125;; return person;&#125;var personObj1 = &#123; name: 'Alex', age: 30&#125;;var personObj2 = changeAgeAndReference(personObj1);console.log(personObj1); // -&gt; ?console.log(personObj2); // -&gt; ? The function first changes the property age on the original object it was passed in. It then reassigns the variable to a brand new object and returns that object. Hereâ€™s what the two objects are logged out. 12console.log(personObj1); // -&gt; &#123; name: 'Alex', age: 25 &#125;console.log(personObj2); // -&gt; &#123; name: 'John', age: 50 &#125; Remember that assignment through function parameters is essentially the same as assignment with =. The variable person in the function contains a reference to the personObj1 object, so initially it acts directly on that object. Once we reassign person to a new object, it stops affecting the original. This reassignment does not change the object that personObj1 points to in the outer scope. person has a new reference because it was reassigned but this reassignment doesnâ€™t change personObj1. An equivalent piece of code to the above block would be: 123456789101112131415var personObj1 = &#123; name: 'Alex', age: 30&#125;;var person = personObj1;person.age = 25;person = &#123; name: 'john', age: 50&#125;;var personObj2 = person;console.log(personObj1); // -&gt; &#123; name: 'Alex', age: 25 &#125;console.log(personObj2); // -&gt; &#123; name: 'John', age: '50' &#125; The only difference is that when we use the function, person is no longer in scope once the function ends. Káº¿t thÃºc. Báº¯t Ä‘áº§u viáº¿t code nÃ o.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"Thá»±c hÃ nh tá»‘i Æ°u nhá»¯ng á»©ng dá»¥ng React","slug":"Optimizing-React-Apps-in-Practice","date":"2017-08-21T12:21:55.000Z","updated":"2017-08-31T01:00:24.154Z","comments":true,"path":"2017/08/Optimizing-React-Apps-in-Practice.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Optimizing-React-Apps-in-Practice.html","excerpt":"React cÃ³ thá»ƒ cháº­m. Ã tÃ´i lÃ , báº¥t ká»³ á»©ng dá»¥ng React vá»›i kÃ­ch thÆ°á»›c trung bÃ¬nh cÃ³ thá»ƒ cÃ³ váº» cháº­m. NhÆ°ng trÆ°á»›c khi báº¡n báº¯t Ä‘áº§u tÃ¬m kiáº¿m cÃ¡c phÆ°Æ¡ng Ã¡n thay tháº¿, báº¡n nÃªn biáº¿t ráº±ng báº¥t ká»³ á»©ng dá»¥ng Angular hay Ember cá»¡ trung bÃ¬nh nÃ o cÅ©ng cháº­m. Tin vui lÃ : Náº¿u báº¡n quan tÃ¢m Ä‘áº¿n hiá»‡u suáº¥t, nÃ³ khÃ¡ dá»… dÃ ng Ä‘á»ƒ lÃ m báº¥t ká»³ á»©ng dá»¥ng React trá»Ÿ nÃªn siÃªu nhanh âš¡.ï¸ ÄÃ¢y lÃ  cÃ¡ch.","text":"React cÃ³ thá»ƒ cháº­m. Ã tÃ´i lÃ , báº¥t ká»³ á»©ng dá»¥ng React vá»›i kÃ­ch thÆ°á»›c trung bÃ¬nh cÃ³ thá»ƒ cÃ³ váº» cháº­m. NhÆ°ng trÆ°á»›c khi báº¡n báº¯t Ä‘áº§u tÃ¬m kiáº¿m cÃ¡c phÆ°Æ¡ng Ã¡n thay tháº¿, báº¡n nÃªn biáº¿t ráº±ng báº¥t ká»³ á»©ng dá»¥ng Angular hay Ember cá»¡ trung bÃ¬nh nÃ o cÅ©ng cháº­m. Tin vui lÃ : Náº¿u báº¡n quan tÃ¢m Ä‘áº¿n hiá»‡u suáº¥t, nÃ³ khÃ¡ dá»… dÃ ng Ä‘á»ƒ lÃ m báº¥t ká»³ á»©ng dá»¥ng React trá»Ÿ nÃªn siÃªu nhanh âš¡.ï¸ ÄÃ¢y lÃ  cÃ¡ch. Measuring React PerformanceWhat do I mean by â€œslowâ€? Letâ€™s take an example: Iâ€™m working on an open-source project called admin-on-rest, which leverages material-ui and Redux to provide an admin GUI for any REST API. This application has a datagrid page, displaying a list of records in a table. When the user changes the sort order, or goes to the next page, or filters the result, the interface isnâ€™t as responsive as I would expect. The following screencast shows the refresh slowed down five times: To see whatâ€™s happening, I append a ?react_perf to the URL. This enables Component Profiling since React 15.4. I wait for the initial datagrid to load. Then I open the Chrome Developer Tools on the Timeline tab, hit the â€œRecordâ€ button, and click on a table header to update the sort order. Once the data refreshes, I hit the â€œRecordâ€ button again to stop recording, and Chrome displays a yellow flamegraph with a â€œUser Timingâ€ label. If youâ€™ve never seen a flamegraph, it can look intimidating, but itâ€™s actually very easy to use. This â€œUser Timingâ€ graph shows the time passed in each of your components. It hides the time spend inside React internals (you canâ€™t optimize this time anyway), so it lets you focus on optimizing your app. The Timeline displays screenshots of the window at various stages, this lets me zoom in to the moment I clicked on the table header: It seems that my app rerenders the &lt;List&gt; component just after clicking on the sort button, before even fetching the REST data. And this takes more than 500ms. The app just updates the sort icon in the table header, and displays a grey overlay on the datagrid to show that the data is being fetched. To put it otherwise, the app takes half a second to provide visual feedback to a click. Half a second is definitely perceivable â€” UI experts say that users perceive an interface change as instantaneous when itâ€™s below 100ms. A change slower than that is what I mean by â€œslowâ€. Why Did You Update?In the flamegraph above, you can see many tiny pits. Thatâ€™s not a good sign. It means that many components are rerendered. The flamegraph shows that the &lt;Datagrid&gt; update takes the most time. Why did the app rerender the entire datagrid before fetching new data? Letâ€™s dig down. Understanding the causes of a rerender often implies adding console.log() statements in render() functions. For functional components, you can use the following one-liner Higher-Order Component (HOC): 12345678// in src/log.jsconst log = BaseComponent =&gt; props =&gt; &#123; console.log(`Rendering $&#123;BaseComponent.name&#125;`); return &lt;BaseComponent &#123;â€¦props&#125; /&gt;;&#125;export default log;// in src/MyComponent.jsimport log from â€˜./logâ€™;export default log(MyComponent); Tip: Another React performance tool worth mentioning is why-did-you-update. This npm package patches React to emit console warnings whenever a component rerenders with identical props. Caveats: The output is verbose, and it doesnâ€™t work on functional components. In the example, when the user clicks on a header column, the app emits an action, which changes the state: the list sort order (currentSort) is updated. This state change triggers the rerendering of the &lt;List&gt; page, which in turn rerenders the entire &lt;Datagrid&gt; component. We want the datagrid header to be immediately rendered to show the sort icon change as a feedback to user action. What makes a React app slow is usually not a single slow component (that would translate in the flamegraph as one large pit). What makes a React app slow is, most of the time, useless rerenders of many components. You may have read that the React VirtualDom is super fast. Thatâ€™s true, but in a medium size app, a full redraw can easily render hundreds of components. Even the fastest VirtualDom templating engine canâ€™t make that in less than 16ms. Cutting Components To Optimize ThemHere is the &lt;Datagrid&gt; component render() method: 12345678910111213141516171819202122232425262728293031323334353637383940// in Datagrid.jsrender() &#123; const &#123; resource, children, ids, data, currentSort &#125; = this.props; return ( &lt;table&gt; &lt;thead&gt; &lt;tr&gt; &#123;Children.map(children, (field, index) =&gt; &lt;DatagridHeaderCell key=&#123;index&#125; field=&#123;field&#125; currentSort=&#123;currentSort&#125; updateSort=&#123;this.updateSort&#125; /&gt; )&#125; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &#123;ids.map(id =&gt; ( &lt;tr key=&#123;id&#125;&gt; &#123;Children.map(children, (field, index) =&gt; &lt;DatagridCell record=&#123;data[id]&#125; key=&#123;`$&#123;id&#125;-$&#123;index&#125;`&#125; field=&#123;field&#125; resource=&#123;resource&#125; /&gt; )&#125; &lt;/tr&gt; ))&#125; &lt;/tbody&gt; &lt;/table&gt; );&#125; This seems like a very simple implementation of a datagrid, yet it is very inefficient. Each &lt;DatagridCell&gt; call renders at least two or three components. As you can see in the initial interface screencast, the list has 7 columns, 11 rows, that means 7113 = 231 components rerended. When only the currentSort changes, itâ€™s a waste of time. Even though React doesnâ€™t update the real DOM if the rerendered VirtualDom is unchanged, it takes about 500ms to process all the components. In order to avoid a useless rendering of the table body, I must first extract it: 123456789101112131415161718192021222324252627282930// in Datagrid.jsrender() &#123; const &#123; resource, children, ids, data, currentSort &#125; = this.props; return ( &lt;table&gt; &lt;thead&gt; &lt;tr&gt; &#123;React.Children.map(children, (field, index) =&gt; &lt;DatagridHeaderCell key=&#123;index&#125; field=&#123;field&#125; currentSort=&#123;currentSort&#125; updateSort=&#123;this.updateSort&#125; /&gt; )&#125; &lt;/tr&gt; &lt;/thead&gt; &lt;DatagridBody resource=&#123;resource&#125; ids=&#123;ids&#125; data=&#123;data&#125;&gt; &#123;children&#125; &lt;/DatagridBody&gt; &lt;/table&gt; ); );&#125; I created a new &lt;DatagridBody&gt; component by extracting the table body logic: 12345678910111213141516171819// in DatagridBody.jsimport React, &#123; Children &#125; from 'react';const DatagridBody = (&#123; resource, ids, data, children &#125;) =&gt; ( &lt;tbody&gt; &#123;ids.map(id =&gt; ( &lt;tr key=&#123;id&#125;&gt; &#123;Children.map(children, (field, index) =&gt; &lt;DatagridCell record=&#123;data[id]&#125; key=&#123;`$&#123;id&#125;-$&#123;index&#125;`&#125; field=&#123;field&#125; resource=&#123;resource&#125; /&gt; )&#125; &lt;/tr&gt; ))&#125; &lt;/tbody&gt;);export default DatagridBody; Extracting the table body has no effect on performance, but it reveals the path to optimization. Large, general purpose components are hard to optimize. Small, single-responsibility components are much easier to deal with. shouldComponentUpdateThe React documentation is very clear about the way to avoid useless rerenders: shouldComponentUpdate(). By default, React always renders a component to the virtual DOM. In other terms, itâ€™s your job as a developer to check that the props of a component didnâ€™t change and skip rendering altogether in that case. In the case of the &lt;DatagridBody&gt; component above, there should be no rerender of the body unless the props have changed. So the component should be completed as follows: 123456789101112131415161718192021222324252627import React, &#123; Children, Component &#125; from 'react';class DatagridBody extends Component &#123; shouldComponentUpdate(nextProps) &#123; return (nextProps.ids !== this.props.ids || nextProps.data !== this.props.data); &#125; render() &#123; const &#123; resource, ids, data, children &#125; = this.props; return ( &lt;tbody&gt; &#123;ids.map(id =&gt; ( &lt;tr key=&#123;id&#125;&gt; &#123;Children.map(children, (field, index) =&gt; &lt;DatagridCell record=&#123;data[id]&#125; key=&#123;`$&#123;id&#125;-$&#123;index&#125;`&#125; field=&#123;field&#125; resource=&#123;resource&#125; /&gt; )&#125; &lt;/tr&gt; ))&#125; &lt;/tbody&gt; ); &#125;&#125;export default DatagridBody; Tip: As an alternative to implementing shouldComponentUpdate() manually, I could inherit from Reactâ€™s PureComponent instead of Component. This would compare all props using strict equality (===) and rerender only if any of the props change. But I know that resource and children cannot change in that context, so I donâ€™t need to check for their equality. With this optimization, the rerendering of the &lt;Datagrid&gt; component after clicking on a table header skips the table body and its 231 components entirely. This reduces the update time from 500ms to 60ms. Thatâ€™s a net performance improvement of more than 400ms! Tip: Donâ€™t get fooled by the flamegraph width, itâ€™s zoomed even more than the previous flamegraph. This one is definitely better! The shouldComponentUpdate optimization has removed a lot of pits in the graph, and reduced the overall rendering time. I can use the same trick to avoid even more rerenders (e.g. to avoid rendering the sidebar, the action buttons, the table headers that didnâ€™t change, the pagination). After about an hour of work, the entire page renders just 100ms after clicking on a header column. Thatâ€™s fast enough â€” even if there is still room for optimization. Adding a shouldComponentUpdate method may seem cumbersome, but if you care about performance, most of the components you write should end up with one. Donâ€™t do it everywhere â€” executing shouldComponentUpdate on simple components is sometimes slower than just rendering the component. Donâ€™t do that too early in the life of an application either â€” this would be premature optimization. But as your apps grow, and you can detect performance bottlenecks in your components, add shouldComponentUpdate logic to remain fast. RecomposeIâ€™m not very happy with the previous change on &lt;DatagridBody&gt;: because of shouldComponentUpdate, I had to transform a simple, functional component to a class-based component. This adds more lines of code, and every line of code has a cost â€” to write, to debug, and to maintain. Fortunately, you can implement the shouldComponentUpdate logic in a higher-order component (HOC) thanks to recompose. Itâ€™s a functional utility belt for React, providing for instance the pure() HOC: 1234567891011121314151617181920// in DatagridBody.jsimport React, &#123; Children &#125; from 'react';import pure from 'recompose/pure';const DatagridBody = (&#123; resource, ids, data, children &#125;) =&gt; ( &lt;tbody&gt; &#123;ids.map(id =&gt; ( &lt;tr key=&#123;id&#125;&gt; &#123;Children.map(children, (field, index) =&gt; &lt;DatagridCell record=&#123;data[id]&#125; key=&#123;`$&#123;id&#125;-$&#123;index&#125;`&#125; field=&#123;field&#125; resource=&#123;resource&#125; /&gt; )&#125; &lt;/tr&gt; ))&#125; &lt;/tbody&gt;);export default pure(DatagridBody); The only difference between this code and the initial implementation is the last line: I export pure(DatagridBody) instead of DatagridBody. pure is like PureComponent, but without the extra class boilerplate. I can even be more specific and target only the props that I know may change, using recomposeâ€™s shouldUpdate() instead of pure(): 12345678910// in DatagridBody.jsimport React, &#123; Children &#125; from 'react';import shouldUpdate from â€˜recompose/shouldUpdateâ€™;const DatagridBody = (&#123; resource, ids, data, children &#125;) =&gt; ( ...);const checkPropsChange = (props, nextProps) =&gt; (nextProps.ids !== props.ids || nextProps.data !== props.data);export default shouldUpdate(checkPropsChange)(DatagridBody); The checkPropsChange function is pure, and I can even export it for unit tests. The recompose library offers more performance HOCs, like onlyUpdateForKeys(), which does exactly the type of check I did in my own checkPropsChange: 1234567// in DatagridBody.jsimport React, &#123; Children &#125; from 'react';import onlyUpdateForKeys from â€˜recompose/onlyUpdateForKeysâ€™;const DatagridBody = (&#123; resource, ids, data, children &#125;) =&gt; ( ...);export default onlyUpdateForKeys([â€˜idsâ€™, â€˜dataâ€™])(DatagridBody); I warmly recommend recompose. Beyond performance optimization, it helps you extract data fetching logic, HOC composition, and props manipulation in a functional and testable way. ReduxIf youâ€™re using Redux to manage application state (which I also recommend), then connected components are already pure. No need to add another HOC. Just remember that if only one of the props change, then the connected component rerenders â€” this includes all its children, too. So even if you use Redux for page components, you should use pure() or shouldUpdate() for components further down in the render tree. Also, beware that Redux does the props comparison using strict equality. Since Redux connects the state to a componentâ€™s props, if you mutate an object in the state, Redux props comparison will miss it. Thatâ€™s why you must use immutability in your reducers. For instance, in admin-on-rest, clicking on a table header dispatches a SET_SORT action. The reducer listening to that action must pay attention to replace objects in the state, not update them: 12345678910111213141516171819202122232425262728293031323334// in listReducer.jsexport const SORT_ASC = 'ASC';export const SORT_DESC = 'DESC';const initialState = &#123; sort: 'id', order: SORT_DESC, page: 1, perPage: 25, filter: &#123;&#125;,&#125;;export default (previousState = initialState, &#123; type, payload &#125;) =&gt; &#123; switch (type) &#123; case SET_SORT: if (payload === previousState.sort) &#123; // inverse sort order return &#123; ...previousState, order: oppositeOrder(previousState.order), page: 1, &#125;; &#125; // replace sort field_ return &#123; ...previousState, sort: payload, order: SORT_ASC, page: 1, &#125;; // ... default: return previousState; &#125;&#125;; With this reducer, when Redux checks for changes using triple equal, it finds that the state object is different, and rerenders the datagrid. But had we mutated the state, Redux would have missed the state change, and skipped rerendering by mistake: 12345678910111213141516171819// don't do this at homeexport default (previousState = initialState, &#123; type, payload &#125;) =&gt; &#123; switch (type) &#123; case SET_SORT: if (payload === previousState.sort) &#123; // never do this previousState.order = oppositeOrder(previousState.order); return previousState; &#125; // never do that either previousState.sort = payload; previousState.order = SORT_ASC; previousState.page = 1; return previousState; // ... default: return previousState; &#125;&#125;; To write immutable reducers, other developers like to use immutable.js, also from Facebook. I find it unnecessary, since ES6 destructuring makes it easy to selectively replace a component properties. Besides, Immutable is heavy (60kB), so think twice before you add it to your project dependencies. ReselectTo prevent useless renders in (Redux) connected components, you must also make sure that the mapStateToProps function doesnâ€™t return new objects each time it is called. Take for instance the &lt;List&gt; component in admin-on-rest. It grabs the list of records for the current resource (e.g. posts, comments, etc) from the state using the following code: 123456789101112131415161718// in List.jsimport React from 'react';import &#123; connect &#125; from 'react-redux';const List = (props) =&gt; ...const mapStateToProps = (state, props) =&gt; &#123; const resourceState = state.admin[props.resource]; return &#123; ids: resourceState.list.ids, data: Object.keys(resourceState.data) .filter(id =&gt; resourceState.list.ids.includes(id)) .map(id =&gt; resourceState.data[id]) .reduce((data, record) =&gt; &#123; data[record.id] = record; return data; &#125;, &#123;&#125;), &#125;;&#125;;export default connect(mapStateToProps)(List); The state contains an array of all the previously fetched records, indexed by resource. For instance, state.admin.posts.data contains the list of posts: 12345&#123; 23: &#123; id: 23, title: â€œHello, Worldâ€, /* â€¦ */ &#125;, 45: &#123; id: 45, title: â€œLorem Ipsumâ€, /* â€¦ */ &#125;, 67: &#123; id: 67, title: â€œSic dolor ametâ€, /* â€¦ */ &#125;,&#125; The mapStateToProps function filters this state object to return only the records actually displayed in the list. Something like: 1234&#123; 23: &#123; id: 23, title: â€œHello, Worldâ€, /* â€¦ */ &#125;, 67: &#123; id: 67, title: â€œSic dolor ametâ€, /* â€¦ */ &#125;,&#125; The problem is that each time mapStateToProps runs, it returns a new object, even if the underlying objects didnâ€™t change. As a consequence, the &lt;List&gt; component rerenders every time something in the state changes â€” while id should only change if the date or ids change. Reselect solves this problem by using memoization. Instead of computing the props directly in mapStateToProps, you use a selector from reselect, which returns the same output if the input didnâ€™t change. 123456789101112131415161718192021222324252627import React from 'react';import &#123; connect &#125; from 'react-redux';import &#123; createSelector &#125; from 'reselect'const List = (props) =&gt; ...const idsSelector = (state, props) =&gt; state.admin[props.resource].idsconst dataSelector = (state, props) =&gt; state.admin[props.resource].dataconst filteredDataSelector = createSelector( idsSelector, dataSelector (ids, data) =&gt; Object.keys(data) .filter(id =&gt; ids.includes(id)) .map(id =&gt; data[id]) .reduce((data, record) =&gt; &#123; data[record.id] = record; return data; &#125;, &#123;&#125;))const mapStateToProps = (state, props) =&gt; &#123; const resourceState = state.admin[props.resource]; return &#123; ids: idsSelector(state, props), data: filteredDataSelector(state, props), &#125;;&#125;;export default connect(mapStateToProps)(List); Now the &lt;List&gt; component will only rerender if a subset of the state changes. As for recompose, reselect selectors are pure functions, easy to test and compose. Itâ€™s a great way to code your selectors for Redux connected components. Beware of Object Literals in JSXOnce your components become more â€œpureâ€, you start detecting bad patterns that lead to useless rerenders. The most common is the usage of object literals in JSX, which I like to call â€œThe infamous \\{\\{â€. Let me give you an example: 1234567import React from 'react';import MyTableComponent from './MyTableComponent';const Datagrid = (props) =&gt; ( &lt;MyTableComponent style=&#123;&#123; marginTop: 10 &#125;&#125;&gt; ... &lt;/MyTableComponent&gt;) The style prop of the &lt;MyTableComponent&gt; component gets a new value every time the &lt;Datagrid&gt; component is rendered. So even if &lt;MyTableComponent&gt; is pure, it will be rendered every time &lt;Datagrid&gt; is rendered. In fact, each time you pass an object literal as prop to a child component, you break purity. The solution is simple: 12345678import React from 'react';import MyTableComponent from './MyTableComponent';const tableStyle = &#123; marginTop: 10 &#125;;const Datagrid = (props) =&gt; ( &lt;MyTableComponent style=&#123;tableStyle&#125;&gt; ... &lt;/MyTableComponent&gt;) This looks very basic, but Iâ€™ve seen this mistake so many times that Iâ€™ve developed a sense for detecting the infamous \\{\\{ in JSX. I routinely replace it with constants. Another usual suspect for hijacking pure components is React.cloneElement(). If you pass a prop by value as second parameter, the cloned element will receive new props at every render. 12345678// badconst MyComponent = (props) =&gt; &lt;div&gt;&#123;React.cloneElement(Foo, &#123; bar: 1 &#125;)&#125;&lt;/div&gt;;// goodconst additionalProps = &#123; bar: 1 &#125;;const MyComponent = (props) =&gt; &lt;div&gt;&#123;React.cloneElement(Foo, additionalProps)&#125;&lt;/div&gt;; This has bitten me a couple times with material-ui, for instance with the following code: 123456789import &#123; CardActions &#125; from 'material-ui/Card';import &#123; CreateButton, RefreshButton &#125; from 'admin-on-rest';const Toolbar = (&#123; basePath, refresh &#125;) =&gt; ( &lt;CardActions&gt; &lt;CreateButton basePath=&#123;basePath&#125; /&gt; &lt;RefreshButton refresh=&#123;refresh&#125; /&gt; &lt;/CardActions&gt;);export default Toolbar; Although &lt;CreateButton&gt; is pure, it was rendered every time &lt;Toolbar&gt; was rendered. Thatâ€™s because material-uiâ€™s &lt;CardActions&gt; adds a special style to its first child to accommodate for margins â€” and it does so with an object literal. So &lt;CreateButton&gt; received a different style prop every time. I solved it using recomposeâ€™s onlyUpdateForKeys() HOC. 123456// in Toolbar.jsimport onlyUpdateForKeys from 'recompose/onlyUpdateForKeys';const Toolbar = (&#123; basePath, refresh &#125;) =&gt; ( ...);export default onlyUpdateForKeys(['basePath', 'refresh'])(Toolbar); ConclusionThere are many other things you should do to keep your React app fast (using keys, lazy loading heavy routes, the react-addons-perf package, using ServiceWorkers to cache app state, going isomorphic, etc), but implementing shouldComponentUpdate correctly is the first step â€” and the most rewarding. React isnâ€™t fast by default, but it offers all the tools to be fast whatever the size of the application. This may seem counterintuitive, especially since many frameworks offering an alternative to React claim themselves as n times faster. But React puts developer experience before performance. Thatâ€™s the reason why developing large apps with React is such a pleasant experience, without bad surprises, and a constant implementation rate. Just remember to profile your app every once in a while, and dedicate some time to add a few pure() calls where itâ€™s needed. Donâ€™t do it first, or spend too much time to over optimize each and every component â€” except if youâ€™re on mobile. And remember to test on various devices to get a good impression of your appâ€™s responsiveness from a userâ€™s point of view. If you want to read more about React performance optimization, here is a list of great articles on the subject: React Rally: Animated â€” React Performance Toolbox: A fabulous slide deck by Christopher Chedeau (Vjeux), one of the React Native developers. Heâ€™s French, by the way. Progressive Web Apps with React.js: Part 2 â€” Page Load Performance by Addy Osmany, who works at Google and writes a lot of blog posts about web performance Optimizing the Performance of Your React Application focuses on the react-addons-perf package to profile React apps precisely React Higher Order Components in depth, interesting for the introduction of Render Hijacking A Deep Dive into React Perf Debugging describes a step-by-step debugging session with Chrome dev Tools Making React reactive: the pursuit of high performing, easily maintainable React apps on using Observables to avoid rerenders","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"Use const Until You Have to Use let","slug":"Use-const-Until-You-Have-to-Use-let","date":"2017-08-21T11:44:18.000Z","updated":"2017-08-21T15:42:19.465Z","comments":true,"path":"2017/08/Use-const-Until-You-Have-to-Use-let.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Use-const-Until-You-Have-to-Use-let.html","excerpt":"Aloha, web surfer. So perhaps youâ€™re a let fan who came here to see what was up. Or maybe youâ€™re a beginner, just moving out of var town and into the wild west that is ES6 variable declaration. Whatever your experience level may be, I hope this article provides valuable insights and leaves you with a solid rule of thumb for instantiating variables in Javascript. My other hope is that, upon finishing this article, you can confidently part ways with var â€“ it is time.","text":"Aloha, web surfer. So perhaps youâ€™re a let fan who came here to see what was up. Or maybe youâ€™re a beginner, just moving out of var town and into the wild west that is ES6 variable declaration. Whatever your experience level may be, I hope this article provides valuable insights and leaves you with a solid rule of thumb for instantiating variables in Javascript. My other hope is that, upon finishing this article, you can confidently part ways with var â€“ it is time. Once Upon A Timeâ€¦â€¦in a specification authored somewhere in Californiaâ€¦ â€¦a keyword for variable instantiation was created and called var. If you remember your first day learning Javascript, it probably involved var. This little keyword was our only option for declaring variables in Javascript for a long time. In fact, every web site and application that used Javascript between itâ€™s inception in 1995 and the release of ECMAScript 2015 (ES6) used var and only var to create variables. (Someone fact check me on this statement, but I think itâ€™s accurate.) The var keyword is no longer relevant, but in order to truly understand our present, we must understand our past. Some important things to know about variables created with the var keyword: 1231) They are function scoped2) Their declarations get hoisted3) They can be declared without a value 1 â€œThey are function scopedâ€This means that var creates a variable that only exists inside of the function where it was declared. (Unless it was not declared inside a function. In that case, it exists ~everywhere~ ğŸ˜². More on this in fact #3.) Hereâ€™s a code snippet that illustrates the behavior of a function scoped variable: 123456function logA() &#123; var a = 2; console.log(a); // inside of `logA()`, `a` exists with value 2&#125;console.log(a); // ReferenceError! Outside of logA(), `a` is not defined. I think itâ€™s worth clarifying that when I say â€œinside ofâ€ logA(), I mean â€œbetween logA()â€™s curly bracketsâ€. 2 â€œTheir declarations get hoistedâ€ ğŸ‹Variable hoisting basically boils down to the fact that a variable declared with var can be instantiated after it gets used. This codeâ€¦ 123456function logB() &#123; b = 2; // using b to hold the number 2 console.log(b); // using b to print 2 in the console var b; // instantiating b ğŸ¤”&#125; â€¦will get transformed into something like this codeâ€¦ 123456function logB() &#123; var b; // instantiation is hoisted to the top of logB()'s scope b = 2; console.log(b);&#125; â€¦at compile time (yes, Javascript gets compiled). Thatâ€™s why it doesnâ€™t matter (to the browser) where we instantiate our variables â€“ the declarations get to skip the line every time. Thereâ€™s a dark side to the way var gets hoisted, though. Javascriptâ€™s compiler can be a bit too helpful in some situations. If we use a variable within a function but donâ€™t instantiate the variable in that function, the compiler will look for a var in the parent function scope. If it doesnâ€™t find it there, it will keep looking all the way up the scope chain until it gets to the global scope. If it still doesnâ€™t see a var declaration up there, it will just go ahead and make one for you, as demonstrated in this snippet: 12345function logC() &#123; c = 2; console.log(c); // 2&#125;// c is not instantiated in this program, yet it just works... Yikes. I guess this could be convenient sometimes when messing around in a REPL or somethingâ€¦ But for the most part, this is bananas. &quot;use strict&quot;; prevents this and should be included at the top of any ES5 script. 3 â€œThey can be declared without a valueâ€You may have seen someone do something along these lines before: 1234567// declare all my variables at the top of the scriptvar a, b, c;// use them down herea = 1;b = 2;c = a + b; Put a pin in this because it becomes important later. Times Have ChangedThe three facets of var that I just covered come together to create an extremely flexible variable declaration mechanism. While flexibility itself is not a bad thing and having only one variable instantiation keyword means a little more flexibility is necessary, var is simply doing too much. Function scope isnâ€™t a problem, but reassigning variables is so-so and should only be used for for loops and times when itâ€™s completely unavoidable (and when itâ€™s unavoidable, it probably means we have bigger fish to fry). The same goes for declaring variables without values. Lastly, being allowed to use a variable whether we declared it or not is silly. So, in order to address these drawbacks of var and save us developers from the pitfalls these â€œhelpfulâ€ features can cause, the ES6 specification introduced two new variable keywords: const and let. Remember, the primary goal of this post is to show that itâ€™s time to ditch var. Times have changed and var doesnâ€™t make the cut. Let me explainâ€¦In 2015, Javascriptâ€™s variable declaration family grew to include let, which deviates significantly from var in that it is block scoped. This basically means that we now have two units of scope available: 1 Functions12345function() &#123; let i = 'aye'; // `i` is scoped to this function console.log(i); // \"aye\"&#125;console.log(i); // ReferenceError 2 Blocks12345&#123; let i = 'oi'; // `i` is scoped to this block console.log(i); // \"oi\"&#125;console.log(i); // ReferenceError The let keyword has another helpful constraint: the variable cannot be accessed before its declaration (let does get hoisted though). One thing let shares with var is that it can be used to declare a variable without an initial value. Like in the example above, we could have done 1234&#123; let i; i = 'oi';&#125; and it wouldâ€™ve worked. Bookmarks for let ğŸ‘“ Are Let / Const Hoisted? YDKJS Blocks As Scopes YDKJS Let YDKJS Garbage Collection YDKJS Let loops Const stop, wonâ€™t stopOkay, const is my favorite variable declaration keyword in Javascript. I default to const over let and never use var. As a rule, I always use const unless I have to use let. Remember how variables declared with var can be instantiated with empty values? This type of instantiation is allowed with let, too. It is not so with const. Oh no, const requires that you provide a value up front. Otherwise, it will turn its nose up at you and refuse to create a variable, â€œIf you donâ€™t know whatâ€™s going in the variable, monsieur/madame, then why do you need it at all?â€ â€“ this is good. But thereâ€™s more! const goes one step further and ensures that the variable cannot be reassigned [note: this does not mean the variable is immutable]. For example, 12const a = 'ay';a = 2; // TypeError: Assignment to constant variable. Comparing const to var: 1 const is block scoped, var is function scoped. 2 const has to be instantiated with a value, var does not 3 const cannot be reassigned, var can 4 const cannot be accessed prior to instantiation, var can So basically const is the strictest variable instantiation tool we have at our disposal. The constraints it provides protect us from several possible errors, making the development process smoother. Exceptions: When to use letWhile I recommend defaulting to const, some situations demand the use of let. Here is a quote by Eric Elliot from a great article he wrote about the three keywords: 1`let`, is a signal that the variable may be reassigned, such as a counter in a loop, or a value swap in an algorithm. It also signals that the variable will be used only in the block itâ€™s defined in, which is not always the entire containing function. In other words, for loops and mathematical algorithms are the only times we would need to reach for let. Other than that, const is the strongest, safest bet. Use const until you have to use letI hope this article helped you on your quest to understand let and const and how they differ from var. I also hope you can comfortably ditch var and use const until you have to use let. Iâ€™m still learning myself and there are certainly gaps in this article. Feel free to correct me when Iâ€™m wrong or bring missing information to light.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"es6","slug":"es6","permalink":"http://nthung2112.github.io/tags/es6/"}]},{"title":"How to use Memoize to cache JavaScript function results and speed up yourÂ code","slug":"How-to-use-Memoize-to-cache-JavaScript-function-results","date":"2017-08-21T07:58:54.000Z","updated":"2017-08-21T15:42:19.418Z","comments":true,"path":"2017/08/How-to-use-Memoize-to-cache-JavaScript-function-results.html","link":"","permalink":"http://nthung2112.github.io/2017/08/How-to-use-Memoize-to-cache-JavaScript-function-results.html","excerpt":"","text":"Functions are an integral part of programming. They help add modularity and reusability to our code. Itâ€™s quite common to divide our program into chunks using functions which we can call later to perform some useful action. Sometimes, a function can become expensive to call multiple times (say, a function to calculate the factorial of a number). But thereâ€™s a way we can optimize such functions and make them execute much faster: caching. For example, letâ€™s say we have a function to return the factorial of a number: 1234function factorial(n) &#123; // Calculations: n * (n-1) * (n-2) * ... (2) * (1) return factorial&#125; Great, now letâ€™s find factorial(50). The computer will perform calculations and return us the final answer, sweet! When thatâ€™s done, letâ€™s find factorial(51). The computer again performs a number of calculations and gets us the result, but you might have noticed that weâ€™re already repeating a number of steps that could have been avoided. An optimized way would be: 1factorial(51) = factorial(50) * 51 But our function performs the calculations from scratch every time itâ€™s called: 1factorial(51) = 51 * 50 * 49 * ... * 2 * 1 Wouldnâ€™t it be cool if somehow our factorial function could remember the values from its previous calculations and use them to speed up the execution? In comes memoization, a way for our function to remember (cache) the results. Now that youâ€™ve a basic understanding of what weâ€™re trying to achieve, hereâ€™s a formal definition: Memoization is an optimization technique used primarily to speed up computer programs by storing the results of expensive function calls and returning the cached result when the same inputs occur again Memoizing in simple terms means memorizing or storing in memory. A memoized function is usually faster because if the function is called subsequently with the previous value(s), then instead of executing the function, we would be fetching the result from the cache. Hereâ€™s what a simple memoized function might look like (and hereâ€™s a CodePen in case you want to interact with it): 12345678910111213141516171819202122232425// a simple function to add somethingconst add = (n) =&gt; (n + 10);add(9);// a simple memoized function to add somethingconst memoizedAdd = () =&gt; &#123; let cache = &#123;&#125;; return (n) =&gt; &#123; if (n in cache) &#123; console.log('Fetching from cache'); return cache[n]; &#125; else &#123; console.log('Calculating result'); let result = n + 10; cache[n] = result; return result; &#125; &#125;&#125;// returned function from memoizedAddconst newAdd = memoizedAdd();console.log(newAdd(9)); // calculatedconsole.log(newAdd(9)); // cached Memoization takeawaysSome takeaways from the above code are: memoizedAdd returns a function which is invoked later. This is possible because in JavaScript, functions are first class objects which lets us use them as higher order functions and return another function. cache can remember its values since the returned function has a closure over it. Itâ€™s essential that the memoized function is pure. A pure function will return the same output for a particular input no mater how many times itâ€™s called, which makes the cache work as expected. Writing your own memoize functionThe previous code works fine but what if we wanted to turn any function into a memoized function? Hereâ€™s how to write your own memoize function (codepen): 1234567891011121314151617181920212223242526272829// a simple pure function to get a value adding 10const add = (n) =&gt; (n + 10);console.log('Simple call', add(3));// a simple memoize function that takes in a function// and returns a memoized functionconst memoize = (fn) =&gt; &#123; let cache = &#123;&#125;; return (...args) =&gt; &#123; let n = args[0]; // just taking one argument here if (n in cache) &#123; console.log('Fetching from cache'); return cache[n]; &#125; else &#123; console.log('Calculating result'); let result = fn(n); cache[n] = result; return result; &#125; &#125;&#125;// creating a memoized function for the 'add' pure functionconst memoizedAdd = memoize(add);console.log(memoizedAdd(3)); // calculatedconsole.log(memoizedAdd(3)); // cachedconsole.log(memoizedAdd(4)); // calculatedconsole.log(memoizedAdd(4)); // cached Now thatâ€™s great! This simple memoize function will wrap any simple function into a memoized equivalent. The code works fine for simple functions and it can be easily tweaked to handle any number of arguments as per your needs. Another alternative is to make use of some de-facto libraries such as: Lodashâ€™s _.memoize(func, [resolver]) ES7 @memoize decorators from decko Memoizing recursive functionsIf you try passing in a recursive function to the memoize function above or _.memoize from Lodash, the results wonâ€™t be as expected since the recursive function on its subsequent calls will end up calling itself instead of the memoized function thereby making no use of the cache. Just make sure that your recursive function is calling the memoized function. Hereâ€™s how you can tweak a textbook factorial example (codepen): 12345678910111213141516171819202122232425262728293031// same memoize function from beforeconst memoize = (fn) =&gt; &#123; let cache = &#123;&#125;; return (...args) =&gt; &#123; let n = args[0]; if (n in cache) &#123; console.log('Fetching from cache', n); return cache[n]; &#125; else &#123; console.log('Calculating result', n); let result = fn(n); cache[n] = result; return result; &#125; &#125;&#125;const factorial = memoize( (x) =&gt; &#123; if (x === 0) &#123; return 1; &#125; else &#123; return x * factorial(x - 1); &#125; &#125;);console.log(factorial(5)); // calculatedconsole.log(factorial(6)); // calculated for 6 and cached for 5 A few points to note from this code: The factorial function is recursively calling a memoized version of itself. The memoized function is caching the values of previous factorials which significantly improves calculations since they can be reused factorial(6) = 6 * factorial(5) Is memoization same as caching?Yes, kind of. Memoization is actually a specific type of caching. While caching can refer in general to any storing technique (like HTTP caching) for future use, memoizing specifically involves caching the return values of a function. When to memoize your functionsAlthough it might look like memoization can be used with all functions, it actually has limited use cases: In order to memoize a function, it should be pure so that return values are the same for same inputs every time Memoizing is a trade-off between added space and added speed and thus only significant for functions having a limited input range so that cached values can be made use of more frequently It might look like you should memoize your API calls however it isnâ€™t necessary because the browser automatically caches them for you. See HTTP caching for more detail The best use case I found for memoized functions is for heavy computational functions which can significantly improve performance (factorial and fibonacci are not really good real world examples) If youâ€™re into React/Redux you can check out reselect which uses a memoized selector to ensure that calculations only happen when a change happens in a related part of the state tree. Further readingThe following links can be useful if you would like to know more about some of the topics from this article in more detail: Higher order functions in JavaScript Closures in JavaScript Pure functions Lodashâ€™s _.memoize docs and source code More memoization examples here and here reactjs/reselect I hope this article was useful for you, and youâ€™ve gained a better understanding of memoization in JavaScript.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"advanced","slug":"advanced","permalink":"http://nthung2112.github.io/tags/advanced/"}]},{"title":"3 Reasons why I stopped using React.setState","slug":"3-Reasons-why-I-stopped-using-React-setState","date":"2017-08-21T07:43:25.000Z","updated":"2017-08-21T15:44:01.374Z","comments":true,"path":"2017/08/3-Reasons-why-I-stopped-using-React-setState.html","link":"","permalink":"http://nthung2112.github.io/2017/08/3-Reasons-why-I-stopped-using-React-setState.html","excerpt":"Since a few months Iâ€™ve stopped using Reactâ€™s setState on all my new React components. Donâ€™t get me wrong, I didnâ€™t stop having local component state, I just stopped using React to manage it. And itâ€™s been delightful! Using setState is tricky for beginners. Even experienced React programmers easily introduce subtle bugs when using Reactâ€™s own state mechanism, like this: Bug introduced by forgetting that React state is asynchronous; the log is always one item behind","text":"Since a few months Iâ€™ve stopped using Reactâ€™s setState on all my new React components. Donâ€™t get me wrong, I didnâ€™t stop having local component state, I just stopped using React to manage it. And itâ€™s been delightful! Using setState is tricky for beginners. Even experienced React programmers easily introduce subtle bugs when using Reactâ€™s own state mechanism, like this: Bug introduced by forgetting that React state is asynchronous; the log is always one item behind The excellent Reacts docs sum up everything that could go wrong when using setState: To summarize, there are 3 issues when using setState: 1. setState is asynchronousMany devs donâ€™t realize this initially, but setState is asynchronous. If you set some state, than take a look at it, you will still see the old state.This is the most tricky part of setState. setState calls donâ€™t look asynchronous, and naively calling setState introduces very subtle bugs. The next gist demonstrates that nicely: At first glance this might look fine. Two event handlers and a utility function that fire the onSelect event if provided. However, this Select component has a bug that is nicely demonstrated in the GIF above. onSelect is always fired with the previous value of state.selection, because setState hasnâ€™t done itâ€™s job yet when the fireOnSelect helperis invoked. I think the least React could do here is rename the method to scheduleState or make the callback required. This bug is easily fixed, the tricky part is realizing itâ€™s there. 2. setState causes unnecessary rendersThe second issue with setState is that it always triggers a re-render. Often those re-renders are unnecessary. You can use the printWasted method from the React performance tools to find out when this happens. But roughly speaking there are several reasons why a re-render may be unnecessary: The new state is actually the same as the previous one. This can often be addressed by implementing shouldComponentUpdate. You may already be using a (pure render) library to solve this for you. Sometimes the changed state is relevant for the rendering, but not under all circumstances. For example when some data is only conditionally visible. Thirdly, as pointed out in Aria Bucklesâ€™ talk at React Europe 2015, sometimes instance state is not relevant for the rendering at all! This is often householding state related to managing event listeners, timer IDâ€™s etc. 3. setState is not sufficient to capture all component stateFollowing the last point above, not all component state should be stored and updated using setState. More complex components often have administration that is needed by lifecycle hooks to manage timers, network requests, events etc. Managing those with setState not only causes unnecessary renders, but also causes related lifecycle hooks to be triggered again, leading to weird situations. Managing local component state with MobX(Surprise, surprise) At Mendix we already rely on MobX to manage all our stores. However, we were still using Reactâ€™s own state mechanism for local component state. Recently, we switched to managing local component state with MobX as well. That looks like this: For completeness sake: No unexpected bugs when using a state mechanism that is synchronous The above code snippet is not only more concise, MobX also addresses all of the setState related issues: Changes to the state are immediately reflected in the local component state. This makes our logic simpler and code reuse easier. You donâ€™t have to compensate for the fact that the state might not have been updated yet. MobX determines at runtime which observables are relevant for rendering. So observables that are temporarily irrelevant for the rendering, wonâ€™t cause a re-rendering. Until they are relevant again. For this reason, there are also no rendering penalties (or lifecycle issues) when marking fields as @observable that are not relevant for rendering at all. So renderable and non-renderable state is treated uniformly. In addition, state stored in our components now works the same as state stored in any of our stores. This makes it trivial to refactor components, and move local component state into a separate store or vice versa. Which is demonstrated in this egghead tutorial. MobX effectively turns your components into small stores Furthermore, rookie mistakes like assigning values directly to the state object cannot be made anymore when using observables for state. Oh, and donâ€™t worry about implementing shouldComponentUpdate or PureRenderMixin, MobX already takes care of that as well. Finally, you might be wondering, what if I want to wait until setState has finished? Well, you can still use the _compentDidUpdate l_ifecycle hook for that. Sounds cool! How do I get started with MobX?Pretty simple, follow the 10 minute interactive introduction or watch the aforementioned video. You can simply take a single component from your code base, slap @observer on it and introduce some @observable properties. You donâ€™t even have to replace your existing setState calls, they continue to work while using MobX. Although, within a few minutes you might find them so convoluted that you will replace them anyway :). (Oh, and if you donâ€™t like decorators, no worries, it works with good olâ€™ ES5 as well). TL;DR:Iâ€™ve stopped using React to manage local component state. I use MobX instead. Now React is truly â€œjust the viewâ€ :). MobX now manages both local component state and state in stores. It is concise, synchronous, efficient and uniform. From experience, Iâ€™ve learned that MobX is even easier to explain to React beginners than Reactâ€™s own setState. It keeps our components clean and simple. JSBin using setState for state management JSBin using MobX observables for state management","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"mobx","slug":"mobx","permalink":"http://nthung2112.github.io/tags/mobx/"}]},{"title":"What Iâ€™ve Learned Over 5 Years as a Software Developer","slug":"What-Iâ€™ve-Learned-Over-5-Years-as-a-Software-Developer","date":"2017-08-20T17:22:53.000Z","updated":"2017-08-20T17:47:33.433Z","comments":true,"path":"2017/08/What-Iâ€™ve-Learned-Over-5-Years-as-a-Software-Developer.html","link":"","permalink":"http://nthung2112.github.io/2017/08/What-Iâ€™ve-Learned-Over-5-Years-as-a-Software-Developer.html","excerpt":"Itâ€™s July 3rd 2017 at the time of publishing this article. Why am I mentioning such a seemingly arbitrary fact? Because today marks the five-year anniversary of beginning my software engineering career. Before this, I did undertake some work experience and completed some freelance projects, but I had no commercial exposure until I started my graduate scheme at Sky on this very day in 2012. Rather than dive into some self-indulgent drivel, Iâ€™d love to share five of the most important things Iâ€™ve learned thus far; I believe that all developers should embrace them.","text":"Itâ€™s July 3rd 2017 at the time of publishing this article. Why am I mentioning such a seemingly arbitrary fact? Because today marks the five-year anniversary of beginning my software engineering career. Before this, I did undertake some work experience and completed some freelance projects, but I had no commercial exposure until I started my graduate scheme at Sky on this very day in 2012. Rather than dive into some self-indulgent drivel, Iâ€™d love to share five of the most important things Iâ€™ve learned thus far; I believe that all developers should embrace them. 1. Throw yourself in the deep endI remember my first day in the NOW TV Xbox 360 team. Iâ€™d just finished a 7-month stint on a graduate scheme, working on a number of small internal projects using Ruby and JavaScript. My new team, in contrast, used C#, .NET, and Silverlight. Needless to say, I had no idea where to begin; I covered C#, .NET, and a touch of XAML in the final year of my degree, but not to a commercially-acceptable level. Although my colleagues were incredibly accommodating and helpful, I nonetheless realised that I had to get up to speed if I was to meaningfully contribute to the codebase. As well as working on tickets, I: studied the various aspects of the codebase and searched online for information on concepts that I didnâ€™t understand paired with senior developers to gain insights into effectively implementing new features and refactoring others read books, documentation, and other literature covering: C#; .NET; Silverlight; design patterns; unit testing; and the software development lifecycle (SDLC) Of course, one can only learn at a set pace, and as Iâ€™ll cover later, too much work will ultimately come to a head. However, by placing oneself on an alien project, one will naturally push oneself to work as hard as possible; humans are naturally curious creatures, and we thrive in new settings, regardless of how difficult the challenges ahead may be. If somebody offers you an amazing opportunity but you are not sure you can do it, say yes â€” then learn how to do it later! Richard Branson 2. Be humbleOnce one has gained enough experience as a developer, or in any other capacity for that matter, one consequently gains confidence, and is now in a position to contribute to more complex parts of a codebase, to open source projects, and to the community in general in a variety of ways, such as articles. It can be easy to patronise others who may not have the same skill set, or general level of aptitude, as you. â€œThatâ€™s easy! How can you not know that?!â€ or â€œYou obviously forgot to run the build scriptâ€ may be tempting responses to simple questions, but remember that you were once naÃ¯ve and lacking knowledge. Be kind and humble towards others as if you were at their level. Empathise! Another important facet of humility is to admit when one is wrong. Iâ€™ve encountered my share of developers who, rather than admit that theyâ€™ve misunderstood a concept or take ownership of a problem theyâ€™ve created, attempt to bullshit their way out of a situation. â€œYouâ€™re incapable of understanding my work! I canâ€™t be wrong.â€ Well yes, you can. 3. Listen and be open-minded, but donâ€™t be afraid of demonstrating assertionOn the subject of humility, it is important to be open-minded towards both alternative points of view and new information regarding concepts and ideas to which one is completely new. While the latter case may seem natural, few people are willing to challenge their own views and ultimately alter their own positions; being malleable will allow one to refine oneâ€™s opinions and knowledge which can then be applied to a similar situation further down the road. That said, there is nothing wrong with pushing back if one has experience within the domain of a specific problem and is therefore aware of common pitfalls and best practices. By demonstrating confidence and effective persuasion techniques, one might bring new information to the attention of oneâ€™s colleagues. Being assertive does not make you an arsehole. Me 4. Embrace change, but donâ€™t jump on the bandwagonTo a new developer, the rate of change that one witnesses might seem unmanageable; I would like to counter this by arguing that this is not necessarily the case. In the JavaScript world, itâ€™s clear that new libraries and frameworks are released regularly, and certain programmers (read: hipsters) will adopt them quickly without giving much thought to their applicability to a particular use case. One might therefore feel obliged to follow the emergence of technologies in order to continue to provide value as a developer. I initially felt this pressure, but itâ€™s completely avoidable when one views this in reverse. Whenever Iâ€™m starting a new project, I seek technologies from which it may benefit, and investigate them with the outcome of answering these questions: Does is naturally lend itself to my problem? Is it mature? Does it have a strong community? Is it well-tested? This is by no means an exclusive list, but Iâ€™ve found that this mindset points me in the right direction. I was admittedly very cynical of React when it first emerged. â€œXML in JS?! Surely this is just a pointless abstraction of the DOM.â€ Then I tried it in a new role for an app that rendered large lists of items, which would re-render as a consequence of various interactions; it clicked that it was a great library for this particular application, and I thus realised how wrong I was. One should definitely endeavour to be aware of new approaches, and to use them if appropriate, but thereâ€™s no obligation to use the new hotness for the sake of it; the main goal of software engineering is to, well, deliver software, and choosing the wrong tech could hinder this achievement. 5. Balance work and playAs soon as I wrote my first Hello World program at university, I almost became addicted to programming. Initially, my ability was limited, thus most of my code was ugly (but thatâ€™s OK; itâ€™s part of the learning process.) Once I had worked in the industry for a while and became competent, however, I would spend my evenings and weekends working on all sorts of side projects, and I loved it. I felt that I had truly found my calling, and I just couldnâ€™t stop. Some of these manifested into relatively successful open source projects, as well as contributions to existing codebases. This really gave me a sense of self-esteem, so I kept going. I would enter JavaScript competitions, such as the brilliant js13kGames and JS1k, write articles, and go on to publish a screencast series for SitePoint. I even interviewed with some big tech companies, which resulted in lots of practice and reading. By the end of this, I was completely burned out. I had lost all motivation and could no longer bring myself to program in my spare time. Furthermore, my other hobbies, which allowed me to escape technology when needed, were put on the back burner; I was essentially a code production unit. Itâ€™s important to challenge oneself while one has the opportunity; these means not only enabled me to improve as a developer, but have really advanced my career. However, rest is critical. Youâ€™re a human being; your capacity to learn abstract concepts and work without sufficient breaks will naturally diminish, given our evolutionary origins. If you feel burnout approaching, take a step back for a while. Not just for a week or so; Iâ€™m talking a month or two. Trust me, youâ€™ll know when youâ€™re ready to resume, plus your projects wonâ€™t be going anywhere.","categories":[],"tags":[]},{"title":"Our Best Practices for Writing React Components","slug":"Our-Best-Practices-for-Writing-React-Components","date":"2017-08-20T16:06:29.000Z","updated":"2017-08-21T15:42:19.451Z","comments":true,"path":"2017/08/Our-Best-Practices-for-Writing-React-Components.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Our-Best-Practices-for-Writing-React-Components.html","excerpt":"When I first started writing React, I remember seeing many different approaches to writing components, varying greatly from tutorial to tutorial. Though the framework has matured considerably since then, there doesnâ€™t seem to yet be a firm â€˜rightâ€™ way of doing things. Over the past year at MuseFind, our team has written a lot of React components. Weâ€™ve gradually refined our approach until weâ€™re happy with it. This guide represents our suggested best practices. We hope it will be useful, whether youâ€™re a beginner or experienced.","text":"When I first started writing React, I remember seeing many different approaches to writing components, varying greatly from tutorial to tutorial. Though the framework has matured considerably since then, there doesnâ€™t seem to yet be a firm â€˜rightâ€™ way of doing things. Over the past year at MuseFind, our team has written a lot of React components. Weâ€™ve gradually refined our approach until weâ€™re happy with it. This guide represents our suggested best practices. We hope it will be useful, whether youâ€™re a beginner or experienced.Before we get started, a couple of notes: We use ES6 and ES7 syntax. If youâ€™re not sure of the distinction between presentational and container components, we recommend you read this first. Please let us know in the comments if you have any suggestions, questions, or feedback. Class Based ComponentsClass based components are stateful and/or contain methods. We try to use them as sparingly as possible, but they have their place. Letâ€™s incrementally build our component, line by line. Importing CSS12345import React, &#123; Component &#125; from 'react'import &#123; observer &#125; from 'mobx-react'import ExpandableForm from './ExpandableForm'import './styles/ProfileContainer.css' I like CSS in JavaScript, I do â€” in theory. But itâ€™s still a new idea, and a mature solution hasnâ€™t emerged. Until then, we import a CSS file to each component. We also separate our dependency imports from local imports by a newline. Initializing State12345678import React, &#123; Component &#125; from 'react'import &#123; observer &#125; from 'mobx-react'import ExpandableForm from './ExpandableForm'import './styles/ProfileContainer.css'export default class ProfileContainer extends Component &#123; state = &#123; expanded: false &#125; You can also use the older approach of initializing state in the constructor. More on that here. We prefer the cleaner way. We also make sure to export our class as the default. propTypes and defaultProps12345678910111213141516171819import React, &#123; Component &#125; from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; string, object &#125; from 'prop-types'import ExpandableForm from './ExpandableForm'import './styles/ProfileContainer.css'export default class ProfileContainer extends Component &#123; state = &#123; expanded: false &#125; static propTypes = &#123; model: object.isRequired, title: string &#125; static defaultProps = &#123; model: &#123; id: 0 &#125;, title: 'Your Name' &#125; propTypes and defaultProps are static properties, declared as high as possible within the component code. They should be immediately visible to other devs reading the file, since they serve as documentation. If using React 15.3.0 or higher, use the prop-types package instead of React.PropTypes â€” nicely destructured, of course. All your components should have propTypes. Methods1234567891011121314151617181920212223242526272829303132333435import React, &#123; Component &#125; from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; string, object &#125; from 'prop-types'import ExpandableForm from './ExpandableForm'import './styles/ProfileContainer.css'export default class ProfileContainer extends Component &#123; state = &#123; expanded: false &#125; static propTypes = &#123; model: object.isRequired, title: string &#125; static defaultProps = &#123; model: &#123; id: 0 &#125;, title: 'Your Name' &#125; handleSubmit = (e) =&gt; &#123; e.preventDefault() this.props.model.save() &#125; handleNameChange = (e) =&gt; &#123; this.props.model.changeName(e.target.value) &#125; handleExpand = (e) =&gt; &#123; e.preventDefault() this.setState(&#123; expanded: !this.state.expanded &#125;) &#125; With class components, when you pass methods to subcomponents, you have to ensure that they have the right this when theyâ€™re called. This is usually achieved by passing this.handleSubmit.bind(this) to the subcomponent. We think this approach is cleaner and easier, maintaining the correct context automatically via the ES6 arrow function. Passing setState a FunctionIn the above example, we do this: 1this.setState(&#123; expanded: !this.state.expanded &#125;) Hereâ€™s the dirty secret about setState â€” itâ€™s actually asynchronous. React batches state changes for performance reasons, so the state may not change immediately after setState is called. That means you should not rely on the current state when calling setState â€” since you canâ€™t be sure what that state will be! Hereâ€™s the solution â€” pass a function to setState, with the previous state as an argument. 1this.setState(prevState =&gt; (&#123; expanded: !prevState.expanded &#125;)) (Thanks to Austin Wood for his help with this section). Destructuring Props123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657import React, &#123; Component &#125; from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; string, object &#125; from 'prop-types'import ExpandableForm from './ExpandableForm'import './styles/ProfileContainer.css'export default class ProfileContainer extends Component &#123; state = &#123; expanded: false &#125; static propTypes = &#123; model: object.isRequired, title: string &#125; static defaultProps = &#123; model: &#123; id: 0 &#125;, title: 'Your Name' &#125; handleSubmit = (e) =&gt; &#123; e.preventDefault() this.props.model.save() &#125; handleNameChange = (e) =&gt; &#123; this.props.model.changeName(e.target.value) &#125; handleExpand = (e) =&gt; &#123; e.preventDefault() this.setState(prevState =&gt; (&#123; expanded: !prevState.expanded &#125;)) &#125; render() &#123; const &#123; model, title &#125; = this.props return ( &lt;ExpandableForm onSubmit=&#123;this.handleSubmit&#125; expanded=&#123;this.state.expanded&#125; onExpand=&#123;this.handleExpand&#125;&gt; &lt;div&gt; &lt;h1&gt;&#123;title&#125;&lt;/h1&gt; &lt;input type=\"text\" value=&#123;model.name&#125; onChange=&#123;this.handleNameChange&#125; placeholder=\"Your Name\"/&gt; &lt;/div&gt; &lt;/ExpandableForm&gt; ) &#125;&#125; Components with many props should have each prop on a newline, like above. Decorators12@observerexport default class ProfileContainer extends Component &#123; If youâ€™re using something like mobx, you can decorate your class components like so â€” which is the same as passing the component into a function. Decorators are flexible and readable way of modifying component functionality. We use them extensively, with mobx and our own mobx-models library. If you donâ€™t want to use decorators, do the following: 12345class ProfileContainer extends Component &#123; // Component code&#125;export default observer(ProfileContainer) ClosuresAvoid passing new closures to subcomponents, like so: 1234567&lt;input type=\"text\" value=&#123;model.name&#125; // onChange=&#123;(e) =&gt; &#123; model.name = e.target.value &#125;&#125; // ^Not this. Use the below: onChange=&#123;this.handleChange&#125; placeholder=\"Your Name\"/&gt; Hereâ€™s why: every time the parent component renders, a new function is created and passed to the input. If the input were a React component, this would automatically trigger it to re-render, regardless of whether its other props have actually changed. Reconciliation is the most expensive part of React. Donâ€™t make it harder than it needs to be! Plus, passing a class method is easier to read, debug, and change. Hereâ€™s our full component: Functional ComponentsThese components have no state and no methods. Theyâ€™re pure, and easy to reason about. Use them as often as possible. propTypes123456789101112import React from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; func, bool &#125; from 'prop-types'import './styles/Form.css'ExpandableForm.propTypes = &#123; onSubmit: func.isRequired, expanded: bool&#125;// Component declaration Here, we assign the propTypes before the component declaration, so they are immediately visible. Weâ€™re able to do this because of JavaScript function hoisting. Destructuring Props and defaultProps123456789101112131415161718192021import React from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; func, bool &#125; from 'prop-types'import './styles/Form.css'ExpandableForm.propTypes = &#123; onSubmit: func.isRequired, expanded: bool, onExpand: func.isRequired&#125;function ExpandableForm(props) &#123; const formStyle = props.expanded ? &#123;height: 'auto'&#125; : &#123;height: 0&#125; return ( &lt;form style=&#123;formStyle&#125; onSubmit=&#123;props.onSubmit&#125;&gt; &#123;props.children&#125; &lt;button onClick=&#123;props.onExpand&#125;&gt;Expand&lt;/button&gt; &lt;/form&gt; )&#125; Our component is a function, which takes its props as its argument. We can expand them like so: 123456789101112131415161718192021import React from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; func, bool &#125; from 'prop-types'import './styles/Form.css'ExpandableForm.propTypes = &#123; onSubmit: func.isRequired, expanded: bool, onExpand: func.isRequired&#125;function ExpandableForm(&#123; onExpand, expanded = false, children, onSubmit &#125;) &#123; const formStyle = expanded ? &#123;height: 'auto'&#125; : &#123;height: 0&#125; return ( &lt;form style=&#123;formStyle&#125; onSubmit=&#123;onSubmit&#125;&gt; &#123;children&#125; &lt;button onClick=&#123;onExpand&#125;&gt;Expand&lt;/button&gt; &lt;/form&gt; )&#125; Note we can also use default arguments to act as defaultProps in a highly readable manner. If expanded is undefined, we set it to false. (A bit of a forced example, since itâ€™s a boolean, but very useful for avoiding â€˜Cannot read of undefinedâ€™ errors with objects). Avoid the following ES6 syntax: 1const ExpandableForm = (&#123; onExpand, expanded, children &#125;) =&gt; &#123; Looks very modern, but the function here is actually unnamed. This lack of name will not be a problem if your Babel is set up correctly â€” but if itâ€™s not, any errors will show up as occurring in &lt;&gt; which is terrible for debugging. Unnamed functions can also cause problems with Jest, a React testing library. Due to the potential for difficult-to-understand bugs (and the lack of real benefit) we recommend using function instead of const. WrappingSince you canâ€™t use decorators with functional components, you simply pass it the function in as an argument: 12345678910111213141516171819202122import React from 'react'import &#123; observer &#125; from 'mobx-react'import &#123; func, bool &#125; from 'prop-types'import './styles/Form.css'ExpandableForm.propTypes = &#123; onSubmit: func.isRequired, expanded: bool, onExpand: func.isRequired&#125;function ExpandableForm(&#123; onExpand, expanded = false, children, onSubmit &#125;) &#123; const formStyle = expanded ? &#123;height: 'auto'&#125; : &#123;height: 0&#125; return ( &lt;form style=&#123;formStyle&#125; onSubmit=&#123;onSubmit&#125;&gt; &#123;children&#125; &lt;button onClick=&#123;onExpand&#125;&gt;Expand&lt;/button&gt; &lt;/form&gt; )&#125;export default observer(ExpandableForm) Hereâ€™s our full component: Conditionals in JSXChances are youâ€™re going to do a lot of conditional rendering. Hereâ€™s what you want to avoid: Actual code I wrote in my early days at MuseFindâ€¦ forgive me No, nested ternaries are not a good idea. There are some libraries that solve this problem (JSX-Control Statements), but rather than introduce another dependency, we settled on this approach for complex conditions: A refactored version of the above. Use curly braces wrapping an IIFE, and then put your if statements inside, returning whatever you want to render. Note that IIFEâ€™s like this can cause a performance hit, but in most cases it will not be significant enough to warrant losing the readability factor. Update: Many commenters have recommended extracting this logic to a subcomponent that conditionally returns different buttons based on props. Theyâ€™re right â€” splitting up your components as much as possible is always a good call. But keep the IIFE approach in mind as a fallback for quick conditionals. Also, when you only want to render an element on one condition, instead of doing thisâ€¦ 12345&#123; isTrue ? &lt;p&gt;True!&lt;/p&gt; : &lt;none/&gt;&#125; â€¦ use short-circuit evaluation: 1234&#123; isTrue &amp;&amp; &lt;p&gt;True!&lt;/p&gt;&#125; ConclusionWas this article useful? Please click the green heart below, or follow me and our publication for more. Have any feedback? Leave a comment below. Thanks for reading!","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"Nodejs lÃ  gÃ¬","slug":"Nodejs-la-gi","date":"2017-08-20T15:56:00.000Z","updated":"2017-08-21T15:44:24.511Z","comments":true,"path":"2017/08/Nodejs-la-gi.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Nodejs-la-gi.html","excerpt":"Trong bÃ i viáº¿t giá»›i thiá»‡u vá» asynchronous, event-driven vÃ  non-blocking I/O, mÃ¬nh cÃ³ treo tÃªn Nodejs lÃªn trÃªn tiÃªu Ä‘á» nhÆ°ng tháº­t ra bÃ i viáº¿t áº¥y láº¡i khÃ´ng Ä‘áº£ Ä‘á»™ng Ä‘áº¿n Nodejs Ä‘Æ°á»£c bao nhiÃªu. NÃ³ chá»‰ giá»›i thiá»‡u Ã½ nghÄ©a cá»§a cÃ¡c khÃ¡i niá»‡m trÃªn trong ngá»¯ cáº£nh mÃ  Nodejs sá»­ dá»¥ng. Láº§n nÃ y lÃ  má»™t bÃ i viáº¿t chÃ¢n tháº­t vá» Nodejs. HÃ£y cÃ¹ng nhau tráº£ lá»i má»™t cÃ¢u há»i mang tÃ­nh báº£n thá»ƒ luáº­n vá» Nodejs: Báº£n cháº¥t cá»§a Nodejs lÃ  gÃ¬? Trong bÃ i viáº¿t giá»›i thiá»‡u vá» asynchronous, event-driven vÃ  non-blocking I/O, mÃ¬nh cÃ³ treo tÃªn Nodejs lÃªn trÃªn tiÃªu Ä‘á» nhÆ°ng tháº­t ra bÃ i viáº¿t áº¥y láº¡i khÃ´ng Ä‘áº£ Ä‘á»™ng Ä‘áº¿n Nodejs Ä‘Æ°á»£c bao nhiÃªu. NÃ³ chá»‰ giá»›i thiá»‡u Ã½ nghÄ©a cá»§a cÃ¡c khÃ¡i niá»‡m trÃªn trong ngá»¯ cáº£nh mÃ  Nodejs sá»­ dá»¥ng. Láº§n nÃ y lÃ  má»™t bÃ i viáº¿t chÃ¢n tháº­t vá» Nodejs. HÃ£y cÃ¹ng nhau tráº£ lá»i má»™t cÃ¢u há»i mang tÃ­nh báº£n thá»ƒ luáº­n vá» Nodejs: Báº£n cháº¥t cá»§a Nodejs lÃ  gÃ¬?","text":"Trong bÃ i viáº¿t giá»›i thiá»‡u vá» asynchronous, event-driven vÃ  non-blocking I/O, mÃ¬nh cÃ³ treo tÃªn Nodejs lÃªn trÃªn tiÃªu Ä‘á» nhÆ°ng tháº­t ra bÃ i viáº¿t áº¥y láº¡i khÃ´ng Ä‘áº£ Ä‘á»™ng Ä‘áº¿n Nodejs Ä‘Æ°á»£c bao nhiÃªu. NÃ³ chá»‰ giá»›i thiá»‡u Ã½ nghÄ©a cá»§a cÃ¡c khÃ¡i niá»‡m trÃªn trong ngá»¯ cáº£nh mÃ  Nodejs sá»­ dá»¥ng. Láº§n nÃ y lÃ  má»™t bÃ i viáº¿t chÃ¢n tháº­t vá» Nodejs. HÃ£y cÃ¹ng nhau tráº£ lá»i má»™t cÃ¢u há»i mang tÃ­nh báº£n thá»ƒ luáº­n vá» Nodejs: Báº£n cháº¥t cá»§a Nodejs lÃ  gÃ¬? Trong bÃ i viáº¿t giá»›i thiá»‡u vá» asynchronous, event-driven vÃ  non-blocking I/O, mÃ¬nh cÃ³ treo tÃªn Nodejs lÃªn trÃªn tiÃªu Ä‘á» nhÆ°ng tháº­t ra bÃ i viáº¿t áº¥y láº¡i khÃ´ng Ä‘áº£ Ä‘á»™ng Ä‘áº¿n Nodejs Ä‘Æ°á»£c bao nhiÃªu. NÃ³ chá»‰ giá»›i thiá»‡u Ã½ nghÄ©a cá»§a cÃ¡c khÃ¡i niá»‡m trÃªn trong ngá»¯ cáº£nh mÃ  Nodejs sá»­ dá»¥ng. Láº§n nÃ y lÃ  má»™t bÃ i viáº¿t chÃ¢n tháº­t vá» Nodejs. HÃ£y cÃ¹ng nhau tráº£ lá»i má»™t cÃ¢u há»i mang tÃ­nh báº£n thá»ƒ luáº­n vá» Nodejs: Báº£n cháº¥t cá»§a Nodejs lÃ  gÃ¬? Node.js is a JavaScript runtime built on Chromeâ€™s V8 JavaScript Engine. JavaScript thÃ¬ dá»… hiá»ƒu rá»“i (Tháº­t ra Chrome cÅ©ng dá»… hiá»ƒu), nhÆ°ng cÃ²n Runtime vá»›i Engine lÃ  gÃ¬? Má»‘i quan há»‡ giá»¯a chÃºng nhÆ° tháº¿ nÃ o? JavaScript Engine cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a má»™t cÃ¡ch Ä‘Æ¡n giáº£n nhÆ° sau: Má»™t chÆ°Æ¡ng trÃ¬nh hoáº·c thÆ° viá»‡n thá»±c thi mÃ£ JavaScript, cung cáº¥p cÃ¡c cÆ¡ cháº¿ khá»Ÿi táº¡o object, gá»i function,â€¦ CÃ³ thá»ƒ Ä‘Æ¡n giáº£n lÃ  má»™t interpreter hoáº·c má»™t JIT compiler to bytecode. Táº¥t nhiÃªn, vÃ¬ cáº£ bÃ i viáº¿t nÃ y chá»‰ nháº±m nhiá»‡m vá»¥ tráº£ lá»i Nodejs lÃ  gÃ¬, mÃ  biáº¿t Ä‘Æ°á»£c JavaScript Engine lÃ  gÃ¬ tá»©c lÃ  Ä‘Ã£ xong 50% váº¥n Ä‘á», nÃªn ta sáº½ giáº£i thÃ­ch láº¡i, má»™t cÃ¡ch phá»©c táº¡p vÃ  dÃ i dÃ²ng hÆ¡n, báº¯t Ä‘áº§u tá»« nhá»¯ng khÃ¡i niá»‡m cÆ¡ báº£n hÆ¡n nhÆ° Interpreter vÃ  Compiler. Interpreter vÃ  Compiler Interpreter (cá»§a ngÃ´n ngá»¯ A): Má»™t thÃ nh pháº§n cÃ³ chá»©c nÄƒng trá»±c tiáº¿p thá»±c thi má»™t Ä‘oáº¡n code (Ä‘Æ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ A). CÃ³ thá»ƒ coi CPU nhÆ° má»™t interpreter cá»§a táº­p chá»‰ lá»‡nh tÆ°Æ¡ng á»©ng. NgÃ y nay, interpreter thÆ°á»ng hiá»ƒu theo Ã½ nghÄ©a trá»±c tiáº¿p má»™t chÆ°Æ¡ng trÃ¬nh tá»« source code mÃ  khÃ´ng qua chuyá»ƒn Ä‘á»•i thÃ nh machine code. Compiler: Dá»‹ch tá»« ngÃ´n ngá»¯ A sang ngÃ´n ngá»¯ B sao cho khi thá»±c thi thu Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng Ä‘Æ°Æ¡ng. ThÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ dá»‹ch source code tá»« ngÃ´n ngá»¯ báº­c cao A sang ngÃ´n ngá»¯ B cÃ³ báº­c tháº¥p hÆ¡n dá»… dÃ ng interprete hÆ¡n, vÃ  táº¥t nhiÃªn ngÃ´n ngá»¯ dá»… interprete nháº¥t lÃ  machine code. Thá»i gian cáº§n Ä‘á»ƒ compile thÆ°á»ng khÃ´ng pháº£i lÃ  nhá», nháº¥t lÃ  khi cáº§n tá»‘i Æ°u hoÃ¡ káº¿t quáº£. Äá»ƒ giáº£m thiá»ƒu thá»i gian compile, cÃ³ má»™t cÃ¡ch (Ä‘Ã¡nh Ä‘á»•i bá»Ÿi tá»‘c Ä‘á»™ thá»±c thi sau khi compile) lÃ  khÃ´ng dá»‹ch trá»±c tiáº¿p source code ra machine code mÃ  dá»‹ch sang má»™t ngÃ´n ngá»¯ trung gian vÃ  sá»­ dá»¥ng interpreter cho ngÃ´n ngá»¯ trung gian nÃ y, thÆ°á»ng gá»i lÃ  bytecode, vá»›i Ä‘áº·c Ä‘iá»ƒm lÃ  thá»i gian compile tá»« ngÃ´n ngá»¯ nguá»“n sang bytecode nhanh hÆ¡n sang machine code, tá»‘c Ä‘á»™ thá»±c thi nhanh hÆ¡n viá»‡c trá»±c tiáº¿p interprete source code, máº·c dÃ¹ cháº­m hÆ¡n machine code. Tá»« interpreter vÃ  bytecode trong Ä‘á»‹nh nghÄ©a vá» JavaScript Engine Ä‘Ã£ rÃµ rÃ ng, váº­y cÃ²n JIT compiler? Äá»ƒ cÃ³ má»™t cÃ¡i nhÃ¬n vá» JIT compiler, chÃºng ta cáº§n xem xÃ©t nÃ³ trong má»™t má»‘i quan há»‡ biá»‡n chá»©ng giá»¯a nÃ³ vÃ  má»™t khÃ¡i niá»‡m khÃ¡c: AOT compiler. Ahead-of-Time (AOT) vÃ  Just-in-Time (JIT) compilation: Tá»« time Ä‘Æ°á»£c nháº¯c Ä‘áº¿n á»Ÿ Ä‘Ã¢y lÃ  runtime. AOT dá»‹ch toÃ n bá»™ source code trÆ°á»›c khi báº¯t Ä‘áº§u cháº¡y chÆ°Æ¡ng trÃ¬nh, JIT thÃ¬ trÃ¡i láº¡i compile source code trong thá»i gian cháº¡y. Triáº¿t lÃ½ cá»§a JIT compilation lÃ  thay vÃ¬ pháº£i chá» compiler dá»‹ch toÃ n bá»™ source, viá»‡c cÃ³ thá»ƒ máº¥t nhiá»u thá»i gian, ta dá»‹ch tá»«ng pháº§n mÃ  ta cáº§n dÃ¹ng trÆ°á»›c rá»“i báº¯t Ä‘áº§u cháº¡y vá»›i chÃºng ngay láº­p tá»©c. Interpreter vÃ  compiler cÃ³ thá»ƒ káº¿t há»£p trá»Ÿ thÃ nh engine cá»§a má»™t ngÃ´n ngá»¯ theo 1 trong 2 cÃ¡ch: AOT káº¿t há»£p interpreter: Source code Ä‘Æ°á»£c compile toÃ n bá»™ thÃ nh machine code hoáº·c bytecode trÆ°á»›c khi khá»Ÿi cháº¡y chÆ°Æ¡ng trÃ¬nh, sau Ä‘Ã³ sá»­ dá»¥ng má»™t interpreter Ä‘á»ƒ thá»±c thi. VÃ­ dá»¥ Python Ä‘Æ°á»£c AOT compiler dá»‹ch thÃ nh cpython bytecode trong chá»›p nhoÃ¡ng vÃ  cpython Ä‘Æ°á»£c cháº¡y trÃªn interpreter. JIT káº¿t há»£p interpreter: Thá»±c táº¿ lÃ  full compiled code cháº¡y nhanh hÆ¡n nhÆ°ng tá»‘n nhiá»u thá»i gian trÆ°á»›c khi báº¯t Ä‘áº§u cháº¡y, trá»±c tiáº¿p interprete source code thÃ¬ cÃ³ thá»ƒ báº¯t Ä‘áº§u cháº¡y ngay nhÆ°ng tá»‘c Ä‘á»™ thá»±c thi cháº­m. Giáº£i phÃ¡p trung hoÃ  lÃ  sá»­ dá»¥ng interpreter Ä‘á»ƒ khá»Ÿi cháº¡y nhanh chÃ³ng source code, rá»“i dÃ¹ng JIT compiler Ä‘á»ƒ dá»‹ch vÃ  thay tháº¿ source code báº±ng compiled code sau khi Ä‘Ã£ dá»‹ch xong. V8 EngineV8 lÃ  má»™t open source JavaScript engine viáº¿t báº±ng C++, phÃ¡t triá»ƒn bá»Ÿi Google nhÆ° lÃ  má»™t pháº§n trong dá»± Ã¡n Chromium, phÃ¡t hÃ nh láº§n Ä‘áº§u cÃ¹ng vá»›i phiÃªn báº£n Ä‘áº§u tiÃªn cá»§a trÃ¬nh duyÃªt Chrome. V8 compile trá»±c tiáº¿p JavaScript thÃ nh native machine code thay vÃ¬ sá»­ dá»¥ng interpreting bytecode theo cÃ¡ch truyá»n thá»‘ng. Nodejs Ä‘Æ°á»£c xÃ¢y dá»±ng láº§n Ä‘áº§u trÃªn V8 do tá»‘c Ä‘á»™ thá»±c thi Ä‘Ã¡ng kinh ngáº¡c so vá»›i cÃ¡c JavaScript Engine trÆ°á»›c Ä‘Ã³, Ä‘á»§ sá»©c Ä‘áº£m Ä‘Æ°Æ¡ng má»™t há»‡ thá»‘ng yÃªu cáº§u hiá»‡u nÄƒng cao trÃªn server-side. NgÃ y nay thÃ¬ cÃ¡c Engine cá»§a cÃ¡c hÃ£ng khÃ¡c cÅ©ng Ä‘Ã£ báº¯t ká»‹p V8 rá»“i, vá»«a rá»“i Nodejs cÅ©ng Ä‘Ã£ phÃ¡t hÃ nh má»™t phiÃªn báº£n sá»­ dá»¥ng Chakra Enginecá»§a Microsoft táº¡i https://github.com/nodejs/node-chakracore, nhÆ°ng cÃ³ láº½ khi nháº¯c Ä‘áº¿n Nodejs thÃ¬ ta chá»‰ cáº§n giá»›i thiá»‡u vá» V8 lÃ  Ä‘á»§. V8 Engine Ä‘Æ°á»£c Google lá»±a chá»n quáº£ tháº­t lÃ  má»™t cÃ¡i tÃªn mang nhiá»u cáº£m xÃºc, gá»£i lÃªn hÃ¬nh áº£nh vá» nhá»¯ng Ä‘á»™ng cÆ¡ Ã´ tÃ´ máº¡nh máº½, sáº£n sinh cÃ´ng suáº¥t lá»›n tá»« thiáº¿t káº¿ 8 xy-lanh sáº¯p xáº¿p hÃ¬nh chá»¯ V mÃ  hiáº¿m khi nÃ o cÃ³ tá»•ng dung tÃ­ch dÆ°á»›i 3.0 L, tháº­m chÃ­ lÃªn Ä‘áº¿n hÆ¡n 8.0 L, vÃ­ nhÆ° Ä‘á»™ng cÆ¡ cá»§a chiáº¿c Audi R8 trong hÃ¬nh dÆ°á»›i. KhÃ¡ cháº¯c lÃ  cÃ¡c ká»¹ sÆ° cá»§a Google cÅ©ng ráº¥t mÃª xe, bá»Ÿi há» tiáº¿p tá»¥c Ä‘áº·t tÃªn cho cÃ¡c thÃ nh pháº§n trong Ä‘á»™ng cÆ¡ V8 cá»§a mÃ¬nh lÃ  Crankshaft, TuborFan vÃ  Ignition, cÃ¡c thÃ nh pháº§n ká»¹ thuáº­t cá»§a Ä‘á»™ng cÆ¡ Ä‘á»‘t trong hiá»‡n Ä‘áº¡i mÃ  chÃºng ta sáº½ báº¯t gáº·p trong pháº§n sau cá»§a bÃ i viáº¿t. Lan man váº­y thÃ´i, bÃ¢y giá», ba yáº¿u tá»‘ then chá»‘t táº¡o nÃªn hiá»‡u nÄƒng cao cá»§a V8 lÃ : Fast Property Access Dynamic Machine Code Generation Efficient Garbage Collection Fast Property AccessJavaScript lÃ  má»™t dynamic programming language, cÃ³ nghÄ©a, cÃ¡c property cÃ³ thá»ƒ Ä‘Æ°á»£c thÃªm, bá»›t, thay Ä‘á»•i trong thá»i gian cháº¡y. Háº§u háº¿t cÃ¡c JavaScript Engine sá»­ dá»¥ng má»™t cáº¥u trÃºc dá»¯ liá»‡u dáº¡ng dictionary Ä‘á»ƒ lÆ°u giá»¯ cÃ¡c property trong object, má»—i truy cáº­p Ä‘áº¿n property yÃªu cáº§u má»™t dictionary dynamic lookup Ä‘á»ƒ tÃ¬m ra vá»‹ trÃ­ cá»§a property trong memory, cháº­m hÆ¡n cÃ¡ch truy cáº­p trá»±c tiáº¿p Ä‘áº¿n property trong cÃ¡c class-based language truyá»n thá»‘ng. Äá»ƒ trÃ¡nh dynamic lookup, V8 tá»± Ä‘á»™ng ngáº§m táº¡o má»™t hidden class cho má»—i object, biáº¿n object trong JavaScript thÃ nh class-based. Má»—i khi object Ä‘Æ°á»£c thÃªm property, V8 táº¡o má»›i má»™t hidden class vÃ  object chuyá»ƒn hidden class cá»§a nÃ³ sang class má»›i nÃ y. Nguá»“n áº£nh: v8project.blogspot.com Ká»ƒ tá»« khi object trong JavaScript trá»Ÿ thÃ nh class-based, má»™t ká»¹ thuáº­t compiler optimization kinh Ä‘iá»ƒn trá»Ÿ nÃªn kháº£ thi vÃ  Ä‘Æ°á»£c Ä‘Æ°a vÃ o V8, Inline Caching, giÃºp tÄƒng lá»±c cho JavaScript lÃªn tháº­m chÃ­ vÃ i chá»¥c láº§n vá»›i long runtime. Dynamic Machine Code GenerationV8 dá»‹ch trá»±c tiáº¿p JavaScript source code sang native machine code, cho tá»‘c Ä‘á»™ interprete cao, Ä‘á»“ng thá»i cÃ³ kháº£ nÄƒng linh Ä‘á»™ng tá»‘i Æ°u hoÃ¡ (vÃ  tÃ¡i tá»‘i Æ°u) compiled code trong thá»i gian cháº¡y dá»±a trÃªn cÃ¡c dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c tá»« profiler. V8 cÃ³ 2 compiler, ban Ä‘áº§u, táº¥t cáº£ source code cá»§a báº¡n sáº½ Ä‘Æ°á»£c phÃ¢n tÃ­ch cÃº phÃ¡p, chuyá»ƒn thÃ nh AST rá»“i Ä‘áº©y vÃ o Full-Codegen Compiler, nÆ¡i sáº½ cho ra phiÃªn báº£n machine code Ä‘áº§u tiÃªn cá»§a chÆ°Æ¡ng trÃ¬nh. Full-Codegen Compiler: Nhiá»‡m vá»¥ lÃ  chuyá»ƒn source code cá»§a báº¡n thÃ nh machine code nhanh nháº¥t cÃ³ thá»ƒ, khá»i optimize gÃ¬ luÃ´n. NÃ³ cÅ©ng thÃªm vÃ o má»™t Ã­t type-feedback code thu tháº­p thÃ´ng tin Ä‘á»ƒ phá»¥c vá»¥ cÃ´ng viá»‡c optimize code sau nÃ y. Compiler khÃ´ng tiáº¿n hÃ nh báº¥t cá»© phÃ¢n tÃ­ch vÃ  khÃ´ng biáº¿t gÃ¬ vá» kiá»ƒu dá»¯ liá»‡u trong source code táº¡i thá»i Ä‘iá»ƒm nÃ y. Äá»ƒ gia tÄƒng hiá»‡u nÄƒng, V8 tiáº¿p tá»¥c theo dÃµi chÆ°Æ¡ng trÃ¬nh trong runtime báº±ng má»™t profiler, má»™t thÃ nh pháº§n trong kiáº¿n trÃºc cá»§a V8, sáº½ thu tháº­p thÃ´ng tin vÃ  tÃ¬m xem function nÃ o lÃ  hot function, tá»©c Ä‘Æ°á»£c dÃ¹ng Ä‘i dÃ¹ng láº¡i ráº¥t nhiá»u láº§n, Ä‘Ã³ lÃ  thá»i Ä‘iá»ƒm cáº§n tiáº¿n hÃ nh optimize cho má»™t compiled code tá»‘t hÆ¡n. VÃ  Ä‘Ã³ lÃ  thá»i Ä‘iá»ƒm Crankshaft vÃ o cuá»™c. Optimizing compiler: Crankshaft (vÃ  má»›i Ä‘Ã¢y lÃ  TuborFan Ä‘Æ°á»£c thÃªm vÃ o) Ä‘Æ°a ra nhá»¯ng dá»± Ä‘oÃ¡n vá» function dá»±a vÃ o nhá»¯ng thÃ´ng tin thu Ä‘Æ°á»£c tá»« profiler, re-compile vÃ  thay tháº¿ pháº§n code chÆ°a Ä‘Æ°á»£c optimize báº±ng cÃ¡ch sá»­ dá»¥ng on-stack replacement (OSR). Náº¿u nhá»¯ng giáº£ Ä‘á»‹nh lÃ  sai láº§m, vÃ­ dá»¥ nÃ³ cho ráº±ng a, b sáº½ luÃ´n lÃ  number trong phÃ©p tÃ­nh a + b á»Ÿ Ä‘Ã¢u Ä‘Ã³, vÃ  sá»­ dá»¥ng tháº³ng phÃ©p cá»™ng 2 sá»‘ á»Ÿ Ä‘Ã¢y thay vÃ¬ láº§n nÃ o cÅ©ng pháº£i kiá»ƒm tra kiá»ƒu vÃ  sá»­ dá»¥ng + operator thÃ­ch há»£p, mÃ  báº¥t chá»£t b láº¡i nháº­n kiá»ƒu lÃ  string, thÃ¬ nÃ³ chá»‰ Ä‘Æ¡n giáº£n lÃ  de-optimizing vÃ  tÃ¡i sá»­ dá»¥ng pháº§n code chÆ°a optimize. ÄÃ¢y lÃ  cÃ¡ch V8 Ä‘á»‘i xá»­ vá»›i source code cá»§a chÃºng ta: Nguá»“n áº£nh: v8project.blogspot.com Trong nÄƒm 2016, má»™t interpreter mang tÃªn Ingition Ä‘Æ°á»£c thÃªm vÃ o V8 vá»›i má»¥c Ä‘Ã­ch giáº£m thiá»ƒu chiáº¿m dá»¥ng bá»™ nhá»› trÃªn nhá»¯ng há»‡ thá»‘ng cÃ³ memory nhá» nhÆ° Android. Efficient Garbage CollectionGarbage collector cá»§a V8, Ä‘Æ°á»£c quáº£ng cÃ¡o lÃ  má»™t stop-the-world, generational, accurate, garbage collector lÃ m nhiá»‡m vá»¥ thu há»“i memory Ä‘á»‘i vá»›i nhá»¯ng object khÃ´ng cÃ²n Ä‘Æ°á»£c process sá»­ dá»¥ng má»™t cÃ¡ch ráº¥t hiá»‡u quáº£. CÃ²n nÃ³ hiá»‡u quáº£ nhÆ° tháº¿ nÃ o, táº¡i sao hay tháº­m chÃ­ nÃ³ cÃ³ tháº­t sá»± hiá»‡u quáº£ hÆ¡n cÃ¡c engine khÃ¡c hay khÃ´ng thÃ¬ mÃ¬nh cÅ©ng khÃ´ng rÃµ. Ban Ä‘áº§u, JavaScript Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thá»±c hiá»‡n má»™t sá»‘ nhiá»‡m vá»¥ nhá» nhoi vÃ  ngáº¯n ngá»§i, vÃ­ dá»¥ nhÆ° Ä‘áº·t má»™t event listener cho má»™t element trÃªn browser, engine lÃºc áº¥y chá»‰ Ä‘Æ¡n giáº£n lÃ  má»™t interpreter Ä‘á»c vÃ  thá»±c thi JavaScript source code. Dáº§n dáº§n, theo thá»i gian, chÃºng ta yÃªu cáº§u nhiá»u hÆ¡n tá»« nÃ³. á»¨ng dá»¥ng Ä‘áº§u tiÃªn giao phÃ³ nhá»¯ng nhiá»‡m vá»¥ náº·ng ná» cho JavaScript lÃ  Google Map. Tá»« Ä‘Ã¢y ngÆ°á»i ta nháº­n ra sá»± cáº§n thiáº¿t cá»§a má»™t JavaScript nhanh hÆ¡n, trong má»™t runtime dÃ i hÆ¡i hÆ¡n. JIT compilation cáº§n nhiá»u thá»i gian Ä‘á»ƒ khá»Ÿi táº¡o hÆ¡n interpretation, nhÆ°ng nhanh hÆ¡n ráº¥t nhiá»u trong runtime dÃ i. Vá»›i nhá»¯ng web application dÃ¹ng nhiá»u JavaScript cá»§a mÃ¬nh, Google Ä‘Ã£ dÃ nh nhiá»u cÃ´ng sá»©c Ä‘á»ƒ thÃºc Ä‘áº©y cÃ¡c trÃ¬nh duyá»‡t cáº£i thiá»‡n hiá»‡u suáº¥t cá»§a JavaScript, vÃ  V8 ra Ä‘á»i nhÆ° má»™t káº¿t quáº£. Giá» Ä‘Ã¢y, má»™t process JavaScript cháº¡y cÃ ng lÃ¢u, cÃ ng Ä‘Æ°á»£c optimize vÃ  cÃ ng sá»Ÿ há»¯u hiá»‡u nÄƒng cao hÆ¡n, má»i ngÆ°á»i cáº£m tháº¥y nÃ³ Ä‘Ã£ kháº£ thi Ä‘á»ƒ xuáº¥t hiá»‡n trong má»™t mÃ´i trÆ°á»ng kháº¯c nghiá»‡t hÆ¡n lÃ  trÃªn web browser, server-side. JavaScript RuntimeÄÆ°á»£c giá»›i thiá»‡u lÃ  má»™t JavaScript Runtime, Nodejs cÃ³ gÃ¬ khÃ¡c biá»‡t vá»›i má»™t JavaScript Engine? Láº¥y cáº£m há»©ng tá»« má»™t cÃ¢u tráº£ lá»i trÃªn Stackoverflow, chÃºng ta cÃ³ thá»ƒ táº¡m hiá»ƒu nhÆ° sau: JavaScript cháº¡y trÃªn má»™t container â€“ má»™t chÆ°Æ¡ng trÃ¬nh sáº½ nháº­n source code cá»§a báº¡n vÃ  thá»±c thi nÃ³. ChÆ°Æ¡ng trÃ¬nh nÃ y lÃ m hai Ä‘iá»u: PhÃ¢n thÃ­ch source code vÃ  thá»±c thi tá»«ng Ä‘Æ¡n vá»‹ cÃ³ thá»ƒ. Cung cáº¥p má»™t vÃ i object Ä‘á»ƒ JavaScript cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i tháº¿ giá»›i bÃªn ngoÃ i. Pháº§n Ä‘áº§u, gá»i lÃ  Engine. Pháº§n cÃ²n láº¡i, gá»i lÃ  Runtime. TrÃªn thá»±c táº¿, V8 implement má»™t ECMAScript theo Ä‘Ãºng chuáº©n, tá»©c lÃ  nhá»¯ng gÃ¬ ngoÃ i chuáº©n thÃ¬ khÃ´ng cÃ³ máº·t trong V8. Äá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng, V8 cung cáº¥p cÃ¡c lá»›p template bá»c ngoÃ i cÃ¡c object vÃ  function viáº¿t bá»Ÿi C++. CÃ¡c C++ function nÃ y cÃ³ thá»ƒ lÃ m nhiá»‡m vá»¥ Ä‘á»c/ghi file system, thao tÃ¡c networking hoáº·c giao tiáº¿p vá»›i cÃ¡c process khÃ¡c trong há»‡ thá»‘ng. Báº±ng cÃ¡ch thiáº¿t láº­p má»™t JavaScript context vá»›i global scope chá»©a cÃ¡c JavaScript instance táº¡o ra tá»« cÃ¡c template vÃ  cháº¡y source code cá»§a chÃºng ta trong context nÃ y, mÃ£ cá»§a chÃºng ta Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ giao tiáº¿p vá»›i tháº¿ giá»›i. VÃ  Ä‘Ã³ lÃ  nhiá»‡m vá»¥ cá»§a má»™t Runtime Library: Táº¡o ra má»™t runtime environment cung cáº¥p cÃ¡c thÆ° viá»‡n built-in dÆ°á»›i dáº¡ng cÃ¡c biáº¿n global Ä‘á»ƒ mÃ£ cá»§a báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng trong thá»i gian cháº¡y, Ä‘Ã³n nháº­n source code nhÆ° lÃ  má»™t argument vÃ  thá»±c thi nÃ³ trong context Ä‘Ã£ táº¡o. Vá»›i browser runtime environment nhÆ° Chrome, context mÃ  Chrome cung cáº¥p cho V8 bao gá»“m cÃ¡c biáº¿n global nhÆ° window, console, DOM object, XMLHttpRequest vÃ  timer setTimeout(). Táº¥t cáº£ nhá»¯ng thá»© áº¥y Ä‘áº¿n tá»« Chrome, khÃ´ng pháº£i tá»« báº£n thÃ¢n V8. Thay vÃ o Ä‘Ã³, V8 cung cáº¥p cÃ¡c built-in object chuáº©n, cÃ³ máº·t trong má»i environment cá»§a JavaScript, Ä‘Æ°á»£c miÃªu táº£ trong ECMAScript Standard, bao gá»“m cÃ¡c kiá»ƒu dá»¯ liá»‡u, operator, má»™t sá»‘ object vÃ  function Ä‘áº·c biá»‡t nhÆ° cÃ¡c value property (Infinity, NaN, null, undefined), Object, Function, Boolean, String, Number, Map, Set, Array, parseInt(), eval(),â€¦ Rá»i xa tháº¿ giá»›i browser, rá»i xa DOM, Nodejs mang Ä‘áº¿n cho chÃºng ta nhiá»u built-in library hÆ¡n nhÆ° fs Ä‘á»ƒ giao tiáº¿p vá»›i file system, http vÃ  https cho networking, tls, tty, cluster, os,â€¦ Váº¥n Ä‘á» lÃ  khÃ´ng pháº£i lÃºc nÃ o ta cÅ©ng cáº§n táº¥t cáº£ nhá»¯ng thá»© nÃ y, viá»‡c táº¡o má»™t context mang quÃ¡ nhiá»u global variable khÃ´ng cáº§n thiáº¿t nhÆ° váº­y rÃµ rÃ ng khÃ´ng pháº£i lÃ  má»™t cÃ¡ch lÃ m hay. Nodejs bá»Ÿi váº­y nhÃ³m nhiá»u chá»©c nÄƒng vÃ o cÃ¡c module khÃ¡c nhau vÃ  thá»±c hiá»‡n má»™t cÆ¡ cháº¿ module loading thÃ´ng qua tá»« khoÃ¡ require vÃ  exports, cho phÃ©p táº¡o ra nhá»¯ng context linh Ä‘á»™ng hÆ¡n. Táº¥t nhiÃªn, cÆ¡ cháº¿ nÃ y Ä‘Æ°á»£c implement báº±ng C/C++. ÄÃ³ lÃ  diá»…n giáº£i Ä‘áº±ng sau lá»i giá»›i thiá»‡u runtime built on Chromeâ€™s V8 JavaScript Engine cá»§a Nodejs, vÃ  Ä‘Ã³ lÃ  cÃ¡ch mÃ£ JavaScript cá»§a báº¡n thao tÃ¡c vá»›i cÃ¡c low-level API, theo má»™t cÃ¡ch Ä‘á»“ng bá»™ (synchronous). V8 cháº¡y mÃ£ cá»§a báº¡n trong má»™t single thread, tuáº§n tá»± tá»«ng lá»‡nh má»™t, sá»­ dá»¥ng má»™t cáº¥u trÃºc Ä‘á»ƒ quáº£n lÃ½ cÃ¡c active subroutine gá»i lÃ  call stack. Call Stack vÃ  Event LoopCall stack khÃ´ng pháº£i lÃ  má»™t Ä‘iá»u gÃ¬ Ä‘Ã³ má»›i máº», thá»±c táº¿ chÃºng ta luÃ´n luÃ´n pháº£i sá»­ dá»¥ng nÃ³ Ä‘á»ƒ Ä‘áº£m báº£m chÆ°Æ¡ng trÃ¬nh thá»±c thi má»™t cÃ¡ch Ä‘Ãºng Ä‘áº¯n, cháº³ng qua trong cÃ¡c ngÃ´n ngá»¯ báº­c cao, viá»‡c cung cáº¥p má»™t call stack Ä‘Æ°á»£c áº©n Ä‘i vÃ  tá»± Ä‘á»™ng hoÃ¡. Náº¿u push quÃ¡ nhiá»u stack frame vÃ o vÃ  tiÃªu tá»‘n háº¿t khÃ´ng gian Ä‘Æ°á»£c cáº¥p cho call stack, chÃºng ta sáº½ Ä‘á»‘i diá»‡n vá»›i Stackoverflow huyá»n thoáº¡i. CÃ¢u chuyá»‡n vá» call stack cá»§a JavaScript cÃ³ láº½ chÃºng ta Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c nghe ká»ƒ ráº¥t nhiá»u láº§n. Ta Ä‘á»u biáº¿t ráº±ng stack frame Ä‘Æ°á»£c push má»—i khi má»™t hÃ m Ä‘Æ°á»£c gá»i, vÃ  Ä‘Æ°á»£c pop vá»›i lá»‡nh return. Sau khi láº§n lÆ°á»£t xá»­ lÃ½ háº¿t cÃ¡c lá»‡nh trong chÆ°Æ¡ng trÃ¬nh, call stack trá»Ÿ nÃªn rá»—ng ruá»™t, má»™t phÃ©p mÃ u mang tÃªn event loop sáº½ nháº·t cÃ¡c hÃ m callback trong má»™t táº¡o váº­t gá»i lÃ  event queue (hay task queue), Ä‘áº©y vÃ o trong call stack, vÃ  V8 engine tiáº¿p tá»¥c thá»±c thi hÃ m Ä‘ang náº±m trong call stack nÃ y. ÄÃ¢y lÃ  cÃ¡ch JavaScript thá»±c hiá»‡n asynchronous call. ÄÃ¢y cÅ©ng lÃ  lÃ½ do táº¡i sao gá»i timer setTimeout() vá»›i Ä‘á»‘i sá»‘ lÃ  0, hÃ m callback cá»§a chÃºng ta váº«n pháº£i chá» cho Ä‘áº¿n khi táº¥t cáº£ code trong chÆ°Æ¡ng trÃ¬nh thá»±c thi xong (call stack trá»Ÿ thÃ nh empty) thÃ¬ má»›i Ä‘Æ°á»£c invoke. Nguá»“n áº£nh: appsdev.is.ed.ac.uk V8 nháº­n event loop nhÆ° lÃ  má»™t Ä‘á»‘i sá»‘ Ä‘áº§u vÃ o khi khá»Ÿi táº¡o environment, cÃ¡c mÃ´i trÆ°á»ng khÃ¡c nhau sáº½ cÃ³ event loop vÃ  API Ä‘á»ƒ táº¡o asynchronous request, thá»© mÃ  sáº½ Ä‘áº©y callback function cá»§a ta vÃ o trong event queue rá»“i váº­t vá» ngá»“i Ä‘á»£i, cá»§a riÃªng mÃ¬nh. Vá»›i Nodejs, event loop implementation cá»§a nÃ³ lÃ  libuv. Thiáº¿u Ä‘i libuv, bá»©c tranh vá» má»™t Nodejs event-driven asynchronous non-blocking I/O sáº½ khÃ´ng thá»ƒ hoÃ n thiá»‡n. V8 thÃ¬ tháº­m chÃ­ cÃ²n cháº³ng biáº¿t I/O lÃ  cÃ¡i gÃ¬ chá»© Ä‘á»«ng nÃ³i Ä‘áº¿n blocking hay khÃ´ng blocking. Vá» libuv vÃ  cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng láº¡i lÃ  má»™t cÃ¢u chuyá»‡n dÃ i mÃ  thá»i lÆ°á»£ng á»Ÿ Ä‘Ã¢y khÃ´ng cho phÃ©p mÃ¬nh giá»›i thiá»‡u. Xin háº¹n Ä‘Æ°á»£c chia sáº» vá» nÃ³ trong má»™t bÃ i viáº¿t khÃ¡c, mÃ  chÃ­nh xÃ¡c ra thÃ¬ lÃ  bÃ i viáº¿t nÃ y: http://sotatek.com/nodejs-hieu-asynchronous-event-drivent-nonblocking-io/ Tá»•ng káº¿tÄáº¿n Ä‘Ã¢y, cÃ³ láº½ ta Ä‘Ã£ cÃ³ thá»ƒ tá»± váº½ má»™t bá»©c tranh khÃ¡ Ä‘áº§y Ä‘á»§ vá» Nodejs system cho riÃªng mÃ¬nh. CÃ²n náº¿u báº¡n lÆ°á»i váº½, khÃ´ng sao cáº£, Richard Key Ä‘Ã£ váº½ cho báº¡n rá»“i Ä‘Ã¢y: Nguá»“n áº£nh: twitter.com/BusyRich","categories":[],"tags":[{"name":"nodejs","slug":"nodejs","permalink":"http://nthung2112.github.io/tags/nodejs/"}]},{"title":"Master the JavaScript Interview","slug":"Master-the-JavaScript-Interview","date":"2017-08-20T15:36:07.000Z","updated":"2017-08-20T17:47:13.879Z","comments":true,"path":"2017/08/Master-the-JavaScript-Interview.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Master-the-JavaScript-Interview.html","excerpt":"â€œMaster the JavaScript Interviewâ€ is a series of posts designed to prepare candidates for common questions they are likely to encounter when applying for a mid to senior-level JavaScript position. These are questions I frequently use in real interviews. Want to start from the beginning? See â€œWhat is a Closure?â€","text":"â€œMaster the JavaScript Interviewâ€ is a series of posts designed to prepare candidates for common questions they are likely to encounter when applying for a mid to senior-level JavaScript position. These are questions I frequently use in real interviews. Want to start from the beginning? See â€œWhat is a Closure?â€Note: This article uses ES6 examples. If you havenâ€™t learned ES6 yet, see â€œHow to Learn ES6â€. Objects are frequently used in JavaScript, and understanding how to work with them effectively will be a huge win for your productivity. In fact, poor OO design can potentially lead to project failure, and in the worst cases, company failures. Unlike most other languages, JavaScriptâ€™s object system is based on prototypes, not classes. Unfortunately, most JavaScript developers donâ€™t understand JavaScriptâ€™s object system, or how to put it to best use. Others do understand it, but want it to behave more like class based systems. The result is that JavaScriptâ€™s object system has a confusing split personality, which means that JavaScript developers need to know a bit about both prototypes and classes. Whatâ€™s the Difference Between Class &amp; Prototypal Inheritance?This can be a tricky question, and youâ€™ll probably need to defend your answer with follow-up Q&amp;A, so pay special attention to learning the differences, and how to apply the knowledge to write better code. Class Inheritance: A class is like a blueprint â€” a description of the object to be created. Classes inherit from classes and create subclass relationships: hierarchical class taxonomies. Instances are typically instantiated via constructor functions with the new keyword. Class inheritance may or may not use the class keyword from ES6. Classes as you may know them from languages like Java donâ€™t technically exist in JavaScript. Constructor functions are used, instead. The ES6 class keyword desugars to a constructor function: 12class Foo &#123;&#125;typeof Foo // 'function' In JavaScript, class inheritance is implemented on top of prototypal inheritance, but that does not mean that it does the same thing: JavaScriptâ€™s class inheritance uses the prototype chain to wire the child Constructor.prototype to the parent Constructor.prototype for delegation. Usually, the super() constructor is also called. Those steps form single-ancestor parent/child hierarchies and create the tightest coupling available in OO design. â€œClasses inherit from classes and create subclass relationships: hierarchical class taxonomies.â€ Prototypal Inheritance: A prototype is a working object instance. Objects inherit directly from other objects. Instances may be composed from many different source objects, allowing for easy selective inheritance and a flat [[Prototype]] delegation hierarchy. In other words, class taxonomies are not an automatic side-effect of prototypal OO: a critical distinction. Instances are typically instantiated via factory functions, object literals, or Object.create(). â€œA prototype is a working object instance. Objects inherit directly from other objects.â€ Why Does this Matter?Inheritance is fundamentally a code reuse mechanism: A way for different kinds of objects to share code. The way that you share code matters because if you get it wrong, it can create a lot of problems, specifically: Class inheritance creates parent/child object taxonomies as a side-effect. Those taxonomies are virtually impossible to get right for all new use cases, and widespread use of a base class leads to the fragile base class problem, which makes them difficult to fix when you get them wrong.In fact, class inheritance causes many well known problems in OO design: The tight coupling problem (class inheritance is the tightest coupling available in oo design), which leads to the next oneâ€¦ The fragile base class problem Inflexible hierarchy problem (eventually, all evolving hierarchies are wrong for new uses) The duplication by necessity problem (due to inflexible hierarchies, new use cases are often shoe-horned in by duplicating, rather than adapting existing code) The Gorilla/banana problem (What you wanted was a banana, but what you got was a gorilla holding the banana, and the entire jungle) I discuss some of the issues in more depth in my talk, â€œClassical Inheritance is Obsolete: How to Think in Prototypal OOâ€: The solution to all of these problems is to favor object composition over class inheritance. â€œFavor object composition over class inheritance.â€~ The Gang of Four, â€œDesign Patterns: Elements of Reusable Object Oriented Softwareâ€ Summed up nicely here: Is All Inheritance Bad?When people say â€œfavor composition over inheritanceâ€ that is short for â€œfavor composition over class inheritanceâ€ (the original quote from â€œDesign Patternsâ€ by the Gang of Four). This is common knowledge in OO design because class inheritance has many flaws and causes many problems. Often people leave off the word class when they talk about class inheritance, which makes it sound like all inheritance is bad â€” but itâ€™s not. There are actually several different kinds of inheritance, and most of them are great. Three Different Kinds of Prototypal InheritanceBefore we dive into the other kinds of inheritance, letâ€™s take a closer look at what I mean by class inheritance: You can experiment with this example on Codepen. BassAmp inherits from GuitarAmp, and ChannelStrip inherits from BassAmp &amp; GuitarAmp. This is an example of how OO design goes wrong. A channel strip isnâ€™t actually a type of guitar amp, and doesnâ€™t actually need a cabinet at all. A better option would be to create a new base class that both the amps and the channel strip inherits from, but even that has limitations. Eventually, the new shared base class strategy breaks down, too. Thereâ€™s a better way. You can inherit just the stuff you really need using object composition: Experiment with this on CodePen. If you look carefully, you might see that weâ€™re being much more specific about which objects get which properties because with composition, we can. It wasnâ€™t really an option with class inheritance. When you inherit from a class, you get everything, even if you donâ€™t want it. At this point, you may be thinking to yourself, â€œthatâ€™s nice, but where are the prototypes?â€ To understand that, you have to understand that there are three different kinds of prototypal OO. Concatenative inheritance: The process of inheriting features directly from one object to another by copying the source objects properties. In JavaScript, source prototypes are commonly referred to as mixins. Since ES6, this feature has a convenience utility in JavaScript called Object.assign(). Prior to ES6, this was commonly done with Underscore/Lodashâ€™s .extend() jQueryâ€™s $.extend(), and so onâ€¦ The composition example above uses concatenative inheritance. Prototype delegation: In JavaScript, an object may have a link to a prototype for delegation. If a property is not found on the object, the lookup is delegated to the delegate prototype, which may have a link to its own delegate prototype, and so on up the chain until you arrive at Object.prototype, which is the root delegate. This is the prototype that gets hooked up when you attach to a Constructor.prototype and instantiate with new. You can also use Object.create() for this purpose, and even mix this technique with concatenation in order to flatten multiple prototypes to a single delegate, or extend the object instance after creation. Functional inheritance: In JavaScript, any function can create an object. When that function is not a constructor (or class), itâ€™s called a factory function. Functional inheritance works by producing an object from a factory, and extending the produced object by assigning properties to it directly (using concatenative inheritance). Douglas Crockford coined the term, but functional inheritance has been in common use in JavaScript for a long time. As youâ€™re probably starting to realize, concatenative inheritance is the secret sauce that enables object composition in JavaScript, which makes both prototype delegation and functional inheritance a lot more interesting. When most people think of prototypal OO in JavaScript, they think of prototype delegation. By now you should see that theyâ€™re missing out on a lot. Delegate prototypes arenâ€™t the great alternative to class inheritance â€” object composition is. Why Composition is Immune to the Fragile Base Class ProblemTo understand the fragile base class problem and why it doesnâ€™t apply to composition, first you have to understand how it happens: A is the base class B inherits from A C inherits from B D inherits from B C calls super, which runs code in B. B calls super which runs code in A. A and B contain unrelated features needed by both C &amp; D. D is a new use case, and needs slightly different behavior in Aâ€™s init code than C needs. So the newbie dev goes and tweaks Aâ€™s init code. __**_C_ breaks because it depends on the existing behavior**, and D starts working. What we have here are features spread out between A and B that C and D need to use in various ways. C and D donâ€™t use every feature of A and Bâ€¦ they just want to inherit some stuff thatâ€™s already defined in A and B. But by inheriting and calling super, you donâ€™t get to be selective about what you inherit. You inherit everything: â€œâ€¦the problem with object-oriented languages is theyâ€™ve got all this implicit environment that they carry around with them. You wanted a banana but what you got was a gorilla holding the banana and the entire jungle.â€ ~ Joe Armstrong â€” â€œCoders at Workâ€ With CompositionImagine you have features instead of classes: 1feat1, feat2, feat3, feat4 C needs feat1 and feat3, D needs feat1, feat2, feat4: 12const C = compose(feat1, feat3);const D = compose(feat1, feat2, feat4); Now, imagine you discover that D needs slightly different behavior from feat1. It doesnâ€™t actually need to change feat1, instead, you can make a customized version of feat1 and use that, instead. You can still inherit the existing behaviors from feat2 and feat4 with no changes: 1const D = compose(custom1, feat2, feat4); And __**_C_ remains unaffected**. The reason this is not possible with class inheritance is because when you use class inheritance, you buy into the whole existing class taxonomy. If you want to adapt a little for a new use-case, you either end up duplicating parts of the existing taxonomy (the duplication by necessity problem), or you refactor everything that depends on the existing taxonomy to adapt the taxonomy to the new use case due to the fragile base class problem. Composition is immune to both. You Think You Know Prototypes, butâ€¦If you were taught to build classes or constructor functions and inherit from those, what you were taught was not prototypal inheritance. You were taught how to mimic class inheritance using prototypes. See â€œCommon Misconceptions About Inheritance in JavaScriptâ€. In JavaScript, class inheritance piggybacks on top of the very rich, flexible prototypal inheritance features built into the language a long time ago, but when you use class inheritance â€” even the ES6+ class inheritance built on top of prototypes, youâ€™re not using the full power &amp; flexibility of prototypal OO. In fact, youâ€™re painting yourself into corners and opting into all of the class inheritance problems. Using class inheritance in JavaScript is like driving your new Tesla Model S to the dealer and trading it in for a rusted out 1983 Ford Pinto. Stamps: Composable Factory FunctionsMost of the time, composition is achieved using factory functions: functions which exist to create object instances. What if there was a standard that makes factory functions composable? There is. Itâ€™s called The Stamp Specification. Explore the Series What is a Closure? What is the Difference Between Class and Prototypal Inheritance? What is a Pure Function? What is Function Composition? What is Functional Programming? What is a Promise? Soft Skills Level Up Your Skills with Live 1:1 MentorshipDevAnywhere is the fastest way to level up to advanced JavaScript skills: Live lessons Flexible hours 1:1 mentorship Build real production apps https://devanywhere.io/","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"interview","slug":"interview","permalink":"http://nthung2112.github.io/tags/interview/"}]},{"title":"Giáº£i thÃ­ch keyword 'new' trong Javascript","slug":"Giai-thich-keyword-new-trong-Javascript","date":"2017-08-20T15:21:52.000Z","updated":"2017-08-20T17:47:47.594Z","comments":true,"path":"2017/08/Giai-thich-keyword-new-trong-Javascript.html","link":"","permalink":"http://nthung2112.github.io/2017/08/Giai-thich-keyword-new-trong-Javascript.html","excerpt":"Normal Function CallTo explain what new does, letâ€™s start with just a normal function, called without new. We want to write a function that will create â€œpersonâ€ objects. Itâ€™ll give these objects name and age properties based on parameters that it takes in.","text":"Normal Function CallTo explain what new does, letâ€™s start with just a normal function, called without new. We want to write a function that will create â€œpersonâ€ objects. Itâ€™ll give these objects name and age properties based on parameters that it takes in. 123456789function personFn(name, age) &#123; var personObj = &#123;&#125;; personObj.name = name; personObj.age = age; return personObj;&#125;var alex = personFn('Alex', 30);// -&gt; &#123; name: 'Alex', age: 30 &#125; Simple enough. We create an object, add the properties to it, and return it at the end. newObject-oriented programming Letâ€™s create a function that does the same thing, but we want it to be invoked using new. This function will create the same object as the one above. Common practice is to make functions that are meant to be invoked with new start with a capital letter. These functions are also referred to as constructors. 123456function PersonConstructor(name, age) &#123; this.name = name; this.age = age;&#125;var alex = new PersonConstructor('Alex', 30);// -&gt; &#123; name: 'Alex', age: 30 &#125; Invoking personFn normally and invoking PersonConstructor with new both result in the same object being created. Whatâ€™s going on? The new keyword invokes a function in a special way. It adds some implicit code that we donâ€™t see. Letâ€™s expand the above function to show everything thatâ€™s happening. The commented lines are pseudocode representing functionality that is implicitly added by the JS engine when using new. 12345678910111213141516function PersonConstructor(name, age) &#123; // this = &#123;&#125;; // this.__proto__ = PersonConstructor.prototype; // Set up logic such that: if // there is a return statement // in the function body that // returns anything EXCEPT an // object, array, or function: // return 'this' (the newly // constructed object) // instead of that item at // the return statement; this.name = name; this.age = age; // return this;&#125; Letâ€™s break it down. new: Creates a new object and binds it to the this keyword. Sets the objectâ€™s internal [[Prototype]], property, &#95;&#95;proto&#95;&#95;, to be the prototype of the constructing function. This also makes it so the constructor of the new object is prototypically inherited. Sets up logic such that if a variable of any type other than object, array, or function is returned in the function body, return this, the newly constructed object, instead of what the function says to return. At the end of the function, returns this if there is no return statement in the function body. Letâ€™s show that these statements are valid, one by one. 12345678910111213function Demo() &#123; console.log(this); this.value = 5; return 10;&#125;/*1*/ var demo = new Demo(); // -&gt; &#123;&#125;/*2*/ console.log(demo.__proto__ === Demo.prototype); // -&gt; true console.log(demo.constructor === Demo); // -&gt; true/*3*/ console.log(demo); // -&gt; &#123; value: 5 &#125;function SecondDemo() &#123; this.val = '2nd demo';&#125;/*4*/ console.log(new SecondDemo()); // -&gt; &#123; val: '2nd demo' &#125; If you arenâ€™t familiar with constructors or prototypes, donâ€™t worry about it too much. Youâ€™ll run into them as you continue to learn Javascript. For now, just understand that the new object implicitly returned by the constructor function will be able to inherit properties and methods. Calling a non-constructor with newWhat happens if we invoke a normal function like personFn using new? Nothing special. The same rules apply. in the case of personFn, we see nothing explicitly happening. 12var alex = new personFn('Alex', 30);// -&gt; &#123; name: 'Alex', age: 30 &#125; Why? Letâ€™s add our implicit code in to personFn. 123456789101112131415161718192021function personFn(name, age) &#123; // this = &#123;&#125;; // this.constructor = PersonConstructor; // this.__proto__ = PersonConstructor.prototype; // Set up logic such that: if // there is a return statement // in the function body that // returns anything EXCEPT an // object, array, or function: // return this (the newly // constructed object) // instead of that item at // the return statement; var personObj = &#123;&#125;; personObj.name = name; personObj.age = age; return personObj; // return this;&#125; The implicit code is still added in: It binds this to a new object and sets its constructor and prototype. It adds logic that will return this instead of a non-object. It adds an implicit return this statement at the end. This doesnâ€™t affect our code, since we donâ€™t use the this keyword in our code. We also explicitly return an object, personObj, so the returning logic and the return this line have no use. Effectively, using new to invoke our function here has no effect on the output. If we were using this or if we werenâ€™t returning an object, the function would have different effects when invoked with and without new. Thatâ€™s it. Go write some code.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"}]},{"title":"A Jade Tutorial for Beginners","slug":"A-Jade-Tutorial-for-Beginners","date":"2017-08-20T14:57:13.000Z","updated":"2017-08-20T15:07:42.818Z","comments":true,"path":"2017/08/A-Jade-Tutorial-for-Beginners.html","link":"","permalink":"http://nthung2112.github.io/2017/08/A-Jade-Tutorial-for-Beginners.html","excerpt":"Jade is an elegant templating engine, primarily used for server-side templating in NodeJS. In plain words, Jade gives you a powerful new way to write markup, with a number of advantages over plain HTML. For example, take a look at this movie card in HTML: 123456789&lt;div&gt; &lt;h1&gt;Ocean's Eleven&lt;/h1&gt; &lt;ul&gt; &lt;li&gt;Comedy&lt;/li&gt; &lt;li&gt;Thriller&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Danny Ocean and his eleven accomplices plan to rob three Las Vegas casinos simultaneously.&lt;/p&gt;&lt;/div&gt;","text":"Jade is an elegant templating engine, primarily used for server-side templating in NodeJS. In plain words, Jade gives you a powerful new way to write markup, with a number of advantages over plain HTML. For example, take a look at this movie card in HTML: 123456789&lt;div&gt; &lt;h1&gt;Ocean's Eleven&lt;/h1&gt; &lt;ul&gt; &lt;li&gt;Comedy&lt;/li&gt; &lt;li&gt;Thriller&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Danny Ocean and his eleven accomplices plan to rob three Las Vegas casinos simultaneously.&lt;/p&gt;&lt;/div&gt; This is what the same markup looks like in Jade: 12345678div h1 Ocean&apos;s Eleven ul li Comedy li Thriller p. Danny Ocean and his eleven accomplices plan to rob three Las Vegas casinos simultaneously. The Jade version is elegant and concise. But itâ€™s not just about the beautiful syntax. Jade has some really neat features, allowing you to write modular and reusable markup. Before we get into these powerful features, letâ€™s do a quick overview of the basics. The BasicsIâ€™m going to highlight three basic features in Jade Simple tags Adding attributes to the tags Blocks of text If you want to try this out as we go along, you can use CodePen and choose Jade as your HTML preprocessor or use the online compiler on the official Jade page to compile your Jade to HTML. Simple TagsAs you might have noticed earlier, there are no â€œclosingâ€ tags in Jade. Instead, Jade uses indentation (i.e. white space) to determine how tags are nested. 123div p Hello! p World! In the example above, since the paragraph tags are indented, they will end up inside the div tag. Simple! 1234&lt;div&gt; &lt;p&gt;Hello!&lt;/p&gt; &lt;p&gt;World!&lt;/p&gt;&lt;/div&gt; Jade compiles this accurately by treating the first word on each line as a tag, while subsequent words on that line are treated as text inside the tag. View this example on CodePen AttributesAll this is great, but how do we add attributes to our tags? Quite simple really. Letâ€™s go back to our first example and toss in some classes and a poster image. 123456div(class=&quot;movie-card&quot;, id=&quot;oceans-11&quot;) h1(class=&quot;movie-title&quot;) Ocean&apos;s 11 img(src=&quot;/img/oceans-11.png&quot;, class=&quot;movie-poster&quot;) ul(class=&quot;genre-list&quot;) li Comedy li Thriller Pretty neat right? 12345678&lt;div class=\"movie-card\" id=\"oceans-11\"&gt; &lt;h1 class=\"movie-title\"&gt;Ocean's 11&lt;/h1&gt; &lt;img src=\"/img/oceans-11.png\" class=\"movie-poster\"&gt; &lt;ul class=\"genre-list\"&gt; &lt;li&gt;Comedy&lt;/li&gt; &lt;li&gt;Thriller&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; View this example on CodePen But it doesnâ€™t stop here. Jade provides special shorthand for IDs and classes, further simplifying our markup using a familiar notation: 123456div.movie-card#oceans-11 h1.movie-title Ocean&apos;s 11 img.movie-poster(src=&quot;/img/oceans-11.png&quot;) ul.genre-list li Comedy li Thriller View this example on CodePen As you can see, Jade uses the same syntax as that which weâ€™re already familiar with when writing CSS selectors, making it even easier to spot classes. Blocks of TextLetâ€™s say you have a paragraph tag and you want to place a large block of text in it. Jade treats the first word of every line as an HTML tag â€“ so what do you do? You might have noticed an innocent period in the first code example in this article. Adding a period (full stop) after your tag indicates that everything inside that tag is text and Jade stops treating the first word on each line as an HTML tag. 123456div p How are you? p. I&apos;m fine thank you. And you? I heard you fell into a lake? That&apos;s rather unfortunate. I hate it when my shoes get wet. View this example on CodePen And just to drive home the point, if I were to remove the period after the p tag in this example, the compiled HTML would treat the â€œIâ€ in the word â€œIâ€™mâ€ as an opening tag (in this case, it would be the &lt;i&gt; tag). Powerful FeaturesNow that weâ€™ve covered the basics, letâ€™s take a peek at some powerful features that will make your markup smarter. Weâ€™ll look at the following features in remainder of this tutorial: Loops JavaScript Interpolation Mixins Using JavaScript in JadeJade is implemented with JavaScript, so itâ€™s super-easy to use JavaScript in Jade. Hereâ€™s an example. 123456- var x = 5;div ul - for (var i=1; i&lt;=x; i++) &#123; li Hello - &#125; What did we just do here?! By starting a line with a hyphen, we indicate to the Jade compiler that we want to start using JavaScript and it just works as we would expect. Hereâ€™s what you get when you compile the Jade code above to HTML: 123456789&lt;div&gt; &lt;ul&gt; &lt;li&gt;Hello&lt;/li&gt; &lt;li&gt;Hello&lt;/li&gt; &lt;li&gt;Hello&lt;/li&gt; &lt;li&gt;Hello&lt;/li&gt; &lt;li&gt;Hello&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; View this example on CodePen We use a hyphen when the code doesnâ€™t directly add output. If we want to use JavaScript to output something in Jade, we use =. Letâ€™s tweak the code above to show a serial number. 123456- var x = 5;div ul - for (var i=1; i&lt;=x; i++) &#123; li= i + &quot;. Hello&quot; - &#125; And voilÃ , we now have serial numbers: 123456789&lt;div&gt; &lt;ul&gt; &lt;li&gt;1\\. Hello&lt;/li&gt; &lt;li&gt;2\\. Hello&lt;/li&gt; &lt;li&gt;3\\. Hello&lt;/li&gt; &lt;li&gt;4\\. Hello&lt;/li&gt; &lt;li&gt;5\\. Hello&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; View this example on CodePen Of course, in this case, an ordered list would be much more appropriate, but you get the point. Now, if youâ€™re worried about XSS and HTML escaping, read the docs for more info. LoopsJade provides an excellent looping syntax so that you donâ€™t need to resort to JavaScript. Letâ€™s loop over an array: 123456- var droids = [&quot;R2D2&quot;, &quot;C3PO&quot;, &quot;BB8&quot;];div h1 Famous Droids from Star Wars for name in droids div.card h2= name And this will compile as follows: 123456789101112&lt;div&gt; &lt;h1&gt;Famous Droids from Star Wars&lt;/h1&gt; &lt;div class=\"card\"&gt; &lt;h2&gt;R2D2&lt;/h2&gt; &lt;/div&gt; &lt;div class=\"card\"&gt; &lt;h2&gt;C3PO&lt;/h2&gt; &lt;/div&gt; &lt;div class=\"card\"&gt; &lt;h2&gt;BB8&lt;/h2&gt; &lt;/div&gt;&lt;/div&gt; View this example on CodePen You can iterate over objects and use while loops too. Check out the docs for more. InterpolationIt can get annoying to mix JavaScript into text like this p= &quot;Hi there, &quot; + profileName + &quot;. How are you doing?&quot;. Does Jade have an elegant solution for this? You bet. 123- var profileName = &quot;Danny Ocean&quot;;div p Hi there, #&#123;profileName&#125;. How are you doing? View this example on CodePen Isnâ€™t that neat? MixinsMixins are like functions. They take parameters as input and give markup as output. Mixins are defined using the mixin keyword. 1234mixin thumbnail(imageName, caption) div.thumbnail img(src=&quot;/img/#&#123;imageName&#125;.jpg&quot;) h4.image-caption= caption Once the mixin is defined, you can call the mixin with the + syntax. 12+thumbnail(&quot;oceans-eleven&quot;, &quot;Danny Ocean makes an elevator pitch.&quot;)+thumbnail(&quot;pirates&quot;, &quot;Introducing Captain Jack Sparrow!&quot;) Which will output HTML like this: 123456789101112&lt;div class=\"thumbnail\"&gt; &lt;img src=\"/img/oceans-eleven.jpg\"&gt; &lt;h4 class=\"image-caption\"&gt; Danny Ocean makes an elevator pitch. &lt;/h4&gt;&lt;/div&gt;&lt;div class=\"thumbnail\"&gt; &lt;img src=\"/img/pirates.jpg\"&gt; &lt;h4 class=\"image-caption\"&gt; Introducing Captain Jack Sparrow! &lt;/h4&gt;&lt;/div&gt; Putting It All TogetherLetâ€™s put together everything weâ€™ve learned so far. Say we have a nice array of movies, with each item containing the movieâ€™s title, the cast (a sub-array), the rating, the genre, a link to the IMDB page and the image path for the movieâ€™s poster. The array will look something like this (white space added for readability): 1234567891011- var movieList = [ &#123; title: \"Ocean's Eleven\", cast: [\"Julia Roberts\", \"George Clooney\", \"Brad Pitt\", \"Andy Garcia\"], genres: [\"Comedy\", \"Thriller\"], posterImage: \"/img/oceans-eleven\", imdbURL: \"http://www.imdb.com/title/tt0240772/\", rating: 7 &#125; // etc...]; We have 10 movies and we want to build nice movie cards for each of them. Initially, we donâ€™t plan to use the IMDB link. If a movie is rated above 5, we give it a thumbs up, otherwise, we give it a thumbs down. Weâ€™ll use all the nice features of Jade to write some modular code to do the following: Create a mixin for a movie card Iterate through the cast list and display the actors. Weâ€™ll do the same with genres. Check the rating and decide whether to display a thumbs up or a thumbs down. Iterate through the movie list and use the mixin to create one card per movie. So letâ€™s create the mixin first. 12345678910111213141516mixin movie-card(movie) div.movie-card h2.movie-title= movie.title img.movie-poster(src=movie.posterImage) h3 Cast ul.cast each actor in movie.cast li= actor div.rating if movie.rating &gt; 5 img(src=&quot;img/thumbs-up&quot;) else img(src=&quot;img/thumbs-down&quot;) ul.genre each genre in movie.genres li= genre Thereâ€™s a lot going on up there, but Iâ€™m sure it looks familiar â€“ weâ€™ve covered all this in this tutorial. Now, we just need to use our mixin in a loop: 12for movie in movieList +movie-card(movie) Thatâ€™s it. Is that elegant or what? Hereâ€™s the final code. 1234567891011121314151617181920212223242526272829303132333435363738- var movieList = [ &#123; title: &quot;Ocean&apos;s Eleven&quot;, cast: [&quot;Julia Roberts&quot;, &quot;George Clooney&quot;, &quot;Brad Pitt&quot;, &quot;Andy Garcia&quot;], genres: [&quot;Comedy&quot;, &quot;Thriller&quot;], posterImage: &quot;/img/oceans-eleven&quot;, imdbURL: &quot;http://www.imdb.com/title/tt0240772/&quot;, rating: 9.2 &#125;, &#123; title: &quot;Pirates of the Caribbean&quot;, cast: [&quot;Johnny Depp&quot;, &quot;Keira Knightley&quot;, &quot;Orlando Bloom&quot;], genres: [&quot;Adventure&quot;, &quot;Comedy&quot;], posterImage: &quot;/img/pirates-caribbean&quot;, imdbURL: &quot;http://www.imdb.com/title/tt0325980/&quot;, rating: 9.7 &#125;];mixin movie-card(movie) div.movie-card h2.movie-title= movie.title img.movie-poster(src=movie.posterImage) h3 Cast ul.cast each actor in movie.cast li= actor div.rating if movie.rating &gt; 5 img(src=&quot;img/thumbs-up&quot;) else img(src=&quot;img/thumbs-down&quot;) ul.genre each genre in movie.genres li= genrefor movie in movieList +movie-card(movie) And hereâ€™s the compiled HTML: 1234567891011121314151617181920212223242526272829303132333435&lt;div class=\"movie-card\"&gt; &lt;h2 class=\"movie-title\"&gt;Ocean's Eleven&lt;/h2&gt; &lt;img src=\"/img/oceans-eleven\" class=\"movie-poster\"/&gt; &lt;h3&gt;Cast&lt;/h3&gt; &lt;ul class=\"cast\"&gt; &lt;li&gt;Julia Roberts&lt;/li&gt; &lt;li&gt;George Clooney&lt;/li&gt; &lt;li&gt;Brad Pitt&lt;/li&gt; &lt;li&gt;Andy Garcia&lt;/li&gt; &lt;/ul&gt; &lt;div class=\"rating\"&gt; &lt;img src=\"img/thumbs-up\"/&gt; &lt;/div&gt; &lt;ul class=\"genre\"&gt; &lt;li&gt;Comedy&lt;/li&gt; &lt;li&gt;Thriller&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;div class=\"movie-card\"&gt; &lt;h2 class=\"movie-title\"&gt;Pirates of the Carribean&lt;/h2&gt; &lt;img src=\"/img/pirates-caribbean\" class=\"movie-poster\"/&gt; &lt;h3&gt;Cast&lt;/h3&gt; &lt;ul class=\"cast\"&gt; &lt;li&gt;Johnny Depp&lt;/li&gt; &lt;li&gt;Keira Knightley&lt;/li&gt; &lt;li&gt;Orlando Bloom&lt;/li&gt; &lt;/ul&gt; &lt;div class=\"rating\"&gt; &lt;img src=\"img/thumbs-up\"/&gt; &lt;/div&gt; &lt;ul class=\"genre\"&gt; &lt;li&gt;Adventure&lt;/li&gt; &lt;li&gt;Comedy&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; But wait a minute. What if we now want to go to the movieâ€™s IMDB page when we click on a movieâ€™s title? We can add one line: a(href=movie.imdbURL) to the mixin. 1234567891011121314151617mixin movie-card(movie) div.movie-card a(href=movie.imdbURL) h2.movie-title= movie.title img.movie-poster(src=movie.posterImage) h3 Cast ul.cast each actor in movie.cast li= actor div.rating if movie.rating &gt; 5 img(src=&quot;img/thumbs-up&quot;) else img(src=&quot;img/thumbs-down&quot;) ul.genre each genre in movie.genres li= genre View this example on CodePen ConclusionWe went from knowing nothing about Jade to building some beautiful modular movie cards. Thereâ€™s a lot more to Jade, but Iâ€™ve glossed over some concepts to keep things simple. So I hope this tutorial piqued your curiosity to learn more. Important note: As some of you might already know, Jade has been renamed to Pug due to a software trademark claim. In the future, articles on Jade will use the new name â€œPugâ€ or â€œPugJSâ€.","categories":[],"tags":[{"name":"jade","slug":"jade","permalink":"http://nthung2112.github.io/tags/jade/"},{"name":"html","slug":"html","permalink":"http://nthung2112.github.io/tags/html/"}]},{"title":"Reducing CSS bundle size with webpack","slug":"reducing-css-bundle-size-with-webpack","date":"2017-08-20T08:41:31.000Z","updated":"2017-08-20T14:50:45.892Z","comments":true,"path":"2017/08/reducing-css-bundle-size-with-webpack.html","link":"","permalink":"http://nthung2112.github.io/2017/08/reducing-css-bundle-size-with-webpack.html","excerpt":"Äáº§u nÄƒm nay tÃ´i Ä‘Ã£ build 1 á»©ng dá»¥ng tÃªn lÃ  GO2CINEMA, 1 á»©ng dá»¥ng nhá» gá»n, nhanh nháº¹, báº£o máº­t, giÃºp ngÆ°á»i dÃ¹ng book vÃ© xem phim á»Ÿ Anh. Trong thá»i gian build á»©ng dá»¥ng nÃ y, tÃ´i Ä‘Ã£ bá»‹ Ã¡m áº£nh vá»›i viá»‡c tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™ render. TÃ´i Ä‘Ã£ giáº£i quyáº¿t viá»‡c pre-render HTML báº±ng usus. usus sáº½ render HTML SPA (Single Page Application) vÃ  sá»­ dá»¥ng inline CSS. Tuy nhiÃªn tÃ´i khÃ´ng thÃ­ch viá»‡c nhÃ©t Ä‘áº¿n 70kB dung lÆ°á»£ng vÃ o má»—i tÃ i liá»‡u HTML, nháº¥t lÃ  khi pháº§n lá»›n dung lÆ°á»£ng Ä‘Ã³ lÃ  Ä‘á»ƒ chá»©a tÃªn class CSS.","text":"Äáº§u nÄƒm nay tÃ´i Ä‘Ã£ build 1 á»©ng dá»¥ng tÃªn lÃ  GO2CINEMA, 1 á»©ng dá»¥ng nhá» gá»n, nhanh nháº¹, báº£o máº­t, giÃºp ngÆ°á»i dÃ¹ng book vÃ© xem phim á»Ÿ Anh. Trong thá»i gian build á»©ng dá»¥ng nÃ y, tÃ´i Ä‘Ã£ bá»‹ Ã¡m áº£nh vá»›i viá»‡c tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™ render. TÃ´i Ä‘Ã£ giáº£i quyáº¿t viá»‡c pre-render HTML báº±ng usus. usus sáº½ render HTML SPA (Single Page Application) vÃ  sá»­ dá»¥ng inline CSS. Tuy nhiÃªn tÃ´i khÃ´ng thÃ­ch viá»‡c nhÃ©t Ä‘áº¿n 70kB dung lÆ°á»£ng vÃ o má»—i tÃ i liá»‡u HTML, nháº¥t lÃ  khi pháº§n lá»›n dung lÆ°á»£ng Ä‘Ã³ lÃ  Ä‘á»ƒ chá»©a tÃªn class CSS. Google xá»­ lÃ½ nhÆ° tháº¿ nÃ o?ÄÃ£ bao giá» báº¡n tÃ² mÃ² vá» source code cá»§a Google chÆ°a? Náº¿u rá»“i, háº³n báº¡n sáº½ nháº­n ra tÃªn class CSS chá»‰ Ä‘Æ¡n giáº£n lÃ  vÃ i kÃ½ tá»±. Báº¡n cÃ³ tháº¯c máº¯c táº¡i sao láº¡i tháº¿ khÃ´ng? Sá»± thiáº¿u sÃ³t cá»§a CSS minifierCÃ³ 1 thá»© duy nháº¥t minifier khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c: Ä‘Ã³ lÃ  thay Ä‘á»•i tÃªn cá»§a selector. LÃ½ do lÃ  vÃ¬ minifier CSS khÃ´ng Ä‘iá»u khiá»ƒn Ä‘Æ°á»£c cÃ¡c HTML output. Trong lÃºc Ä‘Ã³, cÃ¡c CSS name cÃ³ thá»ƒ ráº¥t dÃ i. Náº¿u báº¡n sá»­ dá»¥ng CSS module, CSS module sáº½ cÃ³ xu hÆ°á»›ng thÃªm cÃ¡c tÃªn cho stylesheet, local identifier vÃ  cÃ¡c hash ngáº«u nhiÃªn. Dáº¡ng cá»§a tÃªn class sáº½ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi css-loader localIdentName, config nhÆ° sau: [name]___[local]___[hash:base64:5. Do Ä‘Ã³, tÃªn class sáº½ Ä‘Æ°á»£c sinh ra cÃ³ dáº¡ng giá»‘ng tháº¿: .MovieView___movie-title___yvKVV; trong trÆ°á»ng há»£p báº¡n muá»‘n mÃ´ táº£ kÄ© hÆ¡n, tÃªn class cÃ³ thá»ƒ cÃ²n dÃ i ná»¯a: .MovieView___movie-description-with-summary-paragraph___yvKVV Thay Ä‘á»•i tÃªn class CSS ngay thá»i Ä‘iá»ƒm biÃªn dá»‹chNáº¿u báº¡n sá»­ dá»¥ng webpack vÃ  babel-plugin-react-css-module thÃ¬ báº¡n khÃ´ng cáº§n lo láº¯ng thÃªm vá» váº¥n Ä‘á» nÃ y ná»¯a. Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i tÃªn class ngay thá»i Ä‘iá»ƒm biÃªn dá»‹ch báº±ng cÃ¡ch sá»­ dá»¥ng css-loader getLocalIdent vÃ  babel-plugin-react-css-modules generateScopedName. 1234567const generateScopedName = ( localName: string, resourcePath: string) =&gt; &#123; const componentName = resourcePath.split('/').slice(-2, -1);return componentName + '_' + localName;&#125;; CÃ³ 1 Ä‘iá»u khÃ¡ tuyá»‡t vá» generateScopedName Ä‘Ã³ lÃ  instance cá»§a function nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong quÃ¡ trÃ¬nh build cá»§a babel vÃ  webpack. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/** * @file Webpack configuration. */const path = require('path');const generateScopedName = (localName, resourcePath) =&gt; &#123; const componentName = resourcePath.split('/').slice(-2, -1); return componentName + '_' + localName;&#125;;module.exports = &#123; module: &#123; rules: [ &#123; include: path.resolve(__dirname, '../app'), loader: 'babel-loader', options: &#123; babelrc: false, extends: path.resolve(__dirname, '../app/webpack.production.babelrc'), plugins: [ [ 'react-css-modules', &#123; context: common.context, filetypes: &#123; '.scss': &#123; syntax: 'postcss-scss' &#125; &#125;, generateScopedName, webpackHotModuleReloading: false &#125; ] ] &#125;, test: /\\.js$/ &#125;, &#123; test: /\\.scss$/, use: [ &#123; loader: 'css-loader', options: &#123; camelCase: true, getLocalIdent: (context, localIdentName, localName) =&gt; &#123; return generateScopedName(localName, context.resourcePath); &#125;, importLoaders: 1, minimize: true, modules: true &#125; &#125;, 'resolve-url-loader' ] &#125; ] &#125;, output: &#123; filename: '[name].[chunkhash].js', path: path.join(__dirname, './.dist'), publicPath: '/static/' &#125;, stats: 'minimal'&#125;; Äáº·t tÃªn ngáº¯nMay máº¯n ráº±ng babel-plugin-react-css-modules vÃ  css-loader sá»­ dá»¥ng cÃ¹ng 1 logic Ä‘á»ƒ sinh ra tÃªn class CSS. Nhá» Ä‘Ã³ ta cÃ³ thá»ƒ thay Ä‘á»•i tÃªn class báº¥t cá»© khi nÃ o cáº§n thiáº¿t, tháº­m chÃ­ cÃ¡c hash ngáº«u nhiÃªn. CÃ¡ nhÃ¢n tÃ´i thÃ¬ láº¡i muá»‘n tÃªn class ngáº¯n nháº¥t cÃ³ thá»ƒ. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y, tÃ´i sáº½ táº¡o 1 class name index vÃ  sá»­ dá»¥ng module incstr Ä‘á»ƒ sinh ra cÃ¡c ID tÄƒng dáº§n cho má»—i báº£n ghi. 123456789101112131415161718192021222324252627282930313233343536const incstr = require('incstr');const createUniqueIdGenerator = () =&gt; &#123; const index = &#123;&#125;; const generateNextId = incstr.idGenerator(&#123; // Removed \"d\" letter to avoid accidental \"ad\" construct. // @see https://medium.com/@mbrevda/just-make-sure-ad-isnt-being-used-as-a-class-name-prefix-or-you-might-suffer-the-wrath-of-the-558d65502793 alphabet: 'abcefghijklmnopqrstuvwxyz0123456789' &#125;); return (name) =&gt; &#123; if (index[name]) &#123; return index[name]; &#125; let nextId; do &#123; // Class name cannot start with a number. nextId = generateNextId(); &#125; while (/^[0-9]/.test(nextId)); index[name] = generateNextId(); return index[name]; &#125;;&#125;;const uniqueIdGenerator = createUniqueIdGenerator();const generateScopedName = (localName, resourcePath) =&gt; &#123; const componentName = resourcePath.split('/').slice(-2, -1); return uniqueIdGenerator(componentName) + '_' + uniqueIdGenerator(localName);&#125;; Viá»‡c nÃ y sáº½ Ä‘áº£m báº£o Ä‘Æ°á»£c tÃªn class sáº½ Ä‘á»§ ngáº¯n vÃ  duy nháº¥t trong cáº£ á»©ng dá»¥ng. BÃ¢y giá» thay vÃ¬ lÃ  nhá»¯ng cÃ¡i tÃªn dÃ i ngoáº±ng nhÆ° .MovieView___movie-title___yvKVV vÃ  .MovieView___movie-description-with-summary-paragraph___yvKVV, tÃªn class Ä‘Ã£ trá»Ÿ thÃ nh .a_a, .b_a. Nhá» Ä‘Ã³ mÃ  kÃ­ch thÆ°á»›c file bundle css cá»§a GO2CINEMA Ä‘Ã£ giáº£m tá»« 140kB xuá»‘ng cÃ²n 53kB. Sá»­ dá»¥ng Scope Isolation Ä‘á»ƒ giáº£m kÃ­ch thÆ°á»›c file bundleCÃ³ 1 lÃ½ do cho viá»‡c tÃ´i sá»­ dá»¥ng _ trong tÃªn class, chia tÃ¡ch tÃªn cÃ¡c component vá»›i tÃªn cÃ¡c local identifier, Ä‘iá»u nÃ y ráº¥t há»¯u Ã­ch cho quÃ¡ trÃ¬nh minify. csso (CSS minifier) cÃ³ nhá»¯ng thiáº¿t láº­p vá» scope. Scope sáº½ Ä‘á»‹nh nghÄ©a cÃ¡c danh sÃ¡ch tÃªn class CSS Ä‘á»ƒ sá»­ dá»¥ng vá»›i 1 sá»‘ markup, vÃ­ dá»¥ cÃ¡c selector tá»« cÃ¡c scope khÃ¡c nhau sáº½ khÃ´ng ná»‘i vá»›i cÃ¡c element giá»‘ng nhau. Viá»‡c nÃ y sáº½ giÃºp cho viá»‡c optimize chá»§ Ä‘á»™ng hÆ¡n. DÆ°á»›i Ä‘Ã¢y lÃ  code sá»­ dá»¥ng csso-webpack-plugin Ä‘á»ƒ tiá»n xá»­ lÃ½ file bundle CSS: 12345678910111213141516171819202122232425262728293031const getScopes = (ast) =&gt; &#123; const scopes = &#123;&#125;; const getModuleID = (className) =&gt; &#123; const tokens = className.split('_')[0]; if (tokens.length !== 2) &#123; return 'default'; &#125; return tokens[0]; &#125;; csso.syntax.walk(ast, node =&gt; &#123; if (node.type === 'ClassSelector') &#123; const moduleId = getModuleID(node.name); if (moduleId) &#123; if (!scopes[moduleId]) &#123; scopes[moduleId] = []; &#125; if (!scopes[moduleId].includes(node.name)) &#123; scopes[moduleId].push(node.name); &#125; &#125; &#125; &#125;); return Object.values(scopes);&#125;; QuÃ¡ trÃ¬nh nÃ y tiáº¿p tá»¥c giáº£m kÃ­ch thÆ°á»›c file bundle CSS cá»§a GO2CINEMA tá»« 53kB cÃ²n 47kB. Káº¿t luáº­nHáº³n sáº½ cÃ³ nhá»¯ng Ã½ kiáº¿n trÃ¡i chiá»u nÃ³i ráº±ng viá»‡c minify nÃ y hoÃ n toÃ n cÃ³ thá»ƒ dÃ¹ng thuáº­t toÃ¡n nÃ©n. Vá»›i GO2CINEMA, fle bundle CSS sau khi Ä‘Æ°á»£c nÃ©n báº±ng thuáº­t toÃ¡n Brotli thÃ¬ kÃ­ch thÆ°á»›c cá»§a nÃ³ chá»‰ Ã­t hÆ¡n 1kB so vá»›i cÃ¡ch minify file bundle bá»-tÃªn-class tÃ´i Ä‘Ã£ trÃ¬nh bÃ y trÃªn. Máº·t khÃ¡c, cÃ i Ä‘áº·t quÃ¡ trÃ¬nh minify cÃ³ thá»ƒ xem nhÆ° lÃ  1 khoáº£n Ä‘áº§u tÆ° dÃ i háº¡n. NgoÃ i viá»‡c giáº£m kÃ­ch thÆ°á»›c file cáº§n parse, nÃ³ cÃ²n cÃ³ nhá»¯ng lá»£i Ã­ch khÃ¡c ná»¯a, vÃ­ dá»¥ nhÆ° ngÄƒn cháº·n viá»‡c tÃªn class CSS khÃ´ng bá»‹ ná»‘i vá»›i cÃ¡c selector cá»§a blocklist ad-blocker cháº³ng háº¡n. Báº¡n cÃ³ thá»ƒ xem demo cá»§a minification nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i cÃ¡c phim trÃªn GO2CINEMA: https://go2cinema.com/movies/wonder-woman-2017-1305237 https://go2cinema.com/venues/odeon-oxford-magdalen-st-1001053","categories":[],"tags":[{"name":"css","slug":"css","permalink":"http://nthung2112.github.io/tags/css/"},{"name":"webpack","slug":"webpack","permalink":"http://nthung2112.github.io/tags/webpack/"}]},{"title":"How to Create a Reddit Clone Using React and Firebase","slug":"How-to-Create-a-Reddit-Clone-Using-React-and-Firebase","date":"2017-07-23T09:48:27.000Z","updated":"2017-08-20T14:50:38.595Z","comments":true,"path":"2017/07/How-to-Create-a-Reddit-Clone-Using-React-and-Firebase.html","link":"","permalink":"http://nthung2112.github.io/2017/07/How-to-Create-a-Reddit-Clone-Using-React-and-Firebase.html","excerpt":"React is an awesome JavaScript library for building user interfaces. Since the publishing of Create React App, it has become very easy to scaffold a barebones React application. In this article, we will be using Firebase along with Create React App to build an app which will function similar to Reddit. It will allow the user to submit a new link which can then be voted on. Hereâ€™s a live demo of what weâ€™ll be building.","text":"React is an awesome JavaScript library for building user interfaces. Since the publishing of Create React App, it has become very easy to scaffold a barebones React application. In this article, we will be using Firebase along with Create React App to build an app which will function similar to Reddit. It will allow the user to submit a new link which can then be voted on. Hereâ€™s a live demo of what weâ€™ll be building. Why Firebase?Using Firebase will make it very easy for us to show real-time data to the user. Once a user votes on a link, the feedback will be instantaneous. Firebaseâ€™s Realtime Database will help us in developing this feature. Also, it will help us to understand how to bootstrap a React application with Firebase. Why React?React is particularly known for creating user interfaces using a component architecture. Each component can contain internal state or be passed data as props. State and props are the two most important concepts in React. These two things help us determine the state of our application at any point in time. If you are not familiar with these terms, please head over to the React docs first. Note: You can also use a state container like Redux or MobX, but for the sake of simplicity, we wonâ€™t be using one for this tutorial. The whole project is available on Github. By the way, for a high-quality, in-depth introduction to React, you canâ€™t go past Canadian full-stack developer Wes Bos. Try his course, and use the coupon code â€˜SITEPOINTâ€™ to get 25% off and to help support SitePoint. Setting up the projectLetâ€™s walk through the steps to set up our project structure and any necessary dependencies. Installing create-react-appIf you havenâ€™t already, you need to install create-react-app. To do so, you can type the following in your terminal: 1npm install -g create-react-app Once youâ€™ve installed it globally, you can use it to scaffold a React project inside any folder. Now, letâ€™s create a new app and call it reddit-clone. 1create-react-app reddit-clone This will scaffold a new create-react-app project inside the reddit-clone folder. Once the bootstrapping is done, we can go inside reddit-clone directory and fire up the development server: 1npm start At this point, you can go to http://localhost:3000/ and see your app skeleton up and running. Structuring the appFor maintenance, I always like to separate my containers and components. Containers are the smart components which are contains the business logic of our application and manage Ajax requests. Components are simply dumb presentational components. They can have their own internal state which can be used to control the logic of that component (e.g. showing the current state of a controlled input component). After removing the unnecessary logo and css files, this is how your app should look like now. We created a components folder and a containers folder. Letâ€™s move App.js inside the containers/App folder and create registerServiceWorker.js inside the utils folder. Your src/containers/App/index.js file should look like this: 123456789101112131415// src/containers/App/index.jsimport React, &#123; Component &#125; from 'react';class App extends Component &#123; render() &#123; return ( &lt;div className=\"App\"&gt; Hello World &lt;/div&gt; ); &#125;&#125;export default App; Your src/index.js file should look like this: 123456789// src/index.jsimport React from 'react';import ReactDOM from 'react-dom';import App from './containers/App';import registerServiceWorker from './utils/registerServiceWorker';ReactDOM.render(&lt;App /&gt;, document.getElementById('root'));registerServiceWorker(); Go to your browser and if every thing works fine you will see Hello World on your screen. You can check my commit on Github. Adding react-routerReact-router will help us define the routes for our app. Itâ€™s very customizable and very popular in the react ecosystem. We will be using version 3.0.0 of react-router. 1npm install --save react-router@3.0.0 Now, add a new file routes.js inside the src folder with the following code: 123456789101112131415// routes.jsimport React from 'react';import &#123; Router, Route &#125; from 'react-router';import App from './containers/App';const Routes = (props) =&gt; ( &lt;Router &#123;...props&#125;&gt; &lt;Route path=\"/\" component=&#123; App &#125;&gt; &lt;/Route&gt; &lt;/Router&gt;);export default Routes; The Router component wraps all the Route components. Based on the path prop of the Route component, the component passed to the component prop, will be rendered on the page. Here, we are setting up the root URL (/) to load our App component using the Router component. 1234&lt;Router &#123;...props&#125;&gt; &lt;Route path=&quot;/&quot; component=&#123; &lt;div&gt;Hello World!&lt;/div&gt; &#125;&gt; &lt;/Route&gt;&lt;/Router&gt; The above code is also valid. For the path /, the &lt;div&gt;Hello World!&lt;/div&gt; will be mounted. Now, we need to call our routes.js file from our src/index.js file. The file should have the following content: 12345678910111213141516// src/index.jsimport React from 'react';import ReactDOM from 'react-dom';import &#123; browserHistory &#125; from 'react-router';import App from './containers/App';import Routes from './routes';import registerServiceWorker from './utils/registerServiceWorker';ReactDOM.render( &lt;Routes history=&#123;browserHistory&#125; /&gt;, document.getElementById('root'));registerServiceWorker(); Basically, we are mounting our Router component from our routes.js file. We pass in the history prop to it so that the routes know how to handle history tracking. You can check my commit on Github. Adding FirebaseIf you donâ€™t have a Firebase account, create one now (itâ€™s free!) by going to their website. After youâ€™re done creating a new account, log into your account and go to the console page and click on Add project. Enter the name of your project (Iâ€™ll call mine reddit-clone), choose your country, and click on the Create project button. Now, before we proceed we need to change the rules for the database since, by default, Firebase expects the user to be authenticated to be able to read and write data. If you select your project and click on the Database tab on the left, you will be able to see your database. You need to click on the Rules tab on the top that will redirect us to a screen which will have the following data: 123456&#123; \"rules\": &#123; \".read\": \"auth != null\", \".write\": \"auth != null\" &#125;&#125; We need to change this to the following: 123456&#123; \"rules\": &#123; \".read\": \"auth === null\", \".write\": \"auth === null\" &#125;&#125; This will let users update the database without logging in. If we implemented a flow in which we had authentication before making updates to the database, then we would need the default rules provided by Firebase. To keep this application simple, we wonâ€™t be doing authentication. Important: If you donâ€™t make this modification, Firebase wonâ€™t let you update the database from your app. Now, letâ€™s add the firebase npm module to our app by running the following code: 1npm install --save firebase Next, import that module in your App/index.js file as: 123// App/index.jsimport * as firebase from \"firebase\"; When we select our project after logging into Firebase, we will get an option Add Firebase to your web app. If we click on that option, a modal will appear which will show us the config variable which we will use in our componentWillMount method. Letâ€™s create the Firebase config file. We shall call this file firebase-config.js and this file will contain all the configs necessary to connect our app with Firebase. 12345678910// App/firebase-config.jsexport default &#123; apiKey: \"AIzaSyBRExKF0cHylh_wFLcd8Vxugj0UQRpq8oc\", authDomain: \"reddit-clone-53da5.firebaseapp.com\", databaseURL: \"https://reddit-clone-53da5.firebaseio.com\", projectId: \"reddit-clone-53da5\", storageBucket: \"reddit-clone-53da5.appspot.com\", messagingSenderId: \"490290211297\"&#125;; Weâ€™ll import our Firebase config into App/index.js. 123// App/index.jsimport config from './firebase-config'; We will initialize our Firebase database connection in the constructor. 12345678// App/index.jsconstructor() &#123; super(); // Initialize Firebase firebase.initializeApp(config);&#125; In the componentWillMount() lifecycle hook, we use the package firebase we just installed and call its initializeApp method and passed the config variable to it. This object contains all the data about our app. The initializeApp method will connect our application to our Firebase database so that we can read and write data. Letâ€™s add some data to Firebase to check if our configuration is correct. Go to the Database tab and add the following structure to your database: Clicking on Add will save the data to our database. Now, letâ€™s add some code to our componentWillMount method to make the data appear on our screen. 123456789101112131415161718// App/index.jscomponentWillMount() &#123; ... let postsRef = firebase.database().ref('posts'); let _this = this; postsRef.on('value', function(snapshot) &#123; console.log(snapshot.val()); _this.setState(&#123; posts: snapshot.val(), loading: false &#125;); &#125;); &#125; firebase.database() gives us a reference to the database service. Using ref(), we can get a specific reference from the database. For example, if we call ref(&#39;posts&#39;), we will be getting the posts reference from our database and storing that reference in postsRef. postsRef.on(&#39;value&#39;, ...) gives us the updated value whenever there is any change in the database. This is very useful when we need a real-time update to our user interface based on any database events. Using postsRef.once(&#39;value&#39;, ...) will only give us the data once. This is useful for data that only needs to be loaded once and isnâ€™t expected to change frequently or require active listening. After we get the updated value in our on() callback, we store the values in our posts state. Now, we will see the data appearing on our console. Also, we will be passing this data down to our children. So, we need to modify the render function of our App/index.js file: 12345678910111213// App/index.jsrender() &#123; return ( &lt;div className=\"App\"&gt; &#123;this.props.children &amp;&amp; React.cloneElement(this.props.children, &#123; firebaseRef: firebase.database().ref('posts'), posts: this.state.posts, loading: this.state.loading &#125;)&#125; &lt;/div&gt; );&#125; This main objective here is to make the posts data available in all our children components which will be passed through react-router. We are checking if this.props.children exists or not and if it exists we clone that element and pass all our props to all our children. This is a very efficient way of passing props to dynamic children. Calling cloneElement will shallowly merge the already existing props in this.props.children and the props, we passed here (firebaseRef, posts and loading). Using this technique, the firebaseRef, posts and loading props will be available to all routes. You can check my commit on Github. Connecting The App With FirebaseFirebase can only store data as objects; it doesnâ€™t have any native support for arrays. We will store the data in the following format: Add the data in the screenshot above manually so that you can test your views. Add views for all the postsNow, we will add views to show all the posts. Create a file src/containers/Posts/index.js with the following content: 1234567891011121314151617181920212223242526272829// src/containers/Posts/index.jsimport React, &#123; Component &#125; from 'react';class Posts extends Component &#123; render() &#123; if (this.props.loading) &#123; return ( &lt;div&gt; Loading... &lt;/div&gt; ); &#125; return ( &lt;div className=\"Posts\"&gt; &#123; this.props.posts.map((post) =&gt; &#123; return ( &lt;div&gt; &#123; post.title &#125; &lt;/div&gt; ); &#125;)&#125; &lt;/div&gt; ); &#125;&#125;export default Posts; Here, we are just mapping over the data and rendering it to the user interface. Next, we need to add this to our routes.js file. 123456789// routes.js...&lt;Router &#123;...props&#125;&gt; &lt;Route path=\"/\" component=&#123; App &#125;&gt; &lt;Route path=\"/posts\" component=&#123; Posts &#125; /&gt; &lt;/Route&gt;&lt;/Router&gt;... This is because we want the posts to show up only on the /posts route. So, we just pass the Posts component to the component prop and /posts to the path prop of the Route component of react-router. If we go to the URL localhost:3000/posts, we will see the posts from our Firebase database. You can check my commit on Github. Add views to write a new postNow, letâ€™s create a view from where we can add a new post. Create a file src/containers/AddPost/index.js with the following content: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455// src/containers/AddPost/index.jsimport React, &#123; Component &#125; from 'react';class AddPost extends Component &#123; constructor() &#123; super(); this.handleChange = this.handleChange.bind(this); this.handleSubmit = this.handleSubmit.bind(this); &#125; state = &#123; title: '' &#125;; handleChange = (e) =&gt; &#123; this.setState(&#123; title: e.target.value &#125;); &#125; handleSubmit = (e) =&gt; &#123; e.preventDefault(); this.props.firebaseRef.push(&#123; title: this.state.title &#125;); this.setState(&#123; title: '' &#125;); &#125; render() &#123; return ( &lt;div className=\"AddPost\"&gt; &lt;input type=\"text\" placeholder=\"Write the title of your post\" onChange=&#123; this.handleChange &#125; value=&#123; this.state.title &#125; /&gt; &lt;button type=\"submit\" onClick=&#123; this.handleSubmit &#125; &gt; Submit &lt;/button&gt; &lt;/div&gt; ); &#125;&#125;export default AddPost; Here, the handleChange method updates our state with the value present in the input box. Now, when we click on the button, the handleSubmit method is triggered. The handleSubmit method is responsible for making the API request to write to our database. We do it using the firebaseRef prop which we passed to all the children. 123this.props.firebaseRef.push(&#123; title: this.state.title&#125;); The above block of code sets the current value of the title to our database. After the new post has been stored in the database, we make the input box empty again ready to add a new post. Now, we need to add this page to our routes. 12345678910111213141516171819// routes.jsimport React from 'react';import &#123; Router, Route &#125; from 'react-router';import App from './containers/App';import Posts from './containers/Posts';import AddPost from './containers/AddPost';const Routes = (props) =&gt; ( &lt;Router &#123;...props&#125;&gt; &lt;Route path=\"/\" component=&#123; App &#125;&gt; &lt;Route path=\"/posts\" component=&#123; Posts &#125; /&gt; &lt;Route path=\"/add-post\" component=&#123; AddPost &#125; /&gt; &lt;/Route&gt; &lt;/Router&gt;);export default Routes; Here, we just added the /add-post route so that we can add a new post from that route. Hence, we passed the AddPost component to its component prop. Also, letâ€™s modify the render method of our src/containers/Posts/index.js file so that it can iterate over objects instead of arrays (since Firebase doesnâ€™t store arrays). 12345678910111213141516171819202122232425// src/containers/Posts/index.jsrender() &#123; let posts = this.props.posts; if (this.props.loading) &#123; return ( &lt;div&gt; Loading... &lt;/div&gt; ); &#125; return ( &lt;div className=\"Posts\"&gt; &#123; Object.keys(posts).map(function(key) &#123; return ( &lt;div key=&#123;key&#125;&gt; &#123; posts[key].title &#125; &lt;/div&gt; ); &#125;)&#125; &lt;/div&gt; ); &#125; Now, if we go to localhost:3000/add-post, we can add a new post. After clicking on the submit button, the new post will appear immediately on the posts page. You can check my commit on Github. Implement votingNow, we need to allow users to vote on a post. For that, letâ€™s modify the render method of our src/containers/App/index.js. 1234567891011121314// src/containers/App/index.jsrender() &#123; return ( &lt;div className=\"App\"&gt; &#123;this.props.children &amp;&amp; React.cloneElement(this.props.children, &#123; // https://github.com/ReactTraining/react-router/blob/v3/examples/passing-props-to-children/app.js#L56-L58 firebase: firebase.database(), posts: this.state.posts, loading: this.state.loading &#125;)&#125; &lt;/div&gt; );&#125; We changed the firebase prop from firebaseRef: firebase.database().ref(&#39;posts&#39;) to firebase: firebase.database() because we will be using Firebaseâ€™s set method to update our voting count. In this way, if we had more Firebase refs, it would be very easy for us to handle them by using only the firebase prop. Before proceeding with the voting, letâ€™s modify the handleSubmit method in our src/containers/AddPost/index.js file a little bit: 1234567891011// src/containers/AddPost/index.jshandleSubmit = (e) =&gt; &#123; ... this.props.firebase.ref('posts').push(&#123; title: this.state.title, upvote: 0, downvote: 0 &#125;); ...&#125; We renamed our firebaseRef prop to firebase prop. So, we change the this.props.firebaseRef.push to this.props.firebase.ref(&#39;posts&#39;).push. Now, we need to modify our src/containers/Posts/index.js file to accomodate the voting. The render method should be modified to: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// src/containers/Posts/index.jsrender() &#123; let posts = this.props.posts; let _this = this; if (!posts) &#123; return false; &#125; if (this.props.loading) &#123; return ( &lt;div&gt; Loading... &lt;/div&gt; ); &#125; return ( &lt;div className=\"Posts\"&gt; &#123; Object.keys(posts).map(function(key) &#123; return ( &lt;div key=&#123;key&#125;&gt; &lt;div&gt;Title: &#123; posts[key].title &#125;&lt;/div&gt; &lt;div&gt;Upvotes: &#123; posts[key].upvote &#125;&lt;/div&gt; &lt;div&gt;Downvotes: &#123; posts[key].downvote &#125;&lt;/div&gt; &lt;div&gt; &lt;button onClick=&#123; _this.handleUpvote.bind(this, posts[key], key) &#125; type=\"button\" &gt; Upvote &lt;/button&gt; &lt;button onClick=&#123; _this.handleDownvote.bind(this, posts[key], key) &#125; type=\"button\" &gt; Downvote &lt;/button&gt; &lt;/div&gt; &lt;/div&gt; ); &#125;)&#125; &lt;/div&gt; );&#125; When the buttons are clicked, the upvote or downvote count will be incremented in our Firebase DB. To handle that logic, we create two more methods: handleUpvote() and handleDownvote(): 1234567891011121314151617// src/containers/Posts/index.jshandleUpvote = (post, key) =&gt; &#123; this.props.firebase.ref('posts/' + key).set(&#123; title: post.title, upvote: post.upvote + 1, downvote: post.downvote &#125;);&#125;handleDownvote = (post, key) =&gt; &#123; this.props.firebase.ref('posts/' + key).set(&#123; title: post.title, upvote: post.upvote, downvote: post.downvote + 1 &#125;);&#125; In these two methods, whenever a user clicks on either of the buttons, the respective count is incremented in the database and is instantly updated in the browser. If we open two tabs with localhost:3000/posts and click on the voting buttons of the posts, we will see each of the tabs get updated almost instantly. This is the magic of using a real-time database like Firebase. You can check my commit on Github. In the repository, Iâ€™ve added the /posts route to the IndexRoute of the application just to show the posts on localhost:3000 by default. You can check that commit on Github. ConclusionThe end result is admittedly a bit barebones, as we didnâ€™t try to implement any design (although the demo has some basic styles added). We also didnâ€™t add any authentication in order to reduce the complexity and the length of the tutorial, but obviously any real-world application would require it. Firebase is really useful for places where you donâ€™t want to create and maintain a separate backend application or where you want real-time data without investing too much time developing your APIs. It plays really well with React, as you can hopefully see from the article.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"},{"name":"firebase","slug":"firebase","permalink":"http://nthung2112.github.io/tags/firebase/"}]},{"title":"Using MySQL with Node.js & the mysql JavaScript Client","slug":"Using-MySQL-with-Node-js-the-mysql-JavaScript-Client","date":"2017-07-23T09:47:48.000Z","updated":"2018-05-18T01:03:22.966Z","comments":true,"path":"2017/07/Using-MySQL-with-Node-js-the-mysql-JavaScript-Client.html","link":"","permalink":"http://nthung2112.github.io/2017/07/Using-MySQL-with-Node-js-the-mysql-JavaScript-Client.html","excerpt":"NoSQL databases are all the rage these days and probably the preferred back-end for Node.js applications. But you shouldnâ€™t architect your next project based on whatâ€™s hip and trendy, rather the type of database to be used should depend on the projectâ€™s requirements. If your project involves dynamic table creation, real time inserts etc. then NoSQL is the way to go, but on the other hand, if your project deals with complex queries and transactions, then a SQL database makes much more sense. In this tutorial, weâ€™ll have a look at getting started with the mysql module â€” a Node.js driver for MySQL, written in JavaScript. Iâ€™ll explain how to use the module to connect to a MySQL database, perform the usual CRUD operations, before examining stored procedures and escaping user input. This popular tutorial was updated on 11.07.2017. Changes include updating to ES6 syntax, addressing the fact that the node-mysql module was renamed, adding more beginner friendly instructions and adding a section on ORMs.","text":"NoSQL databases are all the rage these days and probably the preferred back-end for Node.js applications. But you shouldnâ€™t architect your next project based on whatâ€™s hip and trendy, rather the type of database to be used should depend on the projectâ€™s requirements. If your project involves dynamic table creation, real time inserts etc. then NoSQL is the way to go, but on the other hand, if your project deals with complex queries and transactions, then a SQL database makes much more sense. In this tutorial, weâ€™ll have a look at getting started with the mysql module â€” a Node.js driver for MySQL, written in JavaScript. Iâ€™ll explain how to use the module to connect to a MySQL database, perform the usual CRUD operations, before examining stored procedures and escaping user input. This popular tutorial was updated on 11.07.2017. Changes include updating to ES6 syntax, addressing the fact that the node-mysql module was renamed, adding more beginner friendly instructions and adding a section on ORMs. Quick Start: How to Use MySQL in NodeMaybe youâ€™ve arrived here looking for a quick leg up. If youâ€™re just after a way to get up and running with MySQL in Node in as little time as possible, we got you covered! Hereâ€™s how to use MySQL in Node in 5 easy steps: Create a new project: mkdir mysql-test &amp;&amp; cd mysql-test Create a package.json file: npm init â€“y Install the mysql module: npm install mysql â€“save Create an app.js file and copy in the snippet below. Run the file: node app.js. Observe a â€œConnected!â€ message. 12345678910111213//app.jsconst mysql = require(&apos;mysql&apos;);const connection = mysql.createConnection(&#123; host: &apos;localhost&apos;, user: &apos;user&apos;, password: &apos;password&apos;, database: &apos;database name&apos;&#125;);connection.connect((err) =&gt; &#123; if (err) throw err; console.log(&apos;Connected!&apos;);&#125;); Installing the mysql ModuleNow letâ€™s take a closer look at each of those steps. First of all weâ€™re using the command line to create a new directory and navigate to it. Then weâ€™re creating a package.json file using the command npm init â€“y. The -y flag means that npm will use only defaults and not prompt you for any options. This step also assumes that you have Node and npm installed on your system. If this is not the case, then check out this SitePoint article to find out how to do that: Install Multiple Versions of Node.js using nvm. After that, weâ€™re installing the mysql module from npm and saving it as a project dependency. Project dependencies (as opposed to dev-dependencies) are those packages required for the application to run. You can read more about the differences between the two here. 123mkdir mysql-testcd mysql-testnpm install mysql -y If you need further help using npm, then be sure to check out this guide, or ask in our forums. Getting StartedBefore we get on to connecting to a database, itâ€™s important that you have MySQL installed and configured on your machine. If this is not the case, please consult the installation instructions on their home page. The next thing we need to do is to create a database and a database table to work with. You can do this using agraphical interface, such as phpMyAdmin, or using the command line. For this article Iâ€™ll be using a database called sitepoint and a table called employees. Hereâ€™s a dump of the database, so that you can get up and running quickly, if you wish to follow along: 123456789101112CREATE TABLE employees ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(50), location varchar(50), PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=5 ;INSERT INTO employees (id, name, location) VALUES(1, &apos;Jasmine&apos;, &apos;Australia&apos;),(2, &apos;Jay&apos;, &apos;India&apos;),(3, &apos;Jim&apos;, &apos;Germany&apos;),(4, &apos;Lesley&apos;, &apos;Scotland&apos;); Connecting to the DatabaseNow, letâ€™s create a file called app.js in our mysql-test directory and see how to connect to MySQL from Node.js. 1234567891011121314151617181920212223// app.jsconst mysql = require(&apos;mysql&apos;);// First you need to create a connection to the dbconst con = mysql.createConnection(&#123; host: &apos;localhost&apos;, user: &apos;user&apos;, password: &apos;password&apos;,&#125;);con.connect((err) =&gt; &#123; if(err)&#123; console.log(&apos;Error connecting to Db&apos;); return; &#125; console.log(&apos;Connection established&apos;);&#125;);con.end((err) =&gt; &#123; // The connection is terminated gracefully // Ensures all previously enqueued queries are still // before sending a COM_QUIT packet to the MySQL server.&#125;); Now open up a terminal and enter node app.js. Once the connection is successfully established you should be able to see the â€˜Connection establishedâ€™ message in the console. If something goes wrong (for example you enter the wrong password), a callback is fired, which is passed an instance of the JavaScript Error object (err). Try logging this to the console to see what additional useful information it contains. Using Grunt to Watch the Files for ChangesRunning node app.js by hand every time we make a change to our code is going to get a bit tedious, so letâ€™s automate that. This part isnâ€™t necessary to follow along with the rest of the tutorial, but will certainly save you some keystrokes. Letâ€™s start off by installing a couple of packages: 1npm install --save-dev grunt grunt-contrib-watch grunt-execute Grunt is the well-know JavaScript task runner, grunt-contrib-watch runs a pre-defined task whenever a watched file changes, and grunt-execute can be used to run the node app.js command. Once these are installed, create a file called Gruntfile.js in the project root and add the following code. 1234567891011121314151617181920// Gruntfile.jsmodule.exports = (grunt) =&gt; &#123; grunt.initConfig(&#123; execute: &#123; target: &#123; src: [&apos;app.js&apos;] &#125; &#125;, watch: &#123; scripts: &#123; files: [&apos;app.js&apos;], tasks: [&apos;execute&apos;], &#125;, &#125; &#125;); grunt.loadNpmTasks(&apos;grunt-contrib-watch&apos;); grunt.loadNpmTasks(&apos;grunt-execute&apos;);&#125;; Now run grunt watch and make a change to app.js. Grunt should detect the change and re-run the node app.js command. Executing QueriesReadingNow that you know how to establish a connection to MySQL from Node.js, letâ€™s see how to execute SQL queries. Weâ€™ll start by specifying the database name (sitepoint) in the createConnection command. 123456const con = mysql.createConnection(&#123; host: &apos;localhost&apos;, user: &apos;user&apos;, password: &apos;password&apos;, database: &apos;sitepoint&apos;&#125;); Once the connection is established weâ€™ll use the connection variable to execute a query against the database table employees. 123456con.query(&apos;SELECT * FROM employees&apos;, (err,rows) =&gt; &#123; if(err) throw err; console.log(&apos;Data received from Db:\\n&apos;); console.log(rows);&#125;); When you run app.js (either using grunt-watch or by typing node app.js into your terminal), you should be able to see the data returned from database logged to the terminal. 1234[ &#123; id: 1, name: &apos;Jasmine&apos;, location: &apos;Australia&apos; &#125;, &#123; id: 2, name: &apos;Jay&apos;, location: &apos;India&apos; &#125;, &#123; id: 3, name: &apos;Jim&apos;, location: &apos;Germany&apos; &#125;, &#123; id: 4, name: &apos;Lesley&apos;, location: &apos;Scotland&apos; &#125; ] Data returned from the MySQL database can be parsed by simply lopping over the rows object. 123rows.forEach( (row) =&gt; &#123; console.log(`$&#123;row.name&#125; is in $&#123;row.location&#125;`); &#125;); CreatingYou can execute an insert query against a database, like so: 123456const employee = &#123; name: &apos;Winnie&apos;, location: &apos;Australia&apos; &#125;;con.query(&apos;INSERT INTO employees SET ?&apos;, employee, (err, res) =&gt; &#123; if(err) throw err; console.log(&apos;Last insert ID:&apos;, res.insertId);&#125;); Note how we can get the ID of the inserted record using the callback parameter. UpdatingSimilarly, when executing an update query, the number of rows affected can be retrieved using result.affectedRows: 123456789con.query( &apos;UPDATE employees SET location = ? Where ID = ?&apos;, [&apos;South Africa&apos;, 5], (err, result) =&gt; &#123; if (err) throw err; console.log(`Changed $&#123;result.changedRows&#125; row(s)`); &#125;); DestroyingSame thing goes for a delete query: 1234567con.query( &apos;DELETE FROM employees WHERE id = ?&apos;, [5], (err, result) =&gt; &#123; if (err) throw err; console.log(`Deleted $&#123;result.affectedRows&#125; row(s)`); &#125;); Advanced UseIâ€™d like to finish off by looking at how the mysql module handles stored procedures and the escaping of user input. Stored ProceduresPut simply, a stored procedure is a procedure (written in, for example, SQL) stored in a database which can be called by the database engine and connected programming languages. If you are in need of a refresher, then please check out this excellent article. Letâ€™s create a stored procedure for our sitepoint database which fetches all the employee details. Weâ€™ll call it sp_getall . To do this, youâ€™ll need some kind of interface to the database. Iâ€™m using phpMyAdmin. Run the following query on the sitepoint database: 123456DELIMITER $$CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getall`()BEGIN SELECT id, name, location FROM employees;END This will create and store the procedure in the information_schema database in the ROUTINES table. Next, establish a connection and use the connection object to call the stored procedure as shown: 123456con.query(&apos;CALL sp_getall()&apos;,function(err, rows)&#123; if (err) throw err; console.log(&apos;Data received from Db:\\n&apos;); console.log(rows);&#125;); Save the changes and run the file. Once executed you should be able to view the data returned from the database. 123456789101112[ [ &#123; id: 1, name: &apos;Jasmine&apos;, location: &apos;Australia&apos; &#125;, &#123; id: 2, name: &apos;Jay&apos;, location: &apos;India&apos; &#125;, &#123; id: 3, name: &apos;Jim&apos;, location: &apos;Germany&apos; &#125;, &#123; id: 4, name: &apos;Lesley&apos;, location: &apos;Scotland&apos; &#125; ], &#123; fieldCount: 0, affectedRows: 0, insertId: 0, serverStatus: 34, warningCount: 0, message: &apos;&apos;, protocol41: true, changedRows: 0 &#125; ] Along with the data, it returns some additional information, such as the affected number of rows, insertId etc. You need to iterate over the 0th index of the returned data to get employee details separated from the rest of the information. 123rows[0].forEach( (row) =&gt; &#123; console.log(`$&#123;row.name&#125; is in $&#123;row.location&#125;`);&#125;); Now lets consider a stored procedure which requires an input parameter. 12345678DELIMITER $$CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_get_employee_detail`( in employee_id int)BEGIN SELECT name, location FROM employees where id = employee_id;END Now we can pass the input parameter while making a call to the stored procedure: 123456con.query(&apos;CALL sp_get_employee_detail(1)&apos;, (err, rows) =&gt; &#123; if(err) throw err; console.log(&apos;Data received from Db:\\n&apos;); console.log(rows[0]);&#125;); Most of the time when we try to insert a record into the database, we need the last inserted ID to be returned as an out parameter. Consider the following insert stored procedure with an out parameter: 123456789101112DELIMITER $$CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_insert_employee`( out employee_id int, in employee_name varchar(25), in employee_location varchar(25))BEGIN insert into employees(name, location) values(employee_name, employee_location); set employee_id = LAST_INSERT_ID();END To make a procedure call with an out parameter, we first need to enable multiple calls while creating the connection. So, modify the connection by setting the multiple statement execution to true. 1234567const con = mysql.createConnection(&#123; host: &apos;localhost&apos;, user: &apos;user&apos;, password: &apos;password&apos;, database: &apos;sitepoint&apos;, multipleStatements: true&#125;); Next when making a call to the procedure, set an out parameter and pass it in. 123456789con.query( &quot;SET @employee_id = 0; CALL sp_insert_employee(@employee_id, &apos;Ron&apos;, &apos;USA&apos;); SELECT @employee_id&quot;, (err, rows) =&gt; &#123; if (err) throw err; console.log(&apos;Data received from Db:\\n&apos;); console.log(rows); &#125;); As seen in the above code, we have set an out parameter @employee_id and passed it while making a call to the stored procedure. Once the call has been made we need to select the out parameter to access the returned ID. Run app.js. On successful execution you should be able to see the selected out parameter along with various other information. rows[2] should give you access to the selected out parameter. 1[ &#123; &apos;@employee_id&apos;: 6 &#125; ] Escaping User InputIn order to avoid SQL Injection attacks, you should always escape any data from user land before using it inside a SQL query. Letâ€™s demonstrate why: 123456789const userLandVariable = &apos;4 &apos;;con.query( `SELECT * FROM employees WHERE id = $&#123;userLandVariable&#125;`, (err, rows) =&gt; &#123; if(err) throw err; console.log(rows); &#125;); This seems harmless enough and even returns the correct result: 1&#123; id: 4, name: &apos;Lesley&apos;, location: &apos;Scotland&apos; &#125; However, if we change the userLandVariable to this: 1const userLandVariable = &apos;4 OR 1=1&apos;; we suddenly have access to the entire data set. If we then change it to this: 1const userLandVariable = &apos;4; DROP TABLE employees&apos;; then weâ€™re in proper trouble! The good news is that help is at hand. You just have to use the mysql.escape method: 1234con.query( `SELECT * FROM employees WHERE id = $&#123;mysql.escape(userLandVariable)&#125;`, function(err, rows)&#123; ... &#125;); Or by using a question mark placeholder, as we did in the examples at the beginning of the article: 12345 con.query( &apos;SELECT * FROM employees WHERE id = ?&apos;, [userLandVariable], (err, rows) =&gt; &#123; ... &#125;); Why Not Just USE an ORM?As you may have noticed, a couple of people in the comments are suggesting using an ORM. Before we get into the pros and cons of this approach, letâ€™s take a second to look at what ORMs are. The following is taken from an answer on Stack Overflow: Object-Relational Mapping (ORM) is a technique that lets you query and manipulate data from a database using an object-oriented paradigm. When talking about ORM, most people are referring to a library that implements the Object-Relational Mapping technique, hence the phrase â€œan ORMâ€. So basically, this approach means you write your database logic in the domain-specific language of the ORM, as opposed to the vanilla approach we have been taking so far. Hereâ€™s a contrived example using Sequelize: 123Employee.findAll().then(employees =&gt; &#123; console.log(employees);&#125;); Contrasted with: 123456con.query(&apos;SELECT * FROM employees&apos;, (err,rows) =&gt; &#123; if(err) throw err; console.log(&apos;Data received from Db:\\n&apos;); console.log(rows);&#125;); Whether or not using an ORM makes sense for you, will depend very much on what you are working on and with whom. On the one hand, ORMS tend to make developers more productive, in part by abstracting away a large part of the SQL so that not everyone on the team needs to know how to write super efficient database specific queries. It is also easy to move to different database software, because you are developing to an abstraction. On the other hand however, it is possible to write some really messy and inefficient SQL as a result of not understanding how the ORM does what it does. Performance is also an issue in that itâ€™s much easier to optimize queries that donâ€™t have to go through the ORM. Whichever path you take is up to you, but if this is a decision youâ€™re in the process of making, check out this Stack Overflow thread: Why should you use an ORM? as well as this post on SitePoint: 3 JavaScript ORMs You Might Not Know. ConclusionIn this tutorial, weâ€™ve only scratched the surface of what the mysql client offers. For more detailed information, I would recommend reading the official documentation. There are other options too, such as node-mysql2 and node-mysql-libmysqlclient.","categories":[],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"nodejs","slug":"nodejs","permalink":"http://nthung2112.github.io/tags/nodejs/"},{"name":"mysql","slug":"mysql","permalink":"http://nthung2112.github.io/tags/mysql/"}]},{"title":"10 React mini-patterns","slug":"10-react-mini-patterns","date":"2017-07-16T14:50:48.000Z","updated":"2017-08-20T16:43:56.760Z","comments":true,"path":"2017/07/10-react-mini-patterns.html","link":"","permalink":"http://nthung2112.github.io/2017/07/10-react-mini-patterns.html","excerpt":"Over the last few years, Iâ€™ve worked on a handful of decent-sized React projects, and many, many pint-sized ones. Throughout this magical journey, a number of patterns have come up that I find myself repeating again and again. Because thatâ€™s what patterns are. These are the sorts of things I would like to have heard about on day one. So if today is your day one with React, youâ€™re in luck. Or maybe youâ€™re not. Thereâ€™s only one way to find outâ€¦ Itâ€™s a long one, but itâ€™s a listicle so you can skip the boring ones (3, 6, 8, 10).","text":"Over the last few years, Iâ€™ve worked on a handful of decent-sized React projects, and many, many pint-sized ones. Throughout this magical journey, a number of patterns have come up that I find myself repeating again and again. Because thatâ€™s what patterns are. These are the sorts of things I would like to have heard about on day one. So if today is your day one with React, youâ€™re in luck. Or maybe youâ€™re not. Thereâ€™s only one way to find outâ€¦ Itâ€™s a long one, but itâ€™s a listicle so you can skip the boring ones (3, 6, 8, 10). #1 Sending data down and upThe one thing Iâ€™d recommend to everyone new to React is to get your head around the pattern of passing information down (as objects, strings, etc.) and passing methods down to allow child components to pass information back up. Like sending down a packet of chips and a walkie talkie to miners trapped underground. How about a picture? The below thing is the simplest form of this pattern. Worth a thousand words? Parent on the left, child on the right. You can think of the two props that connect these components as allowing information to flow in either direction between the two. The prop called items is passing data down into the child component. The prop called deleteItem is giving the child component a way to send some information back up into the parent (â€œhey, delete this itemâ€). Thatâ€™s not really a pattern. The rest are patterns. I promise. #2 Fixing HTMLâ€™s inputsOne of the great things about React, and web components in general, is that you get to iron out the kinks if something in html doesnâ€™t work the way you want. If you think about the different elements that allow for user input (do it), you will soon see that the naming of these elements is nonsensical, bordering on reckless. If Iâ€™m building a site that will have a lot of user inputs, one of the first things I do is fix this. Itâ€™s not purely cosmetic though; there are more improvements to be had: Inputs should return a value via an onChange method, not a JavaScript Event instance, shouldnâ€™t they? You can go a step further and ensure that the data type returned in onChange matches the type passed in. If the typeof props.value is number, then convert e.target.value back to a number before sending the data out again. A set of radio buttons is functionally the same thing as a &lt;select&gt;, right? Itâ€™s messed up to treat them in a completely different manner when the only difference is the UI. Maybe for your app it makes sense to have a single &lt;PickOneFromMany /&gt; component and pass either ui=&quot;radio&quot; or ui=&quot;dropDown&quot;. The point is not to do it like I do it. The point is to make them your own â€” you donâ€™t need to keep working with the somewhat ass-about nature of HTMLâ€™s user input elements. #3 Binding labels to inputs with unique IDsOn the topic of inputsâ€¦ if you care about your users, youâ€™ll bind your &lt;label&gt; elements to your &lt;input&gt;s via an id/for combo. But you donâ€™t want to think of some clever and unique id for every input you define, whoâ€™s got time for that? I donâ€™t know about you but Iâ€™ve got goat videos to watch. (Frequent-flyer tip: if you have a screaming child on your flight, close your eyes and pretend youâ€™re watching a video on YouTube of goats that sound like humans. Annoying becomes hilarious.) Back to it. You could generate a random ID for each input/label pair, but then your client-rendered HTML wonâ€™t match your server-rendered HTML. Checksum error! Thatâ€™s no good. So, instead you can create a little module that gives an incrementing ID, and use that in an Input component like so: Obviously it makes more sense when the input isnâ€™t inside the label. If getNextId() simply increments a number every time itâ€™s called, then when rendering on the server, the number would keep going up and up, eventually reaching infinity. So youâ€™ll want to reset the number each time you render the app (for each network request). You can do this at the entry point to your app, with a simple resetId() or whatever name you think is best. With all that taken into account, your super-fancy module might look something like this: #4 Controlling CSS with propsWhen you want to apply different CSS in different instances (e.g. â€˜primaryâ€™ and â€˜secondaryâ€™ buttons) you can pass in props to control which CSS to apply. This seems super simple on the surface, but let me assure you there are a lot of wrong ways to do this (Iâ€™ve tried them all!). There are â€” I reckon â€” three distinct ways in which you can control the CSS applied to a component. Using themesFor grouping a number of CSS declarations together, you can use the idea of â€˜themesâ€™, for example primary or secondary button: &lt;Button theme=&quot;secondary&quot;&gt;Hello&lt;/Button&gt; Do your best to only require one theme per component. Using flagsMaybe some of your buttons have rounded corners, but this doesnâ€™t correspond directly with the themes you have defined. In this case you can either sit your designer down and have the consistency talk, or create a boolean prop which might look a little something like this: &lt;Button theme=&quot;secondary&quot; rounded&gt;Hello&lt;/Button&gt; Just like HTMLâ€™s binary attributes, you donâ€™t need to do rounded={true}. Setting valuesIn some cases you might want to pass in the value of a CSS property directly (in the component you would set it as an inline style). &lt;Icon width=&quot;25&quot; height=&quot;25&quot; type=&quot;search&quot; /&gt; An exampleImagine youâ€™re creating a link component. You go through your siteâ€™s designs and work out that there are three distinct themes, and that sometimes they have an underline, sometimes they donâ€™t. Hereâ€™s how I would design that component: And the CSSâ€¦ You may have noticed the awkward double negative for link--no-underline. Story time: I used to think writing fewer lines of CSS was the goal, but itâ€™s not. Iâ€™d rather have some double-negatives and multi-selector rulesets if it means the styles are applied in a nice layered way. Iâ€™m sure Iâ€™ve said it before but the hardest thing about scaling a website is the CSS. JavaScript is easy, but with CSS you pay for your sins â€” once youâ€™ve started a mess, itâ€™s not easy to back out of. True fact: fighting CSS specificity is the number one cause of death among web developers. If youâ€™re on a big computer, check out the CSS for the little notification icon in mediumâ€™s top nav. If youâ€™re not, or youâ€™re lazy, just guess how many CSS rules are combined to make this round circle with a number in it? Twenty three rules. Thatâ€™s not including the styles inherited from eleven other rules. The line-height alone is overridden nine times. If line-height was a cat it would be dead by now. This cannot be pleasant to maintain. With React we can do better. We can thoughtfully design which classes are applied to our components. We can remove global resets and move it all inside our Button.scss. We can remove all reliance on specificity and ordering of files. Side note: I dream of a day when we will be able to tell browsers that we donâ€™t want their opinion about style at all. ::user-agent-styles: none-whatsoever; â€” make it happen, vendors. [Edit: a clever chap in the comments has pointed out that all: unset may cure what ails me.] #5 The switching componentA switching component is a component that renders one of many components. This may be a &lt;Page&gt; component that displays one of many pages. Or tabs in a tab set, or different modals in a modal component. I used to do this with switch statements, then progressed to actually passing in the component I wanted rendered. Then moved on to exporting references to the components from the component itself (as named exports, then as properties on the component). All terrible ideas. The potentially-terrible approach that I have settled on is to use an object to map prop values to components. The keys of the PAGES object can be used in the prop types to catch dev-time errors. Then of course we would use this like &lt;Page page=&quot;home&quot; /&gt;. If you replace the keys home, about and user with /, /about, and /user, youâ€™ve got yourself half a router. (Future post idea: removing react-router.) #6 Reaching into a componentIf youâ€™re looking for an easy way to please your users, add autofocus to the input that they are most likely to type into when coming to a page. It really is that easy. Perhaps you have a sign-in form and â€” being the UX champ that you are â€” you want to put that little blinking cursor in the â€˜user nameâ€™ field. But oh no, the form shows in a modal when the user clicks â€˜sign inâ€™, and the autofocus attribute only applies to page load. Whatever will you do! Youâ€™ll programmatically focus the element, thatâ€™s what. Here you may be tempted to give the input an id and type document.getElementById(&#39;user-name-input&#39;).focus(). This works, but is not The Correct Way. The fewer things you have in your app that rely on two strings matching, the better. Luckily, there is a very easy way to do this â€˜properlyâ€™: Boom, an input component with a focus() method that focuses the HTML element. In the parent component, we can get a reference to the Input component and call its focus() method. Note that when you use ref on a component, itâ€™s a reference to the component (not the underlying element), so you have access to its methods. #7 Almost-componentsLetâ€™s say youâ€™re building a component that lets you search for people. As you type, you see a list of names and photos of potential matches. Something like this. (Iâ€™m searching for political satirists because I, like everyone, am super interested in what other people think about politics.) When designing this component, you may think to yourself: is each item in that list itâ€™s own SearchSuggestion component? Itâ€™s really only a few lines of HTML and CSS, so maybe not? But I was once told â€˜if in doubt, create another componentâ€™. Oh my, this is quite the dilly of a pickle, isnâ€™t it? If I was making this, I would not have a separate component. Instead, just a renderSearchSuggestion method that returned the appropriate DOM for each entry. I can then generate the results like: If things get more complex or you want to use this component elsewhere, you should be able to copy/paste the code out into a new component. Donâ€™t prematurely componentize. Components arenâ€™t like teaspoons; you can have too many. What I am not saying: â€œtake something that you think should be a component, and make it part of the parent component.â€ What I am saying: â€œtake something that you donâ€™t think should be a component, and make it a bit more like its own component (if it can be).â€ #8 Components for formatting textWhen I first started with React I thought of components as big things, a way of grouping structural chunks of DOM. But components work just as well as a way to apply formatting. Hereâ€™s a &lt;Price&gt; component that takes a number and returns a pretty string, with or without decimals and a â€˜$â€™ sign. As you can see Iâ€™m using the powerful Intl string formatting library, hereâ€™s a link to their website. I should point out (before some punk does) that this is not a saving in lines of code. You could just as easily use a function to do this. (Of course components are just functions with different shaped brackets.) Itâ€™s less code, but to my eye, not quite as nice: Note that Iâ€™m not checking that I got a valid number in any of the above. Thatâ€™s because â€¦ #9 The store is the componentâ€™s servantI have probably written this thousands of times: if (props.user.signInStatus === SIGN_IN_STATUSES.SIGNED_IN)... (Iâ€™ve been told that I exaggerate, like, a gazillion times.) Quite recently I have decided that if Iâ€™m doing a check like this, Iâ€™m doing it wrong. I want to just ask â€œis the user signed in?â€, not â€œis the sign in status of the user equal to signed in?â€ My components have enough going on in their lives, they shouldnâ€™t have to worry their pretty little heads over such matters. Nor should they have to worry that a price isnâ€™t being sent as a number, or a boolean as the word â€˜trueâ€™. For you see, if the data in your store is designed to match your components, your components will be much simpler. And Iâ€™ve said it before, complexity is where the bugs hide. The less complexity you have in your components, the lower the chance of bugs. But the complexity has to go somewhere, doesnâ€™t it? My suggestion is this: Work out the general structure of your components and the data they will require Design your store to support those requirements Do whatever you need to do to your incoming data to make it fit into the store. For this last point, I recommend a single module that does all the massaging of incoming data (oh la la). Renaming props, casting strings to numbers, objects into arrays, date strings to date objects, whatever. Do it all in the one place, and unit test the crap out of it. If youâ€™re rockinâ€™ a react/redux setup, you might then do something like this in an action creator that fetches search results: Your components will thank you for it. #10 Importing components without relative pathsWouldnâ€™t it be sweet if instead of doing this: **import** Button **from** '../../../../Button/Button.jsx'; **import** Icon **from** '../../../../Icon/Icon.jsx'; **import** Footer **from** '../../Footer/Footer.jsx'; You could just do this: 1import &#123;Button, Icon, Footer&#125; from &apos;Components&apos;; Well in theory you can: Create a single index.js somewhere that exports references each of your components Use Webpackâ€™s resolve.alias to redirect Components to that index file I hadnâ€™t done this before, and planned to convert one of my existing apps for this post (then lie and tell you I totes do it all the time). But as I wrote the code I came to realise that this is a bad idea, for three reasons: It seems to be broken in Webpack 2. Itâ€™s an eslint error because Components wonâ€™t be in node_modules. If you use a good IDE, it will know things about your components. You will get clever warnings about not supplying required props, the ability to cmd/ctrl+click to open that componentâ€™s file. Things of that nature.If you do the above, your IDE will no longer know where to find that component and youâ€™ll lose those smarts. Thanks, WebStorm. Edit: matthew hsiung has a solution for the eslint and WebStorm issues in this comment. Wrap upThatâ€™s the lot of them. Iâ€™m quite sure Iâ€™ll look at this in a year and wince. Perhaps youâ€™ll do it today. Perhaps youâ€™ll share something that has served you well. Oh and Iâ€™ve decided I donâ€™t care if you click the little green heart or not. I WILL NOT BE DEFINED BY AN INTERNET METRIC.","categories":[],"tags":[{"name":"react","slug":"react","permalink":"http://nthung2112.github.io/tags/react/"}]},{"title":"TÃ¬m hiá»ƒu vá» async vÃ  await Ä‘Æ¡n giáº£n","slug":"Javascript-Tim-hieu-ve-async-va-await-don-gian","date":"2017-01-10T13:03:38.000Z","updated":"2017-08-20T14:51:30.727Z","comments":true,"path":"2017/01/Javascript-Tim-hieu-ve-async-va-await-don-gian.html","link":"","permalink":"http://nthung2112.github.io/2017/01/Javascript-Tim-hieu-ve-async-va-await-don-gian.html","excerpt":"1. Giá»›i thiá»‡uVá»›i cÃ¡c Ä‘áº·c táº£ JavaScript cÅ©, ta pháº£i sá»­ dá»¥ng cÃ¡c hÃ m pháº£n há»“i Ä‘á»ƒ xá»­ lÃ½ cÃ¡c thao tÃ¡c báº¥t Ä‘á»“ng bá»™. Tuy nhiÃªn viá»‡c nÃ y dáº«n tá»›i tÃ¬nh tráº¡ng callback hell khi ta cÃ³ nhiá»u thao tÃ¡c báº¥t Ä‘á»“ng bá»™ pháº£i chá» nhau thá»±c hiá»‡n. Call hell lÃ m cho mÃ£ nguá»“n cá»§a ta ráº¥t rá»‘i vÃ  khÃ³ báº£o trÃ¬. 12345678910111213141516function wait(ms, cb) &#123; setTimeout(cb, ms)&#125;function main() &#123; console.log('sáº¯p rá»“i...') wait(2007, () =&gt; &#123; console.log('chá» tÃ­...') wait(2012, () =&gt; &#123; console.log('thÃªm chÃºt ná»¯a thÃ´i...') wait(2016, () =&gt; &#123; console.log('xong rá»“i Ä‘áº¥y!') &#125;) &#125;) &#125;)&#125; VÃ¬ váº­y, vá»›i phiÃªn báº£n ES6 (ES 2016), Promise Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a vÃ o máº·c Ä‘á»‹nh nháº±m giáº£i quyáº¿t tÃ¬nh tráº¡ng callback hell. Vá»›i Promise, mÃ£ nguá»“n cá»§a ta sáº½ trÃ´ng gáº§n giá»‘ng vá»›i phong cÃ¡ch Ä‘á»“ng bá»™, káº¿t quáº£ lÃ  trÃ´ng dá»… theo dÃµi vÃ  báº£o trÃ¬ hÆ¡n. Tuy nhiÃªn sá»­ dá»¥ng Promise láº¡i lÃ m phÃ¡t sinh váº¥n Ä‘á» â€œkhÃ¡â€ tÆ°Æ¡ng tá»± lÃ  Promise hell ( lol! JavaScript Heo! ).","text":"1. Giá»›i thiá»‡uVá»›i cÃ¡c Ä‘áº·c táº£ JavaScript cÅ©, ta pháº£i sá»­ dá»¥ng cÃ¡c hÃ m pháº£n há»“i Ä‘á»ƒ xá»­ lÃ½ cÃ¡c thao tÃ¡c báº¥t Ä‘á»“ng bá»™. Tuy nhiÃªn viá»‡c nÃ y dáº«n tá»›i tÃ¬nh tráº¡ng callback hell khi ta cÃ³ nhiá»u thao tÃ¡c báº¥t Ä‘á»“ng bá»™ pháº£i chá» nhau thá»±c hiá»‡n. Call hell lÃ m cho mÃ£ nguá»“n cá»§a ta ráº¥t rá»‘i vÃ  khÃ³ báº£o trÃ¬. 12345678910111213141516function wait(ms, cb) &#123; setTimeout(cb, ms)&#125;function main() &#123; console.log('sáº¯p rá»“i...') wait(2007, () =&gt; &#123; console.log('chá» tÃ­...') wait(2012, () =&gt; &#123; console.log('thÃªm chÃºt ná»¯a thÃ´i...') wait(2016, () =&gt; &#123; console.log('xong rá»“i Ä‘áº¥y!') &#125;) &#125;) &#125;)&#125; VÃ¬ váº­y, vá»›i phiÃªn báº£n ES6 (ES 2016), Promise Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a vÃ o máº·c Ä‘á»‹nh nháº±m giáº£i quyáº¿t tÃ¬nh tráº¡ng callback hell. Vá»›i Promise, mÃ£ nguá»“n cá»§a ta sáº½ trÃ´ng gáº§n giá»‘ng vá»›i phong cÃ¡ch Ä‘á»“ng bá»™, káº¿t quáº£ lÃ  trÃ´ng dá»… theo dÃµi vÃ  báº£o trÃ¬ hÆ¡n. Tuy nhiÃªn sá»­ dá»¥ng Promise láº¡i lÃ m phÃ¡t sinh váº¥n Ä‘á» â€œkhÃ¡â€ tÆ°Æ¡ng tá»± lÃ  Promise hell ( lol! JavaScript Heo! ). 12345678910111213141516171819function wait(ms) &#123; return new Promise(r =&gt; setTimeout(r, ms)) &#125;function main() &#123; console.log('sáº¯p rá»“i...') wait(2007).then(() =&gt; &#123; console.log('chá» tÃ­...') return wait(2007) &#125;).then(() =&gt; &#123; console.log('thÃªm chÃºt ná»¯a thÃ´i...') return wait(2012) &#125;).then(() =&gt; &#123; console.log('thÃªm chÃºt ná»¯a thÃ´i...') return wait(2016) &#125;).then(() =&gt; &#123; console.log('xong rá»“i Ä‘áº¥y!') &#125;)&#125; Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘Ã³, á»Ÿ phiÃªn báº£n ES7 (ES 2017), 1 khÃ¡i niá»‡m vá»›i 2 tá»« khÃ³a má»›i Ä‘Æ°á»£c Ä‘Æ°a vÃ o lÃ  hÃ m async (async / await). HÃ m async cho phÃ©p ta viáº¿t cÃ¡c thao tÃ¡c báº¥t Ä‘á»“ng bá»™ vá»›i phong cÃ¡ch cá»§a cÃ¡c mÃ£ Ä‘á»“ng bá»™. Báº±ng cÃ¡ch viáº¿t nhÆ° váº­y, mÃ£ nguá»“n cá»§a ta trÃ´ng sáº½ sÃ¡ng sá»§a, dá»… Ä‘á»c hÆ¡n vÃ  â€œdá»… hiá»ƒu hÆ¡nâ€. 12345678910111213function wait(ms) &#123; return new Promise(r =&gt; setTimeout(r, ms)) &#125;async function main() &#123; console.log('sáº¯p rá»“i...') await wait(2007) console.log('chá» tÃ­...') await wait(2012) console.log('thÃªm chÃºt ná»¯a thÃ´i...') await wait(2016) console.log('xong rá»“i Ä‘áº¥y!')&#125; 2. CÃ¡ch sá»­ dá»¥ngÄá»ƒ sá»­ dá»¥ng hÃ m async, ta cáº§n khai bÃ¡o tá»« khÃ³a async ngay trÆ°á»›c tá»« khÃ³a Ä‘á»‹nh nghÄ©a hÃ m. Tá»©c lÃ , vá»›i hÃ m Ä‘á»‹nh nghÄ©a vá»›i tá»« khÃ³a function ta pháº£i khai bÃ¡o ngay trÆ°á»›c function, vá»›i hÃ m mÅ©i tÃªn (arrow function) ta pháº£i khai bÃ¡o trÆ°á»›c táº­p tham sá»‘ Ä‘áº§u vÃ o, vá»›i phÆ°Æ¡ng thá»©c cá»§a lá»›p Class thÃ¬ ta pháº£i khai bÃ¡o ngay trÆ°á»›c tÃªn hÃ m. 1234567891011121314151617181920// regular functionasync function functionName() &#123; let ret = await new Google().search('JavaScript')&#125;// arrow functionlet arr = ['JS', 'node.js'].map(async val =&gt; &#123; return await new Google().search(val)&#125;)// Classclass Google &#123; constructor() &#123; this.apiKey = '...' &#125; async search(keyword) &#123; return await this.searchApi(keyword) &#125;&#125; Vá»›i tá»« khÃ³a async nÃ y, ta cÃ³ thá»ƒ Ä‘á»£i cÃ¡c Promise (thao tÃ¡c báº¥t Ä‘á»“ng bá»™) xá»­ lÃ½ trong hÃ m Ä‘Ã³ mÃ  khÃ´ng táº¡m dÃ¹ng luá»“ng chÃ­nh báº±ng tá»« khÃ³a await nhÆ° vÃ­ dá»¥ trÃªn. Káº¿t quáº£ tráº£ ra cá»§a hÃ m async luÃ´n lÃ  má»™t Promise dÃ¹ báº¡n cÃ³ gá»i await - cÃ³ xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ hay khÃ´ng. Promise nÃ y sáº½ á»Ÿ tráº¡ng thÃ¡i thÃ nh cÃ´ng vá»›i káº¿t quáº£ Ä‘Æ°á»£c tráº£ ra vá»›i tá»« khÃ³a return cá»§a hÃ m async, hoáº·c tráº¡ng thÃ¡i tháº¥t báº¡i vá»›i káº¿t quáº£ Ä‘Æ°á»£c Ä‘áº©y qua tá»« khÃ³a throw trong hÃ m async. NhÆ° váº­y, báº£n cháº¥t cá»§a hÃ m async chÃ­nh lÃ  Promise. Náº¿u báº¡n chÆ°a tÃ¬m hiá»ƒu vá» Promise thÃ¬ nÃªn Ä‘á»c trÆ°á»›c á»Ÿ bÃ i viáº¿t nÃ y. Vá»›i Promise, ta cÃ³ thá»ƒ xá»­ lÃ½ ngoáº¡i lá»‡ vá»›i catch khÃ¡ Ä‘Æ¡n giáº£n. Tuy nhiÃªn cÅ©ng khÃ´ng dá»… dÃ ng theo dÃµi vÃ  dá»… Ä‘á»c. NhÆ°ng vá»›i hÃ m async, viá»‡c nÃ y cá»±c kÃ¬ Ä‘Æ¡n giáº£n báº±ng tá»« khÃ³a try catch há»‡t nhÆ° cÃ¡c thao tÃ¡c Ä‘á»“ng bá»™. 1234567891011121314151617181920212223242526272829//// test.js//function wait(ms) &#123; return new Promise(r =&gt; setTimeout(r, ms)) &#125;async function runner() &#123; console.log('sáº¯p rá»“i...') await wait(2007) console.log('chá» tÃ­...') await wait(2012) console.log('thÃªm chÃºt ná»¯a thÃ´i...') await wait(2016) throw new Error(2016)&#125;async function main() &#123; try &#123; await runner() console.log('xong rá»“i Ä‘áº¥y!') &#125; catch (e) &#123; console.log(`cÃ³ váº¥n Ä‘á» táº¡i $&#123; e &#125;`) &#125;&#125;// Node v7// `$ node --harmony-async-await test.js`// Console: ... cÃ³ váº¥n Ä‘á» táº¡i 2016 Ngon! RÃµ rÃ ng lÃ  mÃ£ nguá»“n sá»­ dá»¥ng async/await trÃ´ng Ä‘Æ¡n giáº£n, dá»… theo dÃµi, â€œdá»… hiá»ƒuâ€ hÆ¡n vÃ  giáº£i quyáº¿t Ä‘Æ°á»£c tÃ¬nh tráº¡ng callback - promise hell. Tuy nhiÃªn, viá»‡c sá»­ dá»¥ng nÃ³ cÅ©ng khÃ´ng pháº£i lÃºc nÃ o cÅ©ng Ä‘Æ¡n giáº£n. Ta cÃ¹ng nhau xem má»™t sá»‘ trÆ°á»ng há»£p dÆ°á»›i Ä‘Ã¢y. 3. LÆ°u Ã½3.1. QuÃªn khai bÃ¡o tá»« khÃ³a asyncÄÆ°Æ¡ng nhiÃªn rá»“i, khÃ´ng khai bÃ¡o tá»« khÃ³a nÃ y thÃ¬ ta khÃ´ng cÃ³ hÃ m async Ä‘Æ°á»£c, khÃ´ng sá»­ dá»¥ng await Ä‘Æ°á»£c rá»“i. ThÆ°á»ng báº¡n sáº½ nghÄ© Ä‘Æ¡n giáº£n lÃ  khÃ´ng thá»ƒ nÃ o quÃªn Ä‘Æ°á»£c tá»« khÃ³a nÃ y, nhÆ°ng tÃ´i nghÄ© Ä‘Ã´i lÃºc cÃ³ thá»ƒ Ä‘áº¥y. VÃ­ dá»¥ nhÆ° vá»›i trÆ°á»ng há»£p khai bÃ¡o má»™t hÃ m trong má»™t hÃ m async. HÃ m khai bÃ¡o trong hÃ m async cÅ©ng báº¯t buá»™c pháº£i Ä‘Æ°á»£c khai bÃ¡o vá»›i tá»« khÃ³a async náº¿u nhÆ° báº¡n muá»‘n sá»­ dá»¥ng nhÆ° má»™t hÃ m async. 123456async function main() &#123; await wait(1000) let arr = [100, 300, 500].map(val =&gt; wait(val)) arr.forEach(func =&gt; await func) // ??? error&#125; 3.2. Nháº­p nháº±ng tá»« khÃ³a awaitCÃ³ 2 tÃ¬nh huá»‘ng Ä‘iá»ƒn hÃ¬nh cho trÆ°á»ng há»£p nÃ y lÃ : QuÃªn khai bÃ¡o khi cáº§n Ä‘á»£i má»™t xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ CÃ³ gÃ¬ Ä‘Ã¡ng sá»£ khÃ´ng? CÃ¢u tráº£ lá»i lÃ  cÃ³ Ä‘áº¥y! Náº¿u báº¡n khÃ´ng khai bÃ¡o tá»« khÃ³a nÃ y thÃ¬ káº¿t quáº£ báº¡n nháº­n Ä‘Æ°á»£c sáº½ lÃ  má»™t Promise chá»© khÃ´ng pháº£i lÃ  káº¿t quáº£ thá»±c thi cá»§a xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ nhÃ©. 123456789async function now() &#123; return Date.now()&#125;async function main() &#123; let t = now() console.log(t) // ??? `t` is a `Promise` instance&#125; Khai bÃ¡o â€œthá»«aâ€ trÆ°á»›c má»™t xá»­ lÃ½ Ä‘á»“ng bá»™ Náº¿u mÃ  sá»£ quÃªn thÃ¬ cá»© khai bÃ¡o bá»«a Ä‘i, Ä‘Ã¢u cÃ³ sao? á»ª khÃ´ng sao Ä‘Ã¢u ngoáº¡i trá»« 2 váº¥n Ä‘á» lÃ  khÃ´ng biáº¿t cÃ¡i nÃ o lÃ  Ä‘á»“ng bá»™, cÃ¡i nÃ o lÃ  báº¥t Ä‘á»“ng bá»™ ná»¯a, vÃ  hiá»‡u quáº£ Ä‘i xuá»‘ng Ä‘áº¥y. Má»—i khi báº¡n khai bÃ¡o await thÃ¬ máº·c nhiÃªn sau tá»« khÃ³a Ä‘Ã³ lÃ  má»™t Promise, náº¿u khÃ´ng pháº£i lÃ  má»™t Promise thÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c gÃ³i láº¡i vÃ o Promise vÃ  Ä‘Æ°á»£c tráº£ ra ngay vá»›i phÆ°Æ¡ng thá»©c Promise.resolve(value). Ráº£nh quÃ¡ ha, muá»‘n láº¥y 1 + 0 = 1 mÃ  pháº£i Ä‘i Ä‘Æ°á»ng vÃ²ng lÃ  tÃ­nh tá»•ng, rá»“i nhÃ©t vÃ o Promise, rá»“i láº¡i moi ra Ä‘á»ƒ sá»­ dá»¥ng. 12345678910111213141516171819async function main() &#123; // run with await console.log('run with await') let i = 1000000 console.time('await') while(i-- &gt; 0) &#123; let t = await (1 + 0) &#125; console.timeEnd('await') // run without await console.log('run without await') i = 1000000 console.time('normal') while(i-- &gt; 0) &#123; let t = 1 + 0 &#125; console.timeEnd('normal')&#125; 3.3. QuÃªn xá»­ lÃ½ lá»—iCÅ©ng nhÆ° vá»›i viá»‡c quÃªn catch lá»—i khi sá»­ dá»¥ng Promise, viá»‡c quÃªn try catch Ä‘á»ƒ báº¯t lá»—i vá»›i hÃ m async cÅ©ng cÃ³ thá»ƒ xáº£y ra. Náº¿u báº¡n quÃªn khÃ´ng báº¯t lá»—i, thÃ¬ khi Ä‘oáº¡n mÃ£ báº¥t Ä‘á»“ng cá»§a báº¡n xáº£y ra lá»—i cÃ³ thá»ƒ lÃ m chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n bá»‹ dá»«ng láº¡i. 1234567891011121314function wait(ms) &#123; if (ms &gt; 2015) throw new Error(ms) return new Promise(r =&gt; setTimeout(r, ms))&#125;async function main() &#123; console.log('sáº¯p rá»“i...') await wait(2007) console.log('chá» tÃ­...') await wait(2012) console.log('thÃªm chÃºt ná»¯a thÃ´i...') await wait(2016) console.log('xong rá»“i Ä‘áº¥y!')&#125; 3.4. Máº¥t tÃ­nh song songCÃ¡i nÃ y cÃ³ váº» lÃ  cÄƒng nháº¥t, báº¡n cá»© khai bÃ¡o await tuáº§n tá»± Ä‘i rá»“i chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n sáº½ cháº­m nhÆ° con rÃ¹a. hahaaa. VÃ¬ má»—i láº§n khai bÃ¡o await nhÆ° váº­y lÃ  báº¡n cáº§n pháº£i chá» cho xá»­ lÃ½ cá»§a await káº¿t thÃºc. Káº¿t quáº£ lÃ  báº¡n cÃ³ 1 con rÃ¹a cháº¡y tuáº§n tá»± qua tá»«ng náº¥c thang. 12345678910function wait(ms) &#123; return new Promise(r =&gt; setTimeout(r, ms))&#125;async function main() &#123; console.time('wait3s') await wait(1000) await wait(2000) console.timeEnd('wait3s')&#125; Vá»›i Ä‘oáº¡n mÃ£ trÃªn báº¡n sáº½ máº¥t tá»•ng cá»™ng lÃ  1 + 2 = 3s Ä‘á»ƒ thá»±c thi. VÃ¬ báº¡n pháº£i chá» tá»«ng hÃ m wait má»™t. Váº­y lÃ m sao Ä‘á»ƒ trÃ¡nh Ä‘Æ°á»£c tÃ¬nh tráº¡ng trÃªn? CÃ¢u tráº£ lá»i lÃ  cá»© cho xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ cháº¡y trÆ°á»›c Ä‘i rá»“i láº¥y káº¿t quáº£ sau. VÃ¬ Promise cÃ³ thá»ƒ cho phÃ©p ta láº¥y káº¿t quáº£ báº¥t cá»© khi nÃ o mÃ  nÃ³ á»Ÿ tráº¡ng thÃ¡i cuá»‘i cÃ¹ng, nÃªn ta cÃ³ thá»ƒ cháº¡y nÃ³ trÆ°á»›c rá»“i láº¥y sau cÅ©ng khÃ´ng sao cáº£. 123456789101112function wait(ms) &#123; return new Promise(r =&gt; setTimeout(r, ms))&#125;async function main() &#123; console.time('wait2s') let w1 = wait(1000) let w2 = wait(2000) await w1 await w2 console.timeEnd('wait2s')&#125; NhÆ° Ä‘oáº¡n mÃ£ nÃ y, ta chá»‰ máº¥t 2s Ä‘á»ƒ thá»±c hiá»‡n vÃ¬ Ä‘oáº¡n wait cá»§a ta Ä‘Æ°á»£c thá»±c thi song song. NgoÃ i cÃ¡ch await tá»«ng Promise nhÆ° trÃªn ta cÃ³ thá»ƒ sá»­ dá»¥ng Promise.all Ä‘á»ƒ song song hÃ³a cÃ¡c Promise. 123456789function wait(ms) &#123; return new Promise(r =&gt; setTimeout(r, ms))&#125;async function main() &#123; console.time('wait2s') await Promise.all([wait(1000), wait(2000)]) console.timeEnd('wait2s')&#125; LÃºc nÃ y, cÃ³ thá»ƒ báº¡n Ä‘ang nghÄ© Promise.all vÃ  await tá»«ng Promise lÃ  nhÆ° nhau, nhÆ°ng nÃ³ khÃ¡c nhau chÃºt Ä‘áº¥y. Promise.all chá»‰ á»Ÿ tráº¡ng thÃ¡i thÃ nh cÃ´ng khi mÃ  táº¥t cáº£ cÃ¡c Promise Ä‘Æ°á»£c truyá»n vÃ o xá»­ lÃ½ thÃ nh cÃ´ng, cÃ²n nÃ³ sáº½ á»Ÿ tráº¡ng thÃ¡i lá»—i khi má»™t trong cÃ¡c Promise truyá»n vÃ o bá»‹ lá»—i. NhÆ° váº­y, náº¿u báº¡n muá»‘n bá» qua cÃ¡c Promise lá»—i thÃ¬ báº¡n khÃ´ng thá»ƒ sá»­ dá»¥ng Promise.all Ä‘Æ°á»£c Ä‘Ã¢u. LÃºc Ä‘Ã³ báº¯t buá»™c báº¡n pháº£i sá»­ dá»¥ng await kÃ¨m vá»›i try catch cho tá»«ng Promise cá»§a báº¡n. 12345678910111213141516171819202122232425function wait(ms) &#123; if (ms &gt; 2000) throw new Error(ms) return new Promise(r =&gt; setTimeout(r, ms))&#125;async function main() &#123; const dur = [1000, 2000, 3000, 4000] let all = dur.map(ms =&gt; wait(ms)) try &#123; await Promise.all(all) console.log('Promise.all - done') &#125; catch (e) &#123; console.error('Promise.all:', e) &#125; let each = dur.map(ms =&gt; wait(ms)) each.forEach(async (func, index) =&gt; &#123; try &#123; await func console.log('each - done:', dur[index]) &#125; catch (e) &#123; console.error('each:', e) &#125; &#125;)&#125; 4. Ná»n táº£ng/ trÃ¬nh duyá»‡t há»— trá»£ Thá»i Ä‘iá»ƒm nÃ y (2016/10), cÃ¡c ná»n táº£ng vÃ  trÃ¬nh duyá»‡t sau Ä‘Ã£ há»— trá»£ hÃ m async. Node.js v7.0 vá»›i cá» --harmony-async-await Chrome v5.55 Microsoft Edge v21.10547 Náº¿u báº¡n muá»‘n cháº¡y á»Ÿ cÃ¡c ná»n táº£ng/ trÃ¬nh duyá»‡t chÆ°a há»— trá»£ thÃ¬ cÃ³ thá»ƒ dÃ¹ng babel Ä‘á»ƒ chuyá»ƒn Ä‘á»•i: Babel async-2-generator plugin 5. Káº¿t luáº­n Báº£n cháº¥t cá»§a hÃ m async chÃ­nh lÃ  Promise, vÃ¬ váº­y Ä‘á»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c nÃ³ ta cáº§n pháº£i sá»­ dá»¥ng Promise cho viá»‡c xá»­ lÃ½ cÃ¡c thao tÃ¡c báº¥t Ä‘á»“ng bá»™. Báº¡n khÃ´ng thá»ƒ nÃ o sÃ i await Ä‘á»ƒ Ä‘á»£i cÃ¡c hÃ m cÃ³ sá»­ dá»¥ng hÃ m pháº£n há»“i (callback) Ä‘Æ°á»£c, mÃ  báº¯t buá»™c pháº£i gáº¯n nÃ³ vá»›i má»™t Promise trÆ°á»›c khi sá»­ dá»¥ng await. Máº·c dÃ¹ hÃ m async cÃ³ cÃº phÃ¡p ráº¥t rÃµ rÃ ng, ta cÅ©ng cáº§n pháº£i lÆ°u Ã½ trÃ¡nh khai bÃ¡o thá»«a thiáº¿u cÃ¡c tá»« khÃ³a gÃ¢y lá»—i, gÃ¢y hiá»ƒu láº§m vá» lÃ´-gÃ­c chÆ°Æ¡ng trÃ¬nh. VÃ  Ä‘áº·c biá»‡t lÆ°u Ã½ tá»›i kháº£ nÄƒng lÃ m máº¥t Ä‘i tÃ­nh song song cá»§a chÆ°Æ¡ng trÃ¬nh. Vá»›i sá»± tiá»‡n dá»¥ng cá»§a hÃ m async, ta nÃªn cá»‘ gáº¯ng sá»­ dá»¥ng nÃ³ ngay tá»« bÃ¢y giá» Ä‘á»ƒ giáº£m thiá»ƒu viá»‡c báº£o trÃ¬ sau nÃ y. Vá»›i cÃ¡c ná»n táº£ng/ trÃ¬nh duyá»‡t chÆ°a há»— trá»£ thÃ¬ ta cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i báº±ng babel. Hiá»‡n táº¡i Node v7 váº«n Ä‘ang sá»­ dá»¥ng Chrome v5.54 nÃªn muá»‘n sá»­ dá»¥ng Ä‘Æ°á»£c async/await, ta buá»™c pháº£i cháº¡y vá»›i cá» --harmony-async-await vÃ  hiá»‡u nÄƒng, bá»™ nhá»› Ä‘Æ°á»£c sá»­ dá»¥ng váº«n chÆ°a hiá»‡u quáº£, khÃ´ng khuyáº¿n khÃ­ch cho cÃ¡c sáº£n pháº©m thá»±c táº¿. Tuy nhiÃªn, ráº¥t cÃ³ thá»ƒ Node v8 sáº½ sá»­ dá»¥ng phiÃªn báº£n Chrome v5.55 vÃ  cho phÃ©p ta thá»±c hiá»‡n máº·c Ä‘á»‹nh cÃ¡c hÃ m async. async chÃºc cÃ¡c báº¡n await vui váº»!","categories":[{"name":"Javascript","slug":"Javascript","permalink":"http://nthung2112.github.io/categories/Javascript/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"async","slug":"async","permalink":"http://nthung2112.github.io/tags/async/"},{"name":"await","slug":"await","permalink":"http://nthung2112.github.io/tags/await/"}]},{"title":"Báº¥t ngá» vá» máº£ng trong javascript","slug":"Javascript-Bat-ngo-ve-mang-trong-javascript","date":"2017-01-10T13:02:14.000Z","updated":"2017-08-20T14:51:37.207Z","comments":true,"path":"2017/01/Javascript-Bat-ngo-ve-mang-trong-javascript.html","link":"","permalink":"http://nthung2112.github.io/2017/01/Javascript-Bat-ngo-ve-mang-trong-javascript.html","excerpt":"Tá»«ng lÃ m viá»‡c vá»›i má»™t vÃ i ngÃ´n ngá»¯ láº­p trÃ¬nh (Java, C, C++, C#, Objective-C, PHP), má»—i ngÃ´n ngá»¯ Ä‘á»u cÃ³ cÃ¡i hay riÃªng. NhÆ°ng khi tiáº¿p xÃºc vá»›i JavaScript (JS) láº¡i tá»± dÆ°ng tháº¥y yÃªu nÃ³, yÃªu cÃ¡i váº» sexy vÃ  báº¥t ngá» cá»§a nÃ³. VÃ­ nhÆ° máº£ng trong JS ráº¥t Ä‘áº·c biá»‡t vÃ  báº¥t ngá». Trong bÃ i nÃ y sáº½ viáº¿t láº¡i má»™t sá»‘ Ä‘iá»ƒm cÃ³ thá»ƒ lÃ  báº¥t ngá» vá»›i má»™t sá»‘ ngÆ°á»i nhÆ° mÃ¬nh. 1. Báº¡n láº¥y Ä‘á»™ dÃ i cá»§a máº£ng tháº¿ nÃ o?HÃ´m qua ngá»“i code lÃºc láº¥y Ä‘á»™ dÃ i máº£ng báº±ng thuá»™c tÃ­nh length má»›i tháº¥y khÃ¡c biá»‡t vá»›i pháº§n tá»­ láº¥y Ä‘Æ°á»£c, lÃ m mÃ¬nh hÆ¡i ngáº¡c nhiÃªn má»™t chÃºt. Ngá»“i Ä‘á»c láº¡i tÃ i liá»‡u JS, má»›i tháº¥y dÆ°á»ng nhÆ° nÃ³ khÃ´ng cÃ³ thuá»™c tÃ­nh lÆ°u trá»¯ sá»‘ lÆ°á»£ng pháº§n tá»­ hiá»‡n há»¯u (khÃ¡c undefined) trong nÃ³ thÃ¬ pháº£i? Hoáº·c Ã­t nháº¥t lÃ  mÃ¬nh chÆ°a rÃµ. CÃ³ cao thá»§ nÃ o chá»‰ giÃ¡o cho thÃ¬ tá»‘t. CÃ¡c báº¡n cÃ³ thá»ƒ thá»­ Ä‘oáº¡n mÃ£ sau thÃ¬ sáº½ tháº¥y ráº±ng thuá»™c tÃ­nh length cá»§a máº£ng sáº½ báº±ng tá»•ng cá»§a index lá»›n nháº¥t cá»§a máº£ng vá»›i 1. 12345var arr = []arr[10] = 0arr[20] = 'index 20'arr['js'] = 'JavaScript'console.log(arr.length)","text":"Tá»«ng lÃ m viá»‡c vá»›i má»™t vÃ i ngÃ´n ngá»¯ láº­p trÃ¬nh (Java, C, C++, C#, Objective-C, PHP), má»—i ngÃ´n ngá»¯ Ä‘á»u cÃ³ cÃ¡i hay riÃªng. NhÆ°ng khi tiáº¿p xÃºc vá»›i JavaScript (JS) láº¡i tá»± dÆ°ng tháº¥y yÃªu nÃ³, yÃªu cÃ¡i váº» sexy vÃ  báº¥t ngá» cá»§a nÃ³. VÃ­ nhÆ° máº£ng trong JS ráº¥t Ä‘áº·c biá»‡t vÃ  báº¥t ngá». Trong bÃ i nÃ y sáº½ viáº¿t láº¡i má»™t sá»‘ Ä‘iá»ƒm cÃ³ thá»ƒ lÃ  báº¥t ngá» vá»›i má»™t sá»‘ ngÆ°á»i nhÆ° mÃ¬nh. 1. Báº¡n láº¥y Ä‘á»™ dÃ i cá»§a máº£ng tháº¿ nÃ o?HÃ´m qua ngá»“i code lÃºc láº¥y Ä‘á»™ dÃ i máº£ng báº±ng thuá»™c tÃ­nh length má»›i tháº¥y khÃ¡c biá»‡t vá»›i pháº§n tá»­ láº¥y Ä‘Æ°á»£c, lÃ m mÃ¬nh hÆ¡i ngáº¡c nhiÃªn má»™t chÃºt. Ngá»“i Ä‘á»c láº¡i tÃ i liá»‡u JS, má»›i tháº¥y dÆ°á»ng nhÆ° nÃ³ khÃ´ng cÃ³ thuá»™c tÃ­nh lÆ°u trá»¯ sá»‘ lÆ°á»£ng pháº§n tá»­ hiá»‡n há»¯u (khÃ¡c undefined) trong nÃ³ thÃ¬ pháº£i? Hoáº·c Ã­t nháº¥t lÃ  mÃ¬nh chÆ°a rÃµ. CÃ³ cao thá»§ nÃ o chá»‰ giÃ¡o cho thÃ¬ tá»‘t. CÃ¡c báº¡n cÃ³ thá»ƒ thá»­ Ä‘oáº¡n mÃ£ sau thÃ¬ sáº½ tháº¥y ráº±ng thuá»™c tÃ­nh length cá»§a máº£ng sáº½ báº±ng tá»•ng cá»§a index lá»›n nháº¥t cá»§a máº£ng vá»›i 1. 12345var arr = []arr[10] = 0arr[20] = 'index 20'arr['js'] = 'JavaScript'console.log(arr.length) Äoáº¡n mÃ£ trÃªn sáº½ in ra Ä‘á»™ dÃ i cá»§a máº£ng arr lÃ  21, tá»©c lÃ  báº±ng index lá»›n nháº¥t (20) cá»™ng vá»›i 1. HÆ¡i báº¥t ngá» chÃºt vÃ¬ lÃºc Ä‘áº§u mÃ¬nh nghÄ© nÃ³ tráº£ ra lÃ  3 (sá»‘ pháº§n tá»­ khÃ¡c undefined) . CÃ²n index khÃ´ng pháº£i lÃ  dáº¡ng sá»‘ tá»± nhiÃªn thÃ¬ cÃ³ Ã½ nghÄ©a gÃ¬ khÃ´ng? CÃ¢u tráº£ lá»i lÃ  khÃ´ng cÃ³ Ã½ nghÄ©a gÃ¬ vá»›i thuá»™c tÃ­nh length cáº£. CÃ¡c báº¡n cÃ³ thá»ƒ xem trong vÃ­ dá»¥ sau thÃ¬ sáº½ tháº¥y Ä‘á»™ dÃ i length sáº½ khÃ´ng phá»¥ thuá»™c vÃ o cÃ¡c index khÃ´ng thuá»™c dáº¡ng sá»‘ tá»± nhiÃªn. 12345var arr = []arr[-1] = 100arr['js'] = 'JavaScript'arr['me'] = 'Java Lover'console.log(arr.length) Äoáº¡n mÃ£ nÃ y sáº½ luÃ´n in ra 0, chá»©ng tá» cÃ¡c index khÃ´ng sá»‘ tá»± nhiÃªn khÃ´ng áº£nh hÆ°á»Ÿng gÃ¬ tá»›i thuá»™c tÃ­nh length. Váº­y cÃ¢u há»i Ä‘áº·t ra lÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ láº¥y Ä‘Æ°á»£c sá»‘ pháº§n tá»­ chÃ­nh xÃ¡c cá»§a má»™t máº£ng? Má»™t cÃ¡ch lÃ m Ä‘Æ¡n giáº£n lÃ  duyá»‡t máº£ng Ä‘á»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng cÃ¡c pháº§n tá»­ hiá»‡n há»¯u cá»§a máº£ng Ä‘Ãºng khÃ´ng? Tháº¿ nhÆ°ng má»i chuyá»‡n láº¡i khÃ´ng Ä‘Æ¡n giáº£n nhÆ° ta nghÄ©. 2. Báº¡n duyá»‡t máº£ng tháº¿ nÃ o?Duyá»‡t máº£ng trong JS cÅ©ng ráº¥t thÃº vá»‹. CÃ¡ch duyá»‡t máº£ng thÃ´ng thÆ°á»ng vá»›i má»™t máº£ng lÃ  láº¥y length cá»§a nÃ³ rá»“i duyá»‡t tá»« Ä‘áº§u tá»›i cuá»‘i nhÆ° sau. 1234567891011121314151617var arr = []arr[10] = 0arr[20] = 'index 20'arr['me'] = 'Java Lover'var counter = 0for (var i = 0, len = arr.length; i &lt; len; i ++) &#123; console.log(i + \": \" + arr[i]) if (typeof(arr[i]) != 'undefined') counter ++&#125;// hoáº·c nhÆ° saufor (var i = arr.length; i &gt; 0; -- i) &#123; console.log(i + \": \" + arr[i]) if (typeof(arr[i]) != 'undefined') counter ++&#125;console.log('The size of array: %d', counter) Káº¿t quáº£ Ä‘oáº¡n mÃ£ trÃªn sáº½ tráº£ ra cÃ¡c pháº§n tá»« cÃ³ index tá»« 0 ~ 9 vÃ  11 ~ 19 lÃ  undefined, vÃ  counter sáº½ lÃ  2.NhÆ° váº­y lÃ  counter khÃ´ng cho ra káº¿t quáº£ chÃ­nh xÃ¡c vÃ  vá»›i má»™t máº£ng lá»›n (1000 pháº§n tá»­ cháº³ng háº¡n) ta khÃ´ng thá»ƒ duyá»‡t theo cÃ¡ch nÃ y Ä‘Æ°á»£c. Váº­y pháº£i cÃ³ cÃ¡ch khÃ¡c, ta thá»­ dÃ¹ng hÃ m forEach cá»§a Array xem sao. 12345678910var arr = []arr[10] = 0arr[20] = 'index 20'arr['me'] = 'XXX Lover'var counter = 0arr.forEach(function(ele, i, array) &#123; console.log(i + \": \" + ele) counter ++&#125;)console.log('The size of array: %d', counter) CÃ¡ch nÃ y váº«n khÃ´ng Äƒn thua, káº¿t quáº£ láº¡i nhÆ° duyá»‡t theo biáº¿n length. ThÃªm má»™t cÃ¡ch duyá»‡t khÃ¡c lÃ  vá»›i lá»‡nh for in nhÆ° sau. 12345678910var arr = []arr[10] = 0arr[20] = 'index 20'arr['me'] = 'Java Lover'var counter = 0for (var i in arr) &#123; console.log(i + \": \" + arr[i]) counter ++&#125;console.log('The size of array: %d', counter) Äoáº¡n nÃ y láº¡i cho ra káº¿t quáº£ chÃ­nh xÃ¡c vá»›i tá»«ng pháº§n tá»­ Ä‘Æ°á»£c in ra vÃ  kÃ­ch cá»¡ máº£ng tráº£ vá» lÃ  3. Tá»« Ä‘Ã¢y ta cÃ³ thá»ƒ tháº¥y má»™t Ä‘iá»u lÃ  nÃªn cáº©n tháº­n vá»›i biáº¿n length cá»§a máº£ng vÃ  nÃªn chÃº Ã½ cÃ¡ch duyá»‡t máº£ng sao cho há»£p lÃ½. Vá»›i cÃ¡c dá»¯ liá»‡u liÃªn tá»¥c ta hoÃ n toÃ n cÃ³ thá»ƒ duyá»‡t theo biáº¿n length hay Array.forEach, nhÆ°ng dá»¯ liá»‡u cÃ¡ch Ä‘oáº¡n vÃ  index khÃ´ng lÃ  sá»‘ tá»± nhiÃªn thÃ¬ cáº§n theo cÃ¡ch duyá»‡t for in. 3. LÃ m sao Ä‘á»ƒ biáº¿t má»™t biáº¿n lÃ  máº£ng?CÃ¡c báº¡n thá»­ cháº¡y Ä‘oáº¡n mÃ£ sau xem tháº¿ nÃ o. 12345678var arr = []arr[10] = 0arr[20] = 'index 20'arr['me'] = 'JavaScript Lover'console.log(\"Trust me, men, I'm an Array @@\")console.log(\"Really, I have to check your DNA.\")console.log(\"JavaScript checker: arr is \" + typeof(arr)) ??? MÃ y lÃ  Object mÃ  sao láº¡i báº£o lÃ  Array?KhÃ´ng chÃ¡u lÃ  máº£ng mÃ , bÃ¡c thá»­ kiá»ƒm tra vá»›i cÃ¡i mÃ¡y nÃ y xem. 1234567var arr = []arr[10] = 0arr[20] = 'index 20'arr['me'] = 'JavaScript Lover'console.log(\"JavaScript checker: Is arr an array ... \" + (Object.prototype.toString.apply(arr) === \"[object Array]\")) á»’, á»“ khá»‰ tháº­t sao láº¡i tháº¿ nhá»‰? Äáº¥y chÃ¡u dÃ²ng giá»‘ng hoÃ ng tá»™c nÃªn pháº£i áº©n mÃ¬nh tháº¿ Ä‘áº¥y. ÄÃºng lÃ  nhÃ¬n gÃ¡i xinh thÃ¬ dá»… chá»© nhÃ¬n gÃ¡i tá»‘t hay xáº¥u pháº£i cÃ³ máº¹o tháº­t. Äá»ƒ káº¿t thÃºc bÃ i, dÃ nh táº·ng cho cÃ¡c báº¡n beginner vá» NodeJS má»™t Ä‘oáº¡n mÃ£ nhá». BÃ i toÃ¡n Ä‘áº·t ra lÃ  láº¥y ná»™i dung 3 trang web (giao thá»©c http) vá»›i Ä‘á»‹a chá»‰ nháº­p tá»« bÃ n phÃ­m theo dáº¡ng báº¥t Ä‘á»“ng bá»™ vÃ  in ra ná»™i dung cÃ¡c trang Ä‘Ã³ theo Ä‘Ãºng thá»© tá»± Ä‘áº§u vÃ o nháº­p tá»« bÃ n phÃ­m.Cháº¯c code nÃ y khÃ´ng pháº£i giáº£i thÃ­ch nhiá»u cÃ¡c báº¡n cÅ©ng sáº½ tháº¥y cÃ³ má»‘i tÆ°Æ¡ng quan vá»›i ná»™i dung mÃ¬nh vá»«a viáº¿t phÃ­a trÃªn.1234567891011121314151617181920212223242526var http = require('http')var bl = require('bl')var data = []var counter = 0function printData() &#123; for (var i = 0; i&lt; 3; i++) console.log(data[i])&#125;function loadData(index) &#123; http.get(process.argv[2 + index], function(resp) &#123; resp.pipe(bl(function(err, buf) &#123; if (err) data[index] = err.toString() else data[index] = buf.toString() counter ++ if (counter === 3) printData() &#125;)) &#125;)&#125;for (var i = 0; i &lt; 3; i++) loadData(i) BÃ i nÃ y táº¡m thá»i tháº¿, khi nÃ o gáº·p váº¥n Ä‘á» láº¡i update tiáº¿p. Mong cÃ¡c cao thá»§ biáº¿t Ä‘Æ°á»£c gÃ¬ thÃªm vá» máº£ng trong JavaScript thÃ¬ chá»‰ giÃ¡o cho cÃ¡c háº¡.","categories":[{"name":"Javascript","slug":"Javascript","permalink":"http://nthung2112.github.io/categories/Javascript/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"array","slug":"array","permalink":"http://nthung2112.github.io/tags/array/"}]},{"title":"TÃ¬m hiá»ƒu vá» call, apply vÃ  bind","slug":"Javascript-Tim-hieu-ve-call-apply-va-bind","date":"2017-01-10T12:57:42.000Z","updated":"2017-08-20T14:51:23.254Z","comments":true,"path":"2017/01/Javascript-Tim-hieu-ve-call-apply-va-bind.html","link":"","permalink":"http://nthung2112.github.io/2017/01/Javascript-Tim-hieu-ve-call-apply-va-bind.html","excerpt":"NhÆ° trong bÃ i vá» tá»« khÃ³a this Ä‘Ã£ Ä‘á» cáº­p tá»›i ngá»¯ cáº£nh thá»±c thi vá»›i má»‘i tÆ°Æ¡ng quan tá»›i tá»« khÃ³a this vÃ  viá»‡c thay Ä‘á»•i Ä‘Æ°á»£c ngá»¯ cáº£nh thá»±c thi má»™t cÃ¡ch trá»±c tiáº¿p báº±ng cÃ¡ch sá»­ dá»¥ng call, apply vÃ  bind, thÃ¬ bÃ i viáº¿t nÃ y sáº½ lÃ m rÃµ rÃ ng hÆ¡n 3 phÆ°Æ¡ng thá»©c nÃ y vÃ  sá»± khÃ¡c nhau cÅ©ng nhÆ° tÃ­nh há»¯u dá»¥ng cá»§a nÃ³. Vá» cÆ¡ báº£n call vÃ  apply gáº§n giá»‘ng nhau vÃ  Ä‘Æ°á»£c giá»›i thiá»‡u tá»« phiÃªn báº£n 3 theo chuáº©n ECMAScript, cÃ²n bind Ä‘Æ°á»£c giá»›i thiá»‡u tá»« phiÃªn báº£n 5 thÃ¬ láº¡i khÃ¡c háº³n vá» báº£n cháº¥t nhÆ°ng cÅ©ng cÃ³ má»‘i quan há»‡ máº­t thiáº¿t vá»›i 2 phÆ°Æ¡ng thá»©c kia. Váº­y nÃªn trong bÃ i nÃ y ta sáº½ Ä‘i dáº§n tá»« call vá»›i apply tá»›i bind.","text":"NhÆ° trong bÃ i vá» tá»« khÃ³a this Ä‘Ã£ Ä‘á» cáº­p tá»›i ngá»¯ cáº£nh thá»±c thi vá»›i má»‘i tÆ°Æ¡ng quan tá»›i tá»« khÃ³a this vÃ  viá»‡c thay Ä‘á»•i Ä‘Æ°á»£c ngá»¯ cáº£nh thá»±c thi má»™t cÃ¡ch trá»±c tiáº¿p báº±ng cÃ¡ch sá»­ dá»¥ng call, apply vÃ  bind, thÃ¬ bÃ i viáº¿t nÃ y sáº½ lÃ m rÃµ rÃ ng hÆ¡n 3 phÆ°Æ¡ng thá»©c nÃ y vÃ  sá»± khÃ¡c nhau cÅ©ng nhÆ° tÃ­nh há»¯u dá»¥ng cá»§a nÃ³. Vá» cÆ¡ báº£n call vÃ  apply gáº§n giá»‘ng nhau vÃ  Ä‘Æ°á»£c giá»›i thiá»‡u tá»« phiÃªn báº£n 3 theo chuáº©n ECMAScript, cÃ²n bind Ä‘Æ°á»£c giá»›i thiá»‡u tá»« phiÃªn báº£n 5 thÃ¬ láº¡i khÃ¡c háº³n vá» báº£n cháº¥t nhÆ°ng cÅ©ng cÃ³ má»‘i quan há»‡ máº­t thiáº¿t vá»›i 2 phÆ°Æ¡ng thá»©c kia. Váº­y nÃªn trong bÃ i nÃ y ta sáº½ Ä‘i dáº§n tá»« call vá»›i apply tá»›i bind. 1. Call vÃ  ApplyCÃº phÃ¡p: call() Function.prototype.call(thisArg[, arg1[ , arg2, â€¦]]) apply() Function.prototype.apply(thisArg, argArray) PhÆ°Æ¡ng thá»©c call() vÃ  apply() Ä‘á»ƒ gá»i thá»±c thi má»™t hÃ m vá»›i má»™t ngá»¯ cáº£nh chá»‰ Ä‘á»‹nh thÃ´ng qua tham sá»‘ thisArg vÃ  cÃ¡c tham sá»‘ Ä‘áº§u vÃ o cá»§a hÃ m tÆ°Æ¡ng á»©ng. Tá»©c lÃ  nÃ³ sáº½ cho phÃ©p hÃ m thá»±c thi Ä‘Æ°á»£c vá»›i má»™t ngá»¯ cáº£nh chá»‰ Ä‘á»‹nh nÃ o Ä‘Ã³ tuá»³ Ã½. Sá»± khÃ¡c nhau giá»¯a chÃºng lÃ  call() sáº½ nháº­n tham sá»‘ hÃ m qua tá»«ng biáº¿n Ä‘áº§u vÃ o riÃªng biá»‡t cÃ²n apply() thÃ¬ láº¡i nháº­n cÃ¡c tham sá»‘ hÃ m qua má»™t máº£ng chá»©a cÃ¡c biáº¿n Ä‘áº§u vÃ o. Ta cÃ¹ng xÃ©t vÃ­ dá»¥ bÃªn dÆ°á»›i: 12345678910111213141516171819202122232425var obj = &#123; firstName: \"VÃ´\", lastName : \"Danh\", mMethod: function(firstName, lastName) &#123; var firstName = firstName || this.firstName var lastName = lastName || this.lastName console.log(\"Hello \" + firstName + \" \" + lastName) &#125;&#125; var obj1 = &#123; firstName: \"Ã”ng\", lastName : \"KÃ©\"&#125;;obj.mMethod() // Hello VÃ´ Danhobj.mMethod.call(obj1) // Hello Ã”ng KÃ©obj.mMethod.apply(obj1) // Hello Ã”ng KÃ© obj.mMethod.call(obj1, \"Thá»‹\", \"Ná»Ÿ\") // Hello Thá»‹ Ná»Ÿobj.mMethod.apply(obj1, [\"ChÃ­\", \"PhÃ¨o\"]) // Hello ChÃ­ PhÃ¨o Vá»›i Ä‘oáº¡n mÃ£ trÃªn ta cÃ³ thá»ƒ tháº¥y ráº±ng, sau khi gá»i call() hoáº·c apply() ngá»¯ cáº£nh thá»±c thi cá»§a mMethod Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»•i sang obj1 vÃ  call() cho phÃ©p ta truyá»n tham sá»‘ Ä‘áº§u vÃ o riÃªng biá»‡t cÃ²n apply() láº¡i cho phÃ©p truyá»n vÃ o nhÆ° má»™t máº£ng. Tá»« phiÃªn báº£n 5, apply() cÃ²n cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n vÃ o má»™t Ä‘á»‘i tÆ°á»£ng tá»±a máº£ng (chÃº thÃ­ch [1]) thay vÃ¬ máº£ng: 12345678910111213141516171819var obj = &#123; firstName: \"VÃ´\", lastName : \"Danh\", mMethod: function(firstName, lastName) &#123; var firstName = firstName || this.firstName var lastName = lastName || this.lastName console.log(\"Hello \" + firstName + \" \" + lastName) &#125;&#125; var obj1 = &#123; firstName: \"Ã”ng\", lastName : \"KÃ©\"&#125;;obj.mMethod.apply(obj1, [\"ChÃ­\", \"PhÃ¨o\"]) // Hello ChÃ­ PhÃ¨oobj.mMethod.apply(obj1, &#123;'length': 2, '0': \"ChÃ­\", '1': \"PhÃ¨o\"&#125;) // Hello ChÃ­ PhÃ¨o Vá»›i viá»‡c sá»­ dá»¥ng call() hoáº·c apply() ta cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c ráº¥t nhiá»u viá»‡c hay ho nhÆ° sá»­ dá»¥ng phÆ°Æ¡ng thá»©c cá»§a má»™t ngá»¯ cáº£nh khÃ¡c nhÆ° á»Ÿ vÃ­ dá»¥ trÃªn, hay Ä‘áº©y ngá»¯ cáº£nh thá»±c thi cho hÃ m pháº£n há»“i hoáº·c thay Ä‘á»•i cÃ¡ch truyá»n tham sá»‘ hÃ m ráº¥t hiá»ƒu quáº£. CÃ¡c báº¡n cÃ³ thá»ƒ xem á»Ÿ vÃ­ dá»¥ sau: Truyá»n ngá»¯ cáº£nh thá»±c thi cho hÃ m pháº£n há»“i 1234567891011121314function print() &#123; console.log(this.mVal)&#125;var obj = &#123; mVal: \"TÃ´i yÃªu thÃ nh phá»‘ Há»“ ChÃ­ Minh\", mMethod: function(callback) &#123; // truyá»n Ä‘á»‘i tÆ°á»£ng hiá»‡n táº¡i cho hÃ m pháº£n há»“i callback callback.call(this) &#125;&#125;obj.mMethod(print) Thay Ä‘á»•i cÃ¡ch truyá»n tham sá»‘ hÃ m123// Math.min([value1[,value2[, ...]]])// Ta sá»­ dá»¥ng máº£ng cho tham sá»‘ Ä‘áº§u vÃ o thay vÃ¬ cÃ¡c giÃ¡ trá»‹ rá»i ráº¡cconsole.log (Math.min.apply(null, [100, -1, 8, 219])) // -1 CÅ©ng khÃ´ng tá»“i Ä‘áº¥y chá»©, báº±ng call, apply ta cÃ³ thá»ƒ linh hoáº¡t hÆ¡n khi láº­p trÃ¬nh, Ä‘á»¡ Ä‘Æ°á»£c nhiá»u cÃ´ng sá»©c biáº¿n Ä‘á»•i ráº¯c rá»‘i vÃ  táº­n dá»¥ng Ä‘Æ°á»£c mÃ£ nguá»“n ráº¥t hiá»‡u quáº£. 2. BindCÃº phÃ¡p: Function.prototype.bind( thisArg[, arg1[ , arg2, â€¦]]) PhÆ°Æ¡ng thá»©c bind() sáº½ táº¡o ra má»™t hÃ m má»›i cÃ³ ná»™i dung thá»±c thi nhÆ° hÃ m Ä‘Æ°á»£c gá»i nhÆ°ng Ä‘Æ°á»£c gáº¯n vá»›i má»™t ngá»¯ cáº£nh thá»±c thi chá»‰ Ä‘á»‹nh qua tham sá»‘ thisArg. NhÆ° váº­y khÃ¡c vá»›i call() vÃ  apply(), bind() sáº½ khÃ´ng gá»i Ä‘á»ƒ thá»±c thi hÃ m mÃ  sáº½ lÆ°u láº¡i ngá»¯ cáº£nh thá»±c thi cho má»™t hÃ m nÃ o Ä‘Ã³ nhÆ° vÃ­ dá»¥ sau: 123456789101112131415var obj = &#123; mVal: \"Viá»‡t Nam\", mMethod: function() &#123; console.log(\"Hello \" + this.mVal) &#125;&#125; var oMethod = obj.mMethod.bind(obj) // this trong oMethod sáº½ bá»‹ Ã©p thÃ nh giÃ¡ trá»‹ objoMethod() // Hello Viá»‡t Namobj.mVal = \"HÃ  Ná»™i\" oMethod() // Hello HÃ  Ná»™i NhÆ° váº­y khÃ¡c vá»›i call() vÃ  apply(), khi gá»i bind() hÃ m sáº½ khÃ´ng thá»±c thi ngay mÃ  chá»‰ gáº¯n ngá»¯ cáº£nh thá»±c thi cho phÆ°Æ¡ng thá»©c mMethod. VÃ¬ mMethod Ä‘Æ°á»£c gáº¯n vá»›i ngá»¯ cáº£nh Ä‘á»‘i tÆ°á»£ng obj, nÃªn má»—i láº§n thá»±c thi nÃ³ sáº½ sá»­ dá»¥ng this nhÆ° lÃ  Ä‘á»‘i tÆ°á»£ng obj. NhÆ° trong vÃ­ dá»¥ phÃ­a trÃªn, sau khi ta thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n mVal trong Ä‘á»‘i tÆ°á»£ng obj thÃ¬ mMethod cÅ©ng sáº½ in ra giÃ¡ trá»‹ Ä‘Ã£ bá»‹ thay Ä‘á»•i. Vá» báº£n cháº¥t thÃ¬ bind() cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° sau:123456Function.prototype.bind = function(context) &#123; var _this = this; return function() &#123; _this.apply(context, arguments); &#125;;&#125;; Báº±ng viá»‡c sá»­ dá»¥ng apply(), ta cÃ³ thá»ƒ thay Ä‘á»•i ngá»¯ cáº£nh thá»±c thi cho má»™t hÃ m, cÃ²n Ä‘á»ƒ lÆ°u láº¡i ngá»¯ cáº£nh dÃ nh cho viá»‡c thá»±c thi sau nÃ y ta táº¡o ra má»™t hÃ m má»›i nhÆ° trong Ä‘oáº¡n mÃ£ trÃªn. VÃ¬ tÃ­nh cháº¥t lÆ°u láº¡i Ä‘Æ°á»£c ngá»¯ cáº£nh nÃªn bind() ráº¥t hay Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i hÃ m pháº£n há»“i nhÆ° xá»­ lÃ½ sá»± kiá»‡n click vÃ o má»™t nÃºt nÃ o Ä‘Ã³ cháº³ng háº¡n. VÃ­ dá»¥ nhÆ° khi sá»­ dá»¥ng jQuery, ta cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c giÃ¡ trá»‹ cho this báº±ng button trong cÃ¡c hÃ m pháº£n há»“i cá»§a sá»± kiá»‡n click vÃ o má»™t button vÃ¬ jQuery Ä‘á»u Ä‘Ã£ buá»™c (bind) sáºµn button cho hÃ m pháº£n há»“i Ä‘Æ°á»£c truyá»n vÃ o. 1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js\"&gt;&lt;/script&gt;&lt;script&gt;$(document).ready(function()&#123; $(\"#btn\").click(function()&#123; console.log(this) $(this).text(Number($(this).text()) + 1) &#125;);&#125;);&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;button id=\"btn\"&gt;0&lt;/button&gt;&lt;/body&gt;&lt;/html&gt; NgoÃ i ra, ta cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c ráº¥t nhiá»u viá»‡c khÃ¡ hay ho nhÆ° táº¡o shortcut cho hÃ m nÃ o Ä‘Ã³, hay nhÃ³m láº¡i cÃ¡c tham sá»‘ theo tá»«ng cá»¥m nhÆ° vÃ­ dá»¥ bÃªn dÆ°á»›i: 12345678910111213141516171819202122232425262728var obj = &#123; firstName: \"ThÃ¡nh\", lastName: \"GiÃ³ng\", mMethod: function(hello, firstName, lastName) &#123; var hello = hello || \"Hello\" ,firstName = firstName || this.firstName ,lastName = lastName || this.lastName console.log(hello + \" \" + firstName + \" \" + lastName); &#125;&#125;// táº¡o shortcutvar print = obj.mMethod.bind(obj)print()var print = obj.mMethod.bind(obj, \"Hello\", \"Mr\", \"Bean\")print()// NhÃ³m theo helloprint = obj.mMethod.bind(obj, \"Xin chÃ o báº¡n\")print()// NhÃ³m theo firstNameprint = obj.mMethod.bind(obj, \"KÃ­nh chÃ o ngÃ i\", \"Nguyá»…n\")print(\"TrÃ£i\")print(\"Xiá»ƒn\") 3. Vui váº» tÃ½NhÆ° bÃªn trÃªn Ä‘Ã£ phÃ¢n tÃ­ch, khi ta cáº§n thá»±c thi má»™t function cho má»™t ngá»¯ cáº£nh khÃ¡c, ta cáº§n sá»­ dá»¥ng call, apply hoáº·c bind, nhÆ°ng cÃ³ má»™t cÃ¡ch vÆ°á»£t máº·t Ä‘á»ƒ khÃ´ng cáº§n sá»­ dá»¥ng nÃ³. Báº¡n cÃ³ thá»ƒ xem vÃ­ dá»¥ sau: 123456789101112131415161718192021222324252627var obj = &#123; firstName: \"VÃ´\", lastName : \"Danh\", mMethod: function(firstName, lastName) &#123; var firstName = firstName || this.firstName var lastName = lastName || this.lastName console.log(\"Hello \" + firstName + \" \" + lastName) &#125;&#125; var obj1 = &#123; firstName: \"Ã”ng\", lastName : \"KÃ©\"&#125;;obj.mMethod.apply(obj1) // Hello Ã”ng KÃ©// vÆ°á»£t máº·t á»Ÿ Ä‘Ã¢yvar method = Function.call.bind(obj.mMethod)method(obj1) // Hello Ã”ng KÃ©// vÆ°á»£t máº·t trong prototype cá»§a objectmethod = Function.call.bind(Array.prototype.slice)console.log(method([100, 20, 40], 1)) // [20, 40] Vá»›i Ä‘oáº¡n mÃ£ trÃªn, ta cÃ³ tháº¿ tháº¥y ráº±ng khi gá»i method ta khÃ´ng cáº§n pháº£i gá»i call, apply hay bind ra ná»¯a mÃ  chá»‰ cáº§n Ä‘áº©y trá»±c tiáº¿p Ä‘á»‘i tÆ°á»£ng cáº§n gá»i vÃ  tham sá»‘ vÃ o lÃ  Ä‘á»§. KhÃ¡ hay ho Ä‘áº¥y chá»©? gá»i call, apply, bind mÃ£i cÅ©ng chÃ¡n, overcome má»™t tÃ½ tháº¥y nÃ³ tiá»‡n hÆ¡n háº³n. Ta cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c nhÆ° váº­y lÃ  vÃ¬ táº¥t cáº£ cÃ¡c function trong JavaScript Ä‘á»u káº¿ thá»«a tá»« Ä‘á»‘i tÆ°á»£ng Function.prototype, nÃªn hiá»ƒn nhiÃªn nÃ³ cÃ³ táº¥t cáº£ cÃ¡c function Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a tá»« Function.prototype nhÆ° call, apply hay bind. NhÆ° váº­y, ta hoÃ n toÃ n cÃ³ thá»ƒ gá»i Ä‘Æ°á»£c cÃ¡c phÆ°Æ¡ng thá»©c káº¿ thá»«a nÃ y tá»« má»™t function báº¥t kÃ¬. Vá»›i vÃ­ dá»¥ trÃªn, ta coi obj.mMethod lÃ  má»™t Ä‘á»‘i tÆ°á»£ng cáº§n gá»i tá»›i phÆ°Æ¡ng thá»©c call thÃ¬ ta hoÃ n toÃ n cÃ³ thá»ƒ táº¡o má»™t phÆ°Æ¡ng thá»©c method trá»±c tiáº¿p tá»« phÆ°Æ¡ng thá»©c call mÃ  Ä‘Ã£ Ä‘Æ°á»£c gáº¯n thisVal báº±ng obj.mMethod: Function.call.bind(obj.mMethod) hoáº·c Function.prototype.call.bind(obj.mMethod). Hay nÃ³i cÃ¡ch khÃ¡c, phÆ°Æ¡ng thá»©c method má»›i Ä‘Æ°á»£c táº¡o ra cÃ³ ná»™i dung giá»‘ng nhÆ° phÆ°Æ¡ng thá»©c call vÃ  Ä‘á»‘i tÆ°á»£ng chá»©a nÃ³ (gá»i nÃ³ - this) lÃ  Ä‘á»‘i tÆ°á»£ng obj.mMethod nÃªn method() ~ obj.mMethod.call(). 4. Káº¿t luáº­nBáº±ng viá»‡c sá»­ dá»¥ng call, apply vÃ  bind ta cÃ³ thá»ƒ thay Ä‘á»•i Ä‘Æ°á»£c ngá»¯ cáº£nh thá»±c thi (pháº¡m vi chá»©a hÃ m) Ä‘á»ƒ sá»­ dá»¥ng má»™t hÃ m vá»›i cÃ´ng dá»¥ng Ä‘a nÄƒng hÆ¡n nhÆ° thá»±c thi cho má»™t Ä‘á»‘i tÆ°á»£ng, pháº¡m vi khÃ¡c khÃ¡c giÃºp ta cÃ³ thá»ƒ táº­n dá»¥ng tá»‘i Ä‘a mÃ£ nguá»“n Ä‘Æ°á»£c Ä‘Ã£ táº¡o ra, hay táº¡o shortcut cho hÃ m, linh hoáº¡t hÆ¡n tham sá»‘ Ä‘áº§u vÃ o. Vá»›i call vÃ  apply chÃºng ta sá»­ dá»¥ng Ä‘á»ƒ thá»±c thi hÃ m Ä‘Ã³ luÃ´n khi gá»i, cÃ²n vá»›i bind ta cÃ³ thá»ƒ thá»±c thi hÃ m Ä‘Ã³ nhiá»u láº§n sau khi Ä‘Ã£ Ä‘Æ°á»£c buá»™c (bind) vá»›i má»™t ngá»¯ cáº£nh nháº¥t Ä‘á»‹nh. ChÃº thÃ­ch[1] Ä‘á»‘i tÆ°á»£ng tá»±a máº£ng: Má»™t Ä‘á»‘i tÆ°á»£ng tá»±a máº£ng (array-like object) lÃ  má»™t Ä‘á»‘i tÆ°á»£ng cÃ³ cÃ¡c thuá»™c tÃ­nh lÃ  sá»‘ tá»± nhiÃªn vÃ  cÃ³ má»™t thuá»™c tÃ­nh báº¯t buá»™c lÃ  length cÃ³ giÃ¡ trá»‹ báº±ng sá»‘ cÃ¡c thuá»™c tÃ­nh lÃ  sá»‘ tá»± nhiÃªn. VÃ­ dá»¥: {length: 3, 0: &quot;TÃ´i&quot;, 1: &quot;lÃ &quot;, 2: &quot;ngÆ°á»i Viá»‡t&quot;} hoáº·c {&#39;length&#39;: 3, &#39;0&#39;: &quot;TÃ´i&quot;, &#39;1&#39;: &quot;lÃ &quot;, &#39;2&#39;: &quot;ngÆ°á»i Viá»‡t&quot;}.","categories":[{"name":"Javascript","slug":"Javascript","permalink":"http://nthung2112.github.io/categories/Javascript/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"call","slug":"call","permalink":"http://nthung2112.github.io/tags/call/"},{"name":"apply","slug":"apply","permalink":"http://nthung2112.github.io/tags/apply/"},{"name":"bind","slug":"bind","permalink":"http://nthung2112.github.io/tags/bind/"}]},{"title":"TÃ¬m hiá»ƒu vá» tá»« khÃ³a this","slug":"Javascript-Tim-hieu-ve-tu-khoa-this","date":"2017-01-10T12:55:00.000Z","updated":"2017-08-20T14:51:16.099Z","comments":true,"path":"2017/01/Javascript-Tim-hieu-ve-tu-khoa-this.html","link":"","permalink":"http://nthung2112.github.io/2017/01/Javascript-Tim-hieu-ve-tu-khoa-this.html","excerpt":"123456789101112// app.js// cÃ¢u há»i: ÄoÃ¡n káº¿t quáº£ lá»‡nh (1) vÃ  lá»‡nh (2)var obj = &#123; mMethod: function() &#123; console.log(this) &#125;&#125;obj.mMethod(); // (1)var _mMethod = obj.mMethod;_mMethod(); // (2) JavaScript (JS) lÃ  má»™t ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡ linh hoáº¡t vÃ  thÃº vá»‹. NhÆ°ng Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³ nÃ³ cÅ©ng mang tá»›i khÃ´ng Ã­t phiá»n phá»©c, dá»… nháº§m láº«n vá»›i nhá»¯ng ngÆ°á»i khÃ´ng chuyÃªn. Vá»›i nhá»¯ng ngÆ°á»i má»›i sá» vÃ o JS, há» thÆ°á»ng nghÄ© ngay cháº¯c JS cÅ©ng lÆ¡ lá»› nhÆ° cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡c nhÆ° Java hay C#. NhÆ°ng nhiá»u Ä‘iá»ƒm á»Ÿ JS láº¡i khÃ¡ khÃ¡c vá»›i suy nghÄ© á»Ÿ cÃ¡c ngÃ´n ngá»¯ khÃ¡c gÃ¢y nÃªn nhá»¯ng hiá»ƒu láº§m cho ngÆ°á»i má»›i vÃ o nghá». Má»™t trong nhá»¯ng Ä‘iá»ƒm dá»… nháº§m láº«n Ä‘Ã³ lÃ  biáº¿n this vÃ¬ trong JS nÃ³ khÃ´ng chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘áº¡i diá»‡n cho Ä‘á»‘i tÆ°á»£ng hiá»‡n thá»i nhÆ° cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng khÃ¡c. Cá»¥ thá»ƒ ra sao ta cÃ¹ng nhau xem xÃ©t á»Ÿ bÃ i viáº¿t nÃ y. Äá»c tá»›i Ä‘Ã¢y cháº¯c má»™t sá»‘ báº¡n biáº¿t vá» this rá»“i sáº½ báº­t cÆ°á»i lÃ  sao láº¡i viáº¿t lÃ  biáº¿n this. Náº¿u báº¡n nghÄ© tá»›i má»©c Ä‘Ã³ thÃ¬ xin chÃºc má»«ng báº¡n, báº¡n Ä‘Ã£ Ä‘Ãºng. this trong JS lÃ  má»™t tá»« khoÃ¡ chá»© khÃ´ng pháº£i lÃ  má»™t biáº¿n nÃ o cáº£. Báº¡n khÃ´ng thá»ƒ gáº¯n giÃ¡ trá»‹ trá»±c tiáº¿p cho this Ä‘Æ°á»£c cÅ©ng nhÆ° cháº³ng thá»ƒ nÃ o delete nÃ³ Ä‘i. Váº­y tá»« khoÃ¡ nÃ y cÃ³ gÃ¬ láº¡i ráº¯c rá»‘i váº­y?","text":"123456789101112// app.js// cÃ¢u há»i: ÄoÃ¡n káº¿t quáº£ lá»‡nh (1) vÃ  lá»‡nh (2)var obj = &#123; mMethod: function() &#123; console.log(this) &#125;&#125;obj.mMethod(); // (1)var _mMethod = obj.mMethod;_mMethod(); // (2) JavaScript (JS) lÃ  má»™t ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡ linh hoáº¡t vÃ  thÃº vá»‹. NhÆ°ng Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³ nÃ³ cÅ©ng mang tá»›i khÃ´ng Ã­t phiá»n phá»©c, dá»… nháº§m láº«n vá»›i nhá»¯ng ngÆ°á»i khÃ´ng chuyÃªn. Vá»›i nhá»¯ng ngÆ°á»i má»›i sá» vÃ o JS, há» thÆ°á»ng nghÄ© ngay cháº¯c JS cÅ©ng lÆ¡ lá»› nhÆ° cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡c nhÆ° Java hay C#. NhÆ°ng nhiá»u Ä‘iá»ƒm á»Ÿ JS láº¡i khÃ¡ khÃ¡c vá»›i suy nghÄ© á»Ÿ cÃ¡c ngÃ´n ngá»¯ khÃ¡c gÃ¢y nÃªn nhá»¯ng hiá»ƒu láº§m cho ngÆ°á»i má»›i vÃ o nghá». Má»™t trong nhá»¯ng Ä‘iá»ƒm dá»… nháº§m láº«n Ä‘Ã³ lÃ  biáº¿n this vÃ¬ trong JS nÃ³ khÃ´ng chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘áº¡i diá»‡n cho Ä‘á»‘i tÆ°á»£ng hiá»‡n thá»i nhÆ° cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng khÃ¡c. Cá»¥ thá»ƒ ra sao ta cÃ¹ng nhau xem xÃ©t á»Ÿ bÃ i viáº¿t nÃ y. Äá»c tá»›i Ä‘Ã¢y cháº¯c má»™t sá»‘ báº¡n biáº¿t vá» this rá»“i sáº½ báº­t cÆ°á»i lÃ  sao láº¡i viáº¿t lÃ  biáº¿n this. Náº¿u báº¡n nghÄ© tá»›i má»©c Ä‘Ã³ thÃ¬ xin chÃºc má»«ng báº¡n, báº¡n Ä‘Ã£ Ä‘Ãºng. this trong JS lÃ  má»™t tá»« khoÃ¡ chá»© khÃ´ng pháº£i lÃ  má»™t biáº¿n nÃ o cáº£. Báº¡n khÃ´ng thá»ƒ gáº¯n giÃ¡ trá»‹ trá»±c tiáº¿p cho this Ä‘Æ°á»£c cÅ©ng nhÆ° cháº³ng thá»ƒ nÃ o delete nÃ³ Ä‘i. Váº­y tá»« khoÃ¡ nÃ y cÃ³ gÃ¬ láº¡i ráº¯c rá»‘i váº­y? 1. Báº£n cháº¥t cá»§a tá»« khoÃ¡ thisCÃ¡c Ä‘oáº¡n mÃ£ cá»§a JavaScript Ä‘Æ°á»£c thá»±c thi trong má»™t ngá»¯ cáº£nh nháº¥t Ä‘á»‹nh (Execution Context). CÃ¡c ngá»¯ cáº£nh nÃ y láº¡i Ä‘Æ°á»£c sáº¯p xáº¿p Ä‘á»ƒ thá»±c hiá»‡n chÆ°Æ¡ng trÃ¬nh má»™t cÃ¡ch tuáº§n tá»±. Báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng tháº¿ nÃ y, má»—i ngá»¯ cáº£nh chá»©a má»™t sá»‘ Ä‘oáº¡n mÃ£ nháº¥t Ä‘á»‹nh, vÃ  toÃ n chÆ°Æ¡ng trÃ¬nh cá»§a ta sáº¯p xáº¿p cÃ¡c ngá»¯ cáº£nh nÃ y vÃ o má»™t ngÄƒn xáº¿p (stack). Sau Ä‘Ã³ cÃ¡c ngá»¯ cáº£nh sáº½ Ä‘Æ°á»£c gá»i ra thá»±c thi dáº§n cho tá»›i háº¿t, tá»©c lÃ  ngá»¯ cáº£nh trÃªn Ä‘á»‰nh cá»§a ngÄƒn xáº¿p sáº½ chá»©a cÃ¡c Ä‘oáº¡n mÃ£ sáºµn sÃ ng cháº¡y. Má»—i ngá»¯ cáº£nh thá»±c thi nÃ y cÃ³ tÆ°Æ¡ng á»©ng má»™t ThisBinding cÃ³ giÃ¡ trá»‹ khÃ´ng Ä‘á»•i Ä‘áº¡i diá»‡n cho ngá»¯ cáº£nh thá»±c thi Ä‘Ã³. VÃ  tá»« khoÃ¡ this sáº½ báº±ng giÃ¡ trá»‹ ThisBinding trong ngá»¯ cáº£nh Ä‘ang thá»±c thi hiá»‡n thá»i. NhÆ° váº­y this sáº½ Ä‘áº¡i diá»‡n cho ngá»¯ cáº£nh Ä‘ang thá»±c thi vÃ  nÃ³ cáº§n Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ láº¡i tham chiáº¿u khi ngá»¯ cáº£nh thá»±c thi thay Ä‘á»•i. CÃ³ 3 kiá»ƒu ngá»¯ cáº£nh thá»±c thi lÃ  toÃ n cá»¥c (global), eval vÃ  hÃ m (function). Global lÃ  ngá»¯ cáº£nh á»Ÿ má»©c trÃªn cÃ¹ng cá»§a toÃ n bá»™ chÆ°Æ¡ng trÃ¬nh, tá»©c lÃ  nÃ³ chá»©a cÃ¡c Ä‘oáº¡n mÃ£ khÃ´ng náº±m trong function hay Ä‘Æ°á»£c gá»i bá»Ÿi eval vÃ  global sáº½ lÃ  ngá»¯ cáº£nh thá»±c thi chÆ°Æ¡ng trÃ¬nh máº·c Ä‘á»‹nh. Eval lÃ  ngá»¯ cáº£nh chá»©a cÃ¡c mÃ£ Ä‘Æ°á»£c gá»i bá»Ÿi hÃ m eval. CÃ²n function lÃ  cÃ¡c Ä‘oáº¡n mÃ£ náº±m trong má»™t function nÃ o Ä‘Ã³. Ta sáº½ xem chi tiáº¿t tá»«ng ngá»¯ cáº£nh thá»±c thi qua pháº§n dÆ°á»›i Ä‘Ã¢y. 2. CÃ¡c ngá»¯ cáº£nh thá»±c thi2.1. ToÃ n cá»¥c - GlobalLÃ  ngá»¯ cáº£nh thá»±c thi náº±m á»Ÿ trÃªn cÃ¹ng cá»§a ngÄƒn xáº¿p ngá»¯ cáº£nh, tá»©c lÃ  ngá»¯ cáº£nh Ä‘áº§u tiÃªn thá»±c thi chÆ°Æ¡ng trÃ¬nh. VÃ­ dá»¥ trong cÃ¡c mÃ£ thá»±c thi phÃ­a mÃ¡y khÃ¡ch trong trang web thÃ¬ ngá»¯ cáº£nh toÃ n cá»¥c nÃ y náº±m ngay sau tháº» . Trong ngá»¯ cáº£nh toÃ n cá»¥c nÃ y thÃ¬ ThisBinding sáº½ Ä‘Æ°á»£c thiáº¿t láº­p giÃ¡ trá»‹ lÃ  Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c (Global Object). Trong Nodejs thÃ¬ Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c lÃ  Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c cá»§a Nodejs - khá»Ÿi Ä‘áº§u lÃ  má»™t Ä‘á»‘i tÆ°á»£ng trá»‘ng, trong trÃ¬nh duyá»‡t thÃ¬ nÃ³ lÃ  Ä‘á»‘i tÆ°á»£ng window, nhÆ°ng cáº§n chÃº Ã½ lÃ  náº¿u á»Ÿ trong cháº¿ Ä‘á»™ strict mode thÃ¬ Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c lÃ  undefined. Ta cÃ³ thá»ƒ cÃ¹ng nhau xem xÃ©t vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y. 12345678910111213console.log(this) // Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c trong ngá»¯ cáº£nh toÃ n cá»¥cthis.mX = \"I love JavaScript\" // sá»­ dá»¥ng Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥cconsole.log(this.mX) // in ra giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh mXvar obj = &#123; mMethod: function() &#123; console.log(this) // in ra giÃ¡ trá»‹ this hiá»‡n thá»i &#125;&#125;obj.mMethod() // khÃ´ng cÃ²n lÃ  Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c ná»¯a 2.2. Gá»i mÃ£ - EvalVá»›i trÆ°á»ng há»£p sá»­ dá»¥ng hÃ m eval ta phÃ¢n lÃ m 2 trÆ°á»ng há»£p. 2.2.1. Gá»i eval trá»±c tiáº¿pGá»i eval trá»±c tiáº¿p lÃ  ta gá»i trá»±c tiáº¿p hÃ m eval nhÆ° vÃ­ dá»¥ bÃªn dÆ°á»›i. Vá»›i trÆ°á»ng há»£p nÃ y thÃ¬ ThisBinding sáº½ Ä‘Æ°á»£c gáº¯n giÃ¡ trá»‹ lÃ  ngá»¯ cáº£nh gá»‘c cá»§a Ä‘oáº¡n mÃ£ Ä‘Ã³. 12345678910111213function callMe() &#123; console.log(this)&#125;var obj = &#123; callMe: function() &#123; console.log(this) &#125;&#125;eval(\"callMe()\") // Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥ceval(\"obj.callMe()\") // Ä‘á»‘i tÆ°á»£ng obj 2.2.2. Gá»i eval giÃ¡n tiáº¿pGá»i eval giÃ¡n tiáº¿p lÃ  ta gá»i hÃ m eval thÃ´ng qua má»™t biáº¿n Ä‘Æ°á»£c gáº¯n giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng nhÆ° truyá»n hÃ m eval qua tham sá»‘ hÃ m khÃ¡c hoáº·c gáº¯n nÃ³ vá»›i má»™t biáº¿n nÃ o Ä‘Ã³. Vá»›i trÆ°á»ng há»£p nÃ y thÃ¬ ThisBinding sáº½ Ä‘Æ°á»£c gáº¯n giÃ¡ trá»‹ lÃ  ngá»¯ toÃ n cá»¥c. 1234567891011121314151617181920// this trong mÃ£ thá»±c thi cá»§a eval sáº½ lÃ  Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥cthis.callMe = function () &#123; console.log(\"callMe in Global Object\")&#125;var obj = &#123; callMe: function() &#123; console.log(this) &#125;, _callMe: function(_eval) &#123; _eval(\"console.log(this)\") _eval(\"callMe()\") &#125;&#125;obj._callMe(eval) // gá»i giÃ¡n tiáº¿p eval qua tham sá»‘ hÃ mvar mEval = eval // gáº¯n eval vá»›i má»™t biáº¿nmEval(\"console.log(this)\") // gá»i giÃ¡n tiáº¿p eval qua biáº¿n mEval 2.3. HÃ m - FunctionKhi hÃ m Ä‘Æ°á»£c gá»i thÃ¬ ngá»¯ cáº£nh thá»±c thi cá»§a nÃ³ sáº½ phá»¥ thuá»™c vÃ o tham sá»‘ Ä‘áº§u vÃ o vÃ  ngá»¯ cáº£nh gá»i nÃ³. Giáº£ sá»­ hÃ m cá»§a ta lÃ  F, vá»›i tham sá»‘ lÃ  argumentsLits, vÃ  ngá»¯ cáº£nh gá»i F tÆ°Æ¡ng á»©ng vá»›i thisValue. Viá»‡c xÃ¡c Ä‘á»‹nh thisBinding Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh nhÆ° sau: If hÃ m trong cháº¿ Ä‘á»™ strict, ThisBinding Ä‘Æ°á»£c gáº¯n lÃ  thisValue. Else if thisValue lÃ  null hoáº·c undefined, ThisBinding Ä‘Æ°á»£c gáº¯n lÃ  Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c. Else if Type(thisValue) khÃ´ng lÃ  Object, ThisBinding Ä‘Æ°á»£c gáº¯n lÃ  ToObject(thisValue). Else ThisBinding Ä‘Æ°á»£c gáº¯n lÃ  thisValue Xem thÃªm vá» cÃ¡ch gáº¯n thisBinding á»Ÿ Ä‘Ã¢y. Äá»ƒ rÃµ rÃ ng hÆ¡n ta xÃ©t má»™t sá»‘ tÃ¬nh huá»‘ng cá»¥ vá»›i viá»‡c gá»i hÃ m. 2.3.1. Gá»i thÃ´ng qua ngá»¯ cáº£nh toÃ n cá»¥cTrÆ°á»ng há»£p nÃ y this sáº½ tham chiáº¿u tá»›i Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c.123456789101112131415function mMethod() &#123; console.log(this) // Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c - global object&#125;mMethod();var obj = &#123; myMethod: function() &#123; return (function()&#123; console.log(this) // Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c &#125;)(); &#125;&#125;obj.myMethod() 2.3.2. Gá»i thÃ´ng qua Ä‘á»‘i tÆ°á»£ngTrÆ°á»ng há»£p nÃ y this sáº½ tham chiáº¿u tá»›i Ä‘á»‘i tÆ°á»£ng thisValue - Ä‘á»‘i tÆ°á»£ng tÆ°Æ¡ng á»©ng chá»©a hÃ m. 12345678910111213141516171819202122232425262728293031323334353637// Táº¡o Ä‘á»‘i tÆ°á»£ng objvar obj = &#123; mMethod: function() &#123; console.log(this) &#125;, oMethod: function() &#123; console.log('â–¼ oMethod') console.log(this) console.log('â–² oMethod') &#125;&#125;obj.mMethod() // this sáº½ tÆ°Æ¡ng á»©ng vá»›i Ä‘á»‘i tÆ°á»£ng objobj['oMethod']() // this sáº½ tÆ°Æ¡ng á»©ng vá»›i Ä‘á»‘i tÆ°á»£ng obj// Gáº¯n mMethod cho Ä‘á»‘i tÆ°á»£ng khÃ¡cvar obj1 = &#123; mVal: \"I'm obj1\"&#125;obj1.mMethod = obj.mMethod;obj1.mMethod() // this sáº½ tÆ°Æ¡ng á»©ng vá»›i Ä‘á»‘i tÆ°á»£ng obj1// Gá»i qua khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng vá»›i tá»« khoÃ¡ newfunction MyObject(val) &#123; this.mVal = val || \"I xxx JS\"; this.mMethod = function() &#123; console.log(this) &#125;;&#125;var mObj1 = new MyObject()var mObj2 = new MyObject(\"I'm object 2\")mObj1.mMethod() // this sáº½ tÆ°Æ¡ng á»©ng vá»›i Ä‘á»‘i tÆ°á»£ng mObj1mObj2.mMethod() // this sáº½ tÆ°Æ¡ng á»©ng vá»›i Ä‘á»‘i tÆ°á»£ng mObj2 2.3.3. Gá»i thÃ´ng qua má»™t sá»‘ hÃ m Ä‘áº·c biá»‡tTrong JavaScript cÃ³ xÃ¢y dá»±ng sáºµn má»™t sá»‘ hÃ m Ä‘áº·c biá»‡t cho phÃ©p ta sá»­ dá»¥ng this qua Ä‘á»‘i tÆ°á»£ng Ä‘áº§u vÃ o nhÆ°: Function.prototype.apply(thisArg, argArray) Function.prototype.call(thisArg[, arg1[ , arg2, â€¦]]) Function.prototype.bind( thisArg[, arg1[ , arg2, â€¦]]) Array.prototype.every(callback[, thisArg]) Array.prototype.some(callback[, thisArg]) Array.prototype.forEach(callback[, thisArg]) Array.prototype.map(callback[, thisArg]) Array.prototype.filter(callback[, thisArg]) Báº±ng viá»‡c sá»­ dá»¥ng cÃ¡c hÃ m trÃªn ta cÃ³ thá»ƒ thá»ƒ sá»­ dá»¥ng this nhÆ° lÃ  giÃ¡ trá»‹ cá»§a Ä‘á»‘i tÆ°á»£ng thisArg. Viá»‡c nÃ y ráº¥t tiá»‡n cho ta thay Ä‘á»•i thisBinding má»™t cÃ¡ch chá»§ Ä‘á»™ng. Ta cÃ³ thá»ƒ xem vÃ­ dá»¥ sau: 123456789101112131415161718var obj = &#123; mMethod: function(firstName, lastName) &#123; var firstName = firstName || \"VÃ´\" var lastName = lastName || \"Danh\" console.log(\"Hello \" + firstName + \" \" + lastName) console.log(this) &#125;&#125;var obj1 = &#123; mVal: \"I'm obj1\"&#125;;obj.mMethod.apply(obj1) // Ä‘á»‘i tÆ°á»£ng obj1obj.mMethod.apply(obj1, [\"ChÃ­\", \"PhÃ¨o\"]) // Ä‘á»‘i tÆ°á»£ng obj1obj.mMethod.call(obj1, \"Thá»‹\", \"Ná»Ÿ\") // Ä‘á»‘i tÆ°á»£ng obj1 Äoáº¡n mÃ£ trÃªn sáº½ in ra this lÃ  Ä‘á»‘i tÆ°á»£ng obj1 chá»© khÃ´ng cÃ²n lÃ  obj, do call vÃ  apply Ä‘Ã£ Ä‘áº©y trá»±c tiáº¿p this qua tham sá»‘ Ä‘áº§u vÃ o. 3. Má»™t sá»‘ trÆ°á»ng há»£p dá»… nháº§m láº«n3.1. Gá»i thÃ´ng qua ngá»¯ cáº£nh khÃ¡cTa xÃ©t trÆ°á»ng há»£p sau: 1234567891011var obj = &#123; mVal: \"Viá»‡t Nam\", mMethod: function() &#123; console.log(\"Hello \" + this.mVal) &#125;&#125;var oMethod = obj.mMethod // oMethod náº±m trong ngá»¯ cáº£nh toÃ n cá»¥coMethod() Khi thá»±c hiá»‡n Ä‘oáº¡n mÃ£ trÃªn káº¿t quáº£ in ra sáº½ lÃ  Hello undefined, vÃ¬ ta Ä‘Ã£ Ä‘áº©y this ra Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c máº¥t rá»“i. Váº­y lÃ m sao Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c Ä‘Ãºng káº¿t quáº£ lÃ  Hello Viá»‡t Nam? Äá»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c cÃ¡i nÃ y ta sáº½ sá»­ dá»¥ng hÃ m bind Ä‘á»ƒ Ä‘áº©y giÃ¡ trá»‹ Ä‘á»‘i tÆ°á»£ng obj cho biáº¿n this á»Ÿ Ä‘Ã¢y nhÆ° sau: 1234567891011var obj = &#123; mVal: \"Viá»‡t Nam\", mMethod: function() &#123; console.log(\"Hello \" + this.mVal) &#125;&#125;var oMethod = obj.mMethod.bind(obj) // this trong oMethod sáº½ bá»‹ Ã©p thÃ nh giÃ¡ trá»‹ objoMethod() VÃ¬ sao láº¡i lÃ  bind mÃ  khÃ´ng pháº£i lÃ  call hay apply? VÃ¬ bind sáº½ giá»¯ giÃ¡ trá»‹ cá»§a obj Ä‘á»ƒ gá»i nhiá»u láº§n chá»© khÃ´ng chá»‰ gá»i má»™t láº§n nhÆ° vá»›i call hay apply. CÃ¡c báº¡n cÃ³ thá»ƒ Ä‘á»c thÃªm á»Ÿ Ä‘Ã¢y.Vá»›i trÆ°á»ng há»£p gá»i má»™t láº§n vá»›i call hoáº·c apply ta cÃ³ thá»ƒ cÃ¹ng nhau xem vÃ­ dá»¥ sau: 12345678910111213var obj = &#123; mVal: \"Viá»‡t Nam\", mMethod: function() &#123; console.log(\"Hello \" + this.mVal) &#125;&#125;var obj1 = &#123; mVal: \"Nháº­t Báº£n\" &#125;obj.mMethod.call(obj1) // in ra lÃ : Hello Nháº­t Báº£n Äoáº¡n mÃ£ trÃªn sáº½ gá»i hÃ m mMethod cá»§a Ä‘á»‘i tÆ°á»£ng obj nhÆ°ng this trong hÃ m mMethod Ä‘Ã£ Ä‘Æ°á»£c Ã©p thÃ nh Ä‘á»‘i tÆ°á»£ng obj1. Vá»›i viá»‡c gá»i 1 láº§n nÃ y ta cÃ³ thá»ƒ mÆ°á»£n phÆ°Æ¡ng thá»©c mMethod cá»§a Ä‘á»‘i tÆ°á»£ng obj Ä‘á»ƒ thá»±c thi cho Ä‘á»‘i tÆ°á»£ng obj1 mÃ  khÃ´ng cáº§n táº¡o phÆ°Æ¡ng thá»©c nÃ y cho Ä‘á»‘i tÆ°á»£ng obj1. CÃ¡i nÃ y khÃ¡ kool Ä‘Ãºng hem ^.^ 3.2. HÃ m pháº£n há»“i - CallbackGá»i thÃ´ng qua hÃ m pháº£n há»“i cÅ©ng chÃ­nh lÃ  má»™t trÆ°á»ng há»£p cá»§a gá»i thÃ´ng qua ngá»¯ cáº£nh khÃ¡c vÃ¬ hÃ m pháº£n há»“i Ä‘Æ°á»£c thá»±c thi trong má»™t ngá»¯ cáº£nh khÃ¡c. Ta xÃ©t vÃ­ dá»¥ sau: 123456789101112131415var obj = &#123; mVal: \"Viá»‡t Nam\", mMethod: function() &#123; console.log(\"Hello \" + this.mVal) &#125;&#125;var obj1 = &#123; oMethod: function(callback) &#123; return callback(); &#125;&#125;obj1.oMethod(obj.mMethod) VÃ¬ gá»i trong ngá»¯ cáº£nh cá»§a Ä‘á»‘i tÆ°á»£ng obj1 nÃªn mMethod lÃºc nÃ y sáº½ láº¥y giÃ¡ trá»‹ cho this lÃ  obj1 chá»© khÃ´ng cÃ²n lÃ  obj ná»¯a. Váº«n lÃ m tÆ°Æ¡ng tá»± nhÆ° pháº§n 3.1, ta sá»­ dá»¥ng bind Ä‘á»ƒ Ä‘áº©y giÃ¡ trá»‹ ngá»¯ cáº£nh obj vÃ o cho mMethod nhÆ° sau: 123456789101112131415var obj = &#123; mVal: \"Viá»‡t Nam\", mMethod: function() &#123; console.log(\"Hello \" + this.mVal) &#125;&#125;var obj1 = &#123; oMethod: function(callback) &#123; return callback(); &#125;&#125;obj1.oMethod(obj.mMethod.bind(obj)) HoÃ n háº£o, Ä‘oáº¡n mÃ£ trÃªn Ä‘Ã£ cho ta káº¿t quáº£ nhÆ° mong muá»‘n. Äá»c tá»›i Ä‘Ã¢y, nhiá»u báº¡n tháº¯c máº¯c sao cáº§n gÃ¬ pháº£i tÃ¡ch ra 3.1 vá»›i 3.2 lÃ m gÃ¬ cho ráº¯c rá»‘i? TÃ¡ch ra tháº¿ nÃ y cÃ³ lá»£i tháº¿ lÃ  khÃ´ng bá»‹ vÆ°á»›ng quÃ¡ nhiá»u váº¥n Ä‘á» vÃ o cáº£ má»™t cá»¥m, vÃ­ hÃ m pháº£n há»“i lÃ  má»™t trÆ°á»ng há»£p ráº¥t hay Ä‘Æ°á»£c sá»­ dá»¥ng khi láº­p trÃ¬nh vá»›i JavaScript. VÃ­ dá»¥ nhÆ° trong Nodejs, hÃ m pháº£n há»“i lÃ  má»™t thÃ nh pháº§n quan trá»ng, má»™t khÃ¡i niá»‡m cÆ¡ báº£n nháº¥t cáº§n náº¯m Ä‘Æ°á»£c Ä‘á»ƒ cÃ³ thá»ƒ láº­p trÃ¬nh vá»›i Nodejs. Hay nhiá»u báº¡n cÃ³ sá»­ dá»¥ng JQuery Ä‘á»ƒ lÃ m phÃ­a trÃ¬nh duyá»‡t, cÃ¡c sá»± kiá»‡n click vÃ o má»™t nÃºt nÃ o Ä‘Ã³ cháº³ng háº¡n, cÃ¡c báº¡n Ä‘á»u sá»­ dá»¥ng luÃ´n Ä‘Æ°á»£c tá»« khoÃ¡ this ngay trong hÃ m pháº£n há»“i cá»§a cÃ¡c nÃºt Ä‘Ã³ mÃ  khÃ´ng cáº§n quan tÃ¢m tá»›i ngá»¯ cáº£nh thá»±c thi hiá»‡n táº¡i lÃ  gÃ¬ cáº£. Äá»ƒ lÃ m Ä‘Æ°á»£c viá»‡c Ä‘Ã³, jQuery Ä‘á»u Ä‘Ã£ bind cÃ¡c nÃºt tÆ°Æ¡ng á»©ng Ä‘Ã³ cho cÃ¡c hÃ m pháº£n há»“i cho cÃ¡c báº¡n rá»“i Ä‘Ã³. 3.3. HÃ m lá»“ng nhauTa cÃ¹ng xÃ©t sá»± nháº­p nháº±ng qua vÃ­ dá»¥ sau. 1234567891011121314151617var obj = &#123; mVal: \"Viá»‡t Nam\", oVal: &#123; oMethod: function(callMe) &#123; callMe() &#125; &#125;, mMethod: function() &#123; this.oVal.oMethod(function() &#123; console.log(\"Hello \" + this.mVal) &#125;) &#125;&#125;obj.mMethod() // in ra lÃ : Hello undefined Vá»›i Ä‘oáº¡n mÃ£ trÃªn ta mong muá»‘n nÃ³ in ra Ä‘Æ°á»£c giÃ¡ chá»‰ cá»§a biáº¿n mVal trong Ä‘á»‘i tÆ°á»£ng obj nhÆ°ng thá»±c táº¿ nÃ³ sáº½ in ra Hello undefined? NguyÃªn nhÃ¢n lÃ  ngá»¯ cáº£nh cá»§a thá»±c thi á»Ÿ console.log lÃºc nÃ y lÃ  Ä‘á»‘i tÆ°á»£ng oVal máº¥t rá»“i. Váº­y lÃ m sao ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c biáº¿n mVal cá»§a Ä‘á»‘i tÆ°á»£ng obj? Muá»‘n lÃ m Ä‘Æ°á»£c nhÆ° váº­y ta cáº§n láº¥y Ä‘Æ°á»£c ngá»¯ cáº£nh thá»±c thi cá»§a Ä‘á»‘i tÆ°á»£ng obj báº±ng cÃ¡ch nhá»› láº¡i ngá»¯ cáº£nh thá»±c thi thÃ´ng qua má»™t biáº¿n trung gian vÃ  sá»­ dá»¥ng biáº¿n nÃ y vá»›i ngá»¯ cáº£nh cá»§a Ä‘á»‘i tÆ°á»£ng oVal. VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y sáº½ thá»±c hiá»‡n theo Ã½ tÆ°á»Ÿng nÃ y: 12345678910111213141516171819var obj = &#123; mVal: \"Viá»‡t Nam\", oVal: &#123; oMethod: function(callMe) &#123; callMe() &#125; &#125;, mMethod: function() &#123; var _this = this; // nhá»› ngá»¯ cáº£nh thá»±c thi cá»§a obj trong biáº¿n _this this.oVal.oMethod(function() &#123; console.log(\"Hello \" + _this.mVal) // gá»i tá»›i ngá»¯ cáº£nh thá»±c thi cá»§a obj &#125;) &#125;&#125;obj.mMethod() 4. Káº¿t luáº­nTá»« khoÃ¡ this hÆ¡i ráº¯c rá»‘i má»™t chÃºt nÃªn khi láº­p trÃ¬nh ta cáº§n chÃº Ã½ tá»›i ngá»¯ cáº£nh thá»±c thi Ä‘á»ƒ sá»­ dá»¥ng tá»« khoÃ¡ nÃ y cho hiá»‡u quáº£ vÃ  Ä‘Ãºng Ä‘áº¯n dá»±a vÃ o ngá»¯ cáº£nh gá»i nÃ³ vÃ  kiá»ƒu cá»§a ngá»¯ cáº£nh thá»±c thi. Ta cÅ©ng cáº§n chÃº Ã½ hÆ¡n á»Ÿ nhá»¯ng Ä‘oáº¡n sá»­ dá»¥ng tá»›i hÃ m pháº£n há»“i hay hÃ m lá»“ng nhau. NgoÃ i ra ta cÃ³ thá»ƒ thay Ä‘á»•i Ä‘Æ°á»£c ngá»¯ cáº£nh thá»±c thi cá»§a má»™t Ä‘á»‘i tÆ°á»£ng báº±ng cÃ¡ch sá»­ dá»¥ng call, apply hoáº·c bind nhÆ° Ä‘Ã£ mÃ´ táº£ phÃ­a trÃªn. Vá» viá»‡c sá»­ dá»¥ng Call, Apply vÃ  Bind cá»¥ thá»ƒ ra sao thÃ¬ cÃ¡c báº¡n Ä‘á»c thÃªm á»Ÿ bÃ i viáº¿t nÃ y. NgoÃ i ra, báº¡n cÃ³ thá»ƒ tham kháº£o vá» chuáº©n ECMAScript 5.1 á»Ÿ Ä‘Ã¢y.","categories":[{"name":"Javascript","slug":"Javascript","permalink":"http://nthung2112.github.io/categories/Javascript/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://nthung2112.github.io/tags/javascript/"},{"name":"this","slug":"this","permalink":"http://nthung2112.github.io/tags/this/"}]}]}