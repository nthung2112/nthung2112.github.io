<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title> Tìm hiểu Higher-Order Function (HOF) và Currying qua một số ví dụ · Learn and Share</title><meta name="description" content="Tìm hiểu Higher-Order Function (HOF) và Currying qua một số ví dụ - Hung Tan Nguyen"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#FB4D42"><meta name="google-site-verification" content="rk-Nc1c8xi1CdZ0ZQIVV-ifsndGrHanIuSHI-yTHZYE"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/zoom.css"><meta property="og:title" content="Tìm hiểu Higher-Order Function (HOF) và Currying qua một số ví dụ"><meta property="og:image" content="https://i.ytimg.com/vi/dTlpYnmBW9I/maxresdefault.jpg"><meta property="og:description" content="HOF và Currying là hai kỹ thuật không khó, thậm chí có thể bạn đang dùng nó hàng ngày mà không để ý. Cùng tìm hiểu chúng thông qua một số ví dụ.
BackgroundTôi cho rằng một kỹ sư phần mềm pro không phải là người viết ra những dòng code đánh đố người đọc hay đồng nghiệp, mà là người viết những dòng code mà khi người khác đọc nó liền cảm thấy trong sáng, dễ hiểu, dễ bảo trì.
Cũng như sự tiến hóa của con người, khi mà “ăn no, ăn sạch rồi ăn ngon”, thì coding cũng có slogan tương tự: “chạy được, chạy đúng, sau cùng là chạy nhanh”.Vậy, sau khi chạy được và chạy đúng rồi, chúng ta nên suy nghĩ xem ngoài việc có thể chạy nhanh hơn ko, thì đoạn code này đã sáng sủa chưa? Nếu bị/được sửa thì có dễ ko?
HOF và Currying là 2 trong số ti tỉ kỹ thuật nhằm giúp chúng ta, những lập trình viên huyền thoại, đạt được tiêu chí trên."></head><body><div class="wrap"><div class="header"><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nthung2112" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item search-form-input"><div class="search-icon"><div class="search-icon__circle"></div><div class="search-icon__rectangle"></div></div></li></ul><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" placeholder="Type something..." class="ins-search-input"><span class="ins-close ins-selectable"><div class="close-icon"><div class="close-icon__x"></div><div class="close-icon__y"></div></div></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>var rootUrl = "/";
var contentUrl = '/content.json';
(function (window) {
  var INSIGHT_CONFIG = {
  TRANSLATION: {
      POSTS:'Posts',
      PAGES: 'Pages',
      CATEGORIES: 'Categories',
      TAGS: 'Tags',
      UNTITLED: '(Untitled)'
    },
    ROOT_URL: rootUrl,
    CONTENT_URL: contentUrl,
  };
  window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);</script></div></div><section class="container"><div class="post"><article class="post-block"><div class="wrap"><h1 class="post-title">Tìm hiểu Higher-Order Function (HOF) và Currying qua một số ví dụ</h1><h2 class="post-subtitle"></h2><header class="post-info">Apr 3, 2018<div class="tags"><a href="/tags/javascript" class="tag-link">#javascript</a><a href="/tags/hof" class="tag-link">#hof</a></div><div class="fb-ir-time"><time dateTime="2018-04-03T04:20:00.000Z" class="op-modified"></time><time dateTime="2018-04-03T04:20:00.000Z" class="op-published"></time></div></header></div><div class="post-banner"><img src="https://i.ytimg.com/vi/dTlpYnmBW9I/maxresdefault.jpg"></div><div class="wrap"><div class="post-content"><p>HOF và Currying là hai kỹ thuật không khó, thậm chí có thể bạn đang dùng nó hàng ngày mà không để ý. Cùng tìm hiểu chúng thông qua một số ví dụ.</p>
<h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>Tôi cho rằng một kỹ sư phần mềm pro không phải là người viết ra những dòng code đánh đố người đọc hay đồng nghiệp, mà là người viết những dòng code mà khi người khác đọc nó liền cảm thấy trong sáng, dễ hiểu, dễ bảo trì.</p>
<p>Cũng như sự tiến hóa của con người, khi mà “ăn no, ăn sạch rồi ăn ngon”, thì coding cũng có slogan tương tự: <a href="http://wiki.c2.com/?MakeItWorkMakeItRightMakeItFast" target="_blank" rel="noopener">“chạy được, chạy đúng, sau cùng là chạy nhanh”</a>.<br>Vậy, sau khi chạy được và chạy đúng rồi, chúng ta nên suy nghĩ xem ngoài việc có thể chạy nhanh hơn ko, thì đoạn code này đã sáng sủa chưa? Nếu bị/được sửa thì có dễ ko?</p>
<p>HOF và Currying là 2 trong số ti tỉ kỹ thuật nhằm giúp chúng ta, những lập trình viên huyền thoại, đạt được tiêu chí trên.<br><a id="more"></a><br>Trước khi đi vào khái niệm cụ thể, chúng ta cùng xem ví dụ dưới đây:</p>
<h3 id="Vi-du-1"><a href="#Vi-du-1" class="headerlink" title="Ví dụ 1"></a>Ví dụ 1</h3><p>Nhóc con nhà bạn nhờ bạn tìm những số tự nhiên khác 0 nhỏ hơn 20 và là số lẻ.<br>Là một ông bố mẫu mực với niềm kiêu hãnh nhiều năm kinh nghiệm fixed hàng trăm bug nhỏ và <del>tạo ra</del> hàng tá bug to, bạn muốn viết một chương trình hoành tráng để lấy le với con mình. Ok, you win!.<br>Dưới đây chắc hẳn là đoạn code đầu tiên xuất hiện trong đầu:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pickOddNumbers</span>(<span class="params">maximum</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= maximum; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">2</span> === <span class="number">1</span>) result.push(i);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pickOddNumbers(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p>Nhưng đời không bao giờ là mơ, khi hôm sau nhóc con lại mếu máo: “Cô giáo cho thêm bài: Tìm những số tự nhiên khác 0 nhỏ hơn 20 mà nếu gấp 3 số đó rồi từ đi 2 thì thu được số chẵn.”.<br>Bố chiều cô luôn. Vậy là bạn lại cho ra phiên bản mới:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pickSpecialNumbers</span>(<span class="params">maximum</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= maximum; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (((i * <span class="number">3</span>) - <span class="number">2</span>) % <span class="number">2</span> === <span class="number">0</span>) result.push(i);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pickSpecialNumbers(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p>Đời vẫn ko như mơ khi cô giáo lại cho thêm bài tập: “Tìm những số tự nhiên khác 0 nhỏ hơn 20 mà nếu lấy phần dư số đó cho 9 rồi cộng thêm 2 thì thu số lẻ.”<br>Ơ cô giáo từ từ, để bố em sửa function bên trên đã :))))</p>
<p>Cứ như vậy, mỗi lần cô giáo cho thêm yêu cầu là bạn lại phải sửa phiên bản cũ hoặc cho ra một bản mới, tuy yêu cầu khác nhau nhưng xử lý cơ bản là giống nhau, chỉ khác ở đoạn xử lý điều kiện cho số được chọn.<br>Và bạn chợt nhớ tới HOF, một ứng cử viên sáng giá cho việc làm đoạn code trên sạch hơn, gọn hơn, dễ sửa hơn.</p>
<h3 id="Dinh-nghia-HOF"><a href="#Dinh-nghia-HOF" class="headerlink" title="Định nghĩa HOF"></a>Định nghĩa HOF</h3><p>Theo <a href="https://en.wikipedia.org/wiki/Higher-order_function" target="_blank" rel="noopener">wikipedia</a> thì:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A higher-order <span class="function"><span class="keyword">function</span> (<span class="params">also functional, functional form or functor</span>) <span class="title">is</span> <span class="title">a</span> <span class="title">function</span> <span class="title">that</span> <span class="title">does</span> <span class="title">at</span> <span class="title">least</span> <span class="title">one</span> <span class="title">of</span> <span class="title">the</span> <span class="title">following</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">・<span class="title">takes</span> <span class="title">one</span> <span class="title">or</span> <span class="title">more</span> <span class="title">functions</span> <span class="title">as</span> <span class="title">arguments</span>,</span></span><br><span class="line"><span class="function">・<span class="title">returns</span> <span class="title">a</span> <span class="title">function</span> <span class="title">as</span> <span class="title">its</span> <span class="title">result</span>.</span></span><br></pre></td></tr></table></figure>
<p>Vietsub:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HOF là một <span class="function"><span class="keyword">function</span> <span class="title">m</span>à <span class="title">cho</span> <span class="title">ph</span>é<span class="title">p</span> <span class="title">th</span>ự<span class="title">c</span> <span class="title">hi</span>ệ<span class="title">n</span> í<span class="title">t</span> <span class="title">nh</span>ấ<span class="title">t</span> 1 <span class="title">trong</span> 2 <span class="title">kh</span>ả <span class="title">n</span>ă<span class="title">ng</span> <span class="title">sau</span>:</span></span><br><span class="line"><span class="function">・<span class="title">Nh</span>ậ<span class="title">n</span> <span class="title">v</span>à<span class="title">o</span> <span class="title">m</span>ộ<span class="title">t</span> <span class="title">ho</span>ặ<span class="title">c</span> <span class="title">nhi</span>ề<span class="title">u</span> <span class="title">function</span> <span class="title">nh</span>ư <span class="title">l</span>à <span class="title">tham</span> <span class="title">s</span>ố, <span class="title">ho</span>ặ<span class="title">c</span>/<span class="title">v</span>à</span></span><br><span class="line"><span class="function">・<span class="title">Tr</span>ả <span class="title">v</span>ề <span class="title">k</span>ế<span class="title">t</span> <span class="title">qu</span>ả <span class="title">l</span>à <span class="title">m</span>ộ<span class="title">t</span> <span class="title">function</span>.</span></span><br></pre></td></tr></table></figure>
<p><em>// Bạn có thể thấy có rất nhiều ngôn ngữ hỗ trợ HOF ở link wiki trên. Đến Java còn hỗ trợ nữa là :v</em></p>
<p>Trăm nghe không bằng một thấy, trăm thấy không bằng một sờ, và chúng ta lại cùng sờ với ví dụ bên trên.<br>Lần này là bản nâng cấp có giá trị về mặt học thuật, vì được áp dụng HOF vào cơ mà :)))</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pickNumbers</span>(<span class="params">maximum, pickingCondition</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= maximum; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (pickingCondition(i)) result.push(i);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chọn ra những số lẻ</span></span><br><span class="line">pickNumbers(<span class="number">20</span>, <span class="function"><span class="keyword">function</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> number % <span class="number">2</span> === <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chọn ra những số mà gấp 3 số đó rồi trừ đi 2 thu số chẵn</span></span><br><span class="line">pickNumbers(<span class="number">20</span>, <span class="function"><span class="keyword">function</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ((number * <span class="number">3</span>) - <span class="number">2</span>) % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Với việc đưa HOF vào function bên trên, giờ thì cô giáo thích gì cũng chiều được nhé,<br>chỉ cần thay đổi function kiểm tra điều kiện vào thôi, ko cần phải copy thành function mới nữa.</p>
<h3 id="Dinh-nghia-Currying"><a href="#Dinh-nghia-Currying" class="headerlink" title="Định nghĩa Currying"></a>Định nghĩa Currying</h3><p>Lại theo <a href="https://en.wikipedia.org/wiki/Currying" target="_blank" rel="noopener">wikipedia</a>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Currying is the technique <span class="keyword">of</span> translating the evaluation <span class="keyword">of</span> a <span class="function"><span class="keyword">function</span></span></span><br><span class="line"><span class="function"><span class="title">that</span> <span class="title">takes</span> <span class="title">multiple</span> <span class="title">arguments</span> (<span class="params">or a tuple of arguments</span>)</span></span><br><span class="line"><span class="function"><span class="title">into</span> <span class="title">evaluating</span> <span class="title">a</span> <span class="title">sequence</span> <span class="title">of</span> <span class="title">functions</span>, <span class="title">each</span> <span class="title">with</span> <span class="title">a</span> <span class="title">single</span> <span class="title">argument</span>.</span></span><br></pre></td></tr></table></figure>
<p>Vietsub:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Currying là kỹ thuật mà cho phép chuyển đổi một <span class="function"><span class="keyword">function</span> <span class="title">v</span>ớ<span class="title">i</span> <span class="title">nhi</span>ề<span class="title">u</span> <span class="title">tham</span> <span class="title">s</span>ố</span></span><br><span class="line"><span class="function"><span class="title">th</span>à<span class="title">nh</span> <span class="title">nh</span>ữ<span class="title">ng</span> <span class="title">functions</span> <span class="title">li</span>ê<span class="title">n</span> <span class="title">ti</span>ế<span class="title">p</span> <span class="title">c</span>ó <span class="title">m</span>ộ<span class="title">t</span> <span class="title">tham</span> <span class="title">s</span>ố.</span></span><br><span class="line"><span class="function">// <span class="title">V</span>í <span class="title">d</span>ụ <span class="title">f</span>(<span class="params">a,b,c</span>) <span class="title">c</span>ó <span class="title">th</span>ể đượ<span class="title">c</span> <span class="title">convert</span> <span class="title">th</span>à<span class="title">nh</span> <span class="title">g</span>(<span class="params">a</span>)<span class="title">h</span>(<span class="params">b, c</span>) <span class="title">hay</span> <span class="title">g</span>(<span class="params">a</span>)<span class="title">h</span>(<span class="params">b</span>)<span class="title">k</span>(<span class="params">c</span>), <span class="title">th</span>ậ<span class="title">m</span> <span class="title">ch</span>í <span class="title">l</span>à đổ<span class="title">i</span> <span class="title">th</span>ứ <span class="title">t</span>ự <span class="title">c</span>ủ<span class="title">a</span> <span class="title">c</span>á<span class="title">c</span> <span class="title">function</span> <span class="title">t</span>ươ<span class="title">ng</span> ứ<span class="title">ng</span>...</span></span><br></pre></td></tr></table></figure>
<p>Vậy dễ dàng nhận thấy Currying là một trường hợp của HOF, vì nó thỏa mãn điều kiện trả về kết quả là một function.</p>
<p>Cụ thể áp dụng cho ví dụ trên, có thể viết thành dạng sau:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pickNumbers</span>(<span class="params">maximum</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">pickingCondition</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> result = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= maximum; i += <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (pickingCondition(i)) result.push(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chọn ra những số lẻ</span></span><br><span class="line">pickNumbers(<span class="number">20</span>)(<span class="function"><span class="keyword">function</span> (<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> number % <span class="number">2</span> === <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chọn ra những số mà gấp 3 số đó rồi trừ đi 2 thu số chẵn</span></span><br><span class="line">pickNumbers(<span class="number">20</span>)(<span class="function"><span class="keyword">function</span> (<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (number * <span class="number">3</span> - <span class="number">2</span>) % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>So sánh ví dụ áp dụng Currying này với ví dụ sử dụng HOF ở trên, rõ ràng là ta chưa thấy sự ưu việt của Currying so với HOF, thậm chí còn thấy hơi rườm rà nữa.<br>Tuy nhiên, hãy cùng xem xét ví dụ dưới đây:</p>
<h3 id="Vi-du-2"><a href="#Vi-du-2" class="headerlink" title="Ví dụ 2"></a>Ví dụ 2</h3><p>Viết một function lấy ra giá trị của một key của object, được chọn ra từ một mảng các objects với điều kiện. Đơn giản vậy thôi, nên việc cài đặt cũng có vẻ là đơn giản.</p>
<p>Với HOF:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getValue</span>(<span class="params">objects, key, pickingCondition</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> object = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; objects.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (pickingCondition(objects[i])) &#123;</span><br><span class="line">      object = objects[i];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> object ? object[key] : <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Mỗi khi gọi function với key khác nhau, hẳn là sẽ phải gọi kiểu như vầy:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> valueByKey1 = getValue(objects, <span class="string">'key1'</span>, pickingCondition);</span><br><span class="line"><span class="keyword">var</span> valueByKey2 = getValue(objects, <span class="string">'key2'</span>, pickingCondition);</span><br></pre></td></tr></table></figure>
<p>Nếu như coi key là <strong>biết trước</strong>, chỉ thay đổi objects và pickingCondition, thì việc áp dụng Currying là hợp lý:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getValue</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">objects, pickingCondition</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> object = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; objects.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (pickingCondition(objects[i])) &#123;</span><br><span class="line">        object = objects[i];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> object ? object[key] : <span class="literal">null</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Wrap getValue thành những function ngắn hơn với tên sáng nghĩa:</span></span><br><span class="line"><span class="keyword">var</span> getValueByKey1 = getValue(<span class="string">'key1'</span>);</span><br><span class="line"><span class="keyword">var</span> getValueByKey2 = getValue(<span class="string">'key2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sử dụng:</span></span><br><span class="line"><span class="keyword">var</span> valueByKey1 = getValueByKey1(objects, pickingCondition);</span><br><span class="line"><span class="keyword">var</span> valueByKey2 = getValueByKey2(objects, pickingCondition);</span><br></pre></td></tr></table></figure>
<p>Khá là gọn gàng.</p>
<p><em>// Ngoài lề: Nếu bạn làm việc với ReactJs, hẳn bạn đã biết tới thuật ngữ Higher-Order Component, hay các selectors mà redux-form cung cấp, thì chúng đều áp dụng kỹ thuật Currying này, cũng như HOF.</em></p>
<p>Dưới đây là một vài ví dụ cho thấy tác dụng tốt của Currying:</p>
<h3 id="Vi-du-3"><a href="#Vi-du-3" class="headerlink" title="Ví dụ 3"></a>Ví dụ 3</h3><p>Viết function để kiểm tra độ dài của một xâu s có vượt quá n hay ko.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cách 1: Không dùng Currying</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isLengthOver</span>(<span class="params">s, n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> s.length &gt; n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cách 2: Có Currying</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isLengthOver</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">s</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.length &gt; n;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Giả sử cả 2 cách viết trên được sử dụng cho việc validate của một field trên form, với n = 10 thì có sự khác biệt như sau:</p>
<p>Với cách 1:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> validate=&#123;value =&gt; isLengthOver(value, <span class="number">10</span>)&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>Với cách 2:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> validate=&#123;isLengthOver(<span class="number">10</span>)&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>Quá khác bọt!</p>
<h3 id="Vi-du-4"><a href="#Vi-du-4" class="headerlink" title="Ví dụ 4"></a>Ví dụ 4</h3><p>Viết function hiển thị tên group mà một nhân viên đang làm việc, với:</p>
<p>Input:</p>
<ul>
<li>employeeGroupId là id của group mà nhân viên đang làm việc,</li>
<li>Mảng chứa toàn bộ groups có trong công ty.</li>
</ul>
<p>Điều kiện rằng buộc:</p>
<ul>
<li>Một group luôn có id khác null,</li>
<li>Nếu groupB là group con của groupA, thì groupB sẽ có parentGroupId là id của groupA. Group không là con khi parentGroupId của nó là null,</li>
<li>Không có quan hệ vòng tròn. (Kiểu: groupA là con groupB, groupB là con groupC, groupC là con groupA)</li>
</ul>
<p>Output:</p>
<ul>
<li>Full path của group mà nhân viên đang làm việc, phân cách bởi dấu /. Ví dụ Group A / Group B / Group C</li>
</ul>
<p>Chắc hẳn bạn sẽ nghĩ tới cách dùng vòng lặp, kiểm tra chừng nào còn tìm thấy group có id bằng parentGroupId. Và tôi cũng nghĩ vậy :D</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getGroupFullPathName = <span class="function">(<span class="params">groups, employeeGroupId</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> groupNames = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> group = groups.find(<span class="function"><span class="params">grp</span> =&gt;</span> grp.id === employeeGroupId);</span><br><span class="line">  <span class="keyword">while</span> (group) &#123;</span><br><span class="line">    groupNames.unshift(group.name);</span><br><span class="line">    group = groups.find(<span class="function"><span class="params">grp</span> =&gt;</span> grp.id === group.parentGroupId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> groupNames.join(<span class="string">'/'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Nhưng đoạn code trên vẫn chưa ngon, do vi phạm rule <a href="https://eslint.org/docs/rules/no-loop-func" target="_blank" rel="noopener">Don’t make functions within a loop</a> của ESLint.<br>Cụ thể: Mỗi khi vòng while được chạy thì groups.find(grp =&gt; grp.id === group.parentGroupId) lại sinh ra một anonymous function, chính là grp =&gt; grp.id === group.parentGroupId.</p>
<p>Cách khắc phục là ta viết một currying bên ngoài vòng while là được:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getGroupFullPathName = <span class="function">(<span class="params">groups, employeeGroupId</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> groupNames = [];</span><br><span class="line">  <span class="keyword">const</span> condition = <span class="function"><span class="params">parentGroupId</span> =&gt;</span> group =&gt; group.id === parentGroupId;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> group = groups.find(<span class="function"><span class="params">grp</span> =&gt;</span> grp.id === employeeGroupId);</span><br><span class="line">  <span class="keyword">while</span> (group) &#123;</span><br><span class="line">    groupNames.unshift(group.name);</span><br><span class="line">    group = groups.find(condition(group.parentDepartmentId));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> groupNames.join(<span class="string">'/'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="Ket-luan"><a href="#Ket-luan" class="headerlink" title="Kết luận:"></a>Kết luận:</h3><p>Bài quá dài.</p>
<p><em>// Nếu mấy ví dụ trên dùng cú pháp của es6 và dùng các api của Array thì sẽ ngắn hơn nhiều, nhưng lại khó nhìn rõ đâu là function được nhận vào/trả ra, nên các bạn chịu khó đọc với cú pháp cơ bản vậy :D</em></p>
<span>Source: </span><a href="https://manhdaovan.github.io/programming/vi/2017/10/14/higer-order-function-and-currying/" target="_blank" title="https://manhdaovan.github.io/programming/vi/2017/10/14/higer-order-function-and-currying/" class="post-from">https://manhdaovan.github.io/programming/vi/2017/10/14/higer-order-function-and-currying/</a></div></div></article></div></section><div class="wrap"><footer><div class="paginator"><a href="/2018/04/Hoc-Regular-Expression-va-cuoc-doi-ban-se-bot-kho.html" class="prev">NEXT</a><a href="/2018/03/CSS-Grid-vs-Flexbox-su-dung-nhu-the-nao.html" class="next">PREV</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'nthung2112';
var disqus_identifier = '2018/04/Tim-hieu-Higher-Order-Function-HOF-va-Currying-qua-mot-so-vi-du-3.html';
var disqus_title = 'Tìm hiểu Higher-Order Function (HOF) và Currying qua một số ví dụ';
var disqus_url = 'http://nth-blogs.herokuapp.com/2018/04/Tim-hieu-Higher-Order-Function-HOF-va-Currying-qua-mot-so-vi-du-3.html';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//nthung2112.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 - 2018 <a href="http://nth-blogs.herokuapp.com">Hung Tan Nguyen</a>, unless otherwise noted.</p></div></footer></div><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script><script src="/js/zoom.js"></script><script src="/js/insight.js"></script></body></html>